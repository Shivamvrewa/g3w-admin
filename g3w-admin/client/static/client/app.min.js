(()=>{var tF=Object.create;var _p=Object.defineProperty;var nF=Object.getOwnPropertyDescriptor;var iF=Object.getOwnPropertyNames;var sF=Object.getPrototypeOf,rF=Object.prototype.hasOwnProperty;var cr=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var R=(e,t)=>()=>(e&&(t=e(e=0)),t);var He=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),qn=(e,t)=>{for(var n in t)_p(e,n,{get:t[n],enumerable:!0})},US=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of iF(t))!rF.call(e,o)&&o!==n&&_p(e,o,{get:()=>t[o],enumerable:!(s=nF(t,o))||s.enumerable});return e};var Ut=(e,t,n)=>(n=e!=null?tF(sF(e)):{},US(t||!e||!e.__esModule?_p(n,"default",{value:e,enumerable:!0}):n,e)),kn=e=>US(_p({},"__esModule",{value:!0}),e);var Vy,zS=R(()=>{Vy="4.0.0"});var aF,jt,yp,sd,ur,fe,Ul,Go,sn,$n,Hy,rd,Gr,od,Rn,Bs,zl,ft=R(()=>{zS();aF=["add_feature","change_feature","change_attr_feature","delete_feature"],jt="g3w_fid",yp={gte:">=",lte:"<=",NOT:"!=",eq:"=",gt:">",lt:"<",in:"IN",LIKE:"LIKE",ILIKE:"ILIKE",AND:"AND",OR:"OR"},sd={lte:"<=",ltgt:"!=",ilike:"ILIKE",like:"LIKE",...yp},ur=["geometryProperty","boundedBy","geom","the_geom","geometry","bbox","GEOMETRY","geoemtria","geometria"],fe={POINT:"Point",POINTZ:"PointZ",POINTM:"PointM",POINTZM:"PointZM",POINT25D:"Point25D",MULTIPOINT:"MultiPoint",MULTIPOINTZ:"MultiPointZ",MULTIPOINTM:"MutliPointM",MULTIPOINTZM:"MultiPointZM",MULTIPOINT25D:"MultiPoint25D",LINESTRING:"LineString",LINESTRINGZ:"LineStringZ",LINESTRINGM:"LineStringM",LINESTRINGZM:"LineStringZM",LINESTRING25D:"LineString25D",LINE:"Line",LINEZ:"LineZ",LINEM:"LineM",LINEZM:"LineZM",LINE25D:"Line25D",MULTILINESTRING:"MultiLineString",MULTILINESTRINGZ:"MultiLineStringZ",MULTILINESTRINGM:"MultiLineStringM",MULTILINESTRINGZM:"MultiLineStringZM",MULTILINESTRING25D:"MultiLineString25D",MULTILINE:"MultiLine",MULTILINEZ:"MultiLineZ",MULTILINEM:"MultiLineM",MULTILINEZM:"MultiLineZM",MULTILINE25D:"MultiLine25D",POLYGON:"Polygon",POLYGONZ:"PolygonZ",POLYGONM:"PolygonM",POLYGONZM:"PolygonZM",POLYGON25D:"Polygon25D",MULTIPOLYGON:"MultiPolygon",MULTIPOLYGONZ:"MultiPolygonZ",MULTIPOLYGONM:"MultiPolygonM",MULTIPOLYGONZM:"MultiPolygonZM",MULTIPOLYGON25D:"MultiPolygon25D",GEOMETRYCOLLECTION:"GeometryCollection",GEOMETRYCOLLECTIONZ:"GeometryCollectionZ",GEOMETRYCOLLECTIONM:"GeometryCollectionM",GEOMETRYCOLLECTIONZM:"GeometryCollectionZM",GEOMETRYCOLLECTION25D:"GeometryCollection25D"},Ul=[{value:100,label:"1:100"},{value:200,label:"1:200"},{value:500,label:"1:500"},{value:1e3,label:"1:1.000"},{value:2e3,label:"1:2.000"},{value:2500,label:"1:2.500"},{value:5e3,label:"1:5.000"},{value:1e4,label:"1:10.000"},{value:2e4,label:"1:20.000"},{value:25e3,label:"1:25.000"},{value:5e4,label:"1:50.000"},{value:1e5,label:"1:100.000"},{value:25e4,label:"1:250.000"},{value:5e5,label:"1:500.000"},{value:1e6,label:"1:1.000.000"},{value:25e5,label:"1:2.500.000"},{value:5e6,label:"1:5.000.000"},{value:1e7,label:"1:10.000.000"},{value:2e7,label:"1:20.000.000"},{value:5e7,label:"1:50.000.000"},{value:1e8,label:"1:100.000.000"},{value:25e7,label:"1:250.000.000"},{value:5e8,label:"1:500.000.000"}],Go={unit:"pixel",value:10},sn="__G3W_ALL__",$n=6e4,Hy={"change-map":"fas fa-map-signs",map:"far fa-map",file:"fas fa-file-code",marker:"fas fa-map-marker-alt",relation:"fas fa-sitemap",tools:"fas fa-cogs",tool:"fas fa-cog",search:"fas fa-search",print:"fas fa-print",info:"fas fa-info-circle","info-circle":"fas fa-info-circle",globe:"fas fa-globe",mail:"fas fa-envelope",mobile:"fas fa-mobile",fax:"fas fa-fax",user:"fas fa-user",bars:"fas fa-bars",uncheck:"far fa-square",check:"far fa-check-square",checkmark:"fa fa-check",filluncheck:"fas fa-square",table:"fas fa-table",trash:"fas fa-trash","trash-o":"far fa-trash-alt",pencil:"fas fa-pencil-alt","ellips-h":"fas fa-ellipsis-h","ellips-v":"fas fa-ellipsis-v","arrow-up":"fas fa-chevron-up","arrow-down":"fas fa-chevron-down","arrow-left":"fas fa-chevron-left","arrow-right":"fas fa-chevron-right","resize-h":"fas fa-arrows-alt-h","resize-v":"fas fa-arrows-alt-v","resize-default":"fas fa-compress","caret-up":"fas fa-caret-up","caret-down":"fas fa-caret-down","caret-left":"fas fa-caret-left","caret-right":"fas fa-caret-right","empty-circle":"far fa-circle","cloud-upload":"fas fa-cloud-upload-alt",spinner:"fas fa-spinner",minus:"fas fa-minus","minus-square":"far fa-minus-square",plus:"fas fa-plus","plus-circle":"fas fa-plus-circle","plus-square":"far fa-plus-square",grid:"fas fa-th",home:"fas fa-home",folder:"fas fa-folder","sign-out":"fas fa-sign-out-alt",close:"fas fa-times",time:"far fa-clock",calendar:"fas fa-calendar-alt",list:"fas fa-list-alt",link:"fas fa-link",unlink:"fas fa-unlink",eye:"far fa-eye","eye-close":"far fa-eye-slash",save:"far fa-save",pdf:"fas fa-file-pdf",image:"far fa-image",video:"far fa-file-video",unknow:"far fa-question-circle",zip:"far fa-file-archive",text:"far fa-file-alt",excel:"far fa-file-excel",xls:"far fa-file-excel",gpx:"fas fa-location-arrow",gpkg:"fas fa-box-open",shapefile:"fas fa-file-archive",csv:"fas fa-file-csv",geotiff:"fas fa-th",ppt:"far fa-file-powerpoint",circle:"fas fa-circle",calculator:"fas fa-calculator",picture:"far fa-image",keyboard:"far fa-keyboard","file-download":"fas fa-file-download",copy:"far fa-copy",draw:"fas fa-draw-polygon",chart:"fas fa-chart-bar","chart-line":"fas fa-chart-line","chart-area":"fas fa-chart-area","chart-pie":"fas fa-chart-pie",run:"fas fa-play",warning:"fas fa-exclamation-circle",alert:"fas fa-exclamation-triangle",crosshairs:"fas fa-crosshairs",success:"far fa-check-circle",back:"fas fa-chevron-circle-left","file-upload":"fas fa-file-upload",wifi:"fas fa-wifi",mouse:"fas fa-mouse","copy-paste":"far fa-copy","vector-square":"fas fa-vector-square",download:"fas fa-download",credits:"fas fa-euro-sign",filter:"fas fa-filter",plugin:"fas fa-plug",invert:"fas fa-exchange-alt",clear:"fas fa-broom",palette:"fas fa-palette",layers:"fas fa-layer-group","sign-in":"fas fa-sign-in-alt",language:"fas fa-language",target:"fas fa-bullseye",pin:"fas fa-map-pin",square:"far fa-square",move:"fas fa-arrows-alt",moon:"fas fa-moon",sun:"fas fa-sun",refresh:"fas fa-sync-alt",pause:"fas fa-pause","step-backward":"fas fa-step-backward","fast-backward":"fas fa-fast-backward","step-forward":"fas fa-step-forward","fast-forward":"fas fa-fast-forward",crop:"fas fa-crop-alt",exit:"fas fa-door-open",slider:"fas fa-sliders-h",bookmark:"fas fa-bookmark",reply:"fas fa-reply",share:"fas fa-share","share-alt":"fa fa-share-alt","external-link":"fa fa-external-link-alt",pointer:"fa fa-hand-pointer",camera:"fas fa-camera-retro",measure:"fas fa-ruler-horizontal",tint:"fa fa-tint",sort:"fa fa-sort",copyright:"fa fa-copyright",forward:"fas fa-angle-double-right",backward:"fas fa-angle-double-left",annotation:"fas fa-font"},rd=["intersects","within"],Gr=96,od={m:39.37,degrees:4374754},Rn={ALL:"__ALL__",EXCLUDE:"__EXCLUDE__"},Bs=[10,25,50,100],zl={DEFAULT_EDITING_CAPABILITIES:aF,DOTS_PER_INCH:Gr,FILTER_OPERATORS:yp,FILTER_EXPRESSION_OPERATORS:sd,FONT_AWESOME_ICONS:Hy,G3W_FID:jt,GEOMETRY_FIELDS:ur,GEOMETRY_TYPES:fe,INCHES_PER_UNIT:od,PRINT_SCALES:Ul,QUERY_POINT_TOLERANCE:Go,SEARCH_ALLVALUE:sn,SPATIAL_METHODS:rd,TIMEOUT:$n,PAGELENGTHS:Bs}});function oi(){}var Vl=R(()=>{});function un(e,t=500){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>e(...s),t)}}var Us=R(()=>{});function En(e,t=500){let n;return function(...s){let o=n;n=Date.now(),(o===void 0||n-o>t)&&e(...s)}}var dr=R(()=>{});var HS=He((VS,vp)=>{(function(e){"use strict";function t(){}var n=t.prototype,s=e.EventEmitter;function o(u,h){for(var p=u.length;p--;)if(u[p].listener===h)return p;return-1}function l(u){return function(){return this[u].apply(this,arguments)}}n.getListeners=function(h){var p=this._getEvents(),d,_;if(h instanceof RegExp){d={};for(_ in p)p.hasOwnProperty(_)&&h.test(_)&&(d[_]=p[_])}else d=p[h]||(p[h]=[]);return d},n.flattenListeners=function(h){var p=[],d;for(d=0;d<h.length;d+=1)p.push(h[d].listener);return p},n.getListenersAsObject=function(h){var p=this.getListeners(h),d;return p instanceof Array&&(d={},d[h]=p),d||p};function a(u){return typeof u=="function"||u instanceof RegExp?!0:u&&typeof u=="object"?a(u.listener):!1}n.addListener=function(h,p){if(!a(p))throw new TypeError("listener must be a function");var d=this.getListenersAsObject(h),_=typeof p=="object",m;for(m in d)d.hasOwnProperty(m)&&o(d[m],p)===-1&&d[m].push(_?p:{listener:p,once:!1});return this},n.on=l("addListener"),n.addOnceListener=function(h,p){return this.addListener(h,{listener:p,once:!0})},n.once=l("addOnceListener"),n.defineEvent=function(h){return this.getListeners(h),this},n.defineEvents=function(h){for(var p=0;p<h.length;p+=1)this.defineEvent(h[p]);return this},n.removeListener=function(h,p){var d=this.getListenersAsObject(h),_,m;for(m in d)d.hasOwnProperty(m)&&(_=o(d[m],p),_!==-1&&d[m].splice(_,1));return this},n.off=l("removeListener"),n.addListeners=function(h,p){return this.manipulateListeners(!1,h,p)},n.removeListeners=function(h,p){return this.manipulateListeners(!0,h,p)},n.manipulateListeners=function(h,p,d){var _,m,v=h?this.removeListener:this.addListener,x=h?this.removeListeners:this.addListeners;if(typeof p=="object"&&!(p instanceof RegExp))for(_ in p)p.hasOwnProperty(_)&&(m=p[_])&&(typeof m=="function"?v.call(this,_,m):x.call(this,_,m));else for(_=d.length;_--;)v.call(this,p,d[_]);return this},n.removeEvent=function(h){var p=typeof h,d=this._getEvents(),_;if(p==="string")delete d[h];else if(h instanceof RegExp)for(_ in d)d.hasOwnProperty(_)&&h.test(_)&&delete d[_];else delete this._events;return this},n.removeAllListeners=l("removeEvent"),n.emitEvent=function(h,p){var d=this.getListenersAsObject(h),_,m,v,x,b;for(x in d)if(d.hasOwnProperty(x))for(_=d[x].slice(0),v=0;v<_.length;v++)m=_[v],m.once===!0&&this.removeListener(h,m.listener),b=m.listener.apply(this,p||[]),b===this._getOnceReturnValue()&&this.removeListener(h,m.listener);return this},n.trigger=l("emitEvent"),n.emit=function(h){var p=Array.prototype.slice.call(arguments,1);return this.emitEvent(h,p)},n.setOnceReturnValue=function(h){return this._onceReturnValue=h,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return e.EventEmitter=s,t},typeof define=="function"&&define.amd?define(function(){return t}):typeof vp=="object"&&vp.exports?vp.exports=t:e.EventEmitter=t})(typeof window<"u"?window:VS||{})});var WS,nt,vn=R(()=>{Vl();Us();dr();WS=Ut(HS()),nt=class extends WS.default{___setters;___throttles;___debounces;___listeners;get setters(){return this.___setters}set setters(t){if(Array.isArray(t)&&(t=t.reduce((n,s)=>Object.assign(n,{[s]:this[s]}),{})),this.___setters=t,t){this.___listeners={after:{},before:{}};for(let n in this.___setters)this.___listeners.after[n]=[],this.___listeners.before[n]=[],this[n]=function(...s){return $.Deferred(o=>{let l=0,a=u=>{let h=u===!0||u===!1?!u:!1,p=this.___listeners.before[n].length;if(h){(this.___setters[n]instanceof Function?oi:this.___setters[n].fallback||oi).apply(this,s),o.reject();return}if(l===p){o.resolve((this.___setters[n]instanceof Function?this.___setters[n]:this.___setters[n].fnc).apply(this,s));let d=[];this.___listeners.after[n].forEach(_=>{_.fnc.apply(this,s),_.once&&d.push(_.key)}),d.forEach(_=>this.un(n,_)),this.emitEvent(`set:${n}`,s)}if(l<p){let d=this.___listeners.before[n][l++];d.async?(s.push(a),d.fnc.apply(this,s)):a(d.fnc.apply(this,s)),d.once&&this.___listeners.before[n].splice(l-1,1)}};a(!0)})}}}get throttles(){return this.___throttles}set throttles(t){if(this.___throttles=t,t){console.warn("[G3W-CLIENT] throttles option is deprecated"),console.trace();for(let n in this.___throttles)this[n]=En(this.___throttles[n].fnc,this.___throttles[n].delay)}}get debounces(){return this.___debounces}set debounces(t){if(this.___debounces=t,t){console.warn("[G3W-CLIENT] debounces option is deprecated"),console.trace();for(let n in this.___debounces)this[n]=un(this.___debounces[n].fnc,this.___debounces[n].delay)}}constructor(t){super(t),t=t||{},this.setters=t.setters||this.setters,this.throttles=t.throttles||this.throttles,this.throttles=t.debounces||this.debounces}onafter(t,n,s){return this._onsetter("after",t,n,!1,s)}onceafter(t,n,s){return this._onsetter("after",t,n,!1,s,!0)}onbefore(t,n,s){return this._onsetter("before",t,n,!1,s)}oncebefore(t,n,s){return this._onsetter("before",t,n,!1,s,!0)}onbeforeasync(t,n,s){return this._onsetter("before",t,n,!0,s)}un(t,n){Object.entries(this.___listeners).forEach(([s,o])=>{n===void 0?o[t].splice(0):o[t].forEach((l,a)=>{l.key===n&&o[t].splice(a,1)})})}_onsetter(t,n,s,o,l=0,a=!1){let u;return this.___listeners&&this.___listeners[t][n]!==void 0&&(u=`${Math.floor(Math.random()*1e6)+Date.now()}`,this.___listeners[t][n].push({key:u,fnc:s,async:o,priority:l,once:a}),this.___listeners[t][n]=this.___listeners[t][n].sort((h,p)=>p.priority-h.priority)),u}get(t){return this[t]&&!(this[t]instanceof Function)?this[t]:null}set(t,n){this[t]=n}}});var lF,F,Ke=R(()=>{vn();lF=Vue.observable({ready:!1,iframe:window.top!==window.self,online:navigator.onLine,ismobile:isMobile.any,download:!1,upload:!1,baseLayerId:null,language:"en",locales:{},plugins:[],pluginsConfigs:{},configurationPlugins:[],user:null,map:{epsg:"",unit:"metric"},gui:{app:{disabled:!1},sidebar:{disabled:!1,open:!0},layout:{__current:"app",app:{}}},keys:{vendorkeys:{google:void 0,bing:void 0}},tokens:{filtertoken:void 0},querybuilder:{cache:{},searches:JSON.parse(window.localStorage.getItem("QUERYBUILDERSEARCHES")||"{}")},navbaritems:[],sidebar:{title:"",components:[],parent:null,contentsdata:[],btn_close:!0,tooltip_close:"close"},contentsdata:[],viewport:{resized:{start:!1,h:!1,v:!1},split:"h",map:{sizes:{width:0,height:0}},content:{loading:!1,disabled:!1,sizes:{width:0,height:0},resize:{h:{perc:0},v:{perc:0}},showgoback:!0,stack:[],closable:!0,backonclose:!1,contentsdata:[]},usermessage:{id:null,show:!1,title:null,message:null,position:null,type:null,draggable:null,cloasable:null,autoclose:null,textMessage:!1,hooks:{header:null,body:null,footer:null}},components:{map:null,content:null}},sizes:{sidebar:{width:0}},project:new nt,catalog:{},highlightlayers:!1}),F=lF});var YS,Mn,Hl=R(()=>{ft();vn();YS=new nt({setters:{online(){},offline(){}}});YS.version=Vy;Mn=YS});function ad(e){return e.length===2&&e.push(0),e}function bp({feature:e,geometryType:t}={}){let n=e?.getGeometry?.(),s=n?.getCoordinates?.();switch(t||n?.getType?.()){case"PointZ":case"PointM":case"PointZM":case"Point25D":e.getGeometry().setCoordinates(ad(s));break;case"MultiPointZ":case"MultiPointM":case"MultiPointZM":case"MultiPoint25D":case"LineStringZ":case"LineStringM":case"LineStringZM":case"LineString25D":case"LineZ":case"LineM":case"LineZM":case"Line25D":s.forEach(o=>ad(o)),e.getGeometry().setCoordinates(s);break;case"MultiLineStringZ":case"MultiLineStringM":case"MultiLineStringZM":case"MultiLineString25D":case"MultiLineZ":case"MultiLineM":case"MultiLineZM":case"MultiLine25D":s.forEach(o=>o.forEach(l=>ad(l))),e.getGeometry().setCoordinates(s);break;case"PolygonZ":case"PolygonM":case"PolygonZM":case"Polygon25D":s[0].forEach(o=>ad(o)),e.getGeometry().setCoordinates(s);break;case"MultiPolygonZ":case"MultiPolygonM":case"MultiPolygonZM":case"MultiPolygon25D":s.forEach(o=>o[0].forEach(l=>ad(l))),e.getGeometry().setCoordinates(s);break;default:console.warn("invalid geometry type:",t||n?.getType?.())}return e}var Wy=R(()=>{});function ld(e){return[fe.POINTZ,fe.POINTM,fe.POINTZM,fe.POINT25D,fe.MULTIPOINTZ,fe.MULTIPOINTM,fe.MULTIPOINTZM,fe.MULTIPOINT25D,fe.LINESTRINGZ,fe.LINESTRINGM,fe.LINESTRINGZM,fe.LINESTRING25D,fe.MULTILINESTRINGZ,fe.MULTILINESTRINGM,fe.MULTILINESTRINGZM,fe.MULTILINESTRING25D,fe.LINEZ,fe.LINEM,fe.LINEZM,fe.LINE25D,fe.MULTILINEZ,fe.MULTILINEM,fe.MULTILINEZM,fe.MULTILINE25D,fe.POLYGONZ,fe.POLYGONM,fe.POLYGONZM,fe.POLYGON25D,fe.MULTIPOLYGONZ,fe.MULTIPOLYGONM,fe.MULTIPOLYGONZM,fe.MULTIPOLYGON25D].find(t=>t===e)}var Yy=R(()=>{ft()});function cd({feature:e}={}){let t=e.getGeometry();if(!t)return e;let n=t.getCoordinates();switch(t.getType()){case fe.POINT:n.splice(2),t.setCoordinates(n);break;case fe.MULTIPOINT:case fe.LINESTRING:case fe.LINE:n.forEach(s=>s.splice(2)),t.setCoordinates(n);break;case fe.MULTILINESTRING:case fe.MULTILINE:n.forEach(s=>s.forEach(o=>o.splice(2))),t.setCoordinates(n);break;case fe.POLYGON:n[0].forEach(s=>s.splice(2)),t.setCoordinates(n);break;case fe.MULTIPOLYGON:n.forEach(s=>s[0].forEach(o=>o.splice(2))),t.setCoordinates(n);break;default:console.warn("unsupported geometry type: "+t.getType())}return e}var Xy=R(()=>{ft()});function jo(e){return[fe.MULTIPOINT,fe.MULTIPOINTZ,fe.MULTIPOINTZM,fe.MULTIPOINTM,fe.MULTIPOINT25D,fe.MULTILINESTRING,fe.MULTILINESTRINGZ,fe.MULTILINESTRINGM,fe.MULTILINESTRINGZM,fe.MULTILINESTRING25D,fe.MULTILINE,fe.MULTILINEZ,fe.MULTILINEM,fe.MULTILINEZM,fe.MULTILINE25D,fe.MULTIPOLYGON,fe.MULTIPOLYGONZ,fe.MULTIPOLYGONM,fe.MULTIPOLYGONZM,fe.MULTIPOLYGON25D].includes(e)}var xp=R(()=>{ft()});function Wl(e){return[fe.POINT,fe.POINTZ,fe.POINTM,fe.POINTZM,fe.POINT25D,fe.MULTIPOINT,fe.MULTIPOINTZ,fe.MULTIPOINTM,fe.MULTIPOINTZM,fe.MULTIPOINT25D].includes(e)}var wp=R(()=>{ft()});function qo(e){return[fe.LINESTRING,fe.LINESTRINGZ,fe.LINESTRINGM,fe.LINESTRINGZM,fe.LINESTRING25D,fe.MULTILINESTRING,fe.MULTILINESTRINGZ,fe.MULTILINESTRINGM,fe.MULTILINESTRINGZM,fe.MULTILINESTRING25D,fe.LINE,fe.LINEZ,fe.LINEM,fe.LINEZM,fe.LINE25D,fe.MULTILINE,fe.MULTILINEZ,fe.MULTILINEM,fe.MULTILINEZM,fe.MULTILINE25D].includes(e)}var ud=R(()=>{ft()});function $o(e){return[fe.POLYGON,fe.POLYGONZ,fe.POLYGONM,fe.POLYGONZM,fe.POLYGON25D,fe.MULTIPOLYGON,fe.MULTIPOLYGONZ,fe.MULTIPOLYGONM,fe.MULTIPOLYGONZM,fe.MULTIPOLYGON25D].includes(e)}var dd=R(()=>{ft()});var Sp=He((ZS,Zy)=>{(function(e){typeof ZS=="object"&&typeof Zy<"u"?Zy.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=e()})(function(){return function e(t,n,s){function o(u,h){if(!n[u]){if(!t[u]){var p=typeof cr=="function"&&cr;if(!h&&p)return p(u,!0);if(l)return l(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var _=n[u]={exports:{}};t[u][0].call(_.exports,function(m){var v=t[u][1][m];return o(v||m)},_,_.exports,e,t,n,s)}return n[u].exports}for(var l=typeof cr=="function"&&cr,a=0;a<s.length;a++)o(s[a]);return o}({1:[function(e,t,n){"use strict";var s=e("./utils"),o=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(a){for(var u,h,p,d,_,m,v,x=[],b=0,w=a.length,L=w,D=s.getTypeOf(a)!=="string";b<a.length;)L=w-b,p=D?(u=a[b++],h=b<w?a[b++]:0,b<w?a[b++]:0):(u=a.charCodeAt(b++),h=b<w?a.charCodeAt(b++):0,b<w?a.charCodeAt(b++):0),d=u>>2,_=(3&u)<<4|h>>4,m=1<L?(15&h)<<2|p>>6:64,v=2<L?63&p:64,x.push(l.charAt(d)+l.charAt(_)+l.charAt(m)+l.charAt(v));return x.join("")},n.decode=function(a){var u,h,p,d,_,m,v=0,x=0,b="data:";if(a.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var w,L=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===l.charAt(64)&&L--,a.charAt(a.length-2)===l.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=o.uint8array?new Uint8Array(0|L):new Array(0|L);v<a.length;)u=l.indexOf(a.charAt(v++))<<2|(d=l.indexOf(a.charAt(v++)))>>4,h=(15&d)<<4|(_=l.indexOf(a.charAt(v++)))>>2,p=(3&_)<<6|(m=l.indexOf(a.charAt(v++))),w[x++]=u,_!==64&&(w[x++]=h),m!==64&&(w[x++]=p);return w}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var s=e("./external"),o=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function u(h,p,d,_,m){this.compressedSize=h,this.uncompressedSize=p,this.crc32=d,this.compression=_,this.compressedContent=m}u.prototype={getContentWorker:function(){var h=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),p=this;return h.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(h,p,d){return h.pipe(new l).pipe(new a("uncompressedSize")).pipe(p.compressWorker(d)).pipe(new a("compressedSize")).withStreamInfo("compression",p)},t.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var s=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var s=e("./utils"),o=function(){for(var l,a=[],u=0;u<256;u++){l=u;for(var h=0;h<8;h++)l=1&l?3988292384^l>>>1:l>>>1;a[u]=l}return a}();t.exports=function(l,a){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(u,h,p,d){var _=o,m=d+p;u^=-1;for(var v=d;v<m;v++)u=u>>>8^_[255&(u^h[v])];return-1^u}(0|a,l,l.length,0):function(u,h,p,d){var _=o,m=d+p;u^=-1;for(var v=d;v<m;v++)u=u>>>8^_[255&(u^h.charCodeAt(v))];return-1^u}(0|a,l,l.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var s=null;s=typeof Promise<"u"?Promise:e("lie"),t.exports={Promise:s}},{lie:37}],7:[function(e,t,n){"use strict";var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),l=e("./utils"),a=e("./stream/GenericWorker"),u=s?"uint8array":"array";function h(p,d){a.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=d,this.meta={}}n.magic="\b\0",l.inherits(h,a),h.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(u,p.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(d){p.push({data:d,meta:p.meta})}},n.compressWorker=function(p){return new h("Deflate",p)},n.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function s(_,m){var v,x="";for(v=0;v<m;v++)x+=String.fromCharCode(255&_),_>>>=8;return x}function o(_,m,v,x,b,w){var L,D,G=_.file,W=_.compression,P=w!==u.utf8encode,j=l.transformTo("string",w(G.name)),V=l.transformTo("string",u.utf8encode(G.name)),H=G.comment,se=l.transformTo("string",w(H)),M=l.transformTo("string",u.utf8encode(H)),ie=V.length!==G.name.length,E=M.length!==H.length,X="",K="",te="",Ge=G.dir,ye=G.date,Re={crc32:0,compressedSize:0,uncompressedSize:0};m&&!v||(Re.crc32=_.crc32,Re.compressedSize=_.compressedSize,Re.uncompressedSize=_.uncompressedSize);var U=0;m&&(U|=8),P||!ie&&!E||(U|=2048);var ce=0,we=0;Ge&&(ce|=16),b==="UNIX"?(we=798,ce|=function(Ee,Fe){var lt=Ee;return Ee||(lt=Fe?16893:33204),(65535&lt)<<16}(G.unixPermissions,Ge)):(we=20,ce|=function(Ee){return 63&(Ee||0)}(G.dosPermissions)),L=ye.getUTCHours(),L<<=6,L|=ye.getUTCMinutes(),L<<=5,L|=ye.getUTCSeconds()/2,D=ye.getUTCFullYear()-1980,D<<=4,D|=ye.getUTCMonth()+1,D<<=5,D|=ye.getUTCDate(),ie&&(K=s(1,1)+s(h(j),4)+V,X+="up"+s(K.length,2)+K),E&&(te=s(1,1)+s(h(se),4)+M,X+="uc"+s(te.length,2)+te);var pe="";return pe+=`
\0`,pe+=s(U,2),pe+=W.magic,pe+=s(L,2),pe+=s(D,2),pe+=s(Re.crc32,4),pe+=s(Re.compressedSize,4),pe+=s(Re.uncompressedSize,4),pe+=s(j.length,2),pe+=s(X.length,2),{fileRecord:p.LOCAL_FILE_HEADER+pe+j+X,dirRecord:p.CENTRAL_FILE_HEADER+s(we,2)+pe+s(se.length,2)+"\0\0\0\0"+s(ce,4)+s(x,4)+j+X+se}}var l=e("../utils"),a=e("../stream/GenericWorker"),u=e("../utf8"),h=e("../crc32"),p=e("../signature");function d(_,m,v,x){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=v,this.encodeFileName=x,this.streamFiles=_,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(d,a),d.prototype.push=function(_){var m=_.meta.percent||0,v=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(_):(this.bytesWritten+=_.data.length,a.prototype.push.call(this,{data:_.data,meta:{currentFile:this.currentFile,percent:v?(m+100*(v-x-1))/v:100}}))},d.prototype.openedSource=function(_){this.currentSourceOffset=this.bytesWritten,this.currentFile=_.file.name;var m=this.streamFiles&&!_.file.dir;if(m){var v=o(_,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(_){this.accumulate=!1;var m=this.streamFiles&&!_.file.dir,v=o(_,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),m)this.push({data:function(x){return p.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)}(_),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var _=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var v=this.bytesWritten-_,x=function(b,w,L,D,G){var W=l.transformTo("string",G(D));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(b,2)+s(b,2)+s(w,4)+s(L,4)+s(W.length,2)+W}(this.dirRecords.length,v,_,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(_){this._sources.push(_);var m=this;return _.on("data",function(v){m.processChunk(v)}),_.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),_.on("error",function(v){m.error(v)}),this},d.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(_){var m=this._sources;if(!a.prototype.error.call(this,_))return!1;for(var v=0;v<m.length;v++)try{m[v].error(_)}catch{}return!0},d.prototype.lock=function(){a.prototype.lock.call(this);for(var _=this._sources,m=0;m<_.length;m++)_[m].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var s=e("../compressions"),o=e("./ZipFileWorker");n.generateWorker=function(l,a,u){var h=new o(a.streamFiles,u,a.platform,a.encodeFileName),p=0;try{l.forEach(function(d,_){p++;var m=function(w,L){var D=w||L,G=s[D];if(!G)throw new Error(D+" is not a valid compression method !");return G}(_.options.compression,a.compression),v=_.options.compressionOptions||a.compressionOptions||{},x=_.dir,b=_.date;_._compressWorker(m,v).withStreamInfo("file",{name:d,dir:x,date:b,comment:_.comment||"",unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions}).pipe(h)}),h.entriesCount=p}catch(d){h.error(d)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,l){return new s().loadAsync(o,l)},s.external=e("./external"),t.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var s=e("./utils"),o=e("./external"),l=e("./utf8"),a=e("./zipEntries"),u=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function p(d){return new o.Promise(function(_,m){var v=d.decompressed.getContentWorker().pipe(new u);v.on("error",function(x){m(x)}).on("end",function(){v.streamInfo.crc32!==d.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):_()}).resume()})}t.exports=function(d,_){var m=this;return _=s.extend(_||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),h.isNode&&h.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,_.optimizedBinaryString,_.base64).then(function(v){var x=new a(_);return x.load(v),x}).then(function(v){var x=[o.Promise.resolve(v)],b=v.files;if(_.checkCRC32)for(var w=0;w<b.length;w++)x.push(p(b[w]));return o.Promise.all(x)}).then(function(v){for(var x=v.shift(),b=x.files,w=0;w<b.length;w++){var L=b[w],D=L.fileNameStr,G=s.resolve(L.fileNameStr);m.file(G,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:_.createFolders}),L.dir||(m.file(G).unsafeOriginalName=D)}return x.zipComment.length&&(m.comment=x.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var s=e("../utils"),o=e("../stream/GenericWorker");function l(a,u){o.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(l,o),l.prototype._bindStream=function(a){var u=this;(this._stream=a).pause(),a.on("data",function(h){u.push({data:h,meta:{percent:0}})}).on("error",function(h){u.isPaused?this.generatedError=h:u.error(h)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var s=e("readable-stream").Readable;function o(l,a,u){s.call(this,a),this._helper=l;var h=this;l.on("data",function(p,d){h.push(p)||h._helper.pause(),u&&u(d)}).on("error",function(p){h.emit("error",p)}).on("end",function(){h.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},t.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,t,n){"use strict";function s(G,W,P){var j,V=l.getTypeOf(W),H=l.extend(P||{},h);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(G=b(G)),H.createFolders&&(j=x(G))&&w.call(this,j,!0);var se=V==="string"&&H.binary===!1&&H.base64===!1;P&&P.binary!==void 0||(H.binary=!se),(W instanceof p&&W.uncompressedSize===0||H.dir||!W||W.length===0)&&(H.base64=!1,H.binary=!0,W="",H.compression="STORE",V="string");var M=null;M=W instanceof p||W instanceof a?W:m.isNode&&m.isStream(W)?new v(G,W):l.prepareContent(G,W,H.binary,H.optimizedBinaryString,H.base64);var ie=new d(G,M,H);this.files[G]=ie}var o=e("./utf8"),l=e("./utils"),a=e("./stream/GenericWorker"),u=e("./stream/StreamHelper"),h=e("./defaults"),p=e("./compressedObject"),d=e("./zipObject"),_=e("./generate"),m=e("./nodejsUtils"),v=e("./nodejs/NodejsStreamInputAdapter"),x=function(G){G.slice(-1)==="/"&&(G=G.substring(0,G.length-1));var W=G.lastIndexOf("/");return 0<W?G.substring(0,W):""},b=function(G){return G.slice(-1)!=="/"&&(G+="/"),G},w=function(G,W){return W=W!==void 0?W:h.createFolders,G=b(G),this.files[G]||s.call(this,G,null,{dir:!0,createFolders:W}),this.files[G]};function L(G){return Object.prototype.toString.call(G)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(G){var W,P,j;for(W in this.files)j=this.files[W],(P=W.slice(this.root.length,W.length))&&W.slice(0,this.root.length)===this.root&&G(P,j)},filter:function(G){var W=[];return this.forEach(function(P,j){G(P,j)&&W.push(j)}),W},file:function(G,W,P){if(arguments.length!==1)return G=this.root+G,s.call(this,G,W,P),this;if(L(G)){var j=G;return this.filter(function(H,se){return!se.dir&&j.test(H)})}var V=this.files[this.root+G];return V&&!V.dir?V:null},folder:function(G){if(!G)return this;if(L(G))return this.filter(function(V,H){return H.dir&&G.test(V)});var W=this.root+G,P=w.call(this,W),j=this.clone();return j.root=P.name,j},remove:function(G){G=this.root+G;var W=this.files[G];if(W||(G.slice(-1)!=="/"&&(G+="/"),W=this.files[G]),W&&!W.dir)delete this.files[G];else for(var P=this.filter(function(V,H){return H.name.slice(0,G.length)===G}),j=0;j<P.length;j++)delete this.files[P[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(G){var W,P={};try{if((P=l.extend(G||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");l.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var j=P.comment||this.comment||"";W=_.generateWorker(this,P,j)}catch(V){(W=new a("error")).error(V)}return new u(W,P.type||"string",P.mimeType)},generateAsync:function(G,W){return this.generateInternalStream(G).accumulate(W)},generateNodeStream:function(G,W){return(G=G||{}).type||(G.type="nodebuffer"),this.generateInternalStream(G).toNodejsStream(W)}};t.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var s=e("./DataReader");function o(l){s.call(this,l);for(var a=0;a<this.data.length;a++)l[a]=255&l[a]}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var a=l.charCodeAt(0),u=l.charCodeAt(1),h=l.charCodeAt(2),p=l.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===a&&this.data[d+1]===u&&this.data[d+2]===h&&this.data[d+3]===p)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var a=l.charCodeAt(0),u=l.charCodeAt(1),h=l.charCodeAt(2),p=l.charCodeAt(3),d=this.readData(4);return a===d[0]&&u===d[1]&&h===d[2]&&p===d[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,a},t.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var s=e("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var a,u=0;for(this.checkOffset(l),a=this.index+l-1;a>=this.index;a--)u=(u<<8)+this.byteAt(a);return this.index+=l,u},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},t.exports=o},{"../utils":32}],19:[function(e,t,n){"use strict";var s=e("./Uint8ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var a=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,a},t.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var s=e("./DataReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var a=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,a},t.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var s=e("./ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,a},t.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var s=e("../utils"),o=e("../support"),l=e("./ArrayReader"),a=e("./StringReader"),u=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");t.exports=function(p){var d=s.getTypeOf(p);return s.checkSupport(d),d!=="string"||o.uint8array?d==="nodebuffer"?new u(p):o.uint8array?new h(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new a(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";var s=e("./GenericWorker"),o=e("../utils");function l(a){s.call(this,"ConvertWorker to "+a),this.destType=a}o.inherits(l,s),l.prototype.processChunk=function(a){this.push({data:o.transformTo(this.destType,a.data),meta:a.meta})},t.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var s=e("./GenericWorker"),o=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(a){this.streamInfo.crc32=o(a.data,this.streamInfo.crc32||0),this.push(a)},t.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var s=e("../utils"),o=e("./GenericWorker");function l(a){o.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}s.inherits(l,o),l.prototype.processChunk=function(a){if(a){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+a.data.length}o.prototype.processChunk.call(this,a)},t.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var s=e("../utils"),o=e("./GenericWorker");function l(a){o.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(h){u.dataIsReady=!0,u.data=h,u.max=h&&h.length||0,u.type=s.getTypeOf(h),u.isPaused||u._tickAndRepeat()},function(h){u.error(h)})}s.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,u);break;case"uint8array":a=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":a=this.data.slice(this.index,u)}return this.index=u,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var a=0;a<this._listeners[o].length;a++)this._listeners[o][a].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(a){l.processChunk(a)}),o.on("end",function(){l.end()}),o.on("error",function(a){l.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},t.exports=s},{}],29:[function(e,t,n){"use strict";var s=e("../utils"),o=e("./ConvertWorker"),l=e("./GenericWorker"),a=e("../base64"),u=e("../support"),h=e("../external"),p=null;if(u.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(m,v){return new h.Promise(function(x,b){var w=[],L=m._internalType,D=m._outputType,G=m._mimeType;m.on("data",function(W,P){w.push(W),v&&v(P)}).on("error",function(W){w=[],b(W)}).on("end",function(){try{var W=function(P,j,V){switch(P){case"blob":return s.newBlob(s.transformTo("arraybuffer",j),V);case"base64":return a.encode(j);default:return s.transformTo(P,j)}}(D,function(P,j){var V,H=0,se=null,M=0;for(V=0;V<j.length;V++)M+=j[V].length;switch(P){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(se=new Uint8Array(M),V=0;V<j.length;V++)se.set(j[V],H),H+=j[V].length;return se;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+P+"'")}}(L,w),G);x(W)}catch(P){b(P)}w=[]}).resume()})}function _(m,v,x){var b=v;switch(v){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=v,this._mimeType=x,s.checkSupport(b),this._worker=m.pipe(new o(b)),m.lock()}catch(w){this._worker=new l("error"),this._worker.error(w)}}_.prototype={accumulate:function(m){return d(this,m)},on:function(m,v){var x=this;return m==="data"?this._worker.on(m,function(b){v.call(x,b.data,b.meta)}):this._worker.on(m,function(){s.delay(v,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},m)}},t.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var s=new ArrayBuffer(0);try{n.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),n.blob=o.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var s=e("./utils"),o=e("./support"),l=e("./nodejsUtils"),a=e("./stream/GenericWorker"),u=new Array(256),h=0;h<256;h++)u[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;u[254]=u[254]=1;function p(){a.call(this,"utf-8 decode"),this.leftOver=null}function d(){a.call(this,"utf-8 encode")}n.utf8encode=function(_){return o.nodebuffer?l.newBufferFrom(_,"utf-8"):function(m){var v,x,b,w,L,D=m.length,G=0;for(w=0;w<D;w++)(64512&(x=m.charCodeAt(w)))==55296&&w+1<D&&(64512&(b=m.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(b-56320),w++),G+=x<128?1:x<2048?2:x<65536?3:4;for(v=o.uint8array?new Uint8Array(G):new Array(G),w=L=0;L<G;w++)(64512&(x=m.charCodeAt(w)))==55296&&w+1<D&&(64512&(b=m.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(b-56320),w++),x<128?v[L++]=x:(x<2048?v[L++]=192|x>>>6:(x<65536?v[L++]=224|x>>>12:(v[L++]=240|x>>>18,v[L++]=128|x>>>12&63),v[L++]=128|x>>>6&63),v[L++]=128|63&x);return v}(_)},n.utf8decode=function(_){return o.nodebuffer?s.transformTo("nodebuffer",_).toString("utf-8"):function(m){var v,x,b,w,L=m.length,D=new Array(2*L);for(v=x=0;v<L;)if((b=m[v++])<128)D[x++]=b;else if(4<(w=u[b]))D[x++]=65533,v+=w-1;else{for(b&=w===2?31:w===3?15:7;1<w&&v<L;)b=b<<6|63&m[v++],w--;1<w?D[x++]=65533:b<65536?D[x++]=b:(b-=65536,D[x++]=55296|b>>10&1023,D[x++]=56320|1023&b)}return D.length!==x&&(D.subarray?D=D.subarray(0,x):D.length=x),s.applyFromCharCode(D)}(_=s.transformTo(o.uint8array?"uint8array":"array",_))},s.inherits(p,a),p.prototype.processChunk=function(_){var m=s.transformTo(o.uint8array?"uint8array":"array",_.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=m;(m=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),m.set(v,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var x=function(w,L){var D;for((L=L||w.length)>w.length&&(L=w.length),D=L-1;0<=D&&(192&w[D])==128;)D--;return D<0||D===0?L:D+u[w[D]]>L?D:L}(m),b=m;x!==m.length&&(o.uint8array?(b=m.subarray(0,x),this.leftOver=m.subarray(x,m.length)):(b=m.slice(0,x),this.leftOver=m.slice(x,m.length))),this.push({data:n.utf8decode(b),meta:_.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=p,s.inherits(d,a),d.prototype.processChunk=function(_){this.push({data:n.utf8encode(_.data),meta:_.meta})},n.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var s=e("./support"),o=e("./base64"),l=e("./nodejsUtils"),a=e("./external");function u(v){return v}function h(v,x){for(var b=0;b<v.length;++b)x[b]=255&v.charCodeAt(b);return x}e("setimmediate"),n.newBlob=function(v,x){n.checkSupport("blob");try{return new Blob([v],{type:x})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(v),b.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(v,x,b){var w=[],L=0,D=v.length;if(D<=b)return String.fromCharCode.apply(null,v);for(;L<D;)x==="array"||x==="nodebuffer"?w.push(String.fromCharCode.apply(null,v.slice(L,Math.min(L+b,D)))):w.push(String.fromCharCode.apply(null,v.subarray(L,Math.min(L+b,D)))),L+=b;return w.join("")},stringifyByChar:function(v){for(var x="",b=0;b<v.length;b++)x+=String.fromCharCode(v[b]);return x},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function d(v){var x=65536,b=n.getTypeOf(v),w=!0;if(b==="uint8array"?w=p.applyCanBeUsed.uint8array:b==="nodebuffer"&&(w=p.applyCanBeUsed.nodebuffer),w)for(;1<x;)try{return p.stringifyByChunk(v,b,x)}catch{x=Math.floor(x/2)}return p.stringifyByChar(v)}function _(v,x){for(var b=0;b<v.length;b++)x[b]=v[b];return x}n.applyFromCharCode=d;var m={};m.string={string:u,array:function(v){return h(v,new Array(v.length))},arraybuffer:function(v){return m.string.uint8array(v).buffer},uint8array:function(v){return h(v,new Uint8Array(v.length))},nodebuffer:function(v){return h(v,l.allocBuffer(v.length))}},m.array={string:d,array:u,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(v)}},m.arraybuffer={string:function(v){return d(new Uint8Array(v))},array:function(v){return _(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:u,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(new Uint8Array(v))}},m.uint8array={string:d,array:function(v){return _(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:u,nodebuffer:function(v){return l.newBufferFrom(v)}},m.nodebuffer={string:d,array:function(v){return _(v,new Array(v.length))},arraybuffer:function(v){return m.nodebuffer.uint8array(v).buffer},uint8array:function(v){return _(v,new Uint8Array(v.length))},nodebuffer:u},n.transformTo=function(v,x){if(x=x||"",!v)return x;n.checkSupport(v);var b=n.getTypeOf(x);return m[b][v](x)},n.resolve=function(v){for(var x=v.split("/"),b=[],w=0;w<x.length;w++){var L=x[w];L==="."||L===""&&w!==0&&w!==x.length-1||(L===".."?b.pop():b.push(L))}return b.join("/")},n.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(v){var x,b,w="";for(b=0;b<(v||"").length;b++)w+="\\x"+((x=v.charCodeAt(b))<16?"0":"")+x.toString(16).toUpperCase();return w},n.delay=function(v,x,b){setImmediate(function(){v.apply(b||null,x||[])})},n.inherits=function(v,x){function b(){}b.prototype=x.prototype,v.prototype=new b},n.extend=function(){var v,x,b={};for(v=0;v<arguments.length;v++)for(x in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],x)&&b[x]===void 0&&(b[x]=arguments[v][x]);return b},n.prepareContent=function(v,x,b,w,L){return a.Promise.resolve(x).then(function(D){return s.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader<"u"?new a.Promise(function(G,W){var P=new FileReader;P.onload=function(j){G(j.target.result)},P.onerror=function(j){W(j.target.error)},P.readAsArrayBuffer(D)}):D}).then(function(D){var G=n.getTypeOf(D);return G?(G==="arraybuffer"?D=n.transformTo("uint8array",D):G==="string"&&(L?D=o.decode(D):b&&w!==!0&&(D=function(W){return h(W,s.uint8array?new Uint8Array(W.length):new Array(W.length))}(D))),D):a.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var s=e("./reader/readerFor"),o=e("./utils"),l=e("./signature"),a=e("./zipEntry"),u=e("./support");function h(p){this.files=[],this.loadOptions=p}h.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(p)+")")}},isSignature:function(p,d){var _=this.reader.index;this.reader.setIndex(p);var m=this.reader.readString(4)===d;return this.reader.setIndex(_),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",_=o.transformTo(d,p);this.zipComment=this.loadOptions.decodeFileName(_)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,d,_,m=this.zip64EndOfCentralSize-44;0<m;)p=this.reader.readInt(2),d=this.reader.readInt(4),_=this.reader.readData(d),this.zip64ExtensibleData[p]={id:p,length:d,value:_}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,d;for(p=0;p<this.files.length;p++)d=this.files[p],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var d=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var _=this.centralDirOffset+this.centralDirSize;this.zip64&&(_+=20,_+=12+this.zip64EndOfCentralSize);var m=d-_;if(0<m)this.isSignature(d,l.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var s=e("./reader/readerFor"),o=e("./utils"),l=e("./compressedObject"),a=e("./crc32"),u=e("./utf8"),h=e("./compressions"),p=e("./support");function d(_,m){this.options=_,this.loadOptions=m}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(_){var m,v;if(_.skip(22),this.fileNameLength=_.readInt(2),v=_.readInt(2),this.fileName=_.readData(this.fileNameLength),_.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(x){for(var b in h)if(Object.prototype.hasOwnProperty.call(h,b)&&h[b].magic===x)return h[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,m,_.readData(this.compressedSize))},readCentralPart:function(_){this.versionMadeBy=_.readInt(2),_.skip(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4);var m=_.readInt(2);if(this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");_.skip(m),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var _=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),_==0&&(this.dosPermissions=63&this.externalFileAttributes),_==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var _=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=_.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=_.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=_.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=_.readInt(4))}},readExtraFields:function(_){var m,v,x,b=_.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});_.index+4<b;)m=_.readInt(2),v=_.readInt(2),x=_.readData(v),this.extraFields[m]={id:m,length:v,value:x};_.setIndex(b)},handleUTF8:function(){var _=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var v=o.transformTo(_,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var b=o.transformTo(_,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var m=s(_.value);return m.readInt(1)!==1||a(this.fileName)!==m.readInt(4)?null:u.utf8decode(m.readData(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var m=s(_.value);return m.readInt(1)!==1||a(this.fileComment)!==m.readInt(4)?null:u.utf8decode(m.readData(_.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function s(m,v,x){this.name=m,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=v,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var o=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),a=e("./utf8"),u=e("./compressedObject"),h=e("./stream/GenericWorker");s.prototype={internalStream:function(m){var v=null,x="string";try{if(!m)throw new Error("No output type specified.");var b=(x=m.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),v=this._decompressWorker();var w=!this._dataBinary;w&&!b&&(v=v.pipe(new a.Utf8EncodeWorker)),!w&&b&&(v=v.pipe(new a.Utf8DecodeWorker))}catch(L){(v=new h("error")).error(L)}return new o(v,x,"")},async:function(m,v){return this.internalStream(m).accumulate(v)},nodeStream:function(m,v){return this.internalStream(m||"nodebuffer").toNodejsStream(v)},_compressWorker:function(m,v){if(this._data instanceof u&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new a.Utf8EncodeWorker)),u.createWorkerFrom(x,m,v)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof h?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_=0;_<p.length;_++)s.prototype[p[_]]=d;t.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(s){"use strict";var o,l,a=s.MutationObserver||s.WebKitMutationObserver;if(a){var u=0,h=new a(m),p=s.document.createTextNode("");h.observe(p,{characterData:!0}),o=function(){p.data=u=++u%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){m(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(m,0)};else{var d=new s.MessageChannel;d.port1.onmessage=m,o=function(){d.port2.postMessage(0)}}var _=[];function m(){var v,x;l=!0;for(var b=_.length;b;){for(x=_,_=[],v=-1;++v<b;)x[v]();b=_.length}l=!1}t.exports=function(v){_.push(v)!==1||l||o()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,t,n){"use strict";var s=e("immediate");function o(){}var l={},a=["REJECTED"],u=["FULFILLED"],h=["PENDING"];function p(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,b!==o&&v(this,b)}function d(b,w,L){this.promise=b,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function _(b,w,L){s(function(){var D;try{D=w(L)}catch(G){return l.reject(b,G)}D===b?l.reject(b,new TypeError("Cannot resolve promise with itself")):l.resolve(b,D)})}function m(b){var w=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof w=="function")return function(){w.apply(b,arguments)}}function v(b,w){var L=!1;function D(P){L||(L=!0,l.reject(b,P))}function G(P){L||(L=!0,l.resolve(b,P))}var W=x(function(){w(G,D)});W.status==="error"&&D(W.value)}function x(b,w){var L={};try{L.value=b(w),L.status="success"}catch(D){L.status="error",L.value=D}return L}(t.exports=p).prototype.finally=function(b){if(typeof b!="function")return this;var w=this.constructor;return this.then(function(L){return w.resolve(b()).then(function(){return L})},function(L){return w.resolve(b()).then(function(){throw L})})},p.prototype.catch=function(b){return this.then(null,b)},p.prototype.then=function(b,w){if(typeof b!="function"&&this.state===u||typeof w!="function"&&this.state===a)return this;var L=new this.constructor(o);return this.state!==h?_(L,this.state===u?b:w,this.outcome):this.queue.push(new d(L,b,w)),L},d.prototype.callFulfilled=function(b){l.resolve(this.promise,b)},d.prototype.otherCallFulfilled=function(b){_(this.promise,this.onFulfilled,b)},d.prototype.callRejected=function(b){l.reject(this.promise,b)},d.prototype.otherCallRejected=function(b){_(this.promise,this.onRejected,b)},l.resolve=function(b,w){var L=x(m,w);if(L.status==="error")return l.reject(b,L.value);var D=L.value;if(D)v(b,D);else{b.state=u,b.outcome=w;for(var G=-1,W=b.queue.length;++G<W;)b.queue[G].callFulfilled(w)}return b},l.reject=function(b,w){b.state=a,b.outcome=w;for(var L=-1,D=b.queue.length;++L<D;)b.queue[L].callRejected(w);return b},p.resolve=function(b){return b instanceof this?b:l.resolve(new this(o),b)},p.reject=function(b){var w=new this(o);return l.reject(w,b)},p.all=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=b.length,D=!1;if(!L)return this.resolve([]);for(var G=new Array(L),W=0,P=-1,j=new this(o);++P<L;)V(b[P],P);return j;function V(H,se){w.resolve(H).then(function(M){G[se]=M,++W!==L||D||(D=!0,l.resolve(j,G))},function(M){D||(D=!0,l.reject(j,M))})}},p.race=function(b){var w=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=b.length,D=!1;if(!L)return this.resolve([]);for(var G=-1,W=new this(o);++G<L;)P=b[G],w.resolve(P).then(function(j){D||(D=!0,l.resolve(W,j))},function(j){D||(D=!0,l.reject(W,j))});var P;return W}},{immediate:36}],38:[function(e,t,n){"use strict";var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var s=e("./zlib/deflate"),o=e("./utils/common"),l=e("./utils/strings"),a=e("./zlib/messages"),u=e("./zlib/zstream"),h=Object.prototype.toString,p=0,d=-1,_=0,m=8;function v(b){if(!(this instanceof v))return new v(b);this.options=o.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},b||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var L=s.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(L!==p)throw new Error(a[L]);if(w.header&&s.deflateSetHeader(this.strm,w.header),w.dictionary){var D;if(D=typeof w.dictionary=="string"?l.string2buf(w.dictionary):h.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(L=s.deflateSetDictionary(this.strm,D))!==p)throw new Error(a[L]);this._dict_set=!0}}function x(b,w){var L=new v(w);if(L.push(b,!0),L.err)throw L.msg||a[L.err];return L.result}v.prototype.push=function(b,w){var L,D,G=this.strm,W=this.options.chunkSize;if(this.ended)return!1;D=w===~~w?w:w===!0?4:0,typeof b=="string"?G.input=l.string2buf(b):h.call(b)==="[object ArrayBuffer]"?G.input=new Uint8Array(b):G.input=b,G.next_in=0,G.avail_in=G.input.length;do{if(G.avail_out===0&&(G.output=new o.Buf8(W),G.next_out=0,G.avail_out=W),(L=s.deflate(G,D))!==1&&L!==p)return this.onEnd(L),!(this.ended=!0);G.avail_out!==0&&(G.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(G.output,G.next_out))):this.onData(o.shrinkBuf(G.output,G.next_out)))}while((0<G.avail_in||G.avail_out===0)&&L!==1);return D===4?(L=s.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===p):D!==2||(this.onEnd(p),!(G.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Deflate=v,n.deflate=x,n.deflateRaw=function(b,w){return(w=w||{}).raw=!0,x(b,w)},n.gzip=function(b,w){return(w=w||{}).gzip=!0,x(b,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var s=e("./zlib/inflate"),o=e("./utils/common"),l=e("./utils/strings"),a=e("./zlib/constants"),u=e("./zlib/messages"),h=e("./zlib/zstream"),p=e("./zlib/gzheader"),d=Object.prototype.toString;function _(v){if(!(this instanceof _))return new _(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||v&&v.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var b=s.inflateInit2(this.strm,x.windowBits);if(b!==a.Z_OK)throw new Error(u[b]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function m(v,x){var b=new _(x);if(b.push(v,!0),b.err)throw b.msg||u[b.err];return b.result}_.prototype.push=function(v,x){var b,w,L,D,G,W,P=this.strm,j=this.options.chunkSize,V=this.options.dictionary,H=!1;if(this.ended)return!1;w=x===~~x?x:x===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof v=="string"?P.input=l.binstring2buf(v):d.call(v)==="[object ArrayBuffer]"?P.input=new Uint8Array(v):P.input=v,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new o.Buf8(j),P.next_out=0,P.avail_out=j),(b=s.inflate(P,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&V&&(W=typeof V=="string"?l.string2buf(V):d.call(V)==="[object ArrayBuffer]"?new Uint8Array(V):V,b=s.inflateSetDictionary(this.strm,W)),b===a.Z_BUF_ERROR&&H===!0&&(b=a.Z_OK,H=!1),b!==a.Z_STREAM_END&&b!==a.Z_OK)return this.onEnd(b),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&b!==a.Z_STREAM_END&&(P.avail_in!==0||w!==a.Z_FINISH&&w!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=l.utf8border(P.output,P.next_out),D=P.next_out-L,G=l.buf2string(P.output,L),P.next_out=D,P.avail_out=j-D,D&&o.arraySet(P.output,P.output,L,D,0),this.onData(G)):this.onData(o.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(H=!0)}while((0<P.avail_in||P.avail_out===0)&&b!==a.Z_STREAM_END);return b===a.Z_STREAM_END&&(w=a.Z_FINISH),w===a.Z_FINISH?(b=s.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===a.Z_OK):w!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(P.avail_out=0))},_.prototype.onData=function(v){this.chunks.push(v)},_.prototype.onEnd=function(v){v===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},n.Inflate=_,n.inflate=m,n.inflateRaw=function(v,x){return(x=x||{}).raw=!0,m(v,x)},n.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(a){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var h=u.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var p in h)h.hasOwnProperty(p)&&(a[p]=h[p])}}return a},n.shrinkBuf=function(a,u){return a.length===u?a:a.subarray?a.subarray(0,u):(a.length=u,a)};var o={arraySet:function(a,u,h,p,d){if(u.subarray&&a.subarray)a.set(u.subarray(h,h+p),d);else for(var _=0;_<p;_++)a[d+_]=u[h+_]},flattenChunks:function(a){var u,h,p,d,_,m;for(u=p=0,h=a.length;u<h;u++)p+=a[u].length;for(m=new Uint8Array(p),u=d=0,h=a.length;u<h;u++)_=a[u],m.set(_,d),d+=_.length;return m}},l={arraySet:function(a,u,h,p,d){for(var _=0;_<p;_++)a[d+_]=u[h+_]},flattenChunks:function(a){return[].concat.apply([],a)}};n.setTyped=function(a){a?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,o)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,l))},n.setTyped(s)},{}],42:[function(e,t,n){"use strict";var s=e("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var a=new s.Buf8(256),u=0;u<256;u++)a[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function h(p,d){if(d<65537&&(p.subarray&&l||!p.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(p,d));for(var _="",m=0;m<d;m++)_+=String.fromCharCode(p[m]);return _}a[254]=a[254]=1,n.string2buf=function(p){var d,_,m,v,x,b=p.length,w=0;for(v=0;v<b;v++)(64512&(_=p.charCodeAt(v)))==55296&&v+1<b&&(64512&(m=p.charCodeAt(v+1)))==56320&&(_=65536+(_-55296<<10)+(m-56320),v++),w+=_<128?1:_<2048?2:_<65536?3:4;for(d=new s.Buf8(w),v=x=0;x<w;v++)(64512&(_=p.charCodeAt(v)))==55296&&v+1<b&&(64512&(m=p.charCodeAt(v+1)))==56320&&(_=65536+(_-55296<<10)+(m-56320),v++),_<128?d[x++]=_:(_<2048?d[x++]=192|_>>>6:(_<65536?d[x++]=224|_>>>12:(d[x++]=240|_>>>18,d[x++]=128|_>>>12&63),d[x++]=128|_>>>6&63),d[x++]=128|63&_);return d},n.buf2binstring=function(p){return h(p,p.length)},n.binstring2buf=function(p){for(var d=new s.Buf8(p.length),_=0,m=d.length;_<m;_++)d[_]=p.charCodeAt(_);return d},n.buf2string=function(p,d){var _,m,v,x,b=d||p.length,w=new Array(2*b);for(_=m=0;_<b;)if((v=p[_++])<128)w[m++]=v;else if(4<(x=a[v]))w[m++]=65533,_+=x-1;else{for(v&=x===2?31:x===3?15:7;1<x&&_<b;)v=v<<6|63&p[_++],x--;1<x?w[m++]=65533:v<65536?w[m++]=v:(v-=65536,w[m++]=55296|v>>10&1023,w[m++]=56320|1023&v)}return h(w,m)},n.utf8border=function(p,d){var _;for((d=d||p.length)>p.length&&(d=p.length),_=d-1;0<=_&&(192&p[_])==128;)_--;return _<0||_===0?d:_+a[p[_]]>d?_:d}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(s,o,l,a){for(var u=65535&s|0,h=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;h=h+(u=u+o[a++]|0)|0,--p;);u%=65521,h%=65521}return u|h<<16|0}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var s=function(){for(var o,l=[],a=0;a<256;a++){o=a;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[a]=o}return l}();t.exports=function(o,l,a,u){var h=s,p=u+a;o^=-1;for(var d=u;d<p;d++)o=o>>>8^h[255&(o^l[d])];return-1^o}},{}],46:[function(e,t,n){"use strict";var s,o=e("../utils/common"),l=e("./trees"),a=e("./adler32"),u=e("./crc32"),h=e("./messages"),p=0,d=4,_=0,m=-2,v=-1,x=4,b=2,w=8,L=9,D=286,G=30,W=19,P=2*D+1,j=15,V=3,H=258,se=H+V+1,M=42,ie=113,E=1,X=2,K=3,te=4;function Ge(C,Q){return C.msg=h[Q],Q}function ye(C){return(C<<1)-(4<C?9:0)}function Re(C){for(var Q=C.length;0<=--Q;)C[Q]=0}function U(C){var Q=C.state,ge=Q.pending;ge>C.avail_out&&(ge=C.avail_out),ge!==0&&(o.arraySet(C.output,Q.pending_buf,Q.pending_out,ge,C.next_out),C.next_out+=ge,Q.pending_out+=ge,C.total_out+=ge,C.avail_out-=ge,Q.pending-=ge,Q.pending===0&&(Q.pending_out=0))}function ce(C,Q){l._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,Q),C.block_start=C.strstart,U(C.strm)}function we(C,Q){C.pending_buf[C.pending++]=Q}function pe(C,Q){C.pending_buf[C.pending++]=Q>>>8&255,C.pending_buf[C.pending++]=255&Q}function Ee(C,Q){var ge,N,k=C.max_chain_length,O=C.strstart,Z=C.prev_length,ae=C.nice_match,J=C.strstart>C.w_size-se?C.strstart-(C.w_size-se):0,re=C.window,de=C.w_mask,me=C.prev,Ae=C.strstart+H,it=re[O+Z-1],Xe=re[O+Z];C.prev_length>=C.good_match&&(k>>=2),ae>C.lookahead&&(ae=C.lookahead);do if(re[(ge=Q)+Z]===Xe&&re[ge+Z-1]===it&&re[ge]===re[O]&&re[++ge]===re[O+1]){O+=2,ge++;do;while(re[++O]===re[++ge]&&re[++O]===re[++ge]&&re[++O]===re[++ge]&&re[++O]===re[++ge]&&re[++O]===re[++ge]&&re[++O]===re[++ge]&&re[++O]===re[++ge]&&re[++O]===re[++ge]&&O<Ae);if(N=H-(Ae-O),O=Ae-H,Z<N){if(C.match_start=Q,ae<=(Z=N))break;it=re[O+Z-1],Xe=re[O+Z]}}while((Q=me[Q&de])>J&&--k!=0);return Z<=C.lookahead?Z:C.lookahead}function Fe(C){var Q,ge,N,k,O,Z,ae,J,re,de,me=C.w_size;do{if(k=C.window_size-C.lookahead-C.strstart,C.strstart>=me+(me-se)){for(o.arraySet(C.window,C.window,me,me,0),C.match_start-=me,C.strstart-=me,C.block_start-=me,Q=ge=C.hash_size;N=C.head[--Q],C.head[Q]=me<=N?N-me:0,--ge;);for(Q=ge=me;N=C.prev[--Q],C.prev[Q]=me<=N?N-me:0,--ge;);k+=me}if(C.strm.avail_in===0)break;if(Z=C.strm,ae=C.window,J=C.strstart+C.lookahead,re=k,de=void 0,de=Z.avail_in,re<de&&(de=re),ge=de===0?0:(Z.avail_in-=de,o.arraySet(ae,Z.input,Z.next_in,de,J),Z.state.wrap===1?Z.adler=a(Z.adler,ae,de,J):Z.state.wrap===2&&(Z.adler=u(Z.adler,ae,de,J)),Z.next_in+=de,Z.total_in+=de,de),C.lookahead+=ge,C.lookahead+C.insert>=V)for(O=C.strstart-C.insert,C.ins_h=C.window[O],C.ins_h=(C.ins_h<<C.hash_shift^C.window[O+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[O+V-1])&C.hash_mask,C.prev[O&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=O,O++,C.insert--,!(C.lookahead+C.insert<V)););}while(C.lookahead<se&&C.strm.avail_in!==0)}function lt(C,Q){for(var ge,N;;){if(C.lookahead<se){if(Fe(C),C.lookahead<se&&Q===p)return E;if(C.lookahead===0)break}if(ge=0,C.lookahead>=V&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+V-1])&C.hash_mask,ge=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),ge!==0&&C.strstart-ge<=C.w_size-se&&(C.match_length=Ee(C,ge)),C.match_length>=V)if(N=l._tr_tally(C,C.strstart-C.match_start,C.match_length-V),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=V){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+V-1])&C.hash_mask,ge=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else N=l._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(N&&(ce(C,!1),C.strm.avail_out===0))return E}return C.insert=C.strstart<V-1?C.strstart:V-1,Q===d?(ce(C,!0),C.strm.avail_out===0?K:te):C.last_lit&&(ce(C,!1),C.strm.avail_out===0)?E:X}function qe(C,Q){for(var ge,N,k;;){if(C.lookahead<se){if(Fe(C),C.lookahead<se&&Q===p)return E;if(C.lookahead===0)break}if(ge=0,C.lookahead>=V&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+V-1])&C.hash_mask,ge=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=V-1,ge!==0&&C.prev_length<C.max_lazy_match&&C.strstart-ge<=C.w_size-se&&(C.match_length=Ee(C,ge),C.match_length<=5&&(C.strategy===1||C.match_length===V&&4096<C.strstart-C.match_start)&&(C.match_length=V-1)),C.prev_length>=V&&C.match_length<=C.prev_length){for(k=C.strstart+C.lookahead-V,N=l._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-V),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=k&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+V-1])&C.hash_mask,ge=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=V-1,C.strstart++,N&&(ce(C,!1),C.strm.avail_out===0))return E}else if(C.match_available){if((N=l._tr_tally(C,0,C.window[C.strstart-1]))&&ce(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return E}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(N=l._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<V-1?C.strstart:V-1,Q===d?(ce(C,!0),C.strm.avail_out===0?K:te):C.last_lit&&(ce(C,!1),C.strm.avail_out===0)?E:X}function rt(C,Q,ge,N,k){this.good_length=C,this.max_lazy=Q,this.nice_length=ge,this.max_chain=N,this.func=k}function Pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*P),this.dyn_dtree=new o.Buf16(2*(2*G+1)),this.bl_tree=new o.Buf16(2*(2*W+1)),Re(this.dyn_ltree),Re(this.dyn_dtree),Re(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(j+1),this.heap=new o.Buf16(2*D+1),Re(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*D+1),Re(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Je(C){var Q;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=b,(Q=C.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?M:ie,C.adler=Q.wrap===2?0:1,Q.last_flush=p,l._tr_init(Q),_):Ge(C,m)}function et(C){var Q=Je(C);return Q===_&&function(ge){ge.window_size=2*ge.w_size,Re(ge.head),ge.max_lazy_match=s[ge.level].max_lazy,ge.good_match=s[ge.level].good_length,ge.nice_match=s[ge.level].nice_length,ge.max_chain_length=s[ge.level].max_chain,ge.strstart=0,ge.block_start=0,ge.lookahead=0,ge.insert=0,ge.match_length=ge.prev_length=V-1,ge.match_available=0,ge.ins_h=0}(C.state),Q}function Be(C,Q,ge,N,k,O){if(!C)return m;var Z=1;if(Q===v&&(Q=6),N<0?(Z=0,N=-N):15<N&&(Z=2,N-=16),k<1||L<k||ge!==w||N<8||15<N||Q<0||9<Q||O<0||x<O)return Ge(C,m);N===8&&(N=9);var ae=new Pe;return(C.state=ae).strm=C,ae.wrap=Z,ae.gzhead=null,ae.w_bits=N,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=k+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+V-1)/V),ae.window=new o.Buf8(2*ae.w_size),ae.head=new o.Buf16(ae.hash_size),ae.prev=new o.Buf16(ae.w_size),ae.lit_bufsize=1<<k+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new o.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=Q,ae.strategy=O,ae.method=ge,et(C)}s=[new rt(0,0,0,0,function(C,Q){var ge=65535;for(ge>C.pending_buf_size-5&&(ge=C.pending_buf_size-5);;){if(C.lookahead<=1){if(Fe(C),C.lookahead===0&&Q===p)return E;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var N=C.block_start+ge;if((C.strstart===0||C.strstart>=N)&&(C.lookahead=C.strstart-N,C.strstart=N,ce(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-se&&(ce(C,!1),C.strm.avail_out===0))return E}return C.insert=0,Q===d?(ce(C,!0),C.strm.avail_out===0?K:te):(C.strstart>C.block_start&&(ce(C,!1),C.strm.avail_out),E)}),new rt(4,4,8,4,lt),new rt(4,5,16,8,lt),new rt(4,6,32,32,lt),new rt(4,4,16,16,qe),new rt(8,16,32,32,qe),new rt(8,16,128,128,qe),new rt(8,32,128,256,qe),new rt(32,128,258,1024,qe),new rt(32,258,258,4096,qe)],n.deflateInit=function(C,Q){return Be(C,Q,w,15,8,0)},n.deflateInit2=Be,n.deflateReset=et,n.deflateResetKeep=Je,n.deflateSetHeader=function(C,Q){return C&&C.state?C.state.wrap!==2?m:(C.state.gzhead=Q,_):m},n.deflate=function(C,Q){var ge,N,k,O;if(!C||!C.state||5<Q||Q<0)return C?Ge(C,m):m;if(N=C.state,!C.output||!C.input&&C.avail_in!==0||N.status===666&&Q!==d)return Ge(C,C.avail_out===0?-5:m);if(N.strm=C,ge=N.last_flush,N.last_flush=Q,N.status===M)if(N.wrap===2)C.adler=0,we(N,31),we(N,139),we(N,8),N.gzhead?(we(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),we(N,255&N.gzhead.time),we(N,N.gzhead.time>>8&255),we(N,N.gzhead.time>>16&255),we(N,N.gzhead.time>>24&255),we(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),we(N,255&N.gzhead.os),N.gzhead.extra&&N.gzhead.extra.length&&(we(N,255&N.gzhead.extra.length),we(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(C.adler=u(C.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=69):(we(N,0),we(N,0),we(N,0),we(N,0),we(N,0),we(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),we(N,3),N.status=ie);else{var Z=w+(N.w_bits-8<<4)<<8;Z|=(2<=N.strategy||N.level<2?0:N.level<6?1:N.level===6?2:3)<<6,N.strstart!==0&&(Z|=32),Z+=31-Z%31,N.status=ie,pe(N,Z),N.strstart!==0&&(pe(N,C.adler>>>16),pe(N,65535&C.adler)),C.adler=1}if(N.status===69)if(N.gzhead.extra){for(k=N.pending;N.gzindex<(65535&N.gzhead.extra.length)&&(N.pending!==N.pending_buf_size||(N.gzhead.hcrc&&N.pending>k&&(C.adler=u(C.adler,N.pending_buf,N.pending-k,k)),U(C),k=N.pending,N.pending!==N.pending_buf_size));)we(N,255&N.gzhead.extra[N.gzindex]),N.gzindex++;N.gzhead.hcrc&&N.pending>k&&(C.adler=u(C.adler,N.pending_buf,N.pending-k,k)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=73)}else N.status=73;if(N.status===73)if(N.gzhead.name){k=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>k&&(C.adler=u(C.adler,N.pending_buf,N.pending-k,k)),U(C),k=N.pending,N.pending===N.pending_buf_size)){O=1;break}O=N.gzindex<N.gzhead.name.length?255&N.gzhead.name.charCodeAt(N.gzindex++):0,we(N,O)}while(O!==0);N.gzhead.hcrc&&N.pending>k&&(C.adler=u(C.adler,N.pending_buf,N.pending-k,k)),O===0&&(N.gzindex=0,N.status=91)}else N.status=91;if(N.status===91)if(N.gzhead.comment){k=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>k&&(C.adler=u(C.adler,N.pending_buf,N.pending-k,k)),U(C),k=N.pending,N.pending===N.pending_buf_size)){O=1;break}O=N.gzindex<N.gzhead.comment.length?255&N.gzhead.comment.charCodeAt(N.gzindex++):0,we(N,O)}while(O!==0);N.gzhead.hcrc&&N.pending>k&&(C.adler=u(C.adler,N.pending_buf,N.pending-k,k)),O===0&&(N.status=103)}else N.status=103;if(N.status===103&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&U(C),N.pending+2<=N.pending_buf_size&&(we(N,255&C.adler),we(N,C.adler>>8&255),C.adler=0,N.status=ie)):N.status=ie),N.pending!==0){if(U(C),C.avail_out===0)return N.last_flush=-1,_}else if(C.avail_in===0&&ye(Q)<=ye(ge)&&Q!==d)return Ge(C,-5);if(N.status===666&&C.avail_in!==0)return Ge(C,-5);if(C.avail_in!==0||N.lookahead!==0||Q!==p&&N.status!==666){var ae=N.strategy===2?function(J,re){for(var de;;){if(J.lookahead===0&&(Fe(J),J.lookahead===0)){if(re===p)return E;break}if(J.match_length=0,de=l._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++,de&&(ce(J,!1),J.strm.avail_out===0))return E}return J.insert=0,re===d?(ce(J,!0),J.strm.avail_out===0?K:te):J.last_lit&&(ce(J,!1),J.strm.avail_out===0)?E:X}(N,Q):N.strategy===3?function(J,re){for(var de,me,Ae,it,Xe=J.window;;){if(J.lookahead<=H){if(Fe(J),J.lookahead<=H&&re===p)return E;if(J.lookahead===0)break}if(J.match_length=0,J.lookahead>=V&&0<J.strstart&&(me=Xe[Ae=J.strstart-1])===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]){it=J.strstart+H;do;while(me===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]&&me===Xe[++Ae]&&Ae<it);J.match_length=H-(it-Ae),J.match_length>J.lookahead&&(J.match_length=J.lookahead)}if(J.match_length>=V?(de=l._tr_tally(J,1,J.match_length-V),J.lookahead-=J.match_length,J.strstart+=J.match_length,J.match_length=0):(de=l._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++),de&&(ce(J,!1),J.strm.avail_out===0))return E}return J.insert=0,re===d?(ce(J,!0),J.strm.avail_out===0?K:te):J.last_lit&&(ce(J,!1),J.strm.avail_out===0)?E:X}(N,Q):s[N.level].func(N,Q);if(ae!==K&&ae!==te||(N.status=666),ae===E||ae===K)return C.avail_out===0&&(N.last_flush=-1),_;if(ae===X&&(Q===1?l._tr_align(N):Q!==5&&(l._tr_stored_block(N,0,0,!1),Q===3&&(Re(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),U(C),C.avail_out===0))return N.last_flush=-1,_}return Q!==d?_:N.wrap<=0?1:(N.wrap===2?(we(N,255&C.adler),we(N,C.adler>>8&255),we(N,C.adler>>16&255),we(N,C.adler>>24&255),we(N,255&C.total_in),we(N,C.total_in>>8&255),we(N,C.total_in>>16&255),we(N,C.total_in>>24&255)):(pe(N,C.adler>>>16),pe(N,65535&C.adler)),U(C),0<N.wrap&&(N.wrap=-N.wrap),N.pending!==0?_:1)},n.deflateEnd=function(C){var Q;return C&&C.state?(Q=C.state.status)!==M&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==ie&&Q!==666?Ge(C,m):(C.state=null,Q===ie?Ge(C,-3):_):m},n.deflateSetDictionary=function(C,Q){var ge,N,k,O,Z,ae,J,re,de=Q.length;if(!C||!C.state||(O=(ge=C.state).wrap)===2||O===1&&ge.status!==M||ge.lookahead)return m;for(O===1&&(C.adler=a(C.adler,Q,de,0)),ge.wrap=0,de>=ge.w_size&&(O===0&&(Re(ge.head),ge.strstart=0,ge.block_start=0,ge.insert=0),re=new o.Buf8(ge.w_size),o.arraySet(re,Q,de-ge.w_size,ge.w_size,0),Q=re,de=ge.w_size),Z=C.avail_in,ae=C.next_in,J=C.input,C.avail_in=de,C.next_in=0,C.input=Q,Fe(ge);ge.lookahead>=V;){for(N=ge.strstart,k=ge.lookahead-(V-1);ge.ins_h=(ge.ins_h<<ge.hash_shift^ge.window[N+V-1])&ge.hash_mask,ge.prev[N&ge.w_mask]=ge.head[ge.ins_h],ge.head[ge.ins_h]=N,N++,--k;);ge.strstart=N,ge.lookahead=V-1,Fe(ge)}return ge.strstart+=ge.lookahead,ge.block_start=ge.strstart,ge.insert=ge.lookahead,ge.lookahead=0,ge.match_length=ge.prev_length=V-1,ge.match_available=0,C.next_in=ae,C.input=J,C.avail_in=Z,ge.wrap=O,_},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(s,o){var l,a,u,h,p,d,_,m,v,x,b,w,L,D,G,W,P,j,V,H,se,M,ie,E,X;l=s.state,a=s.next_in,E=s.input,u=a+(s.avail_in-5),h=s.next_out,X=s.output,p=h-(o-s.avail_out),d=h+(s.avail_out-257),_=l.dmax,m=l.wsize,v=l.whave,x=l.wnext,b=l.window,w=l.hold,L=l.bits,D=l.lencode,G=l.distcode,W=(1<<l.lenbits)-1,P=(1<<l.distbits)-1;e:do{L<15&&(w+=E[a++]<<L,L+=8,w+=E[a++]<<L,L+=8),j=D[w&W];t:for(;;){if(w>>>=V=j>>>24,L-=V,(V=j>>>16&255)===0)X[h++]=65535&j;else{if(!(16&V)){if(!(64&V)){j=D[(65535&j)+(w&(1<<V)-1)];continue t}if(32&V){l.mode=12;break e}s.msg="invalid literal/length code",l.mode=30;break e}H=65535&j,(V&=15)&&(L<V&&(w+=E[a++]<<L,L+=8),H+=w&(1<<V)-1,w>>>=V,L-=V),L<15&&(w+=E[a++]<<L,L+=8,w+=E[a++]<<L,L+=8),j=G[w&P];n:for(;;){if(w>>>=V=j>>>24,L-=V,!(16&(V=j>>>16&255))){if(!(64&V)){j=G[(65535&j)+(w&(1<<V)-1)];continue n}s.msg="invalid distance code",l.mode=30;break e}if(se=65535&j,L<(V&=15)&&(w+=E[a++]<<L,(L+=8)<V&&(w+=E[a++]<<L,L+=8)),_<(se+=w&(1<<V)-1)){s.msg="invalid distance too far back",l.mode=30;break e}if(w>>>=V,L-=V,(V=h-p)<se){if(v<(V=se-V)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break e}if(ie=b,(M=0)===x){if(M+=m-V,V<H){for(H-=V;X[h++]=b[M++],--V;);M=h-se,ie=X}}else if(x<V){if(M+=m+x-V,(V-=x)<H){for(H-=V;X[h++]=b[M++],--V;);if(M=0,x<H){for(H-=V=x;X[h++]=b[M++],--V;);M=h-se,ie=X}}}else if(M+=x-V,V<H){for(H-=V;X[h++]=b[M++],--V;);M=h-se,ie=X}for(;2<H;)X[h++]=ie[M++],X[h++]=ie[M++],X[h++]=ie[M++],H-=3;H&&(X[h++]=ie[M++],1<H&&(X[h++]=ie[M++]))}else{for(M=h-se;X[h++]=X[M++],X[h++]=X[M++],X[h++]=X[M++],2<(H-=3););H&&(X[h++]=X[M++],1<H&&(X[h++]=X[M++]))}break}}break}}while(a<u&&h<d);a-=H=L>>3,w&=(1<<(L-=H<<3))-1,s.next_in=a,s.next_out=h,s.avail_in=a<u?u-a+5:5-(a-u),s.avail_out=h<d?d-h+257:257-(h-d),l.hold=w,l.bits=L}},{}],49:[function(e,t,n){"use strict";var s=e("../utils/common"),o=e("./adler32"),l=e("./crc32"),a=e("./inffast"),u=e("./inftrees"),h=1,p=2,d=0,_=-2,m=1,v=852,x=592;function b(M){return(M>>>24&255)+(M>>>8&65280)+((65280&M)<<8)+((255&M)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(M){var ie;return M&&M.state?(ie=M.state,M.total_in=M.total_out=ie.total=0,M.msg="",ie.wrap&&(M.adler=1&ie.wrap),ie.mode=m,ie.last=0,ie.havedict=0,ie.dmax=32768,ie.head=null,ie.hold=0,ie.bits=0,ie.lencode=ie.lendyn=new s.Buf32(v),ie.distcode=ie.distdyn=new s.Buf32(x),ie.sane=1,ie.back=-1,d):_}function D(M){var ie;return M&&M.state?((ie=M.state).wsize=0,ie.whave=0,ie.wnext=0,L(M)):_}function G(M,ie){var E,X;return M&&M.state?(X=M.state,ie<0?(E=0,ie=-ie):(E=1+(ie>>4),ie<48&&(ie&=15)),ie&&(ie<8||15<ie)?_:(X.window!==null&&X.wbits!==ie&&(X.window=null),X.wrap=E,X.wbits=ie,D(M))):_}function W(M,ie){var E,X;return M?(X=new w,(M.state=X).window=null,(E=G(M,ie))!==d&&(M.state=null),E):_}var P,j,V=!0;function H(M){if(V){var ie;for(P=new s.Buf32(512),j=new s.Buf32(32),ie=0;ie<144;)M.lens[ie++]=8;for(;ie<256;)M.lens[ie++]=9;for(;ie<280;)M.lens[ie++]=7;for(;ie<288;)M.lens[ie++]=8;for(u(h,M.lens,0,288,P,0,M.work,{bits:9}),ie=0;ie<32;)M.lens[ie++]=5;u(p,M.lens,0,32,j,0,M.work,{bits:5}),V=!1}M.lencode=P,M.lenbits=9,M.distcode=j,M.distbits=5}function se(M,ie,E,X){var K,te=M.state;return te.window===null&&(te.wsize=1<<te.wbits,te.wnext=0,te.whave=0,te.window=new s.Buf8(te.wsize)),X>=te.wsize?(s.arraySet(te.window,ie,E-te.wsize,te.wsize,0),te.wnext=0,te.whave=te.wsize):(X<(K=te.wsize-te.wnext)&&(K=X),s.arraySet(te.window,ie,E-X,K,te.wnext),(X-=K)?(s.arraySet(te.window,ie,E-X,X,0),te.wnext=X,te.whave=te.wsize):(te.wnext+=K,te.wnext===te.wsize&&(te.wnext=0),te.whave<te.wsize&&(te.whave+=K))),0}n.inflateReset=D,n.inflateReset2=G,n.inflateResetKeep=L,n.inflateInit=function(M){return W(M,15)},n.inflateInit2=W,n.inflate=function(M,ie){var E,X,K,te,Ge,ye,Re,U,ce,we,pe,Ee,Fe,lt,qe,rt,Pe,Je,et,Be,C,Q,ge,N,k=0,O=new s.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&M.avail_in!==0)return _;(E=M.state).mode===12&&(E.mode=13),Ge=M.next_out,K=M.output,Re=M.avail_out,te=M.next_in,X=M.input,ye=M.avail_in,U=E.hold,ce=E.bits,we=ye,pe=Re,Q=d;e:for(;;)switch(E.mode){case m:if(E.wrap===0){E.mode=13;break}for(;ce<16;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(2&E.wrap&&U===35615){O[E.check=0]=255&U,O[1]=U>>>8&255,E.check=l(E.check,O,2,0),ce=U=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&U)<<8)+(U>>8))%31){M.msg="incorrect header check",E.mode=30;break}if((15&U)!=8){M.msg="unknown compression method",E.mode=30;break}if(ce-=4,C=8+(15&(U>>>=4)),E.wbits===0)E.wbits=C;else if(C>E.wbits){M.msg="invalid window size",E.mode=30;break}E.dmax=1<<C,M.adler=E.check=1,E.mode=512&U?10:12,ce=U=0;break;case 2:for(;ce<16;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(E.flags=U,(255&E.flags)!=8){M.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){M.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=U>>8&1),512&E.flags&&(O[0]=255&U,O[1]=U>>>8&255,E.check=l(E.check,O,2,0)),ce=U=0,E.mode=3;case 3:for(;ce<32;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}E.head&&(E.head.time=U),512&E.flags&&(O[0]=255&U,O[1]=U>>>8&255,O[2]=U>>>16&255,O[3]=U>>>24&255,E.check=l(E.check,O,4,0)),ce=U=0,E.mode=4;case 4:for(;ce<16;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}E.head&&(E.head.xflags=255&U,E.head.os=U>>8),512&E.flags&&(O[0]=255&U,O[1]=U>>>8&255,E.check=l(E.check,O,2,0)),ce=U=0,E.mode=5;case 5:if(1024&E.flags){for(;ce<16;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}E.length=U,E.head&&(E.head.extra_len=U),512&E.flags&&(O[0]=255&U,O[1]=U>>>8&255,E.check=l(E.check,O,2,0)),ce=U=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(ye<(Ee=E.length)&&(Ee=ye),Ee&&(E.head&&(C=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),s.arraySet(E.head.extra,X,te,Ee,C)),512&E.flags&&(E.check=l(E.check,X,Ee,te)),ye-=Ee,te+=Ee,E.length-=Ee),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(ye===0)break e;for(Ee=0;C=X[te+Ee++],E.head&&C&&E.length<65536&&(E.head.name+=String.fromCharCode(C)),C&&Ee<ye;);if(512&E.flags&&(E.check=l(E.check,X,Ee,te)),ye-=Ee,te+=Ee,C)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(ye===0)break e;for(Ee=0;C=X[te+Ee++],E.head&&C&&E.length<65536&&(E.head.comment+=String.fromCharCode(C)),C&&Ee<ye;);if(512&E.flags&&(E.check=l(E.check,X,Ee,te)),ye-=Ee,te+=Ee,C)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;ce<16;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(U!==(65535&E.check)){M.msg="header crc mismatch",E.mode=30;break}ce=U=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),M.adler=E.check=0,E.mode=12;break;case 10:for(;ce<32;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}M.adler=E.check=b(U),ce=U=0,E.mode=11;case 11:if(E.havedict===0)return M.next_out=Ge,M.avail_out=Re,M.next_in=te,M.avail_in=ye,E.hold=U,E.bits=ce,2;M.adler=E.check=1,E.mode=12;case 12:if(ie===5||ie===6)break e;case 13:if(E.last){U>>>=7&ce,ce-=7&ce,E.mode=27;break}for(;ce<3;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}switch(E.last=1&U,ce-=1,3&(U>>>=1)){case 0:E.mode=14;break;case 1:if(H(E),E.mode=20,ie!==6)break;U>>>=2,ce-=2;break e;case 2:E.mode=17;break;case 3:M.msg="invalid block type",E.mode=30}U>>>=2,ce-=2;break;case 14:for(U>>>=7&ce,ce-=7&ce;ce<32;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if((65535&U)!=(U>>>16^65535)){M.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&U,ce=U=0,E.mode=15,ie===6)break e;case 15:E.mode=16;case 16:if(Ee=E.length){if(ye<Ee&&(Ee=ye),Re<Ee&&(Ee=Re),Ee===0)break e;s.arraySet(K,X,te,Ee,Ge),ye-=Ee,te+=Ee,Re-=Ee,Ge+=Ee,E.length-=Ee;break}E.mode=12;break;case 17:for(;ce<14;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(E.nlen=257+(31&U),U>>>=5,ce-=5,E.ndist=1+(31&U),U>>>=5,ce-=5,E.ncode=4+(15&U),U>>>=4,ce-=4,286<E.nlen||30<E.ndist){M.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;ce<3;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}E.lens[Z[E.have++]]=7&U,U>>>=3,ce-=3}for(;E.have<19;)E.lens[Z[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,ge={bits:E.lenbits},Q=u(0,E.lens,0,19,E.lencode,0,E.work,ge),E.lenbits=ge.bits,Q){M.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;rt=(k=E.lencode[U&(1<<E.lenbits)-1])>>>16&255,Pe=65535&k,!((qe=k>>>24)<=ce);){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(Pe<16)U>>>=qe,ce-=qe,E.lens[E.have++]=Pe;else{if(Pe===16){for(N=qe+2;ce<N;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(U>>>=qe,ce-=qe,E.have===0){M.msg="invalid bit length repeat",E.mode=30;break}C=E.lens[E.have-1],Ee=3+(3&U),U>>>=2,ce-=2}else if(Pe===17){for(N=qe+3;ce<N;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}ce-=qe,C=0,Ee=3+(7&(U>>>=qe)),U>>>=3,ce-=3}else{for(N=qe+7;ce<N;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}ce-=qe,C=0,Ee=11+(127&(U>>>=qe)),U>>>=7,ce-=7}if(E.have+Ee>E.nlen+E.ndist){M.msg="invalid bit length repeat",E.mode=30;break}for(;Ee--;)E.lens[E.have++]=C}}if(E.mode===30)break;if(E.lens[256]===0){M.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,ge={bits:E.lenbits},Q=u(h,E.lens,0,E.nlen,E.lencode,0,E.work,ge),E.lenbits=ge.bits,Q){M.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,ge={bits:E.distbits},Q=u(p,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,ge),E.distbits=ge.bits,Q){M.msg="invalid distances set",E.mode=30;break}if(E.mode=20,ie===6)break e;case 20:E.mode=21;case 21:if(6<=ye&&258<=Re){M.next_out=Ge,M.avail_out=Re,M.next_in=te,M.avail_in=ye,E.hold=U,E.bits=ce,a(M,pe),Ge=M.next_out,K=M.output,Re=M.avail_out,te=M.next_in,X=M.input,ye=M.avail_in,U=E.hold,ce=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;rt=(k=E.lencode[U&(1<<E.lenbits)-1])>>>16&255,Pe=65535&k,!((qe=k>>>24)<=ce);){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(rt&&!(240&rt)){for(Je=qe,et=rt,Be=Pe;rt=(k=E.lencode[Be+((U&(1<<Je+et)-1)>>Je)])>>>16&255,Pe=65535&k,!(Je+(qe=k>>>24)<=ce);){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}U>>>=Je,ce-=Je,E.back+=Je}if(U>>>=qe,ce-=qe,E.back+=qe,E.length=Pe,rt===0){E.mode=26;break}if(32&rt){E.back=-1,E.mode=12;break}if(64&rt){M.msg="invalid literal/length code",E.mode=30;break}E.extra=15&rt,E.mode=22;case 22:if(E.extra){for(N=E.extra;ce<N;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}E.length+=U&(1<<E.extra)-1,U>>>=E.extra,ce-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;rt=(k=E.distcode[U&(1<<E.distbits)-1])>>>16&255,Pe=65535&k,!((qe=k>>>24)<=ce);){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(!(240&rt)){for(Je=qe,et=rt,Be=Pe;rt=(k=E.distcode[Be+((U&(1<<Je+et)-1)>>Je)])>>>16&255,Pe=65535&k,!(Je+(qe=k>>>24)<=ce);){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}U>>>=Je,ce-=Je,E.back+=Je}if(U>>>=qe,ce-=qe,E.back+=qe,64&rt){M.msg="invalid distance code",E.mode=30;break}E.offset=Pe,E.extra=15&rt,E.mode=24;case 24:if(E.extra){for(N=E.extra;ce<N;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}E.offset+=U&(1<<E.extra)-1,U>>>=E.extra,ce-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){M.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(Re===0)break e;if(Ee=pe-Re,E.offset>Ee){if((Ee=E.offset-Ee)>E.whave&&E.sane){M.msg="invalid distance too far back",E.mode=30;break}Fe=Ee>E.wnext?(Ee-=E.wnext,E.wsize-Ee):E.wnext-Ee,Ee>E.length&&(Ee=E.length),lt=E.window}else lt=K,Fe=Ge-E.offset,Ee=E.length;for(Re<Ee&&(Ee=Re),Re-=Ee,E.length-=Ee;K[Ge++]=lt[Fe++],--Ee;);E.length===0&&(E.mode=21);break;case 26:if(Re===0)break e;K[Ge++]=E.length,Re--,E.mode=21;break;case 27:if(E.wrap){for(;ce<32;){if(ye===0)break e;ye--,U|=X[te++]<<ce,ce+=8}if(pe-=Re,M.total_out+=pe,E.total+=pe,pe&&(M.adler=E.check=E.flags?l(E.check,K,pe,Ge-pe):o(E.check,K,pe,Ge-pe)),pe=Re,(E.flags?U:b(U))!==E.check){M.msg="incorrect data check",E.mode=30;break}ce=U=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;ce<32;){if(ye===0)break e;ye--,U+=X[te++]<<ce,ce+=8}if(U!==(4294967295&E.total)){M.msg="incorrect length check",E.mode=30;break}ce=U=0}E.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return _}return M.next_out=Ge,M.avail_out=Re,M.next_in=te,M.avail_in=ye,E.hold=U,E.bits=ce,(E.wsize||pe!==M.avail_out&&E.mode<30&&(E.mode<27||ie!==4))&&se(M,M.output,M.next_out,pe-M.avail_out)?(E.mode=31,-4):(we-=M.avail_in,pe-=M.avail_out,M.total_in+=we,M.total_out+=pe,E.total+=pe,E.wrap&&pe&&(M.adler=E.check=E.flags?l(E.check,K,pe,M.next_out-pe):o(E.check,K,pe,M.next_out-pe)),M.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(we==0&&pe===0||ie===4)&&Q===d&&(Q=-5),Q)},n.inflateEnd=function(M){if(!M||!M.state)return _;var ie=M.state;return ie.window&&(ie.window=null),M.state=null,d},n.inflateGetHeader=function(M,ie){var E;return M&&M.state&&2&(E=M.state).wrap?((E.head=ie).done=!1,d):_},n.inflateSetDictionary=function(M,ie){var E,X=ie.length;return M&&M.state?(E=M.state).wrap!==0&&E.mode!==11?_:E.mode===11&&o(1,ie,X,0)!==E.check?-3:se(M,ie,X,X)?(E.mode=31,-4):(E.havedict=1,d):_},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(h,p,d,_,m,v,x,b){var w,L,D,G,W,P,j,V,H,se=b.bits,M=0,ie=0,E=0,X=0,K=0,te=0,Ge=0,ye=0,Re=0,U=0,ce=null,we=0,pe=new s.Buf16(16),Ee=new s.Buf16(16),Fe=null,lt=0;for(M=0;M<=15;M++)pe[M]=0;for(ie=0;ie<_;ie++)pe[p[d+ie]]++;for(K=se,X=15;1<=X&&pe[X]===0;X--);if(X<K&&(K=X),X===0)return m[v++]=20971520,m[v++]=20971520,b.bits=1,0;for(E=1;E<X&&pe[E]===0;E++);for(K<E&&(K=E),M=ye=1;M<=15;M++)if(ye<<=1,(ye-=pe[M])<0)return-1;if(0<ye&&(h===0||X!==1))return-1;for(Ee[1]=0,M=1;M<15;M++)Ee[M+1]=Ee[M]+pe[M];for(ie=0;ie<_;ie++)p[d+ie]!==0&&(x[Ee[p[d+ie]]++]=ie);if(P=h===0?(ce=Fe=x,19):h===1?(ce=o,we-=257,Fe=l,lt-=257,256):(ce=a,Fe=u,-1),M=E,W=v,Ge=ie=U=0,D=-1,G=(Re=1<<(te=K))-1,h===1&&852<Re||h===2&&592<Re)return 1;for(;;){for(j=M-Ge,H=x[ie]<P?(V=0,x[ie]):x[ie]>P?(V=Fe[lt+x[ie]],ce[we+x[ie]]):(V=96,0),w=1<<M-Ge,E=L=1<<te;m[W+(U>>Ge)+(L-=w)]=j<<24|V<<16|H|0,L!==0;);for(w=1<<M-1;U&w;)w>>=1;if(w!==0?(U&=w-1,U+=w):U=0,ie++,--pe[M]==0){if(M===X)break;M=p[d+x[ie]]}if(K<M&&(U&G)!==D){for(Ge===0&&(Ge=K),W+=E,ye=1<<(te=M-Ge);te+Ge<X&&!((ye-=pe[te+Ge])<=0);)te++,ye<<=1;if(Re+=1<<te,h===1&&852<Re||h===2&&592<Re)return 1;m[D=U&G]=K<<24|te<<16|W-v|0}}return U!==0&&(m[W+U]=M-Ge<<24|64<<16|0),b.bits=K,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var s=e("../utils/common"),o=0,l=1;function a(k){for(var O=k.length;0<=--O;)k[O]=0}var u=0,h=29,p=256,d=p+1+h,_=30,m=19,v=2*d+1,x=15,b=16,w=7,L=256,D=16,G=17,W=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=new Array(2*(d+2));a(se);var M=new Array(2*_);a(M);var ie=new Array(512);a(ie);var E=new Array(256);a(E);var X=new Array(h);a(X);var K,te,Ge,ye=new Array(_);function Re(k,O,Z,ae,J){this.static_tree=k,this.extra_bits=O,this.extra_base=Z,this.elems=ae,this.max_length=J,this.has_stree=k&&k.length}function U(k,O){this.dyn_tree=k,this.max_code=0,this.stat_desc=O}function ce(k){return k<256?ie[k]:ie[256+(k>>>7)]}function we(k,O){k.pending_buf[k.pending++]=255&O,k.pending_buf[k.pending++]=O>>>8&255}function pe(k,O,Z){k.bi_valid>b-Z?(k.bi_buf|=O<<k.bi_valid&65535,we(k,k.bi_buf),k.bi_buf=O>>b-k.bi_valid,k.bi_valid+=Z-b):(k.bi_buf|=O<<k.bi_valid&65535,k.bi_valid+=Z)}function Ee(k,O,Z){pe(k,Z[2*O],Z[2*O+1])}function Fe(k,O){for(var Z=0;Z|=1&k,k>>>=1,Z<<=1,0<--O;);return Z>>>1}function lt(k,O,Z){var ae,J,re=new Array(x+1),de=0;for(ae=1;ae<=x;ae++)re[ae]=de=de+Z[ae-1]<<1;for(J=0;J<=O;J++){var me=k[2*J+1];me!==0&&(k[2*J]=Fe(re[me]++,me))}}function qe(k){var O;for(O=0;O<d;O++)k.dyn_ltree[2*O]=0;for(O=0;O<_;O++)k.dyn_dtree[2*O]=0;for(O=0;O<m;O++)k.bl_tree[2*O]=0;k.dyn_ltree[2*L]=1,k.opt_len=k.static_len=0,k.last_lit=k.matches=0}function rt(k){8<k.bi_valid?we(k,k.bi_buf):0<k.bi_valid&&(k.pending_buf[k.pending++]=k.bi_buf),k.bi_buf=0,k.bi_valid=0}function Pe(k,O,Z,ae){var J=2*O,re=2*Z;return k[J]<k[re]||k[J]===k[re]&&ae[O]<=ae[Z]}function Je(k,O,Z){for(var ae=k.heap[Z],J=Z<<1;J<=k.heap_len&&(J<k.heap_len&&Pe(O,k.heap[J+1],k.heap[J],k.depth)&&J++,!Pe(O,ae,k.heap[J],k.depth));)k.heap[Z]=k.heap[J],Z=J,J<<=1;k.heap[Z]=ae}function et(k,O,Z){var ae,J,re,de,me=0;if(k.last_lit!==0)for(;ae=k.pending_buf[k.d_buf+2*me]<<8|k.pending_buf[k.d_buf+2*me+1],J=k.pending_buf[k.l_buf+me],me++,ae===0?Ee(k,J,O):(Ee(k,(re=E[J])+p+1,O),(de=P[re])!==0&&pe(k,J-=X[re],de),Ee(k,re=ce(--ae),Z),(de=j[re])!==0&&pe(k,ae-=ye[re],de)),me<k.last_lit;);Ee(k,L,O)}function Be(k,O){var Z,ae,J,re=O.dyn_tree,de=O.stat_desc.static_tree,me=O.stat_desc.has_stree,Ae=O.stat_desc.elems,it=-1;for(k.heap_len=0,k.heap_max=v,Z=0;Z<Ae;Z++)re[2*Z]!==0?(k.heap[++k.heap_len]=it=Z,k.depth[Z]=0):re[2*Z+1]=0;for(;k.heap_len<2;)re[2*(J=k.heap[++k.heap_len]=it<2?++it:0)]=1,k.depth[J]=0,k.opt_len--,me&&(k.static_len-=de[2*J+1]);for(O.max_code=it,Z=k.heap_len>>1;1<=Z;Z--)Je(k,re,Z);for(J=Ae;Z=k.heap[1],k.heap[1]=k.heap[k.heap_len--],Je(k,re,1),ae=k.heap[1],k.heap[--k.heap_max]=Z,k.heap[--k.heap_max]=ae,re[2*J]=re[2*Z]+re[2*ae],k.depth[J]=(k.depth[Z]>=k.depth[ae]?k.depth[Z]:k.depth[ae])+1,re[2*Z+1]=re[2*ae+1]=J,k.heap[1]=J++,Je(k,re,1),2<=k.heap_len;);k.heap[--k.heap_max]=k.heap[1],function(Xe,mn){var Hn,tt,Jn,at,Js,xn,Ci=mn.dyn_tree,_s=mn.max_code,St=mn.stat_desc.static_tree,Ii=mn.stat_desc.has_stree,_n=mn.stat_desc.extra_bits,vo=mn.stat_desc.extra_base,yt=mn.stat_desc.max_length,Tn=0;for(at=0;at<=x;at++)Xe.bl_count[at]=0;for(Ci[2*Xe.heap[Xe.heap_max]+1]=0,Hn=Xe.heap_max+1;Hn<v;Hn++)yt<(at=Ci[2*Ci[2*(tt=Xe.heap[Hn])+1]+1]+1)&&(at=yt,Tn++),Ci[2*tt+1]=at,_s<tt||(Xe.bl_count[at]++,Js=0,vo<=tt&&(Js=_n[tt-vo]),xn=Ci[2*tt],Xe.opt_len+=xn*(at+Js),Ii&&(Xe.static_len+=xn*(St[2*tt+1]+Js)));if(Tn!==0){do{for(at=yt-1;Xe.bl_count[at]===0;)at--;Xe.bl_count[at]--,Xe.bl_count[at+1]+=2,Xe.bl_count[yt]--,Tn-=2}while(0<Tn);for(at=yt;at!==0;at--)for(tt=Xe.bl_count[at];tt!==0;)_s<(Jn=Xe.heap[--Hn])||(Ci[2*Jn+1]!==at&&(Xe.opt_len+=(at-Ci[2*Jn+1])*Ci[2*Jn],Ci[2*Jn+1]=at),tt--)}}(k,O),lt(re,it,k.bl_count)}function C(k,O,Z){var ae,J,re=-1,de=O[1],me=0,Ae=7,it=4;for(de===0&&(Ae=138,it=3),O[2*(Z+1)+1]=65535,ae=0;ae<=Z;ae++)J=de,de=O[2*(ae+1)+1],++me<Ae&&J===de||(me<it?k.bl_tree[2*J]+=me:J!==0?(J!==re&&k.bl_tree[2*J]++,k.bl_tree[2*D]++):me<=10?k.bl_tree[2*G]++:k.bl_tree[2*W]++,re=J,it=(me=0)===de?(Ae=138,3):J===de?(Ae=6,3):(Ae=7,4))}function Q(k,O,Z){var ae,J,re=-1,de=O[1],me=0,Ae=7,it=4;for(de===0&&(Ae=138,it=3),ae=0;ae<=Z;ae++)if(J=de,de=O[2*(ae+1)+1],!(++me<Ae&&J===de)){if(me<it)for(;Ee(k,J,k.bl_tree),--me!=0;);else J!==0?(J!==re&&(Ee(k,J,k.bl_tree),me--),Ee(k,D,k.bl_tree),pe(k,me-3,2)):me<=10?(Ee(k,G,k.bl_tree),pe(k,me-3,3)):(Ee(k,W,k.bl_tree),pe(k,me-11,7));re=J,it=(me=0)===de?(Ae=138,3):J===de?(Ae=6,3):(Ae=7,4)}}a(ye);var ge=!1;function N(k,O,Z,ae){pe(k,(u<<1)+(ae?1:0),3),function(J,re,de,me){rt(J),me&&(we(J,de),we(J,~de)),s.arraySet(J.pending_buf,J.window,re,de,J.pending),J.pending+=de}(k,O,Z,!0)}n._tr_init=function(k){ge||(function(){var O,Z,ae,J,re,de=new Array(x+1);for(J=ae=0;J<h-1;J++)for(X[J]=ae,O=0;O<1<<P[J];O++)E[ae++]=J;for(E[ae-1]=J,J=re=0;J<16;J++)for(ye[J]=re,O=0;O<1<<j[J];O++)ie[re++]=J;for(re>>=7;J<_;J++)for(ye[J]=re<<7,O=0;O<1<<j[J]-7;O++)ie[256+re++]=J;for(Z=0;Z<=x;Z++)de[Z]=0;for(O=0;O<=143;)se[2*O+1]=8,O++,de[8]++;for(;O<=255;)se[2*O+1]=9,O++,de[9]++;for(;O<=279;)se[2*O+1]=7,O++,de[7]++;for(;O<=287;)se[2*O+1]=8,O++,de[8]++;for(lt(se,d+1,de),O=0;O<_;O++)M[2*O+1]=5,M[2*O]=Fe(O,5);K=new Re(se,P,p+1,d,x),te=new Re(M,j,0,_,x),Ge=new Re(new Array(0),V,0,m,w)}(),ge=!0),k.l_desc=new U(k.dyn_ltree,K),k.d_desc=new U(k.dyn_dtree,te),k.bl_desc=new U(k.bl_tree,Ge),k.bi_buf=0,k.bi_valid=0,qe(k)},n._tr_stored_block=N,n._tr_flush_block=function(k,O,Z,ae){var J,re,de=0;0<k.level?(k.strm.data_type===2&&(k.strm.data_type=function(me){var Ae,it=4093624447;for(Ae=0;Ae<=31;Ae++,it>>>=1)if(1&it&&me.dyn_ltree[2*Ae]!==0)return o;if(me.dyn_ltree[18]!==0||me.dyn_ltree[20]!==0||me.dyn_ltree[26]!==0)return l;for(Ae=32;Ae<p;Ae++)if(me.dyn_ltree[2*Ae]!==0)return l;return o}(k)),Be(k,k.l_desc),Be(k,k.d_desc),de=function(me){var Ae;for(C(me,me.dyn_ltree,me.l_desc.max_code),C(me,me.dyn_dtree,me.d_desc.max_code),Be(me,me.bl_desc),Ae=m-1;3<=Ae&&me.bl_tree[2*H[Ae]+1]===0;Ae--);return me.opt_len+=3*(Ae+1)+5+5+4,Ae}(k),J=k.opt_len+3+7>>>3,(re=k.static_len+3+7>>>3)<=J&&(J=re)):J=re=Z+5,Z+4<=J&&O!==-1?N(k,O,Z,ae):k.strategy===4||re===J?(pe(k,2+(ae?1:0),3),et(k,se,M)):(pe(k,4+(ae?1:0),3),function(me,Ae,it,Xe){var mn;for(pe(me,Ae-257,5),pe(me,it-1,5),pe(me,Xe-4,4),mn=0;mn<Xe;mn++)pe(me,me.bl_tree[2*H[mn]+1],3);Q(me,me.dyn_ltree,Ae-1),Q(me,me.dyn_dtree,it-1)}(k,k.l_desc.max_code+1,k.d_desc.max_code+1,de+1),et(k,k.dyn_ltree,k.dyn_dtree)),qe(k),ae&&rt(k)},n._tr_tally=function(k,O,Z){return k.pending_buf[k.d_buf+2*k.last_lit]=O>>>8&255,k.pending_buf[k.d_buf+2*k.last_lit+1]=255&O,k.pending_buf[k.l_buf+k.last_lit]=255&Z,k.last_lit++,O===0?k.dyn_ltree[2*Z]++:(k.matches++,O--,k.dyn_ltree[2*(E[Z]+p+1)]++,k.dyn_dtree[2*ce(O)]++),k.last_lit===k.lit_bufsize-1},n._tr_align=function(k){pe(k,2,3),Ee(k,L,se),function(O){O.bi_valid===16?(we(O,O.bi_buf),O.bi_buf=0,O.bi_valid=0):8<=O.bi_valid&&(O.pending_buf[O.pending++]=255&O.bi_buf,O.bi_buf>>=8,O.bi_valid-=8)}(k)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(s){(function(o,l){"use strict";if(!o.setImmediate){var a,u,h,p,d=1,_={},m=!1,v=o.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(o);x=x&&x.setTimeout?x:o,a={}.toString.call(o.process)==="[object process]"?function(D){process.nextTick(function(){w(D)})}:function(){if(o.postMessage&&!o.importScripts){var D=!0,G=o.onmessage;return o.onmessage=function(){D=!1},o.postMessage("","*"),o.onmessage=G,D}}()?(p="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",L,!1):o.attachEvent("onmessage",L),function(D){o.postMessage(p+D,"*")}):o.MessageChannel?((h=new MessageChannel).port1.onmessage=function(D){w(D.data)},function(D){h.port2.postMessage(D)}):v&&"onreadystatechange"in v.createElement("script")?(u=v.documentElement,function(D){var G=v.createElement("script");G.onreadystatechange=function(){w(D),G.onreadystatechange=null,u.removeChild(G),G=null},u.appendChild(G)}):function(D){setTimeout(w,0,D)},x.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var G=new Array(arguments.length-1),W=0;W<G.length;W++)G[W]=arguments[W+1];var P={callback:D,args:G};return _[d]=P,a(d),d++},x.clearImmediate=b}function b(D){delete _[D]}function w(D){if(m)setTimeout(w,0,D);else{var G=_[D];if(G){m=!0;try{(function(W){var P=W.callback,j=W.args;switch(j.length){case 0:P();break;case 1:P(j[0]);break;case 2:P(j[0],j[1]);break;case 3:P(j[0],j[1],j[2]);break;default:P.apply(l,j)}})(G)}finally{b(D),m=!1}}}}function L(D){D.source===o&&typeof D.data=="string"&&D.data.indexOf(p)===0&&w(+D.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});function QS(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var KS=R(()=>{});var zs,Vs,jr,JS,hd,Qy,eE,Ky,Da,xe,tE,nE,iE,Te,bn,Pi,Lt,Bo,dn,xt=R(()=>{zs=1,Vs=2,jr=3,JS=4,hd=5,Qy=6378137,eE=6356752314e-3,Ky=.0066943799901413165,Da=484813681109536e-20,xe=Math.PI/2,tE=.16666666666666666,nE=.04722222222222222,iE=.022156084656084655,Te=1e-10,bn=.017453292519943295,Pi=57.29577951308232,Lt=Math.PI/4,Bo=Math.PI*2,dn=3.14159265359});var Fi,sE,rE=R(()=>{Fi={};Fi.greenwich=0;Fi.lisbon=-9.131906111111;Fi.paris=2.337229166667;Fi.bogota=-74.080916666667;Fi.madrid=-3.687938888889;Fi.rome=12.452333333333;Fi.bern=7.439583333333;Fi.jakarta=106.807719444444;Fi.ferro=-17.666666666667;Fi.brussels=4.367975;Fi.stockholm=18.058277777778;Fi.athens=23.7163375;Fi.oslo=10.722916666667;sE=Fi});var oE,aE=R(()=>{oE={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}}});function cs(e,t){if(e[t])return e[t];for(var n=Object.keys(e),s=t.toLowerCase().replace(lE,""),o=-1,l,a;++o<n.length;)if(l=n[o],a=l.toLowerCase().replace(lE,""),a===s)return e[l]}var lE,fd=R(()=>{lE=/[\s_\-\/\(\)]/g});function pd(e){var t={},n=e.split("+").map(function(u){return u.trim()}).filter(function(u){return u}).reduce(function(u,h){var p=h.split("=");return p.push(!0),u[p[0].toLowerCase()]=p[1],u},{}),s,o,l,a={proj:"projName",datum:"datumCode",rf:function(u){t.rf=parseFloat(u)},lat_0:function(u){t.lat0=u*bn},lat_1:function(u){t.lat1=u*bn},lat_2:function(u){t.lat2=u*bn},lat_ts:function(u){t.lat_ts=u*bn},lon_0:function(u){t.long0=u*bn},lon_1:function(u){t.long1=u*bn},lon_2:function(u){t.long2=u*bn},alpha:function(u){t.alpha=parseFloat(u)*bn},gamma:function(u){t.rectified_grid_angle=parseFloat(u)*bn},lonc:function(u){t.longc=u*bn},x_0:function(u){t.x0=parseFloat(u)},y_0:function(u){t.y0=parseFloat(u)},k_0:function(u){t.k0=parseFloat(u)},k:function(u){t.k0=parseFloat(u)},a:function(u){t.a=parseFloat(u)},b:function(u){t.b=parseFloat(u)},r:function(u){t.a=t.b=parseFloat(u)},r_a:function(){t.R_A=!0},zone:function(u){t.zone=parseInt(u,10)},south:function(){t.utmSouth=!0},towgs84:function(u){t.datum_params=u.split(",").map(function(h){return parseFloat(h)})},to_meter:function(u){t.to_meter=parseFloat(u)},units:function(u){t.units=u;var h=cs(oE,u);h&&(t.to_meter=h.to_meter)},from_greenwich:function(u){t.from_greenwich=u*bn},pm:function(u){var h=cs(sE,u);t.from_greenwich=(h||parseFloat(u))*bn},nadgrids:function(u){u==="@null"?t.datumCode="none":t.nadgrids=u},axis:function(u){var h="ewnsud";u.length===3&&h.indexOf(u.substr(0,1))!==-1&&h.indexOf(u.substr(1,1))!==-1&&h.indexOf(u.substr(2,1))!==-1&&(t.axis=u)},approx:function(){t.approx=!0}};for(s in n)o=n[s],s in a?(l=a[s],typeof l=="function"?l(o):t[l]=o):t[s]=o;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t}var Jy=R(()=>{xt();rE();aE();fd()});var e0,Ep,t0=R(()=>{e0=class{static getId(t){let n=t.find(s=>Array.isArray(s)&&s[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(t,n="unit"){if(!t||t.length<3)return{type:n,name:"unknown",conversion_factor:null};let s=t[1],o=parseFloat(t[2])||null,l=t.find(u=>Array.isArray(u)&&u[0]==="ID"),a=l?{authority:l[1],code:parseInt(l[2],10)}:null;return{type:n,name:s,conversion_factor:o,id:a}}static convertAxis(t){let n=t[1]||"Unknown",s,o=n.match(/^\((.)\)$/);if(o){let p=o[1].toUpperCase();if(p==="E")s="east";else if(p==="N")s="north";else if(p==="U")s="up";else throw new Error(`Unknown axis abbreviation: ${p}`)}else s=t[2]?t[2].toLowerCase():"unknown";let l=t.find(p=>Array.isArray(p)&&p[0]==="ORDER"),a=l?parseInt(l[1],10):null,u=t.find(p=>Array.isArray(p)&&(p[0]==="LENGTHUNIT"||p[0]==="ANGLEUNIT"||p[0]==="SCALEUNIT")),h=this.convertUnit(u);return{name:n,direction:s,unit:h,order:a}}static extractAxes(t){return t.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,s)=>(n.order||0)-(s.order||0))}static convert(t,n={}){switch(t[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=t[1],n.base_crs=t.find(v=>Array.isArray(v)&&v[0]==="BASEGEOGCRS")?this.convert(t.find(v=>Array.isArray(v)&&v[0]==="BASEGEOGCRS")):null,n.conversion=t.find(v=>Array.isArray(v)&&v[0]==="CONVERSION")?this.convert(t.find(v=>Array.isArray(v)&&v[0]==="CONVERSION")):null;let s=t.find(v=>Array.isArray(v)&&v[0]==="CS");s&&(n.coordinate_system={type:s[1],axis:this.extractAxes(t)});let o=t.find(v=>Array.isArray(v)&&v[0]==="LENGTHUNIT");if(o){let v=this.convertUnit(o);n.coordinate_system.unit=v}n.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=t[1];let l=t.find(v=>Array.isArray(v)&&(v[0]==="DATUM"||v[0]==="ENSEMBLE"));if(l){let v=this.convert(l);l[0]==="ENSEMBLE"?n.datum_ensemble=v:n.datum=v;let x=t.find(b=>Array.isArray(b)&&b[0]==="PRIMEM");x&&x[1]!=="Greenwich"&&(v.prime_meridian={name:x[1],longitude:parseFloat(x[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},n.id=this.getId(t);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=t[1],n.ellipsoid=t.find(v=>Array.isArray(v)&&v[0]==="ELLIPSOID")?this.convert(t.find(v=>Array.isArray(v)&&v[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=t[1],n.members=t.filter(v=>Array.isArray(v)&&v[0]==="MEMBER").map(v=>({type:"DatumEnsembleMember",name:v[1],id:this.getId(v)}));let a=t.find(v=>Array.isArray(v)&&v[0]==="ENSEMBLEACCURACY");a&&(n.accuracy=parseFloat(a[1]));let u=t.find(v=>Array.isArray(v)&&v[0]==="ELLIPSOID");u&&(n.ellipsoid=this.convert(u)),n.id=this.getId(t);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=t[1],n.semi_major_axis=parseFloat(t[2]),n.inverse_flattening=parseFloat(t[3]);let h=t.find(v=>Array.isArray(v)&&v[0]==="LENGTHUNIT")?this.convert(t.find(v=>Array.isArray(v)&&v[0]==="LENGTHUNIT"),n):null;break;case"CONVERSION":n.type="Conversion",n.name=t[1],n.method=t.find(v=>Array.isArray(v)&&v[0]==="METHOD")?this.convert(t.find(v=>Array.isArray(v)&&v[0]==="METHOD")):null,n.parameters=t.filter(v=>Array.isArray(v)&&v[0]==="PARAMETER").map(v=>this.convert(v));break;case"METHOD":n.type="Method",n.name=t[1],n.id=this.getId(t);break;case"PARAMETER":n.type="Parameter",n.name=t[1],n.value=parseFloat(t[2]),n.unit=this.convertUnit(t.find(v=>Array.isArray(v)&&(v[0]==="LENGTHUNIT"||v[0]==="ANGLEUNIT"||v[0]==="SCALEUNIT"))),n.id=this.getId(t);break;case"BOUNDCRS":n.type="BoundCRS";let p=t.find(v=>Array.isArray(v)&&v[0]==="SOURCECRS");if(p){let v=p.find(x=>Array.isArray(x));n.source_crs=v?this.convert(v):null}let d=t.find(v=>Array.isArray(v)&&v[0]==="TARGETCRS");if(d){let v=d.find(x=>Array.isArray(x));n.target_crs=v?this.convert(v):null}let _=t.find(v=>Array.isArray(v)&&v[0]==="ABRIDGEDTRANSFORMATION");_?n.transformation=this.convert(_):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=t[1],n.method=t.find(v=>Array.isArray(v)&&v[0]==="METHOD")?this.convert(t.find(v=>Array.isArray(v)&&v[0]==="METHOD")):null,n.parameters=t.filter(v=>Array.isArray(v)&&(v[0]==="PARAMETER"||v[0]==="PARAMETERFILE")).map(v=>{if(v[0]==="PARAMETER")return this.convert(v);if(v[0]==="PARAMETERFILE")return{name:v[1],value:v[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){let v=n.parameters[6];v.name==="Scale difference"&&(v.value=Math.round((v.value-1)*1e12)/1e6)}n.id=this.getId(t);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":let m=this.convertUnit(t,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(v=>{v.unit||(v.unit=m)}),m.conversion_factor&&m.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:m});break;default:n.keyword=t[0];break}return n}},Ep=e0});var n0,cE,uE=R(()=>{t0();n0=class extends Ep{static convert(t,n={}){return super.convert(t,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}},cE=n0});var i0,dE,hE=R(()=>{t0();i0=class extends Ep{static convert(t,n={}){super.convert(t,n);let s=t.find(l=>Array.isArray(l)&&l[0]==="CS");s&&(n.coordinate_system={subtype:s[1],axis:this.extractAxes(t)});let o=t.find(l=>Array.isArray(l)&&l[0]==="USAGE");if(o){let l=o.find(h=>Array.isArray(h)&&h[0]==="SCOPE"),a=o.find(h=>Array.isArray(h)&&h[0]==="AREA"),u=o.find(h=>Array.isArray(h)&&h[0]==="BBOX");n.usage={},l&&(n.usage.scope=l[1]),a&&(n.usage.area=a[1]),u&&(n.usage.bbox=u.slice(1))}return n}},dE=i0});function cF(e){return e.find(t=>Array.isArray(t)&&t[0]==="USAGE")?"2019":(e.find(t=>Array.isArray(t)&&t[0]==="CS")||e[0]==="BOUNDCRS"||e[0]==="PROJCRS"||e[0]==="GEOGCRS","2015")}function fE(e){return(cF(e)==="2019"?dE:cE).convert(e)}var pE=R(()=>{uE();hE()});function gE(e){let t=e.toUpperCase();return t.includes("PROJCRS")||t.includes("GEOGCRS")||t.includes("BOUNDCRS")||t.includes("VERTCRS")||t.includes("LENGTHUNIT")||t.includes("ANGLEUNIT")||t.includes("SCALEUNIT")?"WKT2":(t.includes("PROJCS")||t.includes("GEOGCS")||t.includes("LOCAL_CS")||t.includes("VERT_CS")||t.includes("UNIT"),"WKT1")}var mE=R(()=>{});function qr(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=gd}function fF(e){var t=new qr(e);return t.output()}var _E,gd,yE,vE,Cp,bE,s0,uF,dF,hF,Ip,xE,wE=R(()=>{_E=fF,gd=1,yE=2,vE=3,Cp=4,bE=5,s0=-1,uF=/\s/,dF=/[A-Za-z]/,hF=/[A-Za-z84_]/,Ip=/[,\]]/,xE=/[\d\.E\-\+]/;qr.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==Cp)for(;uF.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case gd:return this.neutral(e);case yE:return this.keyword(e);case Cp:return this.quoted(e);case bE:return this.afterquote(e);case vE:return this.number(e);case s0:return}};qr.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=Cp;return}if(Ip.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};qr.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=gd;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=gd,this.currentObject=this.stack.pop(),this.currentObject||(this.state=s0);return}};qr.prototype.number=function(e){if(xE.test(e)){this.word+=e;return}if(Ip.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};qr.prototype.quoted=function(e){if(e==='"'){this.state=bE;return}this.word+=e};qr.prototype.keyword=function(e){if(hF.test(e)){this.word+=e;return}if(e==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=gd;return}if(Ip.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};qr.prototype.neutral=function(e){if(dF.test(e)){this.word=e,this.state=yE;return}if(e==='"'){this.word="",this.state=Cp;return}if(xE.test(e)){this.word=e,this.state=vE;return}if(Ip.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};qr.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===s0)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)}});function r0(e,t,n){Array.isArray(t)&&(n.unshift(t),t=null);var s=t?{}:e,o=n.reduce(function(l,a){return Ga(a,l),l},s);t&&(e[t]=o)}function Ga(e,t){if(!Array.isArray(e)){t[e]=!0;return}var n=e.shift();if(n==="PARAMETER"&&(n=e.shift()),e.length===1){if(Array.isArray(e[0])){t[n]={},Ga(e[0],t[n]);return}t[n]=e[0];return}if(!e.length){t[n]=!0;return}if(n==="TOWGS84"){t[n]=e;return}if(n==="AXIS"){n in t||(t[n]=[]),t[n].push(e);return}Array.isArray(n)||(t[n]={});var s;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[n]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&Ga(e[2],t[n]);return;case"SPHEROID":case"ELLIPSOID":t[n]={name:e[0],a:e[1],rf:e[2]},e.length===4&&Ga(e[3],t[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],r0(t,n,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],r0(t,n,e),t[n].type=n;return;default:for(s=-1;++s<e.length;)if(!Array.isArray(e[s]))return Ga(e,t[n]);return r0(t,n,e)}}var SE=R(()=>{});function Es(e){return e*pF}function Lp(e){let t=(e.projName||"").toLowerCase().replace(/_/g," ");!e.long0&&e.longc&&(t==="albers conic equal area"||t==="lambert azimuthal equal area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(t==="stereographic south pole"||t==="polar stereographic (variant b)")?(e.lat0=Es(e.lat1>0?90:-90),e.lat_ts=e.lat1,delete e.lat1):!e.lat_ts&&e.lat0&&(t==="polar stereographic"||t==="polar stereographic (variant a)")&&(e.lat_ts=e.lat0,e.lat0=Es(e.lat0>0?90:-90),delete e.lat1)}var pF,o0=R(()=>{pF=.017453292519943295});function EE(e){let t={units:null,to_meter:void 0};return typeof e=="string"?(t.units=e.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.units==="meter"&&(t.to_meter=1)):e&&e.name&&(t.units=e.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.to_meter=e.conversion_factor),t}function CE(e){return typeof e=="object"?e.value*e.unit.conversion_factor:e}function IE(e,t){e.ellipsoid.radius?(t.a=e.ellipsoid.radius,t.rf=0):(t.a=CE(e.ellipsoid.semi_major_axis),e.ellipsoid.inverse_flattening!==void 0?t.rf=e.ellipsoid.inverse_flattening:e.ellipsoid.semi_major_axis!==void 0&&e.ellipsoid.semi_minor_axis!==void 0&&(t.rf=t.a/(t.a-CE(e.ellipsoid.semi_minor_axis))))}function md(e,t={}){return!e||typeof e!="object"?e:e.type==="BoundCRS"?(md(e.source_crs,t),e.transformation&&(e.transformation.method&&e.transformation.method.name==="NTv2"?t.nadgrids=e.transformation.parameters[0].value:t.datum_params=e.transformation.parameters.map(n=>n.value)),t):(Object.keys(e).forEach(n=>{let s=e[n];if(s!==null)switch(n){case"name":if(t.srsCode)break;t.name=s,t.srsCode=s;break;case"type":s==="GeographicCRS"?t.projName="longlat":s==="ProjectedCRS"&&e.conversion&&e.conversion.method&&(t.projName=e.conversion.method.name);break;case"datum":case"datum_ensemble":s.ellipsoid&&(t.ellps=s.ellipsoid.name,IE(s,t)),s.prime_meridian&&(t.from_greenwich=s.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":t.ellps=s.name,IE(s,t);break;case"prime_meridian":t.long0=(s.longitude||0)*Math.PI/180;break;case"coordinate_system":if(s.axis){if(t.axis=s.axis.map(o=>{let l=o.direction;if(l==="east")return"e";if(l==="north")return"n";if(l==="west")return"w";if(l==="south")return"s";throw new Error(`Unknown axis direction: ${l}`)}).join("")+"u",s.unit){let{units:o,to_meter:l}=EE(s.unit);t.units=o,t.to_meter=l}else if(s.axis[0]&&s.axis[0].unit){let{units:o,to_meter:l}=EE(s.axis[0].unit);t.units=o,t.to_meter=l}}break;case"id":s.authority&&s.code&&(t.title=s.authority+":"+s.code);break;case"conversion":s.method&&s.method.name&&(t.projName=s.method.name),s.parameters&&s.parameters.forEach(o=>{let l=o.name.toLowerCase().replace(/\s+/g,"_"),a=o.value;o.unit&&o.unit.conversion_factor?t[l]=a*o.unit.conversion_factor:o.unit==="degree"?t[l]=a*Math.PI/180:t[l]=a});break;case"unit":s.name&&(t.units=s.name.toLowerCase(),t.units==="metre"&&(t.units="meter")),s.conversion_factor&&(t.to_meter=s.conversion_factor);break;case"base_crs":md(s,t),t.datumCode=s.id?s.id.authority+"_"+s.id.code:s.name;break;default:break}}),t.latitude_of_false_origin!==void 0&&(t.lat0=t.latitude_of_false_origin),t.longitude_of_false_origin!==void 0&&(t.long0=t.longitude_of_false_origin),t.latitude_of_standard_parallel!==void 0&&(t.lat0=t.latitude_of_standard_parallel,t.lat1=t.latitude_of_standard_parallel),t.latitude_of_1st_standard_parallel!==void 0&&(t.lat1=t.latitude_of_1st_standard_parallel),t.latitude_of_2nd_standard_parallel!==void 0&&(t.lat2=t.latitude_of_2nd_standard_parallel),t.latitude_of_projection_centre!==void 0&&(t.lat0=t.latitude_of_projection_centre),t.longitude_of_projection_centre!==void 0&&(t.longc=t.longitude_of_projection_centre),t.easting_at_false_origin!==void 0&&(t.x0=t.easting_at_false_origin),t.northing_at_false_origin!==void 0&&(t.y0=t.northing_at_false_origin),t.latitude_of_natural_origin!==void 0&&(t.lat0=t.latitude_of_natural_origin),t.longitude_of_natural_origin!==void 0&&(t.long0=t.longitude_of_natural_origin),t.longitude_of_origin!==void 0&&(t.long0=t.longitude_of_origin),t.false_easting!==void 0&&(t.x0=t.false_easting),t.easting_at_projection_centre&&(t.x0=t.easting_at_projection_centre),t.false_northing!==void 0&&(t.y0=t.false_northing),t.northing_at_projection_centre&&(t.y0=t.northing_at_projection_centre),t.standard_parallel_1!==void 0&&(t.lat1=t.standard_parallel_1),t.standard_parallel_2!==void 0&&(t.lat2=t.standard_parallel_2),t.scale_factor_at_natural_origin!==void 0&&(t.k0=t.scale_factor_at_natural_origin),t.scale_factor_at_projection_centre!==void 0&&(t.k0=t.scale_factor_at_projection_centre),t.scale_factor_on_pseudo_standard_parallel!==void 0&&(t.k0=t.scale_factor_on_pseudo_standard_parallel),t.azimuth!==void 0&&(t.alpha=t.azimuth),t.azimuth_at_projection_centre!==void 0&&(t.alpha=t.azimuth_at_projection_centre),t.angle_from_rectified_to_skew_grid&&(t.rectified_grid_angle=t.angle_from_rectified_to_skew_grid),Lp(t),t)}var LE=R(()=>{o0()});function mF(e,t){var n=t[0],s=t[1];!(n in e)&&s in e&&(e[n]=e[s],t.length===3&&(e[n]=t[2](e[n])))}function NE(e){for(var t=Object.keys(e),n=0,s=t.length;n<s;++n){var o=t[n];gF.indexOf(o)!==-1&&_F(e[o]),typeof e[o]=="object"&&NE(e[o])}}function _F(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var n="",s=0,o=e.AXIS.length;s<o;++s){var l=[e.AXIS[s][0].toLowerCase(),e.AXIS[s][1].toLowerCase()];l[0].indexOf("north")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="north"?n+="n":l[0].indexOf("south")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="south"?n+="s":l[0].indexOf("east")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="east"?n+="e":(l[0].indexOf("west")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(e.axis=n)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var a=e.GEOGCS;e.type==="GEOGCS"&&(a=e),a&&(a.DATUM?e.datumCode=a.DATUM.name.toLowerCase():e.datumCode=a.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(e.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=a.DATUM.SPHEROID.a,e.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(e.datum_params=a.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),e.rectified_grid_angle&&(e.rectified_grid_angle=Es(e.rectified_grid_angle));function u(d){var _=e.to_meter||1;return d*_}var h=function(d){return mF(e,d)},p=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Es],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Es],["x0","false_easting",u],["y0","false_northing",u],["long0","central_meridian",Es],["lat0","latitude_of_origin",Es],["lat0","standard_parallel_1",Es],["lat1","standard_parallel_1",Es],["lat2","standard_parallel_2",Es],["azimuth","Azimuth"],["alpha","azimuth",Es],["srsCode","name"]];p.forEach(h),Lp(e)}function _d(e){if(typeof e=="object")return md(e);let t=gE(e);var n=_E(e);if(t==="WKT2"){let l=fE(n);return md(l)}var s=n[0],o={};return Ga(n,o),NE(o),o[s]}var gF,a0=R(()=>{pE();mE();wE();SE();LE();o0();gF=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"]});function Cs(e){var t=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?Cs[e]=pd(arguments[1]):Cs[e]=_d(arguments[1]):Cs[e]=n}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(s){return Array.isArray(s)?Cs.apply(t,s):Cs(s)});if(typeof e=="string"){if(e in Cs)return Cs[e]}else"EPSG"in e?Cs["EPSG:"+e.EPSG]=e:"ESRI"in e?Cs["ESRI:"+e.ESRI]=e:"IAU2000"in e?Cs["IAU2000:"+e.IAU2000]=e:console.log(e);return}}var Yl,l0=R(()=>{KS();Jy();a0();QS(Cs);Yl=Cs});function yF(e){return typeof e=="string"}function vF(e){return e in Yl}function bF(e){return e.indexOf("+")!==0&&e.indexOf("[")!==-1||typeof e=="object"&&!("srsCode"in e)}function wF(e){var t=cs(e,"authority");if(t){var n=cs(t,"epsg");return n&&xF.indexOf(n)>-1}}function SF(e){var t=cs(e,"extension");if(t)return cs(t,"proj4")}function EF(e){return e[0]==="+"}function CF(e){if(yF(e)){if(vF(e))return Yl[e];if(bF(e)){var t=_d(e);if(wF(t))return Yl["EPSG:3857"];var n=SF(t);return n?pd(n):t}if(EF(e))return pd(e)}else return"projName"in e?e:_d(e)}var xF,TE,kE=R(()=>{l0();a0();Jy();fd();xF=["3857","900913","3785","102113"];TE=CF});function c0(e,t){e=e||{};var n,s;if(!t)return e;for(s in t)n=t[s],n!==void 0&&(e[s]=n);return e}var RE=R(()=>{});function ai(e,t,n){var s=e*t;return n/Math.sqrt(1-s*s)}var ja=R(()=>{});function hr(e){return e<0?-1:1}var Xl=R(()=>{});function Ne(e){return Math.abs(e)<=dn?e:e-hr(e)*Bo}var qt=R(()=>{xt();Xl()});function yi(e,t,n){var s=e*n,o=.5*e;return s=Math.pow((1-s)/(1+s),o),Math.tan(.5*(xe-t))/s}var yd=R(()=>{xt()});function $r(e,t){for(var n=.5*e,s,o,l=xe-2*Math.atan(t),a=0;a<=15;a++)if(s=e*Math.sin(l),o=xe-2*Math.atan(t*Math.pow((1-s)/(1+s),n))-l,l+=o,Math.abs(o)<=1e-10)return l;return-9999}var vd=R(()=>{xt()});function IF(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ai(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function LF(e){var t=e.x,n=e.y;if(n*Pi>90&&n*Pi<-90&&t*Pi>180&&t*Pi<-180)return null;var s,o;if(Math.abs(Math.abs(n)-xe)<=Te)return null;if(this.sphere)s=this.x0+this.a*this.k0*Ne(t-this.long0),o=this.y0+this.a*this.k0*Math.log(Math.tan(Lt+.5*n));else{var l=Math.sin(n),a=yi(this.e,n,l);s=this.x0+this.a*this.k0*Ne(t-this.long0),o=this.y0-this.a*this.k0*Math.log(a)}return e.x=s,e.y=o,e}function NF(e){var t=e.x-this.x0,n=e.y-this.y0,s,o;if(this.sphere)o=xe-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var l=Math.exp(-n/(this.a*this.k0));if(o=$r(this.e,l),o===-9999)return null}return s=Ne(this.long0+t/(this.a*this.k0)),e.x=s,e.y=o,e}var TF,ME,AE=R(()=>{ja();qt();yd();vd();xt();TF=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"],ME={init:IF,forward:LF,inverse:NF,names:TF}});function kF(){}function OE(e){return e}var RF,PE,FE=R(()=>{RF=["longlat","identity"],PE={init:kF,forward:OE,inverse:OE,names:RF}});function DE(e,t){var n=Zl.length;return e.names?(Zl[n]=e,e.names.forEach(function(s){qa[s.toLowerCase()]=n}),this):(console.log(t),!0)}function u0(e){return e.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function AF(e){if(!e)return!1;var t=e.toLowerCase();if(typeof qa[t]<"u"&&Zl[qa[t]]||(t=u0(t),t in qa&&Zl[qa[t]]))return Zl[qa[t]]}function OF(){MF.forEach(DE)}var MF,qa,Zl,GE,d0=R(()=>{AE();FE();MF=[ME,PE],qa={},Zl=[];GE={start:OF,add:DE,get:AF}});var PF,h0,jE=R(()=>{PF={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},h0=PF});function qE(e,t,n,s){var o=e*e,l=t*t,a=(o-l)/o,u=0;s?(e*=1-a*(tE+a*(nE+a*iE)),o=e*e,a=0):u=Math.sqrt(a);var h=(o-l)/l;return{es:a,e:u,ep2:h}}function $E(e,t,n,s,o){if(!e){var l=cs(h0,s);l||(l=FF),e=l.a,t=l.b,n=l.rf}return n&&!t&&(t=(1-1/n)*e),(n===0||Math.abs(e-t)<Te)&&(o=!0,t=e),{a:e,b:t,rf:n,sphere:o}}var FF,BE=R(()=>{xt();jE();fd();FF=h0.WGS84});var Tp,Np,UE,zE,VE=R(()=>{Tp={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(UE in Tp)Np=Tp[UE],Np.datumName&&(Tp[Np.datumName]=Np);zE=Tp});function DF(e,t,n,s,o,l,a){var u={};return e===void 0||e==="none"?u.datum_type=hd:u.datum_type=JS,t&&(u.datum_params=t.map(parseFloat),(u.datum_params[0]!==0||u.datum_params[1]!==0||u.datum_params[2]!==0)&&(u.datum_type=zs),u.datum_params.length>3&&(u.datum_params[3]!==0||u.datum_params[4]!==0||u.datum_params[5]!==0||u.datum_params[6]!==0)&&(u.datum_type=Vs,u.datum_params[3]*=Da,u.datum_params[4]*=Da,u.datum_params[5]*=Da,u.datum_params[6]=u.datum_params[6]/1e6+1)),a&&(u.datum_type=jr,u.grids=a),u.a=n,u.b=s,u.es=o,u.ep2=l,u}var HE,WE=R(()=>{xt();HE=DF});function g0(e,t,n){return t instanceof ArrayBuffer?GF(e,t,n):{ready:jF(e,t)}}function GF(e,t,n){var s=!0;n!==void 0&&n.includeErrorFields===!1&&(s=!1);var o=new DataView(t),l=$F(o),a=BF(o,l),u=UF(o,a,l,s),h={header:a,subgrids:u};return p0[e]=h,h}async function jF(e,t){for(var n=[],s=await t.getImageCount(),o=s-1;o>=0;o--){var l=await t.getImage(o),a=await l.readRasters(),u=a,h=[l.getWidth(),l.getHeight()],p=l.getBoundingBox().map(YE),d=[l.fileDirectory.ModelPixelScale[0],l.fileDirectory.ModelPixelScale[1]].map(YE),_=p[0]+(h[0]-1)*d[0],m=p[3]-(h[1]-1)*d[1],v=u[0],x=u[1],b=[];for(let D=h[1]-1;D>=0;D--)for(let G=h[0]-1;G>=0;G--){var w=D*h[0]+G;b.push([-Uo(x[w]),Uo(v[w])])}n.push({del:d,lim:h,ll:[-_,m],cvs:b})}var L={header:{nSubgrids:s},subgrids:n};return p0[e]=L,L}function XE(e){if(e===void 0)return null;var t=e.split(",");return t.map(qF)}function qF(e){if(e.length===0)return null;var t=e[0]==="@";return t&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:p0[e]||null,isNull:!1}}function YE(e){return e*Math.PI/180}function Uo(e){return e/3600*Math.PI/180}function $F(e){var t=e.getInt32(8,!1);return t===11?!1:(t=e.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function BF(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:f0(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}function f0(e,t,n){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,n)))}function UF(e,t,n,s){for(var o=176,l=[],a=0;a<t.nSubgrids;a++){var u=VF(e,o,n),h=HF(e,o,u,n,s),p=Math.round(1+(u.upperLongitude-u.lowerLongitude)/u.longitudeInterval),d=Math.round(1+(u.upperLatitude-u.lowerLatitude)/u.latitudeInterval);l.push({ll:[Uo(u.lowerLongitude),Uo(u.lowerLatitude)],del:[Uo(u.longitudeInterval),Uo(u.latitudeInterval)],lim:[p,d],count:u.gridNodeCount,cvs:zF(h)});var _=16;s===!1&&(_=8),o+=176+u.gridNodeCount*_}return l}function zF(e){return e.map(function(t){return[Uo(t.longitudeShift),Uo(t.latitudeShift)]})}function VF(e,t,n){return{name:f0(e,t+8,t+16).trim(),parent:f0(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,n),upperLatitude:e.getFloat64(t+88,n),lowerLongitude:e.getFloat64(t+104,n),upperLongitude:e.getFloat64(t+120,n),latitudeInterval:e.getFloat64(t+136,n),longitudeInterval:e.getFloat64(t+152,n),gridNodeCount:e.getInt32(t+168,n)}}function HF(e,t,n,s,o){var l=t+176,a=16;o===!1&&(a=8);for(var u=[],h=0;h<n.gridNodeCount;h++){var p={latitudeShift:e.getFloat32(l+h*a,s),longitudeShift:e.getFloat32(l+h*a+4,s)};o!==!1&&(p.latitudeAccuracy=e.getFloat32(l+h*a+8,s),p.longitudeAccuracy=e.getFloat32(l+h*a+12,s)),u.push(p)}return u}var p0,m0=R(()=>{p0={}});function Ql(e,t){if(!(this instanceof Ql))return new Ql(e);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,t=t||function(p){if(p)throw p};var n=TE(e);if(typeof n!="object"){t("Could not parse to valid json: "+e);return}var s=Ql.projections.get(n.projName);if(!s){t("Could not get projection name from: "+e);return}if(n.datumCode&&n.datumCode!=="none"){var o=cs(zE,n.datumCode);o&&(n.datum_params=n.datum_params||(o.towgs84?o.towgs84.split(","):null),n.ellps=o.ellipse,n.datumName=o.datumName?o.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var l=$E(n.a,n.b,n.rf,n.ellps,n.sphere),a=qE(l.a,l.b,l.rf,n.R_A),u=XE(n.nadgrids),h=n.datum||HE(n.datumCode,n.datum_params,l.a,l.b,a.es,a.ep2,u);c0(this,n),c0(this,s),this.a=l.a,this.b=l.b,this.rf=l.rf,this.sphere=l.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=h,"init"in this&&typeof this.init=="function"&&this.init(),t(null,this)}var Br,kp=R(()=>{kE();RE();d0();BE();VE();WE();fd();m0();Ql.projections=GE;Ql.projections.start();Br=Ql});function ZE(e,t){return e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11?!1:e.datum_type===zs?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type===Vs?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]:!0}function Rp(e,t,n){var s=e.x,o=e.y,l=e.z?e.z:0,a,u,h,p;if(o<-xe&&o>-1.001*xe)o=-xe;else if(o>xe&&o<1.001*xe)o=xe;else{if(o<-xe)return{x:-1/0,y:-1/0,z:e.z};if(o>xe)return{x:1/0,y:1/0,z:e.z}}return s>Math.PI&&(s-=2*Math.PI),u=Math.sin(o),p=Math.cos(o),h=u*u,a=n/Math.sqrt(1-t*h),{x:(a+l)*p*Math.cos(s),y:(a+l)*p*Math.sin(s),z:(a*(1-t)+l)*u}}function Mp(e,t,n,s){var o=1e-12,l=o*o,a=30,u,h,p,d,_,m,v,x,b,w,L,D,G,W=e.x,P=e.y,j=e.z?e.z:0,V,H,se;if(u=Math.sqrt(W*W+P*P),h=Math.sqrt(W*W+P*P+j*j),u/n<o){if(V=0,h/n<o)return H=xe,se=-s,{x:e.x,y:e.y,z:e.z}}else V=Math.atan2(P,W);p=j/h,d=u/h,_=1/Math.sqrt(1-t*(2-t)*d*d),x=d*(1-t)*_,b=p*_,G=0;do G++,v=n/Math.sqrt(1-t*b*b),se=u*x+j*b-v*(1-t*b*b),m=t*v/(v+se),_=1/Math.sqrt(1-m*(2-m)*d*d),w=d*(1-m)*_,L=p*_,D=L*x-w*b,x=w,b=L;while(D*D>l&&G<a);return H=Math.atan(L/Math.abs(w)),{x:V,y:H,z:se}}function QE(e,t,n){if(t===zs)return{x:e.x+n[0],y:e.y+n[1],z:e.z+n[2]};if(t===Vs){var s=n[0],o=n[1],l=n[2],a=n[3],u=n[4],h=n[5],p=n[6];return{x:p*(e.x-h*e.y+u*e.z)+s,y:p*(h*e.x+e.y-a*e.z)+o,z:p*(-u*e.x+a*e.y+e.z)+l}}}function KE(e,t,n){if(t===zs)return{x:e.x-n[0],y:e.y-n[1],z:e.z-n[2]};if(t===Vs){var s=n[0],o=n[1],l=n[2],a=n[3],u=n[4],h=n[5],p=n[6],d=(e.x-s)/p,_=(e.y-o)/p,m=(e.z-l)/p;return{x:d+h*_-u*m,y:-h*d+_+a*m,z:u*d-a*_+m}}}var _0=R(()=>{"use strict";xt()});function Ap(e){return e===zs||e===Vs}function tC(e,t,n){if(ZE(e,t)||e.datum_type===hd||t.datum_type===hd)return n;var s=e.a,o=e.es;if(e.datum_type===jr){var l=JE(e,!1,n);if(l!==0)return;s=Qy,o=Ky}var a=t.a,u=t.b,h=t.es;if(t.datum_type===jr&&(a=Qy,u=eE,h=Ky),o===h&&s===a&&!Ap(e.datum_type)&&!Ap(t.datum_type))return n;if(n=Rp(n,o,s),Ap(e.datum_type)&&(n=QE(n,e.datum_type,e.datum_params)),Ap(t.datum_type)&&(n=KE(n,t.datum_type,t.datum_params)),n=Mp(n,h,a,u),t.datum_type===jr){var p=JE(t,!0,n);if(p!==0)return}return n}function JE(e,t,n){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var s={x:-n.x,y:n.y},o={x:Number.NaN,y:Number.NaN},l=[];e:for(var a=0;a<e.grids.length;a++){var u=e.grids[a];if(l.push(u.name),u.isNull){o=s;break}if(u.grid===null){if(u.mandatory)return console.log("Unable to find mandatory grid '"+u.name+"'"),-1;continue}for(var h=u.grid.subgrids,p=0,d=h.length;p<d;p++){var _=h[p],m=(Math.abs(_.del[1])+Math.abs(_.del[0]))/1e4,v=_.ll[0]-m,x=_.ll[1]-m,b=_.ll[0]+(_.lim[0]-1)*_.del[0]+m,w=_.ll[1]+(_.lim[1]-1)*_.del[1]+m;if(!(x>s.y||v>s.x||w<s.y||b<s.x)&&(o=WF(s,t,_),!isNaN(o.x)))break e}}return isNaN(o.x)?(console.log("Failed to find a grid shift table for location '"+-s.x*Pi+" "+s.y*Pi+" tried: '"+l+"'"),-1):(n.x=-o.x,n.y=o.y,0)}function WF(e,t,n){var s={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return s;var o={x:e.x,y:e.y};o.x-=n.ll[0],o.y-=n.ll[1],o.x=Ne(o.x-Math.PI)+Math.PI;var l=eC(o,n);if(t){if(isNaN(l.x))return s;l.x=o.x-l.x,l.y=o.y-l.y;var a=9,u=1e-12,h,p;do{if(p=eC(l,n),isNaN(p.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}h={x:o.x-(p.x+l.x),y:o.y-(p.y+l.y)},l.x+=h.x,l.y+=h.y}while(a--&&Math.abs(h.x)>u&&Math.abs(h.y)>u);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),s;s.x=Ne(l.x+n.ll[0]),s.y=l.y+n.ll[1]}else isNaN(l.x)||(s.x=e.x+l.x,s.y=e.y+l.y);return s}function eC(e,t){var n={x:e.x/t.del[0],y:e.y/t.del[1]},s={x:Math.floor(n.x),y:Math.floor(n.y)},o={x:n.x-1*s.x,y:n.y-1*s.y},l={x:Number.NaN,y:Number.NaN},a;if(s.x<0||s.x>=t.lim[0]||s.y<0||s.y>=t.lim[1])return l;a=s.y*t.lim[0]+s.x;var u={x:t.cvs[a][0],y:t.cvs[a][1]};a++;var h={x:t.cvs[a][0],y:t.cvs[a][1]};a+=t.lim[0];var p={x:t.cvs[a][0],y:t.cvs[a][1]};a--;var d={x:t.cvs[a][0],y:t.cvs[a][1]},_=o.x*o.y,m=o.x*(1-o.y),v=(1-o.x)*(1-o.y),x=(1-o.x)*o.y;return l.x=v*u.x+m*h.x+x*d.x+_*p.x,l.y=v*u.y+m*h.y+x*d.y+_*p.y,l}var nC=R(()=>{xt();_0();qt()});function y0(e,t,n){var s=n.x,o=n.y,l=n.z||0,a,u,h,p={};for(h=0;h<3;h++)if(!(t&&h===2&&n.z===void 0))switch(h===0?(a=s,"ew".indexOf(e.axis[h])!==-1?u="x":u="y"):h===1?(a=o,"ns".indexOf(e.axis[h])!==-1?u="y":u="x"):(a=l,u="z"),e.axis[h]){case"e":p[u]=a;break;case"w":p[u]=-a;break;case"n":p[u]=a;break;case"s":p[u]=-a;break;case"u":n[u]!==void 0&&(p.z=a);break;case"d":n[u]!==void 0&&(p.z=-a);break;default:return null}return p}var iC=R(()=>{});function Op(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}var v0=R(()=>{});function rC(e){sC(e.x),sC(e.y)}function sC(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}var oC=R(()=>{});function YF(e,t){return(e.datum.datum_type===zs||e.datum.datum_type===Vs||e.datum.datum_type===jr)&&t.datumCode!=="WGS84"||(t.datum.datum_type===zs||t.datum.datum_type===Vs||t.datum.datum_type===jr)&&e.datumCode!=="WGS84"}function $a(e,t,n,s){var o;Array.isArray(n)?n=Op(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var l=n.z!==void 0;if(rC(n),e.datum&&t.datum&&YF(e,t)&&(o=new Br("WGS84"),n=$a(e,o,n,s),e=o),s&&e.axis!=="enu"&&(n=y0(e,!1,n)),e.projName==="longlat")n={x:n.x*bn,y:n.y*bn,z:n.z||0};else if(e.to_meter&&(n={x:n.x*e.to_meter,y:n.y*e.to_meter,z:n.z||0}),n=e.inverse(n),!n)return;if(e.from_greenwich&&(n.x+=e.from_greenwich),n=tC(e.datum,t.datum,n),!!n)return n=n,t.from_greenwich&&(n={x:n.x-t.from_greenwich,y:n.y,z:n.z||0}),t.projName==="longlat"?n={x:n.x*Pi,y:n.y*Pi,z:n.z||0}:(n=t.forward(n),t.to_meter&&(n={x:n.x/t.to_meter,y:n.y/t.to_meter,z:n.z||0})),s&&t.axis!=="enu"?y0(t,!0,n):(n&&!l&&delete n.z,n)}var b0=R(()=>{xt();nC();iC();kp();v0();oC()});function x0(e,t,n,s){var o,l,a;return Array.isArray(n)?(o=$a(e,t,n,s)||{x:NaN,y:NaN},n.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof o.z=="number"?[o.x,o.y,o.z].concat(n.slice(3)):[o.x,o.y,n[2]].concat(n.slice(3)):[o.x,o.y].concat(n.slice(2)):[o.x,o.y]):(l=$a(e,t,n,s),a=Object.keys(n),a.length===2||a.forEach(function(u){if(typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(u==="x"||u==="y"||u==="z")return}else if(u==="x"||u==="y")return;l[u]=n[u]}),l)}function Pp(e){return e instanceof Br?e:typeof e=="object"&&"oProj"in e?e.oProj:Br(e)}function XF(e,t,n){var s,o,l=!1,a;return typeof t>"u"?(o=Pp(e),s=aC,l=!0):(typeof t.x<"u"||Array.isArray(t))&&(n=t,o=Pp(e),s=aC,l=!0),s||(s=Pp(e)),o||(o=Pp(t)),n?x0(s,o,n):(a={forward:function(u,h){return x0(s,o,u,h)},inverse:function(u,h){return x0(o,s,u,h)}},l&&(a.oProj=o),a)}var aC,lC,cC=R(()=>{kp();b0();aC=Br("WGS84");lC=XF});function S0(e,t){return t=t||5,JF(QF({lat:e[1],lon:e[0]}),t)}function ZF(e){var t=C0(mC(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function E0(e){var t=C0(mC(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function w0(e){return e*(Math.PI/180)}function dC(e){return 180*(e/Math.PI)}function QF(e){var t=e.lat,n=e.lon,s=6378137,o=.00669438,l=.9996,a,u,h,p,d,_,m,v=w0(t),x=w0(n),b,w;w=Math.floor((n+180)/6)+1,n===180&&(w=60),t>=56&&t<64&&n>=3&&n<12&&(w=32),t>=72&&t<84&&(n>=0&&n<9?w=31:n>=9&&n<21?w=33:n>=21&&n<33?w=35:n>=33&&n<42&&(w=37)),a=(w-1)*6-180+3,b=w0(a),u=o/(1-o),h=s/Math.sqrt(1-o*Math.sin(v)*Math.sin(v)),p=Math.tan(v)*Math.tan(v),d=u*Math.cos(v)*Math.cos(v),_=Math.cos(v)*(x-b),m=s*((1-o/4-3*o*o/64-5*o*o*o/256)*v-(3*o/8+3*o*o/32+45*o*o*o/1024)*Math.sin(2*v)+(15*o*o/256+45*o*o*o/1024)*Math.sin(4*v)-35*o*o*o/3072*Math.sin(6*v));var L=l*h*(_+(1-p+d)*_*_*_/6+(5-18*p+p*p+72*d-58*u)*_*_*_*_*_/120)+5e5,D=l*(m+h*Math.tan(v)*(_*_/2+(5-p+9*d+4*d*d)*_*_*_*_/24+(61-58*p+p*p+600*d-330*u)*_*_*_*_*_*_/720));return t<0&&(D+=1e7),{northing:Math.round(D),easting:Math.round(L),zoneNumber:w,zoneLetter:KF(t)}}function C0(e){var t=e.northing,n=e.easting,s=e.zoneLetter,o=e.zoneNumber;if(o<0||o>60)return null;var l=.9996,a=6378137,u=.00669438,h,p=(1-Math.sqrt(1-u))/(1+Math.sqrt(1-u)),d,_,m,v,x,b,w,L,D,G=n-5e5,W=t;s<"N"&&(W-=1e7),w=(o-1)*6-180+3,h=u/(1-u),b=W/l,L=b/(a*(1-u/4-3*u*u/64-5*u*u*u/256)),D=L+(3*p/2-27*p*p*p/32)*Math.sin(2*L)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*L)+151*p*p*p/96*Math.sin(6*L),d=a/Math.sqrt(1-u*Math.sin(D)*Math.sin(D)),_=Math.tan(D)*Math.tan(D),m=h*Math.cos(D)*Math.cos(D),v=a*(1-u)/Math.pow(1-u*Math.sin(D)*Math.sin(D),1.5),x=G/(d*l);var P=D-d*Math.tan(D)/v*(x*x/2-(5+3*_+10*m-4*m*m-9*h)*x*x*x*x/24+(61+90*_+298*m+45*_*_-252*h-3*m*m)*x*x*x*x*x*x/720);P=dC(P);var j=(x-(1+2*_+m)*x*x*x/6+(5-2*m+28*_-3*m*m+8*h+24*_*_)*x*x*x*x*x/120)/Math.cos(D);j=w+dC(j);var V;if(e.accuracy){var H=C0({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});V={top:H.lat,right:H.lon,bottom:P,left:j}}else V={lat:P,lon:j};return V}function KF(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function JF(e,t){var n="00000"+e.easting,s="00000"+e.northing;return e.zoneNumber+e.zoneLetter+e6(e.easting,e.northing,e.zoneNumber)+n.substr(n.length-5,t)+s.substr(s.length-5,t)}function e6(e,t,n){var s=gC(n),o=Math.floor(e/1e5),l=Math.floor(t/1e5)%20;return t6(o,l,s)}function gC(e){var t=e%uC;return t===0&&(t=uC),t}function t6(e,t,n){var s=n-1,o=hC.charCodeAt(s),l=fC.charCodeAt(s),a=o+e-1,u=l+t,h=!1;a>xd&&(a=a-xd+Kl-1,h=!0),(a===Di||o<Di&&a>Di||(a>Di||o<Di)&&h)&&a++,(a===Is||o<Is&&a>Is||(a>Is||o<Is)&&h)&&(a++,a===Di&&a++),a>xd&&(a=a-xd+Kl-1),u>bd?(u=u-bd+Kl-1,h=!0):h=!1,(u===Di||l<Di&&u>Di||(u>Di||l<Di)&&h)&&u++,(u===Is||l<Is&&u>Is||(u>Is||l<Is)&&h)&&(u++,u===Di&&u++),u>bd&&(u=u-bd+Kl-1);var p=String.fromCharCode(a)+String.fromCharCode(u);return p}function mC(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var t=e.length,n=null,s="",o,l=0;!/[A-Z]/.test(o=e.charAt(l));){if(l>=2)throw"MGRSPoint bad conversion from: "+e;s+=o,l++}var a=parseInt(s,10);if(l===0||l+3>t)throw"MGRSPoint bad conversion from: "+e;var u=e.charAt(l++);if(u<="A"||u==="B"||u==="Y"||u>="Z"||u==="I"||u==="O")throw"MGRSPoint zone letter "+u+" not handled: "+e;n=e.substring(l,l+=2);for(var h=gC(a),p=n6(n.charAt(0),h),d=i6(n.charAt(1),h);d<s6(u);)d+=2e6;var _=t-l;if(_%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var m=_/2,v=0,x=0,b,w,L,D,G;return m>0&&(b=1e5/Math.pow(10,m),w=e.substring(l,l+m),v=parseFloat(w)*b,L=e.substring(l+m),x=parseFloat(L)*b),D=v+p,G=x+d,{easting:D,northing:G,zoneLetter:u,zoneNumber:a,accuracy:b}}function n6(e,t){for(var n=hC.charCodeAt(t-1),s=1e5,o=!1;n!==e.charCodeAt(0);){if(n++,n===Di&&n++,n===Is&&n++,n>xd){if(o)throw"Bad character: "+e;n=Kl,o=!0}s+=1e5}return s}function i6(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var n=fC.charCodeAt(t-1),s=0,o=!1;n!==e.charCodeAt(0);){if(n++,n===Di&&n++,n===Is&&n++,n>bd){if(o)throw"Bad character: "+e;n=Kl,o=!0}s+=1e5}return s}function s6(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}var uC,hC,fC,Kl,Di,Is,bd,xd,pC,I0=R(()=>{uC=6,hC="AJSAJS",fC="AFAFAF",Kl=65,Di=73,Is=79,bd=86,xd=90,pC={forward:S0,inverse:ZF,toPoint:E0}});function Jl(e,t,n){if(!(this instanceof Jl))return new Jl(e,t,n);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof t>"u"){var s=e.split(",");this.x=parseFloat(s[0]),this.y=parseFloat(s[1]),this.z=parseFloat(s[2])||0}else this.x=e,this.y=t,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var _C,yC=R(()=>{I0();Jl.fromMGRS=function(e){return new Jl(E0(e))};Jl.prototype.toMGRS=function(e){return S0([this.x,this.y],e)};_C=Jl});function ec(e){var t=[];t[0]=r6-e*(o6+e*(vC+e*(bC+e*xC))),t[1]=e*(a6-e*(vC+e*(bC+e*xC)));var n=e*e;return t[2]=n*(l6-e*(c6+e*u6)),n*=e,t[3]=n*(d6-e*h6),t[4]=n*e*f6,t}var r6,o6,vC,bC,xC,a6,l6,c6,u6,d6,h6,f6,Fp=R(()=>{r6=1,o6=.25,vC=.046875,bC=.01953125,xC=.01068115234375,a6=.75,l6=.46875,c6=.013020833333333334,u6=.007120768229166667,d6=.3645833333333333,h6=.005696614583333333,f6=.3076171875});function fr(e,t,n,s){return n*=t,t*=t,s[0]*e-n*(s[1]+t*(s[2]+t*(s[3]+t*s[4])))}var wd=R(()=>{});function tc(e,t,n){for(var s=1/(1-t),o=e,l=p6;l;--l){var a=Math.sin(o),u=1-t*a*a;if(u=(fr(o,a,Math.cos(o),n)-e)*(u*Math.sqrt(u))*s,o-=u,Math.abs(u)<Te)return o}return o}var p6,Dp=R(()=>{wd();xt();p6=20});function g6(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=ec(this.es),this.ml0=fr(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function m6(e){var t=e.x,n=e.y,s=Ne(t-this.long0),o,l,a,u=Math.sin(n),h=Math.cos(n);if(this.es){var d=h*s,_=Math.pow(d,2),m=this.ep2*Math.pow(h,2),v=Math.pow(m,2),x=Math.abs(h)>Te?Math.tan(n):0,b=Math.pow(x,2),w=Math.pow(b,2);o=1-this.es*Math.pow(u,2),d=d/Math.sqrt(o);var L=fr(n,u,h,this.en);l=this.a*(this.k0*d*(1+_/6*(1-b+m+_/20*(5-18*b+w+14*m-58*b*m+_/42*(61+179*w-w*b-479*b)))))+this.x0,a=this.a*(this.k0*(L-this.ml0+u*s*d/2*(1+_/12*(5-b+9*m+4*v+_/30*(61+w-58*b+270*m-330*b*m+_/56*(1385+543*w-w*b-3111*b))))))+this.y0}else{var p=h*Math.sin(s);if(Math.abs(Math.abs(p)-1)<Te)return 93;if(l=.5*this.a*this.k0*Math.log((1+p)/(1-p))+this.x0,a=h*Math.cos(s)/Math.sqrt(1-Math.pow(p,2)),p=Math.abs(a),p>=1){if(p-1>Te)return 93;a=0}else a=Math.acos(a);n<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return e.x=l,e.y=a,e}function _6(e){var t,n,s,o,l=(e.x-this.x0)*(1/this.a),a=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+a/this.k0,n=tc(t,this.es,this.en),Math.abs(n)<xe){var _=Math.sin(n),m=Math.cos(n),v=Math.abs(m)>Te?Math.tan(n):0,x=this.ep2*Math.pow(m,2),b=Math.pow(x,2),w=Math.pow(v,2),L=Math.pow(w,2);t=1-this.es*Math.pow(_,2);var D=l*Math.sqrt(t)/this.k0,G=Math.pow(D,2);t=t*v,s=n-t*G/(1-this.es)*.5*(1-G/12*(5+3*w-9*x*w+x-4*b-G/30*(61+90*w-252*x*w+45*L+46*x-G/56*(1385+3633*w+4095*L+1574*L*w)))),o=Ne(this.long0+D*(1-G/6*(1+2*w+x-G/20*(5+28*w+24*L+8*x*w+6*x-G/42*(61+662*w+1320*L+720*L*w))))/m)}else s=xe*hr(a),o=0;else{var u=Math.exp(l/this.k0),h=.5*(u-1/u),p=this.lat0+a/this.k0,d=Math.cos(p);t=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(h,2))),s=Math.asin(t),a<0&&(s=-s),h===0&&d===0?o=0:o=Ne(Math.atan2(h,d)+this.long0)}return e.x=o,e.y=s,e}var y6,nc,L0=R(()=>{Fp();wd();Dp();qt();xt();Xl();y6=["Fast_Transverse_Mercator","Fast Transverse Mercator"],nc={init:g6,forward:m6,inverse:_6,names:y6}});function Gp(e){var t=Math.exp(e);return t=(t-1/t)/2,t}var N0=R(()=>{});function An(e,t){e=Math.abs(e),t=Math.abs(t);var n=Math.max(e,t),s=Math.min(e,t)/(n||1);return n*Math.sqrt(1+Math.pow(s,2))}var Ba=R(()=>{});function wC(e){var t=1+e,n=t-1;return n===0?e:e*Math.log(t)/n}var SC=R(()=>{});function EC(e){var t=Math.abs(e);return t=wC(t*(1+t/(An(1,t)+1))),e<0?-t:t}var CC=R(()=>{Ba();SC()});function jp(e,t){for(var n=2*Math.cos(2*t),s=e.length-1,o=e[s],l=0,a;--s>=0;)a=-l+n*o+e[s],l=o,o=a;return t+a*Math.sin(2*t)}var IC=R(()=>{});function LC(e,t){for(var n=2*Math.cos(t),s=e.length-1,o=e[s],l=0,a;--s>=0;)a=-l+n*o+e[s],l=o,o=a;return Math.sin(t)*a}var NC=R(()=>{});function TC(e){var t=Math.exp(e);return t=(t+1/t)/2,t}var kC=R(()=>{});function T0(e,t,n){for(var s=Math.sin(t),o=Math.cos(t),l=Gp(n),a=TC(n),u=2*o*a,h=-2*s*l,p=e.length-1,d=e[p],_=0,m=0,v=0,x,b;--p>=0;)x=m,b=_,m=d,_=v,d=-x+u*m-h*_+e[p],v=-b+h*m+u*_;return u=s*a,h=o*l,[u*d-h*v,u*v+h*d]}var RC=R(()=>{N0();kC()});function v6(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(nc.init.apply(this),this.forward=nc.forward,this.inverse=nc.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),n=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),n=n*t,this.cgb[1]=n*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=n*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),n=n*t,this.cgb[2]=n*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=n*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),n=n*t,this.cgb[3]=n*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=n*(1237/630+t*(-12/5+t*(-24832/14175))),n=n*t,this.cgb[4]=n*(4174/315+t*(-144838/6237)),this.cbg[4]=n*(-734/315+t*(109598/31185)),n=n*t,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=n*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=n*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),n=n*t,this.utg[2]=n*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=n*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),n=n*t,this.utg[3]=n*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=n*(49561/161280+t*(-179/168+t*(6601661/7257600))),n=n*t,this.utg[4]=n*(-4583/161280+t*(108847/3991680)),this.gtu[4]=n*(34729/80640+t*(-3418889/1995840)),n=n*t,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var s=jp(this.cbg,this.lat0);this.Zb=-this.Qn*(s+LC(this.gtu,2*s))}function b6(e){var t=Ne(e.x-this.long0),n=e.y;n=jp(this.cbg,n);var s=Math.sin(n),o=Math.cos(n),l=Math.sin(t),a=Math.cos(t);n=Math.atan2(s,a*o),t=Math.atan2(l*o,An(s,o*a)),t=EC(Math.tan(t));var u=T0(this.gtu,2*n,2*t);n=n+u[0],t=t+u[1];var h,p;return Math.abs(t)<=2.623395162778?(h=this.a*(this.Qn*t)+this.x0,p=this.a*(this.Qn*n+this.Zb)+this.y0):(h=1/0,p=1/0),e.x=h,e.y=p,e}function x6(e){var t=(e.x-this.x0)*(1/this.a),n=(e.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,t=t/this.Qn;var s,o;if(Math.abs(t)<=2.623395162778){var l=T0(this.utg,2*n,2*t);n=n+l[0],t=t+l[1],t=Math.atan(Gp(t));var a=Math.sin(n),u=Math.cos(n),h=Math.sin(t),p=Math.cos(t);n=Math.atan2(a*p,An(h,p*u)),t=Math.atan2(h,p*u),s=Ne(t+this.long0),o=jp(this.cgb,n)}else s=1/0,o=1/0;return e.x=s,e.y=o,e}var w6,ic,k0=R(()=>{L0();N0();Ba();CC();IC();NC();RC();qt();w6=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"],ic={init:v6,forward:b6,inverse:x6,names:w6}});function MC(e,t){if(e===void 0){if(e=Math.floor((Ne(t)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var AC=R(()=>{qt()});function E6(){var e=MC(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*bn,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ic.init.apply(this),this.forward=ic.forward,this.inverse=ic.inverse}var S6,C6,OC,PC=R(()=>{AC();k0();xt();S6="etmerc";C6=["Universal Transverse Mercator System","utm"],OC={init:E6,names:C6,dependsOn:S6}});function qp(e,t){return Math.pow((1-e)/(1+e),t)}var FC=R(()=>{});function L6(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Lt)/(Math.pow(Math.tan(.5*this.lat0+Lt),this.C)*qp(this.e*e,this.ratexp))}function N6(e){var t=e.x,n=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Lt),this.C)*qp(this.e*Math.sin(n),this.ratexp))-xe,e.x=this.C*t,e}function T6(e){for(var t=1e-14,n=e.x/this.C,s=e.y,o=Math.pow(Math.tan(.5*s+Lt)/this.K,1/this.C),l=I6;l>0&&(s=2*Math.atan(o*qp(this.e*Math.sin(e.y),-.5*this.e))-xe,!(Math.abs(s-e.y)<t));--l)e.y=s;return l?(e.x=n,e.y=s,e):null}var I6,k6,$p,DC=R(()=>{FC();xt();I6=20;k6=["gauss"],$p={init:L6,forward:N6,inverse:T6,names:k6}});function R6(){$p.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function M6(e){var t,n,s,o;return e.x=Ne(e.x-this.long0),$p.forward.apply(this,[e]),t=Math.sin(e.y),n=Math.cos(e.y),s=Math.cos(e.x),o=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*n*s),e.x=o*n*Math.sin(e.x),e.y=o*(this.cosc0*t-this.sinc0*n*s),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function A6(e){var t,n,s,o,l;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,l=An(e.x,e.y)){var a=2*Math.atan2(l,this.R2);t=Math.sin(a),n=Math.cos(a),o=Math.asin(n*this.sinc0+e.y*t*this.cosc0/l),s=Math.atan2(e.x*t,l*this.cosc0*n-e.y*this.sinc0*t)}else o=this.phic0,s=0;return e.x=s,e.y=o,$p.inverse.apply(this,[e]),e.x=Ne(e.x+this.long0),e}var O6,GC,jC=R(()=>{DC();qt();Ba();O6=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"],GC={init:R6,forward:M6,inverse:A6,names:O6}});function R0(e,t,n){return t*=n,Math.tan(.5*(xe+e))*Math.pow((1-t)/(1+t),.5*n)}function P6(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Te&&(this.k0=.5*(1+hr(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Te&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Te&&Math.abs(Math.cos(this.lat_ts))>Te&&(this.k0=.5*this.cons*ai(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/yi(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ai(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(R0(this.lat0,this.sinlat0,this.e))-xe,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function F6(e){var t=e.x,n=e.y,s=Math.sin(n),o=Math.cos(n),l,a,u,h,p,d,_=Ne(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=Te&&Math.abs(n+this.lat0)<=Te?(e.x=NaN,e.y=NaN,e):this.sphere?(l=2*this.k0/(1+this.sinlat0*s+this.coslat0*o*Math.cos(_)),e.x=this.a*l*o*Math.sin(_)+this.x0,e.y=this.a*l*(this.coslat0*s-this.sinlat0*o*Math.cos(_))+this.y0,e):(a=2*Math.atan(R0(n,s,this.e))-xe,h=Math.cos(a),u=Math.sin(a),Math.abs(this.coslat0)<=Te?(p=yi(this.e,n*this.con,this.con*s),d=2*this.a*this.k0*p/this.cons,e.x=this.x0+d*Math.sin(t-this.long0),e.y=this.y0-this.con*d*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<Te?(l=2*this.a*this.k0/(1+h*Math.cos(_)),e.y=l*u):(l=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*u+this.cosX0*h*Math.cos(_))),e.y=l*(this.cosX0*u-this.sinX0*h*Math.cos(_))+this.y0),e.x=l*h*Math.sin(_)+this.x0,e))}function D6(e){e.x-=this.x0,e.y-=this.y0;var t,n,s,o,l,a=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var u=2*Math.atan(a/(2*this.a*this.k0));return t=this.long0,n=this.lat0,a<=Te?(e.x=t,e.y=n,e):(n=Math.asin(Math.cos(u)*this.sinlat0+e.y*Math.sin(u)*this.coslat0/a),Math.abs(this.coslat0)<Te?this.lat0>0?t=Ne(this.long0+Math.atan2(e.x,-1*e.y)):t=Ne(this.long0+Math.atan2(e.x,e.y)):t=Ne(this.long0+Math.atan2(e.x*Math.sin(u),a*this.coslat0*Math.cos(u)-e.y*this.sinlat0*Math.sin(u))),e.x=t,e.y=n,e)}else if(Math.abs(this.coslat0)<=Te){if(a<=Te)return n=this.lat0,t=this.long0,e.x=t,e.y=n,e;e.x*=this.con,e.y*=this.con,s=a*this.cons/(2*this.a*this.k0),n=this.con*$r(this.e,s),t=this.con*Ne(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else o=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,a<=Te?l=this.X0:(l=Math.asin(Math.cos(o)*this.sinX0+e.y*Math.sin(o)*this.cosX0/a),t=Ne(this.long0+Math.atan2(e.x*Math.sin(o),a*this.cosX0*Math.cos(o)-e.y*this.sinX0*Math.sin(o)))),n=-1*$r(this.e,Math.tan(.5*(xe+l)));return e.x=t,e.y=n,e}var G6,qC,$C=R(()=>{xt();Xl();ja();yd();vd();qt();G6=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"],qC={init:P6,forward:F6,inverse:D6,names:G6,ssfn_:R0}});function j6(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),n=this.a,s=this.rf,o=1/s,l=2*o-Math.pow(o,2),a=this.e=Math.sqrt(l);this.R=this.k0*n*Math.sqrt(1-l)/(1-l*Math.pow(t,2)),this.alpha=Math.sqrt(1+l/(1-l)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var u=Math.log(Math.tan(Math.PI/4+this.b0/2)),h=Math.log(Math.tan(Math.PI/4+e/2)),p=Math.log((1+a*t)/(1-a*t));this.K=u-this.alpha*h+this.alpha*a/2*p}function q6(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),s=-this.alpha*(t+n)+this.K,o=2*(Math.atan(Math.exp(s))-Math.PI/4),l=this.alpha*(e.x-this.lambda0),a=Math.atan(Math.sin(l)/(Math.sin(this.b0)*Math.tan(o)+Math.cos(this.b0)*Math.cos(l))),u=Math.asin(Math.cos(this.b0)*Math.sin(o)-Math.sin(this.b0)*Math.cos(o)*Math.cos(l));return e.y=this.R/2*Math.log((1+Math.sin(u))/(1-Math.sin(u)))+this.y0,e.x=this.R*a+this.x0,e}function $6(e){for(var t=e.x-this.x0,n=e.y-this.y0,s=t/this.R,o=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),l=Math.asin(Math.cos(this.b0)*Math.sin(o)+Math.sin(this.b0)*Math.cos(o)*Math.cos(s)),a=Math.atan(Math.sin(s)/(Math.cos(this.b0)*Math.cos(s)-Math.sin(this.b0)*Math.tan(o))),u=this.lambda0+a/this.alpha,h=0,p=l,d=-1e3,_=0;Math.abs(p-d)>1e-7;){if(++_>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+l/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(p))/2)),d=p,p=2*Math.atan(Math.exp(h))-Math.PI/2}return e.x=u,e.y=p,e}var B6,BC,UC=R(()=>{B6=["somerc"],BC={init:j6,forward:q6,inverse:$6,names:B6}});function U6(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof e.projName=="object"?Object.keys(e.projName)[0]:e.projName;return"no_uoff"in e||"no_off"in e||t.indexOf(n)!==-1||t.indexOf(u0(n))!==-1}function z6(){var e,t,n,s,o,l,a,u,h,p,d=0,_,m=0,v=0,x=0,b=0,w=0,L=0;this.no_off=U6(this),this.no_rot="no_rot"in this;var D=!1;"alpha"in this&&(D=!0);var G=!1;if("rectified_grid_angle"in this&&(G=!0),D&&(L=this.alpha),G&&(d=this.rectified_grid_angle),D||G)m=this.longc;else if(v=this.long1,b=this.lat1,x=this.long2,w=this.lat2,Math.abs(b-w)<=sc||(e=Math.abs(b))<=sc||Math.abs(e-xe)<=sc||Math.abs(Math.abs(this.lat0)-xe)<=sc||Math.abs(Math.abs(w)-xe)<=sc)throw new Error;var W=1-this.es;t=Math.sqrt(W),Math.abs(this.lat0)>Te?(u=Math.sin(this.lat0),n=Math.cos(this.lat0),e=1-this.es*u*u,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/W),this.A=this.B*this.k0*t/e,s=this.B*t/(n*Math.sqrt(e)),o=s*s-1,o<=0?o=0:(o=Math.sqrt(o),this.lat0<0&&(o=-o)),this.E=o+=s,this.E*=Math.pow(yi(this.e,this.lat0,u),this.B)):(this.B=1/t,this.A=this.k0,this.E=s=o=1),D||G?(D?(_=Math.asin(Math.sin(L)/s),G||(d=L)):(_=d,L=Math.asin(s*Math.sin(_))),this.lam0=m-Math.asin(.5*(o-1/o)*Math.tan(_))/this.B):(l=Math.pow(yi(this.e,b,Math.sin(b)),this.B),a=Math.pow(yi(this.e,w,Math.sin(w)),this.B),o=this.E/l,h=(a-l)/(a+l),p=this.E*this.E,p=(p-a*l)/(p+a*l),e=v-x,e<-Math.PI?x-=Bo:e>Math.PI&&(x+=Bo),this.lam0=Ne(.5*(v+x)-Math.atan(p*Math.tan(.5*this.B*(v-x))/h)/this.B),_=Math.atan(2*Math.sin(this.B*Ne(v-this.lam0))/(o-1/o)),d=L=Math.asin(s*Math.sin(_))),this.singam=Math.sin(_),this.cosgam=Math.cos(_),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(s*s-1)/Math.cos(L))),this.lat0<0&&(this.u_0=-this.u_0)),o=.5*_,this.v_pole_n=this.ArB*Math.log(Math.tan(Lt-o)),this.v_pole_s=this.ArB*Math.log(Math.tan(Lt+o))}function V6(e){var t={},n,s,o,l,a,u,h,p;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-xe)>Te){if(a=this.E/Math.pow(yi(this.e,e.y,Math.sin(e.y)),this.B),u=1/a,n=.5*(a-u),s=.5*(a+u),l=Math.sin(this.B*e.x),o=(n*this.singam-l*this.cosgam)/s,Math.abs(Math.abs(o)-1)<Te)throw new Error;p=.5*this.ArB*Math.log((1-o)/(1+o)),u=Math.cos(this.B*e.x),Math.abs(u)<sc?h=this.A*e.x:h=this.ArB*Math.atan2(n*this.cosgam+l*this.singam,u)}else p=e.y>0?this.v_pole_n:this.v_pole_s,h=this.ArB*e.y;return this.no_rot?(t.x=h,t.y=p):(h-=this.u_0,t.x=p*this.cosrot+h*this.sinrot,t.y=h*this.cosrot-p*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function H6(e){var t,n,s,o,l,a,u,h={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(n=e.y,t=e.x):(n=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),s=Math.exp(-this.BrA*n),o=.5*(s-1/s),l=.5*(s+1/s),a=Math.sin(this.BrA*t),u=(a*this.cosgam+o*this.singam)/l,Math.abs(Math.abs(u)-1)<Te)h.x=0,h.y=u<0?-xe:xe;else{if(h.y=this.E/Math.sqrt((1+u)/(1-u)),h.y=$r(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(o*this.cosgam-a*this.singam,Math.cos(this.BrA*t))}return h.x+=this.lam0,h}var sc,W6,zC,VC=R(()=>{yd();qt();vd();xt();d0();sc=1e-7;W6=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"],zC={init:z6,forward:V6,inverse:H6,names:W6}});function Y6(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Te)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),n=Math.cos(this.lat1),s=ai(this.e,t,n),o=yi(this.e,this.lat1,t),l=Math.sin(this.lat2),a=Math.cos(this.lat2),u=ai(this.e,l,a),h=yi(this.e,this.lat2,l),p=Math.abs(Math.abs(this.lat0)-xe)<Te?0:yi(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Te?this.ns=Math.log(s/u)/Math.log(o/h):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=s/(this.ns*Math.pow(o,this.ns)),this.rh=this.a*this.f0*Math.pow(p,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function X6(e){var t=e.x,n=e.y;Math.abs(2*Math.abs(n)-Math.PI)<=Te&&(n=hr(n)*(xe-2*Te));var s=Math.abs(Math.abs(n)-xe),o,l;if(s>Te)o=yi(this.e,n,Math.sin(n)),l=this.a*this.f0*Math.pow(o,this.ns);else{if(s=n*this.ns,s<=0)return null;l=0}var a=this.ns*Ne(t-this.long0);return e.x=this.k0*(l*Math.sin(a))+this.x0,e.y=this.k0*(this.rh-l*Math.cos(a))+this.y0,e}function Z6(e){var t,n,s,o,l,a=(e.x-this.x0)/this.k0,u=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(a*a+u*u),n=1):(t=-Math.sqrt(a*a+u*u),n=-1);var h=0;if(t!==0&&(h=Math.atan2(n*a,n*u)),t!==0||this.ns>0){if(n=1/this.ns,s=Math.pow(t/(this.a*this.f0),n),o=$r(this.e,s),o===-9999)return null}else o=-xe;return l=Ne(h/this.ns+this.long0),e.x=l,e.y=o,e}var Q6,HC,WC=R(()=>{ja();yd();Xl();qt();vd();xt();Q6=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"],HC={init:Y6,forward:X6,inverse:Z6,names:Q6}});function K6(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function J6(e){var t,n,s,o,l,a,u,h=e.x,p=e.y,d=Ne(h-this.long0);return t=Math.pow((1+this.e*Math.sin(p))/(1-this.e*Math.sin(p)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(p/2+this.s45),this.alfa)/t)-this.s45),s=-d*this.alfa,o=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(s)),l=Math.asin(Math.cos(n)*Math.sin(s)/Math.cos(o)),a=this.n*l,u=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(o/2+this.s45),this.n),e.y=u*Math.cos(a)/1,e.x=u*Math.sin(a)/1,this.czech||(e.y*=-1,e.x*=-1),e}function e8(e){var t,n,s,o,l,a,u,h,p=e.x;e.x=e.y,e.y=p,this.czech||(e.y*=-1,e.x*=-1),a=Math.sqrt(e.x*e.x+e.y*e.y),l=Math.atan2(e.y,e.x),o=l/Math.sin(this.s0),s=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(s)-Math.sin(this.ad)*Math.cos(s)*Math.cos(o)),n=Math.asin(Math.cos(s)*Math.sin(o)/Math.cos(t)),e.x=this.long0-n/this.alfa,u=t,h=0;var d=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.e/2))-this.s45),Math.abs(u-e.y)<1e-10&&(h=1),u=e.y,d+=1;while(h===0&&d<15);return d>=15?null:e}var t8,YC,XC=R(()=>{qt();t8=["Krovak","krovak"],YC={init:K6,forward:J6,inverse:e8,names:t8}});function Bn(e,t,n,s,o){return e*o-t*Math.sin(2*o)+n*Math.sin(4*o)-s*Math.sin(6*o)}var Sd=R(()=>{});function Ur(e){return 1-.25*e*(1+e/16*(3+1.25*e))}var Ed=R(()=>{});function zr(e){return .375*e*(1+.25*e*(1+.46875*e))}var Cd=R(()=>{});function Vr(e){return .05859375*e*e*(1+.75*e)}var Id=R(()=>{});function Hr(e){return e*e*e*(35/3072)}var Ld=R(()=>{});function Nd(e,t,n){var s=t*n;return e/Math.sqrt(1-s*s)}var M0=R(()=>{});function Gi(e){return Math.abs(e)<xe?e:e-hr(e)*Math.PI}var Ua=R(()=>{xt();Xl()});function za(e,t,n,s,o){var l,a;l=e/t;for(var u=0;u<15;u++)if(a=(e-(t*l-n*Math.sin(2*l)+s*Math.sin(4*l)-o*Math.sin(6*l)))/(t-2*n*Math.cos(2*l)+4*s*Math.cos(4*l)-6*o*Math.cos(6*l)),l+=a,Math.abs(a)<=1e-10)return l;return NaN}var Bp=R(()=>{});function n8(){this.sphere||(this.e0=Ur(this.es),this.e1=zr(this.es),this.e2=Vr(this.es),this.e3=Hr(this.es),this.ml0=this.a*Bn(this.e0,this.e1,this.e2,this.e3,this.lat0))}function i8(e){var t,n,s=e.x,o=e.y;if(s=Ne(s-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(o)*Math.sin(s)),n=this.a*(Math.atan2(Math.tan(o),Math.cos(s))-this.lat0);else{var l=Math.sin(o),a=Math.cos(o),u=Nd(this.a,this.e,l),h=Math.tan(o)*Math.tan(o),p=s*Math.cos(o),d=p*p,_=this.es*a*a/(1-this.es),m=this.a*Bn(this.e0,this.e1,this.e2,this.e3,o);t=u*p*(1-d*h*(1/6-(8-h+8*_)*d/120)),n=m-this.ml0+u*l/a*d*(.5+(5-h+6*_)*d/24)}return e.x=t+this.x0,e.y=n+this.y0,e}function s8(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,n=e.y/this.a,s,o;if(this.sphere){var l=n+this.lat0;s=Math.asin(Math.sin(l)*Math.cos(t)),o=Math.atan2(Math.tan(t),Math.cos(l))}else{var a=this.ml0/this.a+n,u=za(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(u)-xe)<=Te)return e.x=this.long0,e.y=xe,n<0&&(e.y*=-1),e;var h=Nd(this.a,this.e,Math.sin(u)),p=h*h*h/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(u),2),_=t*this.a/h,m=_*_;s=u-h*Math.tan(u)/p*_*_*(.5-(1+3*d)*_*_/24),o=_*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(u)}return e.x=Ne(o+this.long0),e.y=Gi(s),e}var r8,ZC,QC=R(()=>{Sd();Ed();Cd();Id();Ld();M0();qt();Ua();Bp();xt();r8=["Cassini","Cassini_Soldner","cass"],ZC={init:n8,forward:i8,inverse:s8,names:r8}});function Hs(e,t){var n;return e>1e-7?(n=e*t,(1-e*e)*(t/(1-n*n)-.5/e*Math.log((1-n)/(1+n)))):2*t}var Up=R(()=>{});function o8(){var e=Math.abs(this.lat0);if(Math.abs(e-xe)<Te?this.mode=this.lat0<0?A0:O0:Math.abs(e)<Te?this.mode=P0:this.mode=zp,this.es>0){var t;switch(this.qp=Hs(this.e,1),this.mmf=.5/(1-this.es),this.apa=g8(this.es),this.mode){case O0:this.dd=1;break;case A0:this.dd=1;break;case P0:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case zp:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Hs(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===zp&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function a8(e){var t,n,s,o,l,a,u,h,p,d,_=e.x,m=e.y;if(_=Ne(_-this.long0),this.sphere){if(l=Math.sin(m),d=Math.cos(m),s=Math.cos(_),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+d*s:1+this.sinph0*l+this.cosph0*d*s,n<=Te)return null;n=Math.sqrt(2/n),t=n*d*Math.sin(_),n*=this.mode===this.EQUIT?l:this.cosph0*l-this.sinph0*d*s}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(s=-s),Math.abs(m+this.lat0)<Te)return null;n=Lt-m*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),t=n*Math.sin(_),n*=s}}else{switch(u=0,h=0,p=0,s=Math.cos(_),o=Math.sin(_),l=Math.sin(m),a=Hs(this.e,l),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(u=a/this.qp,h=Math.sqrt(1-u*u)),this.mode){case this.OBLIQ:p=1+this.sinb1*u+this.cosb1*h*s;break;case this.EQUIT:p=1+h*s;break;case this.N_POLE:p=xe+m,a=this.qp-a;break;case this.S_POLE:p=m-xe,a=this.qp+a;break}if(Math.abs(p)<Te)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:p=Math.sqrt(2/p),this.mode===this.OBLIQ?n=this.ymf*p*(this.cosb1*u-this.sinb1*h*s):n=(p=Math.sqrt(2/(1+h*s)))*u*this.ymf,t=this.xmf*p*h*o;break;case this.N_POLE:case this.S_POLE:a>=0?(t=(p=Math.sqrt(a))*o,n=s*(this.mode===this.S_POLE?p:-p)):t=n=0;break}}return e.x=this.a*t+this.x0,e.y=this.a*n+this.y0,e}function l8(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,n=e.y/this.a,s,o,l,a,u,h,p;if(this.sphere){var d=0,_,m=0;if(_=Math.sqrt(t*t+n*n),o=_*.5,o>1)return null;switch(o=2*Math.asin(o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(o),d=Math.cos(o)),this.mode){case this.EQUIT:o=Math.abs(_)<=Te?0:Math.asin(n*m/_),t*=m,n=d*_;break;case this.OBLIQ:o=Math.abs(_)<=Te?this.lat0:Math.asin(d*this.sinph0+n*m*this.cosph0/_),t*=m*this.cosph0,n=(d-Math.sin(o)*this.sinph0)*_;break;case this.N_POLE:n=-n,o=xe-o;break;case this.S_POLE:o-=xe;break}s=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,n)}else{if(p=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,n*=this.dd,h=Math.sqrt(t*t+n*n),h<Te)return e.x=this.long0,e.y=this.lat0,e;a=2*Math.asin(.5*h/this.rq),l=Math.cos(a),t*=a=Math.sin(a),this.mode===this.OBLIQ?(p=l*this.sinb1+n*a*this.cosb1/h,u=this.qp*p,n=h*this.cosb1*l-n*this.sinb1*a):(p=n*a/h,u=this.qp*p,n=h*l)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),u=t*t+n*n,!u)return e.x=this.long0,e.y=this.lat0,e;p=1-u/this.qp,this.mode===this.S_POLE&&(p=-p)}s=Math.atan2(t,n),o=m8(Math.asin(p),this.apa)}return e.x=Ne(this.long0+s),e.y=o,e}function g8(e){var t,n=[];return n[0]=e*c8,t=e*e,n[0]+=t*u8,n[1]=t*h8,t*=e,n[0]+=t*d8,n[1]+=t*f8,n[2]=t*p8,n}function m8(e,t){var n=e+e;return e+t[0]*Math.sin(n)+t[1]*Math.sin(n+n)+t[2]*Math.sin(n+n+n)}var A0,O0,P0,zp,c8,u8,d8,h8,f8,p8,_8,KC,JC=R(()=>{xt();Up();qt();A0=1,O0=2,P0=3,zp=4;c8=.3333333333333333,u8=.17222222222222222,d8=.10257936507936508,h8=.06388888888888888,f8=.0664021164021164,p8=.016415012942191543;_8=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],KC={init:o8,forward:a8,inverse:l8,names:_8,S_POLE:A0,N_POLE:O0,EQUIT:P0,OBLIQ:zp}});function ji(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}var Va=R(()=>{});function y8(){Math.abs(this.lat1+this.lat2)<Te||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ai(this.e3,this.sin_po,this.cos_po),this.qs1=Hs(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ai(this.e3,this.sin_po,this.cos_po),this.qs2=Hs(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Hs(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Te?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function v8(e){var t=e.x,n=e.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var s=Hs(this.e3,this.sin_phi),o=this.a*Math.sqrt(this.c-this.ns0*s)/this.ns0,l=this.ns0*Ne(t-this.long0),a=o*Math.sin(l)+this.x0,u=this.rh-o*Math.cos(l)+this.y0;return e.x=a,e.y=u,e}function b8(e){var t,n,s,o,l,a;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),s=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),s=-1),o=0,t!==0&&(o=Math.atan2(s*e.x,s*e.y)),s=t*this.ns0/this.a,this.sphere?a=Math.asin((this.c-s*s)/(2*this.ns0)):(n=(this.c-s*s)/this.ns0,a=this.phi1z(this.e3,n)),l=Ne(o/this.ns0+this.long0),e.x=l,e.y=a,e}function x8(e,t){var n,s,o,l,a,u=ji(.5*t);if(e<Te)return u;for(var h=e*e,p=1;p<=25;p++)if(n=Math.sin(u),s=Math.cos(u),o=e*n,l=1-o*o,a=.5*l*l/s*(t/(1-h)-n/l+.5/e*Math.log((1-o)/(1+o))),u=u+a,Math.abs(a)<=1e-7)return u;return null}var w8,e2,t2=R(()=>{ja();Up();qt();Va();xt();w8=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"],e2={init:y8,forward:v8,inverse:b8,names:w8,phi1z:x8}});function S8(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function E8(e){var t,n,s,o,l,a,u,h,p=e.x,d=e.y;return s=Ne(p-this.long0),t=Math.sin(d),n=Math.cos(d),o=Math.cos(s),a=this.sin_p14*t+this.cos_p14*n*o,l=1,a>0||Math.abs(a)<=Te?(u=this.x0+this.a*l*n*Math.sin(s)/a,h=this.y0+this.a*l*(this.cos_p14*t-this.sin_p14*n*o)/a):(u=this.x0+this.infinity_dist*n*Math.sin(s),h=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*n*o)),e.x=u,e.y=h,e}function C8(e){var t,n,s,o,l,a;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(o=Math.atan2(t,this.rc),n=Math.sin(o),s=Math.cos(o),a=ji(s*this.sin_p14+e.y*n*this.cos_p14/t),l=Math.atan2(e.x*n,t*this.cos_p14*s-e.y*this.sin_p14*n),l=Ne(this.long0+l)):(a=this.phic0,l=0),e.x=l,e.y=a,e}var I8,n2,i2=R(()=>{qt();Va();xt();I8=["gnom"],n2={init:S8,forward:E8,inverse:C8,names:I8}});function s2(e,t){var n=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-n)<1e-6)return t<0?-1*xe:xe;for(var s=Math.asin(.5*t),o,l,a,u,h=0;h<30;h++)if(l=Math.sin(s),a=Math.cos(s),u=e*l,o=Math.pow(1-u*u,2)/(2*a)*(t/(1-e*e)-l/(1-u*u)+.5/e*Math.log((1-u)/(1+u))),s+=o,Math.abs(o)<=1e-10)return s;return NaN}var r2=R(()=>{xt()});function L8(){this.sphere||(this.k0=ai(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function N8(e){var t=e.x,n=e.y,s,o,l=Ne(t-this.long0);if(this.sphere)s=this.x0+this.a*l*Math.cos(this.lat_ts),o=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var a=Hs(this.e,Math.sin(n));s=this.x0+this.a*this.k0*l,o=this.y0+this.a*a*.5/this.k0}return e.x=s,e.y=o,e}function T8(e){e.x-=this.x0,e.y-=this.y0;var t,n;return this.sphere?(t=Ne(this.long0+e.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(n=s2(this.e,2*e.y*this.k0/this.a),t=Ne(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=n,e}var k8,o2,a2=R(()=>{qt();Up();ja();r2();k8=["cea"],o2={init:L8,forward:N8,inverse:T8,names:k8}});function R8(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function M8(e){var t=e.x,n=e.y,s=Ne(t-this.long0),o=Gi(n-this.lat0);return e.x=this.x0+this.a*s*this.rc,e.y=this.y0+this.a*o,e}function A8(e){var t=e.x,n=e.y;return e.x=Ne(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=Gi(this.lat0+(n-this.y0)/this.a),e}var O8,l2,c2=R(()=>{qt();Ua();O8=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"],l2={init:R8,forward:M8,inverse:A8,names:O8}});function P8(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ur(this.es),this.e1=zr(this.es),this.e2=Vr(this.es),this.e3=Hr(this.es),this.ml0=this.a*Bn(this.e0,this.e1,this.e2,this.e3,this.lat0)}function F8(e){var t=e.x,n=e.y,s,o,l,a=Ne(t-this.long0);if(l=a*Math.sin(n),this.sphere)Math.abs(n)<=Te?(s=this.a*a,o=-1*this.a*this.lat0):(s=this.a*Math.sin(l)/Math.tan(n),o=this.a*(Gi(n-this.lat0)+(1-Math.cos(l))/Math.tan(n)));else if(Math.abs(n)<=Te)s=this.a*a,o=-1*this.ml0;else{var u=Nd(this.a,this.e,Math.sin(n))/Math.tan(n);s=u*Math.sin(l),o=this.a*Bn(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+u*(1-Math.cos(l))}return e.x=s+this.x0,e.y=o+this.y0,e}function D8(e){var t,n,s,o,l,a,u,h,p;if(s=e.x-this.x0,o=e.y-this.y0,this.sphere)if(Math.abs(o+this.a*this.lat0)<=Te)t=Ne(s/this.a+this.long0),n=0;else{a=this.lat0+o/this.a,u=s*s/this.a/this.a+a*a,h=a;var d;for(l=u2;l;--l)if(d=Math.tan(h),p=-1*(a*(h*d+1)-h-.5*(h*h+u)*d)/((h-a)/d-1),h+=p,Math.abs(p)<=Te){n=h;break}t=Ne(this.long0+Math.asin(s*Math.tan(h)/this.a)/Math.sin(n))}else if(Math.abs(o+this.ml0)<=Te)n=0,t=Ne(this.long0+s/this.a);else{a=(this.ml0+o)/this.a,u=s*s/this.a/this.a+a*a,h=a;var _,m,v,x,b;for(l=u2;l;--l)if(b=this.e*Math.sin(h),_=Math.sqrt(1-b*b)*Math.tan(h),m=this.a*Bn(this.e0,this.e1,this.e2,this.e3,h),v=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),x=m/this.a,p=(a*(_*x+1)-x-.5*_*(x*x+u))/(this.es*Math.sin(2*h)*(x*x+u-2*a*x)/(4*_)+(a-x)*(_*v-2/Math.sin(2*h))-v),h-=p,Math.abs(p)<=Te){n=h;break}_=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),t=Ne(this.long0+Math.asin(s*_/this.a)/Math.sin(n))}return e.x=t,e.y=n,e}var u2,G8,d2,h2=R(()=>{Ed();Cd();Id();Ld();qt();Ua();Sd();xt();M0();u2=20;G8=["Polyconic","American_Polyconic","poly"],d2={init:P8,forward:F8,inverse:D8,names:G8}});function j8(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function q8(e){var t,n=e.x,s=e.y,o=s-this.lat0,l=n-this.long0,a=o/Da*1e-5,u=l,h=1,p=0;for(t=1;t<=10;t++)h=h*a,p=p+this.A[t]*h;var d=p,_=u,m=1,v=0,x,b,w=0,L=0;for(t=1;t<=6;t++)x=m*d-v*_,b=v*d+m*_,m=x,v=b,w=w+this.B_re[t]*m-this.B_im[t]*v,L=L+this.B_im[t]*m+this.B_re[t]*v;return e.x=L*this.a+this.x0,e.y=w*this.a+this.y0,e}function $8(e){var t,n=e.x,s=e.y,o=n-this.x0,l=s-this.y0,a=l/this.a,u=o/this.a,h=1,p=0,d,_,m=0,v=0;for(t=1;t<=6;t++)d=h*a-p*u,_=p*a+h*u,h=d,p=_,m=m+this.C_re[t]*h-this.C_im[t]*p,v=v+this.C_im[t]*h+this.C_re[t]*p;for(var x=0;x<this.iterations;x++){var b=m,w=v,L,D,G=a,W=u;for(t=2;t<=6;t++)L=b*m-w*v,D=w*m+b*v,b=L,w=D,G=G+(t-1)*(this.B_re[t]*b-this.B_im[t]*w),W=W+(t-1)*(this.B_im[t]*b+this.B_re[t]*w);b=1,w=0;var P=this.B_re[1],j=this.B_im[1];for(t=2;t<=6;t++)L=b*m-w*v,D=w*m+b*v,b=L,w=D,P=P+t*(this.B_re[t]*b-this.B_im[t]*w),j=j+t*(this.B_im[t]*b+this.B_re[t]*w);var V=P*P+j*j;m=(G*P+W*j)/V,v=(W*P-G*j)/V}var H=m,se=v,M=1,ie=0;for(t=1;t<=9;t++)M=M*H,ie=ie+this.D[t]*M;var E=this.lat0+ie*Da*1e5,X=this.long0+se;return e.x=X,e.y=E,e}var B8,f2,p2=R(()=>{xt();B8=["New_Zealand_Map_Grid","nzmg"],f2={init:j8,forward:q8,inverse:$8,names:B8}});function U8(){}function z8(e){var t=e.x,n=e.y,s=Ne(t-this.long0),o=this.x0+this.a*s,l=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return e.x=o,e.y=l,e}function V8(e){e.x-=this.x0,e.y-=this.y0;var t=Ne(this.long0+e.x/this.a),n=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=n,e}var H8,g2,m2=R(()=>{qt();H8=["Miller_Cylindrical","mill"],g2={init:U8,forward:z8,inverse:V8,names:H8}});function Y8(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ec(this.es)}function X8(e){var t,n,s=e.x,o=e.y;if(s=Ne(s-this.long0),this.sphere){if(!this.m)o=this.n!==1?Math.asin(this.n*Math.sin(o)):o;else for(var l=this.n*Math.sin(o),a=W8;a;--a){var u=(this.m*o+Math.sin(o)-l)/(this.m+Math.cos(o));if(o-=u,Math.abs(u)<Te)break}t=this.a*this.C_x*s*(this.m+Math.cos(o)),n=this.a*this.C_y*o}else{var h=Math.sin(o),p=Math.cos(o);n=this.a*fr(o,h,p,this.en),t=this.a*s*p/Math.sqrt(1-this.es*h*h)}return e.x=t,e.y=n,e}function Z8(e){var t,n,s,o;return e.x-=this.x0,s=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,s=s/(this.C_x*(this.m+Math.cos(t))),this.m?t=ji((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=ji(Math.sin(t)/this.n)),s=Ne(s+this.long0),t=Gi(t)):(t=tc(e.y/this.a,this.es,this.en),o=Math.abs(t),o<xe?(o=Math.sin(t),n=this.long0+e.x*Math.sqrt(1-this.es*o*o)/(this.a*Math.cos(t)),s=Ne(n)):o-Te<xe&&(s=this.long0)),e.x=s,e.y=t,e}var W8,Q8,_2,y2=R(()=>{qt();Ua();Fp();wd();Dp();xt();Va();W8=20;Q8=["Sinusoidal","sinu"],_2={init:Y8,forward:X8,inverse:Z8,names:Q8}});function K8(){}function J8(e){for(var t=e.x,n=e.y,s=Ne(t-this.long0),o=n,l=Math.PI*Math.sin(n);;){var a=-(o+Math.sin(o)-l)/(1+Math.cos(o));if(o+=a,Math.abs(a)<Te)break}o/=2,Math.PI/2-Math.abs(n)<Te&&(s=0);var u=.900316316158*this.a*s*Math.cos(o)+this.x0,h=1.4142135623731*this.a*Math.sin(o)+this.y0;return e.x=u,e.y=h,e}function eD(e){var t,n;e.x-=this.x0,e.y-=this.y0,n=e.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),t=Math.asin(n);var s=Ne(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));s<-Math.PI&&(s=-Math.PI),s>Math.PI&&(s=Math.PI),n=(2*t+Math.sin(2*t))/Math.PI,Math.abs(n)>1&&(n=1);var o=Math.asin(n);return e.x=s,e.y=o,e}var tD,v2,b2=R(()=>{qt();xt();tD=["Mollweide","moll"],v2={init:K8,forward:J8,inverse:eD,names:tD}});function nD(){Math.abs(this.lat1+this.lat2)<Te||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ur(this.es),this.e1=zr(this.es),this.e2=Vr(this.es),this.e3=Hr(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=ai(this.e,this.sin_phi,this.cos_phi),this.ml1=Bn(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Te?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=ai(this.e,this.sin_phi,this.cos_phi),this.ml2=Bn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Bn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function iD(e){var t=e.x,n=e.y,s;if(this.sphere)s=this.a*(this.g-n);else{var o=Bn(this.e0,this.e1,this.e2,this.e3,n);s=this.a*(this.g-o)}var l=this.ns*Ne(t-this.long0),a=this.x0+s*Math.sin(l),u=this.y0+this.rh-s*Math.cos(l);return e.x=a,e.y=u,e}function sD(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,n,s,o;this.ns>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var l=0;if(n!==0&&(l=Math.atan2(t*e.x,t*e.y)),this.sphere)return o=Ne(this.long0+l/this.ns),s=Gi(this.g-n/this.a),e.x=o,e.y=s,e;var a=this.g-n/this.a;return s=za(a,this.e0,this.e1,this.e2,this.e3),o=Ne(this.long0+l/this.ns),e.x=o,e.y=s,e}var rD,x2,w2=R(()=>{Ed();Cd();Id();Ld();ja();Sd();qt();Ua();Bp();xt();rD=["Equidistant_Conic","eqdc"],x2={init:nD,forward:iD,inverse:sD,names:rD}});function oD(){this.R=this.a}function aD(e){var t=e.x,n=e.y,s=Ne(t-this.long0),o,l;Math.abs(n)<=Te&&(o=this.x0+this.R*s,l=this.y0);var a=ji(2*Math.abs(n/Math.PI));(Math.abs(s)<=Te||Math.abs(Math.abs(n)-xe)<=Te)&&(o=this.x0,n>=0?l=this.y0+Math.PI*this.R*Math.tan(.5*a):l=this.y0+Math.PI*this.R*-Math.tan(.5*a));var u=.5*Math.abs(Math.PI/s-s/Math.PI),h=u*u,p=Math.sin(a),d=Math.cos(a),_=d/(p+d-1),m=_*_,v=_*(2/p-1),x=v*v,b=Math.PI*this.R*(u*(_-x)+Math.sqrt(h*(_-x)*(_-x)-(x+h)*(m-x)))/(x+h);s<0&&(b=-b),o=this.x0+b;var w=h+_;return b=Math.PI*this.R*(v*w-u*Math.sqrt((x+h)*(h+1)-w*w))/(x+h),n>=0?l=this.y0+b:l=this.y0-b,e.x=o,e.y=l,e}function lD(e){var t,n,s,o,l,a,u,h,p,d,_,m,v;return e.x-=this.x0,e.y-=this.y0,_=Math.PI*this.R,s=e.x/_,o=e.y/_,l=s*s+o*o,a=-Math.abs(o)*(1+l),u=a-2*o*o+s*s,h=-2*a+1+2*o*o+l*l,v=o*o/h+(2*u*u*u/h/h/h-9*a*u/h/h)/27,p=(a-u*u/3/h)/h,d=2*Math.sqrt(-p/3),_=3*v/p/d,Math.abs(_)>1&&(_>=0?_=1:_=-1),m=Math.acos(_)/3,e.y>=0?n=(-d*Math.cos(m+Math.PI/3)-u/3/h)*Math.PI:n=-(-d*Math.cos(m+Math.PI/3)-u/3/h)*Math.PI,Math.abs(s)<Te?t=this.long0:t=Ne(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(s*s-o*o)+l*l))/2/s),e.x=t,e.y=n,e}var cD,S2,E2=R(()=>{qt();xt();Va();cD=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"],S2={init:oD,forward:aD,inverse:lD,names:cD}});function C2(e,t,n,s,o,l){let a=s-t,u=Math.atan((1-l)*Math.tan(e)),h=Math.atan((1-l)*Math.tan(n)),p=Math.sin(u),d=Math.cos(u),_=Math.sin(h),m=Math.cos(h),v=a,x,b=100,w,L,D,G,W,P,j,V,H,se,M,ie,E,X;do{if(w=Math.sin(v),L=Math.cos(v),D=Math.sqrt(m*w*(m*w)+(d*_-p*m*L)*(d*_-p*m*L)),D===0)return{azi1:0,s12:0};G=p*_+d*m*L,W=Math.atan2(D,G),P=d*m*w/D,j=1-P*P,V=j!==0?G-2*p*_/j:0,H=l/16*j*(4+l*(4-3*j)),x=v,v=a+(1-H)*l*P*(W+H*D*(V+H*G*(-1+2*V*V)))}while(Math.abs(v-x)>1e-12&&--b>0);return b===0?{azi1:NaN,s12:NaN}:(se=j*(o*o-o*(1-l)*(o*(1-l)))/(o*(1-l)*(o*(1-l))),M=1+se/16384*(4096+se*(-768+se*(320-175*se))),ie=se/1024*(256+se*(-128+se*(74-47*se))),E=ie*D*(V+ie/4*(G*(-1+2*V*V)-ie/6*V*(-3+4*D*D)*(-3+4*V*V))),X=o*(1-l)*M*(W-E),{azi1:Math.atan2(m*w,d*_-p*m*L),s12:X})}function I2(e,t,n,s,o,l){let a=Math.atan((1-l)*Math.tan(e)),u=Math.sin(a),h=Math.cos(a),p=Math.sin(n),d=Math.cos(n),_=Math.atan2(u,h*d),m=h*p,v=1-m*m,x=v*(o*o-o*(1-l)*(o*(1-l)))/(o*(1-l)*(o*(1-l))),b=1+x/16384*(4096+x*(-768+x*(320-175*x))),w=x/1024*(256+x*(-128+x*(74-47*x))),L=s/(o*(1-l)*b),D,G=100,W,P,j,V;do W=Math.cos(2*_+L),P=Math.sin(L),j=Math.cos(L),V=w*P*(W+w/4*(j*(-1+2*W*W)-w/6*W*(-3+4*P*P)*(-3+4*W*W))),D=L,L=s/(o*(1-l)*b)+V;while(Math.abs(L-D)>1e-12&&--G>0);if(G===0)return{lat2:NaN,lon2:NaN};let H=u*P-h*j*d,se=Math.atan2(u*j+h*P*d,(1-l)*Math.sqrt(m*m+H*H)),M=Math.atan2(P*p,h*j-u*P*d),ie=l/16*v*(4+l*(4-3*v)),E=M-(1-ie)*l*m*(L+ie*P*(W+ie*j*(-1+2*W*W))),X=t+E;return{lat2:se,lon2:X}}var L2=R(()=>{});function uD(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function dD(e){var t=e.x,n=e.y,s=Math.sin(e.y),o=Math.cos(e.y),l=Ne(t-this.long0),a,u,h,p,d,_,m,v,x,b,w;return this.sphere?Math.abs(this.sin_p12-1)<=Te?(e.x=this.x0+this.a*(xe-n)*Math.sin(l),e.y=this.y0-this.a*(xe-n)*Math.cos(l),e):Math.abs(this.sin_p12+1)<=Te?(e.x=this.x0+this.a*(xe+n)*Math.sin(l),e.y=this.y0+this.a*(xe+n)*Math.cos(l),e):(x=this.sin_p12*s+this.cos_p12*o*Math.cos(l),m=Math.acos(x),v=m?m/Math.sin(m):1,e.x=this.x0+this.a*v*o*Math.sin(l),e.y=this.y0+this.a*v*(this.cos_p12*s-this.sin_p12*o*Math.cos(l)),e):(a=Ur(this.es),u=zr(this.es),h=Vr(this.es),p=Hr(this.es),Math.abs(this.sin_p12-1)<=Te?(d=this.a*Bn(a,u,h,p,xe),_=this.a*Bn(a,u,h,p,n),e.x=this.x0+(d-_)*Math.sin(l),e.y=this.y0-(d-_)*Math.cos(l),e):Math.abs(this.sin_p12+1)<=Te?(d=this.a*Bn(a,u,h,p,xe),_=this.a*Bn(a,u,h,p,n),e.x=this.x0+(d+_)*Math.sin(l),e.y=this.y0+(d+_)*Math.cos(l),e):Math.abs(t)<Te&&Math.abs(n-this.lat0)<Te?(e.x=e.y=0,e):(b=C2(this.lat0,this.long0,n,t,this.a,this.f),w=b.azi1,e.x=b.s12*Math.sin(w),e.y=b.s12*Math.cos(w),e))}function hD(e){e.x-=this.x0,e.y-=this.y0;var t,n,s,o,l,a,u,h,p,d,_,m,v,x,b,w;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*xe*this.a?void 0:(n=t/this.a,s=Math.sin(n),o=Math.cos(n),l=this.long0,Math.abs(t)<=Te?a=this.lat0:(a=ji(o*this.sin_p12+e.y*s*this.cos_p12/t),u=Math.abs(this.lat0)-xe,Math.abs(u)<=Te?this.lat0>=0?l=Ne(this.long0+Math.atan2(e.x,-e.y)):l=Ne(this.long0-Math.atan2(-e.x,e.y)):l=Ne(this.long0+Math.atan2(e.x*s,t*this.cos_p12*o-e.y*this.sin_p12*s))),e.x=l,e.y=a,e)):(h=Ur(this.es),p=zr(this.es),d=Vr(this.es),_=Hr(this.es),Math.abs(this.sin_p12-1)<=Te?(m=this.a*Bn(h,p,d,_,xe),t=Math.sqrt(e.x*e.x+e.y*e.y),v=m-t,a=za(v/this.a,h,p,d,_),l=Ne(this.long0+Math.atan2(e.x,-1*e.y)),e.x=l,e.y=a,e):Math.abs(this.sin_p12+1)<=Te?(m=this.a*Bn(h,p,d,_,xe),t=Math.sqrt(e.x*e.x+e.y*e.y),v=t-m,a=za(v/this.a,h,p,d,_),l=Ne(this.long0+Math.atan2(e.x,e.y)),e.x=l,e.y=a,e):(x=Math.atan2(e.x,e.y),b=Math.sqrt(e.x*e.x+e.y*e.y),w=I2(this.lat0,this.long0,x,b,this.a,this.f),e.x=w.lon2,e.y=w.lat2,e))}var fD,N2,T2=R(()=>{qt();xt();Sd();Ed();Cd();Id();Ld();Va();Bp();L2();fD=["Azimuthal_Equidistant","aeqd"],N2={init:uD,forward:dD,inverse:hD,names:fD}});function pD(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function gD(e){var t,n,s,o,l,a,u,h,p=e.x,d=e.y;return s=Ne(p-this.long0),t=Math.sin(d),n=Math.cos(d),o=Math.cos(s),a=this.sin_p14*t+this.cos_p14*n*o,l=1,(a>0||Math.abs(a)<=Te)&&(u=this.a*l*n*Math.sin(s),h=this.y0+this.a*l*(this.cos_p14*t-this.sin_p14*n*o)),e.x=u,e.y=h,e}function mD(e){var t,n,s,o,l,a,u;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),n=ji(t/this.a),s=Math.sin(n),o=Math.cos(n),a=this.long0,Math.abs(t)<=Te?(u=this.lat0,e.x=a,e.y=u,e):(u=ji(o*this.sin_p14+e.y*s*this.cos_p14/t),l=Math.abs(this.lat0)-xe,Math.abs(l)<=Te?(this.lat0>=0?a=Ne(this.long0+Math.atan2(e.x,-e.y)):a=Ne(this.long0-Math.atan2(-e.x,e.y)),e.x=a,e.y=u,e):(a=Ne(this.long0+Math.atan2(e.x*s,t*this.cos_p14*o-e.y*this.sin_p14*s)),e.x=a,e.y=u,e))}var _D,k2,R2=R(()=>{qt();Va();xt();_D=["ortho"],k2={init:pD,forward:gD,inverse:mD,names:_D}});function yD(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=xe-Lt/2?this.face=hn.TOP:this.lat0<=-(xe-Lt/2)?this.face=hn.BOTTOM:Math.abs(this.long0)<=Lt?this.face=hn.FRONT:Math.abs(this.long0)<=xe+Lt?this.face=this.long0>0?hn.RIGHT:hn.LEFT:this.face=hn.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function vD(e){var t={x:0,y:0},n,s,o,l,a,u,h={value:0};if(e.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):n=e.y,s=e.x,this.face===hn.TOP)l=xe-n,s>=Lt&&s<=xe+Lt?(h.value=Dt.AREA_0,o=s-xe):s>xe+Lt||s<=-(xe+Lt)?(h.value=Dt.AREA_1,o=s>0?s-dn:s+dn):s>-(xe+Lt)&&s<=-Lt?(h.value=Dt.AREA_2,o=s+xe):(h.value=Dt.AREA_3,o=s);else if(this.face===hn.BOTTOM)l=xe+n,s>=Lt&&s<=xe+Lt?(h.value=Dt.AREA_0,o=-s+xe):s<Lt&&s>=-Lt?(h.value=Dt.AREA_1,o=-s):s<-Lt&&s>=-(xe+Lt)?(h.value=Dt.AREA_2,o=-s-xe):(h.value=Dt.AREA_3,o=s>0?-s+dn:-s-dn);else{var p,d,_,m,v,x,b;this.face===hn.RIGHT?s=rc(s,+xe):this.face===hn.BACK?s=rc(s,+dn):this.face===hn.LEFT&&(s=rc(s,-xe)),m=Math.sin(n),v=Math.cos(n),x=Math.sin(s),b=Math.cos(s),p=v*b,d=v*x,_=m,this.face===hn.FRONT?(l=Math.acos(p),o=Vp(l,_,d,h)):this.face===hn.RIGHT?(l=Math.acos(d),o=Vp(l,_,-p,h)):this.face===hn.BACK?(l=Math.acos(-p),o=Vp(l,_,-d,h)):this.face===hn.LEFT?(l=Math.acos(-d),o=Vp(l,_,p,h)):(l=o=0,h.value=Dt.AREA_0)}return u=Math.atan(12/dn*(o+Math.acos(Math.sin(o)*Math.cos(Lt))-xe)),a=Math.sqrt((1-Math.cos(l))/(Math.cos(u)*Math.cos(u))/(1-Math.cos(Math.atan(1/Math.cos(o))))),h.value===Dt.AREA_1?u+=xe:h.value===Dt.AREA_2?u+=dn:h.value===Dt.AREA_3&&(u+=1.5*dn),t.x=a*Math.cos(u),t.y=a*Math.sin(u),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e}function bD(e){var t={lam:0,phi:0},n,s,o,l,a,u,h,p,d,_={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,s=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),n=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?_.value=Dt.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(_.value=Dt.AREA_1,n-=xe):e.x<0&&-e.x>=Math.abs(e.y)?(_.value=Dt.AREA_2,n=n<0?n+dn:n-dn):(_.value=Dt.AREA_3,n+=xe),d=dn/12*Math.tan(n),a=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),u=Math.atan(a),o=Math.cos(n),l=Math.tan(s),h=1-o*o*l*l*(1-Math.cos(Math.atan(1/Math.cos(u)))),h<-1?h=-1:h>1&&(h=1),this.face===hn.TOP)p=Math.acos(h),t.phi=xe-p,_.value===Dt.AREA_0?t.lam=u+xe:_.value===Dt.AREA_1?t.lam=u<0?u+dn:u-dn:_.value===Dt.AREA_2?t.lam=u-xe:t.lam=u;else if(this.face===hn.BOTTOM)p=Math.acos(h),t.phi=p-xe,_.value===Dt.AREA_0?t.lam=-u+xe:_.value===Dt.AREA_1?t.lam=-u:_.value===Dt.AREA_2?t.lam=-u-xe:t.lam=u<0?-u-dn:-u+dn;else{var m,v,x;m=h,d=m*m,d>=1?x=0:x=Math.sqrt(1-d)*Math.sin(u),d+=x*x,d>=1?v=0:v=Math.sqrt(1-d),_.value===Dt.AREA_1?(d=v,v=-x,x=d):_.value===Dt.AREA_2?(v=-v,x=-x):_.value===Dt.AREA_3&&(d=v,v=x,x=-d),this.face===hn.RIGHT?(d=m,m=-v,v=d):this.face===hn.BACK?(m=-m,v=-v):this.face===hn.LEFT&&(d=m,m=v,v=-d),t.phi=Math.acos(-x)-xe,t.lam=Math.atan2(v,m),this.face===hn.RIGHT?t.lam=rc(t.lam,-xe):this.face===hn.BACK?t.lam=rc(t.lam,-dn):this.face===hn.LEFT&&(t.lam=rc(t.lam,+xe))}if(this.es!==0){var b,w,L;b=t.phi<0?1:0,w=Math.tan(t.phi),L=this.b/Math.sqrt(w*w+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-L*L)/(this.one_minus_f*L)),b&&(t.phi=-t.phi)}return t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e}function Vp(e,t,n,s){var o;return e<Te?(s.value=Dt.AREA_0,o=0):(o=Math.atan2(t,n),Math.abs(o)<=Lt?s.value=Dt.AREA_0:o>Lt&&o<=xe+Lt?(s.value=Dt.AREA_1,o-=xe):o>xe+Lt||o<=-(xe+Lt)?(s.value=Dt.AREA_2,o=o>=0?o-dn:o+dn):(s.value=Dt.AREA_3,o+=xe)),o}function rc(e,t){var n=e+t;return n<-dn?n+=Bo:n>+dn&&(n-=Bo),n}var hn,Dt,xD,M2,A2=R(()=>{xt();hn={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Dt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};xD=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"],M2={init:yD,forward:vD,inverse:bD,names:xD}});function ED(e,t,n,s){for(var o=t;s;--s){var l=e(o);if(o-=l,Math.abs(l)<n)break}return o}function CD(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function ID(e){var t=Ne(e.x-this.long0),n=Math.abs(e.y),s=Math.floor(n*F2);s<0?s=0:s>=oc&&(s=oc-1),n=Pi*(n-wD*s);var o={x:Hp(F0[s],n)*t,y:Hp(Td[s],n)};return e.y<0&&(o.y=-o.y),o.x=o.x*this.a*O2+this.x0,o.y=o.y*this.a*P2+this.y0,o}function LD(e){var t={x:(e.x-this.x0)/(this.a*O2),y:Math.abs(e.y-this.y0)/(this.a*P2)};if(t.y>=1)t.x/=F0[oc][0],t.y=e.y<0?-xe:xe;else{var n=Math.floor(t.y*oc);for(n<0?n=0:n>=oc&&(n=oc-1);;)if(Td[n][0]>t.y)--n;else if(Td[n+1][0]<=t.y)++n;else break;var s=Td[n],o=5*(t.y-s[0])/(Td[n+1][0]-s[0]);o=ED(function(l){return(Hp(s,l)-t.y)/SD(s,l)},o,Te,100),t.x/=Hp(F0[n],o),t.y=(5*n+o)*bn,e.y<0&&(t.y=-t.y)}return t.x=Ne(t.x+this.long0),t}var F0,Td,O2,P2,F2,wD,oc,Hp,SD,ND,D2,G2=R(()=>{xt();qt();F0=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Td=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],O2=.8487,P2=1.3523,F2=Pi/5,wD=1/F2,oc=18,Hp=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},SD=function(e,t){return e[1]+t*(2*e[2]+t*3*e[3])};ND=["Robinson","robin"],D2={init:CD,forward:ID,inverse:LD,names:ND}});function TD(){this.name="geocent"}function kD(e){var t=Rp(e,this.es,this.a);return t}function RD(e){var t=Mp(e,this.es,this.a,this.b);return t}var MD,j2,q2=R(()=>{_0();MD=["Geocentric","geocentric","geocent","Geocent"],j2={init:TD,forward:kD,inverse:RD,names:MD}});function AD(){if(Object.keys(kd).forEach(function(n){if(typeof this[n]>"u")this[n]=kd[n].def;else{if(kd[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);kd[n].num&&(this[n]=parseFloat(this[n]))}kd[n].degrees&&(this[n]=this[n]*bn)}.bind(this)),Math.abs(Math.abs(this.lat0)-xe)<Te?this.mode=this.lat0<0?li.S_POLE:li.N_POLE:Math.abs(this.lat0)<Te?this.mode=li.EQUIT:(this.mode=li.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)}function OD(e){e.x-=this.long0;var t=Math.sin(e.y),n=Math.cos(e.y),s=Math.cos(e.x),o,l;switch(this.mode){case li.OBLIQ:l=this.sinph0*t+this.cosph0*n*s;break;case li.EQUIT:l=n*s;break;case li.S_POLE:l=-t;break;case li.N_POLE:l=t;break}switch(l=this.pn1/(this.p-l),o=l*n*Math.sin(e.x),this.mode){case li.OBLIQ:l*=this.cosph0*t-this.sinph0*n*s;break;case li.EQUIT:l*=t;break;case li.N_POLE:l*=-(n*s);break;case li.S_POLE:l*=n*s;break}var a,u;return a=l*this.cg+o*this.sg,u=1/(a*this.sw*this.h1+this.cw),o=(o*this.cg-l*this.sg)*this.cw*u,l=a*u,e.x=o*this.a,e.y=l*this.a,e}function PD(e){e.x/=this.a,e.y/=this.a;var t={x:e.x,y:e.y},n,s,o;o=1/(this.pn1-e.y*this.sw),n=this.pn1*e.x*o,s=this.pn1*e.y*this.cw*o,e.x=n*this.cg+s*this.sg,e.y=s*this.cg-n*this.sg;var l=An(e.x,e.y);if(Math.abs(l)<Te)t.x=0,t.y=e.y;else{var a,u;switch(u=1-l*l*this.pfact,u=(this.p-Math.sqrt(u))/(this.pn1/l+l/this.pn1),a=Math.sqrt(1-u*u),this.mode){case li.OBLIQ:t.y=Math.asin(a*this.sinph0+e.y*u*this.cosph0/l),e.y=(a-this.sinph0*Math.sin(t.y))*l,e.x*=u*this.cosph0;break;case li.EQUIT:t.y=Math.asin(e.y*u/l),e.y=a*l,e.x*=u;break;case li.N_POLE:t.y=Math.asin(a),e.y=-e.y;break;case li.S_POLE:t.y=-Math.asin(a);break}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e}var li,kd,FD,$2,B2=R(()=>{xt();Ba();li={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},kd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};FD=["Tilted_Perspective","tpers"],$2={init:AD,forward:OD,inverse:PD,names:FD}});function DD(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function GD(e){var t=e.x,n=e.y,s,o,l,a;if(t=t-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var u=this.radius_p/An(this.radius_p*Math.cos(n),Math.sin(n));if(o=u*Math.cos(t)*Math.cos(n),l=u*Math.sin(t)*Math.cos(n),a=u*Math.sin(n),(this.radius_g-o)*o-l*l-a*a*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=this.radius_g-o,this.flip_axis?(e.x=this.radius_g_1*Math.atan(l/An(a,s)),e.y=this.radius_g_1*Math.atan(a/s)):(e.x=this.radius_g_1*Math.atan(l/s),e.y=this.radius_g_1*Math.atan(a/An(l,s)))}else this.shape==="sphere"&&(s=Math.cos(n),o=Math.cos(t)*s,l=Math.sin(t)*s,a=Math.sin(n),s=this.radius_g-o,this.flip_axis?(e.x=this.radius_g_1*Math.atan(l/An(a,s)),e.y=this.radius_g_1*Math.atan(a/s)):(e.x=this.radius_g_1*Math.atan(l/s),e.y=this.radius_g_1*Math.atan(a/An(l,s))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function jD(e){var t=-1,n=0,s=0,o,l,a,u;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(s=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*An(1,s)):(n=Math.tan(e.x/this.radius_g_1),s=Math.tan(e.y/this.radius_g_1)*An(1,n));var h=s/this.radius_p;if(o=n*n+h*h+t*t,l=2*this.radius_g*t,a=l*l-4*o*this.C,a<0)return e.x=Number.NaN,e.y=Number.NaN,e;u=(-l-Math.sqrt(a))/(2*o),t=this.radius_g+u*t,n*=u,s*=u,e.x=Math.atan2(n,t),e.y=Math.atan(s*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(s=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+s*s)):(n=Math.tan(e.x/this.radius_g_1),s=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+n*n)),o=n*n+s*s+t*t,l=2*this.radius_g*t,a=l*l-4*o*this.C,a<0)return e.x=Number.NaN,e.y=Number.NaN,e;u=(-l-Math.sqrt(a))/(2*o),t=this.radius_g+u*t,n*=u,s*=u,e.x=Math.atan2(n,t),e.y=Math.atan(s*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e}var qD,U2,z2=R(()=>{Ba();qD=["Geostationary Satellite View","Geostationary_Satellite","geos"],U2={init:DD,forward:GD,inverse:jD,names:qD}});function $D(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function BD(e){var t=Ne(e.x-this.long0),n=e.y,s=Math.asin(Wp*Math.sin(n)),o=s*s,l=o*o*o;return e.x=t*Math.cos(s)/(Wp*(Rd+3*Md*o+l*(7*Ad+9*Od*o))),e.y=s*(Rd+Md*o+l*(Ad+Od*o)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function UD(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t=1e-9,n=12,s=e.y,o,l,a,u,h,p;for(p=0;p<n&&(o=s*s,l=o*o*o,a=s*(Rd+Md*o+l*(Ad+Od*o))-e.y,u=Rd+3*Md*o+l*(7*Ad+9*Od*o),s-=h=a/u,!(Math.abs(h)<t));++p);return o=s*s,l=o*o*o,e.x=Wp*e.x*(Rd+3*Md*o+l*(7*Ad+9*Od*o))/Math.cos(s),e.y=Math.asin(Math.sin(s)/Wp),e.x=Ne(e.x+this.long0),e}var Rd,Md,Ad,Od,Wp,zD,V2,H2=R(()=>{qt();Rd=1.340264,Md=-.081106,Ad=893e-6,Od=.003796,Wp=Math.sqrt(3)/2;zD=["eqearth","Equal Earth","Equal_Earth"],V2={init:$D,forward:BD,inverse:UD,names:zD}});function VD(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<Pd)throw new Error;this.es?(this.en=ec(this.es),this.m1=fr(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=WD,this.forward=HD):(Math.abs(this.phi1)+Pd>=xe?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=XD,this.forward=YD)}function HD(e){var t=Ne(e.x-(this.long0||0)),n=e.y,s,o,l;return s=this.am1+this.m1-fr(n,o=Math.sin(n),l=Math.cos(n),this.en),o=l*t/(s*Math.sqrt(1-this.es*o*o)),e.x=s*Math.sin(o),e.y=this.am1-s*Math.cos(o),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function WD(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,s,o;if(n=An(e.x,e.y=this.am1-e.y),o=tc(this.am1+this.m1-n,this.es,this.en),(t=Math.abs(o))<xe)t=Math.sin(o),s=n*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(o);else if(Math.abs(t-xe)<=Pd)s=0;else throw new Error;return e.x=Ne(s+(this.long0||0)),e.y=Gi(o),e}function YD(e){var t=Ne(e.x-(this.long0||0)),n=e.y,s,o;return o=this.cphi1+this.phi1-n,Math.abs(o)>Pd?(e.x=o*Math.sin(s=t*Math.cos(n)/o),e.y=this.cphi1-o*Math.cos(s)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function XD(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,s=An(e.x,e.y=this.cphi1-e.y);if(n=this.cphi1+this.phi1-s,Math.abs(n)>xe)throw new Error;return Math.abs(Math.abs(n)-xe)<=Pd?t=0:t=s*Math.atan2(e.x,e.y)/Math.cos(n),e.x=Ne(t+(this.long0||0)),e.y=Gi(n),e}var Pd,ZD,W2,Y2=R(()=>{Ua();qt();Ba();Fp();Dp();wd();xt();Pd=1e-10;ZD=["bonne","Bonne (Werner lat_1=90)"],W2={init:VD,names:ZD}});function X2(e){e.Proj.projections.add(nc),e.Proj.projections.add(ic),e.Proj.projections.add(OC),e.Proj.projections.add(GC),e.Proj.projections.add(qC),e.Proj.projections.add(BC),e.Proj.projections.add(zC),e.Proj.projections.add(HC),e.Proj.projections.add(YC),e.Proj.projections.add(ZC),e.Proj.projections.add(KC),e.Proj.projections.add(e2),e.Proj.projections.add(n2),e.Proj.projections.add(o2),e.Proj.projections.add(l2),e.Proj.projections.add(d2),e.Proj.projections.add(f2),e.Proj.projections.add(g2),e.Proj.projections.add(_2),e.Proj.projections.add(v2),e.Proj.projections.add(x2),e.Proj.projections.add(S2),e.Proj.projections.add(N2),e.Proj.projections.add(k2),e.Proj.projections.add(M2),e.Proj.projections.add(D2),e.Proj.projections.add(j2),e.Proj.projections.add($2),e.Proj.projections.add(U2),e.Proj.projections.add(V2),e.Proj.projections.add(W2)}var Z2=R(()=>{L0();k0();PC();jC();$C();UC();VC();WC();XC();QC();JC();t2();i2();a2();c2();h2();p2();m2();y2();b2();w2();E2();T2();R2();A2();G2();q2();B2();z2();H2();Y2()});var Q2,zo,D0=R(()=>{cC();kp();yC();v0();l0();m0();b0();I0();Z2();Q2=Object.assign(lC,{defaultDatum:"WGS84",Proj:Br,WGS84:new Br("WGS84"),Point:_C,toPoint:Op,defs:Yl,nadgrid:g0,transform:$a,mgrs:pC,version:"__VERSION__"});X2(Q2);zo=Q2});function Qe(){return`${++vG}_${Date.now()}`}var vG,Wt=R(()=>{vG=0});function Wa({geometryType:e,color:t="rgb(255,255,0)",fill:n=!0}={}){switch(e){case"LineString":case"MultiLineString":return new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:4})});case"Point":case"MultiPoint":return new ol.style.Style({image:new ol.style.Circle({radius:6,fill:n&&new ol.style.Fill({color:t}),stroke:!n&&new ol.style.Stroke({color:t,width:4})}),zIndex:1/0});case"MultiPolygon":case"Polygon":return new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:4}),fill:n&&new ol.style.Fill({color:ol.color.asString([...ol.color.asArray(t)].splice(0,3).concat(.25))})});default:return console.warn("invalid geometry type",e),null}}var B0=R(()=>{});function pr(e=[]){return(Array.isArray(e)?e:Object.keys(e)).filter(t=>!ur.includes(t))}var lc=R(()=>{ft()});var z0=He((dI,U0)=>{(function(e){if(typeof dI=="object"&&typeof U0<"u")U0.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t=this,t.localforage=e()}})(function(){var e,t,n;return function s(o,l,a){function u(d,_){if(!l[d]){if(!o[d]){var m=typeof cr=="function"&&cr;if(!_&&m)return m(d,!0);if(h)return h(d,!0);var v=new Error("Cannot find module '"+d+"'");throw v.code="MODULE_NOT_FOUND",v}var x=l[d]={exports:{}};o[d][0].call(x.exports,function(b){var w=o[d][1][b];return u(w||b)},x,x.exports,s,o,l,a)}return l[d].exports}for(var h=typeof cr=="function"&&cr,p=0;p<a.length;p++)u(a[p]);return u}({1:[function(s,o,l){(function(a){"use strict";var u=a.MutationObserver||a.WebKitMutationObserver,h;if(u){var p=0,d=new u(b),_=a.document.createTextNode("");d.observe(_,{characterData:!0}),h=function(){_.data=p=++p%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var m=new a.MessageChannel;m.port1.onmessage=b,h=function(){m.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?h=function(){var L=a.document.createElement("script");L.onreadystatechange=function(){b(),L.onreadystatechange=null,L.parentNode.removeChild(L),L=null},a.document.documentElement.appendChild(L)}:h=function(){setTimeout(b,0)};var v,x=[];function b(){v=!0;for(var L,D,G=x.length;G;){for(D=x,x=[],L=-1;++L<G;)D[L]();G=x.length}v=!1}o.exports=w;function w(L){x.push(L)===1&&!v&&h()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(s,o,l){"use strict";var a=s(1);function u(){}var h={},p=["REJECTED"],d=["FULFILLED"],_=["PENDING"];o.exports=m;function m(j){if(typeof j!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,j!==u&&w(this,j)}m.prototype.catch=function(j){return this.then(null,j)},m.prototype.then=function(j,V){if(typeof j!="function"&&this.state===d||typeof V!="function"&&this.state===p)return this;var H=new this.constructor(u);if(this.state!==_){var se=this.state===d?j:V;x(H,se,this.outcome)}else this.queue.push(new v(H,j,V));return H};function v(j,V,H){this.promise=j,typeof V=="function"&&(this.onFulfilled=V,this.callFulfilled=this.otherCallFulfilled),typeof H=="function"&&(this.onRejected=H,this.callRejected=this.otherCallRejected)}v.prototype.callFulfilled=function(j){h.resolve(this.promise,j)},v.prototype.otherCallFulfilled=function(j){x(this.promise,this.onFulfilled,j)},v.prototype.callRejected=function(j){h.reject(this.promise,j)},v.prototype.otherCallRejected=function(j){x(this.promise,this.onRejected,j)};function x(j,V,H){a(function(){var se;try{se=V(H)}catch(M){return h.reject(j,M)}se===j?h.reject(j,new TypeError("Cannot resolve promise with itself")):h.resolve(j,se)})}h.resolve=function(j,V){var H=L(b,V);if(H.status==="error")return h.reject(j,H.value);var se=H.value;if(se)w(j,se);else{j.state=d,j.outcome=V;for(var M=-1,ie=j.queue.length;++M<ie;)j.queue[M].callFulfilled(V)}return j},h.reject=function(j,V){j.state=p,j.outcome=V;for(var H=-1,se=j.queue.length;++H<se;)j.queue[H].callRejected(V);return j};function b(j){var V=j&&j.then;if(j&&(typeof j=="object"||typeof j=="function")&&typeof V=="function")return function(){V.apply(j,arguments)}}function w(j,V){var H=!1;function se(X){H||(H=!0,h.reject(j,X))}function M(X){H||(H=!0,h.resolve(j,X))}function ie(){V(M,se)}var E=L(ie);E.status==="error"&&se(E.value)}function L(j,V){var H={};try{H.value=j(V),H.status="success"}catch(se){H.status="error",H.value=se}return H}m.resolve=D;function D(j){return j instanceof this?j:h.resolve(new this(u),j)}m.reject=G;function G(j){var V=new this(u);return h.reject(V,j)}m.all=W;function W(j){var V=this;if(Object.prototype.toString.call(j)!=="[object Array]")return this.reject(new TypeError("must be an array"));var H=j.length,se=!1;if(!H)return this.resolve([]);for(var M=new Array(H),ie=0,E=-1,X=new this(u);++E<H;)K(j[E],E);return X;function K(te,Ge){V.resolve(te).then(ye,function(Re){se||(se=!0,h.reject(X,Re))});function ye(Re){M[Ge]=Re,++ie===H&&!se&&(se=!0,h.resolve(X,M))}}}m.race=P;function P(j){var V=this;if(Object.prototype.toString.call(j)!=="[object Array]")return this.reject(new TypeError("must be an array"));var H=j.length,se=!1;if(!H)return this.resolve([]);for(var M=-1,ie=new this(u);++M<H;)E(j[M]);return ie;function E(X){V.resolve(X).then(function(K){se||(se=!0,h.resolve(ie,K))},function(K){se||(se=!0,h.reject(ie,K))})}}},{1:1}],3:[function(s,o,l){(function(a){"use strict";typeof a.Promise!="function"&&(a.Promise=s(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(s,o,l){"use strict";var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q};function u(q,ee){if(!(q instanceof ee))throw new TypeError("Cannot call a class as a function")}function h(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var p=h();function d(){try{if(!p||!p.open)return!1;var q=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ee=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!q||ee)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function _(q,ee){q=q||[],ee=ee||{};try{return new Blob(q,ee)}catch(oe){if(oe.name!=="TypeError")throw oe;for(var Y=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,le=new Y,ue=0;ue<q.length;ue+=1)le.append(q[ue]);return le.getBlob(ee.type)}}typeof Promise>"u"&&s(3);var m=Promise;function v(q,ee){ee&&q.then(function(Y){ee(null,Y)},function(Y){ee(Y)})}function x(q,ee,Y){typeof ee=="function"&&q.then(ee),typeof Y=="function"&&q.catch(Y)}function b(q){return typeof q!="string"&&(console.warn(q+" used as a key, but it is not a string."),q=String(q)),q}function w(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var L="local-forage-detect-blob-support",D=void 0,G={},W=Object.prototype.toString,P="readonly",j="readwrite";function V(q){for(var ee=q.length,Y=new ArrayBuffer(ee),le=new Uint8Array(Y),ue=0;ue<ee;ue++)le[ue]=q.charCodeAt(ue);return Y}function H(q){return new m(function(ee){var Y=q.transaction(L,j),le=_([""]);Y.objectStore(L).put(le,"key"),Y.onabort=function(ue){ue.preventDefault(),ue.stopPropagation(),ee(!1)},Y.oncomplete=function(){var ue=navigator.userAgent.match(/Chrome\/(\d+)/),oe=navigator.userAgent.match(/Edge\//);ee(oe||!ue||parseInt(ue[1],10)>=43)}}).catch(function(){return!1})}function se(q){return typeof D=="boolean"?m.resolve(D):H(q).then(function(ee){return D=ee,D})}function M(q){var ee=G[q.name],Y={};Y.promise=new m(function(le,ue){Y.resolve=le,Y.reject=ue}),ee.deferredOperations.push(Y),ee.dbReady?ee.dbReady=ee.dbReady.then(function(){return Y.promise}):ee.dbReady=Y.promise}function ie(q){var ee=G[q.name],Y=ee.deferredOperations.pop();if(Y)return Y.resolve(),Y.promise}function E(q,ee){var Y=G[q.name],le=Y.deferredOperations.pop();if(le)return le.reject(ee),le.promise}function X(q,ee){return new m(function(Y,le){if(G[q.name]=G[q.name]||Ee(),q.db)if(ee)M(q),q.db.close();else return Y(q.db);var ue=[q.name];ee&&ue.push(q.version);var oe=p.open.apply(p,ue);ee&&(oe.onupgradeneeded=function(be){var Se=oe.result;try{Se.createObjectStore(q.storeName),be.oldVersion<=1&&Se.createObjectStore(L)}catch(Le){if(Le.name==="ConstraintError")console.warn('The database "'+q.name+'" has been upgraded from version '+be.oldVersion+" to version "+be.newVersion+', but the storage "'+q.storeName+'" already exists.');else throw Le}}),oe.onerror=function(be){be.preventDefault(),le(oe.error)},oe.onsuccess=function(){var be=oe.result;be.onversionchange=function(Se){Se.target.close()},Y(be),ie(q)}})}function K(q){return X(q,!1)}function te(q){return X(q,!0)}function Ge(q,ee){if(!q.db)return!0;var Y=!q.db.objectStoreNames.contains(q.storeName),le=q.version<q.db.version,ue=q.version>q.db.version;if(le&&(q.version!==ee&&console.warn('The database "'+q.name+`" can't be downgraded from version `+q.db.version+" to version "+q.version+"."),q.version=q.db.version),ue||Y){if(Y){var oe=q.db.version+1;oe>q.version&&(q.version=oe)}return!0}return!1}function ye(q){return new m(function(ee,Y){var le=new FileReader;le.onerror=Y,le.onloadend=function(ue){var oe=btoa(ue.target.result||"");ee({__local_forage_encoded_blob:!0,data:oe,type:q.type})},le.readAsBinaryString(q)})}function Re(q){var ee=V(atob(q.data));return _([ee],{type:q.type})}function U(q){return q&&q.__local_forage_encoded_blob}function ce(q){var ee=this,Y=ee._initReady().then(function(){var le=G[ee._dbInfo.name];if(le&&le.dbReady)return le.dbReady});return x(Y,q,q),Y}function we(q){M(q);for(var ee=G[q.name],Y=ee.forages,le=0;le<Y.length;le++){var ue=Y[le];ue._dbInfo.db&&(ue._dbInfo.db.close(),ue._dbInfo.db=null)}return q.db=null,K(q).then(function(oe){return q.db=oe,Ge(q)?te(q):oe}).then(function(oe){q.db=ee.db=oe;for(var be=0;be<Y.length;be++)Y[be]._dbInfo.db=oe}).catch(function(oe){throw E(q,oe),oe})}function pe(q,ee,Y,le){le===void 0&&(le=1);try{var ue=q.db.transaction(q.storeName,ee);Y(null,ue)}catch(oe){if(le>0&&(!q.db||oe.name==="InvalidStateError"||oe.name==="NotFoundError"))return m.resolve().then(function(){if(!q.db||oe.name==="NotFoundError"&&!q.db.objectStoreNames.contains(q.storeName)&&q.version<=q.db.version)return q.db&&(q.version=q.db.version+1),te(q)}).then(function(){return we(q).then(function(){pe(q,ee,Y,le-1)})}).catch(Y);Y(oe)}}function Ee(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Fe(q){var ee=this,Y={db:null};if(q)for(var le in q)Y[le]=q[le];var ue=G[Y.name];ue||(ue=Ee(),G[Y.name]=ue),ue.forages.push(ee),ee._initReady||(ee._initReady=ee.ready,ee.ready=ce);var oe=[];function be(){return m.resolve()}for(var Se=0;Se<ue.forages.length;Se++){var Le=ue.forages[Se];Le!==ee&&oe.push(Le._initReady().catch(be))}var ke=ue.forages.slice(0);return m.all(oe).then(function(){return Y.db=ue.db,K(Y)}).then(function(Me){return Y.db=Me,Ge(Y,ee._defaultConfig.version)?te(Y):Me}).then(function(Me){Y.db=ue.db=Me,ee._dbInfo=Y;for(var Ve=0;Ve<ke.length;Ve++){var st=ke[Ve];st!==ee&&(st._dbInfo.db=Y.db,st._dbInfo.version=Y.version)}})}function lt(q,ee){var Y=this;q=b(q);var le=new m(function(ue,oe){Y.ready().then(function(){pe(Y._dbInfo,P,function(be,Se){if(be)return oe(be);try{var Le=Se.objectStore(Y._dbInfo.storeName),ke=Le.get(q);ke.onsuccess=function(){var Me=ke.result;Me===void 0&&(Me=null),U(Me)&&(Me=Re(Me)),ue(Me)},ke.onerror=function(){oe(ke.error)}}catch(Me){oe(Me)}})}).catch(oe)});return v(le,ee),le}function qe(q,ee){var Y=this,le=new m(function(ue,oe){Y.ready().then(function(){pe(Y._dbInfo,P,function(be,Se){if(be)return oe(be);try{var Le=Se.objectStore(Y._dbInfo.storeName),ke=Le.openCursor(),Me=1;ke.onsuccess=function(){var Ve=ke.result;if(Ve){var st=Ve.value;U(st)&&(st=Re(st));var It=q(st,Ve.key,Me++);It!==void 0?ue(It):Ve.continue()}else ue()},ke.onerror=function(){oe(ke.error)}}catch(Ve){oe(Ve)}})}).catch(oe)});return v(le,ee),le}function rt(q,ee,Y){var le=this;q=b(q);var ue=new m(function(oe,be){var Se;le.ready().then(function(){return Se=le._dbInfo,W.call(ee)==="[object Blob]"?se(Se.db).then(function(Le){return Le?ee:ye(ee)}):ee}).then(function(Le){pe(le._dbInfo,j,function(ke,Me){if(ke)return be(ke);try{var Ve=Me.objectStore(le._dbInfo.storeName);Le===null&&(Le=void 0);var st=Ve.put(Le,q);Me.oncomplete=function(){Le===void 0&&(Le=null),oe(Le)},Me.onabort=Me.onerror=function(){var It=st.error?st.error:st.transaction.error;be(It)}}catch(It){be(It)}})}).catch(be)});return v(ue,Y),ue}function Pe(q,ee){var Y=this;q=b(q);var le=new m(function(ue,oe){Y.ready().then(function(){pe(Y._dbInfo,j,function(be,Se){if(be)return oe(be);try{var Le=Se.objectStore(Y._dbInfo.storeName),ke=Le.delete(q);Se.oncomplete=function(){ue()},Se.onerror=function(){oe(ke.error)},Se.onabort=function(){var Me=ke.error?ke.error:ke.transaction.error;oe(Me)}}catch(Me){oe(Me)}})}).catch(oe)});return v(le,ee),le}function Je(q){var ee=this,Y=new m(function(le,ue){ee.ready().then(function(){pe(ee._dbInfo,j,function(oe,be){if(oe)return ue(oe);try{var Se=be.objectStore(ee._dbInfo.storeName),Le=Se.clear();be.oncomplete=function(){le()},be.onabort=be.onerror=function(){var ke=Le.error?Le.error:Le.transaction.error;ue(ke)}}catch(ke){ue(ke)}})}).catch(ue)});return v(Y,q),Y}function et(q){var ee=this,Y=new m(function(le,ue){ee.ready().then(function(){pe(ee._dbInfo,P,function(oe,be){if(oe)return ue(oe);try{var Se=be.objectStore(ee._dbInfo.storeName),Le=Se.count();Le.onsuccess=function(){le(Le.result)},Le.onerror=function(){ue(Le.error)}}catch(ke){ue(ke)}})}).catch(ue)});return v(Y,q),Y}function Be(q,ee){var Y=this,le=new m(function(ue,oe){if(q<0){ue(null);return}Y.ready().then(function(){pe(Y._dbInfo,P,function(be,Se){if(be)return oe(be);try{var Le=Se.objectStore(Y._dbInfo.storeName),ke=!1,Me=Le.openKeyCursor();Me.onsuccess=function(){var Ve=Me.result;if(!Ve){ue(null);return}q===0||ke?ue(Ve.key):(ke=!0,Ve.advance(q))},Me.onerror=function(){oe(Me.error)}}catch(Ve){oe(Ve)}})}).catch(oe)});return v(le,ee),le}function C(q){var ee=this,Y=new m(function(le,ue){ee.ready().then(function(){pe(ee._dbInfo,P,function(oe,be){if(oe)return ue(oe);try{var Se=be.objectStore(ee._dbInfo.storeName),Le=Se.openKeyCursor(),ke=[];Le.onsuccess=function(){var Me=Le.result;if(!Me){le(ke);return}ke.push(Me.key),Me.continue()},Le.onerror=function(){ue(Le.error)}}catch(Me){ue(Me)}})}).catch(ue)});return v(Y,q),Y}function Q(q,ee){ee=w.apply(this,arguments);var Y=this.config();q=typeof q!="function"&&q||{},q.name||(q.name=q.name||Y.name,q.storeName=q.storeName||Y.storeName);var le=this,ue;if(!q.name)ue=m.reject("Invalid arguments");else{var oe=q.name===Y.name&&le._dbInfo.db,be=oe?m.resolve(le._dbInfo.db):K(q).then(function(Se){var Le=G[q.name],ke=Le.forages;Le.db=Se;for(var Me=0;Me<ke.length;Me++)ke[Me]._dbInfo.db=Se;return Se});q.storeName?ue=be.then(function(Se){if(Se.objectStoreNames.contains(q.storeName)){var Le=Se.version+1;M(q);var ke=G[q.name],Me=ke.forages;Se.close();for(var Ve=0;Ve<Me.length;Ve++){var st=Me[Ve];st._dbInfo.db=null,st._dbInfo.version=Le}var It=new m(function(Nt,yn){var on=p.open(q.name,Le);on.onerror=function(Qt){var si=on.result;si.close(),yn(Qt)},on.onupgradeneeded=function(){var Qt=on.result;Qt.deleteObjectStore(q.storeName)},on.onsuccess=function(){var Qt=on.result;Qt.close(),Nt(Qt)}});return It.then(function(Nt){ke.db=Nt;for(var yn=0;yn<Me.length;yn++){var on=Me[yn];on._dbInfo.db=Nt,ie(on._dbInfo)}}).catch(function(Nt){throw(E(q,Nt)||m.resolve()).catch(function(){}),Nt})}}):ue=be.then(function(Se){M(q);var Le=G[q.name],ke=Le.forages;Se.close();for(var Me=0;Me<ke.length;Me++){var Ve=ke[Me];Ve._dbInfo.db=null}var st=new m(function(It,Nt){var yn=p.deleteDatabase(q.name);yn.onerror=function(){var on=yn.result;on&&on.close(),Nt(yn.error)},yn.onblocked=function(){console.warn('dropInstance blocked for database "'+q.name+'" until all open connections are closed')},yn.onsuccess=function(){var on=yn.result;on&&on.close(),It(on)}});return st.then(function(It){Le.db=It;for(var Nt=0;Nt<ke.length;Nt++){var yn=ke[Nt];ie(yn._dbInfo)}}).catch(function(It){throw(E(q,It)||m.resolve()).catch(function(){}),It})})}return v(ue,ee),ue}var ge={_driver:"asyncStorage",_initStorage:Fe,_support:d(),iterate:qe,getItem:lt,setItem:rt,removeItem:Pe,clear:Je,length:et,key:Be,keys:C,dropInstance:Q};function N(){return typeof openDatabase=="function"}var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O="~~local_forage_type~",Z=/^~~local_forage_type~([^~]+)~/,ae="__lfsc__:",J=ae.length,re="arbf",de="blob",me="si08",Ae="ui08",it="uic8",Xe="si16",mn="si32",Hn="ur16",tt="ui32",Jn="fl32",at="fl64",Js=J+re.length,xn=Object.prototype.toString;function Ci(q){var ee=q.length*.75,Y=q.length,le,ue=0,oe,be,Se,Le;q[q.length-1]==="="&&(ee--,q[q.length-2]==="="&&ee--);var ke=new ArrayBuffer(ee),Me=new Uint8Array(ke);for(le=0;le<Y;le+=4)oe=k.indexOf(q[le]),be=k.indexOf(q[le+1]),Se=k.indexOf(q[le+2]),Le=k.indexOf(q[le+3]),Me[ue++]=oe<<2|be>>4,Me[ue++]=(be&15)<<4|Se>>2,Me[ue++]=(Se&3)<<6|Le&63;return ke}function _s(q){var ee=new Uint8Array(q),Y="",le;for(le=0;le<ee.length;le+=3)Y+=k[ee[le]>>2],Y+=k[(ee[le]&3)<<4|ee[le+1]>>4],Y+=k[(ee[le+1]&15)<<2|ee[le+2]>>6],Y+=k[ee[le+2]&63];return ee.length%3===2?Y=Y.substring(0,Y.length-1)+"=":ee.length%3===1&&(Y=Y.substring(0,Y.length-2)+"=="),Y}function St(q,ee){var Y="";if(q&&(Y=xn.call(q)),q&&(Y==="[object ArrayBuffer]"||q.buffer&&xn.call(q.buffer)==="[object ArrayBuffer]")){var le,ue=ae;q instanceof ArrayBuffer?(le=q,ue+=re):(le=q.buffer,Y==="[object Int8Array]"?ue+=me:Y==="[object Uint8Array]"?ue+=Ae:Y==="[object Uint8ClampedArray]"?ue+=it:Y==="[object Int16Array]"?ue+=Xe:Y==="[object Uint16Array]"?ue+=Hn:Y==="[object Int32Array]"?ue+=mn:Y==="[object Uint32Array]"?ue+=tt:Y==="[object Float32Array]"?ue+=Jn:Y==="[object Float64Array]"?ue+=at:ee(new Error("Failed to get type for BinaryArray"))),ee(ue+_s(le))}else if(Y==="[object Blob]"){var oe=new FileReader;oe.onload=function(){var be=O+q.type+"~"+_s(this.result);ee(ae+de+be)},oe.readAsArrayBuffer(q)}else try{ee(JSON.stringify(q))}catch(be){console.error("Couldn't convert value into a JSON string: ",q),ee(null,be)}}function Ii(q){if(q.substring(0,J)!==ae)return JSON.parse(q);var ee=q.substring(Js),Y=q.substring(J,Js),le;if(Y===de&&Z.test(ee)){var ue=ee.match(Z);le=ue[1],ee=ee.substring(ue[0].length)}var oe=Ci(ee);switch(Y){case re:return oe;case de:return _([oe],{type:le});case me:return new Int8Array(oe);case Ae:return new Uint8Array(oe);case it:return new Uint8ClampedArray(oe);case Xe:return new Int16Array(oe);case Hn:return new Uint16Array(oe);case mn:return new Int32Array(oe);case tt:return new Uint32Array(oe);case Jn:return new Float32Array(oe);case at:return new Float64Array(oe);default:throw new Error("Unkown type: "+Y)}}var _n={serialize:St,deserialize:Ii,stringToBuffer:Ci,bufferToString:_s};function vo(q,ee,Y,le){q.executeSql("CREATE TABLE IF NOT EXISTS "+ee.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],Y,le)}function yt(q){var ee=this,Y={db:null};if(q)for(var le in q)Y[le]=typeof q[le]!="string"?q[le].toString():q[le];var ue=new m(function(oe,be){try{Y.db=openDatabase(Y.name,String(Y.version),Y.description,Y.size)}catch(Se){return be(Se)}Y.db.transaction(function(Se){vo(Se,Y,function(){ee._dbInfo=Y,oe()},function(Le,ke){be(ke)})},be)});return Y.serializer=_n,ue}function Tn(q,ee,Y,le,ue,oe){q.executeSql(Y,le,ue,function(be,Se){Se.code===Se.SYNTAX_ERR?be.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ee.storeName],function(Le,ke){ke.rows.length?oe(Le,Se):vo(Le,ee,function(){Le.executeSql(Y,le,ue,oe)},oe)},oe):oe(be,Se)},oe)}function Et(q,ee){var Y=this;q=b(q);var le=new m(function(ue,oe){Y.ready().then(function(){var be=Y._dbInfo;be.db.transaction(function(Se){Tn(Se,be,"SELECT * FROM "+be.storeName+" WHERE key = ? LIMIT 1",[q],function(Le,ke){var Me=ke.rows.length?ke.rows.item(0).value:null;Me&&(Me=be.serializer.deserialize(Me)),ue(Me)},function(Le,ke){oe(ke)})})}).catch(oe)});return v(le,ee),le}function Li(q,ee){var Y=this,le=new m(function(ue,oe){Y.ready().then(function(){var be=Y._dbInfo;be.db.transaction(function(Se){Tn(Se,be,"SELECT * FROM "+be.storeName,[],function(Le,ke){for(var Me=ke.rows,Ve=Me.length,st=0;st<Ve;st++){var It=Me.item(st),Nt=It.value;if(Nt&&(Nt=be.serializer.deserialize(Nt)),Nt=q(Nt,It.key,st+1),Nt!==void 0){ue(Nt);return}}ue()},function(Le,ke){oe(ke)})})}).catch(oe)});return v(le,ee),le}function vt(q,ee,Y,le){var ue=this;q=b(q);var oe=new m(function(be,Se){ue.ready().then(function(){ee===void 0&&(ee=null);var Le=ee,ke=ue._dbInfo;ke.serializer.serialize(ee,function(Me,Ve){Ve?Se(Ve):ke.db.transaction(function(st){Tn(st,ke,"INSERT OR REPLACE INTO "+ke.storeName+" (key, value) VALUES (?, ?)",[q,Me],function(){be(Le)},function(It,Nt){Se(Nt)})},function(st){if(st.code===st.QUOTA_ERR){if(le>0){be(vt.apply(ue,[q,Le,Y,le-1]));return}Se(st)}})})}).catch(Se)});return v(oe,Y),oe}function Cu(q,ee,Y){return vt.apply(this,[q,ee,Y,1])}function O_(q,ee){var Y=this;q=b(q);var le=new m(function(ue,oe){Y.ready().then(function(){var be=Y._dbInfo;be.db.transaction(function(Se){Tn(Se,be,"DELETE FROM "+be.storeName+" WHERE key = ?",[q],function(){ue()},function(Le,ke){oe(ke)})})}).catch(oe)});return v(le,ee),le}function P_(q){var ee=this,Y=new m(function(le,ue){ee.ready().then(function(){var oe=ee._dbInfo;oe.db.transaction(function(be){Tn(be,oe,"DELETE FROM "+oe.storeName,[],function(){le()},function(Se,Le){ue(Le)})})}).catch(ue)});return v(Y,q),Y}function F_(q){var ee=this,Y=new m(function(le,ue){ee.ready().then(function(){var oe=ee._dbInfo;oe.db.transaction(function(be){Tn(be,oe,"SELECT COUNT(key) as c FROM "+oe.storeName,[],function(Se,Le){var ke=Le.rows.item(0).c;le(ke)},function(Se,Le){ue(Le)})})}).catch(ue)});return v(Y,q),Y}function Kh(q,ee){var Y=this,le=new m(function(ue,oe){Y.ready().then(function(){var be=Y._dbInfo;be.db.transaction(function(Se){Tn(Se,be,"SELECT key FROM "+be.storeName+" WHERE id = ? LIMIT 1",[q+1],function(Le,ke){var Me=ke.rows.length?ke.rows.item(0).key:null;ue(Me)},function(Le,ke){oe(ke)})})}).catch(oe)});return v(le,ee),le}function Jh(q){var ee=this,Y=new m(function(le,ue){ee.ready().then(function(){var oe=ee._dbInfo;oe.db.transaction(function(be){Tn(be,oe,"SELECT key FROM "+oe.storeName,[],function(Se,Le){for(var ke=[],Me=0;Me<Le.rows.length;Me++)ke.push(Le.rows.item(Me).key);le(ke)},function(Se,Le){ue(Le)})})}).catch(ue)});return v(Y,q),Y}function Cl(q){return new m(function(ee,Y){q.transaction(function(le){le.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(ue,oe){for(var be=[],Se=0;Se<oe.rows.length;Se++)be.push(oe.rows.item(Se).name);ee({db:q,storeNames:be})},function(ue,oe){Y(oe)})},function(le){Y(le)})})}function Fs(q,ee){ee=w.apply(this,arguments);var Y=this.config();q=typeof q!="function"&&q||{},q.name||(q.name=q.name||Y.name,q.storeName=q.storeName||Y.storeName);var le=this,ue;return q.name?ue=new m(function(oe){var be;q.name===Y.name?be=le._dbInfo.db:be=openDatabase(q.name,"","",0),q.storeName?oe({db:be,storeNames:[q.storeName]}):oe(Cl(be))}).then(function(oe){return new m(function(be,Se){oe.db.transaction(function(Le){function ke(It){return new m(function(Nt,yn){Le.executeSql("DROP TABLE IF EXISTS "+It,[],function(){Nt()},function(on,Qt){yn(Qt)})})}for(var Me=[],Ve=0,st=oe.storeNames.length;Ve<st;Ve++)Me.push(ke(oe.storeNames[Ve]));m.all(Me).then(function(){be()}).catch(function(It){Se(It)})},function(Le){Se(Le)})})}):ue=m.reject("Invalid arguments"),v(ue,ee),ue}var er={_driver:"webSQLStorage",_initStorage:yt,_support:N(),iterate:Li,getItem:Et,setItem:Cu,removeItem:O_,clear:P_,length:F_,key:Kh,keys:Jh,dropInstance:Fs};function ef(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ir(q,ee){var Y=q.name+"/";return q.storeName!==ee.storeName&&(Y+=q.storeName+"/"),Y}function D_(){var q="_localforage_support_test";try{return localStorage.setItem(q,!0),localStorage.removeItem(q),!1}catch{return!0}}function G_(){return!D_()||localStorage.length>0}function j_(q){var ee=this,Y={};if(q)for(var le in q)Y[le]=q[le];return Y.keyPrefix=Ir(q,ee._defaultConfig),G_()?(ee._dbInfo=Y,Y.serializer=_n,m.resolve()):m.reject()}function tf(q){var ee=this,Y=ee.ready().then(function(){for(var le=ee._dbInfo.keyPrefix,ue=localStorage.length-1;ue>=0;ue--){var oe=localStorage.key(ue);oe.indexOf(le)===0&&localStorage.removeItem(oe)}});return v(Y,q),Y}function xa(q,ee){var Y=this;q=b(q);var le=Y.ready().then(function(){var ue=Y._dbInfo,oe=localStorage.getItem(ue.keyPrefix+q);return oe&&(oe=ue.serializer.deserialize(oe)),oe});return v(le,ee),le}function nf(q,ee){var Y=this,le=Y.ready().then(function(){for(var ue=Y._dbInfo,oe=ue.keyPrefix,be=oe.length,Se=localStorage.length,Le=1,ke=0;ke<Se;ke++){var Me=localStorage.key(ke);if(Me.indexOf(oe)===0){var Ve=localStorage.getItem(Me);if(Ve&&(Ve=ue.serializer.deserialize(Ve)),Ve=q(Ve,Me.substring(be),Le++),Ve!==void 0)return Ve}}});return v(le,ee),le}function q_(q,ee){var Y=this,le=Y.ready().then(function(){var ue=Y._dbInfo,oe;try{oe=localStorage.key(q)}catch{oe=null}return oe&&(oe=oe.substring(ue.keyPrefix.length)),oe});return v(le,ee),le}function sf(q){var ee=this,Y=ee.ready().then(function(){for(var le=ee._dbInfo,ue=localStorage.length,oe=[],be=0;be<ue;be++){var Se=localStorage.key(be);Se.indexOf(le.keyPrefix)===0&&oe.push(Se.substring(le.keyPrefix.length))}return oe});return v(Y,q),Y}function rf(q){var ee=this,Y=ee.keys().then(function(le){return le.length});return v(Y,q),Y}function rn(q,ee){var Y=this;q=b(q);var le=Y.ready().then(function(){var ue=Y._dbInfo;localStorage.removeItem(ue.keyPrefix+q)});return v(le,ee),le}function Mt(q,ee,Y){var le=this;q=b(q);var ue=le.ready().then(function(){ee===void 0&&(ee=null);var oe=ee;return new m(function(be,Se){var Le=le._dbInfo;Le.serializer.serialize(ee,function(ke,Me){if(Me)Se(Me);else try{localStorage.setItem(Le.keyPrefix+q,ke),be(oe)}catch(Ve){(Ve.name==="QuotaExceededError"||Ve.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Se(Ve),Se(Ve)}})})});return v(ue,Y),ue}function wn(q,ee){if(ee=w.apply(this,arguments),q=typeof q!="function"&&q||{},!q.name){var Y=this.config();q.name=q.name||Y.name,q.storeName=q.storeName||Y.storeName}var le=this,ue;return q.name?ue=new m(function(oe){q.storeName?oe(Ir(q,le._defaultConfig)):oe(q.name+"/")}).then(function(oe){for(var be=localStorage.length-1;be>=0;be--){var Se=localStorage.key(be);Se.indexOf(oe)===0&&localStorage.removeItem(Se)}}):ue=m.reject("Invalid arguments"),v(ue,ee),ue}var Ze={_driver:"localStorageWrapper",_initStorage:j_,_support:ef(),iterate:nf,getItem:xa,setItem:Mt,removeItem:rn,clear:tf,length:rf,key:q_,keys:sf,dropInstance:wn},B=function(ee,Y){return ee===Y||typeof ee=="number"&&typeof Y=="number"&&isNaN(ee)&&isNaN(Y)},Ct=function(ee,Y){for(var le=ee.length,ue=0;ue<le;){if(B(ee[ue],Y))return!0;ue++}return!1},ct=Array.isArray||function(q){return Object.prototype.toString.call(q)==="[object Array]"},Ds={},Ni={},Gt={INDEXEDDB:ge,WEBSQL:er,LOCALSTORAGE:Ze},Iu=[Gt.INDEXEDDB._driver,Gt.WEBSQL._driver,Gt.LOCALSTORAGE._driver],bt=["dropInstance"],bo=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(bt),Il={description:"",driver:Iu.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function wa(q,ee){q[ee]=function(){var Y=arguments;return q.ready().then(function(){return q[ee].apply(q,Y)})}}function xo(){for(var q=1;q<arguments.length;q++){var ee=arguments[q];if(ee)for(var Y in ee)ee.hasOwnProperty(Y)&&(ct(ee[Y])?arguments[0][Y]=ee[Y].slice():arguments[0][Y]=ee[Y])}return arguments[0]}var Sa=function(){function q(ee){u(this,q);for(var Y in Gt)if(Gt.hasOwnProperty(Y)){var le=Gt[Y],ue=le._driver;this[Y]=ue,Ds[ue]||this.defineDriver(le)}this._defaultConfig=xo({},Il),this._config=xo({},this._defaultConfig,ee),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return q.prototype.config=function(Y){if((typeof Y>"u"?"undefined":a(Y))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var le in Y){if(le==="storeName"&&(Y[le]=Y[le].replace(/\W/g,"_")),le==="version"&&typeof Y[le]!="number")return new Error("Database version must be a number.");this._config[le]=Y[le]}return"driver"in Y&&Y.driver?this.setDriver(this._config.driver):!0}else return typeof Y=="string"?this._config[Y]:this._config},q.prototype.defineDriver=function(Y,le,ue){var oe=new m(function(be,Se){try{var Le=Y._driver,ke=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!Y._driver){Se(ke);return}for(var Me=bo.concat("_initStorage"),Ve=0,st=Me.length;Ve<st;Ve++){var It=Me[Ve],Nt=!Ct(bt,It);if((Nt||Y[It])&&typeof Y[It]!="function"){Se(ke);return}}var yn=function(){for(var si=function(Ea){return function(){var Lu=new Error("Method "+Ea+" is not implemented by the current driver"),Lr=m.reject(Lu);return v(Lr,arguments[arguments.length-1]),Lr}},ys=0,Ll=bt.length;ys<Ll;ys++){var wo=bt[ys];Y[wo]||(Y[wo]=si(wo))}};yn();var on=function(si){Ds[Le]&&console.info("Redefining LocalForage driver: "+Le),Ds[Le]=Y,Ni[Le]=si,be()};"_support"in Y?Y._support&&typeof Y._support=="function"?Y._support().then(on,Se):on(!!Y._support):on(!0)}catch(Qt){Se(Qt)}});return x(oe,le,ue),oe},q.prototype.driver=function(){return this._driver||null},q.prototype.getDriver=function(Y,le,ue){var oe=Ds[Y]?m.resolve(Ds[Y]):m.reject(new Error("Driver not found."));return x(oe,le,ue),oe},q.prototype.getSerializer=function(Y){var le=m.resolve(_n);return x(le,Y),le},q.prototype.ready=function(Y){var le=this,ue=le._driverSet.then(function(){return le._ready===null&&(le._ready=le._initDriver()),le._ready});return x(ue,Y,Y),ue},q.prototype.setDriver=function(Y,le,ue){var oe=this;ct(Y)||(Y=[Y]);var be=this._getSupportedDrivers(Y);function Se(){oe._config.driver=oe.driver()}function Le(Ve){return oe._extend(Ve),Se(),oe._ready=oe._initStorage(oe._config),oe._ready}function ke(Ve){return function(){var st=0;function It(){for(;st<Ve.length;){var Nt=Ve[st];return st++,oe._dbInfo=null,oe._ready=null,oe.getDriver(Nt).then(Le).catch(It)}Se();var yn=new Error("No available storage method found.");return oe._driverSet=m.reject(yn),oe._driverSet}return It()}}var Me=this._driverSet!==null?this._driverSet.catch(function(){return m.resolve()}):m.resolve();return this._driverSet=Me.then(function(){var Ve=be[0];return oe._dbInfo=null,oe._ready=null,oe.getDriver(Ve).then(function(st){oe._driver=st._driver,Se(),oe._wrapLibraryMethodsWithReady(),oe._initDriver=ke(be)})}).catch(function(){Se();var Ve=new Error("No available storage method found.");return oe._driverSet=m.reject(Ve),oe._driverSet}),x(this._driverSet,le,ue),this._driverSet},q.prototype.supports=function(Y){return!!Ni[Y]},q.prototype._extend=function(Y){xo(this,Y)},q.prototype._getSupportedDrivers=function(Y){for(var le=[],ue=0,oe=Y.length;ue<oe;ue++){var be=Y[ue];this.supports(be)&&le.push(be)}return le},q.prototype._wrapLibraryMethodsWithReady=function(){for(var Y=0,le=bo.length;Y<le;Y++)wa(this,bo[Y])},q.prototype.createInstance=function(Y){return new q(Y)},q}(),Ti=new Sa;o.exports=Ti},{3:3}]},{},[4])(4)})});var V0,qi,cc=R(()=>{vn();V0={},qi=Object.assign(new nt,{setters:{registerPlugin(e){V0[e.name]=V0[e.name]||e}},getPlugin(e){return V0[e]}})});function Vo(e){if(typeof e=="number")return`EPSG:${e}`;if(e=e.replace(/[^\d\.\-]/g,""),e!=="")return`EPSG:${parseInt(e)}`}var Qp=R(()=>{});var In,gr=R(()=>{Qp();D0();In={get(e={}){let t=ol.proj.get(Vo(e.epsg)),n=!t&&{code:e.epsg,extent:e.extent,axisOrientation:e.axisinverted?"neu":"enu",units:e.geographic?"degrees":"m"};return t||(t=new ol.proj.Projection(n),t.getAxisOrientation=()=>n.axisOrientation,ol.proj.addProjection(t)),n&&e.proj4&&(zo.defs(e.epsg,e.proj4),ol.proj.proj4.register(zo)),e.extent&&!t.getExtent()&&t.setExtent(e.extent),t},async registerProjection(e){let t=ol.proj.get(e)||void 0;if(!t){let{result:n,data:s}=await(await fetch(`/crs/${e.split(":")[1]}/`)).json();if(n)return s.epsg=Vo(s.epsg),t=this.get(s),ol.proj.proj4.register(zo),t}return t}}});function Ot(e){return e instanceof Promise?e:!e||!e.then?(console.trace(e),Promise.reject("not a promise")):new Promise((t,n)=>{e.then(t).fail(n)})}function _t(e){return e===void 0?(console.trace(),$.Deferred(t=>t.reject("not a promise")).promise()):e.always?e:$.Deferred(async t=>{try{t.resolve(await(e instanceof Promise?e:e()))}catch(n){console.trace(n),t.reject(n)}}).promise()}var $i=R(()=>{});var Qa=He((Fd,uc)=>{var bG=200,SI="__lodash_hash_undefined__",EI=9007199254740991,J0="[object Arguments]",xG="[object Array]",CI="[object Boolean]",II="[object Date]",wG="[object Error]",ev="[object Function]",LI="[object GeneratorFunction]",Kp="[object Map]",NI="[object Number]",tv="[object Object]",hI="[object Promise]",TI="[object RegExp]",Jp="[object Set]",kI="[object String]",RI="[object Symbol]",W0="[object WeakMap]",MI="[object ArrayBuffer]",eg="[object DataView]",AI="[object Float32Array]",OI="[object Float64Array]",PI="[object Int8Array]",FI="[object Int16Array]",DI="[object Int32Array]",GI="[object Uint8Array]",jI="[object Uint8ClampedArray]",qI="[object Uint16Array]",$I="[object Uint32Array]",SG=/[\\^$.*+?()[\]{}|]/g,EG=/\w*$/,CG=/^\[object .+?Constructor\]$/,IG=/^(?:0|[1-9]\d*)$/,Yt={};Yt[J0]=Yt[xG]=Yt[MI]=Yt[eg]=Yt[CI]=Yt[II]=Yt[AI]=Yt[OI]=Yt[PI]=Yt[FI]=Yt[DI]=Yt[Kp]=Yt[NI]=Yt[tv]=Yt[TI]=Yt[Jp]=Yt[kI]=Yt[RI]=Yt[GI]=Yt[jI]=Yt[qI]=Yt[$I]=!0;Yt[wG]=Yt[ev]=Yt[W0]=!1;var LG=typeof global=="object"&&global&&global.Object===Object&&global,NG=typeof self=="object"&&self&&self.Object===Object&&self,Wr=LG||NG||Function("return this")(),BI=typeof Fd=="object"&&Fd&&!Fd.nodeType&&Fd,fI=BI&&typeof uc=="object"&&uc&&!uc.nodeType&&uc,TG=fI&&fI.exports===BI;function kG(e,t){return e.set(t[0],t[1]),e}function RG(e,t){return e.add(t),e}function MG(e,t){for(var n=-1,s=e?e.length:0;++n<s&&t(e[n],n,e)!==!1;);return e}function AG(e,t){for(var n=-1,s=t.length,o=e.length;++n<s;)e[o+n]=t[n];return e}function UI(e,t,n,s){var o=-1,l=e?e.length:0;for(s&&l&&(n=e[++o]);++o<l;)n=t(n,e[o],o,e);return n}function OG(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}function PG(e,t){return e?.[t]}function zI(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function pI(e){var t=-1,n=Array(e.size);return e.forEach(function(s,o){n[++t]=[o,s]}),n}function nv(e,t){return function(n){return e(t(n))}}function gI(e){var t=-1,n=Array(e.size);return e.forEach(function(s){n[++t]=s}),n}var FG=Array.prototype,DG=Function.prototype,tg=Object.prototype,H0=Wr["__core-js_shared__"],mI=function(){var e=/[^.]+$/.exec(H0&&H0.keys&&H0.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),VI=DG.toString,Ho=tg.hasOwnProperty,ng=tg.toString,GG=RegExp("^"+VI.call(Ho).replace(SG,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_I=TG?Wr.Buffer:void 0,yI=Wr.Symbol,vI=Wr.Uint8Array,jG=nv(Object.getPrototypeOf,Object),qG=Object.create,$G=tg.propertyIsEnumerable,BG=FG.splice,bI=Object.getOwnPropertySymbols,UG=_I?_I.isBuffer:void 0,zG=nv(Object.keys,Object),Y0=fc(Wr,"DataView"),Dd=fc(Wr,"Map"),X0=fc(Wr,"Promise"),Z0=fc(Wr,"Set"),Q0=fc(Wr,"WeakMap"),Gd=fc(Object,"create"),VG=Za(Y0),HG=Za(Dd),WG=Za(X0),YG=Za(Z0),XG=Za(Q0),xI=yI?yI.prototype:void 0,wI=xI?xI.valueOf:void 0;function Xa(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function ZG(){this.__data__=Gd?Gd(null):{}}function QG(e){return this.has(e)&&delete this.__data__[e]}function KG(e){var t=this.__data__;if(Gd){var n=t[e];return n===SI?void 0:n}return Ho.call(t,e)?t[e]:void 0}function JG(e){var t=this.__data__;return Gd?t[e]!==void 0:Ho.call(t,e)}function ej(e,t){var n=this.__data__;return n[e]=Gd&&t===void 0?SI:t,this}Xa.prototype.clear=ZG;Xa.prototype.delete=QG;Xa.prototype.get=KG;Xa.prototype.has=JG;Xa.prototype.set=ej;function Yr(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function tj(){this.__data__=[]}function nj(e){var t=this.__data__,n=ig(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():BG.call(t,n,1),!0}function ij(e){var t=this.__data__,n=ig(t,e);return n<0?void 0:t[n][1]}function sj(e){return ig(this.__data__,e)>-1}function rj(e,t){var n=this.__data__,s=ig(n,e);return s<0?n.push([e,t]):n[s][1]=t,this}Yr.prototype.clear=tj;Yr.prototype.delete=nj;Yr.prototype.get=ij;Yr.prototype.has=sj;Yr.prototype.set=rj;function dc(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function oj(){this.__data__={hash:new Xa,map:new(Dd||Yr),string:new Xa}}function aj(e){return sg(this,e).delete(e)}function lj(e){return sg(this,e).get(e)}function cj(e){return sg(this,e).has(e)}function uj(e,t){return sg(this,e).set(e,t),this}dc.prototype.clear=oj;dc.prototype.delete=aj;dc.prototype.get=lj;dc.prototype.has=cj;dc.prototype.set=uj;function hc(e){this.__data__=new Yr(e)}function dj(){this.__data__=new Yr}function hj(e){return this.__data__.delete(e)}function fj(e){return this.__data__.get(e)}function pj(e){return this.__data__.has(e)}function gj(e,t){var n=this.__data__;if(n instanceof Yr){var s=n.__data__;if(!Dd||s.length<bG-1)return s.push([e,t]),this;n=this.__data__=new dc(s)}return n.set(e,t),this}hc.prototype.clear=dj;hc.prototype.delete=hj;hc.prototype.get=fj;hc.prototype.has=pj;hc.prototype.set=gj;function mj(e,t){var n=sv(e)||qj(e)?OG(e.length,String):[],s=n.length,o=!!s;for(var l in e)(t||Ho.call(e,l))&&!(o&&(l=="length"||Fj(l,s)))&&n.push(l);return n}function HI(e,t,n){var s=e[t];(!(Ho.call(e,t)&&ZI(s,n))||n===void 0&&!(t in e))&&(e[t]=n)}function ig(e,t){for(var n=e.length;n--;)if(ZI(e[n][0],t))return n;return-1}function _j(e,t){return e&&WI(t,rv(t),e)}function K0(e,t,n,s,o,l,a){var u;if(s&&(u=l?s(e,o,l,a):s(e)),u!==void 0)return u;if(!rg(e))return e;var h=sv(e);if(h){if(u=Aj(e),!t)return kj(e,u)}else{var p=Ya(e),d=p==ev||p==LI;if(Bj(e))return Sj(e,t);if(p==tv||p==J0||d&&!l){if(zI(e))return l?e:{};if(u=Oj(d?{}:e),!t)return Rj(e,_j(u,e))}else{if(!Yt[p])return l?e:{};u=Pj(e,p,K0,t)}}a||(a=new hc);var _=a.get(e);if(_)return _;if(a.set(e,u),!h)var m=n?Mj(e):rv(e);return MG(m||e,function(v,x){m&&(x=v,v=e[x]),HI(u,x,K0(v,t,n,s,x,e,a))}),u}function yj(e){return rg(e)?qG(e):{}}function vj(e,t,n){var s=t(e);return sv(e)?s:AG(s,n(e))}function bj(e){return ng.call(e)}function xj(e){if(!rg(e)||Gj(e))return!1;var t=KI(e)||zI(e)?GG:CG;return t.test(Za(e))}function wj(e){if(!XI(e))return zG(e);var t=[];for(var n in Object(e))Ho.call(e,n)&&n!="constructor"&&t.push(n);return t}function Sj(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function iv(e){var t=new e.constructor(e.byteLength);return new vI(t).set(new vI(e)),t}function Ej(e,t){var n=t?iv(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Cj(e,t,n){var s=t?n(pI(e),!0):pI(e);return UI(s,kG,new e.constructor)}function Ij(e){var t=new e.constructor(e.source,EG.exec(e));return t.lastIndex=e.lastIndex,t}function Lj(e,t,n){var s=t?n(gI(e),!0):gI(e);return UI(s,RG,new e.constructor)}function Nj(e){return wI?Object(wI.call(e)):{}}function Tj(e,t){var n=t?iv(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function kj(e,t){var n=-1,s=e.length;for(t||(t=Array(s));++n<s;)t[n]=e[n];return t}function WI(e,t,n,s){n||(n={});for(var o=-1,l=t.length;++o<l;){var a=t[o],u=s?s(n[a],e[a],a,n,e):void 0;HI(n,a,u===void 0?e[a]:u)}return n}function Rj(e,t){return WI(e,YI(e),t)}function Mj(e){return vj(e,rv,YI)}function sg(e,t){var n=e.__data__;return Dj(t)?n[typeof t=="string"?"string":"hash"]:n.map}function fc(e,t){var n=PG(e,t);return xj(n)?n:void 0}var YI=bI?nv(bI,Object):Vj,Ya=bj;(Y0&&Ya(new Y0(new ArrayBuffer(1)))!=eg||Dd&&Ya(new Dd)!=Kp||X0&&Ya(X0.resolve())!=hI||Z0&&Ya(new Z0)!=Jp||Q0&&Ya(new Q0)!=W0)&&(Ya=function(e){var t=ng.call(e),n=t==tv?e.constructor:void 0,s=n?Za(n):void 0;if(s)switch(s){case VG:return eg;case HG:return Kp;case WG:return hI;case YG:return Jp;case XG:return W0}return t});function Aj(e){var t=e.length,n=e.constructor(t);return t&&typeof e[0]=="string"&&Ho.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Oj(e){return typeof e.constructor=="function"&&!XI(e)?yj(jG(e)):{}}function Pj(e,t,n,s){var o=e.constructor;switch(t){case MI:return iv(e);case CI:case II:return new o(+e);case eg:return Ej(e,s);case AI:case OI:case PI:case FI:case DI:case GI:case jI:case qI:case $I:return Tj(e,s);case Kp:return Cj(e,s,n);case NI:case kI:return new o(e);case TI:return Ij(e);case Jp:return Lj(e,s,n);case RI:return Nj(e)}}function Fj(e,t){return t=t??EI,!!t&&(typeof e=="number"||IG.test(e))&&e>-1&&e%1==0&&e<t}function Dj(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Gj(e){return!!mI&&mI in e}function XI(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||tg;return e===n}function Za(e){if(e!=null){try{return VI.call(e)}catch{}try{return e+""}catch{}}return""}function jj(e){return K0(e,!0,!0)}function ZI(e,t){return e===t||e!==e&&t!==t}function qj(e){return $j(e)&&Ho.call(e,"callee")&&(!$G.call(e,"callee")||ng.call(e)==J0)}var sv=Array.isArray;function QI(e){return e!=null&&Uj(e.length)&&!KI(e)}function $j(e){return zj(e)&&QI(e)}var Bj=UG||Hj;function KI(e){var t=rg(e)?ng.call(e):"";return t==ev||t==LI}function Uj(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=EI}function rg(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function zj(e){return!!e&&typeof e=="object"}function rv(e){return QI(e)?mj(e):wj(e)}function Vj(){return[]}function Hj(){return!1}uc.exports=jj});var av=He((Zpe,JI)=>{JI.exports=Wj;function Wj(e,t){if(ov("noDeprecation"))return e;var n=!1;function s(){if(!n){if(ov("throwDeprecation"))throw new Error(t);ov("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}return s}function ov(e){try{if(!global.localStorage)return!1}catch{return!1}var t=global.localStorage[e];return t==null?!1:String(t).toLowerCase()==="true"}});function Yj(e,t){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}var eL,tL,pt,Ws=R(()=>{vn();Vl();$i();ze();eL=Ut(Qa()),tL=Ut(av());pt=class extends nt{constructor(t={}){if(t.iconConfig&&(console.warn("[G3W-CLIENT] iconConfig is deprecated"),console.trace(),t.iconColor=t.iconConfig.color,t.icon=t.iconConfig.icon,delete t.iconConfig),t.icon=T.getFontClass(t.icon)||t.icon,t.open=t.open??!1,t.mobile=t.mobile??!0,t.collapsible=t.collapsible??!0,super({setters:{setOpen(n){this.state.open=n,this._setOpen&&this._setOpen(n)},setVisible(n){this.state.visible=n,this._setVisible&&this._setVisible(n)},setLoading(n=!1){this.state.loading=n},setDisabled(n=!1){this.state.disabled=n},reload(){console.warn("[G3W-CLIENT] reloading of components will be discontinued, please update your code as soon as possible",this.getId()),this._reload&&this._reload()}}}),this._firstLayout=!0,this.internalComponent=t.internalComponent??null,this._components=[],this.id=t.id??Math.random()*1e3,this.title=t.title??"",this.state={sizes:{width:0,height:0},info:t.info??null,open:t.open??!1,visible:t.visible??!0,loading:t.loading??!1,disabled:t.disabled??!1,resizable:t.resizable??!1,closewhenshowviewportcontent:t.closewhenshowviewportcontent??!0},this.setService(t.service||this),t.internalComponent&&this.setInternalComponent(t.internalComponent),Yj(this,t),this.events=t.events??{},this.events.open){let{when:n="after",cb:s=()=>{}}=this.events.open;this[`on${n}`]("setOpen",o=>s(o))}t.vueComponentObject&&this.init(t)}init(t={}){return this.vueComponent=(0,eL.default)(t.vueComponentObject),this._components=t.components||[],this.setService(t.service||this._service||oi),this._service.init&&this.init!==this._service.init&&this._service.init(t),t.template&&(this.vueComponent.template=t.template),this.setInternalComponent=function(){this.internalComponent=new(Vue.extend(this.vueComponent))({service:this._service,template:t.template,propsData:t.propsData}),this.internalComponent.state=this.getService().state},this.setInternalComponent(),this}getId(){return this.id}setId(t){this.id=t}getOpen(){return this.state.open}getVisible(){return this.state.visible}getTitle(){return this.state.title}setTitle(t){this.state.title=t}getService(){return this._service}setService(t){this._service=t}addComponent(t){this._components.push(t)}removeComponent(t){this._components.find((n,s)=>{if(n===t)return this.splice(s,1),!0})}getInternalComponent(){return this.internalComponent}setInternalComponent(t,n={}){this.internalComponent=t===void 0&&this.internalComponentClass?new this.internalComponentClass:t,(n.events||[]).forEach(s=>this.internalComponent.$on(s.name,o=>s.handler&&s.handler(o)||this[`set${s.name[0].toUpperCase()}${s.name.slice(1)}`](o))),this._service&&this._service.state&&(this.internalComponent.state=this._service.state)}mount(t,n){return _t(new Promise(s=>{this.internalComponent||this.setInternalComponent(),n&&$(t).append(this.internalComponent.$mount().$el),n||this.internalComponent.$mount(t),this.internalComponent.$nextTick(()=>{this.emit("ready"),s(!0)}),this.emit("mount")}))}unmount(){return _t(async()=>{this.internalComponent&&(this.state.resizable&&this.internalComponent.$off("resize-component",this.internalComponent.layout),this.state.open=!1,this.internalComponent.$destroy(!0),$(this.internalComponent.$el).remove(),this.internalComponent=null,this.emit("unmount"))})}ismount(){return this.internalComponent&&this.internalComponent.$el}async layout(t,n){this.state.resizable&&this._firstLayout&&(this.internalComponent.$on("resize-component",this.internalComponent.layout),this._firstLayout=!1),await this.internalComponent.$nextTick(),this.internalComponent?.$emit("resize-component",{width:t,height:n}),this.emit("layout")}};Object.assign(pt.prototype,{destroy:oi,click:oi,show:oi,overwriteServiceMethods:(0,tL.default)(function(e){Object.entries(e).forEach(([t,n])=>this._service[t]=n)},"[G3W-CLIENT] Component::overwriteServiceMethods(methodsOptions) is deprecated")})});var Un,Ka=R(()=>{ze();vn();$i();Un=class extends nt{constructor(t={}){super(),this.id=t.id||null,this.title=t.title||"",this.service=t.service,t.vueComponentObject?this.internalPanel=new(Vue.extend(t.vueComponentObject))({service:this.service}):this.internalPanel=t.panel||t.internalPanel||null,t.show===!0&&this.internalPanel&&this.show()}getId(){return this.id}getTitle(){return this.title}getService(){return this.service}setService(t){this.service=t}getInternalPanel(){return this.internalPanel}setInternalPanel(t){this.internalPanel=t}show(){T.showPanel(this)}close(){T.closePanel()}mount(t){let n=this.internalPanel,s=n.$mount();return $(t).append(s.$el),s.$nextTick(()=>{n.onShow&&n.onShow()}),_t(Promise.resolve(!0))}unmount(){let t=this.internalPanel;return t.$destroy(!0),$(t.$el).remove(),t.onClose&&t.onClose(),this.internalComponent=null,this.service&&this.service.clear&&this.service.clear(),_t(Promise.resolve())}}});function jd(e,t="_",n="",s={}){for(let o in e){let l=n?n+t+o:o;typeof e[o]=="object"?jd(e[o],t,l,s):s[l]=e[o]}return s}var lv=R(()=>{});function _e(e){let t=F.locales?.[F.language]?.[e]??F.locales?.en?.[e];return t===void 0&&F.language!=="en"&&console.info(`[G3W-I18N] missing: '${e}'`),t??e}var Rt=R(()=>{Ke();lv();_e.register=function(e,t){F.locales[e]=Object.assign(F.locales[e]||{},jd(t,"."))}});function vi(e,t){return new Promise((n,s)=>{let o=()=>{if(!e())return"invalid predicate";clearInterval(l),n("predicate")},l=setInterval(o,100);o(),t&&setTimeout(()=>{clearInterval(l),s("timeout")},t)})}var Ja=R(()=>{});async function og(e){return e=Vo(e),await In.registerProjection(e),e}var cv,ag,uv,dv,qd,hv=R(()=>{vn();ze();ei();Ke();cc();gr();Qp();Wt();Ja();cv=class{constructor(){this.pendingactions={},this.getMessage=this.getMessage.bind(this),this.eventResponseServiceHandler=this.eventResponseServiceHandler.bind(this)}async init({project:t}={}){await T.isReady(),this.services={app:new uv,editing:new dv};let n=t.state.layers.map(o=>({id:o.id,name:o.name})),s=Object.keys(this.services);for(let o=0;o<s.length;o++){let l=this.services[s[o]];l.getLayers()===void 0&&l.setLayers(n),await l.init(),l.on("response",this.eventResponseServiceHandler)}this.postMessage({id:null,action:"app:ready",response:{result:!0,data:{layers:n}}}),window.addEventListener("message",this.getMessage,!1)}eventResponseServiceHandler({action:t,response:n}){this.postMessage({id:null,action:t,response:n})}async outputDataPlace(t,n={}){let s,{action:o="app:results"}=n,{result:l,data:a=[]}=await t,u=new ol.format.GeoJSON;try{s=a.map(({layer:h,features:p})=>({[h.getId()]:{features:u.writeFeatures(p)}}))}catch(h){console.warn(h),l=!1,s=h}this.postMessage({id:null,action:o,response:{result:l,data:s}})}postMessage(t={}){window.parent&&window.parent.postMessage(t,"*")}async stopPendingActions(){let t=[];return Object.keys(this.pendingactions).forEach(n=>{t.push(this.services[this.pendingactions[n].context].stop()),delete this.pendingactions[n]}),Promise.allSettled(t)}async getMessage(t){if(t&&t.data){let{id:n=Qe(),single:s=!0,action:o,data:l}=t.data,[a,u]=(o||"").split(":"),h=!1,p;try{let d=this.services[a].getReady();d&&s&&await this.stopPendingActions(),d&&(this.pendingactions[n]={context:a},p=await this.services[a][u](l),h=!0)}catch(d){console.warn(d),h=!1,p=d}this.postMessage({id:n,action:o,response:{result:h,data:p}}),delete this.pendingactions[n]}}async clear(){let t=Object.keys(this.services);for(let n=0;n<t.length;n++)this.services[t[n]].off("response",this.eventResponseServiceHandler);await this.stopPendingActions(),window.removeEventListener("message",this.getMessage,!1)}},ag=class extends nt{constructor(){super(),this.ready=!1,this.mapService=T.getService("map"),this.project=F.project,this.layers=void 0,this.pluginName,this.dependencyApi={}}async init({layers:t={}}={}){this.layers=t,!(this.pluginName!=="editing"||!F.configurationPlugins.includes("editing"))&&(await vi(()=>qi.getPlugin("editing")),this.dependencyApi=qi.getPlugin("editing"),this.dependencyApi.getEditableLayersId=this.dependencyApi.getEditableLayersId||(()=>Object.keys(this.dependencyApi.getEditableLayers())),this.dependencyApi.hidePanel=this.dependencyApi.hidePanel||this.dependencyApi.hideEditingPanel,this.dependencyApi.resetDefault=this.dependencyApi.resetDefault||this.dependencyApi.resetAPIDefault,this.setReady(!0))}getDependecyApi(){return this.dependencyApi}getQgsLayerId({qgs_layer_id:t,noValue:n=this.layers.map(s=>s.id)}){return t?[].concat(t):n}async searchFeature({layer:t,feature:n}){let{data:s=[]}=await gt.getData("search:features",{inputs:{layer:t,filter:[].concat(n.value).map(o=>`${n.field}|eq|${encodeURIComponent(o)}`).join("|OR,")},outputs:!1});return s}async findFeaturesWithGeometry({feature:t,qgs_layer_id:n=[],zoom:s=!1,highlight:o=!1}={}){let l={found:!1,features:[],qgs_layer_id:null},a=n.length,u=0;for(;!l.found&&u<a;){let h=this.project.getLayerById(n[u]);try{let p=h&&await this.searchFeature({layer:h,feature:t}),d=p.length&&p[0].features;if(l.found=d&&d.length>0&&!!d.find(_=>_.getGeometry()),!d||!l.found)throw"invalid response";l.features=d,l.qgs_layer_id=n[u],s&&await this.mapService.zoomToFeatures(d,{highlight:o})}catch(p){u++,console.warn(p)}}return l.found||this.mapService.zoomToExtent(this.mapService.project.state.initextent),l}setLayers(t=[]){this.layers=t}getLayers(){return this.layers}setReady(t=!1){this.ready=t}getReady(){return this.ready}async stop(){}clear(){}},uv=class extends ag{constructor(){super(),this.mapControls={screenshot:{control:null},changeMap:{control:null}}}init(){return new Promise(t=>{this.mapService.once("ready",()=>{this._map=this.mapService.getMap(),this._mapCrs=this.mapService.getCrs(),this.mapControls.screenshot.control=this.mapService.getMapControlByType("screenshot"),this.setReady(!0),t()})})}async results({capture:t=!0}){return T.currentoutputplace=t?"iframe":"gui",[]}async screenshot({capture:t=!0}){if(!t){this.mapControls.screenshot.control.resetOriginalOnClickEvent();return}this.mapControls.screenshot.control.overwriteOnClickEvent(n=>{let s;try{s={result:!0,data:n}}catch(o){console.warn(o),s={result:!1,data:o}}finally{this.emit("response",{response:s,action:"app:screenshot"})}})}async getcenter(t={}){let n=this.mapService.getCenter();return t.epsg!==void 0?ol.proj.transform(n,this.mapService.getEpsg(),await og(t.epsg)):n}async zoomtocoordinates(t={}){let{coordinates:n=[],epsg:s}=t;return n&&Array.isArray(n)&&n.length===2?(s!==void 0&&(s=await og(s),n=ol.proj.transform(n,s,this.mapService.getEpsg())),this.mapService.zoomTo(n),n):Promise.reject(n)}async getextent(t={}){let n=this.mapService.getMapExtent();return t.epsg!==void 0?ol.proj.transformExtent(n,this.mapService.getEpsg(),await og(t.epsg)):n}async zoomtoextent(t={}){let{extent:n=[],epsg:s}=t;return n&&Array.isArray(n)&&n.length===4?(s!==void 0?(s=og(s),n=ol.proj.transformExtent(n,s,this.mapService.getEpsg())):this.mapService.goToBBox(n),n):Promise.reject(n)}async zoomtofeature(t={}){let{qgs_layer_id:n,feature:s,highlight:o=!1}=t;return n=this.getQgsLayerId({qgs_layer_id:n}),(await this.findFeaturesWithGeometry({qgs_layer_id:n,feature:s,zoom:!0,highlight:o})).qgs_layer_id}},dv=class extends ag{constructor(){super(),this.pluginName="editing",this.subscribevents=[],this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.config={tools:{add:{disabled:[{id:"deletefeature"},{id:"copyfeatures"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},update:{disabled:[{id:"addfeature"},{id:"copyfeatures"},{id:"deletefeature"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},delete:{enabled:[{id:"deletefeature",options:{active:!0}}]}}},this.subscribersHandlers={canUndo:({activeTool:t,disableToolboxes:n=[]})=>s=>{s===!1&&(this.responseObject.qgs_layer_id=null,this.responseObject.error=null),t.setEnabled(!s),n.forEach(o=>o.setEditing(!s))},canRedo:()=>{},cancelform:t=>()=>{t()},addfeature:({properties:t,toolboxes:n}={})=>s=>{Object.keys(t).forEach(a=>s.set(a,t[a]));let o,l=[];n.forEach(a=>{let u=a.getToolById("addfeature");u.isActive()?(u.setEnabled(!1),o=u):(a.setEditing(!1),l.push(a))}),this.subscribevents.find(a=>a.event!=="canUndo")&&this.addSubscribeEvents("cancelform",this.addSubscribeEvents("canUndo",{activeTool:o,disableToolboxes:l}))},closeeditingpanel:({qgs_layer_id:t})=>()=>{this.responseObject.cb({qgs_layer_id:this.responseObject.qgs_layer_id,error:this.responseObject.error}),this.stopAction({qgs_layer_id:t})}}}async startAction({toolboxes:t,resolve:n,reject:s}){this.responseObject.cb=s,this.dependencyApi.setSaveConfig({cb:{done:o=>{this.responseObject.cb=n,this.responseObject.qgs_layer_id=o.getId(),this.responseObject.error=null,this.dependencyApi.hidePanel()},error:(o,l)=>{this.responseObject.cb=s,this.responseObject.qgs_layer_id=o.getId(),this.responseObject.error=l}}}),this.dependencyApi.showPanel({toolboxes:t}),this.isRunning=!0}async stopAction(t={}){t.qgs_layer_id&&await this.stopEditing(t.qgs_layer_id)}addSubscribeEvents(t,n={}){let s=this.subscribersHandlers[t](n);return this.dependencyApi.subscribe(t,s),this.subscribevents.push({event:t,handler:s}),s}resetSubscribeEvents(){this.subscribevents.forEach(t=>{this.dependencyApi.unsubscribe(t.event,t.handler)})}add(t={}){return new Promise(async(n,s)=>{if(this.isRunning)return s();let{qgs_layer_id:o,...l}=t,{properties:a}=l,u=this.getQgsLayerId({qgs_layer_id:o,noValue:this.dependencyApi.getEditableLayersId()});await this.startAction({toolboxes:u,resolve:n,reject:s});let h=(await this.startEditing(u,{tools:this.config.tools.add,startstopediting:!1,action:"add",selected:u.length===1})).filter(p=>p.status==="fulfilled").map(p=>p.value);T.isSidebarVisible()||T.showSidebar(),h.length===1&&h[0]&&h[0].setActiveTool(h[0].getToolById("addfeature")),this.addSubscribeEvents("addfeature",{properties:a,toolboxes:h}),this.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:u})})}async update(t={}){return new Promise(async(n,s)=>{if(this.isRunning)return s();let{qgs_layer_id:o,...l}=t,{feature:a}=l,u=this.getQgsLayerId({qgs_layer_id:o,noValue:this.dependencyApi.getEditableLayersId()}),h=await this.findFeaturesWithGeometry({qgs_layer_id:u,feature:a,zoom:!0,highlight:!0,selected:u.length===1});if(!h.found)return s();await this.startAction({toolboxes:[h.qgs_layer_id],resolve:n,reject:s}),await this.startEditing([h.qgs_layer_id],{feature:a,tools:this.config.tools.update,startstopediting:!1,action:"update"}),T.isSidebarVisible()||T.showSidebar(),this.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:[h.qgs_layer_id]})})}delete(){}async startEditing(t=[],n={}){let{action:s="add",feature:o}=n,l={};switch(n.filter=l,s){case"add":l.nofeatures=!0;break;case"update":l.field=`${o.field}|eq|${o.value}`;break}return await Promise.allSettled((t.length===1?t:[]).map(a=>this.dependencyApi.startEditing(a,n)))}async stopEditing(t){let n=[];t.forEach(s=>{n.push(this.dependencyApi.stopEditing(s))}),await Promise.allSettled(n),this.clear()}stop(){return new Promise(t=>{this.dependencyApi.hidePanel(),T.hideSidebar(),this.once("clear",t)})}clear(){this.dependencyApi.resetDefault(),this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.resetSubscribeEvents(),this.emit("clear")}},qd=new cv});function Zn(e){return Object.prototype.toString.call(e).slice(8,-1)}var Xr=R(()=>{});function el(){return window.initConfig.projects,window.initConfig.projects.filter(e=>[null,void 0].includes(e.listable)?e.id===F.project.getId()||window.initConfig.overviewproject&&e.gid===window.initConfig.overviewproject?!1:e:e.listable).sort((e,t)=>(e.title||"").localeCompare(t.title))}var lg=R(()=>{Ke()});function $d(e){let t=window.initConfig.projects.find(n=>e===n.gid);try{return`${new URL(window.initConfig.urls.baseurl)}${t.url}`}catch(n){return console.warn(n),`${location.origin}${window.initConfig.urls.baseurl}${t.url}`}}var fv=R(()=>{});function De(e){return Object.values(F.catalog).map(t=>t.getLayerById(e)).find(t=>t)}var Xt=R(()=>{Ke()});var nL={};qn(nL,{default:()=>s7});function n7(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="SidebarItem.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Xj,Zj,Qj,Kj,Jj,e7,t7,i7,s7,iL=R(()=>{Ke();Xj={name:"SidebarItem",data(){let{component:e}=this.$options;return{info:e.info||{state:null,style:null,class:null},main:!0,component:e,active:!1,title:e.title||"",open:!!e.state.open,icon:e.icon,iconColor:e.iconColor,collapsible:e.collapsible!==!1,actions:e.actions,sidebar:F.gui.sidebar}},methods:{triggerAction(e,t){e.fnc(t)}},mounted(){let e=this.$options.opts||{},t=document.getElementById("g3w-sidebarcomponents");[null,void 0].includes(e.position)||e.position<0||e.position>=t.children.length?$(t).append(this.$el):Array.from(t.children).forEach((n,s)=>{(s===e.position||n.id===e.position)&&n.insertAdjacentElement(e.before||e.before===void 0?"beforebegin":"afterend",this.$el)}),this.component.mount(this.$refs["component-placeholder"]),this.component.click=({open:n=!1}={})=>{n&&F.sidebar.components.forEach(o=>{o!==this.component&&o.getOpen()&&o.click({open:!1})});let s=this.component.getInternalComponent().$el;s.classList&&s.classList.toggle("menu-open",n),s.parentNode.classList.toggle("active",n),this.component.setOpen(n)}}},Zj=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{directives:[{name:"show",rawName:"v-show",value:e.component.state.visible,expression:"component.state.visible"},{name:"disabled",rawName:"v-disabled",value:e.component.state.disabled,expression:"component.state.disabled"}],staticClass:"treeview sidebaritem",class:{active:e.open},attrs:{id:e.component.id}},[n("bar-loader",{attrs:{loading:e.component.state.loading}}),e._v(" "),n("a",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},attrs:{href:"#","data-i18n-title":e.sidebar.open?"":e.title,"data-placement":"right"}},[n("div",[e.sidebar.open?n("i",{class:e.icon,style:{color:e.iconColor}}):n("span",[n("i",{class:e.icon,style:{color:e.iconColor}})]),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticClass:"treeview-label"})]),e._v(" "),n("div",[e.info.state?n("span",{class:e.info.class,staticStyle:{position:"absolute",right:"5px","font-weight":"bold"},style:e.info.style,attrs:{title:e.info.tooltip}},[e._v(e._s(e.info.state))]):e._e(),e._v(" "),e._l(e.actions,function(s){return n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:s.tooltip,expression:"action.tooltip",arg:"left"}],key:s.id,staticClass:"action",class:s.class,staticStyle:{"font-weight":"bold",padding:"3px"},style:s.style,on:{click:function(o){return o.stopPropagation(),e.triggerAction(s,e.component.internalComponent)}}})})],2),e._v(" "),e.collapsible?n("i",{staticClass:"pull-right",class:e.$fa("angle-left")}):e._e()]),e._v(" "),n("div",{ref:"component-placeholder"})],1)},Qj=[],Kj=void 0,Jj=void 0,e7=void 0,t7=!1;i7=n7({render:Zj,staticRenderFns:Qj},Kj,Xj,Jj,t7,e7,!1,void 0,void 0,void 0),s7=i7});function h7(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="FormHeader.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var r7,o7,a7,l7,c7,u7,d7,f7,sL,rL=R(()=>{r7=Vue.extend({name:"form-header",props:{headers:{type:Array,default:[]},currentid:{type:String},update:{type:Boolean},valid:{type:Boolean}},methods:{click(e){e!==this.currentid&&this.headers.length>1&&this.$emit("clickheader",e)},resizeForm(e){this.$emit("resize-form",e)}}}),o7=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"g3wform_header box-header with-border",staticStyle:{display:"flex","flex-direction":"column"}},[n("section",{staticClass:"g3wform_header_content"},e._l(e.headers,function(s){return n("span",{key:s.id,staticClass:"title",class:[{item_selected:e.currentid===s.id&&e.headers.length>1},[e.headers.length>1?"tabs":"one"]],staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},style:{fontSize:e.isMobile()&&"1em !important"},on:{click:function(o){return o.stopPropagation(),e.click(s.id)}}},[s.icon?n("span",{staticStyle:{"margin-right":"5px"}},[n("i",{class:s.icon})]):e._e(),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t:pre",value:s.title,expression:"header.title",arg:"pre"}],staticClass:"g3w-long-text"},[e._v(e._s(s.name))]),e._v(" "),n(s.component,{tag:"component",attrs:{valid:e.valid,update:e.update}})],1)}),0)])},a7=[],l7=void 0,c7=void 0,u7=void 0,d7=!1;f7=h7({render:o7,staticRenderFns:a7},l7,r7,c7,d7,u7,!1,void 0,void 0,void 0),sL=f7});function x7(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="FormFooter.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var p7,g7,m7,_7,y7,v7,b7,w7,oL,aL=R(()=>{p7=Vue.extend({name:"form-footer",props:{state:{type:Object},backToRoot:{type:Function,default:()=>{}},isRootComponent:{type:Function}},data(){return this.originalbuttons=this.state.buttons.map(e=>({...e})),{id:"footer",active:!0,show:!0}},computed:{enableSave(){return this.state.valid&&this.state.update}},methods:{exec(e){e instanceof Function?e(this.state.fields):function(){return this.state.fields}()},btnEnabled(e){let{enabled:t=!0,type:n}=e;return t&&(n!=="save"||n==="save"&&this.enableSave)},isValid(){return this.state.valid}},watch:{"state.component"(e){this.show=this.isRootComponent(e)},"state.update":{immediate:!0,handler(e){this.state.buttons.find((t,n)=>{t.eventButtons&&t.eventButtons.update&&(t.eventButtons.update[e]?this.state.buttons.splice(n,1,{...t,...t.eventButtons.update[e]}):this.state.buttons.splice(n,1,this.originalbuttons[n]))})}}},activated(){this.active=!0},deactivated(){this.active=!1}}),g7=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-group g3wform_footer"},[e.show?[e._t("default",function(){return[n("div",{staticStyle:{margin:"3px","font-weight":"bold"}},[e._v(`
        * `),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}]}),e._v(" "),e.state.footer.message?n("div",{style:[e.state.footer.style]},[e._v(`
          `+e._s(e.state.footer.message)+`
        `)]):e._e()]),e._v(" "),e._l(e.state.buttons,function(s){return n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.btnEnabled(s),expression:"!btnEnabled(button)"},{name:"t",rawName:"v-t",value:s.title,expression:"button.title"}],key:s.id,staticClass:"btn",class:[s.class],attrs:{update:e.state.update,valid:e.state.valid},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),e.exec(s.cbk)}}})})]})]:[n("button",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}],staticClass:"btn skin-button",on:{click:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"prevet",void 0,s.key,void 0)?null:(s.stopPropagation(),e.backToRoot.apply(null,arguments))}}})]],2)},m7=[],_7=void 0,y7=void 0,v7=void 0,b7=!1;w7=x7({render:g7,staticRenderFns:m7},_7,p7,y7,b7,v7,!1,void 0,void 0,void 0),oL=w7});function k7(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="Form.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var S7,E7,C7,I7,L7,N7,T7,R7,lL,cL=R(()=>{rL();aL();S7={name:"g3w-form",data(){return{state:{},switchcomponent:!1,body:{components:{before:[],after:[]}}}},components:{g3wformheader:sL,G3wFormFooter:oL},transitions:{addremovetransition:"showhide"},methods:{isRootComponent(e){return this.$options.service.isRootComponent(e)},backToRoot(){this.$options.service.setRootComponent()},handleRelation(e){this.$options.service.handleRelation(e)},disableComponent({id:e,disabled:t=!1}){this.$options.service.disableComponent({id:e,disabled:t})},resizeForm(e){this.$options.service.setCurrentFormPercentage(e)},switchComponent(e){this.switchcomponent=!0,this.$options.service.setCurrentComponentById(e)},changeInput(e){return this.$options.service.changeInput(e)},addToValidate(e){this.$options.service.addToValidate(e)},removeToValidate(e){this.$options.service.removeToValidate(e)}},async updated(){await this.$nextTick(),this.switchcomponent&&setTimeout(()=>this.switchcomponent=!1,0)},created(){this.$options.service.getEventBus().$on("set-main-component",()=>{this.switchComponent(0)}),this.$options.service.getEventBus().$on("component-validation",({id:e,valid:t})=>{this.$options.service.setValidComponent({id:e,valid:t})}),this.$options.service.getEventBus().$on("addtovalidate",this.addToValidate),this.$options.service.getEventBus().$on("disable-component",this.disableComponent)},mounted(){this.$options.service.isValid(),this.$options.service.setReady(!0)},beforeDestroy(){this.$options.service.clearAll()}},E7=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"g3wform_content",staticStyle:{position:"relative"}},[n("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),n("g3wformheader",{ref:"g3wformheader",attrs:{currentid:e.state.currentheaderid,headers:e.state.headers,update:e.state.update,valid:e.state.valid},on:{"resize-form":e.resizeForm,clickheader:e.switchComponent}}),e._v(" "),n("div",{ref:"g3wform_body",staticClass:"g3wform_body"},[e._l(e.body.components.before,function(s){return n(s,{tag:"component",attrs:{fields:e.state.fields}})}),e._v(" "),n("keep-alive",[n(e.state.component,{tag:"component",attrs:{handleRelation:e.handleRelation,state:e.state},on:{addtovalidate:e.addToValidate,removetovalidate:e.removeToValidate,changeinput:e.changeInput}})],1),e._v(" "),e._l(e.body.components.after,function(s){return n(s,{tag:"component",attrs:{fields:e.state.fields}})})],2),e._v(" "),n("g3w-form-footer",{ref:"g3w_form_footer",attrs:{isRootComponent:e.isRootComponent,backToRoot:e.backToRoot,state:e.state}})],1)},C7=[],I7=void 0,L7=void 0,N7=void 0,T7=!1;R7=k7({render:E7,staticRenderFns:C7},I7,S7,L7,T7,N7,!1,void 0,void 0,void 0),lL=R7});var uL,dL=R(()=>{Xt();uL={methods:{async autocompleteRequest({layerId:e,field:t,value:n}={}){let s=[];try{s=await De(e).getFilterData({suggest:`${t}|${n}`,unique:t})}catch(o){console.warn(o)}return s.map(o=>({id:o,text:o}))}}}});function j7(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Field.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function pv(){let e=pv.styles||(pv.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var M7,A7,O7,P7,F7,D7,G7,q7,Wo,Bd=R(()=>{M7={name:"field",props:["state"]},A7=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[e.state.showlabel?n("div",{staticClass:"field_label"},[e._t("label",function(){return[e._v(e._s(e.state.label))]})],2):e._e(),e._v(" "),n("div",{staticClass:"field_value"},[e._t("field",function(){return[n("span",{staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:e._s(e.state.value)}})]})],2)])},O7=[],P7=function(e){e&&e("data-v-de19bf82_0",{source:".field[data-v-de19bf82]{background-color:transparent!important;padding-top:3px;padding-bottom:3px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.value[data-v-de19bf82]{position:relative}.field div[data-v-de19bf82]{padding-left:3px}.field_value button[data-v-de19bf82]{margin-right:5px}.field_value[data-v-de19bf82]{padding-left:0!important;padding-right:8px;text-align:right;margin-left:auto}",map:void 0,media:void 0})},F7="data-v-de19bf82",D7=void 0,G7=!1;q7=j7({render:A7,staticRenderFns:O7},P7,M7,F7,G7,D7,!1,pv,void 0,void 0),Wo=q7});function Y7(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="FieldText.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function gv(){let e=gv.styles||(gv.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var $7,B7,U7,z7,V7,H7,W7,X7,mv,hL=R(()=>{Bd();$7={name:"field-text",props:["state"],components:{Field:Wo},created(){}},B7=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("field",{attrs:{state:e.state}})},U7=[],z7=function(e){e&&e("data-v-18457c68_0",{source:".field_text_table[data-v-18457c68]{background-color:transparent!important}.field_text_table .field_label[data-v-18457c68]{font-weight:700}",map:void 0,media:void 0})},V7="data-v-18457c68",H7=void 0,W7=!1;X7=Y7({render:B7,staticRenderFns:U7},z7,$7,V7,W7,H7,!1,gv,void 0,void 0),mv=X7});function iq(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="FieldLink.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function _v(){let e=_v.styles||(_v.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Z7,Q7,K7,J7,eq,tq,nq,sq,cg,yv=R(()=>{Bd();Z7={name:"field-link",props:["state"],data(){return{value:null}},components:{Field:Wo},methods:{openLink(e){window.open(e,"_blank")}},created(){this.value=this.state.value&&typeof this.state.value=="object"?this.state.value.value:this.state.value}},Q7=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("field",{attrs:{state:e.state}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"info.link_button",expression:"'info.link_button'"}],staticClass:"btn skin-button field_link",attrs:{slot:"field",title:e.value},on:{click:function(s){return s.stopPropagation(),e.openLink(e.value)}},slot:"field"})])},K7=[],J7=function(e){e&&e("data-v-145d6e0c_0",{source:".field_link[data-v-145d6e0c]{max-width:100%}",map:void 0,media:void 0})},eq="data-v-145d6e0c",tq=void 0,nq=!1;sq=iq({render:Q7,staticRenderFns:K7},J7,Z7,eq,nq,tq,!1,_v,void 0,void 0),cg=sq});function oq(e,t,n,s,o,l,a,u,h,p){typeof a!="boolean"&&(h=u,u=a,a=!1);var d=typeof n=="function"?n.options:n;e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),s&&(d._scopeId=s);var _;if(l?(_=function(x){x=x||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!x&&typeof __VUE_SSR_CONTEXT__<"u"&&(x=__VUE_SSR_CONTEXT__),t&&t.call(this,h(x)),x&&x._registeredComponents&&x._registeredComponents.add(l)},d._ssrRegister=_):t&&(_=a?function(x){t.call(this,p(x,this.$root.$options.shadowRoot))}:function(x){t.call(this,u(x))}),_)if(d.functional){var m=d.render;d.render=function(b,w){return _.call(w),m(b,w)}}else{var v=d.beforeCreate;d.beforeCreate=v?[].concat(v,_):[_]}return n}function lq(e){return function(t,n){return cq(t,n)}}function cq(e,t){var n=aq?t.media||"default":e,s=fL[n]||(fL[n]={ids:new Set,styles:[]});if(!s.ids.has(e)){s.ids.add(e);var o=t.source;if(t.map&&(o+=`
/*# sourceURL=`+t.map.sources[0]+" */",o+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),s.element||(s.element=document.createElement("style"),s.element.type="text/css",t.media&&s.element.setAttribute("media",t.media),vv===void 0&&(vv=document.head||document.getElementsByTagName("head")[0]),vv.appendChild(s.element)),"styleSheet"in s.element)s.styles.push(o),s.element.styleSheet.cssText=s.styles.filter(Boolean).join(`
`);else{var l=s.ids.size-1,a=document.createTextNode(o),u=s.element.childNodes;u[l]&&s.element.removeChild(u[l]),u.length?s.element.insertBefore(a,u[l]):s.element.appendChild(a)}}}function bv(e){bv.installed||(bv.installed=!0,e.component("Teleport",gL))}var rq,aq,vv,fL,uq,pL,dq,hq,fq,pq,gq,gL,mq,ug,dg,xv=R(()=>{rq={name:"teleport",props:{to:{type:String,required:!0},where:{type:String,default:"after"},disabled:Boolean},data:function(){return{nodes:[],waiting:!1,observer:null,parent:null}},watch:{to:"maybeMove",where:"maybeMove",disabled:function(t){var n=this;t?(this.disable(),this.$nextTick(function(){n.teardownObserver()})):(this.bootObserver(),this.move())}},mounted:function(){this.nodes=Array.from(this.$el.childNodes),this.disabled||this.bootObserver(),this.maybeMove()},beforeDestroy:function(){this.nodes=this.getComponentChildrenNode(),this.disable(),this.teardownObserver()},computed:{classes:function(){return this.disabled?["teleporter"]:["teleporter","hidden"]}},methods:{maybeMove:function(){this.disabled||this.move()},move:function(){if(this.waiting=!1,this.parent=document.querySelector(this.to),!this.parent){this.disable(),this.waiting=!0;return}this.where==="before"?this.parent.prepend(this.getFragment()):this.parent.appendChild(this.getFragment())},disable:function(){this.$el.appendChild(this.getFragment()),this.parent=null},getFragment:function(){var t=document.createDocumentFragment();return this.nodes.forEach(function(n){return t.appendChild(n)}),t},onMutations:function(t){for(var n=this,s=!1,o=0;o<t.length;o++){var l=t[o],a=Array.from(l.addedNodes).filter(function(u){return!n.nodes.includes(u)});Array.from(l.removedNodes).includes(this.parent)?(this.disable(),this.waiting=!this.disabled):this.waiting&&a.length>0&&(s=!0)}s&&this.move()},bootObserver:function(){var t=this;this.observer||(this.observer=new MutationObserver(function(n){return t.onMutations(n)}),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1}),!this.childObserver&&(this.childObserver=new MutationObserver(function(n){var s=n.find(function(o){return o.target===t.$el});s&&(t.nodes.forEach(function(o){return o.parentNode&&o.parentNode.removeChild(o)}),t.nodes=t.getComponentChildrenNode(),t.maybeMove())}),this.childObserver.observe(this.$el,{childList:!0,subtree:!1,attributes:!1,characterData:!1})))},teardownObserver:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.childObserver&&(this.childObserver.disconnect(),this.childObserver=null)},getComponentChildrenNode:function(){return this.$vnode.componentOptions.children.map(function(t){return t.elm}).filter(function(t){return t})}}};aq=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());fL={};uq=rq,pL=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.classes},[e._t("default")],2)},dq=[];pL._withStripped=!0;hq=function(e){e&&e("data-v-50f4b45b_0",{source:`.hidden[data-v-50f4b45b] {
  visibility: hidden;
  display: none;
}

/*# sourceMappingURL=Teleport.vue.map */`,map:{version:3,sources:["/home/shodan/Projects/vue2-teleport/src/Teleport.vue","Teleport.vue"],names:[],mappings:"AA2LA;EACA,kBAAA;EACA,aAAA;AC1LA;;AAEA,uCAAuC",file:"Teleport.vue",sourcesContent:[`<template>
  <div :class="classes">
    <slot/>
  </div>
</template>

<script>
export default {
  name: 'teleport',
  props: {
    to: {
      type: String,
      required: true,
    },
    where: {
      type: String,
      default: 'after',
    },
    disabled: Boolean,
  },
  data() {
    return {
      nodes: [],
      waiting: false,
      observer: null,
      parent: null,
    };
  },
  watch: {
    to: 'maybeMove',
    where: 'maybeMove',
    disabled(value) {
      if (value) {
        this.disable();
        // Ensure all event done.
        this.$nextTick(() => {
          this.teardownObserver();
        });
      } else {
        this.bootObserver();
        this.move();
      }
    },
  },
  mounted() {
    // Store a reference to the nodes
    this.nodes = Array.from(this.$el.childNodes);

    if (!this.disabled) {
      this.bootObserver();
    }

    // Move slot content to target
    this.maybeMove();
  },
  beforeDestroy() {
    // Fix nodes reference
    this.nodes = this.getComponentChildrenNode();

    // Move back
    this.disable();

    // Stop observing
    this.teardownObserver();
  },
  computed: {
    classes() {
      if (this.disabled) {
        return ['teleporter'];
      }

      return ['teleporter', 'hidden'];
    },
  },
  methods: {
    maybeMove() {
      if (!this.disabled) {
        this.move();
      }
    },
    move() {
      this.waiting = false;

      this.parent = document.querySelector(this.to);

      if (!this.parent) {
        this.disable();

        this.waiting = true;

        return;
      }

      if (this.where === 'before') {
        this.parent.prepend(this.getFragment());
      } else {
        this.parent.appendChild(this.getFragment());
      }
    },
    disable() {
      this.$el.appendChild(this.getFragment());
      this.parent = null;
    },
    // Using a fragment is faster because it'll trigger only a single reflow
    // See https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment
    getFragment() {
      const fragment = document.createDocumentFragment();

      this.nodes.forEach(node => fragment.appendChild(node));

      return fragment;
    },
    onMutations(mutations) {
      // Makes sure the move operation is only done once
      let shouldMove = false;

      for (let i = 0; i < mutations.length; i++) {
        const mutation = mutations[i];
        const filteredAddedNodes = Array.from(mutation.addedNodes).filter(node => !this.nodes.includes(node));

        if (Array.from(mutation.removedNodes).includes(this.parent)) {
          this.disable();
          this.waiting = !this.disabled;
        } else if (this.waiting && filteredAddedNodes.length > 0) {
          shouldMove = true;
        }
      }

      if (shouldMove) {
        this.move();
      }
    },
    bootObserver() {
      if (this.observer) {
        return;
      }

      this.observer = new MutationObserver(mutations => this.onMutations(mutations));

      this.observer.observe(document.body, {
        childList: true,
        subtree: true,
        attributes: false,
        characterData: false,
      });

      if (this.childObserver) {
        return;
      }
      // watch childNodes change
      this.childObserver = new MutationObserver(mutations => {
        const childChangeRecord = mutations.find(i => i.target === this.$el);
        if (childChangeRecord) {
          // Remove old nodes before update position.
          this.nodes.forEach((node) => node.parentNode && node.parentNode.removeChild(node));
          this.nodes = this.getComponentChildrenNode();
          this.maybeMove();
        }
      });

      this.childObserver.observe(this.$el, {
        childList: true,
        subtree: false,
        attributes: false,
        characterData: false,
      });
    },
    teardownObserver() {
      if (this.observer) {
        this.observer.disconnect();
        this.observer = null;
      }
      if (this.childObserver) {
        this.childObserver.disconnect();
        this.childObserver = null;
      }
    },
    getComponentChildrenNode() {
      return this.$vnode.componentOptions.children
        .map((i) => i.elm)
        .filter((i) => i);
    },
  },
};
<\/script>

<style scoped lang="scss">
.hidden {
  visibility: hidden;
  display: none;
}
</style>
`,`.hidden {
  visibility: hidden;
  display: none;
}

/*# sourceMappingURL=Teleport.vue.map */`]},media:void 0})},fq="data-v-50f4b45b",pq=void 0,gq=!1,gL=oq({render:pL,staticRenderFns:dq},hq,uq,fq,gq,pq,!1,lq,void 0,void 0);mq={install:bv},ug=null;typeof window<"u"?ug=window.Vue:typeof global<"u"&&(ug=global.Vue);ug&&ug.use(mq);dg=gL});function Eq(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="FieldImage.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function wv(){let e=wv.styles||(wv.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var _q,yq,vq,bq,xq,wq,Sq,Cq,tl,hg=R(()=>{xv();Bd();Xr();Wt();_q={name:"field-image",props:["state"],data(){return{id:Qe(),active:null,value:this.state.value.mime_type!==void 0?this.state.value.value:this.state.value}},components:{Field:Wo,Teleport:dg},computed:{images(){return[].concat(this.value).map(e=>({src:(e||{}).photo||e}))}},methods:{async showGallery(e){this.active=e,Zn(this.value)==="Object"&&(this.value.active=!0),$(`#gallery_${this.id}`).modal("show")},isRelativePath(e){return!e.startsWith("/")&&!e.startsWith("http")?`${window.initConfig.mediaurl}${e}`:e}}},yq=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("field",{attrs:{state:e.state}},[n("div",{staticStyle:{"text-align":"left",display:"inline-block"},attrs:{slot:"field"},slot:"field"},[e._l(e.images,function(s,o){return n("img",{staticClass:"img-responsive",staticStyle:{"max-height":"50px"},attrs:{src:s.src},on:{click:function(l){return l.stopPropagation(),e.showGallery(o)}}})}),e._v(" "),n("Teleport",{attrs:{to:"body"}},[n("div",{staticClass:"modal fade modal-fullscreen",attrs:{id:"gallery_"+e.id,tabindex:"-1",role:"dialog","aria-labelledby":"","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog"},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-body"},[n("div",{staticClass:"carousel slide",attrs:{id:"carousel_"+e.id,"data-interval":"false"}},[n("div",{staticClass:"carousel-inner"},e._l(e.images,function(s,o){return n("div",{staticClass:"item",class:e.active==o?"active":""},[n("img",{staticStyle:{margin:"auto"},attrs:{src:e.isRelativePath(s.src),alt:""}})])}),0),e._v(" "),e.images.length>1?n("a",{staticClass:"left carousel-control",attrs:{href:"#carousel_"+e.id,role:"button","data-slide":"prev"}},[n("span",{class:e.$fa("arrow-left")})]):e._e(),e._v(" "),e.images.length>1?n("a",{staticClass:"right carousel-control",attrs:{href:"#carousel_"+e.id,role:"button","data-slide":"next"}},[n("span",{class:e.$fa("arrow-right")})]):e._e()])])])])])])],2)])},vq=[],bq=function(e){e&&e("data-v-6ae7d977_0",{source:".img-responsive[data-v-6ae7d977]{cursor:pointer}.modal-content[data-v-6ae7d977]{background:rgba(255,255,255,.6);border-radius:3px}.modal-dialog[data-v-6ae7d977]{display:inline-block;text-align:left;vertical-align:middle}.modal[data-v-6ae7d977]{text-align:center;padding:0!important}.modal[data-v-6ae7d977]:before{content:'';display:inline-block;height:100%;vertical-align:middle;margin-right:-4px}.carousel .carousel-control span[data-v-6ae7d977]{color:#3c8dbc;position:absolute;top:50%}",map:void 0,media:void 0})},xq="data-v-6ae7d977",wq=void 0,Sq=!1;Cq=Eq({render:yq,staticRenderFns:vq},bq,_q,xq,Sq,wq,!1,wv,void 0,void 0),tl=Cq});function Aq(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="FieldGeo.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Sv(){let e=Sv.styles||(Sv.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Iq,Lq,Nq,Tq,kq,Rq,Mq,Oq,mL,_L=R(()=>{us();Iq={name:"g3w-geospatial",props:{data:{}},mixins:[fg],data(){return{layerId:`table_layer_${Date.now()}`,visible:!1,id:`geo_table_${Date.now()}`}}},Lq=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"geo-content"},[n("span",{staticClass:"show-hide-geo",class:[e.visible?e.g3wtemplate.font["eye-close"]:e.g3wtemplate.font.eye],on:{click:function(s){return s.stopPropagation(),e.showLayer()}}})])},Nq=[],Tq=function(e){e&&e("data-v-fb42eb1e_0",{source:".show-hide-geo[data-v-fb42eb1e]{color:#3c8dbc;cursor:pointer;font-size:1.2em}",map:void 0,media:void 0})},kq="data-v-fb42eb1e",Rq=void 0,Mq=!1;Oq=Aq({render:Lq,staticRenderFns:Nq},Tq,Iq,kq,Mq,Rq,!1,Sv,void 0,void 0),mL=Oq});function Bq(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="FieldMedia.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Pq,Fq,Dq,Gq,jq,qq,$q,Uq,yL,vL=R(()=>{us();Pq={name:"g3w-media",mixins:[pg],props:["state"],computed:{type(){return this.getMediaType(this.state.mime_type).type},value(){return this.state.value}}},Fq=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.value?n("div",{staticClass:"preview"},[n("a",{attrs:{href:e.value,target:"_blank"}},[n("div",{staticClass:"previewtype",class:e.type},[n("i",{staticClass:"fa-2x",class:e.g3wtemplate.font[e.type]})])]),e._v(" "),n("div",{staticClass:"filename"},[e._v(e._s(e.filename))]),e._v(" "),e._t("default")],2):e._e()},Dq=[],Gq=void 0,jq="data-v-79e0e018",qq=void 0,$q=!1;Uq=Bq({render:Fq,staticRenderFns:Dq},Gq,Pq,jq,$q,qq,!1,void 0,void 0,void 0),yL=Uq});function Qq(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="FieldVue.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var zq,Vq,Hq,Wq,Yq,Xq,Zq,Kq,gg,Ev=R(()=>{Bd();zq={name:"vuefield",props:{feature:{type:Object},state:{type:Object,default:{value:null,vueoptions:{component:{}}}}},components:{Field:Wo}},Vq=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("field",{attrs:{state:e.state}},[n("div",{attrs:{slot:"field"},slot:"field"},[n(e.state.vueoptions.component,{tag:"component",attrs:{feature:e.feature,value:e.state.value}})],1)])},Hq=[],Wq=void 0,Yq=void 0,Xq=void 0,Zq=!1;Kq=Qq({render:Vq,staticRenderFns:Hq},Wq,zq,Yq,Zq,Xq,!1,void 0,void 0,void 0),gg=Kq});var pc=He((sme,bL)=>{hL();yv();hg();_L();vL();Ev();bL.exports={simple_field:mv,text_field:mv,link_field:cg,image_field:tl,geo_field:mL,photo_field:tl,media_field:yL,vue_field:gg}});var Ud=He((ome,wL)=>{Xr();var xL=pc();wL.exports={getType(e){let t=e.type;if(t!=="vue"){let n=e.value,s=n&&Zn(n)==="Object"&&!n.coordinates&&!n.vue?n.value:n;s?s&&typeof s=="object"?s.coordinates?t="geo":s.vue&&(t="vue"):s&&Array.isArray(s)?s.length&&s[0].photo?t="photo":t="simple":s.toString().toLowerCase().match(/[^\s]+.(png|jpg|jpeg|gif)$/g)?t="photo":s.toString().match(/^(https?:\/\/[^\s]+)/g)?t="link":t="simple":t="simple"}return`${t}_field`},isSimple(e){return this.getType(e)==="simple_field"},isLink(e){return this.getType(e)==="link_field"},isImage(e){return this.getType(e)==="image_field"},isPhoto(e){return this.getType(e)==="photo_field"},isVue(e){return this.getType(e)==="vue_field"},add({type:e,field:t}){xL[e]=t},remove(e){delete xL[e]}}});var mr,SL=R(()=>{mr={methods:{getFieldService(){return this._fieldsService===void 0&&(this._fieldsService=Ud()),this._fieldsService},getFieldType(e){return this.getFieldService().getType(e)},isSimple(e){return this.getFieldService().isSimple(e)},isLink(e){return this.getFieldService().isLink(e)},isImage(e){return this.getFieldService().isImage(e)},isPhoto(e){return this.getFieldService().isPhoto(e)},isVue(e){return this.getFieldService().isVue(e)},sanitizeFieldValue(e){return Array.isArray(e)&&!e.length?"":e}}}});var pg,EL=R(()=>{pg={computed:{filename(){return this.value?this.value.split("/").pop():this.value}},methods:{isMedia(e){return e&&typeof e=="object"&&Object===e.constructor?!!e.mime_type:!1},getMediaType(e){let t={type:null,options:{}};switch(e){case"image/gif":case"image/png":case"image/jpeg":case"image/bmp":t.type="image";break;case"application/pdf":t.type="pdf";break;case"video/mp4":case"video/ogg":case"video/x-ms-wmv":case"video/x-msvideo":case"video/quicktime":t.type="video",t.options.format=e;break;case"application/gzip":case"application/zip":t.type="zip";break;case"application/msword":case"application/vnd.oasis.opendocument.text":t.type="text";break;case"application/vnd.ms-office":case"application/vnd.oasis.opendocument.spreadsheet":t.type="excel";break;case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.oasis.opendocument.presentation":t.type="ppt";break;default:t.type="unknow"}return t}}}});var fg,CL=R(()=>{ze();fg={methods:{showLayer(){this.visible=!this.visible,this.layer.setVisible(this.visible)}},created(){let e=this.data,t=T.getService("map").getProjection().getCode(),n;switch(e.type){case"Point":case"MultiPoint":n=[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}),new ol.style.Style({image:new ol.style.Circle({radius:2,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})})];break;case"Line":case"MultiLineString":case"Polygon":case"MultiPolygon":n=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.3)"}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})});break}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:new ol.format.GeoJSON().readFeatures(e,{featureProjection:t})}),visible:!!this.visible,style:n}),T.getService("map").getMap().addLayer(this.layer)},beforeDestroy(){T.getService("map").getMap().removeLayer(this.layer)}}});var IL,_r,zd=R(()=>{ze();dr();Us();IL={throttle:En,debounce:un},_r={created(){let e=this.delayType&&IL[this.delayType]||IL.throttle;this.delayResize=this.resize?e(this.resize.bind(this),this.delayTime):null,T.on("resize",this.delayResize)},async mounted(){await this.$nextTick(),this.resize&&this.resize()},beforeDestroy(){T.off("resize",this.delayResize),this.delayResize=null,this.delayTime=null}}});var gc,LL=R(()=>{gc={methods:{getLanguage(){return window.initConfig.user.i18n||"en"},async changeSelect(e){this.state.value=e==="null"?null:e,await this.$nextTick(),this.change()},getValue(e){return e===null?"null":e},resetValues(){this.state.input.options.values.splice(0)}},computed:{autocomplete(){return this.state.input.type==="select_autocomplete"&&this.state.input.options.usecompleter}},watch:{async notvalid(e){await this.$nextTick(),this.select2&&this.select2.data("select2").$container[e?"addClass":"removeClass"]("input-error-validation")}}}});var mg,NL=R(()=>{Ke();zd();mg={mixins:[_r],methods:{setValue(){this.select2.val(this.state.value).trigger("change")},resize(){this.select2&&!F.ismobile&&this.select2.select2("close")}},beforeDestroy(){this.select2&&(this.select2.select2("destroy"),this.select2.off(),this.select2=null)}}});var TL,kL=R(()=>{TL={data(){return{valid:!1}},methods:{addToValidate(e){this.tovalidate.push(e)},changeInput(e){this.isValid(e)},isValid(e){if(e){if(e.validate.mutually){if(!e.validate.required)if(!e.validate.empty)e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce((t,n)=>t&&this.tovalidate[n].validate.empty,!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid;else{e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;let t=[];for(let n=e.validate.mutually.length;n--;){let s=e.validate.mutually[n];this.tovalidate[s].validate.empty||t.push(s)}t.length<2&&t.forEach(n=>{this.tovalidate[n].validate.mutually_valid=!0,this.tovalidate[n].validate.valid=!0,setTimeout(()=>{this.tovalidate[n].validate.valid=this.tovalidate[n].validate._valid,this.state.valid=this.state.valid&&this.tovalidate[n].validate.valid})})}}else if(!e.validate.empty&&(e.validate.min_field||e.validate.max_field)){let t=e.validate.min_field||e.validate.max_field;e.validate.valid=e.validate.min_field?this.tovalidate[e.validate.min_field].validate.empty||1*e.value>1*this.tovalidate[e.validate.min_field].value:this.tovalidate[e.validate.max_field].validate.empty||1*e.value<1*this.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.tovalidate[t].validate.valid=!0)}}this.valid=Object.values(this.tovalidate).reduce((t,n)=>t&&n.validate.valid,!0)}},created(){this.tovalidate=[]},destroyed(){this.tovalidate=null}}});var mc,RL=R(()=>{mc={computed:{tabIndex(){return this.editable?0:-1},notvalid(){return this.state.validate.valid===!1},editable(){return this.state.editable},showhelpicon(){return this.state.help&&this.state.help.message.trim()},disabled(){return!this.editable||["loading","error"].includes(this.loadingState)},loadingState(){return this.state.input.options.loading?this.state.input.options.loading.state:null}},methods:{setLoading(e){this.state.input.options.loading.state=e?"loading":"ready"},showHideHelp(){this.state.help.visible=!this.state.help.visible},mobileChange(e){this.state.value=e.target.value,this.change()},change(){this.service.setEmpty(),this.service.validate(),this.service.setUpdate(),this.$emit("changeinput",this.state)},isVisible(){}}}});var Jq,ML,us=R(()=>{dL();SL();EL();CL();zd();LL();NL();kL();RL();Jq={autocompleteMixin:uL,fieldsMixin:mr,mediaMixin:pg,geoMixin:fg,resizeMixin:_r,selectMixin:gc,select2Mixin:mg,formInputsMixins:TL,baseInputMixin:mc},ML=Jq});function a9(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="InputBase.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Cv(){let e=Cv.styles||(Cv.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var e9,t9,n9,i9,s9,r9,o9,l9,AL,OL=R(()=>{us();e9={name:"InputBase",props:["state"],...mc},t9=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.state.visible?n("div",{staticClass:"form-group"},[e.state.showlabel===void 0||e.state.showlabel?[e._t("label",function(){return[n("label",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"control-label",attrs:{for:e.state.name}},[e.state.i18nLabel?n("span",{directives:[{name:"t",rawName:"v-t",value:e.state.label,expression:"state.label"}]}):n("span",[e._v(e._s(e.state.label))]),e._v(" "),e.state.validate&&e.state.validate.required?n("span",[e._v("*")]):e._e(),e._v(" "),e.showhelpicon?n("i",{staticClass:"skin-color",class:e.g3wtemplate.font.info,staticStyle:{"margin-left":"3px",cursor:"pointer"},on:{click:function(s){return s.stopPropagation(),e.showHideHelp.apply(null,arguments)}}}):e._e()])]})]:e._e(),e._v(" "),e._t("label-action"),e._v(" "),e.state.relationField?n("div",{staticStyle:{color:"var(--skin-warning)",padding:"3px 0 3px 15px"}},[n("span",{class:e.g3wtemplate.getFontClass("warning")}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"Relation key field",expression:"'Relation key field'"}]})]):e._e(),e._v(" "),n("div",{},[e._t("loading",function(){return[e.loadingState==="loading"?n("div",{staticStyle:{position:"relative",width:"100%"},attrs:{slot:"loading"},slot:"loading"},[n("bar-loader",{attrs:{loading:!0}})],1):e._e()]}),e._v(" "),e._t("body"),e._v(" "),e._t("message",function(){return[e.notvalid?n("p",{staticClass:"g3w-long-text error-input-message",staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.validate.message)}}):e.state.info?n("p",{staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.info)}}):e._e()]}),e._v(" "),e.state.help&&this.state.help.visible?n("div",{staticClass:"g3w_input_help skin-background-color",staticStyle:{"background-color":"hsl(from var(--skin-color) h s calc(l + 48)) !important"},domProps:{innerHTML:e._s(e.state.help.message)}}):e._e()],2)],2):e._e()},n9=[],i9=function(e){e&&e("data-v-61356f4f_0",{source:".control-label[data-v-61356f4f]{text-align:left!important;padding-top:0!important;margin-bottom:3px}",map:void 0,media:void 0})},s9="data-v-61356f4f",r9=void 0,o9=!1;l9=a9({render:t9,staticRenderFns:n9},i9,e9,s9,o9,r9,!1,Cv,void 0,void 0),AL=l9});var Qn=He((PL,FL)=>{Xr();Rt();var c9={validators:{float:(e={})=>({options:e,validate:t=>!Number.isNaN(Number(1*t))}),bigint:(e={})=>({options:e,validate(t){return t=1*t,Number.isNaN(t)?!1:t<=Number.MAX_SAFE_INTEGER}}),integer:(e={})=>({options:e,validate(t){let n=1*t;return Number.isNaN(n)?!1:Number.isSafeInteger(n)&&n<=2147483647}}),checkbox:(e={})=>({options:e,validate:t=>(PL.options.values||[]).includes(t)}),datetimepicker:(e={})=>({options:e,validate:(t,n)=>moment(t,n.fielddatetimeformat,!0).isValid()}),char:e=>({options:e,validate:t=>t&&`${t}`.length===1}),varchar:(e={})=>({options:e,validate:()=>!0}),text:(e={})=>({options:e,validate:()=>!0}),string:(e={})=>({options:e,validate:()=>!0}),radio:(e={})=>({options:e,validate:()=>!0}),default:(e={})=>({options:e,validate:()=>!0}),range:(e={})=>({options:e,validate(t){return t=1*t,t>=e.min&&t<=e.max}})},get(e,t={}){return(this.validators[e]||this.validators.default)(t)}};FL.exports=class{constructor(t={}){this.state=t.state||{},this.setValue(this.state.value),this.setEmpty(this.state.value);let n=this.state.type,s=t.validatorOptions||this.state.input.options||{};this._validator=c9.get(n,s),this.setErrorMessage()}getState(){return this.state}getValue(){return this.state.value}setValue(t){if(![null,void 0].includes(t))return;let{options:n}=this.state.input,s=n.default;Array.isArray(n)&&(n[0].default?s=n[0].default:Array.isArray(n.values)&&n.values.length>0&&(s=n.values[0]&&(n.values[0].value||n.values[0])));let o=this.state.get_default_value&&s!==void 0&&s!==null;o&&n.default_expression===void 0&&(this.state.value=s),this.state.value_from_default_value=o}addValueToValues(t){this.state.input.options.values.unshift(t)}_getValidatorType(){return this.state.type}setState(t={}){this.state=Zn(t)==="Object"?t:{}}getValidator(){return this._validator}setValidator(t){this._validator=t}setEmpty(){this.state.validate.empty=this.state.value===null||`${this.state.value}`.trim()===""}validate(){return this.state.validate.empty?(this.state.value=null,this.state.validate.valid=!this.state.validate.required):(["integer","float","bigint"].includes(this.state.input.type)&&(+this.state.value<0?(this.state.value=null,this.state.validate.empty=!0,this.state.validate.valid=!this.state.validate.required):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.unique&&this.state.validate.exclude_values&&this.state.validate.exclude_values.size?this.state.validate.valid=!this.state.validate.exclude_values.has(`${this.state.value}`):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.valid}setErrorMessage(){if(this.state.validate.error){this.state.validate.message=_e(this.state.validate.error);return}let t;this.state.validate.mutually&&!this.state.validate.mutually_valid?this.state.validate.message=`${_e("sdk.form.inputs.input_validation_mutually_exclusive")} ( ${this.state.validate.mutually.join(",")} )`:this.state.validate.max_field?this.state.validate.message=`${_e("sdk.form.inputs.input_validation_max_field")} (${this.state.validate.max_field})`:this.state.validate.min_field?this.state.validate.message=`${_e("sdk.form.inputs.input_validation_min_field")} (${this.state.validate.min_field})`:(this.state.input.type==="unique"||this.state.validate.unique)&&this.state.validate.exclude_values&&this.state.validate.exclude_values.size?this.state.validate.message=`${_e("sdk.form.inputs.input_validation_exclude_values")}`:this.state.validate.required?(t=`${_e("sdk.form.inputs.input_validation_error")} ( ${_e("sdk.form.inputs."+this.state.type)} )`,this.state.info&&(t=`${t}
                 <div>
                  <b>${this.state.info}</b>
                 </div>         
      `),this.state.validate.message=this.state.info||t):this.state.validate.message=this.state.info||`${_e("sdk.form.inputs.input_validation_error_type")} ( ${_e("sdk.form.inputs."+this.state.type)} )`}setUpdate(){let{value:t,_value:n}=this.state;this.state.input.type==="media"&&Zn(t)!=="Object"&&Zn(n)!=="Object"?this.state.update=t.value!=n.value:this.state.input.type==="datetimepicker"?this.state.update=(t!==null?t.toUpperCase():t)!=(n&&n.toUpperCase()):this.state.update=t!=n}}});var GL=He((Dme,DL)=>{var u9=Qn();DL.exports=class extends u9{constructor(t={}){super(t)}}});var qL=He((jme,jL)=>{var d9=Qn();jL.exports=class extends d9{constructor(t={}){super(t)}}});var BL=He(($me,$L)=>{var h9=Qn();$L.exports=class extends h9{constructor(t={}){super(t)}}});var zL=He((Ume,UL)=>{var f9=Qn();UL.exports=class extends f9{constructor(t={}){t.validatorOptions={values:t.state.input.options.values.map(n=>n)},super(t)}}});var HL=He((Vme,VL)=>{var p9=Qn();VL.exports=class extends p9{constructor(t={}){let{min:n,max:s}=t.state.input.options.values[0];t.state.info=`[MIN: ${n} - MAX: ${s}]`,super(t),this.setValidator({validate(o){return o=1*o,o>=1*n&&o<=1*s}})}isValueInRange(t,n,s){return t<=s&&t>=n}}});function Vd(e){e=e.replace(/y/g,"Y");let t=e.match(/d/g);return t&&t.length<3&&(e=e.replace(/d/g,"D")),e}var Iv=R(()=>{});var YL=He((Xme,WL)=>{Iv();var g9=Qn();WL.exports=class extends g9{constructor(t={}){super(t),this.validatorOptions={}}getLocale(){return window.initConfig.user.i18n?window.initConfig.user.i18n:"en"}convertQGISDateTimeFormatToMoment(t){return Vd(t)}setValidatorOptions(t={}){this.validatorOptions=t}}});var ZL=He((Qme,XL)=>{var m9=Qn();XL.exports=class extends m9{constructor(t={}){super(t)}}});var Lv=He((e_e,QL)=>{Xt();var _9=Qn();QL.exports=class extends _9{constructor(t={}){super(t),this.layer=null}_getLayerById(t){return De(t)}addValue(t){this.state.input.options.values.push(t)}sortValues(){let{orderbyvalue:t}=this.state.input.options;this.state.input.options.values.sort((n,s)=>{let o=n[t?"value":"key"],l=s[t?"value":"key"];return o<l?-1:o>l?1:0})}getKeyByValue({search:t}={}){let{value:n,key:s}=this.state.input.options;return new Promise((o,l)=>{this.getData({key:s,value:n,search:t}).then(a=>{a.forEach(({$value:u,text:h})=>{this.addValue({key:u,value:h})}),this.sortValues(),o(this.state.input.options.values)}).catch(a=>{console.warn(a),l(a)})})}getData({layer_id:t=this.state.input.options.layer_id,key:n=this.state.input.options.key,value:s=this.state.input.options.value,search:o}={}){return new Promise((l,a)=>{this._layer||(this._layer=this._getLayerById(t)),this._layer.getDataTable({[Array.isArray(o)?"field":"suggest"]:Array.isArray(o)?o.map((u,h)=>[].concat(o[h]).map(p=>`${n}|eq|${encodeURIComponent(p)}`).join("|null,")).join("|OR,")||"":`${n}|${o}`.trim(),ordering:this.state.input.options.orderbyvalue?s:n}).then(u=>{let h=u.features.map(p=>({text:p.properties[n],id:p.properties[s],$value:p.properties[s]}));l(h)}).fail(u=>{console.warn(u),a(u)})})}}});var JL=He((n_e,KL)=>{var y9=Qn();KL.exports=class extends y9{constructor(t={}){super(t)}}});var tN=He((i_e,eN)=>{var v9=Qn(),Nv=class extends v9{constructor(t={}){let{state:n}=t;t.state.info=`[MIN: ${n.input.options.min} - MAX: ${n.input.options.max}]`,super(t),this.setValidator({validate(s){return s=1*s,s>=1*t.state.input.options.min&&s<=1*t.state.input.options.max}})}validate(){this.state.value=1*this.state.value,this.state.validate.valid=this.state.value>=this.state.input.options.min||this.state.value<=this.state.input.options.max}changeInfoMessage(){this.state.info=`[MIN: ${this.state.input.options.min} - MAX: ${this.state.input.options.max}]`}};eN.exports=Nv});var iN=He((o_e,nN)=>{ze();var b9=Qn();nN.exports=class extends b9{constructor(t={}){super(t),this.coordinatebutton,this.mapService=T.getService("map"),this.mapEpsg=this.mapService.getCrs(),this.mapControlToggleEventHandler=n=>{n.target.isToggled()&&n.target.isClickMap()&&this.coordinatebutton.active&&this.toggleGetCoordinate()},this.map=this.mapService.getMap(),this.outputEpsg=this.state.epsg||this.mapEpsg,this.eventMapKey}setCoordinateButtonReactiveObject(t){this.coordinatebutton=t}validate(){this.state.values.lon<-180?this.state.values.lon=-180:this.state.values.lon>180&&(this.state.values.lon=180),this.state.values.lat<-90?this.state.values.lon=-90:this.state.values.lat>90&&(this.state.values.lon=90),this.state.validate.valid=!Number.isNaN(1*this.state.values.lon)}toggleGetCoordinate(){this.coordinatebutton.active=!this.coordinatebutton.active,this.coordinatebutton.active?this.startToGetCoordinates():this.stopToGetCoordinates()}startToGetCoordinates(){this.mapService.deactiveMapControls(),this.mapService.on("mapcontrol:toggled",this.mapControlToggleEventHandler),this.eventMapKey=this.map.on("click",t=>{t.originalEvent.stopPropagation(),t.preventDefault();let n=this.mapEpsg!==this.outputEpsg?ol.proj.transform(t.coordinate,this.mapEpsg,this.outputEpsg):t.coordinate;this.state.value=[n];let[s,o]=n;this.state.values.lon=s,this.state.values.lat=o})}stopToGetCoordinates(){ol.Observable.unByKey(this.eventMapKey),this.mapService.off("mapcontrol:toggled",this.mapControlToggleEventHandler)}clear(){this.stopToGetCoordinates()}}});var rN=He((a_e,sN)=>{var x9={text:Qn(),textarea:Qn(),texthtml:Qn(),integer:GL(),string:Qn(),float:qL(),radio:BL(),check:zL(),range:HL(),datetimepicker:YL(),unique:ZL(),select:Lv(),media:JL(),select_autocomplete:Lv(),picklayer:Qn(),color:Qn(),slider:tN(),lonlat:iN()};sN.exports=x9});var ti=He((d_e,oN)=>{Ke();OL();us();var w9=rN(),S9={props:["state"],mixins:[mc],components:{baseinput:AL},watch:{notvalid(e){e&&this.service.setErrorMessage()},"state.value"(){this.state.input.options.default_expression!==void 0&&setTimeout(()=>this.change())}},created(){this.service=new w9[this.state.input.type]({state:this.state}),this.$watch(()=>F.language,async()=>{this.state.visible&&(this.state.visible=!1,this.service.setErrorMessage(),await this.$nextTick(),this.state.visible=!0)}),this.state.editable&&this.state.validate.required&&this.service.validate(),this.$emit("addinput",this.state),this.state.value_from_default_value&&this.$emit("changeinput",this.state)},destroyed(){this.$emit("removeinput",this.state)}};oN.exports=S9});function M9(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputText.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var E9,C9,I9,L9,N9,T9,k9,R9,A9,_c,_g=R(()=>{E9=ti(),C9={name:"input-text",mixins:[E9]},I9=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},attrs:{slot:"body",placeholder:e.state.default,tabIndex:e.tabIndex,field:e.state.name,id:e.state.name},domProps:{value:e.state.value},on:{keyup:function(s){e.isMobile()?e.mobileChange(s):e.change()},input:function(s){s.target.composing||e.$set(e.state,"value",s.target.value)}},slot:"body"})])},L9=[],N9=void 0,T9=void 0,k9=void 0,R9=!1;A9=M9({render:I9,staticRenderFns:L9},N9,C9,T9,R9,k9,!1,void 0,void 0,void 0),_c=A9});var Hd=He((p_e,aN)=>{_g();var O9=Vue.extend(_c);aN.exports=O9});var P9,yg,Tv=R(()=>{P9=typeof global=="object"&&global&&global.Object===Object&&global,yg=P9});var F9,D9,On,Ys=R(()=>{Tv();F9=typeof self=="object"&&self&&self.Object===Object&&self,D9=yg||F9||Function("return this")(),On=D9});var G9,Ls,Wd=R(()=>{Ys();G9=On.Symbol,Ls=G9});function $9(e){var t=j9.call(e,Yd),n=e[Yd];try{e[Yd]=void 0;var s=!0}catch{}var o=q9.call(e);return s&&(t?e[Yd]=n:delete e[Yd]),o}var lN,j9,q9,Yd,cN,uN=R(()=>{Wd();lN=Object.prototype,j9=lN.hasOwnProperty,q9=lN.toString,Yd=Ls?Ls.toStringTag:void 0;cN=$9});function z9(e){return U9.call(e)}var B9,U9,dN,hN=R(()=>{B9=Object.prototype,U9=B9.toString;dN=z9});function W9(e){return e==null?e===void 0?H9:V9:fN&&fN in Object(e)?cN(e):dN(e)}var V9,H9,fN,Xs,yc=R(()=>{Wd();uN();hN();V9="[object Null]",H9="[object Undefined]",fN=Ls?Ls.toStringTag:void 0;Xs=W9});function Y9(e){return e!=null&&typeof e=="object"}var ni,Zr=R(()=>{ni=Y9});var X9,Ns,vc=R(()=>{X9=Array.isArray,Ns=X9});function Z9(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ci,Qr=R(()=>{ci=Z9});function Q9(e){return e}var vg,kv=R(()=>{vg=Q9});function n$(e){if(!ci(e))return!1;var t=Xs(e);return t==J9||t==e$||t==K9||t==t$}var K9,J9,e$,t$,bc,bg=R(()=>{yc();Qr();K9="[object AsyncFunction]",J9="[object Function]",e$="[object GeneratorFunction]",t$="[object Proxy]";bc=n$});var i$,xg,pN=R(()=>{Ys();i$=On["__core-js_shared__"],xg=i$});function s$(e){return!!gN&&gN in e}var gN,mN,_N=R(()=>{pN();gN=function(){var e=/[^.]+$/.exec(xg&&xg.keys&&xg.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();mN=s$});function a$(e){if(e!=null){try{return o$.call(e)}catch{}try{return e+""}catch{}}return""}var r$,o$,Kr,Rv=R(()=>{r$=Function.prototype,o$=r$.toString;Kr=a$});function g$(e){if(!ci(e)||mN(e))return!1;var t=bc(e)?p$:c$;return t.test(Kr(e))}var l$,c$,u$,d$,h$,f$,p$,yN,vN=R(()=>{bg();_N();Qr();Rv();l$=/[\\^$.*+?()[\]{}|]/g,c$=/^\[object .+?Constructor\]$/,u$=Function.prototype,d$=Object.prototype,h$=u$.toString,f$=d$.hasOwnProperty,p$=RegExp("^"+h$.call(f$).replace(l$,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");yN=g$});function m$(e,t){return e?.[t]}var bN,xN=R(()=>{bN=m$});function _$(e,t){var n=bN(e,t);return yN(n)?n:void 0}var Bi,Yo=R(()=>{vN();xN();Bi=_$});var y$,wg,wN=R(()=>{Yo();Ys();y$=Bi(On,"WeakMap"),wg=y$});var SN,v$,EN,CN=R(()=>{Qr();SN=Object.create,v$=function(){function e(){}return function(t){if(!ci(t))return{};if(SN)return SN(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),EN=v$});function b$(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var IN,LN=R(()=>{IN=b$});function x$(e,t){var n=-1,s=e.length;for(t||(t=Array(s));++n<s;)t[n]=e[n];return t}var Sg,Mv=R(()=>{Sg=x$});function C$(e){var t=0,n=0;return function(){var s=E$(),o=S$-(s-n);if(n=s,o>0){if(++t>=w$)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var w$,S$,E$,NN,TN=R(()=>{w$=800,S$=16,E$=Date.now;NN=C$});function I$(e){return function(){return e}}var kN,RN=R(()=>{kN=I$});var L$,xc,Av=R(()=>{Yo();L$=function(){try{var e=Bi(Object,"defineProperty");return e({},"",{}),e}catch{}}(),xc=L$});var N$,MN,AN=R(()=>{RN();Av();kv();N$=xc?function(e,t){return xc(e,"toString",{configurable:!0,enumerable:!1,value:kN(t),writable:!0})}:vg,MN=N$});var T$,ON,PN=R(()=>{AN();TN();T$=NN(MN),ON=T$});function k$(e,t){for(var n=-1,s=e==null?0:e.length;++n<s&&t(e[n],n,e)!==!1;);return e}var FN,DN=R(()=>{FN=k$});function A$(e,t){var n=typeof e;return t=t??R$,!!t&&(n=="number"||n!="symbol"&&M$.test(e))&&e>-1&&e%1==0&&e<t}var R$,M$,Eg,Ov=R(()=>{R$=9007199254740991,M$=/^(?:0|[1-9]\d*)$/;Eg=A$});function O$(e,t,n){t=="__proto__"&&xc?xc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var wc,Cg=R(()=>{Av();wc=O$});function P$(e,t){return e===t||e!==e&&t!==t}var yr,Sc=R(()=>{yr=P$});function G$(e,t,n){var s=e[t];(!(D$.call(e,t)&&yr(s,n))||n===void 0&&!(t in e))&&wc(e,t,n)}var F$,D$,Ig,Pv=R(()=>{Cg();Sc();F$=Object.prototype,D$=F$.hasOwnProperty;Ig=G$});function j$(e,t,n,s){var o=!n;n||(n={});for(var l=-1,a=t.length;++l<a;){var u=t[l],h=s?s(n[u],e[u],u,n,e):void 0;h===void 0&&(h=e[u]),o?wc(n,u,h):Ig(n,u,h)}return n}var vr,Ec=R(()=>{Pv();Cg();vr=j$});function q$(e,t,n){return t=GN(t===void 0?e.length-1:t,0),function(){for(var s=arguments,o=-1,l=GN(s.length-t,0),a=Array(l);++o<l;)a[o]=s[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=s[o];return u[t]=n(a),IN(e,this,u)}}var GN,jN,qN=R(()=>{LN();GN=Math.max;jN=q$});function $$(e,t){return ON(jN(e,t,vg),e+"")}var $N,BN=R(()=>{kv();qN();PN();$N=$$});function U$(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=B$}var B$,Lg,Fv=R(()=>{B$=9007199254740991;Lg=U$});function z$(e){return e!=null&&Lg(e.length)&&!bc(e)}var Xo,Xd=R(()=>{bg();Fv();Xo=z$});function V$(e,t,n){if(!ci(n))return!1;var s=typeof t;return(s=="number"?Xo(n)&&Eg(t,n.length):s=="string"&&t in n)?yr(n[t],e):!1}var UN,zN=R(()=>{Sc();Xd();Ov();Qr();UN=V$});function H$(e){return $N(function(t,n){var s=-1,o=n.length,l=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(l=e.length>3&&typeof l=="function"?(o--,l):void 0,a&&UN(n[0],n[1],a)&&(l=o<3?void 0:l,o=1),t=Object(t);++s<o;){var u=n[s];u&&e(t,u,s,l)}return t})}var VN,HN=R(()=>{BN();zN();VN=H$});function Y$(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||W$;return e===n}var W$,Cc,Ng=R(()=>{W$=Object.prototype;Cc=Y$});function X$(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}var WN,YN=R(()=>{WN=X$});function Q$(e){return ni(e)&&Xs(e)==Z$}var Z$,Dv,XN=R(()=>{yc();Zr();Z$="[object Arguments]";Dv=Q$});var ZN,K$,J$,eB,Zd,Gv=R(()=>{XN();Zr();ZN=Object.prototype,K$=ZN.hasOwnProperty,J$=ZN.propertyIsEnumerable,eB=Dv(function(){return arguments}())?Dv:function(e){return ni(e)&&K$.call(e,"callee")&&!J$.call(e,"callee")},Zd=eB});function tB(){return!1}var QN,KN=R(()=>{QN=tB});var tT,JN,nB,eT,iB,sB,Jr,Qd=R(()=>{Ys();KN();tT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,JN=tT&&typeof module=="object"&&module&&!module.nodeType&&module,nB=JN&&JN.exports===tT,eT=nB?On.Buffer:void 0,iB=eT?eT.isBuffer:void 0,sB=iB||QN,Jr=sB});function TB(e){return ni(e)&&Lg(e.length)&&!!tn[Xs(e)]}var rB,oB,aB,lB,cB,uB,dB,hB,fB,pB,gB,mB,_B,yB,vB,bB,xB,wB,SB,EB,CB,IB,LB,NB,tn,nT,iT=R(()=>{yc();Fv();Zr();rB="[object Arguments]",oB="[object Array]",aB="[object Boolean]",lB="[object Date]",cB="[object Error]",uB="[object Function]",dB="[object Map]",hB="[object Number]",fB="[object Object]",pB="[object RegExp]",gB="[object Set]",mB="[object String]",_B="[object WeakMap]",yB="[object ArrayBuffer]",vB="[object DataView]",bB="[object Float32Array]",xB="[object Float64Array]",wB="[object Int8Array]",SB="[object Int16Array]",EB="[object Int32Array]",CB="[object Uint8Array]",IB="[object Uint8ClampedArray]",LB="[object Uint16Array]",NB="[object Uint32Array]",tn={};tn[bB]=tn[xB]=tn[wB]=tn[SB]=tn[EB]=tn[CB]=tn[IB]=tn[LB]=tn[NB]=!0;tn[rB]=tn[oB]=tn[yB]=tn[aB]=tn[vB]=tn[lB]=tn[cB]=tn[uB]=tn[dB]=tn[hB]=tn[fB]=tn[pB]=tn[gB]=tn[mB]=tn[_B]=!1;nT=TB});function kB(e){return function(t){return e(t)}}var Ic,Tg=R(()=>{Ic=kB});var sT,Kd,RB,jv,MB,eo,kg=R(()=>{Tv();sT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Kd=sT&&typeof module=="object"&&module&&!module.nodeType&&module,RB=Kd&&Kd.exports===sT,jv=RB&&yg.process,MB=function(){try{var e=Kd&&Kd.require&&Kd.require("util").types;return e||jv&&jv.binding&&jv.binding("util")}catch{}}(),eo=MB});var rT,AB,Lc,Rg=R(()=>{iT();Tg();kg();rT=eo&&eo.isTypedArray,AB=rT?Ic(rT):nT,Lc=AB});function FB(e,t){var n=Ns(e),s=!n&&Zd(e),o=!n&&!s&&Jr(e),l=!n&&!s&&!o&&Lc(e),a=n||s||o||l,u=a?WN(e.length,String):[],h=u.length;for(var p in e)(t||PB.call(e,p))&&!(a&&(p=="length"||o&&(p=="offset"||p=="parent")||l&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||Eg(p,h)))&&u.push(p);return u}var OB,PB,Mg,qv=R(()=>{YN();Gv();vc();Qd();Ov();Rg();OB=Object.prototype,PB=OB.hasOwnProperty;Mg=FB});function DB(e,t){return function(n){return e(t(n))}}var Ag,$v=R(()=>{Ag=DB});var GB,oT,aT=R(()=>{$v();GB=Ag(Object.keys,Object),oT=GB});function $B(e){if(!Cc(e))return oT(e);var t=[];for(var n in Object(e))qB.call(e,n)&&n!="constructor"&&t.push(n);return t}var jB,qB,lT,cT=R(()=>{Ng();aT();jB=Object.prototype,qB=jB.hasOwnProperty;lT=$B});function BB(e){return Xo(e)?Mg(e):lT(e)}var Nc,Og=R(()=>{qv();cT();Xd();Nc=BB});function UB(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var uT,dT=R(()=>{uT=UB});function HB(e){if(!ci(e))return uT(e);var t=Cc(e),n=[];for(var s in e)s=="constructor"&&(t||!VB.call(e,s))||n.push(s);return n}var zB,VB,hT,fT=R(()=>{Qr();Ng();dT();zB=Object.prototype,VB=zB.hasOwnProperty;hT=HB});function WB(e){return Xo(e)?Mg(e,!0):hT(e)}var br,Tc=R(()=>{qv();fT();Xd();br=WB});var YB,to,Jd=R(()=>{Yo();YB=Bi(Object,"create"),to=YB});function XB(){this.__data__=to?to(null):{},this.size=0}var pT,gT=R(()=>{Jd();pT=XB});function ZB(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var mT,_T=R(()=>{mT=ZB});function eU(e){var t=this.__data__;if(to){var n=t[e];return n===QB?void 0:n}return JB.call(t,e)?t[e]:void 0}var QB,KB,JB,yT,vT=R(()=>{Jd();QB="__lodash_hash_undefined__",KB=Object.prototype,JB=KB.hasOwnProperty;yT=eU});function iU(e){var t=this.__data__;return to?t[e]!==void 0:nU.call(t,e)}var tU,nU,bT,xT=R(()=>{Jd();tU=Object.prototype,nU=tU.hasOwnProperty;bT=iU});function rU(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=to&&t===void 0?sU:t,this}var sU,wT,ST=R(()=>{Jd();sU="__lodash_hash_undefined__";wT=rU});function kc(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}var Bv,ET=R(()=>{gT();_T();vT();xT();ST();kc.prototype.clear=pT;kc.prototype.delete=mT;kc.prototype.get=yT;kc.prototype.has=bT;kc.prototype.set=wT;Bv=kc});function oU(){this.__data__=[],this.size=0}var CT,IT=R(()=>{CT=oU});function aU(e,t){for(var n=e.length;n--;)if(yr(e[n][0],t))return n;return-1}var Zo,eh=R(()=>{Sc();Zo=aU});function uU(e){var t=this.__data__,n=Zo(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():cU.call(t,n,1),--this.size,!0}var lU,cU,LT,NT=R(()=>{eh();lU=Array.prototype,cU=lU.splice;LT=uU});function dU(e){var t=this.__data__,n=Zo(t,e);return n<0?void 0:t[n][1]}var TT,kT=R(()=>{eh();TT=dU});function hU(e){return Zo(this.__data__,e)>-1}var RT,MT=R(()=>{eh();RT=hU});function fU(e,t){var n=this.__data__,s=Zo(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}var AT,OT=R(()=>{eh();AT=fU});function Rc(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}var Qo,th=R(()=>{IT();NT();kT();MT();OT();Rc.prototype.clear=CT;Rc.prototype.delete=LT;Rc.prototype.get=TT;Rc.prototype.has=RT;Rc.prototype.set=AT;Qo=Rc});var pU,Ko,Pg=R(()=>{Yo();Ys();pU=Bi(On,"Map"),Ko=pU});function gU(){this.size=0,this.__data__={hash:new Bv,map:new(Ko||Qo),string:new Bv}}var PT,FT=R(()=>{ET();th();Pg();PT=gU});function mU(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var DT,GT=R(()=>{DT=mU});function _U(e,t){var n=e.__data__;return DT(t)?n[typeof t=="string"?"string":"hash"]:n.map}var Jo,nh=R(()=>{GT();Jo=_U});function yU(e){var t=Jo(this,e).delete(e);return this.size-=t?1:0,t}var jT,qT=R(()=>{nh();jT=yU});function vU(e){return Jo(this,e).get(e)}var $T,BT=R(()=>{nh();$T=vU});function bU(e){return Jo(this,e).has(e)}var UT,zT=R(()=>{nh();UT=bU});function xU(e,t){var n=Jo(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}var VT,HT=R(()=>{nh();VT=xU});function Mc(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}var Fg,Uv=R(()=>{FT();qT();BT();zT();HT();Mc.prototype.clear=PT;Mc.prototype.delete=jT;Mc.prototype.get=$T;Mc.prototype.has=UT;Mc.prototype.set=VT;Fg=Mc});function wU(e,t){for(var n=-1,s=t.length,o=e.length;++n<s;)e[o+n]=t[n];return e}var Dg,zv=R(()=>{Dg=wU});var SU,Ac,Gg=R(()=>{$v();SU=Ag(Object.getPrototypeOf,Object),Ac=SU});function TU(e){if(!ni(e)||Xs(e)!=EU)return!1;var t=Ac(e);if(t===null)return!0;var n=LU.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&WT.call(n)==NU}var EU,CU,IU,WT,LU,NU,YT,XT=R(()=>{yc();Gg();Zr();EU="[object Object]",CU=Function.prototype,IU=Object.prototype,WT=CU.toString,LU=IU.hasOwnProperty,NU=WT.call(Object);YT=TU});function kU(){this.__data__=new Qo,this.size=0}var ZT,QT=R(()=>{th();ZT=kU});function RU(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var KT,JT=R(()=>{KT=RU});function MU(e){return this.__data__.get(e)}var ek,tk=R(()=>{ek=MU});function AU(e){return this.__data__.has(e)}var nk,ik=R(()=>{nk=AU});function PU(e,t){var n=this.__data__;if(n instanceof Qo){var s=n.__data__;if(!Ko||s.length<OU-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new Fg(s)}return n.set(e,t),this.size=n.size,this}var OU,sk,rk=R(()=>{th();Pg();Uv();OU=200;sk=PU});function Oc(e){var t=this.__data__=new Qo(e);this.size=t.size}var ea,jg=R(()=>{th();QT();JT();tk();ik();rk();Oc.prototype.clear=ZT;Oc.prototype.delete=KT;Oc.prototype.get=ek;Oc.prototype.has=nk;Oc.prototype.set=sk;ea=Oc});function FU(e,t){return e&&vr(t,Nc(t),e)}var ok,ak=R(()=>{Ec();Og();ok=FU});function DU(e,t){return e&&vr(t,br(t),e)}var lk,ck=R(()=>{Ec();Tc();lk=DU});function jU(e,t){if(t)return e.slice();var n=e.length,s=hk?hk(n):new e.constructor(n);return e.copy(s),s}var fk,uk,GU,dk,hk,qg,Vv=R(()=>{Ys();fk=typeof exports=="object"&&exports&&!exports.nodeType&&exports,uk=fk&&typeof module=="object"&&module&&!module.nodeType&&module,GU=uk&&uk.exports===fk,dk=GU?On.Buffer:void 0,hk=dk?dk.allocUnsafe:void 0;qg=jU});function qU(e,t){for(var n=-1,s=e==null?0:e.length,o=0,l=[];++n<s;){var a=e[n];t(a,n,e)&&(l[o++]=a)}return l}var pk,gk=R(()=>{pk=qU});function $U(){return[]}var $g,Hv=R(()=>{$g=$U});var BU,UU,mk,zU,Pc,Bg=R(()=>{gk();Hv();BU=Object.prototype,UU=BU.propertyIsEnumerable,mk=Object.getOwnPropertySymbols,zU=mk?function(e){return e==null?[]:(e=Object(e),pk(mk(e),function(t){return UU.call(e,t)}))}:$g,Pc=zU});function VU(e,t){return vr(e,Pc(e),t)}var _k,yk=R(()=>{Ec();Bg();_k=VU});var HU,WU,Ug,Wv=R(()=>{zv();Gg();Bg();Hv();HU=Object.getOwnPropertySymbols,WU=HU?function(e){for(var t=[];e;)Dg(t,Pc(e)),e=Ac(e);return t}:$g,Ug=WU});function YU(e,t){return vr(e,Ug(e),t)}var vk,bk=R(()=>{Ec();Wv();vk=YU});function XU(e,t,n){var s=t(e);return Ns(e)?s:Dg(s,n(e))}var zg,Yv=R(()=>{zv();vc();zg=XU});function ZU(e){return zg(e,Nc,Pc)}var ih,Xv=R(()=>{Yv();Bg();Og();ih=ZU});function QU(e){return zg(e,br,Ug)}var xk,wk=R(()=>{Yv();Wv();Tc();xk=QU});var KU,Vg,Sk=R(()=>{Yo();Ys();KU=Bi(On,"DataView"),Vg=KU});var JU,Hg,Ek=R(()=>{Yo();Ys();JU=Bi(On,"Promise"),Hg=JU});var ez,Wg,Ck=R(()=>{Yo();Ys();ez=Bi(On,"Set"),Wg=ez});var Ik,tz,Lk,Nk,Tk,kk,nz,iz,sz,rz,oz,nl,no,sh=R(()=>{Sk();Pg();Ek();Ck();wN();yc();Rv();Ik="[object Map]",tz="[object Object]",Lk="[object Promise]",Nk="[object Set]",Tk="[object WeakMap]",kk="[object DataView]",nz=Kr(Vg),iz=Kr(Ko),sz=Kr(Hg),rz=Kr(Wg),oz=Kr(wg),nl=Xs;(Vg&&nl(new Vg(new ArrayBuffer(1)))!=kk||Ko&&nl(new Ko)!=Ik||Hg&&nl(Hg.resolve())!=Lk||Wg&&nl(new Wg)!=Nk||wg&&nl(new wg)!=Tk)&&(nl=function(e){var t=Xs(e),n=t==tz?e.constructor:void 0,s=n?Kr(n):"";if(s)switch(s){case nz:return kk;case iz:return Ik;case sz:return Lk;case rz:return Nk;case oz:return Tk}return t});no=nl});function cz(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&lz.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var az,lz,Rk,Mk=R(()=>{az=Object.prototype,lz=az.hasOwnProperty;Rk=cz});var uz,Fc,Zv=R(()=>{Ys();uz=On.Uint8Array,Fc=uz});function dz(e){var t=new e.constructor(e.byteLength);return new Fc(t).set(new Fc(e)),t}var Dc,Yg=R(()=>{Zv();Dc=dz});function hz(e,t){var n=t?Dc(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Ak,Ok=R(()=>{Yg();Ak=hz});function pz(e){var t=new e.constructor(e.source,fz.exec(e));return t.lastIndex=e.lastIndex,t}var fz,Pk,Fk=R(()=>{fz=/\w*$/;Pk=pz});function gz(e){return Gk?Object(Gk.call(e)):{}}var Dk,Gk,jk,qk=R(()=>{Wd();Dk=Ls?Ls.prototype:void 0,Gk=Dk?Dk.valueOf:void 0;jk=gz});function mz(e,t){var n=t?Dc(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Xg,Qv=R(()=>{Yg();Xg=mz});function Fz(e,t,n){var s=e.constructor;switch(t){case Cz:return Dc(e);case _z:case yz:return new s(+e);case Iz:return Ak(e,n);case Lz:case Nz:case Tz:case kz:case Rz:case Mz:case Az:case Oz:case Pz:return Xg(e,n);case vz:return new s;case bz:case Sz:return new s(e);case xz:return Pk(e);case wz:return new s;case Ez:return jk(e)}}var _z,yz,vz,bz,xz,wz,Sz,Ez,Cz,Iz,Lz,Nz,Tz,kz,Rz,Mz,Az,Oz,Pz,$k,Bk=R(()=>{Yg();Ok();Fk();qk();Qv();_z="[object Boolean]",yz="[object Date]",vz="[object Map]",bz="[object Number]",xz="[object RegExp]",wz="[object Set]",Sz="[object String]",Ez="[object Symbol]",Cz="[object ArrayBuffer]",Iz="[object DataView]",Lz="[object Float32Array]",Nz="[object Float64Array]",Tz="[object Int8Array]",kz="[object Int16Array]",Rz="[object Int32Array]",Mz="[object Uint8Array]",Az="[object Uint8ClampedArray]",Oz="[object Uint16Array]",Pz="[object Uint32Array]";$k=Fz});function Dz(e){return typeof e.constructor=="function"&&!Cc(e)?EN(Ac(e)):{}}var Zg,Kv=R(()=>{CN();Gg();Ng();Zg=Dz});function jz(e){return ni(e)&&no(e)==Gz}var Gz,Uk,zk=R(()=>{sh();Zr();Gz="[object Map]";Uk=jz});var Vk,qz,Hk,Wk=R(()=>{zk();Tg();kg();Vk=eo&&eo.isMap,qz=Vk?Ic(Vk):Uk,Hk=qz});function Bz(e){return ni(e)&&no(e)==$z}var $z,Yk,Xk=R(()=>{sh();Zr();$z="[object Set]";Yk=Bz});var Zk,Uz,Qk,Kk=R(()=>{Xk();Tg();kg();Zk=eo&&eo.isSet,Uz=Zk?Ic(Zk):Yk,Qk=Uz});function Qg(e,t,n,s,o,l){var a,u=t&zz,h=t&Vz,p=t&Hz;if(n&&(a=o?n(e,s,o,l):n(e)),a!==void 0)return a;if(!ci(e))return e;var d=Ns(e);if(d){if(a=Rk(e),!u)return Sg(e,a)}else{var _=no(e),m=_==eR||_==Qz;if(Jr(e))return qg(e,u);if(_==tR||_==Jk||m&&!o){if(a=h||m?{}:Zg(e),!u)return h?vk(e,lk(a,e)):_k(e,ok(a,e))}else{if(!Zt[_])return o?e:{};a=$k(e,_,u)}}l||(l=new ea);var v=l.get(e);if(v)return v;l.set(e,a),Qk(e)?e.forEach(function(w){a.add(Qg(w,t,n,w,e,l))}):Hk(e)&&e.forEach(function(w,L){a.set(L,Qg(w,t,n,L,e,l))});var x=p?h?xk:ih:h?br:Nc,b=d?void 0:x(e);return FN(b||e,function(w,L){b&&(L=w,w=e[L]),Ig(a,L,Qg(w,t,n,L,e,l))}),a}var zz,Vz,Hz,Jk,Wz,Yz,Xz,Zz,eR,Qz,Kz,Jz,tR,eV,tV,nV,iV,sV,rV,oV,aV,lV,cV,uV,dV,hV,fV,pV,gV,Zt,nR,iR=R(()=>{jg();DN();Pv();ak();ck();Vv();Mv();yk();bk();Xv();wk();sh();Mk();Bk();Kv();vc();Qd();Wk();Qr();Kk();Og();Tc();zz=1,Vz=2,Hz=4,Jk="[object Arguments]",Wz="[object Array]",Yz="[object Boolean]",Xz="[object Date]",Zz="[object Error]",eR="[object Function]",Qz="[object GeneratorFunction]",Kz="[object Map]",Jz="[object Number]",tR="[object Object]",eV="[object RegExp]",tV="[object Set]",nV="[object String]",iV="[object Symbol]",sV="[object WeakMap]",rV="[object ArrayBuffer]",oV="[object DataView]",aV="[object Float32Array]",lV="[object Float64Array]",cV="[object Int8Array]",uV="[object Int16Array]",dV="[object Int32Array]",hV="[object Uint8Array]",fV="[object Uint8ClampedArray]",pV="[object Uint16Array]",gV="[object Uint32Array]",Zt={};Zt[Jk]=Zt[Wz]=Zt[rV]=Zt[oV]=Zt[Yz]=Zt[Xz]=Zt[aV]=Zt[lV]=Zt[cV]=Zt[uV]=Zt[dV]=Zt[Kz]=Zt[Jz]=Zt[tR]=Zt[eV]=Zt[tV]=Zt[nV]=Zt[iV]=Zt[hV]=Zt[fV]=Zt[pV]=Zt[gV]=!0;Zt[Zz]=Zt[eR]=Zt[sV]=!1;nR=Qg});function yV(e){return nR(e,mV|_V)}var mV,_V,xr,sR=R(()=>{iR();mV=1,_V=4;xr=yV});function bV(e){return this.__data__.set(e,vV),this}var vV,rR,oR=R(()=>{vV="__lodash_hash_undefined__";rR=bV});function xV(e){return this.__data__.has(e)}var aR,lR=R(()=>{aR=xV});function Kg(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Fg;++t<n;)this.add(e[t])}var cR,uR=R(()=>{Uv();oR();lR();Kg.prototype.add=Kg.prototype.push=rR;Kg.prototype.has=aR;cR=Kg});function wV(e,t){for(var n=-1,s=e==null?0:e.length;++n<s;)if(t(e[n],n,e))return!0;return!1}var dR,hR=R(()=>{dR=wV});function SV(e,t){return e.has(t)}var fR,pR=R(()=>{fR=SV});function IV(e,t,n,s,o,l){var a=n&EV,u=e.length,h=t.length;if(u!=h&&!(a&&h>u))return!1;var p=l.get(e),d=l.get(t);if(p&&d)return p==t&&d==e;var _=-1,m=!0,v=n&CV?new cR:void 0;for(l.set(e,t),l.set(t,e);++_<u;){var x=e[_],b=t[_];if(s)var w=a?s(b,x,_,t,e,l):s(x,b,_,e,t,l);if(w!==void 0){if(w)continue;m=!1;break}if(v){if(!dR(t,function(L,D){if(!fR(v,D)&&(x===L||o(x,L,n,s,l)))return v.push(D)})){m=!1;break}}else if(!(x===b||o(x,b,n,s,l))){m=!1;break}}return l.delete(e),l.delete(t),m}var EV,CV,Jg,Jv=R(()=>{uR();hR();pR();EV=1,CV=2;Jg=IV});function LV(e){var t=-1,n=Array(e.size);return e.forEach(function(s,o){n[++t]=[o,s]}),n}var gR,mR=R(()=>{gR=LV});function NV(e){var t=-1,n=Array(e.size);return e.forEach(function(s){n[++t]=s}),n}var _R,yR=R(()=>{_R=NV});function BV(e,t,n,s,o,l,a){switch(n){case $V:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case qV:return!(e.byteLength!=t.byteLength||!l(new Fc(e),new Fc(t)));case RV:case MV:case PV:return yr(+e,+t);case AV:return e.name==t.name&&e.message==t.message;case FV:case GV:return e==t+"";case OV:var u=gR;case DV:var h=s&TV;if(u||(u=_R),e.size!=t.size&&!h)return!1;var p=a.get(e);if(p)return p==t;s|=kV,a.set(e,t);var d=Jg(u(e),u(t),s,o,l,a);return a.delete(e),d;case jV:if(eb)return eb.call(e)==eb.call(t)}return!1}var TV,kV,RV,MV,AV,OV,PV,FV,DV,GV,jV,qV,$V,vR,eb,bR,xR=R(()=>{Wd();Zv();Sc();Jv();mR();yR();TV=1,kV=2,RV="[object Boolean]",MV="[object Date]",AV="[object Error]",OV="[object Map]",PV="[object Number]",FV="[object RegExp]",DV="[object Set]",GV="[object String]",jV="[object Symbol]",qV="[object ArrayBuffer]",$V="[object DataView]",vR=Ls?Ls.prototype:void 0,eb=vR?vR.valueOf:void 0;bR=BV});function HV(e,t,n,s,o,l){var a=n&UV,u=ih(e),h=u.length,p=ih(t),d=p.length;if(h!=d&&!a)return!1;for(var _=h;_--;){var m=u[_];if(!(a?m in t:VV.call(t,m)))return!1}var v=l.get(e),x=l.get(t);if(v&&x)return v==t&&x==e;var b=!0;l.set(e,t),l.set(t,e);for(var w=a;++_<h;){m=u[_];var L=e[m],D=t[m];if(s)var G=a?s(D,L,m,t,e,l):s(L,D,m,e,t,l);if(!(G===void 0?L===D||o(L,D,n,s,l):G)){b=!1;break}w||(w=m=="constructor")}if(b&&!w){var W=e.constructor,P=t.constructor;W!=P&&"constructor"in e&&"constructor"in t&&!(typeof W=="function"&&W instanceof W&&typeof P=="function"&&P instanceof P)&&(b=!1)}return l.delete(e),l.delete(t),b}var UV,zV,VV,wR,SR=R(()=>{Xv();UV=1,zV=Object.prototype,VV=zV.hasOwnProperty;wR=HV});function XV(e,t,n,s,o,l){var a=Ns(e),u=Ns(t),h=a?CR:no(e),p=u?CR:no(t);h=h==ER?em:h,p=p==ER?em:p;var d=h==em,_=p==em,m=h==p;if(m&&Jr(e)){if(!Jr(t))return!1;a=!0,d=!1}if(m&&!d)return l||(l=new ea),a||Lc(e)?Jg(e,t,n,s,o,l):bR(e,t,h,n,s,o,l);if(!(n&WV)){var v=d&&IR.call(e,"__wrapped__"),x=_&&IR.call(t,"__wrapped__");if(v||x){var b=v?e.value():e,w=x?t.value():t;return l||(l=new ea),o(b,w,n,s,l)}}return m?(l||(l=new ea),wR(e,t,n,s,o,l)):!1}var WV,ER,CR,em,YV,IR,LR,NR=R(()=>{jg();Jv();xR();SR();sh();vc();Qd();Rg();WV=1,ER="[object Arguments]",CR="[object Array]",em="[object Object]",YV=Object.prototype,IR=YV.hasOwnProperty;LR=XV});function TR(e,t,n,s,o){return e===t?!0:e==null||t==null||!ni(e)&&!ni(t)?e!==e&&t!==t:LR(e,t,n,s,TR,o)}var kR,RR=R(()=>{NR();Zr();kR=TR});function ZV(e){return function(t,n,s){for(var o=-1,l=Object(t),a=s(t),u=a.length;u--;){var h=a[e?u:++o];if(n(l[h],h,l)===!1)break}return t}}var MR,AR=R(()=>{MR=ZV});var QV,OR,PR=R(()=>{AR();QV=MR(),OR=QV});function KV(e,t,n){(n!==void 0&&!yr(e[t],n)||n===void 0&&!(t in e))&&wc(e,t,n)}var rh,tb=R(()=>{Cg();Sc();rh=KV});function JV(e){return ni(e)&&Xo(e)}var FR,DR=R(()=>{Xd();Zr();FR=JV});function eH(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var oh,nb=R(()=>{oh=eH});function tH(e){return vr(e,br(e))}var GR,jR=R(()=>{Ec();Tc();GR=tH});function nH(e,t,n,s,o,l,a){var u=oh(e,n),h=oh(t,n),p=a.get(h);if(p){rh(e,n,p);return}var d=l?l(u,h,n+"",e,t,a):void 0,_=d===void 0;if(_){var m=Ns(h),v=!m&&Jr(h),x=!m&&!v&&Lc(h);d=h,m||v||x?Ns(u)?d=u:FR(u)?d=Sg(u):v?(_=!1,d=qg(h,!0)):x?(_=!1,d=Xg(h,!0)):d=[]:YT(h)||Zd(h)?(d=u,Zd(u)?d=GR(u):(!ci(u)||bc(u))&&(d=Zg(h))):_=!1}_&&(a.set(h,d),o(d,h,s,l,a),a.delete(h)),rh(e,n,d)}var qR,$R=R(()=>{tb();Vv();Qv();Mv();Kv();Gv();vc();DR();Qd();bg();Qr();XT();Rg();nb();jR();qR=nH});function BR(e,t,n,s,o){e!==t&&OR(t,function(l,a){if(o||(o=new ea),ci(l))qR(e,t,a,n,BR,s,o);else{var u=s?s(oh(e,a),l,a+"",e,t,o):void 0;u===void 0&&(u=l),rh(e,a,u)}},br)}var UR,zR=R(()=>{jg();tb();PR();$R();Qr();Tc();nb();UR=BR});function iH(e,t){return kR(e,t)}var il,VR=R(()=>{RR();il=iH});var sH,Ui,HR=R(()=>{zR();HN();sH=VN(function(e,t,n){UR(e,t,n)}),Ui=sH});var ta=R(()=>{sR();VR();HR();});var zc={};qn(zc,{Attributor:()=>bi,AttributorStore:()=>ah,BlockBlot:()=>sl,ClassAttributor:()=>Pn,ContainerBlot:()=>Bc,EmbedBlot:()=>fn,InlineBlot:()=>tm,LeafBlot:()=>Fn,ParentBlot:()=>zi,Registry:()=>sa,Scope:()=>je,ScrollBlot:()=>lh,StyleAttributor:()=>Vi,TextBlot:()=>Uc});function WR(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter(n=>n.indexOf(`${t}-`)===0)}function ib(e){let t=e.split("-"),n=t.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("");return t[0]+n}function YR(e,t){let n=t.find(e);if(n)return n;try{return t.create(e)}catch{let s=t.create(je.INLINE);return Array.from(e.childNodes).forEach(o=>{s.domNode.appendChild(o)}),e.parentNode&&e.parentNode.replaceChild(s.domNode,e),s.attach(),s}}function aH(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(e[n]!==t[n])return!1;return!0}var je,bi,ia,XR,sa,rb,Pn,ob,Vi,ab,ah,ZR,QR,KR,rH,Fn,lb,JR,oH,zi,Gc,lH,tm,qc,cH,sl,ub,uH,Bc,db,fn,dH,hH,$c,fH,lh,hb,pH,Uc,zt=R(()=>{je=(e=>(e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY",e))(je||{}),bi=class{constructor(t,n,s={}){this.attrName=t,this.keyName=n;let o=je.TYPE&je.ATTRIBUTE;this.scope=s.scope!=null?s.scope&je.LEVEL|o:je.ATTRIBUTE,s.whitelist!=null&&(this.whitelist=s.whitelist)}static keys(t){return Array.from(t.attributes).map(n=>n.name)}add(t,n){return this.canAdd(t,n)?(t.setAttribute(this.keyName,n),!0):!1}canAdd(t,n){return this.whitelist==null?!0:typeof n=="string"?this.whitelist.indexOf(n.replace(/["']/g,""))>-1:this.whitelist.indexOf(n)>-1}remove(t){t.removeAttribute(this.keyName)}value(t){let n=t.getAttribute(this.keyName);return this.canAdd(t,n)&&n?n:""}},ia=class extends Error{constructor(t){t="[Parchment] "+t,super(t),this.message=t,this.name=this.constructor.name}},XR=class sb{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,n=!1){if(t==null)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(n){let s=null;try{s=t.parentNode}catch{return null}return this.find(s,n)}return null}create(t,n,s){let o=this.query(n);if(o==null)throw new ia(`Unable to create ${n} blot`);let l=o,a=n instanceof Node||n.nodeType===Node.TEXT_NODE?n:l.create(s),u=new l(t,a,s);return sb.blots.set(u.domNode,u),u}find(t,n=!1){return sb.find(t,n)}query(t,n=je.ANY){let s;return typeof t=="string"?s=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?s=this.types.text:typeof t=="number"?t&je.LEVEL&je.BLOCK?s=this.types.block:t&je.LEVEL&je.INLINE&&(s=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some(o=>(s=this.classes[o],!!s)),s=s||this.tags[t.tagName]),s==null?null:"scope"in s&&n&je.LEVEL&s.scope&&n&je.TYPE&s.scope?s:null}register(...t){return t.map(n=>{let s="blotName"in n,o="attrName"in n;if(!s&&!o)throw new ia("Invalid definition");if(s&&n.blotName==="abstract")throw new ia("Cannot register abstract class");let l=s?n.blotName:o?n.attrName:void 0;return this.types[l]=n,o?typeof n.keyName=="string"&&(this.attributes[n.keyName]=n):s&&(n.className&&(this.classes[n.className]=n),n.tagName&&(Array.isArray(n.tagName)?n.tagName=n.tagName.map(a=>a.toUpperCase()):n.tagName=n.tagName.toUpperCase(),(Array.isArray(n.tagName)?n.tagName:[n.tagName]).forEach(a=>{(this.tags[a]==null||n.className==null)&&(this.tags[a]=n)}))),n})}};XR.blots=new WeakMap;sa=XR;rb=class extends bi{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map(n=>n.split("-").slice(0,-1).join("-"))}add(t,n){return this.canAdd(t,n)?(this.remove(t),t.classList.add(`${this.keyName}-${n}`),!0):!1}remove(t){WR(t,this.keyName).forEach(n=>{t.classList.remove(n)}),t.classList.length===0&&t.removeAttribute("class")}value(t){let n=(WR(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,n)?n:""}},Pn=rb;ob=class extends bi{static keys(t){return(t.getAttribute("style")||"").split(";").map(n=>n.split(":")[0].trim())}add(t,n){return this.canAdd(t,n)?(t.style[ib(this.keyName)]=n,!0):!1}remove(t){t.style[ib(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){let n=t.style[ib(this.keyName)];return this.canAdd(t,n)?n:""}},Vi=ob,ab=class{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,n){n?t.add(this.domNode,n)&&(t.value(this.domNode)!=null?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};let t=sa.find(this.domNode);if(t==null)return;let n=bi.keys(this.domNode),s=Pn.keys(this.domNode),o=Vi.keys(this.domNode);n.concat(s).concat(o).forEach(l=>{let a=t.scroll.query(l,je.ATTRIBUTE);a instanceof bi&&(this.attributes[a.attrName]=a)})}copy(t){Object.keys(this.attributes).forEach(n=>{let s=this.attributes[n].value(this.domNode);t.format(n,s)})}move(t){this.copy(t),Object.keys(this.attributes).forEach(n=>{this.attributes[n].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((t,n)=>(t[n]=this.attributes[n].value(this.domNode),t),{})}},ah=ab,ZR=class{constructor(t,n){this.scroll=t,this.domNode=n,sa.blots.set(n,this),this.prev=null,this.next=null}static create(t){if(this.tagName==null)throw new ia("Blot definition missing tagName");let n,s;return Array.isArray(this.tagName)?(typeof t=="string"?(s=t.toUpperCase(),parseInt(s,10).toString()===s&&(s=parseInt(s,10))):typeof t=="number"&&(s=t),typeof s=="number"?n=document.createElement(this.tagName[s-1]):s&&this.tagName.indexOf(s)>-1?n=document.createElement(s):n=document.createElement(this.tagName[0])):n=document.createElement(this.tagName),this.className&&n.classList.add(this.className),n}get statics(){return this.constructor}attach(){}clone(){let t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){this.parent!=null&&this.parent.removeChild(this),sa.blots.delete(this.domNode)}deleteAt(t,n){this.isolate(t,n).remove()}formatAt(t,n,s,o){let l=this.isolate(t,n);if(this.scroll.query(s,je.BLOT)!=null&&o)l.wrap(s,o);else if(this.scroll.query(s,je.ATTRIBUTE)!=null){let a=this.scroll.create(this.statics.scope);l.wrap(a),a.format(s,o)}}insertAt(t,n,s){let o=s==null?this.scroll.create("text",n):this.scroll.create(n,s),l=this.split(t);this.parent.insertBefore(o,l||void 0)}isolate(t,n){let s=this.split(t);if(s==null)throw new Error("Attempt to isolate at end");return s.split(n),s}length(){return 1}offset(t=this.parent){return this.parent==null||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,n){let s=typeof t=="string"?this.scroll.create(t,n):t;return this.parent!=null&&(this.parent.insertBefore(s,this.next||void 0),this.remove()),s}split(t,n){return t===0?this:this.next}update(t,n){}wrap(t,n){let s=typeof t=="string"?this.scroll.create(t,n):t;if(this.parent!=null&&this.parent.insertBefore(s,this.next||void 0),typeof s.appendChild!="function")throw new ia(`Cannot wrap ${t}`);return s.appendChild(this),s}};ZR.blotName="abstract";QR=ZR,KR=class extends QR{static value(t){return!0}index(t,n){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(n,1):-1}position(t,n){let s=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(s+=1),[this.parent.domNode,s]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};KR.scope=je.INLINE_BLOT;rH=KR,Fn=rH,lb=class{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){let n=t.slice(1);this.append(...n)}}at(t){let n=this.iterator(),s=n();for(;s&&t>0;)t-=1,s=n();return s}contains(t){let n=this.iterator(),s=n();for(;s;){if(s===t)return!0;s=n()}return!1}indexOf(t){let n=this.iterator(),s=n(),o=0;for(;s;){if(s===t)return o;o+=1,s=n()}return-1}insertBefore(t,n){t!=null&&(this.remove(t),t.next=n,n!=null?(t.prev=n.prev,n.prev!=null&&(n.prev.next=t),n.prev=t,n===this.head&&(this.head=t)):this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let n=0,s=this.head;for(;s!=null;){if(s===t)return n;n+=s.length(),s=s.next}return-1}remove(t){this.contains(t)&&(t.prev!=null&&(t.prev.next=t.next),t.next!=null&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{let n=t;return t!=null&&(t=t.next),n}}find(t,n=!1){let s=this.iterator(),o=s();for(;o;){let l=o.length();if(t<l||n&&t===l&&(o.next==null||o.next.length()!==0))return[o,t];t-=l,o=s()}return[null,0]}forEach(t){let n=this.iterator(),s=n();for(;s;)t(s),s=n()}forEachAt(t,n,s){if(n<=0)return;let[o,l]=this.find(t),a=t-l,u=this.iterator(o),h=u();for(;h&&a<t+n;){let p=h.length();t>a?s(h,t-a,Math.min(n,a+p-t)):s(h,0,Math.min(p,t+n-a)),a+=p,h=u()}}map(t){return this.reduce((n,s)=>(n.push(t(s)),n),[])}reduce(t,n){let s=this.iterator(),o=s();for(;o;)n=t(n,o),o=s();return n}};JR=class na extends QR{constructor(t,n){super(t,n),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach(t=>{t.attach()})}attachUI(t){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=t,na.uiClass&&this.uiNode.classList.add(na.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new lb,Array.from(this.domNode.childNodes).filter(t=>t!==this.uiNode).reverse().forEach(t=>{try{let n=YR(t,this.scroll);this.insertBefore(n,this.children.head||void 0)}catch(n){if(n instanceof ia)return;throw n}})}deleteAt(t,n){if(t===0&&n===this.length())return this.remove();this.children.forEachAt(t,n,(s,o,l)=>{s.deleteAt(o,l)})}descendant(t,n=0){let[s,o]=this.children.find(n);return t.blotName==null&&t(s)||t.blotName!=null&&s instanceof t?[s,o]:s instanceof na?s.descendant(t,o):[null,-1]}descendants(t,n=0,s=Number.MAX_VALUE){let o=[],l=s;return this.children.forEachAt(n,s,(a,u,h)=>{(t.blotName==null&&t(a)||t.blotName!=null&&a instanceof t)&&o.push(a),a instanceof na&&(o=o.concat(a.descendants(t,u,l))),l-=h}),o}detach(){this.children.forEach(t=>{t.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(n=>{t||this.statics.allowedChildren.some(s=>n instanceof s)||(n.statics.scope===je.BLOCK_BLOT?(n.next!=null&&this.splitAfter(n),n.prev!=null&&this.splitAfter(n.prev),n.parent.unwrap(),t=!0):n instanceof na?n.unwrap():n.remove())})}formatAt(t,n,s,o){this.children.forEachAt(t,n,(l,a,u)=>{l.formatAt(a,u,s,o)})}insertAt(t,n,s){let[o,l]=this.children.find(t);if(o)o.insertAt(l,n,s);else{let a=s==null?this.scroll.create("text",n):this.scroll.create(n,s);this.appendChild(a)}}insertBefore(t,n){t.parent!=null&&t.parent.children.remove(t);let s=null;this.children.insertBefore(t,n||null),t.parent=this,n!=null&&(s=n.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==s)&&this.domNode.insertBefore(t.domNode,s),t.attach()}length(){return this.children.reduce((t,n)=>t+n.length(),0)}moveChildren(t,n){this.children.forEach(s=>{t.insertBefore(s,n)})}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){let n=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(n)}else this.remove()}path(t,n=!1){let[s,o]=this.children.find(t,n),l=[[this,t]];return s instanceof na?l.concat(s.path(o,n)):(s!=null&&l.push([s,o]),l)}removeChild(t){this.children.remove(t)}replaceWith(t,n){let s=typeof t=="string"?this.scroll.create(t,n):t;return s instanceof na&&this.moveChildren(s),super.replaceWith(s)}split(t,n=!1){if(!n){if(t===0)return this;if(t===this.length())return this.next}let s=this.clone();return this.parent&&this.parent.insertBefore(s,this.next||void 0),this.children.forEachAt(t,this.length(),(o,l,a)=>{let u=o.split(l,n);u!=null&&s.appendChild(u)}),s}splitAfter(t){let n=this.clone();for(;t.next!=null;)n.appendChild(t.next);return this.parent&&this.parent.insertBefore(n,this.next||void 0),n}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,n){let s=[],o=[];t.forEach(l=>{l.target===this.domNode&&l.type==="childList"&&(s.push(...l.addedNodes),o.push(...l.removedNodes))}),o.forEach(l=>{if(l.parentNode!=null&&l.tagName!=="IFRAME"&&document.body.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;let a=this.scroll.find(l);a!=null&&(a.domNode.parentNode==null||a.domNode.parentNode===this.domNode)&&a.detach()}),s.filter(l=>l.parentNode===this.domNode&&l!==this.uiNode).sort((l,a)=>l===a?0:l.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(l=>{let a=null;l.nextSibling!=null&&(a=this.scroll.find(l.nextSibling));let u=YR(l,this.scroll);(u.next!==a||u.next==null)&&(u.parent!=null&&u.parent.removeChild(this),this.insertBefore(u,a||void 0))}),this.enforceAllowedChildren()}};JR.uiClass="";oH=JR,zi=oH;Gc=class jc extends zi{static create(t){return super.create(t)}static formats(t,n){let s=n.query(jc.blotName);if(!(s!=null&&t.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,n){super(t,n),this.attributes=new ah(this.domNode)}format(t,n){if(t===this.statics.blotName&&!n)this.children.forEach(s=>{s instanceof jc||(s=s.wrap(jc.blotName,!0)),this.attributes.copy(s)}),this.unwrap();else{let s=this.scroll.query(t,je.INLINE);if(s==null)return;s instanceof bi?this.attributes.attribute(s,n):n&&(t!==this.statics.blotName||this.formats()[t]!==n)&&this.replaceWith(t,n)}}formats(){let t=this.attributes.values(),n=this.statics.formats(this.domNode,this.scroll);return n!=null&&(t[this.statics.blotName]=n),t}formatAt(t,n,s,o){this.formats()[s]!=null||this.scroll.query(s,je.ATTRIBUTE)?this.isolate(t,n).format(s,o):super.formatAt(t,n,s,o)}optimize(t){super.optimize(t);let n=this.formats();if(Object.keys(n).length===0)return this.unwrap();let s=this.next;s instanceof jc&&s.prev===this&&aH(n,s.formats())&&(s.moveChildren(this),s.remove())}replaceWith(t,n){let s=super.replaceWith(t,n);return this.attributes.copy(s),s}update(t,n){super.update(t,n),t.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}wrap(t,n){let s=super.wrap(t,n);return s instanceof jc&&this.attributes.move(s),s}};Gc.allowedChildren=[Gc,Fn],Gc.blotName="inline",Gc.scope=je.INLINE_BLOT,Gc.tagName="SPAN";lH=Gc,tm=lH,qc=class cb extends zi{static create(t){return super.create(t)}static formats(t,n){let s=n.query(cb.blotName);if(!(s!=null&&t.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,n){super(t,n),this.attributes=new ah(this.domNode)}format(t,n){let s=this.scroll.query(t,je.BLOCK);s!=null&&(s instanceof bi?this.attributes.attribute(s,n):t===this.statics.blotName&&!n?this.replaceWith(cb.blotName):n&&(t!==this.statics.blotName||this.formats()[t]!==n)&&this.replaceWith(t,n))}formats(){let t=this.attributes.values(),n=this.statics.formats(this.domNode,this.scroll);return n!=null&&(t[this.statics.blotName]=n),t}formatAt(t,n,s,o){this.scroll.query(s,je.BLOCK)!=null?this.format(s,o):super.formatAt(t,n,s,o)}insertAt(t,n,s){if(s==null||this.scroll.query(n,je.INLINE)!=null)super.insertAt(t,n,s);else{let o=this.split(t);if(o!=null){let l=this.scroll.create(n,s);o.parent.insertBefore(l,o)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(t,n){let s=super.replaceWith(t,n);return this.attributes.copy(s),s}update(t,n){super.update(t,n),t.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}};qc.blotName="block",qc.scope=je.BLOCK_BLOT,qc.tagName="P",qc.allowedChildren=[tm,qc,Fn];cH=qc,sl=cH,ub=class extends zi{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,n){super.deleteAt(t,n),this.enforceAllowedChildren()}formatAt(t,n,s,o){super.formatAt(t,n,s,o),this.enforceAllowedChildren()}insertAt(t,n,s){super.insertAt(t,n,s),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};ub.blotName="container",ub.scope=je.BLOCK_BLOT;uH=ub,Bc=uH,db=class extends Fn{static formats(t,n){}format(t,n){super.formatAt(0,this.length(),t,n)}formatAt(t,n,s,o){t===0&&n===this.length()?this.format(s,o):super.formatAt(t,n,s,o)}formats(){return this.statics.formats(this.domNode,this.scroll)}},fn=db,dH={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},hH=100,$c=class extends zi{constructor(t,n){super(null,n),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver(s=>{this.update(s)}),this.observer.observe(this.domNode,dH),this.attach()}create(t,n){return this.registry.create(this,t,n)}find(t,n=!1){let s=this.registry.find(t,n);return s?s.scroll===this?s:n?this.find(s.scroll.domNode.parentNode,!0):null:null}query(t,n=je.ANY){return this.registry.query(t,n)}register(...t){return this.registry.register(...t)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,n){this.update(),t===0&&n===this.length()?this.children.forEach(s=>{s.remove()}):super.deleteAt(t,n)}formatAt(t,n,s,o){this.update(),super.formatAt(t,n,s,o)}insertAt(t,n,s){this.update(),super.insertAt(t,n,s)}optimize(t=[],n={}){super.optimize(n);let s=n.mutationsMap||new WeakMap,o=Array.from(this.observer.takeRecords());for(;o.length>0;)t.push(o.pop());let l=(h,p=!0)=>{h==null||h===this||h.domNode.parentNode!=null&&(s.has(h.domNode)||s.set(h.domNode,[]),p&&l(h.parent))},a=h=>{s.has(h.domNode)&&(h instanceof zi&&h.children.forEach(a),s.delete(h.domNode),h.optimize(n))},u=t;for(let h=0;u.length>0;h+=1){if(h>=hH)throw new Error("[Parchment] Maximum optimize iterations reached");for(u.forEach(p=>{let d=this.find(p.target,!0);d!=null&&(d.domNode===p.target&&(p.type==="childList"?(l(this.find(p.previousSibling,!1)),Array.from(p.addedNodes).forEach(_=>{let m=this.find(_,!1);l(m,!1),m instanceof zi&&m.children.forEach(v=>{l(v,!1)})})):p.type==="attributes"&&l(d.prev)),l(d))}),this.children.forEach(a),u=Array.from(this.observer.takeRecords()),o=u.slice();o.length>0;)t.push(o.pop())}}update(t,n={}){t=t||this.observer.takeRecords();let s=new WeakMap;t.map(o=>{let l=this.find(o.target,!0);return l==null?null:s.has(l.domNode)?(s.get(l.domNode).push(o),null):(s.set(l.domNode,[o]),l)}).forEach(o=>{o!=null&&o!==this&&s.has(o.domNode)&&o.update(s.get(o.domNode)||[],n)}),n.mutationsMap=s,s.has(this.domNode)&&super.update(s.get(this.domNode),n),this.optimize(t,n)}};$c.blotName="scroll",$c.defaultChild=sl,$c.allowedChildren=[sl,Bc],$c.scope=je.BLOCK_BLOT,$c.tagName="DIV";fH=$c,lh=fH,hb=class e3 extends Fn{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,n){super(t,n),this.text=this.statics.value(this.domNode)}deleteAt(t,n){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+n)}index(t,n){return this.domNode===t?n:-1}insertAt(t,n,s){s==null?(this.text=this.text.slice(0,t)+n+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,n,s)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof e3&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,n=!1){return[this.domNode,t]}split(t,n=!1){if(!n){if(t===0)return this;if(t===this.length())return this.next}let s=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(s,this.next||void 0),this.text=this.statics.value(this.domNode),s}update(t,n){t.some(s=>s.type==="characterData"&&s.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};hb.blotName="text",hb.scope=je.INLINE_BLOT;pH=hb,Uc=pH});var d3=He((Hwe,u3)=>{var ds=-1,xi=1,zn=0;function ch(e,t,n,s,o){if(e===t)return e?[[zn,e]]:[];if(n!=null){var l=SH(e,t,n);if(l)return l}var a=pb(e,t),u=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=nm(e,t);var h=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var p=gH(e,t);return u&&p.unshift([zn,u]),h&&p.push([zn,h]),gb(p,o),s&&yH(p),p}function gH(e,t){var n;if(!e)return[[xi,t]];if(!t)return[[ds,e]];var s=e.length>t.length?e:t,o=e.length>t.length?t:e,l=s.indexOf(o);if(l!==-1)return n=[[xi,s.substring(0,l)],[zn,o],[xi,s.substring(l+o.length)]],e.length>t.length&&(n[0][0]=n[2][0]=ds),n;if(o.length===1)return[[ds,e],[xi,t]];var a=_H(e,t);if(a){var u=a[0],h=a[1],p=a[2],d=a[3],_=a[4],m=ch(u,p),v=ch(h,d);return m.concat([[zn,_]],v)}return mH(e,t)}function mH(e,t){for(var n=e.length,s=t.length,o=Math.ceil((n+s)/2),l=o,a=2*o,u=new Array(a),h=new Array(a),p=0;p<a;p++)u[p]=-1,h[p]=-1;u[l+1]=0,h[l+1]=0;for(var d=n-s,_=d%2!==0,m=0,v=0,x=0,b=0,w=0;w<o;w++){for(var L=-w+m;L<=w-v;L+=2){var D=l+L,G;L===-w||L!==w&&u[D-1]<u[D+1]?G=u[D+1]:G=u[D-1]+1;for(var W=G-L;G<n&&W<s&&e.charAt(G)===t.charAt(W);)G++,W++;if(u[D]=G,G>n)v+=2;else if(W>s)m+=2;else if(_){var P=l+d-L;if(P>=0&&P<a&&h[P]!==-1){var j=n-h[P];if(G>=j)return t3(e,t,G,W)}}}for(var V=-w+x;V<=w-b;V+=2){var P=l+V,j;V===-w||V!==w&&h[P-1]<h[P+1]?j=h[P+1]:j=h[P-1]+1;for(var H=j-V;j<n&&H<s&&e.charAt(n-j-1)===t.charAt(s-H-1);)j++,H++;if(h[P]=j,j>n)b+=2;else if(H>s)x+=2;else if(!_){var D=l+d-V;if(D>=0&&D<a&&u[D]!==-1){var G=u[D],W=l+G-D;if(j=n-j,G>=j)return t3(e,t,G,W)}}}}return[[ds,e],[xi,t]]}function t3(e,t,n,s){var o=e.substring(0,n),l=t.substring(0,s),a=e.substring(n),u=t.substring(s),h=ch(o,l),p=ch(a,u);return h.concat(p)}function pb(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,s=Math.min(e.length,t.length),o=s,l=0;n<o;)e.substring(l,o)==t.substring(l,o)?(n=o,l=n):s=o,o=Math.floor((s-n)/2+n);return o3(e.charCodeAt(o-1))&&o--,o}function n3(e,t){var n=e.length,s=t.length;if(n==0||s==0)return 0;n>s?e=e.substring(n-s):n<s&&(t=t.substring(0,n));var o=Math.min(n,s);if(e==t)return o;for(var l=0,a=1;;){var u=e.substring(o-a),h=t.indexOf(u);if(h==-1)return l;a+=h,(h==0||e.substring(o-a)==t.substring(0,a))&&(l=a,a++)}}function nm(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var n=0,s=Math.min(e.length,t.length),o=s,l=0;n<o;)e.substring(e.length-o,e.length-l)==t.substring(t.length-o,t.length-l)?(n=o,l=n):s=o,o=Math.floor((s-n)/2+n);return a3(e.charCodeAt(e.length-o))&&o--,o}function _H(e,t){var n=e.length>t.length?e:t,s=e.length>t.length?t:e;if(n.length<4||s.length*2<n.length)return null;function o(v,x,b){for(var w=v.substring(b,b+Math.floor(v.length/4)),L=-1,D="",G,W,P,j;(L=x.indexOf(w,L+1))!==-1;){var V=pb(v.substring(b),x.substring(L)),H=nm(v.substring(0,b),x.substring(0,L));D.length<H+V&&(D=x.substring(L-H,L)+x.substring(L,L+V),G=v.substring(0,b-H),W=v.substring(b+V),P=x.substring(0,L-H),j=x.substring(L+V))}return D.length*2>=v.length?[G,W,P,j,D]:null}var l=o(n,s,Math.ceil(n.length/4)),a=o(n,s,Math.ceil(n.length/2)),u;if(!l&&!a)return null;a?l?u=l[4].length>a[4].length?l:a:u=a:u=l;var h,p,d,_;e.length>t.length?(h=u[0],p=u[1],d=u[2],_=u[3]):(d=u[0],_=u[1],h=u[2],p=u[3]);var m=u[4];return[h,p,d,_,m]}function yH(e){for(var t=!1,n=[],s=0,o=null,l=0,a=0,u=0,h=0,p=0;l<e.length;)e[l][0]==zn?(n[s++]=l,a=h,u=p,h=0,p=0,o=e[l][1]):(e[l][0]==xi?h+=e[l][1].length:p+=e[l][1].length,o&&o.length<=Math.max(a,u)&&o.length<=Math.max(h,p)&&(e.splice(n[s-1],0,[ds,o]),e[n[s-1]+1][0]=xi,s--,s--,l=s>0?n[s-1]:-1,a=0,u=0,h=0,p=0,o=null,t=!0)),l++;for(t&&gb(e),xH(e),l=1;l<e.length;){if(e[l-1][0]==ds&&e[l][0]==xi){var d=e[l-1][1],_=e[l][1],m=n3(d,_),v=n3(_,d);m>=v?(m>=d.length/2||m>=_.length/2)&&(e.splice(l,0,[zn,_.substring(0,m)]),e[l-1][1]=d.substring(0,d.length-m),e[l+1][1]=_.substring(m),l++):(v>=d.length/2||v>=_.length/2)&&(e.splice(l,0,[zn,d.substring(0,v)]),e[l-1][0]=xi,e[l-1][1]=_.substring(0,_.length-v),e[l+1][0]=ds,e[l+1][1]=d.substring(v),l++),l++}l++}}var i3=/[^a-zA-Z0-9]/,s3=/\s/,r3=/[\r\n]/,vH=/\n\r?\n$/,bH=/^\r?\n\r?\n/;function xH(e){function t(v,x){if(!v||!x)return 6;var b=v.charAt(v.length-1),w=x.charAt(0),L=b.match(i3),D=w.match(i3),G=L&&b.match(s3),W=D&&w.match(s3),P=G&&b.match(r3),j=W&&w.match(r3),V=P&&v.match(vH),H=j&&x.match(bH);return V||H?5:P||j?4:L&&!G&&W?3:G||W?2:L||D?1:0}for(var n=1;n<e.length-1;){if(e[n-1][0]==zn&&e[n+1][0]==zn){var s=e[n-1][1],o=e[n][1],l=e[n+1][1],a=nm(s,o);if(a){var u=o.substring(o.length-a);s=s.substring(0,s.length-a),o=u+o.substring(0,o.length-a),l=u+l}for(var h=s,p=o,d=l,_=t(s,o)+t(o,l);o.charAt(0)===l.charAt(0);){s+=o.charAt(0),o=o.substring(1)+l.charAt(0),l=l.substring(1);var m=t(s,o)+t(o,l);m>=_&&(_=m,h=s,p=o,d=l)}e[n-1][1]!=h&&(h?e[n-1][1]=h:(e.splice(n-1,1),n--),e[n][1]=p,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}}function gb(e,t){e.push([zn,""]);for(var n=0,s=0,o=0,l="",a="",u;n<e.length;){if(n<e.length-1&&!e[n][1]){e.splice(n,1);continue}switch(e[n][0]){case xi:o++,a+=e[n][1],n++;break;case ds:s++,l+=e[n][1],n++;break;case zn:var h=n-o-s-1;if(t){if(h>=0&&c3(e[h][1])){var p=e[h][1].slice(-1);if(e[h][1]=e[h][1].slice(0,-1),l=p+l,a=p+a,!e[h][1]){e.splice(h,1),n--;var d=h-1;e[d]&&e[d][0]===xi&&(o++,a=e[d][1]+a,d--),e[d]&&e[d][0]===ds&&(s++,l=e[d][1]+l,d--),h=d}}if(l3(e[n][1])){var p=e[n][1].charAt(0);e[n][1]=e[n][1].slice(1),l+=p,a+=p}}if(n<e.length-1&&!e[n][1]){e.splice(n,1);break}if(l.length>0||a.length>0){l.length>0&&a.length>0&&(u=pb(a,l),u!==0&&(h>=0?e[h][1]+=a.substring(0,u):(e.splice(0,0,[zn,a.substring(0,u)]),n++),a=a.substring(u),l=l.substring(u)),u=nm(a,l),u!==0&&(e[n][1]=a.substring(a.length-u)+e[n][1],a=a.substring(0,a.length-u),l=l.substring(0,l.length-u)));var _=o+s;l.length===0&&a.length===0?(e.splice(n-_,_),n=n-_):l.length===0?(e.splice(n-_,_,[xi,a]),n=n-_+1):a.length===0?(e.splice(n-_,_,[ds,l]),n=n-_+1):(e.splice(n-_,_,[ds,l],[xi,a]),n=n-_+2)}n!==0&&e[n-1][0]===zn?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,o=0,s=0,l="",a="";break}}e[e.length-1][1]===""&&e.pop();var m=!1;for(n=1;n<e.length-1;)e[n-1][0]===zn&&e[n+1][0]===zn&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)===e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),m=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),m=!0)),n++;m&&gb(e,t)}function o3(e){return e>=55296&&e<=56319}function a3(e){return e>=56320&&e<=57343}function l3(e){return a3(e.charCodeAt(0))}function c3(e){return o3(e.charCodeAt(e.length-1))}function wH(e){for(var t=[],n=0;n<e.length;n++)e[n][1].length>0&&t.push(e[n]);return t}function fb(e,t,n,s){return c3(e)||l3(s)?null:wH([[zn,e],[ds,t],[xi,n],[zn,s]])}function SH(e,t,n){var s=typeof n=="number"?{index:n,length:0}:n.oldRange,o=typeof n=="number"?null:n.newRange,l=e.length,a=t.length;if(s.length===0&&(o===null||o.length===0)){var u=s.index,h=e.slice(0,u),p=e.slice(u),d=o?o.index:null;e:{var _=u+a-l;if(d!==null&&d!==_||_<0||_>a)break e;var m=t.slice(0,_),v=t.slice(_);if(v!==p)break e;var x=Math.min(u,_),b=h.slice(0,x),w=m.slice(0,x);if(b!==w)break e;var L=h.slice(x),D=m.slice(x);return fb(b,L,D,p)}e:{if(d!==null&&d!==u)break e;var G=u,m=t.slice(0,G),v=t.slice(G);if(m!==h)break e;var W=Math.min(l-G,a-G),P=p.slice(p.length-W),j=v.slice(v.length-W);if(P!==j)break e;var L=p.slice(0,p.length-W),D=v.slice(0,v.length-W);return fb(h,L,D,P)}}if(s.length>0&&o&&o.length===0)e:{var b=e.slice(0,s.index),P=e.slice(s.index+s.length),x=b.length,W=P.length;if(a<x+W)break e;var w=t.slice(0,x),j=t.slice(a-W);if(b!==w||P!==j)break e;var L=e.slice(x,l-W),D=t.slice(x,a-W);return fb(b,L,D,P)}return null}function im(e,t,n,s){return ch(e,t,n,s,!0)}im.INSERT=xi;im.DELETE=ds;im.EQUAL=zn;u3.exports=im});var Lb=He((uh,Hc)=>{var EH=200,Ib="__lodash_hash_undefined__",dm=1,S3=2,E3=9007199254740991,sm="[object Arguments]",vb="[object Array]",CH="[object AsyncFunction]",C3="[object Boolean]",I3="[object Date]",L3="[object Error]",N3="[object Function]",IH="[object GeneratorFunction]",rm="[object Map]",T3="[object Number]",LH="[object Null]",Vc="[object Object]",h3="[object Promise]",NH="[object Proxy]",k3="[object RegExp]",om="[object Set]",R3="[object String]",TH="[object Symbol]",kH="[object Undefined]",bb="[object WeakMap]",M3="[object ArrayBuffer]",am="[object DataView]",RH="[object Float32Array]",MH="[object Float64Array]",AH="[object Int8Array]",OH="[object Int16Array]",PH="[object Int32Array]",FH="[object Uint8Array]",DH="[object Uint8ClampedArray]",GH="[object Uint16Array]",jH="[object Uint32Array]",qH=/[\\^$.*+?()[\]{}|]/g,$H=/^\[object .+?Constructor\]$/,BH=/^(?:0|[1-9]\d*)$/,nn={};nn[RH]=nn[MH]=nn[AH]=nn[OH]=nn[PH]=nn[FH]=nn[DH]=nn[GH]=nn[jH]=!0;nn[sm]=nn[vb]=nn[M3]=nn[C3]=nn[am]=nn[I3]=nn[L3]=nn[N3]=nn[rm]=nn[T3]=nn[Vc]=nn[k3]=nn[om]=nn[R3]=nn[bb]=!1;var A3=typeof global=="object"&&global&&global.Object===Object&&global,UH=typeof self=="object"&&self&&self.Object===Object&&self,io=A3||UH||Function("return this")(),O3=typeof uh=="object"&&uh&&!uh.nodeType&&uh,f3=O3&&typeof Hc=="object"&&Hc&&!Hc.nodeType&&Hc,P3=f3&&f3.exports===O3,mb=P3&&A3.process,p3=function(){try{return mb&&mb.binding&&mb.binding("util")}catch{}}(),g3=p3&&p3.isTypedArray;function zH(e,t){for(var n=-1,s=e==null?0:e.length,o=0,l=[];++n<s;){var a=e[n];t(a,n,e)&&(l[o++]=a)}return l}function VH(e,t){for(var n=-1,s=t.length,o=e.length;++n<s;)e[o+n]=t[n];return e}function HH(e,t){for(var n=-1,s=e==null?0:e.length;++n<s;)if(t(e[n],n,e))return!0;return!1}function WH(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}function YH(e){return function(t){return e(t)}}function XH(e,t){return e.has(t)}function ZH(e,t){return e?.[t]}function QH(e){var t=-1,n=Array(e.size);return e.forEach(function(s,o){n[++t]=[o,s]}),n}function KH(e,t){return function(n){return e(t(n))}}function JH(e){var t=-1,n=Array(e.size);return e.forEach(function(s){n[++t]=s}),n}var eW=Array.prototype,tW=Function.prototype,hm=Object.prototype,_b=io["__core-js_shared__"],F3=tW.toString,wr=hm.hasOwnProperty,m3=function(){var e=/[^.]+$/.exec(_b&&_b.keys&&_b.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),D3=hm.toString,nW=RegExp("^"+F3.call(wr).replace(qH,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_3=P3?io.Buffer:void 0,lm=io.Symbol,y3=io.Uint8Array,G3=hm.propertyIsEnumerable,iW=eW.splice,rl=lm?lm.toStringTag:void 0,v3=Object.getOwnPropertySymbols,sW=_3?_3.isBuffer:void 0,rW=KH(Object.keys,Object),xb=Wc(io,"DataView"),dh=Wc(io,"Map"),wb=Wc(io,"Promise"),Sb=Wc(io,"Set"),Eb=Wc(io,"WeakMap"),hh=Wc(Object,"create"),oW=cl(xb),aW=cl(dh),lW=cl(wb),cW=cl(Sb),uW=cl(Eb),b3=lm?lm.prototype:void 0,yb=b3?b3.valueOf:void 0;function al(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function dW(){this.__data__=hh?hh(null):{},this.size=0}function hW(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function fW(e){var t=this.__data__;if(hh){var n=t[e];return n===Ib?void 0:n}return wr.call(t,e)?t[e]:void 0}function pW(e){var t=this.__data__;return hh?t[e]!==void 0:wr.call(t,e)}function gW(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=hh&&t===void 0?Ib:t,this}al.prototype.clear=dW;al.prototype.delete=hW;al.prototype.get=fW;al.prototype.has=pW;al.prototype.set=gW;function so(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function mW(){this.__data__=[],this.size=0}function _W(e){var t=this.__data__,n=fm(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():iW.call(t,n,1),--this.size,!0}function yW(e){var t=this.__data__,n=fm(t,e);return n<0?void 0:t[n][1]}function vW(e){return fm(this.__data__,e)>-1}function bW(e,t){var n=this.__data__,s=fm(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}so.prototype.clear=mW;so.prototype.delete=_W;so.prototype.get=yW;so.prototype.has=vW;so.prototype.set=bW;function ll(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function xW(){this.size=0,this.__data__={hash:new al,map:new(dh||so),string:new al}}function wW(e){var t=pm(this,e).delete(e);return this.size-=t?1:0,t}function SW(e){return pm(this,e).get(e)}function EW(e){return pm(this,e).has(e)}function CW(e,t){var n=pm(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}ll.prototype.clear=xW;ll.prototype.delete=wW;ll.prototype.get=SW;ll.prototype.has=EW;ll.prototype.set=CW;function cm(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new ll;++t<n;)this.add(e[t])}function IW(e){return this.__data__.set(e,Ib),this}function LW(e){return this.__data__.has(e)}cm.prototype.add=cm.prototype.push=IW;cm.prototype.has=LW;function oa(e){var t=this.__data__=new so(e);this.size=t.size}function NW(){this.__data__=new so,this.size=0}function TW(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function kW(e){return this.__data__.get(e)}function RW(e){return this.__data__.has(e)}function MW(e,t){var n=this.__data__;if(n instanceof so){var s=n.__data__;if(!dh||s.length<EH-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new ll(s)}return n.set(e,t),this.size=n.size,this}oa.prototype.clear=NW;oa.prototype.delete=TW;oa.prototype.get=kW;oa.prototype.has=RW;oa.prototype.set=MW;function AW(e,t){var n=um(e),s=!n&&YW(e),o=!n&&!s&&Cb(e),l=!n&&!s&&!o&&V3(e),a=n||s||o||l,u=a?WH(e.length,String):[],h=u.length;for(var p in e)(t||wr.call(e,p))&&!(a&&(p=="length"||o&&(p=="offset"||p=="parent")||l&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||UW(p,h)))&&u.push(p);return u}function fm(e,t){for(var n=e.length;n--;)if($3(e[n][0],t))return n;return-1}function OW(e,t,n){var s=t(e);return um(e)?s:VH(s,n(e))}function ph(e){return e==null?e===void 0?kH:LH:rl&&rl in Object(e)?$W(e):WW(e)}function x3(e){return fh(e)&&ph(e)==sm}function j3(e,t,n,s,o){return e===t?!0:e==null||t==null||!fh(e)&&!fh(t)?e!==e&&t!==t:PW(e,t,n,s,j3,o)}function PW(e,t,n,s,o,l){var a=um(e),u=um(t),h=a?vb:ra(e),p=u?vb:ra(t);h=h==sm?Vc:h,p=p==sm?Vc:p;var d=h==Vc,_=p==Vc,m=h==p;if(m&&Cb(e)){if(!Cb(t))return!1;a=!0,d=!1}if(m&&!d)return l||(l=new oa),a||V3(e)?q3(e,t,n,s,o,l):jW(e,t,h,n,s,o,l);if(!(n&dm)){var v=d&&wr.call(e,"__wrapped__"),x=_&&wr.call(t,"__wrapped__");if(v||x){var b=v?e.value():e,w=x?t.value():t;return l||(l=new oa),o(b,w,n,s,l)}}return m?(l||(l=new oa),qW(e,t,n,s,o,l)):!1}function FW(e){if(!z3(e)||VW(e))return!1;var t=B3(e)?nW:$H;return t.test(cl(e))}function DW(e){return fh(e)&&U3(e.length)&&!!nn[ph(e)]}function GW(e){if(!HW(e))return rW(e);var t=[];for(var n in Object(e))wr.call(e,n)&&n!="constructor"&&t.push(n);return t}function q3(e,t,n,s,o,l){var a=n&dm,u=e.length,h=t.length;if(u!=h&&!(a&&h>u))return!1;var p=l.get(e);if(p&&l.get(t))return p==t;var d=-1,_=!0,m=n&S3?new cm:void 0;for(l.set(e,t),l.set(t,e);++d<u;){var v=e[d],x=t[d];if(s)var b=a?s(x,v,d,t,e,l):s(v,x,d,e,t,l);if(b!==void 0){if(b)continue;_=!1;break}if(m){if(!HH(t,function(w,L){if(!XH(m,L)&&(v===w||o(v,w,n,s,l)))return m.push(L)})){_=!1;break}}else if(!(v===x||o(v,x,n,s,l))){_=!1;break}}return l.delete(e),l.delete(t),_}function jW(e,t,n,s,o,l,a){switch(n){case am:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case M3:return!(e.byteLength!=t.byteLength||!l(new y3(e),new y3(t)));case C3:case I3:case T3:return $3(+e,+t);case L3:return e.name==t.name&&e.message==t.message;case k3:case R3:return e==t+"";case rm:var u=QH;case om:var h=s&dm;if(u||(u=JH),e.size!=t.size&&!h)return!1;var p=a.get(e);if(p)return p==t;s|=S3,a.set(e,t);var d=q3(u(e),u(t),s,o,l,a);return a.delete(e),d;case TH:if(yb)return yb.call(e)==yb.call(t)}return!1}function qW(e,t,n,s,o,l){var a=n&dm,u=w3(e),h=u.length,p=w3(t),d=p.length;if(h!=d&&!a)return!1;for(var _=h;_--;){var m=u[_];if(!(a?m in t:wr.call(t,m)))return!1}var v=l.get(e);if(v&&l.get(t))return v==t;var x=!0;l.set(e,t),l.set(t,e);for(var b=a;++_<h;){m=u[_];var w=e[m],L=t[m];if(s)var D=a?s(L,w,m,t,e,l):s(w,L,m,e,t,l);if(!(D===void 0?w===L||o(w,L,n,s,l):D)){x=!1;break}b||(b=m=="constructor")}if(x&&!b){var G=e.constructor,W=t.constructor;G!=W&&"constructor"in e&&"constructor"in t&&!(typeof G=="function"&&G instanceof G&&typeof W=="function"&&W instanceof W)&&(x=!1)}return l.delete(e),l.delete(t),x}function w3(e){return OW(e,QW,BW)}function pm(e,t){var n=e.__data__;return zW(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Wc(e,t){var n=ZH(e,t);return FW(n)?n:void 0}function $W(e){var t=wr.call(e,rl),n=e[rl];try{e[rl]=void 0;var s=!0}catch{}var o=D3.call(e);return s&&(t?e[rl]=n:delete e[rl]),o}var BW=v3?function(e){return e==null?[]:(e=Object(e),zH(v3(e),function(t){return G3.call(e,t)}))}:KW,ra=ph;(xb&&ra(new xb(new ArrayBuffer(1)))!=am||dh&&ra(new dh)!=rm||wb&&ra(wb.resolve())!=h3||Sb&&ra(new Sb)!=om||Eb&&ra(new Eb)!=bb)&&(ra=function(e){var t=ph(e),n=t==Vc?e.constructor:void 0,s=n?cl(n):"";if(s)switch(s){case oW:return am;case aW:return rm;case lW:return h3;case cW:return om;case uW:return bb}return t});function UW(e,t){return t=t??E3,!!t&&(typeof e=="number"||BH.test(e))&&e>-1&&e%1==0&&e<t}function zW(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function VW(e){return!!m3&&m3 in e}function HW(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||hm;return e===n}function WW(e){return D3.call(e)}function cl(e){if(e!=null){try{return F3.call(e)}catch{}try{return e+""}catch{}}return""}function $3(e,t){return e===t||e!==e&&t!==t}var YW=x3(function(){return arguments}())?x3:function(e){return fh(e)&&wr.call(e,"callee")&&!G3.call(e,"callee")},um=Array.isArray;function XW(e){return e!=null&&U3(e.length)&&!B3(e)}var Cb=sW||JW;function ZW(e,t){return j3(e,t)}function B3(e){if(!z3(e))return!1;var t=ph(e);return t==N3||t==IH||t==CH||t==NH}function U3(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=E3}function z3(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function fh(e){return e!=null&&typeof e=="object"}var V3=g3?YH(g3):DW;function QW(e){return XW(e)?AW(e):GW(e)}function KW(){return[]}function JW(){return!1}Hc.exports=ZW});var H3=He(Tb=>{"use strict";Object.defineProperty(Tb,"__esModule",{value:!0});var eY=Qa(),tY=Lb(),Nb;(function(e){function t(l={},a={},u=!1){typeof l!="object"&&(l={}),typeof a!="object"&&(a={});let h=eY(a);u||(h=Object.keys(h).reduce((p,d)=>(h[d]!=null&&(p[d]=h[d]),p),{}));for(let p in l)l[p]!==void 0&&a[p]===void 0&&(h[p]=l[p]);return Object.keys(h).length>0?h:void 0}e.compose=t;function n(l={},a={}){typeof l!="object"&&(l={}),typeof a!="object"&&(a={});let u=Object.keys(l).concat(Object.keys(a)).reduce((h,p)=>(tY(l[p],a[p])||(h[p]=a[p]===void 0?null:a[p]),h),{});return Object.keys(u).length>0?u:void 0}e.diff=n;function s(l={},a={}){l=l||{};let u=Object.keys(a).reduce((h,p)=>(a[p]!==l[p]&&l[p]!==void 0&&(h[p]=a[p]),h),{});return Object.keys(l).reduce((h,p)=>(l[p]!==a[p]&&a[p]===void 0&&(h[p]=null),h),u)}e.invert=s;function o(l,a,u=!1){if(typeof l!="object")return a;if(typeof a!="object")return;if(!u)return a;let h=Object.keys(a).reduce((p,d)=>(l[d]===void 0&&(p[d]=a[d]),p),{});return Object.keys(h).length>0?h:void 0}e.transform=o})(Nb||(Nb={}));Tb.default=Nb});var Mb=He(Rb=>{"use strict";Object.defineProperty(Rb,"__esModule",{value:!0});var kb;(function(e){function t(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}e.length=t})(kb||(kb={}));Rb.default=kb});var Y3=He(Ob=>{"use strict";Object.defineProperty(Ob,"__esModule",{value:!0});var W3=Mb(),Ab=class{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);let n=this.ops[this.index];if(n){let s=this.offset,o=W3.default.length(n);if(t>=o-s?(t=o-s,this.index+=1,this.offset=0):this.offset+=t,typeof n.delete=="number")return{delete:t};{let l={};return n.attributes&&(l.attributes=n.attributes),typeof n.retain=="number"?l.retain=t:typeof n.retain=="object"&&n.retain!==null?l.retain=n.retain:typeof n.insert=="string"?l.insert=n.insert.substr(s,t):l.insert=n.insert,l}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?W3.default.length(this.ops[this.index])-this.offset:1/0}peekType(){let t=this.ops[this.index];return t?typeof t.delete=="number"?"delete":typeof t.retain=="number"||typeof t.retain=="object"&&t.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{let t=this.offset,n=this.index,s=this.next(),o=this.ops.slice(this.index);return this.offset=t,this.index=n,[s].concat(o)}}else return[]}};Ob.default=Ab});var hs=He((oo,mm)=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.AttributeMap=oo.OpIterator=oo.Op=void 0;var gm=d3(),nY=Qa(),Pb=Lb(),ul=H3();oo.AttributeMap=ul.default;var ro=Mb();oo.Op=ro.default;var Ts=Y3();oo.OpIterator=Ts.default;var iY="\0",X3=(e,t)=>{if(typeof e!="object"||e===null)throw new Error(`cannot retain a ${typeof e}`);if(typeof t!="object"||t===null)throw new Error(`cannot retain a ${typeof t}`);let n=Object.keys(e)[0];if(!n||n!==Object.keys(t)[0])throw new Error(`embed types not matched: ${n} != ${Object.keys(t)[0]}`);return[n,e[n],t[n]]},ao=class e{constructor(t){Array.isArray(t)?this.ops=t:t!=null&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]}static registerEmbed(t,n){this.handlers[t]=n}static unregisterEmbed(t){delete this.handlers[t]}static getHandler(t){let n=this.handlers[t];if(!n)throw new Error(`no handlers for embed type "${t}"`);return n}insert(t,n){let s={};return typeof t=="string"&&t.length===0?this:(s.insert=t,n!=null&&typeof n=="object"&&Object.keys(n).length>0&&(s.attributes=n),this.push(s))}delete(t){return t<=0?this:this.push({delete:t})}retain(t,n){if(typeof t=="number"&&t<=0)return this;let s={retain:t};return n!=null&&typeof n=="object"&&Object.keys(n).length>0&&(s.attributes=n),this.push(s)}push(t){let n=this.ops.length,s=this.ops[n-1];if(t=nY(t),typeof s=="object"){if(typeof t.delete=="number"&&typeof s.delete=="number")return this.ops[n-1]={delete:s.delete+t.delete},this;if(typeof s.delete=="number"&&t.insert!=null&&(n-=1,s=this.ops[n-1],typeof s!="object"))return this.ops.unshift(t),this;if(Pb(t.attributes,s.attributes)){if(typeof t.insert=="string"&&typeof s.insert=="string")return this.ops[n-1]={insert:s.insert+t.insert},typeof t.attributes=="object"&&(this.ops[n-1].attributes=t.attributes),this;if(typeof t.retain=="number"&&typeof s.retain=="number")return this.ops[n-1]={retain:s.retain+t.retain},typeof t.attributes=="object"&&(this.ops[n-1].attributes=t.attributes),this}}return n===this.ops.length?this.ops.push(t):this.ops.splice(n,0,t),this}chop(){let t=this.ops[this.ops.length-1];return t&&typeof t.retain=="number"&&!t.attributes&&this.ops.pop(),this}filter(t){return this.ops.filter(t)}forEach(t){this.ops.forEach(t)}map(t){return this.ops.map(t)}partition(t){let n=[],s=[];return this.forEach(o=>{(t(o)?n:s).push(o)}),[n,s]}reduce(t,n){return this.ops.reduce(t,n)}changeLength(){return this.reduce((t,n)=>n.insert?t+ro.default.length(n):n.delete?t-n.delete:t,0)}length(){return this.reduce((t,n)=>t+ro.default.length(n),0)}slice(t=0,n=1/0){let s=[],o=new Ts.default(this.ops),l=0;for(;l<n&&o.hasNext();){let a;l<t?a=o.next(t-l):(a=o.next(n-l),s.push(a)),l+=ro.default.length(a)}return new e(s)}compose(t){let n=new Ts.default(this.ops),s=new Ts.default(t.ops),o=[],l=s.peek();if(l!=null&&typeof l.retain=="number"&&l.attributes==null){let u=l.retain;for(;n.peekType()==="insert"&&n.peekLength()<=u;)u-=n.peekLength(),o.push(n.next());l.retain-u>0&&s.next(l.retain-u)}let a=new e(o);for(;n.hasNext()||s.hasNext();)if(s.peekType()==="insert")a.push(s.next());else if(n.peekType()==="delete")a.push(n.next());else{let u=Math.min(n.peekLength(),s.peekLength()),h=n.next(u),p=s.next(u);if(p.retain){let d={};if(typeof h.retain=="number")d.retain=typeof p.retain=="number"?u:p.retain;else if(typeof p.retain=="number")h.retain==null?d.insert=h.insert:d.retain=h.retain;else{let m=h.retain==null?"insert":"retain",[v,x,b]=X3(h[m],p.retain),w=e.getHandler(v);d[m]={[v]:w.compose(x,b,m==="retain")}}let _=ul.default.compose(h.attributes,p.attributes,typeof h.retain=="number");if(_&&(d.attributes=_),a.push(d),!s.hasNext()&&Pb(a.ops[a.ops.length-1],d)){let m=new e(n.rest());return a.concat(m).chop()}}else typeof p.delete=="number"&&(typeof h.retain=="number"||typeof h.retain=="object"&&h.retain!==null)&&a.push(p)}return a.chop()}concat(t){let n=new e(this.ops.slice());return t.ops.length>0&&(n.push(t.ops[0]),n.ops=n.ops.concat(t.ops.slice(1))),n}diff(t,n){if(this.ops===t.ops)return new e;let s=[this,t].map(h=>h.map(p=>{if(p.insert!=null)return typeof p.insert=="string"?p.insert:iY;let d=h===t?"on":"with";throw new Error("diff() called "+d+" non-document")}).join("")),o=new e,l=gm(s[0],s[1],n,!0),a=new Ts.default(this.ops),u=new Ts.default(t.ops);return l.forEach(h=>{let p=h[1].length;for(;p>0;){let d=0;switch(h[0]){case gm.INSERT:d=Math.min(u.peekLength(),p),o.push(u.next(d));break;case gm.DELETE:d=Math.min(p,a.peekLength()),a.next(d),o.delete(d);break;case gm.EQUAL:d=Math.min(a.peekLength(),u.peekLength(),p);let _=a.next(d),m=u.next(d);Pb(_.insert,m.insert)?o.retain(d,ul.default.diff(_.attributes,m.attributes)):o.push(m).delete(d);break}p-=d}}),o.chop()}eachLine(t,n=`
`){let s=new Ts.default(this.ops),o=new e,l=0;for(;s.hasNext();){if(s.peekType()!=="insert")return;let a=s.peek(),u=ro.default.length(a)-s.peekLength(),h=typeof a.insert=="string"?a.insert.indexOf(n,u)-u:-1;if(h<0)o.push(s.next());else if(h>0)o.push(s.next(h));else{if(t(o,s.next(1).attributes||{},l)===!1)return;l+=1,o=new e}}o.length()>0&&t(o,{},l)}invert(t){let n=new e;return this.reduce((s,o)=>{if(o.insert)n.delete(ro.default.length(o));else{if(typeof o.retain=="number"&&o.attributes==null)return n.retain(o.retain),s+o.retain;if(o.delete||typeof o.retain=="number"){let l=o.delete||o.retain;return t.slice(s,s+l).forEach(u=>{o.delete?n.push(u):o.retain&&o.attributes&&n.retain(ro.default.length(u),ul.default.invert(o.attributes,u.attributes))}),s+l}else if(typeof o.retain=="object"&&o.retain!==null){let l=t.slice(s,s+1),a=new Ts.default(l.ops).next(),[u,h,p]=X3(o.retain,a.insert),d=e.getHandler(u);return n.retain({[u]:d.invert(h,p)},ul.default.invert(o.attributes,a.attributes)),s+1}}return s},0),n.chop()}transform(t,n=!1){if(n=!!n,typeof t=="number")return this.transformPosition(t,n);let s=t,o=new Ts.default(this.ops),l=new Ts.default(s.ops),a=new e;for(;o.hasNext()||l.hasNext();)if(o.peekType()==="insert"&&(n||l.peekType()!=="insert"))a.retain(ro.default.length(o.next()));else if(l.peekType()==="insert")a.push(l.next());else{let u=Math.min(o.peekLength(),l.peekLength()),h=o.next(u),p=l.next(u);if(h.delete)continue;if(p.delete)a.push(p);else{let d=h.retain,_=p.retain,m=typeof _=="object"&&_!==null?_:u;if(typeof d=="object"&&d!==null&&typeof _=="object"&&_!==null){let v=Object.keys(d)[0];if(v===Object.keys(_)[0]){let x=e.getHandler(v);x&&(m={[v]:x.transform(d[v],_[v],n)})}}a.retain(m,ul.default.transform(h.attributes,p.attributes,n))}}return a.chop()}transformPosition(t,n=!1){n=!!n;let s=new Ts.default(this.ops),o=0;for(;s.hasNext()&&o<=t;){let l=s.peekLength(),a=s.peekType();if(s.next(),a==="delete"){t-=Math.min(l,t-o);continue}else a==="insert"&&(o<t||!n)&&(t+=l);o+=l}return t}};ao.Op=ro.default;ao.OpIterator=Ts.default;ao.AttributeMap=ul.default;ao.handlers={};oo.default=ao;typeof mm=="object"&&(mm.exports=ao,mm.exports.default=ao)});var gh,ui,aa=R(()=>{zt();gh=class extends fn{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}};gh.blotName="break";gh.tagName="BR";ui=gh});function dl(e){return e.replace(/[&<>"']/g,t=>sY[t])}var Ln,sY,lo=R(()=>{zt();Ln=class extends Uc{},sY={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}});var Fb,di,co=R(()=>{zt();aa();lo();Fb=class e extends tm{static allowedChildren=[e,ui,fn,Ln];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(t,n){let s=e.order.indexOf(t),o=e.order.indexOf(n);return s>=0||o>=0?s-o:t===n?0:t<n?-1:1}formatAt(t,n,s,o){if(e.compare(this.statics.blotName,s)<0&&this.scroll.query(s,je.BLOT)){let l=this.isolate(t,n);o&&l.wrap(s,o)}else super.formatAt(t,n,s,o)}optimize(t){if(super.optimize(t),this.parent instanceof e&&e.compare(this.statics.blotName,this.parent.statics.blotName)>0){let n=this.parent.isolate(this.offset(),this.length());this.moveChildren(n),n.wrap(this)}}},di=Fb});function Gb(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return e.descendants(Fn).reduce((n,s)=>s.length()===0?n:n.insert(s.value(),Hi(s,{},t)),new Db.default).insert(`
`,Hi(e))}function Hi(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return e==null||("formats"in e&&typeof e.formats=="function"&&(t={...t,...e.formats()},n&&delete t["code-token"]),e.parent==null||e.parent.statics.blotName==="scroll"||e.parent.statics.scope!==e.statics.scope)?t:Hi(e.parent,t,n)}var Db,Z3,Vt,Vn,ks=R(()=>{zt();Db=Ut(hs(),1);aa();co();lo();Z3=1,Vt=class extends sl{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Gb(this)),this.cache.delta}deleteAt(t,n){super.deleteAt(t,n),this.cache={}}formatAt(t,n,s,o){n<=0||(this.scroll.query(s,je.BLOCK)?t+n===this.length()&&this.format(s,o):super.formatAt(t,Math.min(n,this.length()-t-1),s,o),this.cache={})}insertAt(t,n,s){if(s!=null){super.insertAt(t,n,s),this.cache={};return}if(n.length===0)return;let o=n.split(`
`),l=o.shift();l.length>0&&(t<this.length()-1||this.children.tail==null?super.insertAt(Math.min(t,this.length()-1),l):this.children.tail.insertAt(this.children.tail.length(),l),this.cache={});let a=this;o.reduce((u,h)=>(a=a.split(u,!0),a.insertAt(0,h),h.length),t+l.length)}insertBefore(t,n){let{head:s}=this.children;super.insertBefore(t,n),s instanceof ui&&s.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Z3),this.cache.length}moveChildren(t,n){super.moveChildren(t,n),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n&&(t===0||t>=this.length()-Z3)){let o=this.clone();return t===0?(this.parent.insertBefore(o,this),this):(this.parent.insertBefore(o,this.next),o)}let s=super.split(t,n);return this.cache={},s}};Vt.blotName="block";Vt.tagName="P";Vt.defaultChild=ui;Vt.allowedChildren=[ui,di,fn,Ln];Vn=class extends fn{attach(){super.attach(),this.attributes=new ah(this.domNode)}delta(){return new Db.default().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,n){let s=this.scroll.query(t,je.BLOCK_ATTRIBUTE);s!=null&&this.attributes.attribute(s,n)}formatAt(t,n,s,o){this.format(s,o)}insertAt(t,n,s){if(s!=null){super.insertAt(t,n,s);return}let o=n.split(`
`),l=o.pop(),a=o.map(h=>{let p=this.scroll.create(Vt.blotName);return p.insertAt(0,h),p}),u=this.split(t);a.forEach(h=>{this.parent.insertBefore(h,u)}),l&&this.parent.insertBefore(this.scroll.create("text",l),u)}};Vn.scope=je.BLOCK_BLOT});var jb,la,mh=R(()=>{zt();lo();jb=class e extends fn{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(t,n,s){super(t,n),this.selection=s,this.textNode=document.createTextNode(e.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(t,n){if(this.savedLength!==0){super.format(t,n);return}let s=this,o=0;for(;s!=null&&s.statics.scope!==je.BLOCK_BLOT;)o+=s.offset(s.parent),s=s.parent;s!=null&&(this.savedLength=e.CONTENTS.length,s.optimize(),s.formatAt(o,e.CONTENTS.length,t,n),this.savedLength=0)}index(t,n){return t===this.textNode?0:super.index(t,n)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;let t=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);let n=this.prev instanceof Ln?this.prev:null,s=n?n.length():0,o=this.next instanceof Ln?this.next:null,l=o?o.text:"",{textNode:a}=this,u=a.data.split(e.CONTENTS).join("");a.data=e.CONTENTS;let h;if(n)h=n,(u||o)&&(n.insertAt(n.length(),u+l),o&&o.remove());else if(o)h=o,o.insertAt(0,u);else{let p=document.createTextNode(u);h=this.scroll.create(p),this.parent.insertBefore(h,this)}if(this.remove(),t){let p=(m,v)=>n&&m===n.domNode?v:m===a?s+v-1:o&&m===o.domNode?s+u.length+v:null,d=p(t.start.node,t.start.offset),_=p(t.end.node,t.end.offset);if(d!==null&&_!==null)return{startNode:h.domNode,startOffset:d,endNode:h.domNode,endOffset:_}}return null}update(t,n){if(t.some(s=>s.type==="characterData"&&s.target===this.textNode)){let s=this.restore();s&&(n.range=s)}}optimize(t){super.optimize(t);let{parent:n}=this;for(;n;){if(n.domNode.tagName==="A"){this.savedLength=e.CONTENTS.length,n.isolate(this.offset(n),this.length()).unwrap(),this.savedLength=0;break}n=n.parent}}value(){return""}},la=jb});var K3=He((hSe,qb)=>{"use strict";var rY=Object.prototype.hasOwnProperty,wi="~";function _h(){}Object.create&&(_h.prototype=Object.create(null),new _h().__proto__||(wi=!1));function oY(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function Q3(e,t,n,s,o){if(typeof n!="function")throw new TypeError("The listener must be a function");var l=new oY(n,s||e,o),a=wi?wi+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],l]:e._events[a].push(l):(e._events[a]=l,e._eventsCount++),e}function _m(e,t){--e._eventsCount===0?e._events=new _h:delete e._events[t]}function hi(){this._events=new _h,this._eventsCount=0}hi.prototype.eventNames=function(){var t=[],n,s;if(this._eventsCount===0)return t;for(s in n=this._events)rY.call(n,s)&&t.push(wi?s.slice(1):s);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(n)):t};hi.prototype.listeners=function(t){var n=wi?wi+t:t,s=this._events[n];if(!s)return[];if(s.fn)return[s.fn];for(var o=0,l=s.length,a=new Array(l);o<l;o++)a[o]=s[o].fn;return a};hi.prototype.listenerCount=function(t){var n=wi?wi+t:t,s=this._events[n];return s?s.fn?1:s.length:0};hi.prototype.emit=function(t,n,s,o,l,a){var u=wi?wi+t:t;if(!this._events[u])return!1;var h=this._events[u],p=arguments.length,d,_;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,n),!0;case 3:return h.fn.call(h.context,n,s),!0;case 4:return h.fn.call(h.context,n,s,o),!0;case 5:return h.fn.call(h.context,n,s,o,l),!0;case 6:return h.fn.call(h.context,n,s,o,l,a),!0}for(_=1,d=new Array(p-1);_<p;_++)d[_-1]=arguments[_];h.fn.apply(h.context,d)}else{var m=h.length,v;for(_=0;_<m;_++)switch(h[_].once&&this.removeListener(t,h[_].fn,void 0,!0),p){case 1:h[_].fn.call(h[_].context);break;case 2:h[_].fn.call(h[_].context,n);break;case 3:h[_].fn.call(h[_].context,n,s);break;case 4:h[_].fn.call(h[_].context,n,s,o);break;default:if(!d)for(v=1,d=new Array(p-1);v<p;v++)d[v-1]=arguments[v];h[_].fn.apply(h[_].context,d)}}return!0};hi.prototype.on=function(t,n,s){return Q3(this,t,n,s,!1)};hi.prototype.once=function(t,n,s){return Q3(this,t,n,s,!0)};hi.prototype.removeListener=function(t,n,s,o){var l=wi?wi+t:t;if(!this._events[l])return this;if(!n)return _m(this,l),this;var a=this._events[l];if(a.fn)a.fn===n&&(!o||a.once)&&(!s||a.context===s)&&_m(this,l);else{for(var u=0,h=[],p=a.length;u<p;u++)(a[u].fn!==n||o&&!a[u].once||s&&a[u].context!==s)&&h.push(a[u]);h.length?this._events[l]=h.length===1?h[0]:h:_m(this,l)}return this};hi.prototype.removeAllListeners=function(t){var n;return t?(n=wi?wi+t:t,this._events[n]&&_m(this,n)):(this._events=new _h,this._eventsCount=0),this};hi.prototype.off=hi.prototype.removeListener;hi.prototype.addListener=hi.prototype.on;hi.prefixed=wi;hi.EventEmitter=hi;typeof qb<"u"&&(qb.exports=hi)});var $b,J3=R(()=>{$b=Ut(K3(),1)});var yh,Bb=R(()=>{yh=new WeakMap});function eM(e){if(zb&&Ub.indexOf(e)<=Ub.indexOf(zb)){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];console[e](...n)}}function Vb(e){return Ub.reduce((t,n)=>(t[n]=eM.bind(console,n,e),t),{})}var Ub,zb,fs,hl=R(()=>{Ub=["error","warn","log","info"],zb="warn";Vb.level=e=>{zb=e};eM.level=Vb.level;fs=Vb});var Hb,aY,Wb,$e,uo=R(()=>{J3();Bb();hl();Hb=fs("quill:events"),aY=["selectionchange","mousedown","mouseup","click"];aY.forEach(e=>{document.addEventListener(e,function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];Array.from(document.querySelectorAll(".ql-container")).forEach(o=>{let l=yh.get(o);l&&l.emitter&&l.emitter.handleDOM(...n)})})});Wb=class extends $b.default{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",Hb.error)}emit(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return Hb.log.call(Hb,...n),super.emit(...n)}handleDOM(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];(this.domListeners[t.type]||[]).forEach(l=>{let{node:a,handler:u}=l;(t.target===a||a.contains(t.target))&&u(t,...s)})}listenDOM(t,n,s){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:n,handler:s})}},$e=Wb});function Xb(e,t){try{t.parentNode}catch{return!1}return e.contains(t)}var Yb,fi,Zb,tM,vh=R(()=>{zt();ta();uo();hl();Yb=fs("quill:selection"),fi=class{constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=t,this.length=n}},Zb=class{constructor(t,n){this.emitter=n,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new fi(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,$e.sources.USER),1)}),this.emitter.on($e.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;let s=this.getNativeRange();s!=null&&s.start.node!==this.cursor.textNode&&this.emitter.once($e.events.SCROLL_UPDATE,(o,l)=>{try{this.root.contains(s.start.node)&&this.root.contains(s.end.node)&&this.setNativeRange(s.start.node,s.start.offset,s.end.node,s.end.offset);let a=l.some(u=>u.type==="characterData"||u.type==="childList"||u.type==="attributes"&&u.target===this.root);this.update(a?$e.sources.SILENT:o)}catch{}})}),this.emitter.on($e.events.SCROLL_OPTIMIZE,(s,o)=>{if(o.range){let{startNode:l,startOffset:a,endNode:u,endOffset:h}=o.range;this.setNativeRange(l,a,u,h),this.update($e.sources.SILENT)}}),this.update($e.sources.SILENT)}handleComposition(){this.emitter.on($e.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on($e.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){let t=this.cursor.restore();if(!t)return;setTimeout(()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update($e.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,n){this.scroll.update();let s=this.getNativeRange();if(!(s==null||!s.native.collapsed||this.scroll.query(t,je.BLOCK))){if(s.start.node!==this.cursor.textNode){let o=this.scroll.find(s.start.node,!1);if(o==null)return;if(o instanceof Fn){let l=o.split(s.start.offset);o.parent.insertBefore(this.cursor,l)}else o.insertBefore(this.cursor,s.start.node);this.cursor.attach()}this.cursor.format(t,n),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=this.scroll.length();t=Math.min(t,s-1),n=Math.min(t+n,s-1)-t;let o,[l,a]=this.scroll.leaf(t);if(l==null)return null;if(n>0&&a===l.length()){let[d]=this.scroll.leaf(t+1);if(d){let[_]=this.scroll.line(t),[m]=this.scroll.line(t+1);_===m&&(l=d,a=0)}}[o,a]=l.position(a,!0);let u=document.createRange();if(n>0)return u.setStart(o,a),[l,a]=this.scroll.leaf(t+n),l==null?null:([o,a]=l.position(a,!0),u.setEnd(o,a),u.getBoundingClientRect());let h="left",p;if(o instanceof Text){if(!o.data.length)return null;a<o.data.length?(u.setStart(o,a),u.setEnd(o,a+1)):(u.setStart(o,a-1),u.setEnd(o,a),h="right"),p=u.getBoundingClientRect()}else{if(!(l.domNode instanceof Element))return null;p=l.domNode.getBoundingClientRect(),a>0&&(h="right")}return{bottom:p.top+p.height,height:p.height,left:p[h],right:p[h],top:p.top,width:0}}getNativeRange(){let t=document.getSelection();if(t==null||t.rangeCount<=0)return null;let n=t.getRangeAt(0);if(n==null)return null;let s=this.normalizeNative(n);return Yb.info("getNativeRange",s),s}getRange(){let t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];let n=this.getNativeRange();return n==null?[null,null]:[this.normalizedToRange(n),n]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Xb(this.root,document.activeElement)}normalizedToRange(t){let n=[[t.start.node,t.start.offset]];t.native.collapsed||n.push([t.end.node,t.end.offset]);let s=n.map(a=>{let[u,h]=a,p=this.scroll.find(u,!0),d=p.offset(this.scroll);return h===0?d:p instanceof Fn?d+p.index(u,h):d+p.length()}),o=Math.min(Math.max(...s),this.scroll.length()-1),l=Math.min(o,...s);return new fi(l,o-l)}normalizeNative(t){if(!Xb(this.root,t.startContainer)||!t.collapsed&&!Xb(this.root,t.endContainer))return null;let n={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[n.start,n.end].forEach(s=>{let{node:o,offset:l}=s;for(;!(o instanceof Text)&&o.childNodes.length>0;)if(o.childNodes.length>l)o=o.childNodes[l],l=0;else if(o.childNodes.length===l)o=o.lastChild,o instanceof Text?l=o.data.length:o.childNodes.length>0?l=o.childNodes.length:l=o.childNodes.length+1;else break;s.node=o,s.offset=l}),n}rangeToNative(t){let n=this.scroll.length(),s=(o,l)=>{o=Math.min(n-1,o);let[a,u]=this.scroll.leaf(o);return a?a.position(u,l):[null,-1]};return[...s(t.index,!1),...s(t.index+t.length,!0)]}setNativeRange(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Yb.info("setNativeRange",t,n,s,o),t!=null&&(this.root.parentNode==null||t.parentNode==null||s.parentNode==null))return;let a=document.getSelection();if(a!=null)if(t!=null){this.hasFocus()||this.root.focus({preventScroll:!0});let{native:u}=this.getNativeRange()||{};if(u==null||l||t!==u.startContainer||n!==u.startOffset||s!==u.endContainer||o!==u.endOffset){t instanceof Element&&t.tagName==="BR"&&(n=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),s instanceof Element&&s.tagName==="BR"&&(o=Array.from(s.parentNode.childNodes).indexOf(s),s=s.parentNode);let h=document.createRange();h.setStart(t,n),h.setEnd(s,o),a.removeAllRanges(),a.addRange(h)}}else a.removeAllRanges(),this.root.blur()}setRange(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$e.sources.API;if(typeof n=="string"&&(s=n,n=!1),Yb.info("setRange",t),t!=null){let o=this.rangeToNative(t);this.setNativeRange(...o,n)}else this.setNativeRange(null);this.update(s)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$e.sources.USER,n=this.lastRange,[s,o]=this.getRange();if(this.lastRange=s,this.lastNative=o,this.lastRange!=null&&(this.savedRange=this.lastRange),!il(n,this.lastRange)){if(!this.composing&&o!=null&&o.native.collapsed&&o.start.node!==this.cursor.textNode){let a=this.cursor.restore();a&&this.setNativeRange(a.startNode,a.startOffset,a.endNode,a.endOffset)}let l=[$e.events.SELECTION_CHANGE,xr(this.lastRange),xr(n),t];this.emitter.emit($e.events.EDITOR_CHANGE,...l),t!==$e.sources.SILENT&&this.emitter.emit(...l)}}};tM=Zb});function Yc(e,t,n){if(e.length===0){let[v]=Qb(n.pop());return t<=0?`</li></${v}>`:`</li></${v}>${Yc([],t-1,n)}`}let[{child:s,offset:o,length:l,indent:a,type:u},...h]=e,[p,d]=Qb(u);if(a>t)return n.push(u),a===t+1?`<${p}><li${d}>${bh(s,o,l)}${Yc(h,a,n)}`:`<${p}><li>${Yc(e,t+1,n)}`;let _=n[n.length-1];if(a===t&&u===_)return`</li><li${d}>${bh(s,o,l)}${Yc(h,a,n)}`;let[m]=Qb(n.pop());return`</li></${m}>${Yc(e,t-1,n)}`}function bh(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in e&&typeof e.html=="function")return e.html(t,n);if(e instanceof Ln)return dl(e.value().slice(t,t+n)).replaceAll(" ","&nbsp;");if(e instanceof zi){if(e.statics.blotName==="list-container"){let p=[];return e.children.forEachAt(t,n,(d,_,m)=>{let v="formats"in d&&typeof d.formats=="function"?d.formats():{};p.push({child:d,offset:_,length:m,indent:v.indent||0,type:v.list})}),Yc(p,-1,[])}let o=[];if(e.children.forEachAt(t,n,(p,d,_)=>{o.push(bh(p,d,_))}),s||e.statics.blotName==="list")return o.join("");let{outerHTML:l,innerHTML:a}=e.domNode,[u,h]=l.split(`>${a}<`);return u==="<table"?`<table style="border: 1px solid #000;">${o.join("")}<${h}`:`${u}>${o.join("")}<${h}`}return e.domNode instanceof Element?e.domNode.outerHTML:""}function cY(e,t){return Object.keys(t).reduce((n,s)=>{if(e[s]==null)return n;let o=t[s];return o===e[s]?n[s]=o:Array.isArray(o)?o.indexOf(e[s])<0?n[s]=o.concat([e[s]]):n[s]=o:n[s]=[o,e[s]],n},{})}function Qb(e){let t=e==="ordered"?"ol":"ul";switch(e){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function nM(e){return e.reduce((t,n)=>{if(typeof n.insert=="string"){let s=n.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return t.insert(s,n.attributes)}return t.push(n)},new pn.default)}function iM(e,t){let{index:n,length:s}=e;return new fi(n+t,s)}function uY(e){let t=[];return e.forEach(n=>{typeof n.insert=="string"?n.insert.split(`
`).forEach((o,l)=>{l&&t.push({insert:`
`,attributes:n.attributes}),o&&t.push({insert:o,attributes:n.attributes})}):t.push(n)}),t}var pn,lY,Kb,sM,rM=R(()=>{ta();zt();pn=Ut(hs(),1);ks();aa();mh();lo();vh();lY=/^[ -~]*$/,Kb=class{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let n=this.scroll.length();this.scroll.batchStart();let s=nM(t),o=new pn.default;return uY(s.ops.slice()).reduce((a,u)=>{let h=pn.Op.length(u),p=u.attributes||{},d=!1,_=!1;if(u.insert!=null){if(o.retain(h),typeof u.insert=="string"){let x=u.insert;_=!x.endsWith(`
`)&&(n<=a||!!this.scroll.descendant(Vn,a)[0]),this.scroll.insertAt(a,x);let[b,w]=this.scroll.line(a),L=Ui({},Hi(b));if(b instanceof Vt){let[D]=b.descendant(Fn,w);D&&(L=Ui(L,Hi(D)))}p=pn.AttributeMap.diff(L,p)||{}}else if(typeof u.insert=="object"){let x=Object.keys(u.insert)[0];if(x==null)return a;let b=this.scroll.query(x,je.INLINE)!=null;if(b)(n<=a||this.scroll.descendant(Vn,a)[0])&&(_=!0);else if(a>0){let[w,L]=this.scroll.descendant(Fn,a-1);w instanceof Ln?w.value()[L]!==`
`&&(d=!0):w instanceof fn&&w.statics.scope===je.INLINE_BLOT&&(d=!0)}if(this.scroll.insertAt(a,x,u.insert[x]),b){let[w]=this.scroll.descendant(Fn,a);if(w){let L=Ui({},Hi(w));p=pn.AttributeMap.diff(L,p)||{}}}}n+=h}else if(o.push(u),u.retain!==null&&typeof u.retain=="object"){let x=Object.keys(u.retain)[0];if(x==null)return a;this.scroll.updateEmbedAt(a,x,u.retain[x])}Object.keys(p).forEach(x=>{this.scroll.formatAt(a,h,x,p[x])});let m=d?1:0,v=_?1:0;return n+=m+v,o.retain(m),o.delete(v),a+h+m+v},0),o.reduce((a,u)=>typeof u.delete=="number"?(this.scroll.deleteAt(a,u.delete),a):a+pn.Op.length(u),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(s)}deleteText(t,n){return this.scroll.deleteAt(t,n),this.update(new pn.default().retain(t).delete(n))}formatLine(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(s).forEach(l=>{this.scroll.lines(t,Math.max(n,1)).forEach(a=>{a.format(l,s[l])})}),this.scroll.optimize();let o=new pn.default().retain(t).retain(n,xr(s));return this.update(o)}formatText(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s).forEach(l=>{this.scroll.formatAt(t,n,l,s[l])});let o=new pn.default().retain(t).retain(n,xr(s));return this.update(o)}getContents(t,n){return this.delta.slice(t,t+n)}getDelta(){return this.scroll.lines().reduce((t,n)=>t.concat(n.delta()),new pn.default)}getFormat(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=[],o=[];n===0?this.scroll.path(t).forEach(u=>{let[h]=u;h instanceof Vt?s.push(h):h instanceof Fn&&o.push(h)}):(s=this.scroll.lines(t,n),o=this.scroll.descendants(Fn,t,n));let[l,a]=[s,o].map(u=>{let h=u.shift();if(h==null)return{};let p=Hi(h);for(;Object.keys(p).length>0;){let d=u.shift();if(d==null)return p;p=cY(Hi(d),p)}return p});return{...l,...a}}getHTML(t,n){let[s,o]=this.scroll.line(t);if(s){let l=s.length();return s.length()>=o+n&&!(o===0&&n===l)?bh(s,o,n,!0):bh(this.scroll,t,n,!0)}return""}getText(t,n){return this.getContents(t,n).filter(s=>typeof s.insert=="string").map(s=>s.insert).join("")}insertContents(t,n){let s=nM(n),o=new pn.default().retain(t).concat(s);return this.scroll.insertContents(t,s),this.update(o)}insertEmbed(t,n,s){return this.scroll.insertAt(t,n,s),this.update(new pn.default().retain(t).insert({[n]:s}))}insertText(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n=n.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(t,n),Object.keys(s).forEach(o=>{this.scroll.formatAt(t,n.length,o,s[o])}),this.update(new pn.default().retain(t).insert(n,xr(s)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;let t=this.scroll.children.head;if(t?.statics.blotName!==Vt.blotName)return!1;let n=t;return n.children.length>1?!1:n.children.head instanceof ui}removeFormat(t,n){let s=this.getText(t,n),[o,l]=this.scroll.line(t+n),a=0,u=new pn.default;o!=null&&(a=o.length()-l,u=o.delta().slice(l,l+a-1).insert(`
`));let p=this.getContents(t,n+a).diff(new pn.default().insert(s).concat(u)),d=new pn.default().retain(t).concat(p);return this.applyDelta(d)}update(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,o=this.delta;if(n.length===1&&n[0].type==="characterData"&&n[0].target.data.match(lY)&&this.scroll.find(n[0].target)){let l=this.scroll.find(n[0].target),a=Hi(l),u=l.offset(this.scroll),h=n[0].oldValue.replace(la.CONTENTS,""),p=new pn.default().insert(h),d=new pn.default().insert(l.value()),_=s&&{oldRange:iM(s.oldRange,-u),newRange:iM(s.newRange,-u)};t=new pn.default().retain(u).concat(p.diff(d,_)).reduce((v,x)=>x.insert?v.insert(x.insert,a):v.push(x),new pn.default),this.delta=o.compose(t)}else this.delta=this.getDelta(),(!t||!il(o.compose(t),this.delta))&&(t=o.diff(this.delta,s));return t}};sM=Kb});var Jb,gn,Rs=R(()=>{Jb=class{static DEFAULTS={};constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=t,this.options=n}},gn=Jb});var ym,ex,Xc,vm=R(()=>{zt();lo();ym="\uFEFF",ex=class extends fn{constructor(t,n){super(t,n),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(s=>{this.contentNode.appendChild(s)}),this.leftGuard=document.createTextNode(ym),this.rightGuard=document.createTextNode(ym),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,n){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,n)}restore(t){let n=null,s,o=t.data.split(ym).join("");if(t===this.leftGuard)if(this.prev instanceof Ln){let l=this.prev.length();this.prev.insertAt(l,o),n={startNode:this.prev.domNode,startOffset:l+o.length}}else s=document.createTextNode(o),this.parent.insertBefore(this.scroll.create(s),this),n={startNode:s,startOffset:o.length};else t===this.rightGuard&&(this.next instanceof Ln?(this.next.insertAt(0,o),n={startNode:this.next.domNode,startOffset:o.length}):(s=document.createTextNode(o),this.parent.insertBefore(this.scroll.create(s),this.next),n={startNode:s,startOffset:o.length}));return t.data=ym,n}update(t,n){t.forEach(s=>{if(s.type==="characterData"&&(s.target===this.leftGuard||s.target===this.rightGuard)){let o=this.restore(s.target);o&&(n.range=o)}})}},Xc=ex});var tx,oM,aM=R(()=>{vm();uo();tx=class{isComposing=!1;constructor(t,n){this.scroll=t,this.emitter=n,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",t=>{this.isComposing||this.handleCompositionStart(t)}),this.scroll.domNode.addEventListener("compositionend",t=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(t)})})}handleCompositionStart(t){let n=t.target instanceof Node?this.scroll.find(t.target,!0):null;n&&!(n instanceof Xc)&&(this.emitter.emit($e.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit($e.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit($e.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit($e.events.COMPOSITION_END,t),this.isComposing=!1}},oM=tx});var nx,Zc,ix=R(()=>{nx=class e{static DEFAULTS={modules:{}};static themes={default:e};modules={};constructor(t,n){this.quill=t,this.options=n}init(){Object.keys(this.options.modules).forEach(t=>{this.modules[t]==null&&this.addModule(t)})}addModule(t){let n=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new n(this.quill,this.options.modules[t]||{}),this.modules[t]}},Zc=nx});var dY,hY,bm,lM,fY,cM,uM=R(()=>{dY=e=>e.parentElement||e.getRootNode().host||null,hY=e=>{let t=e.getBoundingClientRect(),n="offsetWidth"in e&&Math.abs(t.width)/e.offsetWidth||1,s="offsetHeight"in e&&Math.abs(t.height)/e.offsetHeight||1;return{top:t.top,right:t.left+e.clientWidth*n,bottom:t.top+e.clientHeight*s,left:t.left}},bm=e=>{let t=parseInt(e,10);return Number.isNaN(t)?0:t},lM=(e,t,n,s,o,l)=>e<n&&t>s?0:e<n?-(n-e+o):t>s?t-e>s-n?e+o-n:t-s+l:0,fY=(e,t)=>{let n=e.ownerDocument,s=t,o=e;for(;o;){let l=o===n.body,a=l?{top:0,right:window.visualViewport?.width??n.documentElement.clientWidth,bottom:window.visualViewport?.height??n.documentElement.clientHeight,left:0}:hY(o),u=getComputedStyle(o),h=lM(s.left,s.right,a.left,a.right,bm(u.scrollPaddingLeft),bm(u.scrollPaddingRight)),p=lM(s.top,s.bottom,a.top,a.bottom,bm(u.scrollPaddingTop),bm(u.scrollPaddingBottom));if(h||p)if(l)n.defaultView?.scrollBy(h,p);else{let{scrollLeft:d,scrollTop:_}=o;p&&(o.scrollTop+=p),h&&(o.scrollLeft+=h);let m=o.scrollLeft-d,v=o.scrollTop-_;s={left:s.left-m,top:s.top-v,right:s.right-m,bottom:s.bottom-v}}o=l||u.position==="fixed"?null:dY(o)}},cM=fY});var pY,gY,mY,dM,hM=R(()=>{zt();pY=100,gY=["block","break","cursor","inline","scroll","text"],mY=(e,t,n)=>{let s=new sa;return gY.forEach(o=>{let l=t.query(o);l&&s.register(l)}),e.forEach(o=>{let l=t.query(o);l||n.error(`Cannot register "${o}" specified in "formats" config. Are you sure it was registered?`);let a=0;for(;l;)if(s.register(l),l="blotName"in l?l.requiredContainer??null:null,a+=1,a>pY){n.error(`Cycle detected in registering blot requiredContainer: "${o}"`);break}}),s},dM=mY});function fM(e){return typeof e=="string"?document.querySelector(e):e}function sx(e){return Object.entries(e??{}).reduce((t,n)=>{let[s,o]=n;return{...t,[s]:o===!0?{}:o}},{})}function pM(e){return Object.fromEntries(Object.entries(e).filter(t=>t[1]!==void 0))}function _Y(e,t){let n=fM(e);if(!n)throw new Error("Invalid Quill container");let o=!t.theme||t.theme===ve.DEFAULTS.theme?Zc:ve.import(`themes/${t.theme}`);if(!o)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);let{modules:l,...a}=ve.DEFAULTS,{modules:u,...h}=o.DEFAULTS,p=sx(t.modules);p!=null&&p.toolbar&&p.toolbar.constructor!==Object&&(p={...p,toolbar:{container:p.toolbar}});let d=Ui({},sx(l),sx(u),p),_={...a,...pM(h),...pM(t)},m=t.registry;return m?t.formats&&Qc.warn('Ignoring "formats" option because "registry" is specified'):m=t.formats?dM(t.formats,_.registry,Qc):_.registry,{..._,registry:m,container:n,theme:o,modules:Object.entries(d).reduce((v,x)=>{let[b,w]=x;if(!w)return v;let L=ve.import(`modules/${b}`);return L==null?(Qc.error(`Cannot load ${b} module. Are you sure you registered it?`),v):{...v,[b]:Ui({},L.DEFAULTS||{},w)}},{}),bounds:fM(_.bounds)}}function Zs(e,t,n,s){if(!this.isEnabled()&&t===$e.sources.USER&&!this.allowReadOnlyEdits)return new ca.default;let o=n==null?null:this.getSelection(),l=this.editor.delta,a=e();if(o!=null&&(n===!0&&(n=o.index),s==null?o=gM(o,a,t):s!==0&&(o=gM(o,n,s,t)),this.setSelection(o,$e.sources.SILENT)),a.length()>0){let u=[$e.events.TEXT_CHANGE,a,l,t];this.emitter.emit($e.events.EDITOR_CHANGE,...u),t!==$e.sources.SILENT&&this.emitter.emit(...u)}return a}function ho(e,t,n,s,o){let l={};return typeof e.index=="number"&&typeof e.length=="number"?typeof t!="number"?(o=s,s=n,n=t,t=e.length,e=e.index):(t=e.length,e=e.index):typeof t!="number"&&(o=s,s=n,n=t,t=0),typeof n=="object"?(l=n,o=s):typeof n=="string"&&(s!=null?l[n]=s:o=n),o=o||$e.sources.API,[e,t,l,o]}function gM(e,t,n,s){let o=typeof n=="number"?n:0;if(e==null)return null;let l,a;return t&&typeof t.transformPosition=="function"?[l,a]=[e.index,e.index+e.length].map(u=>t.transformPosition(u,s!==$e.sources.USER)):[l,a]=[e.index,e.index+e.length].map(u=>u<t||u===t&&s===$e.sources.USER?u:o>=0?u+o:Math.max(t,u+o)),new fi(l,a-l)}var ca,Qc,xm,ve,Wi=R(()=>{ta();zt();ca=Ut(hs(),1);rM();uo();Bb();hl();Rs();vh();aM();ix();uM();hM();Qc=fs("quill"),xm=new sa;zi.uiClass="ql-ui";ve=class e{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:xm,theme:"default"};static events=$e.events;static sources=$e.sources;static version="2.0.3";static imports={delta:ca.default,parchment:zc,"core/module":gn,"core/theme":Zc};static debug(t){t===!0&&(t="log"),fs.level(t)}static find(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return yh.get(t)||xm.find(t,n)}static import(t){return this.imports[t]==null&&Qc.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){let t=arguments.length<=0?void 0:arguments[0],n=!!(!(arguments.length<=1)&&arguments[1]),s="attrName"in t?t.attrName:t.blotName;typeof s=="string"?this.register(`formats/${s}`,t,n):Object.keys(t).forEach(o=>{this.register(o,t[o],n)})}else{let t=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],s=!!(!(arguments.length<=2)&&arguments[2]);this.imports[t]!=null&&!s&&Qc.warn(`Overwriting ${t} with`,n),this.imports[t]=n,(t.startsWith("blots/")||t.startsWith("formats/"))&&n&&typeof n!="boolean"&&n.blotName!=="abstract"&&xm.register(n),typeof n.register=="function"&&n.register(xm)}}constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=_Y(t,n),this.container=this.options.container,this.container==null){Qc.error("Invalid Quill container",t);return}this.options.debug&&e.debug(this.options.debug);let s=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",yh.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new $e;let o=lh.blotName,l=this.options.registry.query(o);if(!l||!("blotName"in l))throw new Error(`Cannot initialize Quill without "${o}" blot`);if(this.scroll=new l(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new sM(this.scroll),this.selection=new tM(this.scroll,this.emitter),this.composition=new oM(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on($e.events.EDITOR_CHANGE,a=>{a===$e.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on($e.events.SCROLL_UPDATE,(a,u)=>{let h=this.selection.lastRange,[p]=this.selection.getRange(),d=h&&p?{oldRange:h,newRange:p}:void 0;Zs.call(this,()=>this.editor.update(null,u,d),a)}),this.emitter.on($e.events.SCROLL_EMBED_UPDATE,(a,u)=>{let h=this.selection.lastRange,[p]=this.selection.getRange(),d=h&&p?{oldRange:h,newRange:p}:void 0;Zs.call(this,()=>{let _=new ca.default().retain(a.offset(this)).retain({[a.statics.blotName]:u});return this.editor.update(_,[],d)},e.sources.USER)}),s){let a=this.clipboard.convert({html:`${s}<p><br></p>`,text:`
`});this.setContents(a)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof t=="string"){let s=t;t=document.createElement("div"),t.classList.add(s)}return this.container.insertBefore(t,n),t}blur(){this.selection.setRange(null)}deleteText(t,n,s){return[t,n,,s]=ho(t,n,s),Zs.call(this,()=>this.editor.deleteText(t,n),s,t,-1*n)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;let n=t();return this.allowReadOnlyEdits=!1,n}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$e.sources.API;return Zs.call(this,()=>{let o=this.getSelection(!0),l=new ca.default;if(o==null)return l;if(this.scroll.query(t,je.BLOCK))l=this.editor.formatLine(o.index,o.length,{[t]:n});else{if(o.length===0)return this.selection.format(t,n),l;l=this.editor.formatText(o.index,o.length,{[t]:n})}return this.setSelection(o,$e.sources.SILENT),l},s)}formatLine(t,n,s,o,l){let a;return[t,n,a,l]=ho(t,n,s,o,l),Zs.call(this,()=>this.editor.formatLine(t,n,a),l,t,0)}formatText(t,n,s,o,l){let a;return[t,n,a,l]=ho(t,n,s,o,l),Zs.call(this,()=>this.editor.formatText(t,n,a),l,t,0)}getBounds(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=null;if(typeof t=="number"?s=this.selection.getBounds(t,n):s=this.selection.getBounds(t.index,t.length),!s)return null;let o=this.container.getBoundingClientRect();return{bottom:s.bottom-o.top,height:s.height,left:s.left-o.left,right:s.right-o.left,top:s.top-o.top,width:s.width}}getContents(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-t;return[t,n]=ho(t,n),this.editor.getContents(t,n)}getFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof t=="number"?this.editor.getFormat(t,n):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof t!="number"?this.scroll.lines(t.index,t.length):this.scroll.lines(t,n)}getModule(t){return this.theme.modules[t]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(n=n??this.getLength()-t),[t,n]=ho(t,n),this.editor.getHTML(t,n)}getText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(n=n??this.getLength()-t),[t,n]=ho(t,n),this.editor.getText(t,n)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,n,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.sources.API;return Zs.call(this,()=>this.editor.insertEmbed(t,n,s),o,t)}insertText(t,n,s,o,l){let a;return[t,,a,l]=ho(t,0,s,o,l),Zs.call(this,()=>this.editor.insertText(t,n,a),l,t,n.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(t,n,s){return[t,n,,s]=ho(t,n,s),Zs.call(this,()=>this.editor.removeFormat(t,n),s,t)}scrollRectIntoView(t){cM(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){let t=this.selection.lastRange,n=t&&this.selection.getBounds(t.index,t.length);n&&this.scrollRectIntoView(n)}setContents(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$e.sources.API;return Zs.call(this,()=>{t=new ca.default(t);let s=this.getLength(),o=this.editor.deleteText(0,s),l=this.editor.insertContents(0,t),a=this.editor.deleteText(this.getLength()-1,1);return o.compose(l).compose(a)},n)}setSelection(t,n,s){t==null?this.selection.setRange(null,n||e.sources.API):([t,n,,s]=ho(t,n,s),this.selection.setRange(new fi(Math.max(0,t),n),s),s!==$e.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$e.sources.API,s=new ca.default().insert(t);return this.setContents(s,n)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$e.sources.USER,n=this.scroll.update(t);return this.selection.update(t),n}updateContents(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$e.sources.API;return Zs.call(this,()=>(t=new ca.default(t),this.editor.applyDelta(t)),n,!0)}}});var rx,Ms,Kc=R(()=>{zt();rx=class extends Bc{},Ms=rx});function mM(e){return e instanceof Vt||e instanceof Vn}function _M(e){return typeof e.updateContent=="function"}function ox(e,t,n){n.reduce((s,o)=>{let l=As.Op.length(o),a=o.attributes||{};if(o.insert!=null){if(typeof o.insert=="string"){let u=o.insert;e.insertAt(s,u);let[h]=e.descendant(Fn,s),p=Hi(h);a=As.AttributeMap.diff(p,a)||{}}else if(typeof o.insert=="object"){let u=Object.keys(o.insert)[0];if(u==null)return s;if(e.insertAt(s,u,o.insert[u]),e.scroll.query(u,je.INLINE)!=null){let[p]=e.descendant(Fn,s),d=Hi(p);a=As.AttributeMap.diff(d,a)||{}}}}return Object.keys(a).forEach(u=>{e.formatAt(s,l,u,a[u])}),s+l},t)}var As,ax,yM,vM=R(()=>{zt();As=Ut(hs(),1);uo();ks();aa();Kc();ax=class extends lh{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Vt;static allowedChildren=[Vt,Vn,Ms];constructor(t,n,s){let{emitter:o}=s;super(t,n),this.emitter=o,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",l=>this.handleDragStart(l))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;let t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit($e.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit($e.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,n){this.emitter.emit($e.events.SCROLL_EMBED_UPDATE,t,n)}deleteAt(t,n){let[s,o]=this.line(t),[l]=this.line(t+n);if(super.deleteAt(t,n),l!=null&&s!==l&&o>0){if(s instanceof Vn||l instanceof Vn){this.optimize();return}let a=l.children.head instanceof ui?null:l.children.head;s.moveChildren(l,a),s.remove()}this.optimize()}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,n,s,o){super.formatAt(t,n,s,o),this.optimize()}insertAt(t,n,s){if(t>=this.length())if(s==null||this.scroll.query(n,je.BLOCK)==null){let o=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(o),s==null&&n.endsWith(`
`)?o.insertAt(0,n.slice(0,-1),s):o.insertAt(0,n,s)}else{let o=this.scroll.create(n,s);this.appendChild(o)}else super.insertAt(t,n,s);this.optimize()}insertBefore(t,n){if(t.statics.scope===je.INLINE_BLOT){let s=this.scroll.create(this.statics.defaultChild.blotName);s.appendChild(t),super.insertBefore(s,n)}else super.insertBefore(t,n)}insertContents(t,n){let s=this.deltaToRenderBlocks(n.concat(new As.default().insert(`
`))),o=s.pop();if(o==null)return;this.batchStart();let l=s.shift();if(l){let h=l.type==="block"&&(l.delta.length()===0||!this.descendant(Vn,t)[0]&&t<this.length()),p=l.type==="block"?l.delta:new As.default().insert({[l.key]:l.value});ox(this,t,p);let d=l.type==="block"?1:0,_=t+p.length()+d;h&&this.insertAt(_-1,`
`);let m=Hi(this.line(t)[0]),v=As.AttributeMap.diff(m,l.attributes)||{};Object.keys(v).forEach(x=>{this.formatAt(_-1,1,x,v[x])}),t=_}let[a,u]=this.children.find(t);if(s.length&&(a&&(a=a.split(u),u=0),s.forEach(h=>{if(h.type==="block"){let p=this.createBlock(h.attributes,a||void 0);ox(p,0,h.delta)}else{let p=this.create(h.key,h.value);this.insertBefore(p,a||void 0),Object.keys(h.attributes).forEach(d=>{p.format(d,h.attributes[d])})}})),o.type==="block"&&o.delta.length()){let h=a?a.offset(a.scroll)+u:this.length();ox(this,h,o.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(t){let n=this.path(t).pop();if(!n)return[null,-1];let[s,o]=n;return s instanceof Fn?[s,o]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(mM,t)}lines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,s=(o,l,a)=>{let u=[],h=a;return o.children.forEachAt(l,a,(p,d,_)=>{mM(p)?u.push(p):p instanceof Bc&&(u=u.concat(s(p,d,h))),h-=_}),u};return s(this,t,n)}optimize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(t,n),t.length>0&&this.emitter.emit($e.events.SCROLL_OPTIMIZE,t,n))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch){Array.isArray(t)&&(this.batch=this.batch.concat(t));return}let n=$e.sources.USER;typeof t=="string"&&(n=t),Array.isArray(t)||(t=this.observer.takeRecords()),t=t.filter(s=>{let{target:o}=s,l=this.find(o,!0);return l&&!_M(l)}),t.length>0&&this.emitter.emit($e.events.SCROLL_BEFORE_UPDATE,n,t),super.update(t.concat([])),t.length>0&&this.emitter.emit($e.events.SCROLL_UPDATE,n,t)}updateEmbedAt(t,n,s){let[o]=this.descendant(l=>l instanceof Vn,t);o&&o.statics.blotName===n&&_M(o)&&o.updateContent(s)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){let n=[],s=new As.default;return t.forEach(o=>{let l=o?.insert;if(l)if(typeof l=="string"){let a=l.split(`
`);a.slice(0,-1).forEach(h=>{s.insert(h,o.attributes),n.push({type:"block",delta:s,attributes:o.attributes??{}}),s=new As.default});let u=a[a.length-1];u&&s.insert(u,o.attributes)}else{let a=Object.keys(l)[0];if(!a)return;this.query(a,je.INLINE)?s.push(o):(s.length()&&n.push({type:"block",delta:s,attributes:{}}),s=new As.default,n.push({type:"blockEmbed",key:a,value:l[a],attributes:o.attributes??{}}))}}),s.length()&&n.push({type:"block",delta:s,attributes:{}}),n}createBlock(t,n){let s,o={};Object.entries(t).forEach(u=>{let[h,p]=u;this.query(h,je.BLOCK&je.BLOT)!=null?s=h:o[h]=p});let l=this.create(s||this.statics.defaultChild.blotName,s?t[s]:void 0);this.insertBefore(l,n||void 0);let a=l.length();return Object.entries(o).forEach(u=>{let[h,p]=u;l.formatAt(0,a,h,p)}),l}};yM=ax});var lx,bM,cx,wm,ux=R(()=>{zt();lx={scope:je.BLOCK,whitelist:["right","center","justify"]},bM=new bi("align","align",lx),cx=new Pn("align","ql-align",lx),wm=new Vi("align","text-align",lx)});var xh,xM,wh,Sm=R(()=>{zt();xh=class extends Vi{value(t){let n=super.value(t);return n.startsWith("rgb(")?(n=n.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${n.split(",").map(o=>`00${parseInt(o,10).toString(16)}`.slice(-2)).join("")}`):n}},xM=new Pn("color","ql-color",{scope:je.INLINE}),wh=new xh("color","color",{scope:je.INLINE})});var wM,Sh,dx=R(()=>{zt();Sm();wM=new Pn("background","ql-bg",{scope:je.INLINE}),Sh=new xh("background","background-color",{scope:je.INLINE})});var Sr,Dn,Jc,Em=R(()=>{ks();aa();mh();co();lo();Kc();Wi();Sr=class extends Ms{static create(t){let n=super.create(t);return n.setAttribute("spellcheck","false"),n}code(t,n){return this.children.map(s=>s.length()<=1?"":s.domNode.innerText).join(`
`).slice(t,t+n)}html(t,n){return`<pre>
${dl(this.code(t,n))}
</pre>`}},Dn=class extends Vt{static TAB="  ";static register(){ve.register(Sr)}},Jc=class extends di{};Jc.blotName="code";Jc.tagName="CODE";Dn.blotName="code-block";Dn.className="ql-code-block";Dn.tagName="DIV";Sr.blotName="code-block-container";Sr.className="ql-code-block-container";Sr.tagName="DIV";Sr.allowedChildren=[Dn];Dn.allowedChildren=[Ln,ui,la];Dn.requiredContainer=Sr});var hx,Cm,fx,Im,px=R(()=>{zt();hx={scope:je.BLOCK,whitelist:["rtl"]},Cm=new bi("direction","dir",hx),fx=new Pn("direction","ql-direction",hx),Im=new Vi("direction","direction",hx)});var SM,mx,gx,Lm,_x=R(()=>{zt();SM={scope:je.INLINE,whitelist:["serif","monospace"]},mx=new Pn("font","ql-font",SM),gx=class extends Vi{value(t){return super.value(t).replace(/["']/g,"")}},Lm=new gx("font","font-family",SM)});var yx,Nm,vx=R(()=>{zt();yx=new Pn("size","ql-size",{scope:je.INLINE,whitelist:["small","large","huge"]}),Nm=new Vi("size","font-size",{scope:je.INLINE,whitelist:["10px","18px","32px"]})});function EM(e){return{key:"Tab",shiftKey:!e,format:{"code-block":!0},handler(t,n){let{event:s}=n,o=this.quill.scroll.query("code-block"),{TAB:l}=o;if(t.length===0&&!s.shiftKey){this.quill.insertText(t.index,l,ve.sources.USER),this.quill.setSelection(t.index+l.length,ve.sources.SILENT);return}let a=t.length===0?this.quill.getLines(t.index,1):this.quill.getLines(t),{index:u,length:h}=t;a.forEach((p,d)=>{e?(p.insertAt(0,l),d===0?u+=l.length:h+=l.length):p.domNode.textContent.startsWith(l)&&(p.deleteAt(0,l.length),d===0?u-=l.length:h-=l.length)}),this.quill.update(ve.sources.USER),this.quill.setSelection(u,h,ve.sources.SILENT)}}}function Tm(e,t){return{key:e,shiftKey:t,altKey:null,[e==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(s){let{index:o}=s;e==="ArrowRight"&&(o+=s.length+1);let[l]=this.quill.getLeaf(o);return l instanceof fn?(e==="ArrowLeft"?t?this.quill.setSelection(s.index-1,s.length+1,ve.sources.USER):this.quill.setSelection(s.index-1,ve.sources.USER):t?this.quill.setSelection(s.index,s.length+1,ve.sources.USER):this.quill.setSelection(s.index+s.length+1,ve.sources.USER),!1):!0}}}function bx(e){return{key:e[0],shortKey:!0,handler(t,n){this.quill.format(e,!n.format[e],ve.sources.USER)}}}function CM(e){return{key:e?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,n){let s=e?"prev":"next",o=n.line,l=o.parent[s];if(l!=null){if(l.statics.blotName==="table-row"){let a=l.children.head,u=o;for(;u.prev!=null;)u=u.prev,a=a.next;let h=a.offset(this.quill.scroll)+Math.min(n.offset,a.length()-1);this.quill.setSelection(h,0,ve.sources.USER)}}else{let a=o.table()[s];a!=null&&(e?this.quill.setSelection(a.offset(this.quill.scroll)+a.length()-1,0,ve.sources.USER):this.quill.setSelection(a.offset(this.quill.scroll),0,ve.sources.USER))}return!1}}}function xY(e){if(typeof e=="string"||typeof e=="number")e={key:e};else if(typeof e=="object")e=xr(e);else return null;return e.shortKey&&(e[vY]=e.shortKey,delete e.shortKey),e}function Ch(e){let{quill:t,range:n}=e,s=t.getLines(n),o={};if(s.length>1){let l=s[0].formats(),a=s[s.length-1].formats();o=pi.AttributeMap.diff(a,l)||{}}t.deleteText(n,ve.sources.USER),Object.keys(o).length>0&&t.formatLine(n.index,1,o,ve.sources.USER),t.setSelection(n.index,ve.sources.SILENT)}function wY(e,t,n,s){return t.prev==null&&t.next==null?n.prev==null&&n.next==null?s===0?-1:1:n.prev==null?-1:1:t.prev==null?-1:t.next==null?1:null}var pi,yY,vY,Eh,bY,km=R(()=>{ta();pi=Ut(hs(),1);zt();Wi();hl();Rs();yY=fs("quill:keyboard"),vY=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",Eh=class e extends gn{static match(t,n){return["altKey","ctrlKey","metaKey","shiftKey"].some(s=>!!n[s]!==t[s]&&n[s]!==null)?!1:n.key===t.key||n.key===t.which}constructor(t,n){super(t,n),this.bindings={},Object.keys(this.options.bindings).forEach(s=>{this.options.bindings[s]&&this.addBinding(this.options.bindings[s])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=xY(t);if(o==null){yY.warn("Attempted to add invalid keyboard binding",o);return}typeof n=="function"&&(n={handler:n}),typeof s=="function"&&(s={handler:s}),(Array.isArray(o.key)?o.key:[o.key]).forEach(a=>{let u={...o,key:a,...n,...s};this.bindings[u.key]=this.bindings[u.key]||[],this.bindings[u.key].push(u)})}listen(){this.quill.root.addEventListener("keydown",t=>{if(t.defaultPrevented||t.isComposing||t.keyCode===229&&(t.key==="Enter"||t.key==="Backspace"))return;let o=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter(L=>e.match(t,L));if(o.length===0)return;let l=ve.find(t.target,!0);if(l&&l.scroll!==this.quill.scroll)return;let a=this.quill.getSelection();if(a==null||!this.quill.hasFocus())return;let[u,h]=this.quill.getLine(a.index),[p,d]=this.quill.getLeaf(a.index),[_,m]=a.length===0?[p,d]:this.quill.getLeaf(a.index+a.length),v=p instanceof Uc?p.value().slice(0,d):"",x=_ instanceof Uc?_.value().slice(m):"",b={collapsed:a.length===0,empty:a.length===0&&u.length()<=1,format:this.quill.getFormat(a),line:u,offset:h,prefix:v,suffix:x,event:t};o.some(L=>{if(L.collapsed!=null&&L.collapsed!==b.collapsed||L.empty!=null&&L.empty!==b.empty||L.offset!=null&&L.offset!==b.offset)return!1;if(Array.isArray(L.format)){if(L.format.every(D=>b.format[D]==null))return!1}else if(typeof L.format=="object"&&!Object.keys(L.format).every(D=>L.format[D]===!0?b.format[D]!=null:L.format[D]===!1?b.format[D]==null:il(L.format[D],b.format[D])))return!1;return L.prefix!=null&&!L.prefix.test(b.prefix)||L.suffix!=null&&!L.suffix.test(b.suffix)?!1:L.handler.call(this,a,b,L)!==!0})&&t.preventDefault()})}handleBackspace(t,n){let s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(n.prefix)?2:1;if(t.index===0||this.quill.getLength()<=1)return;let o={},[l]=this.quill.getLine(t.index),a=new pi.default().retain(t.index-s).delete(s);if(n.offset===0){let[u]=this.quill.getLine(t.index-1);if(u&&!(u.statics.blotName==="block"&&u.length()<=1)){let p=l.formats(),d=this.quill.getFormat(t.index-1,1);if(o=pi.AttributeMap.diff(p,d)||{},Object.keys(o).length>0){let _=new pi.default().retain(t.index+l.length()-2).retain(1,o);a=a.compose(_)}}}this.quill.updateContents(a,ve.sources.USER),this.quill.focus()}handleDelete(t,n){let s=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(n.suffix)?2:1;if(t.index>=this.quill.getLength()-s)return;let o={},[l]=this.quill.getLine(t.index),a=new pi.default().retain(t.index).delete(s);if(n.offset>=l.length()-1){let[u]=this.quill.getLine(t.index+1);if(u){let h=l.formats(),p=this.quill.getFormat(t.index,1);o=pi.AttributeMap.diff(h,p)||{},Object.keys(o).length>0&&(a=a.retain(u.length()-1).retain(1,o))}}this.quill.updateContents(a,ve.sources.USER),this.quill.focus()}handleDeleteRange(t){Ch({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,n){let s=Object.keys(n.format).reduce((l,a)=>(this.quill.scroll.query(a,je.BLOCK)&&!Array.isArray(n.format[a])&&(l[a]=n.format[a]),l),{}),o=new pi.default().retain(t.index).delete(t.length).insert(`
`,s);this.quill.updateContents(o,ve.sources.USER),this.quill.setSelection(t.index+1,ve.sources.SILENT),this.quill.focus()}},bY={bindings:{bold:bx("bold"),italic:bx("italic"),underline:bx("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(e,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","+1",ve.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(e,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","-1",ve.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(e,t){t.format.indent!=null?this.quill.format("indent","-1",ve.sources.USER):t.format.list!=null&&this.quill.format("list",!1,ve.sources.USER)}},"indent code-block":EM(!0),"outdent code-block":EM(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(e){this.quill.deleteText(e.index-1,1,ve.sources.USER)}},tab:{key:"Tab",handler(e,t){if(t.format.table)return!0;this.quill.history.cutoff();let n=new pi.default().retain(e.index).delete(e.length).insert("	");return this.quill.updateContents(n,ve.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,ve.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,ve.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(e,t){let n={list:!1};t.format.indent&&(n.indent=!1),this.quill.formatLine(e.index,e.length,n,ve.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(e){let[t,n]=this.quill.getLine(e.index),s={...t.formats(),list:"checked"},o=new pi.default().retain(e.index).insert(`
`,s).retain(t.length()-n-1).retain(1,{list:"unchecked"});this.quill.updateContents(o,ve.sources.USER),this.quill.setSelection(e.index+1,ve.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(e,t){let[n,s]=this.quill.getLine(e.index),o=new pi.default().retain(e.index).insert(`
`,t.format).retain(n.length()-s-1).retain(1,{header:null});this.quill.updateContents(o,ve.sources.USER),this.quill.setSelection(e.index+1,ve.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(e){let t=this.quill.getModule("table");if(t){let[n,s,o,l]=t.getTable(e),a=wY(n,s,o,l);if(a==null)return;let u=n.offset();if(a<0){let h=new pi.default().retain(u).insert(`
`);this.quill.updateContents(h,ve.sources.USER),this.quill.setSelection(e.index+1,e.length,ve.sources.SILENT)}else if(a>0){u+=n.length();let h=new pi.default().retain(u).insert(`
`);this.quill.updateContents(h,ve.sources.USER),this.quill.setSelection(u,ve.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(e,t){let{event:n,line:s}=t,o=s.offset(this.quill.scroll);n.shiftKey?this.quill.setSelection(o-1,ve.sources.USER):this.quill.setSelection(o+s.length(),ve.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(e,t){if(this.quill.scroll.query("list")==null)return!0;let{length:n}=t.prefix,[s,o]=this.quill.getLine(e.index);if(o>n)return!0;let l;switch(t.prefix.trim()){case"[]":case"[ ]":l="unchecked";break;case"[x]":l="checked";break;case"-":case"*":l="bullet";break;default:l="ordered"}this.quill.insertText(e.index," ",ve.sources.USER),this.quill.history.cutoff();let a=new pi.default().retain(e.index-o).delete(n+1).retain(s.length()-2-o).retain(1,{list:l});return this.quill.updateContents(a,ve.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-n,ve.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(e){let[t,n]=this.quill.getLine(e.index),s=2,o=t;for(;o!=null&&o.length()<=1&&o.formats()["code-block"];)if(o=o.prev,s-=1,s<=0){let l=new pi.default().retain(e.index+t.length()-n-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(l,ve.sources.USER),this.quill.setSelection(e.index-1,ve.sources.SILENT),!1}return!0}},"embed left":Tm("ArrowLeft",!1),"embed left shift":Tm("ArrowLeft",!0),"embed right":Tm("ArrowRight",!1),"embed right shift":Tm("ArrowRight",!0),"table down":CM(!1),"table up":CM(!0)}};Eh.DEFAULTS=bY});function xx(e){e.querySelector('[id^="docs-internal-guid-"]')&&(IY(e),CY(e))}var SY,EY,IM,CY,IY,LM=R(()=>{SY=/font-weight:\s*normal/,EY=["P","OL","UL"],IM=e=>e&&EY.includes(e.tagName),CY=e=>{Array.from(e.querySelectorAll("br")).filter(t=>IM(t.previousElementSibling)&&IM(t.nextElementSibling)).forEach(t=>{t.parentNode?.removeChild(t)})},IY=e=>{Array.from(e.querySelectorAll('b[style*="font-weight"]')).filter(t=>t.getAttribute("style")?.match(SY)).forEach(t=>{let n=e.createDocumentFragment();n.append(...t.childNodes),t.parentNode?.replaceChild(n,t)})}});function wx(e){e.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&RY(e)}var LY,NY,TY,kY,RY,NM=R(()=>{LY=/\bmso-list:[^;]*ignore/i,NY=/\bmso-list:[^;]*\bl(\d+)/i,TY=/\bmso-list:[^;]*\blevel(\d+)/i,kY=(e,t)=>{let n=e.getAttribute("style"),s=n?.match(NY);if(!s)return null;let o=Number(s[1]),l=n?.match(TY),a=l?Number(l[1]):1,u=new RegExp(`@list l${o}:level${a}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),h=t.match(u),p=h&&h[1]==="bullet"?"bullet":"ordered";return{id:o,indent:a,type:p,element:e}},RY=e=>{let t=Array.from(e.querySelectorAll("[style*=mso-list]")),n=[],s=[];t.forEach(a=>{(a.getAttribute("style")||"").match(LY)?n.push(a):s.push(a)}),n.forEach(a=>a.parentNode?.removeChild(a));let o=e.documentElement.innerHTML,l=s.map(a=>kY(a,o)).filter(a=>a);for(;l.length;){let a=[],u=l.shift();for(;u;)a.push(u),u=l.length&&l[0]?.element===u.element.nextElementSibling&&l[0].id===u.id?l.shift():null;let h=document.createElement("ul");a.forEach(_=>{let m=document.createElement("li");m.setAttribute("data-list",_.type),_.indent>1&&m.setAttribute("class",`ql-indent-${_.indent-1}`),m.innerHTML=_.element.innerHTML,h.appendChild(m)});let p=a[0]?.element,{parentNode:d}=p??{};p&&d?.replaceChild(h,p),a.slice(1).forEach(_=>{let{element:m}=_;d?.removeChild(m)})}}});var MY,AY,TM,kM=R(()=>{LM();NM();MY=[wx,xx],AY=e=>{e.documentElement&&MY.forEach(t=>{t(e)})},TM=AY});function fl(e,t,n,s){return s.query(t)?e.reduce((o,l)=>{if(!l.insert)return o;if(l.attributes&&l.attributes[t])return o.push(l);let a=n?{[t]:n}:{};return o.insert(l.insert,{...a,...l.attributes})},new Yi.default):e}function Ih(e,t){let n="";for(let s=e.ops.length-1;s>=0&&n.length<t.length;--s){let o=e.ops[s];if(typeof o.insert!="string")break;n=o.insert+n}return n.slice(-1*t.length)===t}function ua(e,t){if(!(e instanceof Element))return!1;let n=t.query(e);return n&&n.prototype instanceof fn?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(e.tagName.toLowerCase())}function DY(e,t){return e.previousElementSibling&&e.nextElementSibling&&!ua(e.previousElementSibling,t)&&!ua(e.nextElementSibling,t)}function AM(e){return e==null?!1:(Rm.has(e)||(e.tagName==="PRE"?Rm.set(e,!0):Rm.set(e,AM(e.parentNode))),Rm.get(e))}function Am(e,t,n,s,o){return t.nodeType===t.TEXT_NODE?s.reduce((l,a)=>a(t,l,e),new Yi.default):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((l,a)=>{let u=Am(e,a,n,s,o);return a.nodeType===t.ELEMENT_NODE&&(u=n.reduce((h,p)=>p(a,h,e),u),u=(o.get(a)||[]).reduce((h,p)=>p(a,h,e),u)),l.concat(u)},new Yi.default):new Yi.default}function Sx(e){return(t,n,s)=>fl(n,e,!0,s)}function GY(e,t,n){let s=bi.keys(e),o=Pn.keys(e),l=Vi.keys(e),a={};return s.concat(o).concat(l).forEach(u=>{let h=n.query(u,je.ATTRIBUTE);h!=null&&(a[h.attrName]=h.value(e),a[h.attrName])||(h=FY[u],h!=null&&(h.attrName===u||h.keyName===u)&&(a[h.attrName]=h.value(e)||void 0),h=RM[u],h!=null&&(h.attrName===u||h.keyName===u)&&(h=RM[u],a[h.attrName]=h.value(e)||void 0))}),Object.entries(a).reduce((u,h)=>{let[p,d]=h;return fl(u,p,d,n)},t)}function jY(e,t,n){let s=n.query(e);if(s==null)return t;if(s.prototype instanceof fn){let o={},l=s.value(e);if(l!=null)return o[s.blotName]=l,new Yi.default().insert(o,s.formats(e,n))}else if(s.prototype instanceof sl&&!Ih(t,`
`)&&t.insert(`
`),"blotName"in s&&"formats"in s&&typeof s.formats=="function")return fl(t,s.blotName,s.formats(e,n),n);return t}function qY(e,t){return Ih(t,`
`)||t.insert(`
`),t}function $Y(e,t,n){let s=n.query("code-block"),o=s&&"formats"in s&&typeof s.formats=="function"?s.formats(e,n):!0;return fl(t,"code-block",o,n)}function BY(){return new Yi.default}function UY(e,t,n){let s=n.query(e);if(s==null||s.blotName!=="list"||!Ih(t,`
`))return t;let o=-1,l=e.parentNode;for(;l!=null;)["OL","UL"].includes(l.tagName)&&(o+=1),l=l.parentNode;return o<=0?t:t.reduce((a,u)=>u.insert?u.attributes&&typeof u.attributes.indent=="number"?a.push(u):a.insert(u.insert,{indent:o,...u.attributes||{}}):a,new Yi.default)}function zY(e,t,n){let s=e,o=s.tagName==="OL"?"ordered":"bullet",l=s.getAttribute("data-checked");return l&&(o=l==="true"?"checked":"unchecked"),fl(t,"list",o,n)}function MM(e,t,n){if(!Ih(t,`
`)){if(ua(e,n)&&(e.childNodes.length>0||e instanceof HTMLParagraphElement))return t.insert(`
`);if(t.length()>0&&e.nextSibling){let s=e.nextSibling;for(;s!=null;){if(ua(s,n))return t.insert(`
`);let o=n.query(s);if(o&&o.prototype instanceof Vn)return t.insert(`
`);s=s.firstChild}}}return t}function VY(e,t,n){let s={},o=e.style||{};return o.fontStyle==="italic"&&(s.italic=!0),o.textDecoration==="underline"&&(s.underline=!0),o.textDecoration==="line-through"&&(s.strike=!0),(o.fontWeight?.startsWith("bold")||parseInt(o.fontWeight,10)>=700)&&(s.bold=!0),t=Object.entries(s).reduce((l,a)=>{let[u,h]=a;return fl(l,u,h,n)},t),parseFloat(o.textIndent||0)>0?new Yi.default().insert("	").concat(t):t}function HY(e,t,n){let s=e.parentElement?.tagName==="TABLE"?e.parentElement:e.parentElement?.parentElement;if(s!=null){let l=Array.from(s.querySelectorAll("tr")).indexOf(e)+1;return fl(t,"table",l,n)}return t}function WY(e,t,n){let s=e.data;if(e.parentElement?.tagName==="O:P")return t.insert(s.trim());if(!AM(e)){if(s.trim().length===0&&s.includes(`
`)&&!DY(e,n))return t;s=s.replace(/[^\S\u00a0]/g," "),s=s.replace(/ {2,}/g," "),(e.previousSibling==null&&e.parentElement!=null&&ua(e.parentElement,n)||e.previousSibling instanceof Element&&ua(e.previousSibling,n))&&(s=s.replace(/^ /,"")),(e.nextSibling==null&&e.parentElement!=null&&ua(e.parentElement,n)||e.nextSibling instanceof Element&&ua(e.nextSibling,n))&&(s=s.replace(/ $/,"")),s=s.replaceAll("\xA0"," ")}return t.insert(s)}var Yi,OY,PY,FY,RM,Mm,Rm,Ex=R(()=>{zt();Yi=Ut(hs(),1);ks();hl();Rs();Wi();ux();dx();Em();Sm();px();_x();vx();km();kM();OY=fs("quill:clipboard"),PY=[[Node.TEXT_NODE,WY],[Node.TEXT_NODE,MM],["br",qY],[Node.ELEMENT_NODE,MM],[Node.ELEMENT_NODE,jY],[Node.ELEMENT_NODE,GY],[Node.ELEMENT_NODE,VY],["li",UY],["ol, ul",zY],["pre",$Y],["tr",HY],["b",Sx("bold")],["i",Sx("italic")],["strike",Sx("strike")],["style",BY]],FY=[bM,Cm].reduce((e,t)=>(e[t.keyName]=t,e),{}),RM=[wm,Sh,wh,Im,Lm,Nm].reduce((e,t)=>(e[t.keyName]=t,e),{}),Mm=class extends gn{static DEFAULTS={matchers:[]};constructor(t,n){super(t,n),this.quill.root.addEventListener("copy",s=>this.onCaptureCopy(s,!1)),this.quill.root.addEventListener("cut",s=>this.onCaptureCopy(s,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],PY.concat(this.options.matchers??[]).forEach(s=>{let[o,l]=s;this.addMatcher(o,l)})}addMatcher(t,n){this.matchers.push([t,n])}convert(t){let{html:n,text:s}=t,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(o[Dn.blotName])return new Yi.default().insert(s||"",{[Dn.blotName]:o[Dn.blotName]});if(!n)return new Yi.default().insert(s||"",o);let l=this.convertHTML(n);return Ih(l,`
`)&&(l.ops[l.ops.length-1].attributes==null||o.table)?l.compose(new Yi.default().retain(l.length()-1).delete(1)):l}normalizeHTML(t){TM(t)}convertHTML(t){let n=new DOMParser().parseFromString(t,"text/html");this.normalizeHTML(n);let s=n.body,o=new WeakMap,[l,a]=this.prepareMatching(s,o);return Am(this.quill.scroll,s,l,a,o)}dangerouslyPasteHTML(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ve.sources.API;if(typeof t=="string"){let o=this.convert({html:t,text:""});this.quill.setContents(o,n),this.quill.setSelection(0,ve.sources.SILENT)}else{let o=this.convert({html:n,text:""});this.quill.updateContents(new Yi.default().retain(t).concat(o),s),this.quill.setSelection(t+o.length(),ve.sources.SILENT)}}onCaptureCopy(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.defaultPrevented)return;t.preventDefault();let[s]=this.quill.selection.getRange();if(s==null)return;let{html:o,text:l}=this.onCopy(s,n);t.clipboardData?.setData("text/plain",l),t.clipboardData?.setData("text/html",o),n&&Ch({range:s,quill:this.quill})}normalizeURIList(t){return t.split(/\r?\n/).filter(n=>n[0]!=="#").join(`
`)}onCapturePaste(t){if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();let n=this.quill.getSelection(!0);if(n==null)return;let s=t.clipboardData?.getData("text/html"),o=t.clipboardData?.getData("text/plain");if(!s&&!o){let a=t.clipboardData?.getData("text/uri-list");a&&(o=this.normalizeURIList(a))}let l=Array.from(t.clipboardData?.files||[]);if(!s&&l.length>0){this.quill.uploader.upload(n,l);return}if(s&&l.length>0){let a=new DOMParser().parseFromString(s,"text/html");if(a.body.childElementCount===1&&a.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(n,l);return}}this.onPaste(n,{html:s,text:o})}onCopy(t){let n=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:n}}onPaste(t,n){let{text:s,html:o}=n,l=this.quill.getFormat(t.index),a=this.convert({text:s,html:o},l);OY.log("onPaste",a,{text:s,html:o});let u=new Yi.default().retain(t.index).delete(t.length).concat(a);this.quill.updateContents(u,ve.sources.USER),this.quill.setSelection(u.length()-t.length,ve.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,n){let s=[],o=[];return this.matchers.forEach(l=>{let[a,u]=l;switch(a){case Node.TEXT_NODE:o.push(u);break;case Node.ELEMENT_NODE:s.push(u);break;default:Array.from(t.querySelectorAll(a)).forEach(h=>{n.has(h)?n.get(h)?.push(u):n.set(h,[u])});break}}),[s,o]}};Rm=new WeakMap});function OM(e,t){let n=t;for(let s=e.length-1;s>=0;s-=1){let o=e[s];e[s]={delta:n.transform(o.delta,!0),range:o.range&&Cx(o.range,n)},n=o.delta.transform(n),e[s].delta.length()===0&&e.splice(s,1)}}function YY(e,t){let n=t.ops[t.ops.length-1];return n==null?!1:n.insert!=null?typeof n.insert=="string"&&n.insert.endsWith(`
`):n.attributes!=null?Object.keys(n.attributes).some(s=>e.query(s,je.BLOCK)!=null):!1}function XY(e,t){let n=t.reduce((o,l)=>o+(l.delete||0),0),s=t.length()-n;return YY(e,t)&&(s-=1),s}function Cx(e,t){if(!e)return e;let n=t.transformPosition(e.index),s=t.transformPosition(e.index+e.length);return{index:n,length:s-n}}var Om,PM=R(()=>{zt();Rs();Wi();Om=class extends gn{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(t,n){super(t,n),this.quill.on(ve.events.EDITOR_CHANGE,(s,o,l,a)=>{s===ve.events.SELECTION_CHANGE?o&&a!==ve.sources.SILENT&&(this.currentRange=o):s===ve.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||a===ve.sources.USER?this.record(o,l):this.transform(o)),this.currentRange=Cx(this.currentRange,o))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",s=>{s.inputType==="historyUndo"?(this.undo(),s.preventDefault()):s.inputType==="historyRedo"&&(this.redo(),s.preventDefault())})}change(t,n){if(this.stack[t].length===0)return;let s=this.stack[t].pop();if(!s)return;let o=this.quill.getContents(),l=s.delta.invert(o);this.stack[n].push({delta:l,range:Cx(s.range,l)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(s.delta,ve.sources.USER),this.ignoreChange=!1,this.restoreSelection(s)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(t,n){if(t.ops.length===0)return;this.stack.redo=[];let s=t.invert(n),o=this.currentRange,l=Date.now();if(this.lastRecorded+this.options.delay>l&&this.stack.undo.length>0){let a=this.stack.undo.pop();a&&(s=s.compose(a.delta),o=a.range)}else this.lastRecorded=l;s.length()!==0&&(this.stack.undo.push({delta:s,range:o}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(t){OM(this.stack.undo,t),OM(this.stack.redo,t)}undo(){this.change("undo","redo")}restoreSelection(t){if(t.range)this.quill.setSelection(t.range,ve.sources.USER);else{let n=XY(this.quill.scroll,t.delta);this.quill.setSelection(n,ve.sources.USER)}}}});var FM,Pm,DM,GM=R(()=>{FM=Ut(hs(),1);uo();Rs();Pm=class extends gn{constructor(t,n){super(t,n),t.root.addEventListener("drop",s=>{s.preventDefault();let o=null;if(document.caretRangeFromPoint)o=document.caretRangeFromPoint(s.clientX,s.clientY);else if(document.caretPositionFromPoint){let a=document.caretPositionFromPoint(s.clientX,s.clientY);o=document.createRange(),o.setStart(a.offsetNode,a.offset),o.setEnd(a.offsetNode,a.offset)}let l=o&&t.selection.normalizeNative(o);if(l){let a=t.selection.normalizedToRange(l);s.dataTransfer?.files&&this.upload(a,s.dataTransfer.files)}})}upload(t,n){let s=[];Array.from(n).forEach(o=>{o&&this.options.mimetypes?.includes(o.type)&&s.push(o)}),s.length>0&&this.options.handler.call(this,t,s)}};Pm.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(e,t){if(!this.quill.scroll.query("image"))return;let n=t.map(s=>new Promise(o=>{let l=new FileReader;l.onload=()=>{o(l.result)},l.readAsDataURL(s)}));Promise.all(n).then(s=>{let o=s.reduce((l,a)=>l.insert({image:a}),new FM.default().retain(e.index).delete(e.length));this.quill.updateContents(o,$e.sources.USER),this.quill.setSelection(e.index+s.length,$e.sources.SILENT)})}};DM=Pm});function QY(e){return typeof e.data=="string"?e.data:e.dataTransfer?.types.includes("text/plain")?e.dataTransfer.getData("text/plain"):null}var jM,ZY,Ix,qM,$M=R(()=>{jM=Ut(hs(),1);Rs();Wi();km();ZY=["insertText","insertReplacementText"],Ix=class extends gn{constructor(t,n){super(t,n),t.root.addEventListener("beforeinput",s=>{this.handleBeforeInput(s)}),/Android/i.test(navigator.userAgent)||t.on(ve.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(t){Ch({range:t,quill:this.quill})}replaceText(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t.length===0)return!1;if(n){let s=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents(new jM.default().retain(t.index).insert(n,s),ve.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+n.length,0,ve.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!ZY.includes(t.inputType))return;let n=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!n||n.collapsed===!0)return;let s=QY(t);if(s==null)return;let o=this.quill.selection.normalizeNative(n),l=o?this.quill.selection.normalizedToRange(o):null;l&&this.replaceText(l,s)&&t.preventDefault()}handleCompositionStart(){let t=this.quill.getSelection();t&&this.replaceText(t)}};qM=Ix});var KY,JY,eX,Lx,BM,UM=R(()=>{zt();Rs();Wi();KY=/Mac/i.test(navigator.platform),JY=100,eX=e=>!!(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="Home"||KY&&e.key==="a"&&e.ctrlKey===!0),Lx=class extends gn{isListening=!1;selectionChangeDeadline=0;constructor(t,n){super(t,n),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(t,n){let{line:s,event:o}=n;if(!(s instanceof zi)||!s.uiNode)return!0;let l=getComputedStyle(s.domNode).direction==="rtl";return l&&o.key!=="ArrowRight"||!l&&o.key!=="ArrowLeft"?!0:(this.quill.setSelection(t.index-1,t.length+(o.shiftKey?1:0),ve.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",t=>{!t.defaultPrevented&&eX(t)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+JY,this.isListening)return;this.isListening=!0;let t=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",t,{once:!0})}handleSelectionChange(){let t=document.getSelection();if(!t)return;let n=t.getRangeAt(0);if(n.collapsed!==!0||n.startOffset!==0)return;let s=this.quill.scroll.find(n.startContainer);if(!(s instanceof zi)||!s.uiNode)return;let o=document.createRange();o.setStartAfter(s.uiNode),o.setEndAfter(s.uiNode),t.removeAllRanges(),t.addRange(o)}},BM=Lx});var Os,Fm,Nx=R(()=>{Wi();ks();aa();Kc();mh();vm();co();vM();lo();Ex();PM();km();GM();Os=Ut(hs(),1);$M();UM();Rs();ve.register({"blots/block":Vt,"blots/block/embed":Vn,"blots/break":ui,"blots/container":Ms,"blots/cursor":la,"blots/embed":Xc,"blots/inline":di,"blots/scroll":yM,"blots/text":Ln,"modules/clipboard":Mm,"modules/history":Om,"modules/keyboard":Eh,"modules/uploader":DM,"modules/input":qM,"modules/uiNode":BM});Fm=ve});var Tx,tX,zM,VM=R(()=>{zt();Tx=class extends Pn{add(t,n){let s=0;if(n==="+1"||n==="-1"){let o=this.value(t)||0;s=n==="+1"?o+1:o-1}else typeof n=="number"&&(s=n);return s===0?(this.remove(t),!0):super.add(t,s.toString())}canAdd(t,n){return super.canAdd(t,n)||super.canAdd(t,parseInt(n,10))}value(t){return parseInt(super.value(t),10)||void 0}},tX=new Tx("indent","ql-indent",{scope:je.BLOCK,whitelist:[1,2,3,4,5,6,7,8]}),zM=tX});var kx,HM,WM=R(()=>{ks();kx=class extends Vt{static blotName="blockquote";static tagName="blockquote"},HM=kx});var Rx,YM,XM=R(()=>{ks();Rx=class extends Vt{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(t){return this.tagName.indexOf(t.tagName)+1}},YM=Rx});var pl,da,ZM=R(()=>{ks();Kc();Wi();pl=class extends Ms{};pl.blotName="list-container";pl.tagName="OL";da=class extends Vt{static create(t){let n=super.create();return n.setAttribute("data-list",t),n}static formats(t){return t.getAttribute("data-list")||void 0}static register(){ve.register(pl)}constructor(t,n){super(t,n);let s=n.ownerDocument.createElement("span"),o=l=>{if(!t.isEnabled())return;let a=this.statics.formats(n,t);a==="checked"?(this.format("list","unchecked"),l.preventDefault()):a==="unchecked"&&(this.format("list","checked"),l.preventDefault())};s.addEventListener("mousedown",o),s.addEventListener("touchstart",o),this.attachUI(s)}format(t,n){t===this.statics.blotName&&n?this.domNode.setAttribute("data-list",n):super.format(t,n)}};da.blotName="list";da.tagName="LI";pl.allowedChildren=[da];da.requiredContainer=pl});var Mx,eu,Dm=R(()=>{co();Mx=class extends di{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(t){super.optimize(t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}},eu=Mx});var Ax,QM,KM=R(()=>{Dm();Ax=class extends eu{static blotName="italic";static tagName=["EM","I"]},QM=Ax});function Ox(e,t){let n=document.createElement("a");n.href=e;let s=n.href.slice(0,n.href.indexOf(":"));return t.indexOf(s)>-1}var fo,Lh=R(()=>{co();fo=class extends di{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(t){let n=super.create(t);return n.setAttribute("href",this.sanitize(t)),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("target","_blank"),n}static formats(t){return t.getAttribute("href")}static sanitize(t){return Ox(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,n){t!==this.statics.blotName||!n?super.format(t,n):this.domNode.setAttribute("href",this.constructor.sanitize(n))}}});var Px,JM,e5=R(()=>{co();Px=class extends di{static blotName="script";static tagName=["SUB","SUP"];static create(t){return t==="super"?document.createElement("sup"):t==="sub"?document.createElement("sub"):super.create(t)}static formats(t){if(t.tagName==="SUB")return"sub";if(t.tagName==="SUP")return"super"}},JM=Px});var Fx,t5,n5=R(()=>{Dm();Fx=class extends eu{static blotName="strike";static tagName=["S","STRIKE"]},t5=Fx});var Dx,i5,s5=R(()=>{co();Dx=class extends di{static blotName="underline";static tagName="U"},i5=Dx});var Gx,r5,o5=R(()=>{vm();Gx=class extends Xc{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(t){if(window.katex==null)throw new Error("Formula module requires KaTeX.");let n=super.create(t);return typeof t=="string"&&(window.katex.render(t,n,{throwOnError:!1,errorColor:"#f00"}),n.setAttribute("data-value",t)),n}static value(t){return t.getAttribute("data-value")}html(){let{formula:t}=this.value();return`<span>${t}</span>`}},r5=Gx});var a5,jx,l5,c5=R(()=>{zt();Lh();a5=["alt","height","width"],jx=class extends fn{static blotName="image";static tagName="IMG";static create(t){let n=super.create(t);return typeof t=="string"&&n.setAttribute("src",this.sanitize(t)),n}static formats(t){return a5.reduce((n,s)=>(t.hasAttribute(s)&&(n[s]=t.getAttribute(s)),n),{})}static match(t){return/\.(jpe?g|gif|png)$/.test(t)||/^data:image\/.+;base64/.test(t)}static sanitize(t){return Ox(t,["http","https","data"])?t:"//:0"}static value(t){return t.getAttribute("src")}format(t,n){a5.indexOf(t)>-1?n?this.domNode.setAttribute(t,n):this.domNode.removeAttribute(t):super.format(t,n)}},l5=jx});var u5,qx,d5,h5=R(()=>{ks();Lh();u5=["height","width"],qx=class extends Vn{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(t){let n=super.create(t);return n.setAttribute("frameborder","0"),n.setAttribute("allowfullscreen","true"),n.setAttribute("src",this.sanitize(t)),n}static formats(t){return u5.reduce((n,s)=>(t.hasAttribute(s)&&(n[s]=t.getAttribute(s)),n),{})}static sanitize(t){return fo.sanitize(t)}static value(t){return t.getAttribute("src")}format(t,n){u5.indexOf(t)>-1?n?this.domNode.setAttribute(t,n):this.domNode.removeAttribute(t):super.format(t,n)}html(){let{video:t}=this.value();return`<a href="${t}">${t}</a>`}},d5=qx});var Gm,Nh,po,Xi,gl,nX,Th,f5=R(()=>{Gm=Ut(hs(),1);zt();co();Wi();Rs();ks();aa();mh();lo();Em();Ex();Nh=new Pn("code-token","hljs",{scope:je.INLINE}),po=class e extends di{static formats(t,n){for(;t!=null&&t!==n.domNode;){if(t.classList&&t.classList.contains(Dn.className))return super.formats(t,n);t=t.parentNode}}constructor(t,n,s){super(t,n,s),Nh.add(this.domNode,s)}format(t,n){t!==e.blotName?super.format(t,n):n?Nh.add(this.domNode,n):(Nh.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Nh.value(this.domNode)||this.unwrap()}};po.blotName="code-token";po.className="ql-token";Xi=class extends Dn{static create(t){let n=super.create(t);return typeof t=="string"&&n.setAttribute("data-language",t),n}static formats(t){return t.getAttribute("data-language")||"plain"}static register(){}format(t,n){t===this.statics.blotName&&n?this.domNode.setAttribute("data-language",n):super.format(t,n)}replaceWith(t,n){return this.formatAt(0,this.length(),po.blotName,!1),super.replaceWith(t,n)}},gl=class extends Sr{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(t,n){t===Xi.blotName&&(this.forceNext=!0,this.children.forEach(s=>{s.format(t,n)}))}formatAt(t,n,s,o){s===Xi.blotName&&(this.forceNext=!0),super.formatAt(t,n,s,o)}highlight(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;let o=`${Array.from(this.domNode.childNodes).filter(a=>a!==this.uiNode).map(a=>a.textContent).join(`
`)}
`,l=Xi.formats(this.children.head.domNode);if(n||this.forceNext||this.cachedText!==o){if(o.trim().length>0||this.cachedText==null){let a=this.children.reduce((h,p)=>h.concat(Gb(p,!1)),new Gm.default),u=t(o,l);a.diff(u).reduce((h,p)=>{let{retain:d,attributes:_}=p;return d?(_&&Object.keys(_).forEach(m=>{[Xi.blotName,po.blotName].includes(m)&&this.formatAt(h,d,m,_[m])}),h+d):h},0)}this.cachedText=o,this.forceNext=!1}}html(t,n){let[s]=this.children.find(t);return`<pre data-language="${s?Xi.formats(s.domNode):"plain"}">
${dl(this.code(t,n))}
</pre>`}optimize(t){if(super.optimize(t),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){let n=Xi.formats(this.children.head.domNode);n!==this.uiNode.value&&(this.uiNode.value=n)}}};gl.allowedChildren=[Xi];Xi.requiredContainer=gl;Xi.allowedChildren=[po,la,Ln,ui];nX=(e,t,n)=>{if(typeof e.versionString=="string"){let s=e.versionString.split(".")[0];if(parseInt(s,10)>=11)return e.highlight(n,{language:t}).value}return e.highlight(t,n).value},Th=class extends gn{static register(){ve.register(po,!0),ve.register(Xi,!0),ve.register(gl,!0)}constructor(t,n){if(super(t,n),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((s,o)=>{let{key:l}=o;return s[l]=!0,s},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(ve.events.SCROLL_BLOT_MOUNT,t=>{if(!(t instanceof gl))return;let n=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(s=>{let{key:o,label:l}=s,a=n.ownerDocument.createElement("option");a.textContent=l,a.setAttribute("value",o),n.appendChild(a)}),n.addEventListener("change",()=>{t.format(Xi.blotName,n.value),this.quill.root.focus(),this.highlight(t,!0)}),t.uiNode==null&&(t.attachUI(n),t.children.head&&(n.value=Xi.formats(t.children.head.domNode)))})}initTimer(){let t=null;this.quill.on(ve.events.SCROLL_OPTIMIZE,()=>{t&&clearTimeout(t),t=setTimeout(()=>{this.highlight(),t=null},this.options.interval)})}highlight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(ve.sources.USER);let s=this.quill.getSelection();(t==null?this.quill.scroll.descendants(gl):[t]).forEach(l=>{l.highlight(this.highlightBlot,n)}),this.quill.update(ve.sources.SILENT),s!=null&&this.quill.setSelection(s,ve.sources.SILENT)}highlightBlot(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(n=this.languages[n]?n:"plain",n==="plain")return dl(t).split(`
`).reduce((o,l,a)=>(a!==0&&o.insert(`
`,{[Dn.blotName]:n}),o.insert(l)),new Gm.default);let s=this.quill.root.ownerDocument.createElement("div");return s.classList.add(Dn.className),s.innerHTML=nX(this.options.hljs,n,t),Am(this.quill.scroll,s,[(o,l)=>{let a=Nh.value(o);return a?l.compose(new Gm.default().retain(l.length(),{[po.blotName]:a})):l}],[(o,l)=>o.data.split(`
`).reduce((a,u,h)=>(h!==0&&a.insert(`
`,{[Dn.blotName]:n}),a.insert(u)),l)],new WeakMap)}};Th.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]}});function jm(){return`row-${Math.random().toString(36).slice(2,6)}`}var Ps,Er,Qs,ml,p5=R(()=>{ks();Kc();Ps=class e extends Vt{static blotName="table";static tagName="TD";static create(t){let n=super.create();return t?n.setAttribute("data-row",t):n.setAttribute("data-row",jm()),n}static formats(t){if(t.hasAttribute("data-row"))return t.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(t,n){t===e.blotName&&n?this.domNode.setAttribute("data-row",n):super.format(t,n)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}},Er=class extends Ms{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){let t=this.children.head.formats(),n=this.children.tail.formats(),s=this.next.children.head.formats(),o=this.next.children.tail.formats();return t.table===n.table&&t.table===s.table&&t.table===o.table}return!1}optimize(t){super.optimize(t),this.children.forEach(n=>{if(n.next==null)return;let s=n.formats(),o=n.next.formats();if(s.table!==o.table){let l=this.splitAfter(n);l&&l.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}},Qs=class extends Ms{static blotName="table-body";static tagName="TBODY"},ml=class extends Ms{static blotName="table-container";static tagName="TABLE";balanceCells(){let t=this.descendants(Er),n=t.reduce((s,o)=>Math.max(o.children.length,s),0);t.forEach(s=>{new Array(n-s.children.length).fill(0).forEach(()=>{let o;s.children.head!=null&&(o=Ps.formats(s.children.head.domNode));let l=this.scroll.create(Ps.blotName,o);s.appendChild(l),l.optimize()})})}cells(t){return this.rows().map(n=>n.children.at(t))}deleteColumn(t){let[n]=this.descendant(Qs);n==null||n.children.head==null||n.children.forEach(s=>{let o=s.children.at(t);o?.remove()})}insertColumn(t){let[n]=this.descendant(Qs);n==null||n.children.head==null||n.children.forEach(s=>{let o=s.children.at(t),l=Ps.formats(s.children.head.domNode),a=this.scroll.create(Ps.blotName,l);s.insertBefore(a,o)})}insertRow(t){let[n]=this.descendant(Qs);if(n==null||n.children.head==null)return;let s=jm(),o=this.scroll.create(Er.blotName);n.children.head.children.forEach(()=>{let a=this.scroll.create(Ps.blotName,s);o.appendChild(a)});let l=n.children.at(t);n.insertBefore(o,l)}rows(){let t=this.children.head;return t==null?[]:t.children.map(n=>n)}};ml.allowedChildren=[Qs];Qs.requiredContainer=ml;Qs.allowedChildren=[Er];Er.requiredContainer=Qs;Er.allowedChildren=[Ps];Ps.requiredContainer=Er});var g5,$x,m5,_5=R(()=>{g5=Ut(hs(),1);Wi();Rs();p5();$x=class extends gn{static register(){ve.register(Ps),ve.register(Er),ve.register(Qs),ve.register(ml)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(ml).forEach(t=>{t.balanceCells()})}deleteColumn(){let[t,,n]=this.getTable();n!=null&&(t.deleteColumn(n.cellOffset()),this.quill.update(ve.sources.USER))}deleteRow(){let[,t]=this.getTable();t!=null&&(t.remove(),this.quill.update(ve.sources.USER))}deleteTable(){let[t]=this.getTable();if(t==null)return;let n=t.offset();t.remove(),this.quill.update(ve.sources.USER),this.quill.setSelection(n,ve.sources.SILENT)}getTable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(t==null)return[null,null,null,-1];let[n,s]=this.quill.getLine(t.index);if(n==null||n.statics.blotName!==Ps.blotName)return[null,null,null,-1];let o=n.parent;return[o.parent.parent,o,n,s]}insertColumn(t){let n=this.quill.getSelection();if(!n)return;let[s,o,l]=this.getTable(n);if(l==null)return;let a=l.cellOffset();s.insertColumn(a+t),this.quill.update(ve.sources.USER);let u=o.rowOffset();t===0&&(u+=1),this.quill.setSelection(n.index+u,n.length,ve.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(t){let n=this.quill.getSelection();if(!n)return;let[s,o,l]=this.getTable(n);if(l==null)return;let a=o.rowOffset();s.insertRow(a+t),this.quill.update(ve.sources.USER),t>0?this.quill.setSelection(n,ve.sources.SILENT):this.quill.setSelection(n.index+o.children.length,n.length,ve.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(t,n){let s=this.quill.getSelection();if(s==null)return;let o=new Array(t).fill(0).reduce(l=>{let a=new Array(n).fill(`
`).join("");return l.insert(a,{table:jm()})},new g5.default().retain(s.index));this.quill.updateContents(o,ve.sources.USER),this.quill.setSelection(s.index,ve.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(ve.events.SCROLL_OPTIMIZE,t=>{t.some(n=>["TD","TR","TBODY","TABLE"].includes(n.target.tagName)?(this.quill.once(ve.events.TEXT_CHANGE,(s,o,l)=>{l===ve.sources.USER&&this.balanceTables()}),!0):!1)})}},m5=$x});function v5(e,t,n){let s=document.createElement("button");s.setAttribute("type","button"),s.classList.add(`ql-${t}`),s.setAttribute("aria-pressed","false"),n!=null?(s.value=n,s.setAttribute("aria-label",`${t}: ${n}`)):s.setAttribute("aria-label",t),e.appendChild(s)}function iX(e,t){Array.isArray(t[0])||(t=[t]),t.forEach(n=>{let s=document.createElement("span");s.classList.add("ql-formats"),n.forEach(o=>{if(typeof o=="string")v5(s,o);else{let l=Object.keys(o)[0],a=o[l];Array.isArray(a)?sX(s,l,a):v5(s,l,a)}}),e.appendChild(s)})}function sX(e,t,n){let s=document.createElement("select");s.classList.add(`ql-${t}`),n.forEach(o=>{let l=document.createElement("option");o!==!1?l.setAttribute("value",String(o)):l.setAttribute("selected","selected"),s.appendChild(l)}),e.appendChild(s)}var b5,y5,tu,x5=R(()=>{b5=Ut(hs(),1);zt();Wi();hl();Rs();y5=fs("quill:toolbar"),tu=class extends gn{constructor(t,n){if(super(t,n),Array.isArray(this.options.container)){let s=document.createElement("div");s.setAttribute("role","toolbar"),iX(s,this.options.container),t.container?.parentNode?.insertBefore(s,t.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){y5.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{let o=this.options.handlers?.[s];o&&this.addHandler(s,o)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(ve.events.EDITOR_CHANGE,()=>{let[s]=this.quill.selection.getRange();this.update(s)})}addHandler(t,n){this.handlers[t]=n}attach(t){let n=Array.from(t.classList).find(o=>o.indexOf("ql-")===0);if(!n)return;if(n=n.slice(3),t.tagName==="BUTTON"&&t.setAttribute("type","button"),this.handlers[n]==null&&this.quill.scroll.query(n)==null){y5.warn("ignoring attaching to nonexistent format",n,t);return}let s=t.tagName==="SELECT"?"change":"click";t.addEventListener(s,o=>{let l;if(t.tagName==="SELECT"){if(t.selectedIndex<0)return;let u=t.options[t.selectedIndex];u.hasAttribute("selected")?l=!1:l=u.value||!1}else t.classList.contains("ql-active")?l=!1:l=t.value||!t.hasAttribute("value"),o.preventDefault();this.quill.focus();let[a]=this.quill.selection.getRange();if(this.handlers[n]!=null)this.handlers[n].call(this,l);else if(this.quill.scroll.query(n).prototype instanceof fn){if(l=prompt(`Enter ${n}`),!l)return;this.quill.updateContents(new b5.default().retain(a.index).delete(a.length).insert({[n]:l}),ve.sources.USER)}else this.quill.format(n,l,ve.sources.USER);this.update(a)}),this.controls.push([n,t])}update(t){let n=t==null?{}:this.quill.getFormat(t);this.controls.forEach(s=>{let[o,l]=s;if(l.tagName==="SELECT"){let a=null;if(t==null)a=null;else if(n[o]==null)a=l.querySelector("option[selected]");else if(!Array.isArray(n[o])){let u=n[o];typeof u=="string"&&(u=u.replace(/"/g,'\\"')),a=l.querySelector(`option[value="${u}"]`)}a==null?(l.value="",l.selectedIndex=-1):a.selected=!0}else if(t==null)l.classList.remove("ql-active"),l.setAttribute("aria-pressed","false");else if(l.hasAttribute("value")){let a=n[o],u=a===l.getAttribute("value")||a!=null&&a.toString()===l.getAttribute("value")||a==null&&!l.getAttribute("value");l.classList.toggle("ql-active",u),l.setAttribute("aria-pressed",u.toString())}else{let a=n[o]!=null;l.classList.toggle("ql-active",a),l.setAttribute("aria-pressed",a.toString())}})}};tu.DEFAULTS={};tu.DEFAULTS={container:null,handlers:{clean(){let e=this.quill.getSelection();if(e!=null)if(e.length===0){let t=this.quill.getFormat();Object.keys(t).forEach(n=>{this.quill.scroll.query(n,je.INLINE)!=null&&this.quill.format(n,!1,ve.sources.USER)})}else this.quill.removeFormat(e.index,e.length,ve.sources.USER)},direction(e){let{align:t}=this.quill.getFormat();e==="rtl"&&t==null?this.quill.format("align","right",ve.sources.USER):!e&&t==="right"&&this.quill.format("align",!1,ve.sources.USER),this.quill.format("direction",e,ve.sources.USER)},indent(e){let t=this.quill.getSelection(),n=this.quill.getFormat(t),s=parseInt(n.indent||0,10);if(e==="+1"||e==="-1"){let o=e==="+1"?1:-1;n.direction==="rtl"&&(o*=-1),this.quill.format("indent",s+o,ve.sources.USER)}},link(e){e===!0&&(e=prompt("Enter link URL:")),this.quill.format("link",e,ve.sources.USER)},list(e){let t=this.quill.getSelection(),n=this.quill.getFormat(t);e==="check"?n.list==="checked"||n.list==="unchecked"?this.quill.format("list",!1,ve.sources.USER):this.quill.format("list","unchecked",ve.sources.USER):this.quill.format("list",e,ve.sources.USER)}}}});var rX,oX,aX,lX,cX,uX,dX,hX,w5,fX,pX,gX,mX,_X,yX,vX,bX,xX,wX,SX,EX,CX,IX,LX,NX,TX,kX,RX,MX,AX,OX,PX,FX,ha,qm=R(()=>{rX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',oX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',aX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',lX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',cX='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',uX='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',dX='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',hX='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',w5='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',fX='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',pX='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',gX='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',mX='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',_X='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',yX='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',vX='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',bX='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',xX='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',wX='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',SX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',EX='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',CX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',IX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',LX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',NX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',TX='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',kX='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',RX='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',MX='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',AX='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',OX='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',PX='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',FX='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',ha={align:{"":rX,center:oX,right:aX,justify:lX},background:cX,blockquote:uX,bold:dX,clean:hX,code:w5,"code-block":w5,color:fX,direction:{"":pX,rtl:gX},formula:mX,header:{1:_X,2:yX,3:vX,4:bX,5:xX,6:wX},italic:SX,image:EX,indent:{"+1":CX,"-1":IX},link:LX,list:{bullet:NX,check:TX,ordered:kX},script:{sub:RX,super:MX},strike:AX,table:OX,underline:PX,video:FX}});function E5(e,t){e.setAttribute(t,`${e.getAttribute(t)!=="true"}`)}var DX,S5,Bx,fa,kh=R(()=>{DX='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>',S5=0;Bx=class{constructor(t){this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",n=>{switch(n.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),n.preventDefault();break;default:}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),E5(this.label,"aria-expanded"),E5(this.options,"aria-hidden")}buildItem(t){let n=document.createElement("span");n.tabIndex="0",n.setAttribute("role","button"),n.classList.add("ql-picker-item");let s=t.getAttribute("value");return s&&n.setAttribute("data-value",s),t.textContent&&n.setAttribute("data-label",t.textContent),n.addEventListener("click",()=>{this.selectItem(n,!0)}),n.addEventListener("keydown",o=>{switch(o.key){case"Enter":this.selectItem(n,!0),o.preventDefault();break;case"Escape":this.escape(),o.preventDefault();break;default:}}),n}buildLabel(){let t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML=DX,t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}buildOptions(){let t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id=`ql-picker-options-${S5}`,S5+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,Array.from(this.select.options).forEach(n=>{let s=this.buildItem(n);t.appendChild(s),n.selected===!0&&this.selectItem(s)}),this.container.appendChild(t)}buildPicker(){Array.from(this.select.attributes).forEach(t=>{this.container.setAttribute(t.name,t.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.container.querySelector(".ql-selected");t!==s&&(s?.classList.remove("ql-selected"),t!=null&&(t.classList.add("ql-selected"),this.select.selectedIndex=Array.from(t.parentNode.children).indexOf(t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),n&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let t;if(this.select.selectedIndex>-1){let s=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(s)}else this.selectItem(null);let n=t!=null&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",n)}},fa=Bx});var Ux,$m,zx=R(()=>{kh();Ux=class extends fa{constructor(t,n){super(t),this.label.innerHTML=n,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(s=>{s.classList.add("ql-primary")})}buildItem(t){let n=super.buildItem(t);return n.style.backgroundColor=t.getAttribute("value")||"",n}selectItem(t,n){super.selectItem(t,n);let s=this.label.querySelector(".ql-color-label"),o=t&&t.getAttribute("data-value")||"";s&&(s.tagName==="line"?s.style.stroke=o:s.style.fill=o)}},$m=Ux});var Vx,Bm,Hx=R(()=>{kh();Vx=class extends fa{constructor(t,n){super(t),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(s=>{s.innerHTML=n[s.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(t,n){super.selectItem(t,n);let s=t||this.defaultItem;if(s!=null){if(this.label.innerHTML===s.innerHTML)return;this.label.innerHTML=s.innerHTML}}},Bm=Vx});var GX,Wx,Um,Yx=R(()=>{GX=e=>{let{overflowY:t}=getComputedStyle(e,null);return t!=="visible"&&t!=="clip"},Wx=class{constructor(t,n){this.quill=t,this.boundsContainer=n||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,GX(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(t){let n=t.left+t.width/2-this.root.offsetWidth/2,s=t.bottom+this.quill.root.scrollTop;this.root.style.left=`${n}px`,this.root.style.top=`${s}px`,this.root.classList.remove("ql-flip");let o=this.boundsContainer.getBoundingClientRect(),l=this.root.getBoundingClientRect(),a=0;if(l.right>o.right&&(a=o.right-l.right,this.root.style.left=`${n+a}px`),l.left<o.left&&(a=o.left-l.left,this.root.style.left=`${n+a}px`),l.bottom>o.bottom){let u=l.bottom-l.top,h=t.bottom-t.top+u;this.root.style.top=`${s-h}px`,this.root.classList.add("ql-flip")}return a}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}},Um=Wx});function zX(e){let t=e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return t?`${t[1]||"https"}://www.youtube.com/embed/${t[2]}?showinfo=0`:(t=e.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${t[1]||"https"}://player.vimeo.com/video/${t[2]}/`:e}function Rh(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t.forEach(s=>{let o=document.createElement("option");s===n?o.setAttribute("selected","selected"):o.setAttribute("value",String(s)),e.appendChild(o)})}var jX,qX,$X,BX,UX,go,nu,Xx=R(()=>{ta();uo();ix();zx();Hx();kh();Yx();jX=[!1,"center","right","justify"],qX=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],$X=[!1,"serif","monospace"],BX=["1","2","3",!1],UX=["small",!1,"large","huge"],go=class extends Zc{constructor(t,n){super(t,n);let s=o=>{if(!document.body.contains(t.root)){document.body.removeEventListener("click",s);return}this.tooltip!=null&&!this.tooltip.root.contains(o.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(l=>{l.container.contains(o.target)||l.close()})};t.emitter.listenDOM("click",document.body,s)}addModule(t){let n=super.addModule(t);return t==="toolbar"&&this.extendToolbar(n),n}buildButtons(t,n){Array.from(t).forEach(s=>{(s.getAttribute("class")||"").split(/\s+/).forEach(l=>{if(l.startsWith("ql-")&&(l=l.slice(3),n[l]!=null))if(l==="direction")s.innerHTML=n[l][""]+n[l].rtl;else if(typeof n[l]=="string")s.innerHTML=n[l];else{let a=s.value||"";a!=null&&n[l][a]&&(s.innerHTML=n[l][a])}})})}buildPickers(t,n){this.pickers=Array.from(t).map(o=>{if(o.classList.contains("ql-align")&&(o.querySelector("option")==null&&Rh(o,jX),typeof n.align=="object"))return new Bm(o,n.align);if(o.classList.contains("ql-background")||o.classList.contains("ql-color")){let l=o.classList.contains("ql-background")?"background":"color";return o.querySelector("option")==null&&Rh(o,qX,l==="background"?"#ffffff":"#000000"),new $m(o,n[l])}return o.querySelector("option")==null&&(o.classList.contains("ql-font")?Rh(o,$X):o.classList.contains("ql-header")?Rh(o,BX):o.classList.contains("ql-size")&&Rh(o,UX)),new fa(o)});let s=()=>{this.pickers.forEach(o=>{o.update()})};this.quill.on($e.events.EDITOR_CHANGE,s)}};go.DEFAULTS=Ui({},Zc.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let e=this.container.querySelector("input.ql-image[type=file]");e==null&&(e=document.createElement("input"),e.setAttribute("type","file"),e.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),e.classList.add("ql-image"),e.addEventListener("change",()=>{let t=this.quill.getSelection(!0);this.quill.uploader.upload(t,e.files),e.value=""}),this.container.appendChild(e)),e.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});nu=class extends Um{constructor(t,n){super(t,n),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",t=>{t.key==="Enter"?(this.save(),t.preventDefault()):t.key==="Escape"&&(this.cancel(),t.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;n!=null?this.textbox.value=n:t!==this.root.getAttribute("data-mode")&&(this.textbox.value="");let s=this.quill.getBounds(this.quill.selection.savedRange);s!=null&&this.position(s),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${t}`)||""),this.root.setAttribute("data-mode",t)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:t}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{let{scrollTop:n}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",t,$e.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",t,$e.sources.USER)),this.quill.root.scrollTop=n;break}case"video":t=zX(t);case"formula":{if(!t)break;let n=this.quill.getSelection(!0);if(n!=null){let s=n.index+n.length;this.quill.insertEmbed(s,this.root.getAttribute("data-mode"),t,$e.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(s+1," ",$e.sources.USER),this.quill.setSelection(s+2,$e.sources.USER)}break}default:}this.textbox.value="",this.hide()}}});var VX,Zx,Mh,C5=R(()=>{ta();uo();Xx();vh();qm();Wi();VX=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],Zx=class extends nu{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(t,n){super(t,n),this.quill.on($e.events.EDITOR_CHANGE,(s,o,l,a)=>{if(s===$e.events.SELECTION_CHANGE)if(o!=null&&o.length>0&&a===$e.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;let u=this.quill.getLines(o.index,o.length);if(u.length===1){let h=this.quill.getBounds(o);h!=null&&this.position(h)}else{let h=u[u.length-1],p=this.quill.getIndex(h),d=Math.min(h.length()-1,o.index+o.length-p),_=this.quill.getBounds(new fi(p,d));_!=null&&this.position(_)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on($e.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;let t=this.quill.getSelection();if(t!=null){let n=this.quill.getBounds(t);n!=null&&this.position(n)}},1)})}cancel(){this.show()}position(t){let n=super.position(t),s=this.root.querySelector(".ql-tooltip-arrow");return s.style.marginLeft="",n!==0&&(s.style.marginLeft=`${-1*n-s.offsetWidth/2}px`),n}},Mh=class extends go{constructor(t,n){n.modules.toolbar!=null&&n.modules.toolbar.container==null&&(n.modules.toolbar.container=VX),super(t,n),this.quill.container.classList.add("ql-bubble")}extendToolbar(t){this.tooltip=new Zx(this.quill,this.options.bounds),t.container!=null&&(this.tooltip.root.appendChild(t.container),this.buildButtons(t.container.querySelectorAll("button"),ha),this.buildPickers(t.container.querySelectorAll("select"),ha))}};Mh.DEFAULTS=Ui({},go.DEFAULTS,{modules:{toolbar:{handlers:{link(e){e?this.quill.theme.tooltip.edit():this.quill.format("link",!1,ve.sources.USER)}}}}})});var HX,Qx,zm,I5,L5=R(()=>{ta();uo();Xx();Lh();vh();qm();Wi();HX=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],Qx=class extends nu{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",t=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),t.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",t=>{if(this.linkRange!=null){let n=this.linkRange;this.restoreFocus(),this.quill.formatText(n,"link",!1,$e.sources.USER),delete this.linkRange}t.preventDefault(),this.hide()}),this.quill.on($e.events.SELECTION_CHANGE,(t,n,s)=>{if(t!=null){if(t.length===0&&s===$e.sources.USER){let[o,l]=this.quill.scroll.descendant(fo,t.index);if(o!=null){this.linkRange=new fi(t.index-l,o.length());let a=fo.formats(o.domNode);this.preview.textContent=a,this.preview.setAttribute("href",a),this.show();let u=this.quill.getBounds(this.linkRange);u!=null&&this.position(u);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}},zm=class extends go{constructor(t,n){n.modules.toolbar!=null&&n.modules.toolbar.container==null&&(n.modules.toolbar.container=HX),super(t,n),this.quill.container.classList.add("ql-snow")}extendToolbar(t){t.container!=null&&(t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),ha),this.buildPickers(t.container.querySelectorAll("select"),ha),this.tooltip=new Qx(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(n,s)=>{t.handlers.link.call(t,!s.format.link)}))}};zm.DEFAULTS=Ui({},go.DEFAULTS,{modules:{toolbar:{handlers:{link(e){if(e){let t=this.quill.getSelection();if(t==null||t.length===0)return;let n=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(n)&&n.indexOf("mailto:")!==0&&(n=`mailto:${n}`);let{tooltip:s}=this.quill.theme;s.edit("link",n)}else this.quill.format("link",!1,ve.sources.USER)}}}}});I5=zm});var N5={};qn(N5,{AttributeMap:()=>Os.AttributeMap,Delta:()=>Os.default,Module:()=>gn,Op:()=>Os.Op,OpIterator:()=>Os.OpIterator,Parchment:()=>zc,Range:()=>fi,default:()=>WX});var WX,T5=R(()=>{Nx();ux();px();VM();WM();XM();ZM();dx();Sm();_x();vx();Dm();KM();Lh();e5();n5();s5();o5();c5();h5();Em();f5();_5();x5();qm();kh();zx();Hx();Yx();C5();L5();Nx();Fm.register({"attributors/attribute/direction":Cm,"attributors/class/align":cx,"attributors/class/background":wM,"attributors/class/color":xM,"attributors/class/direction":fx,"attributors/class/font":mx,"attributors/class/size":yx,"attributors/style/align":wm,"attributors/style/background":Sh,"attributors/style/color":wh,"attributors/style/direction":Im,"attributors/style/font":Lm,"attributors/style/size":Nm},!0);Fm.register({"formats/align":cx,"formats/direction":fx,"formats/indent":zM,"formats/background":Sh,"formats/color":wh,"formats/font":mx,"formats/size":yx,"formats/blockquote":HM,"formats/code-block":Dn,"formats/header":YM,"formats/list":da,"formats/bold":eu,"formats/code":Jc,"formats/italic":QM,"formats/link":fo,"formats/script":JM,"formats/strike":t5,"formats/underline":i5,"formats/formula":r5,"formats/image":l5,"formats/video":d5,"modules/syntax":Th,"modules/table":m5,"modules/toolbar":tu,"themes/bubble":Mh,"themes/snow":I5,"ui/icons":ha,"ui/picker":fa,"ui/icon-picker":Bm,"ui/color-picker":$m,"ui/tooltip":Um},!0);WX=Fm});function iZ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="InputTextHtml.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Kx(){let e=Kx.styles||(Kx.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var YX,XX,ZX,QX,KX,JX,eZ,tZ,nZ,sZ,k5,R5=R(()=>{YX=ti(),XX=(T5(),kn(N5)).default,ZX={name:"input-html",mixins:[YX],methods:{setupTableCustomTools(){let e=this.$el.querySelector(".ql-column-left");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-left-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M10.205 12.456A.5.5 0 0 0 10.5 12V4a.5.5 0 0 0-.832-.374l-4.5 4a.5.5 0 0 0 0 .748l4.5 4a.5.5 0 0 0 .537.082z"/></svg>',e.title="Add column left";let t=this.$el.querySelector(".ql-column-right");t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M5.795 12.456A.5.5 0 0 1 5.5 12V4a.5.5 0 0 1 .832-.374l4.5 4a.5.5 0 0 1 0 .748l-4.5 4a.5.5 0 0 1-.537.082z"/></svg>',t.title="Add column right";let n=this.$el.querySelector(".ql-column-remove");n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></svg>',n.title="Remove column";let s=this.$el.querySelector(".ql-row-above");s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-up-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M3.544 10.705A.5.5 0 0 0 4 11h8a.5.5 0 0 0 .374-.832l-4-4.5a.5.5 0 0 0-.748 0l-4 4.5a.5.5 0 0 0-.082.537z"/></svg>',s.title="Add row above";let o=this.$el.querySelector(".ql-row-below");o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16"><path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/></svg>',o.title="Add row below";let l=this.$el.querySelector(".ql-row-remove");l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/></svg>',l.title="Remove row"}},created(){this.edit_state={edit:!1,show_html:!1},this.state.edit_states||(this.state.edit_states=[]),this.state.edit_states.push(this.edit_state)},async mounted(){let e=[[{header:[1,2,3,4,5,6,!1]}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}],[{color:[]},{background:[]}],["bold","italic","underline",{list:"ordered"},{list:"bullet"},"link","clean","html"],["table","column-left","column-right","column-remove","row-above","row-below","row-remove"]];await this.$nextTick(),this.quill=new XX(this.$refs.quill_editor,{modules:{table:!0,toolbar:{container:e,handlers:{html:()=>{this.edit_state.show_html=!this.edit_state.show_html,this.edit_state.show_html?this.quill.container.firstChild.innerText=this.quill.container.firstChild.innerHTML:this.quill.container.firstChild.innerHTML=this.quill.container.firstChild.innerText;for(let t of this.$el.querySelectorAll(".ql-formats"))for(let n of t.children)n.classList.contains("ql-html")?n.classList.toggle("skin-color"):n.classList.toggle("g3w-disabled")},"column-left":()=>this.table.insertColumnLeft(),"column-right":()=>this.table.insertColumnRight(),"column-remove":()=>this.table.deleteColumn(),"row-above":()=>this.table.insertRowAbove(),"row-below":()=>this.table.insertRowBelow(),"row-remove":()=>this.table.deleteRow()}}},theme:"snow"}),this.quill.container.firstChild.innerHTML=this.state.value,this.table=this.quill.getModule("table"),this.setupTableCustomTools(),this.handler=()=>{this.state.value=this.edit_state.show_html?this.quill.container.firstChild.innerText:this.quill.container.firstChild.innerHTML,this.edit_state.edit=!0,this.change(),setTimeout(()=>this.edit_state.edit=!1)},this.quill.on("text-change",this.handler)},watch:{"state.value"(e){this.edit_state.edit||(this.edit_state.show_html?this.quill.container.firstChild.innerText=e:this.quill.container.firstChild.innerHTML=e)}},beforeDestroy(){this.quill.off("text-change",this.handler),this.handler=null,this.quill=null,this.edit_state.edit=!1,this.edit_state.show_html=!1}},QX=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],attrs:{state:e.state}},[n("div",{ref:"quill_editor",staticClass:"form-control",style:{border:e.state.validate.valid?"1px solid #ccc":"1px solid reed"},attrs:{slot:"body"},on:{keydown:function(s){s.stopPropagation()}},slot:"body"})])},KX=[],JX=function(e){e&&e("data-v-28f953fd_0",{source:'button.ql-html{width:40px!important}button.ql-html:after{content:"html"}',map:void 0,media:void 0})},eZ=void 0,tZ=void 0,nZ=!1;sZ=iZ({render:QX,staticRenderFns:KX},JX,ZX,eZ,nZ,tZ,!1,Kx,void 0,void 0),k5=sZ});var Jx=He((zIe,M5)=>{R5();var rZ=Vue.extend(k5);M5.exports=rZ});function pZ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="InputTextArea.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function e1(){let e=e1.styles||(e1.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var oZ,aZ,lZ,cZ,uZ,dZ,hZ,fZ,gZ,A5,O5=R(()=>{oZ=ti(),aZ={name:"input-textarea",mixins:[oZ]},lZ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("textarea",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],class:{"input-error-validation":e.notvalid},staticStyle:{"max-width":"100%","min-width":"100%"},attrs:{slot:"body",placeholder:e.state.default,rows:"3",tabIndex:e.tabIndex},domProps:{value:e.state.value},on:{keydown:function(s){s.stopPropagation()},input:[function(s){s.target.composing||e.$set(e.state,"value",s.target.value)},e.change],change:e.change},slot:"body"})])},cZ=[],uZ=function(e){e&&e("data-v-bb33858e_0",{source:"textarea[data-v-bb33858e]{resize:none;border:1px solid #ccc}",map:void 0,media:void 0})},dZ="data-v-bb33858e",hZ=void 0,fZ=!1;gZ=pZ({render:lZ,staticRenderFns:cZ},uZ,aZ,dZ,fZ,hZ,!1,e1,void 0,void 0),A5=gZ});var t1=He((WIe,P5)=>{O5();var mZ=Vue.extend(A5);P5.exports=mZ});function CZ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputInteger.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var _Z,yZ,vZ,bZ,xZ,wZ,SZ,EZ,IZ,F5,D5=R(()=>{_Z=ti(),yZ={name:"input-integer",mixins:[_Z]},vZ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",placeholder:e.state.default,tabIndex:e.tabIndex,type:"number"},domProps:{value:e.state.value},on:{change:e.change,input:[function(s){s.target.composing||e.$set(e.state,"value",s.target.value)},e.change]},slot:"body"})])},bZ=[],xZ=void 0,wZ=void 0,SZ=void 0,EZ=!1;IZ=CZ({render:vZ,staticRenderFns:bZ},xZ,yZ,wZ,EZ,SZ,!1,void 0,void 0,void 0),F5=IZ});var n1=He((ZIe,G5)=>{D5();var LZ=Vue.extend(F5);G5.exports=LZ});function FZ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputFloat.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var NZ,TZ,kZ,RZ,MZ,AZ,OZ,PZ,DZ,j5,q5=R(()=>{NZ=ti(),TZ={name:"input-float",mixins:[NZ]},kZ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",tabIndex:e.tabIndex,type:"number",step:e.state.step||1,placeholder:e.state.default},domProps:{value:e.state.value},on:{change:e.change,input:[function(s){s.target.composing||e.$set(e.state,"value",s.target.value)},e.change]},slot:"body"})])},RZ=[],MZ=void 0,AZ=void 0,OZ=void 0,PZ=!1;DZ=FZ({render:kZ,staticRenderFns:RZ},MZ,TZ,AZ,PZ,OZ,!1,void 0,void 0,void 0),j5=DZ});var i1=He((JIe,$5)=>{q5();var GZ=Vue.extend(j5);$5.exports=GZ});function WZ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputRadio.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var jZ,qZ,$Z,BZ,UZ,zZ,VZ,HZ,YZ,B5,U5=R(()=>{Wt();jZ=ti(),qZ={name:"input-radio",mixins:[jZ],data(){return{ids:[Qe(),Qe()],name:`name_${Qe()}`,radio_value:this.state.value}},watch:{radio_value(){this.state.value=this.radio_value,this.change()}}},$Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("div",{attrs:{slot:"body"},slot:"body"},e._l(e.state.input.options.values,function(s,o){return n("span",{key:s.key},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.radio_value,expression:"radio_value"}],class:{"input-error-validation":e.notvalid},attrs:{id:e.ids[o],name:e.name,tabIndex:e.tabIndex,type:"radio"},domProps:{value:s.value,checked:e._q(e.radio_value,s.value)},on:{change:function(l){e.radio_value=s.value}}}),e._v(" "),n("label",{attrs:{for:e.ids[o]}},[e._v(e._s(s.key))])])}),0)])},BZ=[],UZ=void 0,zZ=void 0,VZ=void 0,HZ=!1;YZ=WZ({render:$Z,staticRenderFns:BZ},UZ,qZ,zZ,HZ,VZ,!1,void 0,void 0,void 0),B5=YZ});var s1=He((iLe,z5)=>{U5();var XZ=Vue.extend(B5);z5.exports=XZ});function sQ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputCheckbox.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var ZZ,QZ,KZ,JZ,eQ,tQ,nQ,iQ,rQ,V5,H5=R(()=>{Wt();ZZ=ti(),QZ={name:"input-checkbox",mixins:[ZZ],data(){return{value:null,label:null,id:Qe(),changed:!1}},watch:{"state.value"(e){this.changed?this.changed=!1:this.stateValueChanged(e)}},methods:{getValuesItem(e=!1){return this.service.state.input.options.values.find(t=>!!e===t.checked)||{}},convertValueToChecked(){if([null,void 0].includes(this.service.state.value))return!1;let e=this.service.state.input.options.values.find(t=>this.service.state.value==t.value);return e===void 0&&(e=this.service.state.input.options.values.find(t=>t.checked===!1),this.service.state.value=e.value),e.checked},changeCheckBox(){let{value:e,label:t}=this.getValuesItem(this.value);this.label=t,this.state.value=e,this.changed=!0,this.change()},stateValueChanged(){this.value=this.convertValueToChecked();let{value:e,label:t}=this.getValuesItem(this.value);this.label=t,this.state.value=e}},mounted(){this.stateValueChanged()}},KZ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticStyle:{height:"20px","margin-top":"8px"},attrs:{slot:"body"},slot:"body"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:{"input-error-validation":e.notvalid},attrs:{tabIndex:e.tabIndex,type:"checkbox",id:e.id},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{change:[function(s){var o=e.value,l=s.target,a=!!l.checked;if(Array.isArray(o)){var u=null,h=e._i(o,u);l.checked?h<0&&(e.value=o.concat([u])):h>-1&&(e.value=o.slice(0,h).concat(o.slice(h+1)))}else e.value=a},e.changeCheckBox]}}),e._v(" "),n("label",{attrs:{for:e.id}},[e._v(e._s(e.label))])])])},JZ=[],eQ=void 0,tQ=void 0,nQ=void 0,iQ=!1;rQ=sQ({render:KZ,staticRenderFns:JZ},eQ,QZ,tQ,iQ,nQ,!1,void 0,void 0,void 0),V5=rQ});var r1=He((aLe,W5)=>{H5();var oQ=Vue.extend(V5);W5.exports=oQ});function gQ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputRange.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var aQ,lQ,cQ,uQ,dQ,hQ,fQ,pQ,mQ,Y5,X5=R(()=>{aQ=ti(),lQ={name:"input-range",mixins:[aQ],data(){let{min:e,max:t,Step:n}=this.state.input.options.values[0];return{min:e,max:t,step:n}},methods:{checkValue(){let e=this.state.value===null||`${this.state.value}`.trim()==="";e&&!this.state.validate.required&&(this.state.value=this.state.input.options.values[0].default),this.state.validate.valid=!this.state.validate.required,e||(this.state.validate.valid=this.service.getValidator().validate(this.state.value)),this.change()}}},cQ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:e.tabIndex,type:"number",step:e.step},domProps:{value:e.state.value},on:{keydown:[function(s){if(!s.type.indexOf("key")&&s.keyCode!==69)return null;s.preventDefault()},function(s){if(!s.type.indexOf("key")&&s.keyCode!==13)return null;s.stopPropagation()}],change:e.checkValue,blur:e.checkValue,input:function(s){s.target.composing||e.$set(e.state,"value",s.target.value)}},slot:"body"})])},uQ=[],dQ=void 0,hQ=void 0,fQ=void 0,pQ=!1;mQ=gQ({render:cQ,staticRenderFns:uQ},dQ,lQ,hQ,pQ,fQ,!1,void 0,void 0,void 0),Y5=mQ});var o1=He((uLe,Z5)=>{X5();var _Q=Vue.extend(Y5);Z5.exports=_Q});function IQ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputDateTimePicker.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var yQ,vQ,bQ,xQ,wQ,SQ,EQ,CQ,LQ,Q5,K5=R(()=>{Ke();us();Wt();yQ=ti(),vQ={name:"input-datetime-picker",mixins:[yQ,_r],data(){let e=Qe();return{widget_container:{top:0,left:0},iddatetimepicker:"datetimepicker_"+e,idinputdatetimepiker:"inputdatetimepicker_"+e}},methods:{resize(){let e=$(`#${this.iddatetimepicker}`);e&&e.data("DateTimePicker")&&e.data("DateTimePicker").hide()},timeOnly(){return!this.state.input.options.formats[0].date},onDatePickerChange(){let e=$(`#${this.idinputdatetimepiker}`).val();this.state.value=e.trim()===""?null:moment(e,this.datetimedisplayformat).format(this.datetimefieldformat),this.change()},onDatePickerShow(e){this.widget_container.top=0,this.widget_container.left=0,setTimeout(()=>{let t=this.$refs.datetimepicker_body.getBoundingClientRect(),n=this.$refs.datimewidget_container.querySelector(".bootstrap-datetimepicker-widget").getBoundingClientRect();this.widget_container.top=t.top+(t.top<n.height?t.height+Math.abs(t.top-n.height)+20:0),this.widget_container.left=t.left-Math.max(t.width,n.width),this.$emit("datetimepickershow")})},onDatePickerHide(e){this.$emit("datetimepickershow")}},watch:{async"state.value"(e){if(e!==$(`#${this.idinputdatetimepiker}`).val()){let t=e!==null?moment(e,this.datetimefieldformat).format(this.datetimedisplayformat):e;await this.$nextTick(),$(`#${this.idinputdatetimepiker}`).val(t)}}},async mounted(){let{formats:e=[],layout:t={vertical:"top",horizontal:"left"}}=this.state.input.options,{minDate:n,maxDate:s,fieldformat:o,enabledDates:l,disabledDates:a,displayformat:u,useCurrent:h}=e[0];await this.$nextTick(),this.datetimedisplayformat=this.service.convertQGISDateTimeFormatToMoment(u),this.datetimefieldformat=this.service.convertQGISDateTimeFormatToMoment(o),this.service.setValidatorOptions({fielddatetimeformat:this.datetimefieldformat});let p=moment(this.state.value,this.datetimefieldformat,!0).isValid()?moment(this.state.value,this.datetimefieldformat).toDate():null;$(`#${this.iddatetimepicker}`).datetimepicker({defaultDate:p,format:this.datetimedisplayformat,ignoreReadonly:!0,allowInputToggle:!0,enabledDates:l,disabledDates:a,useCurrent:h,toolbarPlacement:"top",minDate:n,maxDate:s,widgetParent:$(this.$refs.datimewidget_container),widgetPositioning:{vertical:t.vertical||"top",horizontal:t.horizontal||"left"},showClose:!0,locale:this.service.getLocale()}),$(`#${this.iddatetimepicker}`).on("dp.change",this.onDatePickerChange),$(`#${this.iddatetimepicker}`).on("dp.show",this.onDatePickerShow),$(`#${this.iddatetimepicker}`).on("dp.hide",this.onDatePickerHide),F.ismobile&&setTimeout(()=>{$(`#${this.idinputdatetimepiker}`).blur()})}},bQ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("div",{ref:"datetimepicker_body",attrs:{slot:"body"},slot:"body"},[n("div",{ref:"datimewidget_container",style:{top:e.widget_container.top+"px",left:e.widget_container.left+"px",position:"fixed",zIndex:1e4}}),e._v(" "),n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"input-group date",attrs:{id:e.iddatetimepicker}},[n("input",{staticClass:"form-control",class:{"input-error-validation":e.notvalid},attrs:{type:"text",id:e.idinputdatetimepiker,tabIndex:e.tabIndex,readonly:!e.editable||e.isMobile()?"readonly":null}}),e._v(" "),n("span",{staticClass:"input-group-addon caret"},[n("span",{class:[e.g3wtemplate.getFontClass(e.timeOnly()?"time":"calendar")]})])])])])},xQ=[],wQ=void 0,SQ=void 0,EQ=void 0,CQ=!1;LQ=IQ({render:bQ,staticRenderFns:xQ},wQ,vQ,SQ,CQ,EQ,!1,void 0,void 0,void 0),Q5=LQ});var a1=He((mLe,J5)=>{K5();var NQ=Vue.extend(Q5);J5.exports=NQ});function DQ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputUnique.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var TQ,kQ,RQ,MQ,AQ,OQ,PQ,FQ,GQ,eA,tA=R(()=>{us();Wt();TQ=ti(),kQ={name:"input-unique",mixins:[TQ,gc],data(){return{id:`unique_${Qe()}`}},async mounted(){await this.$nextTick(),this.select2=$(`#${this.id}`).select2({dropdownParent:$("#g3w-view-content"),tags:this.state.input.options.editable,language:this.getLanguage()}),this.state.value!==null&&this.select2.val(this.state.value).trigger("change"),this.select2.on("select2:select",async e=>{let t=e.params.data.$value?e.params.data.$value:e.params.data.id;this.state.value=t==="null"?null:["integer","float","bigint"].includes(this.state.type)?Number(t):t,this.changeSelect(this.state.value),await this.$nextTick()})}},RQ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],attrs:{state:e.state}},[n("select",{staticClass:"form-control",staticStyle:{width:"100%"},attrs:{slot:"body",id:e.id,tabIndex:e.tabIndex},slot:"body"},[n("option",{attrs:{value:"null"}}),e._v(" "),e._l(e.state.input.options.values,function(s){return n("option",{key:s,domProps:{value:e.getValue(s)}},[e._v(e._s(e.getValue(s)))])})],2)])},MQ=[],AQ=void 0,OQ=void 0,PQ=void 0,FQ=!1;GQ=DQ({render:RQ,staticRenderFns:MQ},AQ,kQ,OQ,FQ,PQ,!1,void 0,void 0,void 0),eA=GQ});var l1=He((xLe,nA)=>{tA();var jQ=Vue.extend(eA);nA.exports=jQ});var pa,c1=R(()=>{pa=class extends ol.interaction.Pointer{constructor(t={}){super({handleDownEvent(s){return this.pickedFeature_=this.featuresAtPixel_(s.pixel,s.map),this.pickedFeature_},handleUpEvent(s){return this.pickedFeature_&&this.dispatchEvent({type:"picked",feature:this.pickedFeature_,coordinate:s.coordinate,layer:this.pickedLayer_}),!0},handleMoveEvent(s){s.map.getTargetElement().style.cursor=this.featuresAtPixel_(s.pixel,s.map)?"pointer":""},...t});let{features:n}=t;this.features_=Array.isArray(n)&&n.length>0?n:null,this.layers_=t.layers||null,this.pickedFeature_=null,this.pickedLayer_=null}layerFilter_(t){let n=(this.layers_||[]).includes(t);return this.pickedLayer_=n&&t,n}featuresAtPixel_(t,n){let s=null,o=n.forEachFeatureAtPixel(t,l=>this.features_?this.features_.includes(l)?l:null:l,{layerFilter:this.layerFilter_.bind(this),hitTolerance:isMobile&&isMobile.any?10:0});return o&&(s=o),s}shouldStopEvent(){return!1}setMap(t){t||(this.getMap().getTargetElement().style.cursor=""),super.setMap(t)}}});var gi,_l=R(()=>{gi=class extends ol.interaction.Pointer{constructor(t={}){super({handleDownEvent(n){return this._centerMap=n.map.getView().getCenter(),setTimeout(()=>{this._centerMap===n.map.getView().getCenter()&&this.handleUpEvent(n)},300),!1},handleUpEvent(n){return this.dispatchEvent({type:"picked",coordinate:n.coordinate}),!1},handleMoveEvent(n){return n.map.getViewport().classList.add(this._cursor),!0},...t}),this._cursor=t.cursor||"ol-pointer",this._centerMap=null}shouldStopEvent(){return!1}setActive(t){let n=this.getMap();n&&n.getViewport().classList.remove(this._cursor),super.setActive(t)}setMap(t){t||this.getMap().getViewport().classList.remove(this._cursor),super.setMap(t)}}});var u1=He((TLe,iA)=>{ze();ei();c1();_l();iA.exports=class{constructor(t={}){this.pick_type=t.pick_type||"wms",this.ispicked=!1,this.fields=t.fields||[t.value],this.layerId=t.layer_id,this.mapService=T.getService("map"),this.interaction=this.pick_type==="map"?new pa({layers:[this.mapService.getLayerById(this.layerId)]}):new gi,this.interaction.set("id","picklayer")}isPicked(){return this.ispicked}escKeyUpHandler({keyCode:t,data:{owner:n}}){t===27&&n.unpick()}unbindEscKeyUp(){$(document).unbind("keyup",this.escKeyUpHandler)}bindEscKeyUp(){$(document).on("keyup",{owner:this},this.escKeyUpHandler)}pick(){return new Promise((t,n)=>{this.bindEscKeyUp();let s={};this.ispicked=!0;let o=l=>{if(l){let a=l.getProperties();this.fields.filter(u=>u).forEach(u=>s[u]=a[u]),t(s)}else n();this.ispicked=!1,this.unpick()};T.setModal(!1),this.mapService.addInteraction(this.interaction),this.interaction.once("picked",l=>{if(this.pick_type==="map"){let a=l.feature;o(a)}else if(this.pick_type==="wms"){let a=T.getService("map").getProjectLayer(this.layerId);a&&gt.getQueryLayersPromisesByCoordinates([a],{map:this.mapService.getMap(),feature_count:1,coordinates:l.coordinate}).then(u=>{let{data:h=[]}=u[0],p=h.length&&h[0].features[0]||null;o(p)}).fail(u=>console.warn(u))}})})}unpick(){this.mapService.removeInteraction(this.interaction),T.setModal(!0),this.unbindEscKeyUp(),this.ispicked=!1}clear(){this.isPicked()&&this.unpick(),this.mapService=this.interaction=this.field=null}}});function XQ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="FieldG3W.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var qQ,$Q,BQ,UQ,zQ,VQ,HQ,WQ,YQ,ZQ,Vm,d1=R(()=>{qQ=Ud(),$Q=pc(),BQ={name:"g3w-field",props:{state:{required:!0},feature:{type:Object}},components:{...$Q},created(){this.type=qQ.getType(this.state)}},UQ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.type,{tag:"component",attrs:{feature:e.feature,state:e.state}})},zQ=[],VQ=void 0,HQ=void 0,WQ=void 0,YQ=!1;ZQ=XQ({render:UQ,staticRenderFns:zQ},VQ,BQ,HQ,YQ,WQ,!1,void 0,void 0,void 0),Vm=ZQ});function sA(e){return new(Object.entries({MultiPolygon:ol.geom.MultiPolygon,MultiLine:ol.geom.MultiLineString,MultiPoint:ol.geom.MultiPoint,Polygon:ol.geom.Polygon,Line:ol.geom.LineString,Point:ol.geom.Point,"":ol.geom.Point}).find(t=>e.type.startsWith(t[0])))[1](e.coordinates)}function h1(e){return{id:e.id,feature:{attributes:e.attributes||e.properties,geometry:e.geometry?sA(e.geometry):e.geometry}}}function sK(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Table.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function f1(){let e=f1.styles||(f1.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var QQ,KQ,JQ,eK,tK,nK,iK,rK,rA,oA=R(()=>{ft();Ws();Ke();d1();ze();ei();Us();$i();Xt();Rt();QQ={name:"G3WTable",components:{Field:Vm},data(){let e=De(this.$options.layerId);return{layer:e,state:{features:[],headers:[null,...e.getTableHeaders()],geometry:!0,allfeatures:0,selectAll:!1,nofilteredrow:!1,show_tools:!1,geolayer:{active:!1,in_bbox:void 0}},relations:(e.isGeoLayer()?[]:e.getRelations().getArray()).map(t=>[t,De(t.getFather())]).filter(([t,n])=>e.getId()!==t.getFather()&&n.isGeoLayer()).map(([t,n])=>({layer:n,father_fields:t.getFatherField(),fields:t.getChildField(),features:{}})),filter:[],has_map:!0,async_highlight:()=>{},getAll:!1,search:{},firstCall:!0,map_bbox:{key:null,cb:null},disableSelectAll:!1}},computed:{show_on_active_filter(){return!this.layer.state.filter.pagination&&(this.layer.state.filter.active||!this.layer.state.selectionFids.has("__ALL__"))},current_layout(){return F.gui.layout[F.gui.layout.__current]}},methods:{toggleFilterToken(e){e.state.filter.active&&!e.state.selectionFids.has("__ALL__")&&(this.state.selectAll=!1),e.toggleFilterToken()},editFeature(e){$(".tooltip").remove(),T.getService("queryresults").editFeature({layer:{id:this.layer.getId()},feature:e})},async openForm(e){$(".tooltip").remove();try{await Ot(gt.getData("search:fids",{inputs:{layer:this.layer,fids:[e.id],formatter:1}})),e.geometry&&T.getService("map").zoomToGeometry(sA(e.geometry))}catch(t){console.warn(t)}},async getDataFromBBOX(){let e=T.getService("map");this.state.geolayer.active=!this.state.geolayer.active;let t=this.state.geolayer.active;t&&(this.map_bbox.cb=()=>{this.state.geolayer.in_bbox=this.state.geolayer.active?e.getMapBBOX().join(","):void 0,$(this.$refs.attribute_table).DataTable().ajax.reload()}),t&&(this.map_bbox.key=e.getMap().on("moveend",this.map_bbox.cb)),this.map_bbox.cb&&this.map_bbox.cb(),t||(ol.Observable.unByKey(this.map_bbox.key),this.map_bbox.key=null,this.map_bbox.cb=null)},async inverseSelection(){this.getAll||await this.getFeatures(),this.state.features.forEach(e=>e.selected=!e.selected),this.layer.invertSelectionFids(),this.state.selectAll=this.layer.getSelectionFids().has(Rn.ALL)||this.state.features.every(e=>e.selected)},async selectAllRows(){this.state.selectAll=!this.state.selectAll,await this.$nextTick();let e=this.filter.length>0;!e&&this.state.selectAll&&!this.getAll&&await this.getFeatures(),e||(this.state.features.forEach(t=>t.selected=this.state.selectAll),await this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"]()),e&&this.state.selectAll&&this.state.allfeatures>this.state.featurescount&&(await this.layer.clearSelectionFids(),this.state.selectAll=!0,this.state.features.splice(0),await this.$nextTick(),(await this.getFeatures({field:this.search.field})||[]).forEach(t=>{let n=this.layer.isGeoLayer()&&t.geometry||void 0;t.selected=this.state.selectAll,n&&this.layer.addOlSelectionFeature(h1(t)),this.layer.includeSelectionFid(t.id),this.state.features.push({id:t.id,selected:t.selected,attributes:t.attributes||t.properties,geometry:n})})),e&&this.state.selectAll&&this.state.allfeatures<=this.state.featurescount&&this.state.features.filter(t=>this.filter.includes(t.id)).forEach(t=>{t.selected=!0,this.layer.includeSelectionFid(t.id)}),e&&!this.state.selectAll&&(this.state.features.forEach(t=>t.selected=!1),await this.layer.clearSelectionFids()),this.state.show_tools=this.state.features.some(t=>t.selected)},async highlight(e,t=!0){let n=T.getService("map");if(!e||!e.geometry)return n.clearHighlightGeometry();if(this.async_highlight=()=>{n.clearHighlightGeometry(),n.highlightGeometry(e.geometry,{zoom:t,duration:1/0})},e.geometry&&this.has_map)return this.async_highlight();if(e.geometry||!e.geometry&&!this.relations.length>0)return;let s=[],o=[];(await Promise.allSettled(this.relations.flatMap(({layer:l,father_fields:a,fields:u})=>{let h=u.map(p=>e.attributes[p]);return o.push(h),t?gt.getData("search:features",{inputs:{layer:l,formatter:1,filter:a.map((p,d)=>`${p}|eq|${encodeURIComponent(h[d])}`).join("|AND,")},outputs:!1}):[]}))).forEach((l,a)=>{if(l.status==="fulfilled"){let u=this.relations[a],h=o[a].join("__"),p=l.value&&l.value.data[0];u.features[h]===void 0&&(u.features[h]=p&&p.features||[]),s.push(...u.features[h])}t?n.zoomToFeatures(s,{highlight:!0}):n.highlightFeatures(s)})},select(e){e.selected=!e.selected,this.state.selectAll=this.state.features.every(t=>t.selected),this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),this.state.show_tools=this.layer.getSelectionFids().size>0},async resize(){await this.$nextTick();let e=this.$el.querySelector("div.dataTables_scrollBody");e&&(e.style.height=T.isMobile()?"100%":F.viewport.content.sizes.height-(this.$el.querySelector("div.dataTables_scrollHeadInner")?.clientHeight||0)-100+"px"),$(this.$refs.attribute_table).DataTable().columns.adjust()},async getFeatures(e){try{T.disableContent(!0),T.setLoadingContent(!0);let t=await Ot(this.layer.getDataTable(e||{})),n=this.layer.isGeoLayer()&&t.features;if(n&&!e){let s=this.state.features.map(o=>o.id);t.features.filter(o=>o.geometry&&!s.includes(o.id)).forEach(o=>this.layer.addOlSelectionFeature(h1(o))),this.getAll=!0}if(n)return t.features}catch(t){return console.warn(t),Promise.reject()}finally{T.setLoadingContent(!1),T.disableContent(!1)}},async getData({start:e=0,order:t=[],length:n=this.layer.getAttributeTablePageLength()||Bs[1],columns:s=[],search:o={value:null}}={}){if(T.setLoadingContent(!0),T.disableContent(!0),this.layer.setAttributeTablePageLength(n),this.state.headers.length===0)return{data:[],recordsTotal:0,recordsFiltered:0};this.state.features.splice(0),await this.$nextTick(),t.length===0&&t.push({column:1,dir:"asc"}),this.search={field:s.filter(l=>l.search&&l.search.value).map((l,a,u)=>`${l.name}|ilike|${l.search.value}${a<u.length-1?"|AND":""}`).join(",")||void 0,page:e===0||this.layer.state.filter.active?1:e/n+1,page_size:n,search:o.value&&o.value.length>0?o.value:null,in_bbox:this.state.geolayer.in_bbox,ordering:(t[0].dir==="asc"?"":"-")+this.state.headers[t[0].column].name,formatter:1};try{let l=await Ot(this.layer.getDataTable(this.search));return this.state.allfeatures=l.count,this.state.featurescount=(l.features||[]).length,this.state.features.push(...(l.features||[]).map(a=>{let u=this.layer.isGeoLayer()&&a.geometry;return u&&!this.layer.getOlSelectionFeature(a.id)&&(a.selected=this.state.selectAll,this.layer.addOlSelectionFeature(h1(a)),a.selected&&this.layer.includeSelectionFid(a.id)),u&&this.layer.getOlSelectionFeature(a.id)&&(a.selected=!0),{id:a.id,selected:this.layer.getFilterToken()||this.layer.hasSelectionFid(a.id),attributes:a.attributes||a.properties,geometry:this.layer.isGeoLayer()&&a.geometry||void 0}})),this.state.show_tools=this.layer.state.filter.active||this.layer.getSelectionFids().size>0,this.state.selectAll=this.layer.state.filter.active||this.state.selectAll&&this.state.features.every(a=>a.selected),{data:this.state.features.map(a=>[null].concat(this.state.headers.filter(u=>u).map(u=>(u.value=(a.attributes||a.properties)[u.name],u.value)))),recordsFiltered:l.count,recordsTotal:l.count,filter:this.state.features.map(a=>a.id)}}catch(l){return console.warn(l),T.notify.error(_e("info.server_error")),Promise.reject(l)}finally{T.setLoadingContent(!1),T.disableContent(!1)}},unSelectAll(){this.state.features.forEach(e=>e.selected=!1),this.state.show_tools=!1,this.state.selectAll=!1},onGUIContent(e={}){this.has_map=e.perc!==100},filterChangeHandler(){$(this.$refs.attribute_table).DataTable().ajax.reload()}},async created(){T.on("resize",this.resize),this.currentFilter=null,this.unSelectAll=this.unSelectAll.bind(this),this.onGUIContent=this.onGUIContent.bind(this),T.onbefore("setContent",this.onGUIContent),this.layer.on("unselectionall",this.unSelectAll),this.layer.on("filtertokenchange",this.filterChangeHandler),T.closeSideBar(),T.showContent({content:new pt({id:"openattributetable",service:{state:this.state},internalComponent:this}),split:T.isMobile()?"h":"v",push:!1,title:this.layer.getTitle(),text:!0}),this.isMobile()&&T.hideSidebar()},async mounted(){this.last_map_control=T.getService("map").getMapControls().find(o=>o.control.isToggled&&o.control.isToggled()),this.last_map_control&&this.last_map_control.control.toggle(),await this.$nextTick();let e,t={},n=$(this.$refs.attribute_table).DataTable({ajax:un(async(o,l)=>{T.disableContent(!0);try{let a=await this.getData(o);l(a),this.disableSelectAll=this.state.features.length===0,e&&e(a.filter),await this.$nextTick(),n.columns.adjust()}catch(a){console.warn(a)}this.resize()},800),bSortCellsTop:!0,columns:this.state.headers,columnDefs:[{orderable:!1,searchable:!1,targets:0,width:"1%"}],deferLoading:this.state.allfeatures,dom:'frt<"#g3w-table-toolbar">lip',lengthMenu:Bs,order:[1,"asc"],pageLength:this.layer.getAttributeTablePageLength()||Bs[1],processing:!1,responsive:!0,scrollCollapse:!0,scrollX:!0,serverSide:!0,sSearch:!1});this.changeColumn=un(async(o,l)=>{let a=o.target.value.trim();n.one("draw",async()=>{t[l]=a,this.disableSelectAll=this.state.features.length===0,this.filter=Object.values(t).find(u=>u)?await new Promise(u=>e=u):[]}),n.columns(l).search(a).draw()});let s=document.createDocumentFragment();s.appendChild(this.$refs.table_toolbar),document.getElementById("g3w-table-toolbar").appendChild(s),document.querySelector("#g3w-view-content .g3-content-header-action-tools").insertAdjacentElement("beforebegin",document.querySelector(".dataTables_info")),document.querySelector("#g3w-view-content .g3-content-header-action-tools").insertAdjacentElement("beforebegin",document.querySelector(".dataTables_filter")),document.getElementById("table_body_attributes").remove(),n.ajax.reload()},async beforeDestroy(){this.last_map_control&&!this.last_map_control.control.isToggled()&&this.last_map_control.control.toggle(),this.last_map_control=null,this.layer.off("unselectionall",this.unSelectAll),this.layer.off("filtertokenchange",this.filterChangeHandler),ol.Observable.unByKey(this.map_bbox.key),this.map_bbox.key=null,this.map_bbox.cb=null,this.highlight(),this.has_map||setTimeout(()=>{this.async_highlight(),this.has_map=!0,this.async_highlight=()=>{}}),T.off("resize",this.resize),document.querySelector("#g3w-view-content .dataTables_info").remove(),document.querySelector("#g3w-view-content .dataTables_filter").remove(),$(this.$refs.attribute_table).DataTable().destroy(!0)}},KQ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"open_attribute_table"}},[n("div",{ref:"table_toolbar",staticStyle:{display:"flex","justify-content":"space-between",padding:"1px"}},[e.layer.isGeoLayer()?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.geolayer.active&&e.current_layout.rightpanel.height_100,expression:"state.geolayer.active && current_layout.rightpanel.height_100"},{name:"t-tooltip",rawName:"v-t-tooltip",value:"Update results when map moves",expression:"'Update results when map moves'"}],staticClass:"skin-color action-button",class:[e.$fa("map"),e.state.geolayer.active?"toggled":""],attrs:{"data-placement":"right"},on:{click:function(s){return s.stopPropagation(),e.getDataFromBBOX.apply(null,arguments)}}}):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.state.show_tools,expression:"state.show_tools"},{name:"t-tooltip",rawName:"v-t-tooltip",value:"Invert Selection",expression:"'Invert Selection'"}],staticClass:"skin-color action-button",class:e.$fa("clear"),attrs:{"data-placement":"right"},on:{click:function(s){return s.stopPropagation(),e.layer.clearSelectionFids()}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.state.show_tools,expression:"state.show_tools"},{name:"t-tooltip",rawName:"v-t-tooltip",value:"Invert Selection",expression:"'Invert Selection'"}],staticClass:"skin-color action-button",class:[e.$fa("invert"),e.layer.state.filter.active?"g3w-disabled":""],attrs:{"data-placement":"right"},on:{click:function(s){return s.stopPropagation(),e.inverseSelection.apply(null,arguments)}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.state.show_tools&&e.show_on_active_filter,expression:"state.show_tools && show_on_active_filter"},{name:"t-tooltip",rawName:"v-t-tooltip",value:"Enable/Disable filter",expression:"'Enable/Disable filter'"}],staticClass:"skin-color action-button",class:[e.$fa("filter"),e.layer.state.filter.active?"toggled":""],attrs:{"data-placement":"right"},on:{click:function(s){return s.stopPropagation(),e.toggleFilterToken(e.layer)}}})]),e._v(" "),e.state.headers.length?n("table",{ref:"attribute_table",staticClass:"table table-striped row-border compact nowrap",attrs:{id:"layer_attribute_table"}},[n("thead",[n("tr",[n("th"),e._v(" "),e._l(e.state.headers,function(s,o){return o>0?n("th",[e._v(e._s(s.label))]):e._e()})],2),e._v(" "),n("tr",[n("th",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableSelectAll,expression:"disableSelectAll"}]},[n("label",{on:{click:e.selectAllRows}},[n("input",{attrs:{type:"checkbox"},domProps:{checked:e.state.selectAll&&e.state.features.length>0}})])]),e._v(" "),e._l(e.state.headers,function(s,o){return o>0?n("th",[n("input",{staticClass:"form-control column-search",attrs:{type:"text",placeholder:s.name,title:"search by "+s.name},on:{keyup:function(l){return e.changeColumn(l,o)}}})]):e._e()})],2)]),e._v(" "),n("tbody",{attrs:{id:"table_body_attributes",hidden:""}}),e._v(" "),n("tbody",{ref:"table_body",on:{mouseleave:function(s){return e.highlight()}}},e._l(e.state.features,function(s,o){return n("tr",{key:s.id,class:[o%2==1?"odd":"pair","feature_attribute",{geometry:!!s.geometry},{selected:s.selected}],attrs:{role:"row"},on:{mouseover:function(l){return e.highlight(s,!1)},click:function(l){return l.stopPropagation(),e.highlight(s,!0)}}},[n("td",[n("div",{staticStyle:{display:"flex"}},[e.show_on_active_filter?n("label",{on:{click:function(l){return e.select(s)}}},[n("input",{attrs:{type:"checkbox"},domProps:{checked:s.selected}})]):e._e(),e._v(" "),n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"Form View",expression:"'Form View'",arg:"top"}],class:"action-button skin-color "+e.$fa("table"),on:{click:function(l){return l.stopPropagation(),e.openForm(s)}}}),e._v(" "),e.layer.state.geolayer&&!s.geometry?n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"This item has no geometry",expression:"'This item has no geometry'",arg:"top"}],class:"action-button "+e.$fa("alert"),staticStyle:{color:"currentColor !important"}}):e._e(),e._v(" "),e.layer.isEditable()&&e.layer.config.editing.visible?n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"Editing",expression:"'Editing'",arg:"top"}],class:"action-button skin-color "+e.$fa("pencil"),on:{click:function(l){return l.stopPropagation(),e.editFeature(s)}}}):e._e()])]),e._v(" "),e._l(e.state.headers,function(l,a){return a>0?n("td",[n("field",{attrs:{feature:s,state:{label:void 0,value:s.attributes[l.name]}}})],1):e._e()})],2)}),0)]):n("div",{directives:[{name:"t",rawName:"v-t",value:"No data",expression:"'No data'"}],attrs:{id:"noheaders"}})])},JQ=[],eK=function(e){e&&(e("data-v-0c4cdd25_0",{source:"#open_attribute_table{margin-top:5px}#g3w-table-toolbar{margin:.755em 1ch 0 0;position:relative;bottom:3px;display:inline-flex;border:1px solid #d2d6de;background-color:#fff;float:left}",map:void 0,media:void 0}),e("data-v-0c4cdd25_1",{source:".geometry[data-v-0c4cdd25]{cursor:pointer}#noheaders[data-v-0c4cdd25]{background-color:#fff;font-weight:700;margin-top:10px}input.form-control.column-search[data-v-0c4cdd25]::placeholder{font-weight:400;font-style:italic}input.form-control.column-search[data-v-0c4cdd25]{height:25px;min-width:40px;padding:2px}#open_attribute_table .action-button[data-v-0c4cdd25]{padding:5px}#g3w-table-toolbar .action-button[data-v-0c4cdd25]{padding:4px}#g3w-table-toolbar .action-button.toggled[data-v-0c4cdd25]{color:#fff!important;background-color:var(--skin-color)}#layer_attribute_table[data-v-0c4cdd25]{width:100%;user-select:none}#layer_attribute_table>tbody>tr[data-v-0c4cdd25]:not(.selected):hover{background-color:rgb(255,255,0,.15)}",map:void 0,media:void 0}),e("data-v-0c4cdd25_2",{source:"#g3w-view-content .dataTables_filter{margin-left:auto;margin-right:1ch}#g3w-view-content .dataTables_info{padding-left:.5ch;font-weight:lighter}#open_attribute_table .paginate_button{background:0 0;color:currentColor!important;box-shadow:none}#open_attribute_table .paginate_button.disabled{opacity:.25}#open_attribute_table #layer_attribute_table_length{padding-top:5px}",map:void 0,media:void 0}))},tK="data-v-0c4cdd25",nK=void 0,iK=!1;rK=sK({render:KQ,staticRenderFns:JQ},eK,QQ,tK,iK,nK,!1,f1,void 0,void 0),rA=rK});function Si(e,t="filename=g3w_file"){Object.assign(document.createElement("a"),{href:URL.createObjectURL(e),download:t.split("filename=").at(-1)}).click(),URL.revokeObjectURL(e)}var ga=R(()=>{});var Ye,ii=R(()=>{Ye={async get({url:e,params:t={},signal:n}={}){if(!e)return Promise.reject("No url");t=new URLSearchParams(JSON.parse(JSON.stringify(t||{}))).toString();let s=await(await fetch(e+(t?"?":"")+t,{signal:n})).text();try{return JSON.parse(s)}catch{return s}},async put({url:e,data:t,formdata:n=!1,contentType:s,signal:o}={}){n?(n=new FormData,Object.entries(t).forEach(([a,u])=>n.append(a,u))):s?n=typeof t=="string"?t:JSON.stringify(t||{}):n=new URLSearchParams(JSON.parse(JSON.stringify(t||{}))).toString();let l=await(await fetch(e,{method:"PUT",body:n,headers:{"Content-Type":s||"application/x-www-form-urlencoded"},signal:o})).text();try{return JSON.parse(l)}catch{return l}},async post({url:e,data:t,formdata:n=!1,contentType:s,signal:o}={}){n?(n=new FormData,Object.entries(t).forEach(([a,u])=>n.append(a,u))):s?n=typeof t=="string"?t:JSON.stringify(t||{}):n=new URLSearchParams(JSON.parse(JSON.stringify(t||{}))).toString();let l=await(await fetch(e,{method:"POST",body:n,headers:{"Content-Type":s||"application/x-www-form-urlencoded"},signal:o})).text();try{return JSON.parse(l)}catch{return l}}}});async function Hm({value:e,label:t,callback:n}){let s={value:e,id:Qe()},o=new Vue({template:`
      <div>
        <label :for="id">${t}</label>
        <input
          v-model      = "value"
          :id          = "id"
          class        = "bootbox-input bootbox-input-text form-control"
          autocomplete = "off"
          type         = "text"
        >
      </div>`,data(){return s}}),l;new Promise((a,u)=>{l=T.showModalDialog({message:o.$mount().$el,closeButton:!1,buttons:{ok:{label:"Ok",className:"btn-success",callback:()=>a(s.value)},cancel:{label:"Cancel",className:"btn-danger",callback:()=>u()}}});let h=l.find("button.btn-success");h.prop("disabled",s.value.trim().length===0),o.$watch("value",p=>{h.prop("disabled",p.trim().length===0)})}).then(n).catch(a=>console.warn(a)).finally(()=>{o.$destroy(),o=null,s=null,l=null})}var p1=R(()=>{ze();Wt()});function yl(e,t){return e.reduce((n,s)=>{let o=t(s);return n[o]||(n[o]=[]),n[o].push(s),n},{})}var Wm=R(()=>{});function Ah(e){return typeof e=="string"&&Number.isNaN(1*e)&&(e=e.split("."),e=e.at(e.length===2?1:0)),e}var g1=R(()=>{});function m1(e){return e.setCoordinates(aA(e.getCoordinates())),e}function aA(e){return e.find(t=>{if(!Array.isArray(t)){let[n,s]=e;return e[0]=s,e[1]=n,!0}aA(t)}),e}var lA=R(()=>{});var ps,Oh=R(()=>{ft();Wt();ps=class e extends ol.Feature{constructor(t={}){super(),this.state={new:!1,state:null,visible:!0},this._uid=Qe(),this._geometry=!1,t.feature&&t.properties&&Array.isArray(t.properties)?t.properties.forEach(o=>this.set(o,t.feature.get(o))):t.feature&&this.setProperties(t.feature.getProperties()),t.feature&&(this.setId(t.feature.getId()),this.setGeometryName(t.feature.getGeometryName()));let n=t.feature&&t.feature.getGeometry();n&&(this._geometry=!0,this.setGeometry(n));let s=this.getStyle();s&&this.setStyle(s)}getUid(){return this._uid}isGeometry(){return this._geometry}cloneNew(t){let n=this.clone();return n._uid=Qe(),n.setTemporaryId(),t&&t.editable===!1&&n.set(t.name,null),n}clone(){let t=super.clone();t.setId(this.getId()),this.isGeometry()&&t.setGeometry(t.getGeometry().clone());let n=new e({feature:t});return n._uid=this.getUid(),n.setState(this.getState()),this.isNew()&&n.setNew(),n}setTemporaryId(){this.setId(`_new_${Qe()}`),this.setNew()}setNew(){this.state.new=!0}delete(){return this.state.state="delete",this}update(){return this.state.state="update",this}add(){return this.state.state="add",this}isNew(){return this.state.new}isAdded(){return this.state.state==="add"}isUpdated(){return this.state.state==="update"}isDeleted(){return this.state.state==="delete"}setState(t){this.state.state=t}getState(){return this.state.state}getAlphanumericProperties(){return Object.entries(this.getProperties()).filter(([t,n])=>!zl.GEOMETRY_FIELDS.includes(t)).reduce((t,[n,s])=>(t[n]=s,t),{})}clearState(){this.state.state=null,this.state.new=!1}isVisible(){return this.state.visible}setVisible(t=!0){this.state.visible=t}}});function y1(e,t="Error in server saving"){try{let n=Object.entries(e),s=n.find(([l,a])=>l==="fields"),[,o]=s||n[0];if(!s&&!Array.isArray(o)&&typeof o=="object")return y1(o,t);if(s&&typeof o=="string"&&(t=`[${n.find(([l])=>l!=="fields")[0]}] ${o}`),s&&typeof o!="string"&&(t=Object.entries(o).reduce((l,[a,u])=>`${l}${a} ${Array.isArray(u)?u[0]:u}
`,"")),s)return t.replace(/\:|\./g,"")}catch(n){console.warn(n)}}var _1,gs,Ym=R(()=>{ft();ze();Wm();Yy();Xy();g1();lA();Oh();Rt();Object.entries({G3W_FID:jt,GUI:T,Feature:ps,_:_e,is3DGeometry:ld,removeZValue:cd,sanitizeFidFeature:Ah,reverseGeometry:m1}).forEach(([e,t])=>console.assert(t!==void 0,`${e} is undefined`));_1="GIS3W_ESCAPE_NUMERIC_FIELD_",gs={get(e){switch(e){case"g3w-error":return function(t={}){let{error:n}=t;return{parse({type:s="responseJSON"}={}){return s==="responseJSON"&&n&&n.responseJSON&&n.responseJSON.error.message?n.responseJSON.error.message:s==="responseJSON"&&n&&n.errors?y1(n.errors):s==="String"&&typeof n=="string"?n:s==="String"?y1(n):_e("Error in server saving")}}};case"g3w-table/json":return function(t={}){return(t.features||[]).map(n=>{let s=new ps;return s.setProperties(n.properties),s.setId(n.id),s})};case"g3w-vector/gml":return function({data:t,layer:n}={}){try{return new ol.format.WMSGetFeatureInfo({layers:n.getQueryLayerOrigName()}).readFeatures(t.substr(0,2)==="--"?t.split(/\r\n--/).filter(s=>/<([^ ]*)FeatureCollection/.test(s)||/<([^ ]*)msGMLOutput/.test(s)).map(s=>s.substr(s.indexOf("<?xml"))).pop():t)}catch(s){return console.warn(s),[]}};case"g3w-vector/geojson":case"g3w-vector/json":return function(t,n){try{return new ol.format.GeoJSON({geometryName:"geometry",dataProjection:n.crs,featureProjection:n.mapCrs||n.crs}).readFeatures(typeof t=="string"?JSON.parse(t):t)}catch(s){return console.warn(s),[]}};case"application/json":return function({response:t,projections:n,layers:s=[],wms:o=!0,filtertoken:l}={}){let a=s.map(h=>({layer:h,features:[],filtertoken:l})),u=s.map(h=>o?h.getWMSLayerName():h.getWFSLayerName());return(t?new ol.format.GeoJSON({geometryName:"geometry",defaultDataProjection:n.layer||n.map}).readFeatures(t):[]).filter(h=>{let p=h.getId(),d=Ah(p),_=p==d?0:u.indexOf(p);if(_===-1)return!1;let m=h.getProperties();h.set(jt,d),a[_].layer.getFields().filter(v=>v.show&&m[v.name]===void 0&&m[v.label]!==void 0).forEach(v=>h.set(v.name,m[v.label])),a[_].features.push(h)}),a};case"application/geojson":return function({layers:t,response:n}={}){return n?t.map(s=>({layer:s,features:gs.get("g3w-vector/geojson")(n,{})})):[]};case"text/plain":case"text/html":return function({layers:t,response:n}={}){return t.map(s=>({layer:s,rawdata:n}))};case"text/gml":return function({layers:t,response:n}){return t.map(s=>({layer:s,features:gs.get("g3w-vector/gml")({data:n,layer:t[0]})}))};case"application/vnd.ogc.gml":return function({response:t,projections:n,layers:s,wms:o=!0}={}){t&&typeof t!="string"&&!(t instanceof String)&&(t=new XMLSerializer().serializeToString(t)),t&&(t=s.reduce((h,p,d)=>{let _=(o&&p.config.wms_use_layer_ids?p.getId():p.getName()).replace(/[\s'()/]+/g,m=>/\s/g.test(m)&&!o?"_":"");return o||(_=_.replace(/[/\\]+/g,"").replaceAll(":","-")),h.replace(new RegExp(`qgs:${_}`,"g"),`qgs:layer${d}`)},t));let l=t&&Array.from(t.matchAll(/qgs:(\d+(?:\.\d+)?)(\w+)|qgs:(\w+):(\w+)/g)).filter((h,p)=>p%2===0);l&&(t=l.reduce((h,p)=>h.replace(new RegExp(p[0],"g"),`qgs:${_1}${p[1]}${p[2]}`),t)),t&&(t=t.replace(new RegExp("\0","g"),"0"));let a=[],u;try{if(u=new DOMParser().parseFromString(t,"text/xml"),!u.querySelector("FeatureCollection > featureMember"))throw"no features in response";s.forEach((h,p)=>{let d=u.cloneNode(!0),_=[],m=[...d.querySelectorAll(`FeatureCollection > featureMember > layer${p}`)];if(m.forEach(x=>{let b=(x.getAttribute("fid")||".").split(".")[1];if(b){let w=d.createElement("gml:"+jt);x.setAttribute("fid",b),w.textContent=b,x.appendChild(w)}_.push(x.parentNode)}),m.length>1){let x=yl(m,b=>Object.values(b.children).map(w=>w.nodeName));Object.keys(x).length>1&&Object.keys(x).forEach((b,w)=>x[b].forEach((L,D)=>{let G=d.createElement(`qgs:layer${w}_${D}`);for([...L.attributes].map(({name:P,value:j})=>{G.setAttribute(P,j)});L.firstChild;)G.appendChild(L.firstChild);let W=d.createElement("gml:featureMember");W.appendChild(G),L.parentNode.insertAdjacentElement("beforebegin",W),L.parentNode.children.length===1?L.parentNode.parentNode.removeChild(L.parentNode):L.parentNode.removeChild(L),_.push(W)}))}d.querySelectorAll("FeatureCollection > featureMember").forEach(x=>{_.includes(x)||x.parentNode.removeChild(x)}),_=new ol.format.WMSGetFeatureInfo().readFeatures(d.documentElement.outerHTML);let v=n.layer&&n.layer.getCode()!==n.map.getCode()&&_.length&&!!_[0].getGeometry();if(_.length&&l){let x=Object.keys(_[0].getProperties()).filter(b=>b.indexOf(_1)!==-1);_.forEach(b=>{x.forEach(w=>{let L=l.find(D=>`${D[1]}${D[2]}`===w.replace(_1,""));b.set(L[0].replace("qgs:",""),[].concat(b.get(w))[0]),b.unset(w)})})}v&&_.filter(x=>x.getGeometry()).forEach(x=>x.setGeometry(x.getGeometry().transform(n.layer.getCode(),n.map.getCode()))),(n.layer||n.map).getAxisOrientation().substr(0,2)==="ne"&&_.filter(x=>x.getGeometry()).forEach(x=>x.setGeometry(m1(x.getGeometry()))),h.isGeoLayer()&&!ld(h.getGeometryType())&&_.forEach(x=>cd({feature:x})),a.unshift({layer:h,features:_})})}catch(h){console.warn(h)}return u.querySelector("ServiceException")&&T.showUserMessage({type:"warning",textMessage:!0,message:`${s[0].getName()} - ${u.querySelector("ServiceException").innerText}`}),a};default:return function({layers:t=[]}={}){return t.map(n=>({layer:n,rawdata:_e("Not supported format")}))}}}}});function iu(e){let t,n;return(e.getCategories()||[]).forEach(({checked:s,_checked:o,ruleKey:l})=>{s!==o&&(s?t=(t===void 0?`${e.getWMSLayerName()}:`:`${t},`)+l:n=(n===void 0?`${e.getWMSLayerName()}:`:`${n},`)+l)}),{LEGEND_ON:t,LEGEND_OFF:n}}var v1=R(()=>{});function Ph({layer:e={},relation:t={},fid:n,type:s="data"}){return`${F.project.getLayerById(t.father===void 0?e.id===t.referencedLayer?t.referencingLayer:t.referencedLayer:e.id===t.father?t.child:t.father).getUrl(s)}?relationonetomany=${t.id}|${Ah(n)}`}var b1=R(()=>{Ke();g1()});function Ks(e,t="m"){return Math.round(e*od[t]*Gr)}var su=R(()=>{ft()});var cA={};qn(cA,{Layer:()=>Gn});function vl(e,t){let n=new oK[e];return Object.assign(n,{_name:e,_layer:t,getLayer:()=>n._layer,setLayer:s=>n._layer=s,getFeatures:n.getFeatures||(()=>console.log("overwriteby single provider")),query:n.query||(()=>console.log("overwriteby single provider")),getName:()=>n._name})}var Xm,oK,x1,Gn,bl=R(()=>{ft();vn();Rt();Ke();gr();ei();ze();oA();$i();ga();ii();p1();Ym();v1();b1();Xt();su();Oh();Xm=e=>e!==void 0;oK={geojson:class{query(){return _t(Promise.resolve([]))}getFeatures(e={}){return _t(async()=>new ol.format.GeoJSON().readFeatures(e.data||(await Ye.get({url:e.url||this._layer.get("source").url})).results,{featureProjection:e.mapProjection,dataProjection:e.projection||"EPSG:4326"}))}},qgis:class{query(e={}){return this._projections=this._projections||{map:null,layer:null},_t(async()=>{let t=this._layer.getType()==="table";t||(this._projections.map=F.project.getProjection()||this._projections.layer);let n=e.layers?e.layers.map(a=>a.getWMSLayerName()).join(","):this._layer.getWMSLayerName();if(!e.filter)return Promise.reject();let s=[].concat(e.filter).map(a=>({type:a._type||a.type,value:a._filter||a.value}));s[0].type!=="geometry"&&(this._projections.layer=null),s=s.filter(a=>a.value);let o=await Ye.get({url:e.queryUrl||this._layer.getUrl("query"),params:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",filtertoken:F.tokens.filtertoken,LAYERS:n,QUERY_LAYERS:n,INFO_FORMAT:this._layer.getInfoFormat()||"application/vnd.ogc.gml",FEATURE_COUNT:e.feature_count||10,CRS:t?F.map.epsg:this._projections.map.getCode(),I:e.I,J:e.J,FILTER:s.length?s.map(a=>a.value).join(";"):void 0,WITH_GEOMETRY:!t}}),l=e.layers===void 0?[this._layer]:e.layers;return e.raw?o:gs.get(l[0].getInfoFormat())({response:o,projections:this._projections,layers:l,wms:!0})})}getConfig(){return _t(Ye.get({url:this._layer.getUrl("config")}))}getFeatures(e={},t={}){return Object.entries(t).forEach(([n,s])=>{[null,void 0].includes(s)&&delete t[n]}),_t(async()=>{if(!e.editing){let{vector:n}=await Ye.post({url:this._layer.getUrl("data"),data:JSON.stringify(t),contentType:"application/json"});return{data:n.data,count:n.count}}try{let n;if(e.filter?Xm(e.filter.bbox)?n=await Ye.post({url:this._layer.getUrl("editing"),data:JSON.stringify({...t,in_bbox:e.filter.bbox.join(","),filtertoken:this._layer.getFilterToken()}),contentType:"application/json"}):Xm(e.filter.fid)?n=await Ye.post({url:Ph(e.filter.fid),contentType:"application/json",data:JSON.stringify({formatter:1})}):e.filter.field?n=await Ye.post({url:this._layer.getUrl("editing"),data:JSON.stringify({...t,...e.filter}),contentType:"application/json"}):Xm(e.filter.fids)?n=await Ye.post({url:this._layer.getUrl("editing"),data:JSON.stringify({...t,...e.filter}),contentType:"application/json"}):Xm(e.filter.nofeatures)&&(n=await Ye.post({url:this._layer.getUrl("editing"),data:JSON.stringify({...t,field:`${e.filter.nofeatures_field||"id"}|eq|__G3W__NO_FEATURES__`}),contentType:"application/json"})):n=await Ye.post({url:this._layer.getUrl("editing"),data:JSON.stringify(t),contentType:"application/json"}),!n.result)return;let s=n.featurelocks.map(o=>o.featureid);return{count:n.vector.count,featurelocks:n.featurelocks,features:gs.get(`g3w-${this._layer.getType()}/json`)(n.vector.data,n.vector.geometrytype==="NoGeometry"?{}:{crs:this._layer.getCrs()}).filter(o=>s.includes(`${o.getId()}`)).map(o=>new ps({feature:o}))}}catch(n){console.warn(n)}return Promise.reject({message:_e("info.server_error")})})}},wms:class{query(e={}){let{layers:t=[this._layer],size:n=[101,101],coordinates:s=[],resolution:o}=e,l=o*n[0]/2,a=o*n[1]/2,u=[s[0]-l,s[1]-a,s[0]+l,s[1]+a],h=F.project.getProjection()||this._layer.getProjection(),p=e.query_point_tolerance??Go,d=t[0].getQueryUrl(),_=t[0].getOwsMethod(),m=t[0].useProxy(),v=(d||"").split("SOURCE"),x={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",CRS:h.getCode(),LAYERS:(t||[this._layer.getWMSInfoLayerName()]).map(w=>w.getWMSInfoLayerName()).join(","),QUERY_LAYERS:(t||[this._layer.getWMSInfoLayerName()]).map(w=>w.getWMSInfoLayerName()).join(","),filtertoken:F.tokens.filtertoken,INFO_FORMAT:this._layer.getInfoFormat()||"application/vnd.ogc.gml",FEATURE_COUNT:e.feature_count??10,WITH_GEOMETRY:!0,DPI:Gr,FILTER_GEOM:p.unit==="map"?new ol.format.WKT().writeGeometry(ol.geom.Polygon.fromCircle(new ol.geom.Circle(s,p.value))):void 0,FI_POINT_TOLERANCE:p.unit==="map"?void 0:p.value,FI_LINE_TOLERANCE:p.unit==="map"?void 0:p.value,FI_POLYGON_TOLERANCE:p.unit==="map"?void 0:p.value,G3W_TOLERANCE:p.unit==="map"?void 0:p.value*o,I:p.unit==="map"?void 0:Math.floor((s[0]-u[0])/o),J:p.unit==="map"?void 0:Math.floor((u[3]-s[1])/o),WIDTH:n[0],HEIGHT:n[1],STYLES:(t||[]).map(w=>w.getStyle()).join(","),BBOX:(h.getAxisOrientation().substr(0,2)==="ne"?[u[1],u[0],u[3],u[2]]:u).join(","),LEGEND_ON:t.flatMap(w=>iu(w).LEGEND_ON).filter(Boolean).join(";")||void 0,LEGEND_OFF:t.flatMap(w=>iu(w).LEGEND_OFF).filter(Boolean).join(";")||void 0,SOURCE:!m&&_==="GET"&&v.length>1?v[1]:void 0},b;return _t(Promise.race([new Promise(w=>{b=setTimeout(()=>{w({data:(t||[]).map(L=>({layer:L,rawdata:"timeout"})),query:{coordinates:s,resolution:o}})},$n)}),(async()=>{try{let w;if(m)w=await t[0].getDataProxyFromServer("wms",{url:d,params:x,method:_,headers:{"Content-Type":x.INFO_FORMAT}});else if(_==="GET"){let L=(v.length?v[0]:d).replace(/[?&]$/,"");w=await Ye.get({url:L+(L.indexOf("?")===-1?"?":"&")+Object.keys(x).filter(D=>![void 0,null].includes(x[D])).map(D=>D+"="+encodeURIComponent(x[D])).join("&")})}else _==="POST"?w=await Ye.post({url:d,data:x}):console.warn("unsupported method: ",_);return{data:gs.get(t[0].getInfoFormat())({response:w,layers:t,wms:!0,projections:{map:h,layer:null}}),query:{coordinates:s,resolution:o}}}finally{m||clearTimeout(b)}})()]))}},wfs:class{query(e={},t={}){let n=e.filter||{},s=e.layers||[this._layer],o=`${s[0].getQueryUrl()}/`.replace(/\/+$/,"/"),l=s[0].getOwsMethod();Object.assign(n,{config:n.config||{},type:n._type||n.type,value:n._filter||n.value}),t=Object.assign(t,{SERVICE:"WFS",VERSION:"1.1.0",REQUEST:"GetFeature",MAXFEATURES:e.feature_count??10,TYPENAME:s.map(u=>u.getWFSLayerName()).join(","),OUTPUTFORMAT:s[0].getInfoFormat(),SRSNAME:(e.reproject?s[0].getProjection():F.project.getProjection()).getCode(),FILTER:n.type!=="all"?`(${new ol.format.WFS().writeGetFeature({featureTypes:[""],filter:{bbox:()=>ol.format.filter.bbox("the_geom",n.value),geometry:()=>ol.format.filter[n.config.spatialMethod||"intersects"]("the_geom",n.value),expression:()=>null}[n.type]()}).children[0].innerHTML})`.repeat(s.length||1):void 0});let a;return _t(Promise.race([new Promise(u=>{a=setTimeout(()=>{u({data:(s||[]).map(h=>({layer:h,rawdata:"timeout"})),query:{}})},$n)}),(async()=>{try{let u;l==="GET"&&!["all","geometry"].includes(n.type)&&(u=await Ye.get({url:o+"?"+new URLSearchParams(t||{}).toString()})),(l==="POST"||["all","geometry"].includes(n.type))&&(u=await Ye.post({url:o,data:t}));let h=gs.get(s[0].getInfoFormat())({response:u,projections:{map:F.project.getProjection(),layer:e.reproject?this._layer.getProjection():null},layers:s,wms:!1});return h.flatMap(p=>p.features||[]).forEach(p=>Object.entries(p.getProperties()).forEach(([d,_])=>_&&_["xsi:nil"]&&feature.set(d,"NULL"))),{data:h}}finally{clearTimeout(a)}})()]))}},g3w:class{async query(e={},t={}){let n=e.filter||{},s=n.config.spatialMethod||"intersects";switch(n.type){case"bbox":case"geometry":t.geo_filter_mode=s==="within"?"contains":s,t.geo_filter_wkt=new ol.format.WKT({dataProjection:F.map.epsg,featureProjection:F.map.epsg}).writeFeature(new ol.Feature({geometry:n.value})),t.formatter=1,t.filtertoken=F.tokens.filtertoken;break;case"expression":break}let o=[];try{let l=await Ye.post({url:this._layer.getUrl("data"),contentType:"application/json",data:JSON.stringify(t)});if(l&&l.result)o.push({layer:this._layer,features:gs.get("g3w-vector/json")(l.vector&&l.vector.data||{},{projections:{map:F.project.getProjection()||this._layer.getProjection(),layer:null}}).map(a=>(a.set(jt,a.getId()),a))});else throw l.error}catch(l){console.warn(l)}return{data:o}}}},x1={download:{format:"shapefile",url:"shp"},download_gpkg:{format:"gpkg",url:"gpkg"},download_gpx:{format:"gpx",url:"gpx"},download_csv:{format:"csv",url:"csv"},download_xls:{format:"xls",url:"xls"},download_raster:{format:"geotiff",url:"geotiff"},download_pdf:{format:"pdf",url:"pdf"}},Gn=class e extends nt{constructor(t={},n={}){super();let s=n.project||F.project,o=t.baselayer?"":`${s.getType()}/${s.getId()}/${t.id}/`,l=t.baselayer?"":s.state.vectorurl,a=t.baselayer?"":s.state.rasterurl,u=t.styles&&t.styles.find(d=>d.current).name;this.config=this.state=Object.assign(t,{id:t.id||"Layer",title:t.title||t.name,download:!!t.download,baselayer:!!t.baselayer,fields:t.fields||{},urls:{query:t.infourl||t.wmsUrl,...t.urls||{},...t.baselayer?{}:{filtertoken:`${l}filtertoken/${o}`,data:`${l}data/${o}`,shp:`${l}shp/${o}`,csv:`${l}csv/${o}`,xls:`${l}xls/${o}`,gpx:`${l}gpx/${o}`,gpkg:`${l}gpkg/${o}`,geotiff:`${a}geotiff/${o}`,editing:`${l}editing/${o}`,commit:`${l}commit/${o}`,config:`${l}config/${o}`,unlock:`${l}unlock/${o}`,widget:{unique:`${l}widget/unique/data/${o}`},featurecount:s.getUrl("featurecount"),editorformstructure:s.getUrl("editorformstructure"),pdf:"/html2pdf/"}},...t.baselayer?{}:{searchParams:{I:0,J:0}},search_endpoint:"api",map_crs:n.project?.getProjection()?.getCode(),multilayerid:t.multilayer,projection:t.projection?t.projection.getCode()===t.crs.epsg?t.projection:In.get(t.crs):void 0,attributions:t.attributions,selected:t.selected||!1,disabled:t.disabled||!1,metadata:t.metadata,removable:t.removable||!1,source:t.source,styles:t.styles,defaultstyle:u,infoformats:t.infoformats||[],projectLayer:!0,geolayer:t.geometrytype!=="NoGeometry",attributetable:{pageLength:null},visible:!!t.visible,tochighlightable:!1,inediting:!1,selection:{active:!1},ol_selection:{},selectionFids:new Set,filter:{active:!1,current:null,pagination:!1},filters:t.filters||[],featurecount:t.featurecount,stylesfeaturecount:t.featurecount&&u&&{[u]:t.featurecount},name:t.name,expanded:t.expanded,toc:t.toc??!0,legend:{url:null,loading:!1,error:!1,show:!0,change:!1,categories:{}},exclude_from_legend:t.exclude_from_legend??!0,categories:!1,external:t.source&&t.source.external,bbox:t.bbox,checked:t.checked??!!t.visible,epsg:t.crs.epsg,hidden:!!t.hidden,scalebasedvisibility:!!t.scalebasedvisibility,minscale:t.minscale,maxscale:t.maxscale,ows_method:t.ows_method,opacity:t.opacity||100,proxyData:{wms:null},max_preview_fields:t.max_preview_fields});let h=s.getRelations().filter(d=>[d.referencedLayer,d.referencingLayer].includes(this.getId()));this._relations={_relations:(h||[]).reduce((d,_={})=>{let m=Date.now(),v={loading:!1,id:_.id||`id_${m}`,name:_.name||`name_${m}`,origname:_.origname||`origname_${m}`,father:_.referencedLayer,child:_.referencingLayer,type:_.type,editable:_.editable||!1,prefix:_.prefix,fatherField:[].concat(_.fieldRef.referencedField),childField:[].concat(_.fieldRef.referencingField)};return d[v.id]=Object.assign(new nt(_),{state:v,getId:()=>v.id,setId:x=>v.id=x,getName:()=>v.name,setName:x=>v.name=x,getChild:()=>v.child,getFather:()=>v.father,getState:()=>v,getType:()=>v.type,getFatherField:()=>v.fatherField,getChildField:()=>v.childField,setLoading:x=>v.loading=!!x,isLoading:()=>v.loading,isEditable:()=>v.editable,getPrefix:()=>v.prefix,getFields:()=>({father:v.fatherField,child:v.childField}),getTitle:()=>v.title,setTitle:x=>v.title=x}),d},{}),_length:h?h.length:0,_reloadRelationsInfo(){this._relationsInfo={children:{},fathers:{},father_child:{}};let d,_,{father_child:m,fathers:v,children:x}=this._relationsInfo;Object.entries(this._relations).forEach(([b,w])=>{d=w.getFather(),_=w.getChild(),m[d+_]=b,v[d]=v[d]||[],x[_]=x[_]||[],v[d].push(_),x[_].push(d)})},getLength(){return this._length},getRelations({type:d=null}={}){if(!d)return this._relations;if(["ONE","MANY"].indexOf(d)!==-1){let _={};for(let m in this._relations)d===this._relations[m].getType()&&(_[m]=this._relations[m]);return _}return{}},setRelations(d=[]){this._relations=Array.isArray(d)?d:[]},getRelationById(d){return this._relations[d]},getArray(){return Object.entries(this._relations).map(d=>d[1])},getRelationByFatherChildren(d,_){return this.getRelationById(this._relationsInfo.father_child[d+_])},isChild(d){return!!this._relationsInfo.children[d]},isFather(d){return!!this._relationsInfo.fathers[d]},hasChildren(d){return(this.getChildren(d)||[]).length>0},hasFathers(d){return(this.getFathers(d)||[]).length>0},getChildren(d){return this.isFather(d)?this._relationsInfo.fathers[d]:null},getFathers(d){return this.isChild(d)?this._relationsInfo.children[d]:null}},this._relations._reloadRelationsInfo(),Object.assign(this.config,{openattributetable:this.canShowTable(),downloadable:this.isDownloadable(),infoformat:this.getInfoFormat()}),this._layersstore=t.layersstore||null;let p=`${this.config.servertype} ${this.config.source&&this.config.source.type}`;if(this.providers={data:(()=>{if(["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs"].includes(p))return vl("qgis",this);if(p==="G3WSUITE geojson")return vl("geojson",this)})(),filter:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs","QGIS wmst","QGIS wcs","QGIS wms","QGIS arcgisfeatureserver"].includes(p)&&vl("g3w",this),filtertoken:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext"].includes(p)&&vl("qgis",this),query:(()=>{if(["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs","QGIS wmst","QGIS wcs","QGIS wms","QGIS gdal","QGIS postgresraster","QGIS vector-tile","QGIS vectortile","QGIS arcgismapserver","QGIS arcgisfeatureserver","QGIS mdal","OGC wms"].includes(p))return vl("wms",this);if(p==="G3WSUITE geojson")return vl("geojson",this)})(),search:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs","QGIS arcgisfeatureserver"].includes(p)&&vl("qgis",this)},t?.source?.url){let d=new URL(this.config.source.url);["VERSION","REQUEST","BBOX","LAYERS","WIDTH","HEIGHT","DPI","FORMAT","CRS"].forEach(_=>{this.config.source.url=this.config.source.url.replace(`${_.toUpperCase()}=${d.searchParams.get(_.toUpperCase())}`,"").replace(`${_.toLowerCase()}=${d.searchParams.get(_.toLowerCase())}`,"")})}}async getDownloadFilefromDownloadDataType(t,{data:n={}}){n.filtertoken=this.getFilterToken();let s,o;switch(t){case"pdf":s=this.getUrl("pdf"),o=s&&await fetch(s,{body:JSON.stringify(n),method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Access-Control-Expose-Headers":"Content-Disposition"},signal:AbortSignal.timeout($n)});break;default:s=this.getUrl(t==="shapefile"?"shp":t),o=s&&await fetch(s,{body:Object.keys(n||{}).reduce((l,a)=>(l.append(a,n[a]),l),new FormData),method:"POST",headers:{"Access-Control-Expose-Headers":"Content-Disposition"},signal:AbortSignal.timeout($n)});break}if(!o?.ok)throw(await o.json()).message;Si(await o.blob(),o.headers.get("content-disposition"))}getGeoTIFF({data:t={}}={}){return this.getDownloadFilefromDownloadDataType("geotiff",{data:t})}getXls({data:t={}}={}){return this.getDownloadFilefromDownloadDataType("xls",{data:t})}getShp({data:t={}}={}){return this.getDownloadFilefromDownloadDataType("shapefile",{data:t})}getGpx({data:t={}}={}){return this.getDownloadFilefromDownloadDataType("gpx",{data:t})}getGpkg({data:t={}}={}){return this.getDownloadFilefromDownloadDataType("gpkg",{data:t})}getCsv({data:t={}}={}){return this.getDownloadFilefromDownloadDataType("csv",{data:t})}getDownloadableFormats(){return Object.keys(x1).filter(t=>this.config[t]).map(t=>x1[t].format)}hasDowloadableRelations(){return this.getRelations().getArray().length>0&&!!this.getRelations().getArray().find(t=>De(t.getChild()).getDownloadableFormats().filter(n=>n!=="pdf").length>0)}getDownloadUrl(t){return(Object.values(x1).find(n=>n.format===t)||{}).url}isDownloadable(){return!!this.getDownloadableFormats().length}isGeoTIFFDownloadable(){return!this.isBaseLayer()&&this.config.download&&this.config.source.type==="gdal"}isShpDownloadable(){return!this.isBaseLayer()&&this.config.download&&this.config.source.type!=="gdal"}isXlsDownloadable(){return!this.isBaseLayer()&&!!this.config.download_xls}isGpxDownloadable(){return!this.isBaseLayer()&&!!this.config.download_gpx}isGpkgDownloadable(){return!this.isBaseLayer()&&!!this.config.download_gpkg}isCsvDownloadable(){return!this.isBaseLayer()&&!!this.config.download_csv}getRelations(){return this._relations}getRelationById(t){return this._relations.getArray().find(n=>t===n.getId())}getRelationAttributes(t){let n=this._relations.find(s=>t===s.name);return n?n.fields:[]}getRelationsAttributes(){return(this.state.relations||[]).reduce((t,n)=>(t[n.name]=n.fields,t),{})}isChild(){return this.getRelations()?this._relations.isChild(this.getId()):!1}isFather(){return this.getRelations()?this._relations.isFather(this.getId()):!1}getChildren(){return this.isFather()?this._relations.getChildren(this.getId()):[]}getFathers(){return this.isChild()?this._relations.getFathers(this.getId()):[]}hasChildren(){return this.hasRelations()?this._relations.hasChildren(this.getId()):!1}hasFathers(){return this.hasRelations()?this._relations.hasFathers(this.getId()):!1}hasRelations(){return!!this._relations}isSelected(){return this.state.selected}setSelected(t){this.state.selected=t}async setSelection(t=!1){if(this.state.selection.active=t,t)return;let n=this.state.filter.active,s=this.state.filter.current!==null;s&&n&&await this._applyFilterToken(this.state.filter.current),!s&&n&&await this.deleteFilterToken(),this.emit("unselectionall",this.getId())}isSelectionActive(){return this.state.selection.active}getSelection(){return this.state.selection}getFilter(){return this.state.filter}setFilter(t=!1){this.state.filter.active=t,this.isGeoLayer()&&this.state.filter.active&&T.getService("map").toggleSelection(!1,this.state.id),this.isGeoLayer()&&!this.state.filter.active&&this.#e()}async applyFilter(t){this.providers.filtertoken&&((this.state.filter.current===null||t.fid!==this.state.filter.current.fid)&&(await this.clearSelectionFids(),T.closeContent()),await this._applyFilterToken(t))}async _applyFilterToken(t){try{let n=await Ye.get({url:this.providers.filtertoken._layer.getUrl("filtertoken"),params:{mode:"apply",fid:t.fid}});if(!n||!n.result||!n.data)return;this.setFilter(!1),this.state.filter.current=t,this.setFilterToken(n.data.filtertoken)}catch(n){console.warn(n)}}saveFilter(){!this.providers.filtertoken||!this.state.selectionFids.size>0||Hm({label:_e("Save Filter"),value:this.state.filter.current?.name||"",callback:async t=>{let n=await Ye.get({url:this.providers.filtertoken._layer.getUrl("filtertoken"),params:{mode:"save",name:t}});if(!n||!n.result||!n.data)return;let s=this.state.filters.find(o=>n.data.fid===o.fid);s===void 0&&(s={fid:n.data.fid,name:n.data.name},this.state.filters.push(s)),this.state.filter.current=s,this.setFilter(!1),this.getSelection().active=!1,this.state.selectionFids.clear(),this.isGeoLayer()&&Object.values(this.state.ol_selection).forEach(o=>{o.added&&T.getService("map").setSelectionFeatures("remove",{feature:o.feature}),o.added=!1,o.selected=!1}),this.emit("unselectionall",this.getId())}})}async toggleFilterToken(){this.setFilter(!this.state.filter.active);let t=this.state.filter.current,n=this.state.filter.active;return n&&await this.createFilterToken(),t&&!n&&await this.applyFilter(this.state.filter.current),!t&&!n&&await this.deleteFilterToken(),this.state.filter.active}async deleteFilterToken(t){try{if(!this.providers.filtertoken)return;let n;try{let s=await Ye.get({url:this.providers.filtertoken._layer.getUrl("filtertoken"),params:{fid:t,mode:t===void 0?"delete":"delete_saved"}});s&&s.result&&s.data&&(n=s.data.filtertoken)}catch(s){console.warn(s)}t!==void 0&&(this.state.filters=this.state.filters.filter(s=>t!==s.fid)),this.state.filter.active&&this.state.filter.pagination&&(this.state.selection.active=!1),this.state.filter.pagination=!1,this.state.filter.current=null,this.setFilterToken(n),this.state.filter.active&&this.setFilter(!1)}catch(n){console.warn(n)}}setFilterToken(t=void 0){F.tokens.filtertoken=t,this.setFilter(!!t),this.emit("filtertokenchange",{layerId:this.getId()})}async createFilterToken(){try{let t=this.providers.filtertoken,n=this.state.selectionFids;if(!t||!n.size>0)return;if(n.has(Rn.ALL)){try{await Ye.get({url:this.providers.filtertoken._layer.getUrl("filtertoken"),params:{fid:void 0,mode:"delete"}})}catch(l){console.warn(l)}this.setFilterToken(null);return}let s=Array.from(n),{data:o={}}=await Ye.post({url:t._layer.getUrl("filtertoken"),contentType:"application/json",data:JSON.stringify(n.has(Rn.EXCLUDE)?{fidsout:s.filter(l=>l!==Rn.EXCLUDE).join(",")}:{fidsin:s.join(",")})});this.setFilterToken(o.filtertoken)}catch(t){console.warn(t)}}getFilterToken(){return this.state.filter.active?F.tokens.filtertoken:void 0}setSelectionFidsAll(){this.state.selectionFids.clear(),this.state.selectionFids.add(Rn.ALL),this.isGeoLayer()&&(Object.values(this.state.ol_selection).forEach(t=>t.selected=!0),this.#e()),this.setSelection(!0),this.state.filter.active&&this.createFilterToken()}getSelectionFids(){return this.state.selectionFids}invertSelectionFids(){let t=this.state.selectionFids;if(t.has(Rn.EXCLUDE)?t.delete(Rn.EXCLUDE):t.has(Rn.ALL)?t.delete(Rn.ALL):t.size>0&&t.add(Rn.EXCLUDE),this.isGeoLayer()){let n=T.getService("map");Object.values(this.state.ol_selection).forEach(s=>{s.selected=!s.selected,s.feature.__layerId=this.getId(),s.selected!==s.added&&(n.setSelectionFeatures(s.selected?"add":"remove",{feature:s.feature}),s.added=s.selected)})}this.state.filter.active&&this.createFilterToken(),this.setSelection(t.size>0)}hasSelectionFid(t){let n=this.state.selectionFids;return n.has(Rn.ALL)?!0:n.has(Rn.EXCLUDE)?!n.has(t):n.has(t)}async includeSelectionFid(t,n=!0){let s=this.state.selectionFids,o=s.has(Rn.EXCLUDE)&&s.has(t);o&&s.delete(t),o||s.add(t),o&&s.size===1&&this.setSelectionFidsAll(),!o&&!this.isSelectionActive()&&this.setSelection(!0),this.isGeoLayer()&&this.state.ol_selection[t]?.feature&&(this.state.ol_selection[t].selected=!o,this.state.ol_selection[t].feature.__layerId=!o&&!this.state.ol_selection[t].added?this.getId():void 0,this.#e()),n&&this.state.filter.active&&await this.createFilterToken()}async excludeSelectionFid(t,n=!0){let s=this.state.selectionFids;(s.has(Rn.ALL)||s.size===0)&&(s.clear(),s.add(Rn.EXCLUDE)),s.has(Rn.EXCLUDE)?s.add(t):s.delete(t),s.size===0&&this.clearSelectionFids(),s.size===1&&s.has(Rn.EXCLUDE)&&(s.clear(),this.setselectionFidsAll());let o=s.has(Rn.EXCLUDE)?s.has(t):!s.has(t);this.isGeoLayer()&&this.state.ol_selection[t]?.feature&&(this.state.ol_selection[t].selected=!o,this.state.ol_selection[t].feature.__layerId=!o&&!this.state.ol_selection[t].added?this.getId():void 0,this.#e()),n&&this.state.filter.active&&await this.createFilterToken()}async clearSelectionFids(){this.state.selectionFids.clear(),this.isGeoLayer()&&(Object.values(this.state.ol_selection).forEach(t=>t.selected=!1),this.#e()),await this.setSelection(!1)}getProxyData(t){return t?this.state.proxyData[t]:this.state.proxyData}setProxyData(t,n={}){this.state.proxyData[t]=n}clearProxyData(t){this.state.proxyData[t]=null}async getDataProxyFromServer(t="wms",n={}){try{let{response:s,data:o}=await gt.getData(`proxy:${t}`,{inputs:n,outputs:!1});return this.setProxyData(t,JSON.parse(o)),s}catch(s){console.warn(s)}}changeProxyDataAndReloadFromServer(t="wms",n={}){return Object.keys(n).forEach(s=>{Object.keys(n[s]).forEach(o=>{this.state.proxyData[t][s][o]=n[s][o]})}),this.getDataProxyFromServer(t,this.state.proxyData[t])}isInEditing(){return this.state.inediting}setInEditing(t=!1){this.state.inediting=t}getSearchParams(){return this.config.searchParams}getSearchEndPoint(){return console.warn("getSearchEndPoint is deprecated"),"api"}setAttributeTablePageLength(t){this.state.attributetable.pageLength=t}getAttributeTablePageLength(){return this.state.attributetable.pageLength}getSourceType(){return this.config.source?this.config.source.type:null}isGeoLayer(){return this.state.geolayer}getDataTable({page:t=null,page_size:n=null,ordering:s=null,search:o=null,suggest:l=null,formatter:a=0,custom_params:u={},field:h,in_bbox:p}={}){return _t(async()=>{if(!this.getProvider("filter")&&!this.getProvider("data"))return Promise.reject();let d=await Ot(this.getProvider("data").getFeatures({editing:!1},{...u,field:h,page:t,page_size:n,ordering:s,search:o,formatter:a,suggest:l,in_bbox:p,filtertoken:this.getFilterToken()})),_=d.data.features&&d.data.features||[],m=this.getAttributes()||[],v=_.length?_[0].properties:[];return{features:_,headers:m&&m.length>0?m.filter(x=>Object.keys(v).indexOf(x.name)>-1):Object.keys(v).filter(x=>ur.indexOf(x)===-1).map(x=>({name:x,label:x})),title:this.getTitle(),count:d.count}})}async getFeatureByFids({fids:t=[],formatter:n=0}={}){let s=this.getUrl("data");try{let o=await Ye.get({url:s,params:{fids:t.toString(),formatter:n}});if(o&&o.result&&o.vector&&o.vector.data)return o.vector.data.features}catch(o){console.warn(o)}}searchFeatures(t={},n={}){let{search_endpoint:s=this.config.search_endpoint}=t;return new Promise(async(o,l)=>{switch(s){case"ows":this.search(t,n).then(a=>{o({data:a})}).fail(a=>{console.warn(a),l(a)});break;case"api":try{o(await this.getFilterData({queryUrl:t.queryUrl,field:t.filter,ordering:t.ordering,unique:t.unique,raw:t.raw!==void 0?t.raw:!1,suggest:t.suggest,formatter:t.formatter!==void 0?t.formatter:1,autofilter:t.autofilter,page:t.page,page_size:t.page_size}))}catch(a){console.warn(a),l(a)}break}})}async getFilterData({raw:t=!1,suggest:n,field:s,unique:o,fformatter:l,ffield:a,formatter:u=1,queryUrl:h,ordering:p,autofilter:d,page:_,page_size:m}={}){let v=this.getProvider("data");v._projections=v._projections||{map:null,layer:null};let x={field:s,suggest:n,ordering:p,formatter:u,unique:o,fformatter:l,ffield:a,filtertoken:F.tokens.filtertoken,autofilter:d,page:_,page_size:m};try{let b=h||v._layer.getUrl("data"),w=await Ye.post({url:b,contentType:"application/json",data:JSON.stringify(x)});if(v._layer.getType()!=="table"&&(v._projections.map=F.project.getProjection()||v._projections.layer),t)return w;if(o&&w.result)return w.data;if(l&&w.result)return w;if(w.result)return{data:gs.get("application/json")({layers:[v._layer],response:w.vector.data,filtertoken:w.filtertoken,projections:v._projections}),count:w.vector.count}}catch(b){return console.warn(b),Promise.reject(b)}return Promise.reject()}search(t={},n={}){t={...t,feature_count:t.feature_count||10,...this.config.searchParams,...n};let s=this.getProvider("search");return _t(async()=>s?await Ot(s.query(t)):Promise.reject(_e("Layer is not searchable")))}query(t={}){let n=this.getProvider(t.filter?"filter":"query");return _t(async()=>n?await Ot(n.query(t)):Promise.reject(_e("Layer is not querable")))}get(t){return this.config[t]?this.config[t]:this.state[t]}getFields(){return this.config.fields}getEditingFields(){return this.config.editing.fields}getTableFields(){return(this.config.fields||[]).filter(t=>t.show)}getTableHeaders(){return this.getTableFields().filter(t=>!ur.includes(t.name))}getProject(){return this.config.project}getConfig(){return this.config}getLayerEditingFormStructure(){return this.config.editor_form_structure}hasFormStructure(){return!!this.config.editor_form_structure}getCustomStyle(){return this.config.customstyle}getState(){return this.state}getSource(){return this.state.source}getEditingLayer(){return this._editingLayer}setEditingLayer(t){this._editingLayer=t}isHidden(){return this.state.hidden}setHidden(t=!0){this.state.hidden=t}getId(){return this.config.id}getMetadata(){return this.state.metadata}getTitle(){return this.config.title}getName(){return this.config.name}getOrigName(){return this.config.origname}getServerType(){return this.config.servertype||"QGIS"}getType(){return this.type}isType(t){return t===this.getType()}isDisabled(){return this.state.disabled}isVisible(){return this.state.visible}isQueryable(){return!!(this.config.capabilities&&this.config.capabilities&e.CAPABILITIES.QUERYABLE)}getTocHighlightable(){return this.state.tochighlightable}setTocHighlightable(t=!1){this.state.tochighlightable=t}isFilterable(t=null){let n=!!(this.config.capabilities&&this.config.capabilities&e.CAPABILITIES.FILTERABLE);if(n&&t){let s=Object.keys(t).reduce((o,l)=>{let a=this.get(l),u=t[l];return o&&Array.isArray(a)?a.includes(u):u===a},!0);n=n&&s}return n}isQtimeseries(){return this.config.qtimeseries}isEditable(){return!!(this.config.capabilities&&this.config.capabilities&e.CAPABILITIES.EDITABLE)}isBaseLayer(){return this.config.baselayer}getUrl(t){return this.config.urls[t]}setUrl({type:t,url:n}={}){this.config.urls[t]=n}getQueryUrl(){return this.config.urls.query}getQueryLayerOrigName(){return this.config?.infolayer||this.config.origname}getInfoFormat(t){return this.config.qtimeseries===!0||this.getSourceType()==="gdal"?"application/json":this.config.infoformat&&this.config.infoformat!==""&&t!=="wfs"?this.config.infoformat:"application/vnd.ogc.gml"}getInfoFormats(){return this.state.infoformats}getInfoUrl(){return this.config.infourl}setInfoFormat(t){this.config.infoformat=t}getAttributes(){return this.config.fields}changeAttribute(t,n,s){for(let o of this.config.fields)if(o.name===t){o.type=n,o.options=s;break}}getAttributeLabel(t){return(this.getAttributes().find(n=>t===n.name)||{}).label}getProvider(t){return this.providers[t]}getProviders(){return this.providers}getLayersStore(){return this._layersstore}setLayersStore(t){this._layersstore=t}canShowTable(){return!this.config.not_show_attributes_table&&!this.isBaseLayer()&&(this.isQueryable()&&this.getTableFields().length>0&&["QGIS postgres","QGIS oracle","QGIS wfs","QGIS ogr","QGIS mssql","QGIS spatialite"].includes(`${this.getServerType()} ${this.config.source.type}`)||`${this.getServerType()} ${this.get("source").type}`=="G3WSUITE geojson"||this.isFilterable()&&this.getServerType()!=="G3WSUITE")}changeFieldType({name:t,type:n,options:s={},reset:o=!1}={}){let l=this.getFields().find(a=>t===a.name);if(l&&o)return l.type=l._type,delete l._type,delete l[`${n}options`],l.type;if(l&&!o)return l._type=l.type,l.type=n,l[`${n}options`]=s,l._type}changeConfigFieldType({name:t,type:n,options:s={},reset:o=!1}){return this.changeFieldType({name:t,type:n,options:s,reset:o})}clear(){}isVector(){return e.LayerTypes.VECTOR===this.getType()}isTable(){return e.LayerTypes.TABLE===this.getType()}getFeatureCount(){return this.state.featurecount}async changeCurrentStyle(t){if(!(this.config.styles.find(n=>t===n.name)||{}).current)try{await this.getStyleFeatureCount(t),await this.getStyleEditorFormStructure(t),this.config.styles.forEach(n=>n.current=t===n.name),this.change()}catch(n){console.warn(n)}}async getStyleEditorFormStructure(t){try{let{result:n,data:s={}}=await Ye.post({url:`${this.config.urls.editorformstructure}${this.getId()}/`,data:JSON.stringify({style:t}),contentType:"application/json"});if(n)return this.config.editor_form_structure=s?.editor_form_structure,this.config.fields=s?.fields||this.config.fields,this.state.scalebasedvisibility=s?.scalebasedvisibility,this.state.minscale=s?.minscale,this.state.maxscale=s?.maxscale,s??{}}catch(n){throw console.warn(n),n}}async getStyleFeatureCount(t){if(this.state.stylesfeaturecount!==void 0){if(this.state.stylesfeaturecount[t]===void 0)try{let{result:n,data:s}=await Ye.post({url:`${this.config.urls.featurecount}${this.getId()}/`,data:JSON.stringify({style:t}),contentType:"application/json"});this.state.stylesfeaturecount[t]=n===!0?s:{}}catch(n){throw console.warn(n),this.state.stylesfeaturecount[t]={},n}return this.state.featurecount=this.state.stylesfeaturecount[t],this.state.stylesfeaturecount[t]}}getFormat(){return this.config.format||F.project.state.wms_getmap_format||"image/png"}openAttributeTable(t={}){new(Vue.extend(rA))({...t,layerId:this.state.id})}setCategories(t=[]){this.state.legend.categories[this.getCurrentStyle().name]=t,this.state.categories=(t||[]).filter(n=>n.ruleKey).length>0}getCategories(){return this.state.legend.categories[this.getCurrentStyle().name]}clearCategories(){this.state.legend.categories={},this.state.categories=!1}getOlSelectionFeature(t){return this.state.ol_selection[t]}addOlSelectionFeature({id:t,feature:n}={}){let s=new ol.Feature(n.geometry);return s.setId(`${this.getId()}_${t}`),Object.entries(n.attributes).forEach(([o,l])=>s.set(o,l)),this.state.ol_selection[t]=this.state.ol_selection[t]||{feature:s,added:!1,selected:!1},this.state.ol_selection[t]}#e(){let t=T.getService("map");Object.values(this.state.ol_selection).forEach(n=>{n.selected!==n.added&&(n.feature.__layerId=this.getId(),t.setSelectionFeatures(n.selected?"add":"remove",{feature:n.feature}),n.added=n.selected)}),t.toggleSelection(!this.state.filter.active&&Object.values(this.state.ol_selection).some(n=>n.selected),this.state.id)}setChecked(t){this.state.checked=t}isChecked(){return this.state.checked}setVisible(t){let n=this.state.visible;return this.state.visible=t&&this.isChecked(),n!==this.state.visible&&this.change?.(),this.state.visible}isPrintable({scale:t}={}){let n=this.isChecked();if(n){let s=this.state.parentGroup;for(;n&&s;)n=n&&s.checked,s=s.parentGroup}return n&&(!this.state.scalebasedvisibility||t>=this.state.maxscale&&t<=this.state.minscale)}getStyles(){return this.config.source.external?this.config.source.styles:this.config.styles}getStyle(){return this.config.source.external?this.config.source.styles:this.config.styles?this.config.styles.find(t=>t.current).name:""}getOpacity(){return this.state.opacity}getCurrentStyle(){return this.config.styles.find(t=>t.current)}setDisabled(t,n="m"){if(typeof t=="boolean")return this.state.disabled=t;if(this.state.scalebasedvisibility){let s=Ks(t,n);this.state.disabled=!(s>=this.state.maxscale&&s<=this.state.minscale),this.state.disabled=this.state.minscale===0?!(s>=this.state.maxscale):this.state.disabled;let o=!0,l=this.state.parentGroup;for(;l;)o=o&&l.checked,l=l.parentGroup;o&&this.setVisible(!this.state.disabled),this.isFilterable()&&this.setTocHighlightable(!this.state.disabled)}else this.state.disabled=!1}getMultiLayerId(){return this.config.multilayerid}getGeometryType(){return this.config.geometrytype}getOwsMethod(){return this.config.ows_method}setProjection(t={}){this.config.projection=In.get(t)}getProjection(){return this.config.projection}getEpsg(){return this.config.crs.epsg}getCrs(){return this.config.projection?this.config.projection.getCode():null}isCached(){return this.config.cache_url&&this.config.cache_url!==""}getCacheUrl(){if(this.isCached()&&this.config.cache_provider&&this.config.cache_provider==="mapproxy")return this.config.cache_url;if(this.isCached())return`${this.config.cache_url}/{z}/{x}/{y}.png`}getMapLayer(){console.log("overwrite by single layer")}getWMSLayerName(){return this.config.wms_use_layer_ids?this.getId():this.getName()}};Gn.LayerTypes={TABLE:"table",IMAGE:"image",VECTOR:"vector"};Gn.CAPABILITIES={QUERYABLE:1,FILTERABLE:2,EDITABLE:4}});function Fh({field:e,value:t,operator:n="eq",logicop:s="OR"}){return[].concat(t).map(o=>`${e}|${n.toLowerCase()}|${encodeURIComponent(o)}`).join(`|${s},`)}function _K(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="InputSelect.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function w1(){let e=w1.styles||(w1.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var aK,lK,cK,ms,uK,dK,hK,fK,pK,gK,mK,yK,uA,dA=R(()=>{ze();Ke();us();Xt();aK=u1(),{Layer:lK}=(bl(),kn(cA)),cK=ti(),ms=null;uK={name:"input-select",mixins:[cK,gc,mg],data(){return{showPickLayer:!1,picked:!1,filterFields:[],isFilterFieldsReady:!1}},computed:{showNullOption(){return this.multiple===!1&&[void 0,!0].includes(this.state.nullOption)},select2NullValue(){return this.showNullOption&&ms}},methods:{async pickLayerValue(){try{if(this.picked)this.pickLayerInputService.unpick(),this.picked=!1;else{this.picked=!0;let e=await this.pickLayerInputService.pick(),t=e[this.state.input.options.key];this.multiple&&(t=this.getMultiValues().find(n=>t==n)===void 0?`{${[...this.getMultiValues(),t].join()}}`:this.state.value),t!=this.state.value&&(this.autocomplete&&(this.multiple||this.state.input.options.values.splice(0),this.state.input.options.values.push({key:e[this.state.input.options.value],value:e[this.state.input.options.key]})),!this.autocomplete&&!this.state.input.options.values.find(n=>n.value==t)&&(t=null),await this.changeSelect(t),this.select2.val(this.multiple?this.getMultiValues():t).trigger("change")),t&&T.showUserMessage({type:"success",autoclose:!0}),t===null&&T.showUserMessage({type:"warning",message:"sdk.form.inputs.messages.warning.picklayer",autoclose:!1}),this.picked=!1}}catch(e){console.warn(e),T.showUserMessage({type:"warning",message:"sdk.form.inputs.messages.errors.picklayer",autoclose:!0}),this.picked=!1}},getMultiValues(){return[void 0,null,""].includes(this.state.value)?[]:Array.from(new Set(`${this.state.value}`.replace(/^{|}$/g,"").replace(/"/g,"").split(","))).filter(e=>this.autocomplete||this.state.input.options.values.map(({value:t})=>`${t}`).includes(`${e}`))},setAndListenSelect2Change(){this.select2.on("select2:unselect",e=>{let t=e.params.data.$value?e.params.data.$value:e.params.data.id;if(this.multiple){let n=this.getMultiValues().filter(s=>s!=t);this.autocomplete&&(this.state.input.options.values=this.state.input.options.values.filter(s=>t!=s.value)),this.changeSelect(n.length===0?null:`{${n.join()}}`)}this.showNullOption&&!this.multiple&&this.changeSelect(null)}),this.select2.on("select2:select",e=>{let t=e.params.data.$value?e.params.data.$value:e.params.data.id;t=this.showNullOption&&t===ms?null:t.toString(),this.multiple&&(t=this.getMultiValues().length>0?`{${[...this.getMultiValues(),t].join()}}`:`{${t}}`),this.changeSelect(t)})}},watch:{async"state.input.options.values"(e=[]){if(await this.$nextTick(),this.autocomplete)return;let t,n=e.length===0;(n||this.multiple&&this.getMultiValues().length===0)&&(t=ms),!n&&this.multiple&&this.getMultiValues().length>0&&(t=`{${this.getMultiValues().join()}}`),!n&&!this.multiple&&(t=(e.find(({value:o})=>o==this.state.value)||{value:ms}).value);let s=t!=this.state.value;this.state.value=t,this.select2.val(this.multiple?this.getMultiValues():this.state.value).trigger("change"),s&&this.change()}},async created(){this.unwatch,this.filterFieldsUnwatches;let{relation_id:e,filter_fields:t=[],relation_reference:n=!1,chain_filters:s=!1,allowmulti:o=!1}=this.state.input.options;if(this.multiple=o,n&&Array.isArray(t)&&t.length>0){this.setLoading(!0),this.isFilterFieldsReady=!1;let{referencedLayer:l,referencingLayer:a,fieldRef:{referencingField:u,referencedField:h}}=F.project.getRelationById(e),p=De(a),d=De(l),_=d.getFields();if(this.state.value!==null)try{let{data:m=[]}=await d.getFilterData({formatter:0,field:Fh({field:h[0],value:this.state.value})});this.state.input.options.values=((await p.getFilterData({fformatter:u[0],order:u[0],ffield:t.map((v,x)=>{let b=m[0].features[0].get(v)===void 0?`${ms}`:m[0].features[0].get(v);return this.filterFields.push({id:v,values:[{key:`[${_.find(w=>w.name===v).label}]`,value:`${ms}`}],value:b,disabled:s&&x>0&&`${ms}`===this.filterFields[t[x-1]]}),Fh({field:v,value:b})}).join("|AND,")})).data||[]).map(([v,x])=>({key:x,value:v})),s?((await d.getFilterData({unique:t[0],ordering:t[0],formatter:0})).forEach(v=>this.filterFields[0].values.push({key:v,value:v})),(await Promise.allSettled(t.slice(1).map((v,x)=>d.getFilterData({unique:t[x+1],ordering:t[x+1],formatter:0,field:this.filterFields.slice(0,x+1).filter(b=>b.value!=="null").map(b=>Fh({field:b.id,value:b.value})).join("|AND,")})))).forEach(({status:v,value:x},b)=>{v==="fulfilled"&&x.forEach(w=>this.filterFields[b+1].values.push({key:w,value:w}))})):(await Promise.allSettled(t.map(v=>d.getFilterData({unique:v,ordering:v,formatter:0})))).forEach(({status:v,value:x},b)=>{v==="fulfilled"&&x.forEach(w=>this.filterFields[b].values.push({key:w,value:w}))})}catch(m){console.warn(m)}else(await Promise.allSettled(t.map((m,v)=>(this.filterFields.push({id:m,values:[{key:`[${_.find(x=>x.name===m).label}]`,value:`${ms}`}],value:`${ms}`,disabled:s&&v>0}),d.getFilterData({unique:m,formatter:0,ordering:m}))))).forEach(({status:m,value:v},x)=>{m==="fulfilled"&&v.forEach(b=>this.filterFields[x].values.push({key:b,value:b}))});this.filterFieldsUnwatches=this.filterFields.map((m,v)=>this.$watch(()=>m.value,async x=>{if(this.setLoading(!0),s){for(let b=v+1;b<this.filterFields.length;b++)this.filterFields[b].value=`${ms}`,this.filterFields[b].values=[this.filterFields[b].values[0]],this.filterFields[b].disabled=`${ms}`===x;try{let b=this.filterFields.slice(0,v+1).filter(L=>`${ms}`!==L.value).map(L=>Fh({field:L.id,value:L.value})).join("|AND,"),{data:w=[]}=await d.getFilterData({field:b});if(w[0]&&w[0].features){let L=[];w[0].features.forEach(D=>{if(L.push(D.get(h)),v<this.filterFields.length-1){let G=D.get(this.filterFields[v+1].id);this.filterFields[v+1].values.push({key:G,value:G})}})}}catch(b){console.warn(b)}}this.state.input.options.values=((await p.getFilterData({fformatter:u[0],ordering:u[0],ffield:this.filterFields.filter(b=>`${ms}`!==b.value).map(b=>Fh({field:b.id,value:b.value})).join("|AND,")})).data||[]).map(([b,w])=>({key:w,value:b})),this.state.input.options.values.length>0&&(this.state.value=this.state.input.options.values[0].value,this.select2.val(this.state.value).trigger("change"),await this.changeSelect(this.state.value)),this.setLoading(!1)})),this.setLoading(!1),this.isFilterFieldsReady=!0}if(this.state.input.type==="select_autocomplete"){let l=this.state.input.options.layer_id;if(l)try{let a=T.getService("map").getProjectLayer(l).getEditingLayer()||De(l);if(this.showPickLayer=a&&lK.LayerTypes.TABLE!==a.getType()&&!(this.autocomplete&&this.state.input.options.filter_expression),this.showPickLayer){let{key:u,value:h,layer_id:p}=this.state.input.options;this.pickLayerInputService=new aK({layer_id:p,fields:[h,u],pick_type:a.isStarted&&a.isStarted()?"map":null})}}catch(a){console.warn(a)}}},async mounted(){await this.$nextTick();let e=$(this.$refs.select),t=this.getLanguage(),n=this.state.dropdownParent===void 0&&$("#g3w-view-content");this.autocomplete&&(this.select2=e.select2({minimumInputLength:1,dropdownParent:n,multiple:this.multiple,allowClear:this.showNullOption,placeholder:"",language:t,data:this.state.input.options.filter_expression?this.state.input.options.values.map(({key:s,value:o})=>({text:s,id:o,$value:o})):null,ajax:this.state.input.options.filter_expression?null:{delay:250,transport:(s,o,l)=>{let a=s.data.term;$(".select2-results__option.loading-results").siblings().hide(),this.service.getData({key:this.state.input.options.value,value:this.state.input.options.key,search:a}).then(u=>o(u)).catch(u=>{console.warn(u),l(u)})},processResults:(s,o)=>(o.page=o.page||1,{results:s,pagination:{more:!1}})}}),this.state.value&&(this.state.input.options.values.splice(0),await this.service.getKeyByValue({search:this.multiple?this.getMultiValues():this.state.value}))),this.autocomplete||(this.select2=e.select2({language:t,dropdownParent:n,multiple:this.multiple,minimumResultsForSearch:this.isMobile()?-1:null})),this.setAndListenSelect2Change(),this.multiple&&this.getMultiValues().length>0?this.select2.val(this.getMultiValues()).trigger("change"):this.setValue()},beforeDestroy(){this.pickLayerInputService&&(this.pickLayerInputService.clear(),this.pickLayerInputService=null),this.unwatch&&(this.unwatch(),this.unwatch=null),this.filterFieldsUnwatches&&(this.filterFieldsUnwatches.forEach(e=>e()),this.filterFieldsUnwatches=null)}},dK=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[e.showPickLayer?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"sdk.form.inputs.tooltips.picklayer",expression:"'sdk.form.inputs.tooltips.picklayer'",arg:"top"},{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"disabled"}],staticClass:"g3w-input-pick-layer skin-color",attrs:{slot:"label-action"},on:{click:function(s){return s.stopPropagation(),e.pickLayerValue.apply(null,arguments)}},slot:"label-action"},[n("i",{class:e.g3wtemplate.font.crosshairs})]):e._e(),e._v(" "),n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"disabled"}],attrs:{slot:"body",tabIndex:e.tabIndex},slot:"body"},[e.filterFields.length>0&&e.isFilterFieldsReady?n("div",{staticClass:"g3w-relation-reference-fields-content"},[e._l(e.filterFields,function(s,o){return[n("select",{directives:[{name:"select2",rawName:"v-select2",value:"filterFields",expression:"'filterFields'"}],ref:"filterField_"+s.id,refInFor:!0,staticClass:"form-control",staticStyle:{width:"100%"},attrs:{select2_value:s.value,indexItem:o,id:s.id,disabled:s.disabled}},e._l(s.values,function(l){var a=l.key,u=l.value;return n("option",{domProps:{value:e.getValue(u)}},[e._v(`
            `+e._s(a)+`
          `)])}),0)]}),e._v(" "),n("divider")],2):e._e(),e._v(" "),n("select",{ref:"select",staticClass:"form-control",staticStyle:{width:"100%"}},[e.showNullOption?n("option",{domProps:{value:e.select2NullValue}}):e._e(),e._v(" "),e._l(e.state.input.options.values,function(s){var o=s.key,l=s.value;return n("option",{domProps:{value:e.getValue(l)}},[e._v(e._s(o)+`
      `)])})],2)]),e._v(" "),e.loadingState==="error"?n("p",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"error-input-message",attrs:{slot:"message"},slot:"message"}):e._e()])},hK=[],fK=function(e){e&&e("data-v-ccb32bbe_0",{source:".g3w-input-pick-layer[data-v-ccb32bbe]{cursor:pointer;position:relative;top:2px;font-size:1.2em}",map:void 0,media:void 0})},pK="data-v-ccb32bbe",gK=void 0,mK=!1;yK=_K({render:dK,staticRenderFns:hK},fK,uK,pK,mK,gK,!1,w1,void 0,void 0),uA=yK});var Dh=He((zNe,hA)=>{dA();var vK=Vue.extend(uA);hA.exports=vK});function TK(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputMedia.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var bK,xK,wK,SK,EK,CK,IK,LK,NK,kK,fA,pA=R(()=>{ze();Wt();bK=ti(),{media_field:xK}=pc(),wK={name:"input-media",mixins:[bK],components:{"g3w-media":xK},data(){return{data:{value:null,mime_type:null},mediaid:`media_${Qe()}`,loading:!1}},methods:{onClick(){document.getElementById(this.mediaid).click()},clearMedia(){this.data.value=this.data.mime_type=this.state.value=null,this.change()},setMedia(){this.state.value&&(this.data.value=this.state.value.value,this.data.mime_type=this.state.value.mime_type)},async onChangeFile(e){let t=new FormData;t.append("csrfmiddlewaretoken",this.$cookie.get("csrftoken")),t.append(this.state.name,e.target.files[0]),this.loading=!0;try{let n=(await(await fetch(this.state.input.options.uploadurl,{method:"POST",headers:{Accept:"application/json"},body:t})).json())[this.state.name];console.log(n),n&&(this.state.value=n)}catch(n){console.warn(n),T.notify.error(this.$t("info.server_error"))}this.loading=!1}},watch:{"state.value"(){this.setMedia(),this.change()}},created(){this.setMedia()}},SK=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],attrs:{slot:"body"},slot:"body"},[n("div",{staticClass:"g3w_input_button skin-border-color",staticStyle:{"border-style":"solid","border-width":"2px",width:"100%",cursor:"pointer","text-align":"center"},on:{click:e.onClick}},[n("i",{staticClass:"fa-2x skin-color",class:e.g3wtemplate.getFontClass("file-upload"),staticStyle:{padding:"5px"}},[n("input",{class:{"input-error-validation":e.notvalid},staticStyle:{display:"none"},attrs:{id:e.mediaid,name:e.state.name,tabIndex:e.tabIndex,"data-url":e.state.input.options.uploadurl,type:"file"},on:{change:e.onChangeFile}})])]),e._v(" "),n("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),n("g3w-media",{attrs:{state:e.data}},[n("div",{staticClass:"clearmedia",on:{click:function(s){return s.stopPropagation(),e.clearMedia.apply(null,arguments)}}},[n("i",{staticClass:"g3w-icon",class:e.g3wtemplate.font["trash-o"]})])])],1)])},EK=[],CK=void 0,IK=void 0,LK=void 0,NK=!1;kK=TK({render:SK,staticRenderFns:EK},CK,wK,IK,NK,LK,!1,void 0,void 0,void 0),fA=kK});var S1=He((XNe,gA)=>{pA();var RK=Vue.extend(fA);gA.exports=RK});function $K(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputPickLayer.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var MK,AK,OK,PK,FK,DK,GK,jK,qK,BK,mA,_A=R(()=>{MK=ti(),AK=u1(),OK={name:"input-picklayer",mixins:[MK],methods:{pickLayer(){this.pickservice.pick().then(e=>this.state.value=e).catch(()=>{})},unpick(){setTimeout(()=>!this.pickservice.isPicked()&&this.pickservice.unpick(),200)}},created(){this.pickservice=new AK(this.state.input.options)},beforeDestroy(){this.pickservice.clear(),this.pickservice=null}},PK=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("div",{attrs:{slot:"body"},slot:"body"},[n("span",{staticClass:"skin-color",class:e.g3wtemplate.font.crosshairs,staticStyle:{left:"0",top:"7px",position:"absolute"}}),e._v(" "),n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},style:{cursor:e.editable?"pointer":null},attrs:{readonly:"readonly",tabIndex:e.tabIndex},domProps:{value:e.state.value},on:{input:[function(s){s.target.composing||e.$set(e.state,"value",s.target.value)},e.change],click:e.pickLayer,blur:e.unpick}})])])},FK=[],DK=void 0,GK=void 0,jK=void 0,qK=!1;BK=$K({render:PK,staticRenderFns:FK},DK,OK,GK,qK,jK,!1,void 0,void 0,void 0),mA=BK});var E1=He((KNe,yA)=>{_A();var UK=Vue.extend(mA);yA.exports=UK});function KK(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputColor.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var zK,VK,HK,WK,YK,XK,ZK,QK,JK,vA,bA=R(()=>{zK=ti(),VK={name:"input-color",mixins:[zK]},HK=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{cursor:"pointer"},attrs:{slot:"body",placeholder:e.state.default,type:"color",tabIndex:e.tabIndex,field:e.state.name,id:e.state.name},domProps:{value:e.state.value},on:{change:e.change,input:function(s){s.target.composing||e.$set(e.state,"value",s.target.value)}},slot:"body"})])},WK=[],YK=void 0,XK=void 0,ZK=void 0,QK=!1;JK=KK({render:HK,staticRenderFns:WK},YK,VK,XK,QK,ZK,!1,void 0,void 0,void 0),vA=JK});var C1=He((tTe,xA)=>{bA();var eJ=Vue.extend(vA);xA.exports=eJ});function cJ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputSliderRange.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var tJ,nJ,iJ,sJ,rJ,oJ,aJ,lJ,uJ,wA,SA=R(()=>{tJ=ti(),nJ={name:"input-slider-range",mixins:[tJ],watch:{"state.input.options.min"(){this.service.changeInfoMessage()},"state.input.options.max"(){this.service.changeInfoMessage()}}},iJ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("baseinput",{attrs:{state:e.state}},[n("div",{attrs:{slot:"body"},slot:"body"},[n("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.state.value))]),e._v(" "),n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:e.tabIndex,min:e.state.input.options.min,max:e.state.input.options.max,type:"range",step:e.state.input.options.step},domProps:{value:e.state.value},on:{change:e.change,__r:function(s){return e.$set(e.state,"value",s.target.value)}},slot:"body"})])])},sJ=[],rJ=void 0,oJ=void 0,aJ=void 0,lJ=!1;uJ=cJ({render:iJ,staticRenderFns:sJ},rJ,nJ,oJ,lJ,aJ,!1,void 0,void 0,void 0),wA=uJ});var I1=He((sTe,EA)=>{SA();var dJ=Vue.extend(wA);EA.exports=dJ});function bJ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputLonLat.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var hJ,fJ,pJ,gJ,mJ,_J,yJ,vJ,xJ,CA,IA=R(()=>{Wt();hJ=ti(),fJ={name:"input-lonlat",mixins:[hJ],data(){return{lonId:Qe(),latId:Qe(),coordinatebutton:{active:!1}}},computed:{getCoordinateActive(){return this.service.state.getCoordinateActive}},methods:{toggleGetCoordinate(){this.service.toggleGetCoordinate()},changeLonLat(){this.change(),this.setValue()},setValue(){this.state.value=[[1*this.state.values.lon,1*this.state.values.lat]]}},created(){this.state.values=this.state.values||{lon:0,lat:0},this.setValue(),this.service.setCoordinateButtonReactiveObject(this.coordinatebutton)},destroyed(){this.service.clear()}},pJ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"relative"}},[n("div",{staticStyle:{display:"flex","justify-content":"flex-end",height:"35px","margin-right":"12px","margin-bottom":"5px"}},[n("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.lonlat",expression:"'sdk.form.inputs.tooltips.lonlat'"}],staticClass:"action skin-color skin-border-color",class:e.g3wtemplate.font.crosshairs,staticStyle:{"border-radius":"5px","font-weight":"bold","font-size":"20px",cursor:"pointer"},style:{border:e.coordinatebutton.active?"2px solid":0},attrs:{"data-placement":"left"},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.toggleGetCoordinate.apply(null,arguments)}}})]),e._v(" "),n("baseinput",{attrs:{state:e.state}},[n("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label",for:e.lonId},slot:"label"},[e._v(e._s(e.state.labels.lon)+`
      `),e.state.validate&&e.state.validate.required?n("span",[e._v("*")]):e._e()]),e._v(" "),n("div",{attrs:{slot:"body"},slot:"body"},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.values.lon,expression:"state.values.lon"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:e.lonId,tabIndex:e.tabIndex,type:"number",min:"-180",max:"180",placeholder:"Lon"},domProps:{value:e.state.values.lon},on:{change:e.changeLonLat,input:function(s){s.target.composing||e.$set(e.state.values,"lon",s.target.value)}}})])]),e._v(" "),n("baseinput",{attrs:{state:e.state}},[n("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label",for:e.latId},slot:"label"},[e._v(e._s(e.state.labels.lat)+`
      `),e.state.validate&&e.state.validate.required?n("span",[e._v("*")]):e._e()]),e._v(" "),n("div",{attrs:{slot:"body"},slot:"body"},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.values.lat,expression:"state.values.lat"}],staticClass:"form-control",class:{"input-error-validation":e.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:e.latId,tabIndex:e.tabIndex,type:"number",min:"-90",max:"90",placeholder:"Lon"},domProps:{value:e.state.values.lat},on:{change:e.changeLonLat,input:function(s){s.target.composing||e.$set(e.state.values,"lat",s.target.value)}}})])])],1)},gJ=[],mJ=void 0,_J=void 0,yJ=void 0,vJ=!1;xJ=bJ({render:pJ,staticRenderFns:gJ},mJ,fJ,_J,vJ,yJ,!1,void 0,void 0,void 0),CA=xJ});var L1=He((lTe,LA)=>{IA();var wJ=Vue.extend(CA);LA.exports=wJ});function RJ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="InputG3W.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var SJ,EJ,CJ,IJ,LJ,NJ,TJ,kJ,MJ,ru,Zm=R(()=>{SJ={text_input:Hd(),texthtml_input:Jx(),textarea_input:t1(),integer_input:n1(),string_input:Hd(),float_input:i1(),radio_input:s1(),check_input:r1(),range_input:o1(),datetimepicker_input:a1(),unique_input:l1(),select_input:Dh(),media_input:S1(),select_autocomplete_input:Dh(),picklayer_input:E1(),color_input:C1(),slider_input:I1(),lonlat_input:L1()},EJ={name:"g3w-input",props:{state:{required:!0},addToValidate:{type:Function,required:!0},removeToValidate:{type:Function,required:!0},changeInput:{type:Function,required:!0}},components:{...SJ},computed:{type(){if(this.state.type!=="child")return this.state.input.type?`${this.state.input.type}_input`:`${this.state.type}_input`}},created(){this.state.type!=="child"&&!this.state.input.options&&(this.state.input.options={})}},CJ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.state.visible?n("div",[e.state.type!=="child"?n("div",[n(e.type,{tag:"component",attrs:{changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,state:e.state},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}}),e._v(" "),n("divider")],1):n("div",{staticClass:"skin-border-color field-child",staticStyle:{"border-top":"2px solid"}},[n("h4",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.state.label))]),e._v(" "),n("div",[e._v(" "+e._s(e.state.description)+" ")]),e._v(" "),e._l(e.state.fields,function(s){return n("g3w-input",{key:s.name,attrs:{state:s,changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})})],2)]):e._e()},IJ=[],LJ=void 0,NJ=void 0,TJ=void 0,kJ=!1;MJ=RJ({render:CJ,staticRenderFns:IJ},LJ,EJ,NJ,kJ,TJ,!1,void 0,void 0,void 0),ru=MJ});function qJ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="InputG3WFormInputs.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function N1(){let e=N1.styles||(N1.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var AJ,OJ,PJ,FJ,DJ,GJ,jJ,$J,Qm,T1=R(()=>{Zm();AJ={name:"g3w-form-inputs",props:{state:{type:Object,default:{fields:[]}},addToValidate:{type:Function},changeInput:{type:Function},show_required_field_message:{type:Boolean,default:!1},removeToValidate:{type:Function}},components:{G3wInput:ru}},OJ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"form-horizontal g3w-form"},[n("div",{staticClass:"box-primary"},[n("div",{staticClass:"box-body"},[e._l(e.state.fields,function(s){return[n("g3w-input",{attrs:{state:s,removeToValidate:e.removeToValidate,addToValidate:e.addToValidate,changeInput:e.changeInput},on:{addToValidate:e.addToValidate,changeInput:e.changeInput}})]})],2),e._v(" "),e.show_required_field_message?n("div",{staticStyle:{"caret-color":"rgba(0,0,0,0)"},attrs:{id:"g3w-for-inputs-required-inputs-message"}},[n("span",[e._v("*")]),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}]})]):e._e()])])},PJ=[],FJ=function(e){e&&e("data-v-2f4cd854_0",{source:"#g3w-for-inputs-required-inputs-message[data-v-2f4cd854]{margin-bottom:5px;font-weight:700;text-align:center;display:flex;align-items:center;justify-content:center}.box-body[data-v-2f4cd854]{padding:5px}",map:void 0,media:void 0})},DJ="data-v-2f4cd854",GJ=void 0,jJ=!1;$J=qJ({render:OJ,staticRenderFns:PJ},FJ,AJ,DJ,jJ,GJ,!1,N1,void 0,void 0),Qm=$J});function XJ(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="FormBody.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var BJ,UJ,zJ,VJ,HJ,WJ,YJ,ZJ,NA,TA=R(()=>{T1();BJ=Vue.extend({name:"form-body",props:["state","handleRelation"],data(){return{show:!0}},components:{G3wFormInputs:Qm},methods:{addToValidate(e){this.$emit("addtovalidate",e)},removeToValidate(e){this.$emit("removetovalidate",e)},changeInput(e){this.$emit("changeinput",e)}},computed:{hasFormStructure(){return!!this.state.formstructure}}}),UJ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("form",{staticClass:"form-horizontal g3w-form"},[n("div",{staticClass:"box-primary"},[n("div",{staticClass:"box-body"},[e.hasFormStructure?[n("tabs",{attrs:{layerid:e.state.layerid,feature:e.state.feature,handleRelation:e.handleRelation,contenttype:"editing",addToValidate:e.addToValidate,changeInput:e.changeInput,removeToValidate:e.removeToValidate,tabs:e.state.formstructure,fields:e.state.fields}})]:[n("g3w-form-inputs",{attrs:{state:e.state,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})]],2)])])])},zJ=[],VJ=void 0,HJ=void 0,WJ=void 0,YJ=!1;ZJ=XJ({render:UJ,staticRenderFns:zJ},VJ,BJ,HJ,YJ,WJ,!1,void 0,void 0,void 0),NA=ZJ});async function ou({field:e,feature:t,qgs_layer_id:n,parentData:s}={}){let{layer_id:o=n,default_expression:l,loading:a,default:u}=e.input.options;if(l){a.state="loading";try{let h=await gt.getData("expression:expression_eval",{inputs:{field_name:e.name,layer_id:o,qgs_layer_id:n,form_data:new ol.format.GeoJSON().writeFeatureObject(t),formatter:0,expression:l.expression,parent:s&&{form_data:new ol.format.GeoJSON().writeFeatureObject(s.feature),qgs_layer_id:s.qgs_layer_id,formatter:0}},outputs:!1});return e.value=h,h}catch(h){return u!==void 0&&(e.value=u),console.warn(h),Promise.reject(h)}finally{a.state="ready"}}}var k1=R(()=>{ei()});async function Gh({field:e,feature:t,qgs_layer_id:n,parentData:s}={}){let{key:o,value:l,layer_id:a=n,filter_expression:u,loading:h,orderbyvalue:p}=e.input.options;if(u){h.state="loading";try{let d=await gt.getData("expression:expression",{inputs:{field_name:e.name,layer_id:a,qgs_layer_id:n,form_data:new ol.format.GeoJSON().writeFeatureObject(t),parent:s&&{form_data:new ol.format.GeoJSON().writeFeatureObject(s.feature),qgs_layer_id:s.qgs_layer_id,formatter:0},formatter:0,expression:u.expression,ordering:[void 0,!1].includes(p)?o:l},outputs:!1});if(e.input.type==="select_autocomplete"){e.input.options.values=[];let _=[];for(let m=0;m<d.length;m++)_.push({key:d[m].properties[l],value:d[m].properties[o]});e.value&&!_.find(({value:m})=>m==e.value)&&_.unshift({key:`(${e.value})`,value:e.value}),e.input.options.values=_}return d}catch(d){return console.warn(d),Promise.reject(d)}finally{h.state="ready"}}}var R1=R(()=>{ei()});var kA={};qn(kA,{FormComponent:()=>jh,FormService:()=>au});var jh,au,M1=R(()=>{vn();Ws();ze();cL();TA();k1();R1();jh=class extends pt{constructor(t={}){super({...t,id:t.id||"form",perc:t.layer.getFormPercentage()!==null?t.layer.getFormPercentage():t.perc,service:new(t.service||au),vueComponentObject:t.vueComponentObject||lL});let n=t.components||[{id:t.id,title:t.title,name:t.name,root:!0,component:NA,headerComponent:t.headerComponent}];this.getService().addComponents(n),this.getService().setComponent(n[0].component),this.onafter("mount",()=>T.setModal(!0))}addFormComponents(t=[]){this.getService().addComponents(t)}addFormComponent(t){t&&this.getService().addComponent(t)}layout(){this.getInternalComponent()?.reloadLayout?.()}mount(t,n){return super.mount(t,n).then(()=>{T.setModal(!0)})}},au=class extends nt{constructor(t={}){super(t),this.state=null,this.eventBus=new Vue,this.eventBus.$on("set-loading-form",(n=!1)=>this.state.loading=n),this.force={update:!1,valid:!1},this.layer,this.setters=["setInitForm","setFormStructure","setFormFields","setupFields","setFormData","setField","setState","addActionsForForm","postRender"]}setInitForm(t={}){this._setInitForm(t)}setFormStructure(t){this.state.formstructure=t}setFormFields(t=[]){this.state.fields=t,this.handleFieldsWithExpression(t)}setupFields(){}setFormData(t=[]){this.setFormFields(t)}setField(t){}setState(t){this._setState(t)}addActionsForForm(t){}postRender(t){}init(t={}){this._setInitForm(t)}_setInitForm(t={}){let{fields:n,feature:s,parentData:o,layer:l,title:a="Form",formId:u,name:h,buttons:p={},context_inputs:d,isnew:_,footer:m={},headerComponent:v}=t;this.layer=l,this.feature=s.clone(),this.title=a,this.formId=u,this.name=h,this.buttons=p,this.context_inputs=d,this.parentData=o,this.headerComponent=v,this.state={layerid:l.getId(),loading:!1,components:[],disabledcomponents:[],component:null,headers:[],currentheaderid:null,fields:null,buttons:this.buttons,disabled:!1,isnew:_,valid:!0,update:s.isNew(),tovalidate:{},feature:this.feature,componentstovalidate:{},footer:m,ready:!1},this.force.update=s.isNew(),this.filter_expression_fields_dependencies={},this.default_expression_fields_dependencies={},this.default_expression_fields_on_update=[],this.setFormFields(n),this.layer&&t.formStructure&&this.setFormStructure(this.layer.getLayerEditingFormStructure())}setReady(t=!1){this.state.ready=t}async changeInput(t){try{this.feature.set(t.name,t.value),await this.evaluateFilterExpressionFields(t),await this.evaluateDefaultExpressionFields(t),this.isValid(t),this.isUpdated(t)}catch(n){console.warn(n)}this.emit("changeInput",t)}isUpdated(t){this.state.update=this.force.update||(this.state.update?!!this.state.fields.find(n=>n.update):t.update)}setUpdate(t=!1,n={}){let{force:s=!1}=n;this.force.update=s,this.state.update=this.force.update||t,this.state.update===!1&&this.state.fields.forEach(o=>o._value=o.value)}evaluateDefaultExpressionFields(t={}){let n=this.default_expression_fields_dependencies[t.name];if(n)return Promise.allSettled(n.map(s=>ou({parentData:this.parentData,qgs_layer_id:this.layer.getId(),field:this._getField(s),feature:this.feature})))}evaluateFilterExpressionFields(t={}){let n=this.filter_expression_fields_dependencies[t.name];if(n)return Promise.allSettled(n.map(s=>Gh({parentData:this.parentData,qgs_layer_id:this.layer.getId(),field:this._getField(s),feature:this.feature})))}_handleFieldWithFilterExpression(t,n){if(!n)return;let{referencing_fields:s=[],referenced_columns:o=[]}=n,l=new Set;[...o,...s].forEach(a=>l.add(a)),l.forEach(a=>{this.filter_expression_fields_dependencies[a]===void 0&&(this.filter_expression_fields_dependencies[a]=[]),this.filter_expression_fields_dependencies[a].push(t.name)}),Gh({parentData:this.parentData,qgs_layer_id:this.layer.getId(),feature:this.feature,field:t})}_handleFieldWithDefaultExpression(t,n){if(n){let{referencing_fields:s=[],referenced_columns:o=[],apply_on_update:l=!1}=n;if(!l&&!this.state.isnew)return;let a=new Set;[...o,...s].forEach(u=>a.add(u)),l&&(this.default_expression_fields_on_update.push(t),a.forEach(u=>{this.default_expression_fields_dependencies[u]===void 0&&(this.default_expression_fields_dependencies[u]=[]),this.default_expression_fields_dependencies[u].push(t.name)})),this.state.isnew&&ou({field:t,feature:this.feature,qgs_layer_id:this.layer.getId(),parentData:this.parentData})}}handleFieldsWithExpression(t=[]){t.forEach(n=>{let{options:s={}}=n.input;this._handleFieldWithFilterExpression(n,s.filter_expression),this._handleFieldWithDefaultExpression(n,s.default_expression)}),Object.keys(this.filter_expression_fields_dependencies).forEach(n=>this.evaluateFilterExpressionFields({name:n}))}setCurrentFormPercentage(t){this.layer.setFormPercentage(t)}setLoading(t=!1){this.state.loading=t}setValidComponent({id:t,valid:n}){this.state.componentstovalidate[t]=n,this.isValid()}getValidComponent(t){return this.state.componentstovalidate[t]}isValid(t){if(t){if(t.validate.mutually&&!t.validate.required&&!t.validate.empty&&(t.validate._valid=t.validate.valid,t.validate.mutually_valid=t.validate.mutually.reduce((n,s)=>n&&this.state.tovalidate[s].validate.empty,!0),t.validate.valid=t.validate.mutually_valid&&t.validate.valid),t.validate.mutually&&!t.validate.required&&t.validate.empty){t.value=null,t.validate.mutually_valid=!0,t.validate.valid=!0,t.validate._valid=!0;let n=[];for(let s=t.validate.mutually.length;s--;){let o=t.validate.mutually[s];this.state.tovalidate[o].validate.empty||n.push(o)}n.length<2&&n.forEach(s=>{this.state.tovalidate[s].validate.mutually_valid=!0,this.state.tovalidate[s].validate.valid=!0,setTimeout(()=>{this.state.tovalidate[s].validate.valid=this.state.tovalidate[s].validate._valid,this.state.valid=this.state.valid&&this.state.tovalidate[s].validate.valid})})}if(!t.validate.mutually&&!t.validate.empty&&(t.validate.min_field||t.validate.max_field)){let n=t.validate.min_field||t.validate.max_field;t.validate.valid=t.validate.min_field?this.state.tovalidate[t.validate.min_field].validate.empty||1*t.value>1*this.state.tovalidate[t.validate.min_field].value:this.state.tovalidate[t.validate.max_field].validate.empty||1*t.value<1*this.state.tovalidate[t.validate.max_field].value,t.validate.valid&&(this.state.tovalidate[n].validate.valid=!0)}}this.state.valid=Object.values(this.state.tovalidate).reduce((n,s)=>n&&s.validate.valid,!0)&&Object.values(this.state.componentstovalidate).reduce((n,s)=>n&&s,!0)}addComponents(t=[]){for(let n of t)this.addComponent(n)}addComponent(t){if(!t)return;let{id:n,title:s,name:o,icon:l,valid:a,headerComponent:u,header:h=!0}=t;a!==void 0&&(this.state.componentstovalidate[n]=a,this.state.valid=this.state.valid&&a,this.eventBus.$emit("add-component-validate",{id:n,valid:a})),h&&(this.state.headers.push({title:s,name:o,id:n,icon:l,component:u}),this.state.currentheaderid=this.state.currentheaderid||n),this.state.components.push(t)}replaceComponent({id:t,component:n}={}){this.state.components.splice(this.state.components.findIndex(s=>t===s.id),1,n)}disableComponent({id:t,disabled:n}={}){n?this.state.disabledcomponents.push(t):this.state.disabledcomponents=this.state.disabledcomponents.filter(s=>t!==s)}setCurrentComponentById(t){if(!this.state.disabledcomponents.includes(t))return this.setIdHeader(t),this.state.component=this.state.components.find(n=>t===n.id).component,this.state.component}setRootComponent(){this.state.component=this.state.components.find(t=>t.root).component}getRootComponent(){return this.state.components.find(t=>t.root).component}isRootComponent(t){return t===this.getRootComponent()}getComponentById(t){return this.state.components.find(n=>t===n.id)}setComponent(t){this.state.component=t}addedComponentTo(t="body"){this.state.addedcomponentto[t]=!0}addToValidate(t){this.state.tovalidate[t.name]=t,this.state.ready&&this.isValid(t)}removeToValidate(t){delete this.state.tovalidate[t.name],this.isValid()}getState(){return this.state}_setState(t){this.state=t}getFields(){return this.state.fields}_getField(t){return this.state.fields.find(n=>t===n.name)}getEventBus(){return this.eventBus}setIdHeader(t){this.state.currentheaderid=t}getContext(){return this.context_inputs.context}getSession(){return this.getContext().session}getInputs(){return this.context_inputs.inputs}handleRelation({relationId:t,feature:n}){}clearAll(){this.eventBus.$off("addtovalidate"),this.eventBus.$off("set-main-component"),this.eventBus.$off("set-loading-form"),this.eventBus.$off("component-validation"),this.eventBus.$off("disable-component")}async saveDefaultExpressionFieldsNotDependencies(){if(this.default_expression_fields_on_update.length!==0)try{let t=new Set(Object.values(this.default_expression_fields_dependencies).flat()),n=this.default_expression_fields_on_update.filter(({name:s})=>!t.has(s));await Promise.allSettled(n.map(s=>new Promise(async(o,l)=>{try{await ou({field:s,feature:this.feature,qgs_layer_id:this.layer.getId(),parentData:this.parentData}),o()}catch(a){console.warn(a),l()}})))}catch(t){console.warn(t)}}}});var RA={};qn(RA,{default:()=>oee});function see(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="ProjectsMenu.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function A1(){let e=A1.styles||(A1.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var QJ,KJ,JJ,eee,tee,nee,iee,ree,oee,MA=R(()=>{ze();Rt();QJ={name:"projects-menu",data(){return{state:null,loading:!1}},methods:{trigger(e){e.cbk?this._initCallback(e):e.href?window.open(e.href,"_blank"):e.route?T.goto(e.route):console.log("No action for "+e.title)},_initCallback(e){this._toggleModal(!0),e.cbk.call(e,{gid:e.gid}).then(t=>{t.then(n=>{n&&(document.title=n.state.html_page_title)}).fail(()=>{T.notify.error("<h4>"+_e("Error occurs loading map")+"</h4><h5>"+_e("Check internet connection or contact admin")+"</h5>")}).always(()=>{this._toggleModal(!1)})})},_toggleModal(e){T.showFullModal({show:e}),T.setLoadingContent(e)},logoSrc(e){let t,n=this.$options.host||"",s=e&&e.includes(window.initConfig.mediaurl),o=e&&!e.includes("static")&&!e.includes("media");return e?s?t=e:o?t=`${window.initConfig.mediaurl}${e}`:t="/static/client/images/FakeProjectThumb.png":t="/static/client/images/FakeProjectThumb.png",`${n}${t}`}}},KJ=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container",attrs:{id:"menu-projects"}},[n("div",{staticClass:"row row-equal"},[e._l(e.state.menuitems,function(s){return n("div",{key:s.title,staticClass:"col-sm-4 project-menu",on:{click:function(o){return e.trigger(s)}}},[n("div",{staticClass:"project-menu-item-image"},[n("img",{staticClass:"img-responsive",attrs:{src:e.logoSrc(s.thumbnail)}})]),e._v(" "),n("div",{staticClass:"project-menu-item-content"},[n("div",{staticClass:"project-menu-item-text"},[n("h4",{staticClass:"project-menu-item-title"},[e._v(e._s(s.title))]),e._v(" "),n("div",{domProps:{innerHTML:e._s(s.description)}})])])])}),e._v(" "),e.state.menuitems.length?e._e():n("div",{staticStyle:{"margin-left":"15px"}},[n("h2",{directives:[{name:"t",rawName:"v-t",value:"No more project for this group",expression:"'No more project for this group'"}]})])],2)])},JJ=[],eee=function(e){e&&e("data-v-4bf8831a_0",{source:".project-menu[data-v-4bf8831a]{cursor:pointer;margin-bottom:20px;margin-top:20px}.project-menu-item-image[data-v-4bf8831a]{position:relative;overflow:hidden;padding-bottom:50%}.project-menu-item-image img[data-v-4bf8831a]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.project-menu-item-content[data-v-4bf8831a]{padding:15px;background:rgba(255,255,255,.3)}.project-menu-item-text[data-v-4bf8831a]{position:relative;overflow:hidden;height:100%;text-align:justify}.project-menu-item-title[data-v-4bf8831a]{text-align:center;font-weight:700;background:rgba(255,255,255,.5);padding:5px}#menu-projects[data-v-4bf8831a]{width:100%;overflow-y:auto}#menu-projects .row-equal[data-v-4bf8831a]{display:flex;flex-wrap:wrap}",map:void 0,media:void 0})},tee="data-v-4bf8831a",nee=void 0,iee=!1;ree=see({render:KJ,staticRenderFns:JJ},eee,QJ,tee,iee,nee,!1,A1,void 0,void 0),oee=ree});var T,ze=R(()=>{vn();Ws();Ka();Rt();Ke();hv();Wt();Xr();$i();lg();fv();Xt();T=new class AA extends nt{#e={};#n={navbar:null,sidebar:null,viewport:null};constructor(t){super(t),this.setters=["setContent","getPermalink","getPrintParams"],this.isready=!1,this.push_content=!1,this._closeUserMessage=!0,this.dialog={dialog(n,s){s!=null&&(console.warn("GUI.dialog.confirm(message, callback) is deprecated"),n={message:n,callback:s,buttons:{cancel:{label:"Cancel"},confirm:{label:"OK"}}},n.buttons.cancel.callback=function(){return n.callback.call(this,!1)},n.buttons.confirm.callback=function(){return n.callback.call(this,!0)}),n=Object.assign({className:null,closeButton:!0,show:!0,container:"body",buttons:{},message:""},n);let o=$(`<div class="bootbox modal fade ${n.className||""}" tabindex="-1" role="dialog">
         <div class="modal-dialog ${{large:"modal-lg",small:"modal-sm"}[n.size]||""}">
           <div class="modal-content">
             ${n.title?"<div class='modal-header'><h4 class='modal-title'></h4></div>":""}
             <div class="modal-body"><div class="bootbox-body"></div></div>
           </div>
         </div>
       </div>`);o.find(".bootbox-body").html(n.message);let l="",a={};if(Object.keys(n.buttons).forEach((h,p,d)=>{typeof n.buttons[h]=="function"&&(n.buttons[h]={callback:n.buttons[h]}),n.buttons[h].label||(n.buttons[h].label=h),n.buttons[h].className||(n.buttons[h].className=d.length<=2&&p===d.length-1?"btn-primary":"btn-default"),l+="<button data-bbx='"+h+"' type='button' class='btn "+n.buttons[h].className+"'>"+n.buttons[h].label+"</button>",a[h]=n.buttons[h].callback}),n.closeButton){let h=$("<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>");n.title?o.find(".modal-header").prepend(h):h.css("margin-top","-10px").prependTo(o.find(".modal-body"))}n.title&&o.find(".modal-title").html(n.title),l&&(o.find(".modal-body").after("<div class='modal-footer'></div>"),o.find(".modal-footer").html(l));let u=(h,p,d)=>{h.stopPropagation(),h.preventDefault(),(typeof d!="function"||d.call(p,h)!==!1)&&p.modal("hide")};return o.on("hidden.bs.modal",function(h){h.target===this&&o.remove()}),o.on("shown.bs.modal",function(){o.find(".btn-primary:first").focus()}),o.on("click",".modal-footer button",function(h){u(h,o,a[$(this).data("bbx")])}),o.on("click",".bootbox-close-button",function(h){u(h,o,a.cancel)}),o.on("keyup",function(h){h.which===27&&a.cancel&&u(h,o,a.cancel)}),$(n.container).append(o),o.modal({backdrop:"static",keyboard:!1,show:!1}),n.show&&o.modal("show"),o}},this.dialog.confirm=this.dialog.dialog,this.notify={warning:(n,s=!1)=>{this.showUserMessage({type:"warning",message:n,autoclose:s})},error:(n,s=!1)=>{this.showUserMessage({type:"alert",message:n,autoclose:s})},info:(n,s=!1)=>{this.showUserMessage({type:"info",message:n,autoclose:s})},success:n=>{this.showUserMessage({type:"success",message:n,autoclose:!0})}},this.currentoutputplace="gui"}addComponent(t,n,s={}){let o=!0;return n==="sidebar"&&(!isMobile.any||t.mobile!==!1)?(F.sidebar.components.push(t),new(Vue.extend((iL(),kn(nL)).default))({component:t,opts:s}).$mount()):n!=="sidebar"&&this.#n[n]&&(o=this.#n[n].addComponents([t],s)),o&&this.setComponent(t),!0}setPushContent(t=!1){this.push_content=t}setComponent(t){let n=t.getId();this.#e[n]===void 0&&(this.#e[n]=t)}getComponent(t){return this.#e[t]}getComponents(){return this.#e}ready(){$(window).resize(()=>{requestAnimationFrame(()=>{this._layout()})}),$(".main-sidebar").on("transitionend",()=>{requestAnimationFrame(()=>{this._layout()})}),this._layout();let t=new URL(window.location);t.searchParams.delete("permalink_code"),window.history.replaceState(null,null,t);let n=()=>{let s=document.querySelector("#contents"),o=document.querySelector("#g3w-view-content");s.style.height=o.offsetHeight-(o.querySelector(".close-panel-block")?.offsetHeight||0)-(o.querySelector(".content_breadcrumb")?.offsetHeight||0)-(s.children[0]?50:0)+"px",s.children[0]&&(s.children[0].style.height=s.style.height),o.style.padding=s.children[0]?"15px":null;let l=$(window).height()-$(".navbar").height();$(".content-wrapper").css("height",l),$(".main-sidebar").css("height",l),$(".g3w-sidebarpanel").css("height",l),requestAnimationFrame(n)};requestAnimationFrame(n),this.emit("ready"),this.isready=!0}isReady(){return new Promise(t=>this.isready?t():this.once("ready",t))}getService(t){let n=this.getComponent(t);return n&&n.getService()}async downloadWrapper(t,n={}){this.setLoadingContent(!0),F.download=!0;try{await t(n)}catch(s){this.showUserMessage({type:"alert",message:s||"server_error",textMessage:!!s})}F.download=!1,this.setLoadingContent(!1)}isMobile(){return isMobile.any}getFontClass(t){return Vue.prototype.g3wtemplate.getFontClass(t)}getResourcesUrl(){return window.initConfig.staticurl+window.initConfig.client}async outputDataPlace(t,n={}){let s=Qe();if(this.outputDataPlace.reqs=(this.outputDataPlace.reqs||[]).concat(s),this.currentoutputplace==="iframe")return qd.outputDataPlace(t,n);this.setLoadingContent(!0);let o=["function","boolean"].includes(typeof n.show);Object.assign(n,{condition:o?n.show:!0,add:!1,...o?{}:n.show}),n.add||this.showQueryResults(n.title||"");try{let l=await t||{},u=(typeof n.condition=="function"?await n.condition(l):n.condition!==!1)&&s===this.outputDataPlace.reqs.at(-1);u&&this.outputDataPlace.reqs.splice(0),u&&n.before&&await n.before(l),u&&l.usermessage&&this.showUserMessage({type:l.usermessage.type,message:l.usermessage.message,autoclose:l.usermessage.autoclose}),u&&(this.getService("queryresults")||this.showQueryResults(n.title||"")).setQueryResponse(l,{add:!!n.add}),u&&n.after&&n.after(l)}catch(l){console.warn(l),this.showUserMessage({type:"alert",message:this.#i(l),textMessage:!0}),this.emit("error-output-data",l),await this.closeContent()}this.setLoadingContent(this.outputDataPlace.reqs.length>0)}showForm(t={}){let{FormComponent:n}=(M1(),kn(kA)),s=t.formComponent?new t.formComponent(t):new n(t);return this.setContent({perc:t.perc,content:s,split:t.split!==void 0?t.split:"h",crumb:t.crumb,push:!!t.push,showgoback:!!t.showgoback,closable:!1}),s.getService()}closeForm({pop:t=!1}={}){this.emit("closeform",!1);let n=!t&&F.viewport.content.backonclose&&F.viewport.content.contentsdata.length>1;(t||n)&&this.popContent(),!t&&!n&&(this.closeContent(),this.setModal(!1))}disableElement({element:t,disable:n}){$(t)[n?"addClass":"removeClass"]("g3w-disabled")}disableContent(t){F.viewport.content.disabled=t}disablePanel(t=!1){this.disableElement({element:"#g3w-sidebarpanel-placeholder",disable:t})}closeSideBar(){F.sidebar.components.forEach(t=>t.getOpen()&&t.state.closewhenshowviewportcontent&&t.collapsible&&t.click({open:!1}))}showQueryResults(t,n){return this.getService("queryresults").clearState(),n&&this.getService("queryresults").setQueryResponse(n),this.setContent({content:this.getComponent("queryresults"),title:"info.title",crumb:{title:"info.title",trigger:null},push:this.push_content,post_title:t,perc:isMobile.any?100:void 0}),this.getService("queryresults")}addNavbarItem(t){F.navbaritems.push(t)}async showPanel(t,n={}){F.sidebar.title=t.title,F.sidebar.parent="#g3w-sidebarpanel-placeholder";let s=F.sidebar.contentsdata.at(-1);s&&$(s.content.internalPanel.$el).hide();let o={parent:"#g3w-sidebarpanel-placeholder",...n},l=F.sidebar.parent,a=F.sidebar.contentsdata;if(t instanceof jQuery||typeof t=="string"){let u=typeof t=="string"?$(t).length?$(`<div> ${t} </div>`):$(t):t;$(l).append(u),a.push({content:u,options:o}),console.warn("[G3W-CLIENT] jQuery components will be discontinued, please update your code as soon as possible",a.at(-1))}else if(t.mount&&typeof t.mount=="function"){let u=a.findIndex(h=>h.content.getId&&t.getId()===h.content.getId());u!==-1&&(await Ot(a[u].content.unmount()),a.splice(u,1)),await Ot(t.mount(l,o.append||!1)),a.push({content:t,options:o})}else l.appendChild(t),a.push({content:t,options:o})}async closePanel(){let t=F.sidebar.contentsdata;if(t.length<=0)return;let n=t.slice(-1)[0].content;n instanceof pt||n instanceof Un?await Ot(n.unmount()):$(F.sidebar.parent).empty();let s=t.pop();s=null;let o=F.sidebar.contentsdata.at(-1);o&&($(o.content.internalPanel.$el).show(),F.sidebar.title=o.content.title)}showUserMessage({title:t,subtitle:n,message:s,type:o,position:l,size:a,draggable:u,duration:h,textMessage:p=!1,closable:d,autoclose:_,hooks:m={},iconClass:v=null}={}){return this.closeUserMessage(),setTimeout(()=>{Object.assign(F.viewport.usermessage,{id:Qe(),show:!0,message:s,textMessage:p,title:t,subtitle:n,position:l,duration:h,type:o,size:a,autoclose:_,closable:d,draggable:u,hooks:m,iconClass:v})}),F.viewport.usermessage}closeUserMessage(){Object.assign(F.viewport.usermessage,{id:null,show:!1,textMessage:!1,message:""})}showModalDialog(t={}){return this.dialog.dialog(t)}showSpinner(t={}){let n=t.container||"body",s=t.id||"loadspinner",o=t.where||"prepend",l=t.style||"",a=t.transparent&&"background-color: transparent"||"",u=t.center&&"margin: auto"||"";$(`#${s}`).length||$(n)[o].call($(n),`<div id="${s}" class="spinner-wrapper ${l}" style="${a}"><div class="spinner ${l}" style="${u}"></div></div>`)}hideSpinner(t="loadspinner"){$(`#${t}`).remove()}toggleSidebar(){document.body.classList.contains("sidebar-open")?this.hideSidebar():document.body.classList.contains("sidebar-collapse")||window.innerWidth<=767?this.showSidebar():this.hideSidebar()}showFullModal({element:t="#modal-fullscreen",show:n=!0}={}){$(t).modal(n?"show":"hide")}disableSideBar(t=!0){F.gui.sidebar.disabled=t}async showContent(t={}){return this.setLoadingContent(!1),t.perc=isMobile.any?100:t.perc,await this.setContent(t),!0}async pushContent(t={}){t.perc=isMobile.any?100:t.perc,t.push=!0,await this.setContent(t)}getContentLength(){return F.viewport.content.contentsdata.length}setCurrentContentOptions(t={}){let n=F.viewport.content.contentsdata.at(-1)||null;n&&t.title&&(n.options.title=t.title),n&&t.crumb&&(n.options.crumb=t.crumb)}getCurrentContent(){return F.viewport.content.contentsdata.at(-1)||null}getProjectMenuDOM({projects:t=[],host:n,cbk:s}={}){let o={projects:t&&Array.isArray(t)&&t,cbk:s,host:n};return new pt({...o,id:"projectsmenu",title:o.title||"menu",internalComponent:new(Vue.extend((MA(),kn(RA)).default))({host:o.host,state:{menuitems:(o.projects||el()).map(l=>({title:l.title,description:l.description,thumbnail:l.thumbnail,gid:l.gid,cbk:o.cbk||((a={})=>_t(async()=>{let u=await AA.getService("map").addMapExtentUrlParameterToUrl($d(a.gid));try{history.replaceState(null,null,u)}catch(h){console.warn(h)}location.replace(u)}))}))}})}).getInternalComponent().$mount().$el}toggleUserMessage(t=!0){this._closeUserMessage=t}hideClientMenu(){window.initConfig.user=null}hideChangeMaps(){window.initConfig.projects=[]}setLoadingContent(t=!1){return F.viewport.content.loading=t,t&&new Promise(n=>setTimeout(n,200))}async setContent(t={}){this.emit("opencontent",!0),this._closeUserMessage&&this.closeUserMessage();let n=F.viewport,s=F.gui.layout[F.gui.layout.__current].rightpanel;Object.assign(t,{content:t.content||null,title:t.title||"",push:!!t.push,split:t.split||"h",perc:t.perc??(isMobile.any?100:n.split==="h"?s.width:s.height),backonclose:!!t.backonclose,showtitle:t.showtitle??!0});let o=this.getComponent("contents"),l=t.content;if(Object.assign(n.content,{title:t.title,split:t.split===void 0?null:t.split,closable:t.closable===void 0||t.closable,backonclose:t.backonclose===void 0||t.backonclose,style:t.style===void 0?{}:t.style,headertools:t.headertools===void 0?[]:t.headertools,showgoback:t.showgoback===void 0||t.showgoback,contentsdata:F.contentsdata}),n.split=t.split,(!t.perc||!t.push)&&await this.#t(),Object.assign(t,{parent:o.internalComponent.$el,append:!0}),o.parent=t.parent,l instanceof jQuery||typeof l=="string"){let a=typeof l=="string"?$(l).length?$(`<div> ${l} </div>`):$(l):l;$(o.parent).append(a),F.contentsdata.push({content:a,options:t}),console.warn("[G3W-CLIENT] jQuery components will be discontinued, please update your code as soon as possible",F.contentsdata.at(-1))}else if(typeof l?.mount=="function"){let a=F.contentsdata.findIndex(u=>u.content.getId&&l.getId()===u.content.getId());a!==-1&&(await Ot(F.contentsdata[a].content.unmount()),F.contentsdata.splice(a,1)),await Ot(l.mount(o.parent,t.append||!1)),F.contentsdata.push({content:l,options:t})}else o.parent.appendChild(l),F.contentsdata.push({content:l,options:t});Array.from(o.internalComponent.$el.children).forEach((a,u,h)=>a.style.display=u===h.length-1?"block":"none"),o.setOpen(!0),await this._layout(!0),window.innerWidth<767&&this.hideSidebar()}hideContent(t){let n=F.gui.layout[F.gui.layout.__current].rightpanel[F.viewport.split==="h"?"width":"height"];return this._layout(!t),n}async closeContent(){return this.emit("closecontent",!1),F.viewport.content.contentsdata.length>0&&(this.getComponent("contents").setOpen(!1),await this.#t(),this._layout(!1),await Vue.nextTick()),this.getComponent("map")}async popContent(){if(F.viewport.content.contentsdata.length===0)return Promise.reject();let n=F.contentsdata.at(-2).options,s=F.viewport;if(Object.assign(s.content,{title:n.title,split:n.split!==void 0?n.split:null,closable:n.closable!==void 0?n.closable:!0,backonclose:n.backonclose!==void 0?n.backonclose:!0,contentsdata:F.contentsdata,style:n.style!==void 0?n.style:{},headertools:n.headertools!==void 0?n.headertools:[],showgoback:n.showgoback!==void 0?n.showgoback:!0}),s.split=n.split??s.split,n.perc||await this.#t(),this._layout(!!n.perc),await Vue.nextTick(),F.contentsdata.length<=0)return;let o=F.contentsdata.slice(-1)[0].content;return o instanceof pt||o instanceof Un?await Ot(o.unmount()):o.remove(),F.contentsdata.pop(),Array.from(this.getComponent("contents").internalComponent.$el.children).forEach((l,a,u)=>l.style.display=a===u.length-1?"block":"none"),this._layout(),F.contentsdata.at(-1)}isSidebarVisible(){return!document.body.classList.contains("sidebar-collapse")}setModal(t=!1,n){let s=this.getService("map");t?s.startDrawGreyCover(n):s.stopDrawGreyCover()}showSidebar(){document.body.classList.add("sidebar-open"),document.body.classList.remove("sidebar-collapse"),F.gui.sidebar.open=!0}hideSidebar(){document.body.classList.remove("sidebar-open"),document.body.classList.add("sidebar-collapse"),F.gui.sidebar.open=!1}getSize({element:t,what:n}){if(t&&n)return F.sizes[t][n]}getPrintParams(t={}){return t}async getPermalink(t,n){if(this.getPermalink.loading)return;this.getPermalink.loading=!0;let s=F.project,o=Array.from(t.searchParams.entries()),l=(m,v,x=[])=>(m.forEach((b,w)=>{let L=Object.keys(b).reduce((D,G)=>Object.assign(D,v[w][G]!==void 0&&b[G]!==v[w][G]?{[G]:b[G]}:{}),{});Array.isArray(b.nodes)&&(L.nodes=[],l(b.nodes,v[w].nodes,L.nodes),L.nodes=L.nodes.filter(Boolean),L.nodes.length||delete L.nodes),Object.keys(L).length&&(L[b.id?"id":"name"]=b.id||b.name,x.push(L))}),x),a=s.state.layers.map(m=>De(m.id).config.styles.some((v,x)=>v.current!==m.styles[x].current)&&{id:m.id,styles:De(m.id).config.styles}).filter(Boolean),u=l(s.getLayersStore().state.layerstree[0].nodes,s.state.layerstree).filter(Boolean),p=(await(await fetch("/api/embed/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t,data:{...n,initextent:this.getService("map").getMapExtent(),lng:F.language,initbaselayer:F.baseLayerId||void 0,toc_tab_default:["baselayers","layers","legend"].find(m=>m===this.getComponent("catalog").getInternalComponent().activeTab),layers:a.length?a:void 0,layerstree:u.length?u:void 0}})})).json())?.data?.permalink_code,d=Object.assign(document.createElement("template"),{innerHTML:`
        <dialog id="share_modal">
          <h4 style="margin: 0; padding: .5em; color: #FFF; position: sticky; top: 0; background-color: #212c31"><i class="fa fa-share-alt" style="margin-right: .5ch;"></i> ${_e("Share via link")}</h4>
          <form method="dialog">
            <input readonly value = "${t.toString()}" onfocus="event.target.select()" class="form-control mt-2" id="embed-link" />
            <label style="margin: 1em 0;" ${o.length?"":"hidden"}>
              <input type="checkbox" data-key="permalink_code" checked>
              Generate permalink
            </label>
            <div id="embed-params" style="border-top: thin solid #ccc;padding: 1em 0;" hidden>
              <span>Choose params to share</span>
              <div style="display: flex;gap: 1em;padding: 1em 0;">
                ${o.map(([m,v])=>`<label title="${v}"><input type="checkbox" data-key="${m}" checked> ${m}</label>`).join("")}
              </div>
            </div>
            <menu style="display: flex; justify-content: end;">
              <button type="submit" onclick="document.querySelector('#embed-link').focus() || document.execCommand('copy')" class="form-control btn btn-success mt-2">${_e("Copy share URL")}</button>
            </menu>
          </form>
        </dialog>
      `.trim()}).content.firstChild,_=()=>{let m,v=d.querySelector("#embed-params"),x=d.querySelector("#embed-link");d.querySelector('input[type="checkbox"][data-key="permalink_code"]').checked?(v.hidden=!0,x.value=t.origin+"/api/embed/"+p+"/"):(v.hidden=!1,m=Array.from(v.querySelectorAll('input[type="checkbox"]:checked')).map(b=>`${encodeURIComponent(b.getAttribute("data-key"))}=${encodeURIComponent(t.searchParams.get(b.getAttribute("data-key")))}`).join("&"),x.value=t.origin+t.pathname+(m?`?${m}`:""))};_(),d.addEventListener("click",m=>{m.target===d&&d.close()}),d.querySelectorAll('input[type="checkbox"]').forEach(m=>m.addEventListener("change",_)),d.addEventListener("close",()=>{d.remove(),this.getPermalink.loading=!1}),document.body.appendChild(d),d.showModal()}async _layout(t){typeof t=="boolean"&&(this._layout.secondary=t);let n=this._layout.secondary,s=F.viewport,o=F.gui.layout,l=document.querySelector("#contents"),a=document.querySelector(".content-wrapper"),u=$("#app")[0].getBoundingClientRect().width-$(".main-sidebar")[0].getBoundingClientRect().width-$(".main-sidebar").offset().left,h=$(window).height()-$(".navbar").height(),p=o[o.__current].rightpanel,d={split:s.split,...F.contentsdata.at(-1)?.options||{}},_=d.split==="h",m=d.split==="v";a.style.flexDirection=_?"row":"column",a.style.justifyContent="space-between";let v=d.perc===100||(_?p.width_100:p.height_100),x=v?1:(_?p.width:p.height)/100;l.parentElement.classList.toggle("full-size",v),Object.assign(s.content.sizes,{width:_?n?Math.max(u*x,200):0:n?u:0,height:m?n?Math.max(h*x,200):0:n?h:0}),Object.assign(s.map.sizes,{width:u-(_?s.content.sizes.width:0),height:h-(m?s.content.sizes.height:0)}),document.body.classList.contains("sidebar-open")&&window.innerWidth<767&&Object.assign(s.map.sizes,{width:window.innerWidth,height:window.innerHeight}),await Vue.nextTick(),this.getService("map").layout({width:s.map.sizes.width,height:s.map.sizes.height}),F.contentsdata.forEach(b=>{try{typeof b.content.layout=="function"&&b.content.layout(s.content.sizes.width,l.style.height.replace("px",""))}catch(w){this.showUserMessage({type:"warning",message:w.toString(),autoclose:!0}),setTimeout(()=>this._layout(),1e3)}}),this.emit("resize"),window.localStorage.setItem("SIDEBAR",JSON.stringify(p))}#i(t){let n=Zn(t);if(n==="Error")return`CLIENT - ${t.message}`;if(n==="Object"&&t.responseJSON&&t.responseJSON.result===!1){let s=t.responseJSON.error;return`${(s.code||"").toUpperCase()} ${s.data||""} ${s.message||""}`}return n==="Object"&&t.responseText?t.responseText:n==="Array"?t.map(s=>this.#i(s)).join(" "):t||"server_error"}async#t(){await Promise.allSettled((F.contentsdata||[]).map(async t=>{t.content instanceof pt||t.content instanceof Un?await Ot(t.content.unmount()):$(g3wsdk.gui.GUI.getComponent("contents").parent).empty()})),F.contentsdata.splice(0,F.contentsdata.length)}}});var OA,gt,ei=R(()=>{ft();Ke();ze();Wm();lu();ii();$i();Rt();OA=async(e=[])=>{let t=await Promise.allSettled(e);return t.some(n=>n.status==="fulfilled")?t.filter(n=>n.status==="fulfilled").map(n=>n.value):Promise.reject(t.filter(n=>n.status==="rejected").map(n=>n.reason))},gt={async getData(e,t={}){let{inputs:n={},outputs:s={}}=t,o=this[e](n);return s&&T.outputDataPlace(o,s),await await o},async"query:coordinates"({coordinates:e,layerIds:t=[],multilayers:n=!1,query_point_tolerance:s=Go,addExternal:o=!0,feature_count:l}={}){let a=T.getService("catalog").state.external.vector.some(h=>h.selected),u=Zi({QUERYABLE:!0,SELECTED_OR_ALL:t.length===0,VISIBLE:!0,IDS:t.length?t.map(h=>h):void 0});try{return{result:!0,type:"ows",query:{coordinates:e,type:"coordinates",external:{add:(!a||t.length>0)&&u.length===1&&u[0].isSelected()?!1:o,filter:{SELECTED:a}}},data:((!a||t.length>0)&&await Ot(this.getQueryLayersPromisesByCoordinates(u,{multilayers:n,feature_count:l,query_point_tolerance:s,coordinates:e}))||[]).flatMap(({data:h=[]})=>h)}}catch(h){throw console.warn(h),h}},async"query:bbox"({bbox:e,feature_count:t=F.project.state.feature_count||5,filterConfig:n={},multilayers:s=!1,excludeSelected:o=null,addExternal:l=!0,layersFilterObject:a={SELECTED_OR_ALL:!0,QUERYABLE:!0,VISIBLE:!0}}={}){let u=T.getService("catalog").state.external.vector.some(p=>p.selected),h=u||(typeof o=="boolean"?o:!1);try{return{result:!0,type:"ows",query:{bbox:e,type:"bbox",filterConfig:n,external:{add:l,filter:{SELECTED:h}}},data:(!u&&await this.getQueryLayersPromisesByGeometry(Zi(a),{geometry:ol.geom.Polygon.fromExtent(e),feature_count:t,filterConfig:n,multilayers:s,projection:T.getService("map").getMap().getView().getProjection()})||[]).flatMap(({data:p=[]})=>p)}}catch(p){throw console.warn(p),p}},async"query:polygon"({feature:e,feature_count:t=F.project.state.feature_count||5,filterConfig:n={},multilayers:s=!1,layerName:o="",excludeSelected:l=null,external:a={add:!0,filter:{SELECTED:!1}},type:u="polygon"}={}){let h=e.getGeometry();try{return{result:!0,type:"ows",error:!h,query:{fid:T.getService("catalog").state.external.vector.some(p=>p.selected)?e.getId():e.get(jt),geometry:h,layerName:o,type:u,filterConfig:n,external:a},usermessage:!h&&{type:"warning",message:`${o} - ${_e("mapcontrols.querybypolygon.no_geometry")}`,messagetext:!0,autoclose:!1},data:(await this.getQueryLayersPromisesByGeometry(Zi({...typeof l=="boolean"?{SELECTED:!l}:{SELECTED_OR_ALL:!0},QUERYABLE:!0,VISIBLE:!0}),{geometry:h,multilayers:s,feature_count:t,filterConfig:n,projection:F.project.getProjection()})||[]).flatMap(({data:p=[]})=>p)}}catch(p){throw console.warn(p),p}},async"search:features"(e={layer,filter,raw:!1,queryUrl,feature_count,formatter:1,ordering,autofilter:0,page,page_sizes}){let{layer:t,...n}=e;n.filter=[].concat(n.filter),n.page_size=(n.page_sizes||[])[0];let s=[],o=[],l=[],a=[],u=[],h=p=>(p.nodes||[p]).forEach(d=>{d.id?u.push(d.id):h(d)});return F.project.state.layerstree.forEach(h),{data:(await Promise.allSettled([].concat(t).sort((p,d)=>u.indexOf(p.state.id)>u.indexOf(d.state.id)?1:-1).map((p,d)=>p.searchFeatures({...n,filter:n.filter[d]})))).filter(p=>p.status==="fulfilled"&&(p.value?.data||[])[0].features?.length>0).map(({value:p}={})=>{if(n.autofilter===1&&(p.data||[]).forEach(({layer:d,filtertoken:_})=>{_&&(d.state.selection.active=d.state.filter.active=!0,d.setFilterToken(_))}),n.page_sizes){let d=(p.data||[])[0].features,_=(p.data||[])[0].layer,m=Math.max(...Array.isArray(n.page_sizes)?n.page_sizes:[n.page_sizes]);o.push(m<=p.count?n.page_sizes:[...n.page_sizes.filter(v=>v<p.count),p.count]),s.push(p.count),l.push(d&&p.count>d.length),a.push(_)}if(n.raw)return{data:p};if(Array.isArray(p.data)&&p.data.length>0)return p.data[0]}),query:{type:"search",search:n.filter,autofilter:!!n.autofilter,pagination:n.page_size&&{pages:n.page&&s.map(p=>Math.ceil(p/n.page_size)),current:n.page&&s.map(()=>n.page),page_sizes:o,current_sizes:s.map((p,d)=>o[d][0]),counts:s,paginate:l,getData:{params:n.filter.slice(0,a.length).map(p=>({...n,filter:p})),method:"searchFeatures",layers:[].concat(a)}}},type:"api"}},async"search:fids"({layer:e,formatter:t=0,fids:n=[]}={}){let s=[];try{s=(e&&await e.getFeatureByFids({fids:n,formatter:t})||[]).map(o=>{let l=o.properties!==void 0?o.properties:{};l[jt]=o.id;let a=new ol.Feature(o.geometry&&new ol.geom[o.geometry.type](o.geometry.coordinates));return a.setProperties(l),a.setId(o.id),a})}catch(o){console.warn(o)}return{data:[{layer:e,features:s}],query:{type:"search",fids:n}}},async"search:layersfids"({layers:e=[],fids:t=[],formatter:n=0}={}){let s=[];try{s=(await Promise.all(e.map((o,l)=>this["search:fids"]({layer:o,fids:t[l],formatter:n})))).map(o=>o.data)}catch(o){console.warn(o)}return{data:s,query:{type:"search"}}},async"expression:expression"(e={}){try{let t=await Ye.post({url:`${F.project.getUrl("vector_data")}${e.layer_id}/`,contentType:"application/json",data:JSON.stringify(e)});return t.result?t.vector.data.features||[]:Promise.reject(JSON.stringify(t.error))}catch(t){return console.warn(t),Promise.reject(t)}},async"expression:expression_eval"(e={}){try{let{result:t,value:n,error:s}=await Ye.post({url:`/api/expression_eval/${F.project.getId()}/`,contentType:"application/json",data:JSON.stringify(e)});return t?n:Promise.reject(JSON.stringify(s))}catch(t){return console.warn(t),Promise.reject(t)}},async"proxy:wms"({url:e,method:t="GET",params:n={},headers:s={}}={}){t==="GET"&&(e=new URL(e),Object.keys(n).forEach(o=>e.searchParams.set(o,n[o])),e=e.toString());try{return{response:await Ye.post({data:JSON.stringify({url:e,params:n,headers:s,method:t}),contentType:"application/json",url:`${window.initConfig.proxyurl}`}),data:JSON.stringify({url:e,params:n,headers:s,method:t})}}catch(o){console.warn(o)}},"proxy:data"(e={}){},getQueryLayersPromisesByCoordinates(e,{coordinates:t,feature_count:n=10,query_point_tolerance:s=Go,multilayers:o=!1,reproject:l=!0}={}){if(e.length===0)return _t(Promise.resolve(e));let a=T.getService("map").getMap(),u=a.getSize(),h=a.getView().getProjection(),p=a.getView().getResolution();return _t(async()=>await OA(Object.values(o?yl(e,d=>`${d.getInfoFormat()}:${d.getInfoUrl()}:${d.getMultiLayerId()}`):e).map(d=>Ot([].concat(d)[0].query(o?{feature_count:n,coordinates:t,query_point_tolerance:s,mapProjection:h,size:u,resolution:p,reproject:l,layers:d}:{feature_count:n,coordinates:t,query_point_tolerance:s,mapProjection:h,size:u,resolution:p})))))},async getQueryLayersPromisesByGeometry(e,{geometry:t,projection:n,filterConfig:s={},multilayers:o=!1,feature_count:l=10}={}){if(e.length===0)return[];let a=n.getCode();return await OA(Object.values(o?yl(e,u=>`${u.getMultiLayerId()}_${u.getProjection().getCode()}`):e).map(u=>{let h=[].concat(u)[0],p=h.getProjection().getCode(),d={config:s,type:"geometry",value:a===p?t:t.clone().transform(a,p)};return Ot(h.query(o?{filter:d,feature_count:l,layers:u}:{filter:d,feature_count:l,filterConfig:s}))}))}}});var Kn,ma=R(()=>{ft();ze();Kn=class extends ol.control.Control{constructor(t={}){if(t.ol)return super({element:t.ol.element}),this._options=t,this._control=t.ol,this.positionCode=t.position||"tl",this.offline=!0,$(this._control.element).addClass("ol-control-"+this.positionCode),this;t.enabled=t.enabled??!!t.interactionClass,t.visible=t.visible??!0;let n=(t.name||"").split(" ").join("-").toLowerCase();t.element=t.element||new(Vue.extend({template:`<div class="ol-${n} ol-unselectable ol-control">
        <button type="button" v-t-tooltip="'${t.tipLabel||n}'">
          ${t.label||""}${t.customClass?'<i class="'+t.customClass+'"></i>':""}
        </button>
      </div>`}))().$mount().$el,super(t),this._options=t,this.cursorClass=t.cursorClass,this._originalonlick=null,this._onclick=t.onclick,this._enabled=t.enabled,this.offline=t.offline??!0,this.name=n,this.id=`${this.name}_${Math.floor(Math.random()*1e6)}`,this.eventKeys={},this.positionCode=t.position||"tl",this.priority=t.priority||0,this.clickmap=t.clickmap||!1,$(t.element).on("click",s=>this._handleClick(s)),this.setVisible(t.visible),this._options.postRender&&this._options.postRender.call(this),this._toggled=!1,this._interactionClassOptions=t.interactionClassOptions,t.interactionClass&&this.initInteraction(t)}setMouseCursor(t,n=this.cursorClass){this.getMap().getViewport().classList[t?"add":"remove"](n)}initInteraction(t={}){let{visible:n=!0,enabled:s=!0,toggled:o=!1,clickmap:l=!1,interactionClass:a=null,autountoggle:u=!1,geometryTypes:h=[],onhover:p=!1,help:d=null,toggledTool:_,interactionClassOptions:m={},layers:v=[],spatialMethod:x}=t;if(this.layers=v,this.unwatches=[],this._visible=n,this.clickmap=l,this._interactionClass=a,this._interaction=null,this._autountoggle=u,this._geometryTypes=h,this._onhover=p,this._help=d,this._helpButton,this._toolButton,this.toggledTool,this.spatialMethod=x,this._interactionClassOptions=m,o===!0&&this.on("setMap",()=>this.toggle(o)),this._help&&this._createModalHelp(),_&&this.createControlTool(_),this.setEnable(s),this.spatialMethod){let b=this.spatialMethod,w=null;this.on("toggled",({toggled:L})=>{L===!0?w=this.on("change-spatial-method",this.runSpatialQuery):w!==null&&(ol.Observable.unByKey(w),w=null,this.setSpatialMethod(b),this.clear())})}}isClickMap(){return this.clickmap}isToggled(){return this._toggled}setEventKey({eventType:t,eventKey:n}){this.eventKeys[t]={eventKey:n,originalHandler:n.listener}}resetOriginalHandlerEvent(t){this.eventKeys[t]&&this.eventKeys[t].eventKey&&(ol.Observable.unByKey(this.eventKeys[t].eventKey),this.eventKeys[t].eventKey=this.on(t,this.eventKeys[t].originalHandler))}overwriteEventHandler({eventType:t,handler:n}){this.eventKeys[t]&&this.eventKeys[t].eventKey&&(ol.Observable.unByKey(this.eventKeys[t].eventKey),this.eventKeys[t].eventKey=this.on(t,n))}getPosition(t){return t=t||this.positionCode,{top:t.includes("t"),left:t.includes("l"),bottom:t.includes("b"),right:t.includes("r")}}_handleClick(t){this._enabled&&(this.toggle(),t.preventDefault(),this.dispatchEvent("controlclick"))}layout(t){let n=$(t.getViewport()).find(`.ol-control-${this.positionCode}`);if(n.length){let s=this.getPosition(),o=n.last(),l=s.left?o.position().left:o.position().right,a=s.left?"left":"right",u=$(this.element).position()[a]+l+o[0].offsetWidth+2;$(this.element).css(a,`${u}px`)}}setMap(t){if(this._options.onSetMap&&this._options.onSetMap.call(this,{setter:"before",map:t}),this.layout(t),this._control?this._control.setMap(t):super.setMap(t),!this._interaction&&this._interactionClass&&(this._interaction=new this._interactionClass(this._interactionClassOptions),t.addInteraction(this._interaction),this._interaction.setActive(!1)),this._interaction&&this.cursorClass&&this._interaction.on("change:active",n=>this.setMouseCursor(n.target.get(n.key))),this._onclick){let n=$(this.element).children("button"),s=!1;$(this.element).on("click",async()=>{s||(s=!0,n.addClass("g3w-ol-disabled"),await this._onclick(),n.removeClass("g3w-ol-disabled"),s=!1)})}this.dispatchEvent({type:"setMap",map:t}),this._options.onSetMap&&this._options.onSetMap.call(this,{setter:"after",map:t})}hideControl(){let t=$(this.element).position().left,n=$(this.element).outerWidth(),s=t;$(this.element).siblings(".ol-control-tl").each(function(){$(this).position().left>t&&(s=$(this).position().left,n>$(this).outerWidth()&&(t=t+(n-$(this).outerWidth())),$(this).css("left",`${t}px`),t=s,n=$(this).outerWidth())}),$(this.element).hide()}setEnable(t){$(this.element).find("button").first().toggleClass("g3w-ol-disabled",!t),!t&&this._interaction&&this._interaction.setActive(!1),this._enabled=t}getEnable(){return this._enabled}setVisible(t=!0){this._visible=t,$(this.element)[t?"show":"hide"]()}isVisible(){return this._visible}overwriteOnClickEvent(t){this._originalonlick=this._originalonlick||this._onclick,this._onclick=t}resetOriginalOnClickEvent(){this._onclick=this._originalonlick||this._onclick,this._originalonlick=null}onSelectLayer(){}runSpatialQuery(){}clear(){}onAddExternalLayer({layer:t,unWatches:n}={}){}onRemoveExternalLayer(t){}checkVisibile(t){return!0}enable(){$(this.element).removeClass("g3w-disabled")}disable(){$(this.element).addClass("g3w-disabled")}createControlTool(t={}){switch(console.warn("[G3W-CLIENT] this.toggledTool is deprecated"),t.type){case"spatialMethod":this.toggledTool={template:`
            <div style="width: 100%; padding: 5px;">
              <select ref="select" style="width: 100%" :search="false" v-select2="'method'">
                <option v-for="method in methods">{{ method }}</option>
              </select>
            </div>`,data:()=>({methods:rd,method:this.getSpatialMethod()}),watch:{method:n=>this.setSpatialMethod(n)},created(){T.toggleUserMessage(!1)},beforeDestroy(){T.toggleUserMessage(!0)}};break;case"custom":this.toggledTool=t.component;break}t.how==="how"&&this._onhover&&(this._toolButton=$(`<span style="display:none" class="tool_mapcontrol_button"><i class="${T.getFontClass("tool")}"></i></span>`),$(this.element).prepend(this._toolButton),this._toolButton.on("click",n=>{n.stopPropagation(),this.showToggledTool(!0)}),$(this.element).hover(()=>this._toggled&&this._toolButton.show()),$(this.element).mouseleave(()=>this._toolButton.hide()))}showToggledTool(t=!0){console.warn("[G3W-CLIENT] this.toggledTool is deprecated"),t?T.showUserMessage({title:this.toggledTool.__title,type:"tool",size:"small",iconClass:this.toggledTool.__iconClass,closable:!!this._toolButton,hooks:{body:this.toggledTool}}):T.closeUserMessage()}toggle(t=!this._toggled,n={}){n.parent=n.parent===void 0?!1:n.parent,t!==this._toggled&&(this._toggled=t,this.cursorClass&&this.setMouseCursor(t),t&&this.getMap().getControls().forEach(s=>{s.id&&s.toggle&&s.id!==this.id&&s.id!==n.parent&&s.toggle(!1)}),this._interaction&&this._interaction.setActive(t),$(this.element).find("button").first()[t?"addClass":"removeClass"]("g3w-ol-toggled"),t&&this._toolButton?this._toolButton.show():!t&&this._toolButton&&this._toolButton.hide(),this.toggledTool&&this.showToggledTool(this._toggled),this.dispatchEvent({type:"toggled",toggled:t}),this._options.onToggled&&this._options.onToggled.call(this,t))}getGeometryTypes(){return this._geometryTypes}setGeometryTypes(t){this._geometryTypes=t}getInteraction(){return this._interaction}setSpatialMethod(t="intersects"){this.spatialMethod=t,this.dispatchEvent({type:"change-spatial-method",spatialMethod:this.spatialMethod})}getSpatialMethod(){return this.spatialMethod}setLayers(t=[]){this.layers=t}getOlControl(){return this._control}showHide(){this.element&&$(this.element).toggle()}}});var PA=R(()=>{ze();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.addlayer=e.setupControl.addlayers=function(){Object.keys(window.initConfig.mapcontrols).filter(t=>["addlayers","addlayer"].includes(t)).forEach(t=>{!isMobile.any&&!e.getMapControlByType("addlayer")&&e.createMapControl({id:"addlayer",options:{tipLabel:"Add Layer",onSetMap(n){n.setter==="after"&&$(this.element).on("click",()=>T.getService("map").showAddLayerModal())}}})})}})});function _a({map:e,feature:t}={}){let n=document.createElement("div");n.className="mtooltip mtooltip-measure",n.style.pointerEvents="none";let s=new ol.Overlay({element:n,offset:[0,-15],positioning:"bottom-center",stopEvent:!1});e.addOverlay(s);let o=t.getGeometry().on("change",l=>{let a=l.target,u=Km(a),h=uu(a),p=P1(a);n.innerHTML=[h&&`Area: ${h} <br>`,h&&u&&'<div style="width: 100%; padding: 3px; border-bottom: 2px solid #fff"></div> ',u,p&&`${O1(a.getCenter(),t.get("endCoordinates"))}, ${p}`].filter(Boolean).join(""),a instanceof ol.geom.Polygon&&s.setPosition(a.getInteriorPoint().getCoordinates()),a instanceof ol.geom.MultiPolygon&&s.setPosition(a.getInteriorPoints().getCoordinates()[0]),(a instanceof ol.geom.LineString||a instanceof ol.geom.MultiLineString)&&s.setPosition(a.getLastCoordinate()),a instanceof ol.geom.Circle&&t.get("endCoordinates")&&s.setPosition(t.get("endCoordinates"))});return{tooltip:s,unbyKey:o,remove(){s.getMap()?.removeOverlay(s),ol.Observable.unByKey(o)}}}function FA({map:e,tooltip:t,unbyKey:n}){e.removeOverlay(t),ol.Observable.unByKey(n)}function uu(e,t=F.map.epsg,n=F.map.unit){if(!/^Polygon|^MultiPolygon/.test(e.getType()))return;let s=t==="EPSG:3857"||n==="degrees"?ol.sphere.getArea(e,{projection:t}):e.getArea();return n==="nautical"?`${s*29155334959812285e-23} nmi\xB2`:s>1e4?`${cu(s/1e6)} km\xB2`:`${cu(s)} m\xB2`}function Km(e,t=F.map.epsg,n=F.map.unit){let s=/^Polygon|^MultiPolygon/.test(e.getType())&&(e?.getPolygons?.()||[e]).flatMap(l=>l.getLinearRing().getCoordinates())||[];if(!(/^Line|^MultiLine/.test(e.getType())||/^Polygon|^MultiPolygon/.test(e.getType())&&s.length>2))return;let o=t==="EPSG:3857"||n==="degrees"?ol.sphere.getLength(s.length?new ol.geom.LineString(s):e,{projection:t}):/^Multi/.test(e.getType())?e.getLineStrings().reduce((l,a)=>l+=a.getLength(),0):(s.length?new ol.geom.LineString(s):e).getLength();return n==="nautical"?`${o*.0005399568} nm`:o>100?`${cu(o/1e3)} km`:`${cu(o)} m`}function O1(e,t){return parseInt(Math.atan2(e[0]-t[0],e[1]-t[1])*180/Math.PI)+"\xB0"}function P1(e,t=F.map.epsg,n=F.map.unit){if(e.getType()!=="Circle")return;let s=e.getRadius();return n==="nautical"?`${s*.0005399568} nm`:s>100?`${cu(s/1e3)} km`:`${cu(s)} m`}var cu,ya=R(()=>{Ke();cu=e=>(Math.round(e*100)/100).toFixed(2)});var Jm,F1,DA=R(()=>{Jm=Ut(z0());Ke();ze();ma();ga();ya();ya();ya();ya();ya();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.annotation=async function(){e.addControl("annotation",new F1({features:(await Jm.default.getItem("annotations"))?.[F.project.state.id]?.features||[]}))}});F1=class e extends Kn{static FID=1;constructor(t={}){super({...t,name:"annotation",tipLabel:"Annotation",clickmap:!0,enabled:!0}),this._annotation={layer:new ol.layer.Vector({source:new ol.source.Vector}),type:null,feature:null,style:{color:"rgb(244, 78, 59)",width:3,radius:8,opacity:.5,rotation:0,fontsize:15,direction:null},constraints:{circle:{radius:0,unit:1},line:{length:0,unit:1},rectangle:{width:0,wunit:1,height:0,hunit:1}},text:"",show_text:!1,show_info:!1},this._interaction=null,this._measureTooltip=null,this._interactions={},this._upload=!1;let n=new ol.format.GeoJSON({dataProjection:T.getService("map").getEpsg(),featureProjection:T.getService("map").getEpsg()}).readFeatures({type:"FeatureCollection",features:[...F.project.state.annotations?.features||[],...t?.features||[]]});n.forEach(o=>{o.get("type")==="Circle"&&o.setGeometry(new ol.geom.Circle(o.get("center"),Number(o.get("radius")))),e.FID=Math.max(e.FID,o.getId())+1,o.setStyle(this.#r(o.get("type")))}),this._annotation.layer.getSource().addFeatures(n),this._annotation.layer.getSource().on("addfeature",this.#n.bind(this)),this._annotation.layer.on("change",async()=>{let o=T.getService("map").getEpsg();Jm.default.setItem("annotations",Object.assign(await Jm.default.getItem("annotations")||{},{[F.project.state.id]:JSON.parse(JSON.stringify(new ol.format.GeoJSON().writeFeaturesObject(this._annotation.layer.getSource().getFeatures(),{dataProjection:o,featureProjection:o})))}))}),this._interactions.select=new ol.interaction.Select({layers:[this._annotation.layer],style:o=>this.#r(o.get("type"))(o)}),this._interactions.modify=new ol.interaction.Modify({features:this._interactions.select.getFeatures(),insertVertexCondition:()=>this._annotation.feature&&this._annotation.feature.get("type")!=="Rectangle"}),this._interactions.modify.handleDragEvent=new Proxy(this._interactions.modify.handleDragEvent,{apply:(o,l,a)=>(Reflect.apply(o,l,a),this.#i(...a))}),this._interactions.select.on("select",o=>this.editFeature(o.selected[0])),this._interactions.modify.on("modifystart",this.#t.bind(this)),this._interactions.modify.on("modifyend",this.#s.bind(this));let s=this;this.on("toggled",({toggled:o})=>{if(!o)return T.closeUserMessage();T.showUserMessage({title:"Annotation",type:"tool",size:"small",iconClass:"annotation",closable:!1,hooks:{body:{data:()=>this._annotation,template:`
              <div style="width: 100%; padding: 5px; max-height: 80vh; overflow-y: auto;">

                <!-- DOCS URL -->
                <a
                  :href           = "'https://g3w-suite.readthedocs.io/en/v3.9.x/g3wsuite_client.html#map-controls'"
                  target          = "_blank"
                  style           = "position: absolute;inset: 1em 1em auto auto;"
                  data-i18n-title = "Docs"
                  data-placement  = "bottom"
                >
                  <i :class = "$fa('external-link')"></i>
                </a>

                <!-- SHAPE TYPES -->
                <div style = "display: flex; justify-content: space-between; flex-flow: wrap; padding-bottom: 10px; margin-bottom: 10px; border-bottom: 1px solid #eee;">
                  <input
                    v-for              = "shape in ['Point', 'LineString', 'Polygon', 'Circle', 'Rectangle', 'Text']"
                    v-t-tooltip:bottom = "'annotation_types.' + shape"
                    type               = "radio"
                    :value             = "shape"
                    v-model            = "type"
                    @click.stop        = "type = type === shape ? null : shape"
                    :class             = "[type === shape && 'skin-background-color']"
                    :style             = "{
                      appearance: 'none',
                      display:    'inline-block',
                      width:      '30px',
                      height:     '30px',
                      border:     '1px solid #ccc',
                      cursor:     'pointer',
                      background: 'url(' + getShapeIconUrl(shape) + ') no-repeat center',
                    }"
                  />
                </div>

                <!-- SHAPES SAVED -->
                <ul v-if = "!feature && !type && features.length > 0" style="list-style-type: none; padding: 0;">
                  <li
                    v-for = "feat in features"
                    :key  = "feat.getId()"
                    style = "display:flex;gap:1ch;"
                  >
                    <button 
                      @click.stop = "editFeature(feat)"
                      :style      = "{
                        width:      '100%',
                        margin:     '3px 0',
                        border:     'solid 1px #ccc',
                        padding:    '5px',
                        background: 'url(' + getShapeIconUrl(feat.get('type')) + ') 5px center no-repeat',
                      }"
                    >
                      {{ feat.get('text') }}
                    </button>
                    <button
                      :class            = "$fa('trash')"
                      @click.stop       = "remove(feat)"
                      style             = "background:none; border: none; color: red;"
                      v-t-tooltip:right = "'Remove'"
                    ></button>
                  </li>
                </ul>

                <!-- SHAPE CONSTRAINT: \u201CSegment length (line)\u201D -->
                <div v-if = "'LineString' === type && !feature" style="display: flex; align-items: end;">
                  <label style = "margin: 0; width: 100%">
                    <span v-t = "'Length'"></span>
                    <input 
                      class   = "form-control"
                      type    = "number" 
                      name    = "length" 
                      min     = "0" 
                      step    = "1"
                      v-model = "constraints.line.length"
                    />
                  </label>
                  <select style = "max-width: 25%" class = "form-control" v-model = "constraints.line.unit">
                    <option value = "1">m</option>
                    <option value = "1000">km</option>
                  </select> 
                </div>

                <!-- SHAPE CONSTRAINT: \u201CSegment length (polygon)\u201D -->
                <div v-if = "'Polygon' === type && !feature" style="display: flex; align-items: end;">
                  <label style = "margin: 0; width: 100%">
                    <span v-t = "'Length'"></span>
                    <input 
                      class   = "form-control"
                      type    = "number" 
                      name    = "length" 
                      min     = "0" 
                      step    = "1"
                      v-model = "constraints.line.length"
                    />
                  </label>
                  <select style = "max-width: 25%" class = "form-control" v-model = "constraints.line.unit">
                    <option value = "1">m</option>
                    <option value = "1000">km</option>
                  </select> 
                </div>

                <!-- SHAPE CONSTRAINT: \u201CSegment width (rectangle)\u201D -->
                <div v-if = "'Rectangle' === type && !feature" style="display: flex; align-items: end;">
                  <label style = "margin: 0; width: 100%">
                    <span v-t = "'Width Length'"></span>
                    <input 
                      class   = "form-control"
                      type    = "number" 
                      name    = "width" 
                      min     = "0" 
                      step    = "1"
                      v-model = "constraints.rectangle.width"
                    />
                  </label>
                  <select style = "max-width: 25%" class = "form-control" v-model = "constraints.rectangle.wunit">
                    <option value = "1">m</option>
                    <option value = "1000">km</option>
                  </select> 
                </div>

                <!-- SHAPE CONSTRAINT: \u201CSegment height (rectangle)\u201D -->
                <div v-if = "'Rectangle' === type && !feature" style="display: flex; align-items: end;">
                  <label style = "margin: 0; width: 100%">
                    <span v-t = "'Height Length'"></span>
                    <input 
                      class   = "form-control"
                      type    = "number" 
                      name    = "height" 
                      min     = "0" 
                      step    = "1"
                      v-model = "constraints.rectangle.height"
                    />
                  </label>
                  <select style = "max-width: 25%" class = "form-control" v-model = "constraints.rectangle.hunit">
                    <option value = "1">m</option>
                    <option value = "1000">km</option>
                  </select> 
                </div>

                <!-- SHAPE CONSTRAINT: \u201CCircle radius\u201D -->
                <div v-if = "'Circle' === type && !feature" style="display: flex; align-items: end;">
                  <label style = "margin: 0; width: 100%">
                    <span v-t = "'Radius'"></span>
                    <input 
                      class   = "form-control"
                      type    = "number" 
                      name    = "radius" 
                      min     = "0" 
                      step    = "1"
                      v-model = "constraints.circle.radius"
                    />
                  </label>
                  <select style = "max-width: 25%" class = "form-control" v-model = "constraints.circle.unit">
                    <option value = "1">m</option>
                    <option value = "1000">km</option>
                  </select> 
                </div>

                <!-- SHAPE LABEL -->
                <input
                  v-if    = "feature" 
                  class   = "form-control" 
                  type    = "text" 
                  v-model = "text"
                  style   = "display: block; margin: 5px 0; 0 border:0;"
                />

                <!-- SHAPE LABEL (rotation) -->
                <label v-if = "feature && 'Text' === feature.get('type')" style = "display: block;">
                  <span v-t = "'Rotation'"></span>
                  <input 
                    type    = "range" 
                    name    = "rotation" 
                    min     = "-180" 
                    step    = "1"
                    max     = "180" 
                    v-model = "style.rotation"
                  />
                </label>

                <label v-if = "feature && 'Text' === feature.get('type')" style = "display: block;">
                  <span v-t = "'Font Size'"></span>
                  <input 
                    type    = "range" 
                    name    = "fontsize" 
                    min     = "10" 
                    step    = "1"
                    max     = "30" 
                    v-model = "style.fontsize"
                  />
                </label>

                <!-- SHAPE COLOR -->
                <div
                  v-if  = "feature && 'Text' !== feature.get('type')"
                  style = "display: flex; justify-content: space-between; flex-flow: wrap; margin-bottom: 10px; gap: 5px; justify-content: center;"
                >
                  <input
                    v-for                     = "color in [
                      'rgb(77, 77, 77)', 'rgb(153, 153, 153)', 'rgb(255, 255, 255)', 'rgb(244, 78, 59)', 'rgb(254, 146, 0)', 'rgb(252, 220, 0)', 'rgb(219, 223, 0)', 'rgb(164, 221, 0)', 'rgb(104, 204, 202)', 'rgb(115, 216, 255)', 'rgb(174, 161, 255)', 'rgb(253, 161, 255)',
                      'rgb(51, 51, 51)', 'rgb(128, 128, 128)', 'rgb(204, 204, 204)', 'rgb(211, 49, 21)', 'rgb(226, 115, 0)', 'rgb(252, 196, 0)', 'rgb(176, 188, 0)', 'rgb(104, 188, 0)', 'rgb(22, 165, 165)',  'rgb(0, 156, 224)',   'rgb(123, 100, 255)', 'rgb(250, 40, 255)',
                      'rgb(0, 0, 0)',    'rgb(102, 102, 102)', 'rgb(179, 179, 179)', 'rgb(159, 5, 0)',   'rgb(196, 81, 0)',  'rgb(251, 158, 0)', 'rgb(128, 137, 0)', 'rgb(25, 77, 51)',  'rgb(12, 121, 125)',  'rgb(0, 98, 177)',    'rgb(101, 50, 148)',  'rgb(171, 20, 158)',
                    ]"
                    v-t-tooltip:bottom = "color"
                    type               = "radio"
                    :value             = "color"
                    v-model            = "style.color"
                    :style             = "{
                      appearance: 'none',
                      display:    'inline-block',
                      width:      '20px',
                      height:     '20px',
                      border:     style.color == color ? 'solid' : '1px solid #ccc',
                      cursor:     'pointer',
                      background: color,
                    }"
                  />
                </div>

                <!-- SHAPE RADIUS (point) -->
                <div v-if = "feature && 'Point' === feature.get('type')">
                  <label for = "radius" v-t = "'Radius'"></label>
                  <input 
                    type    = "range" 
                    name    = "radius" 
                    min     = "3" 
                    step    = "1"
                    max     = "20" 
                    v-model = "style.radius"
                  />
                </div>

                <!-- SHAPE STROKE WIDTH -->
                <div v-if = "feature && ['LineString', 'Polygon', 'Rectangle', 'Circle'].includes(feature.get('type'))">
                  <label for = "stroke" v-t = "'Stroke'"></label>
                  <input 
                    type    = "range" 
                    name    = "stroke" 
                    min     = "0.5" 
                    step    = "0.5"
                    max     = "8" 
                    v-model = "style.width"
                  />
                </div>
                <!-- LINE DIRECTION (line) -->
                <div v-if = "feature && 'LineString' === feature.get('type')">
                  <label v-t = "'Direction'"></label>
                  <select class = "form-control" style = "margin-bottom: 5px;" v-model = "style.direction">
                    <option :value = "null">---</option>
                    <option value  = "forward" v-t = "'Forward'"></option>
                    <option value  = "backward" v-t = "'Backward'"></option>  
                  </select>   
                </div>

                <!-- SHAPE OPACITY -->
                <div v-if = "feature && ['Polygon', 'Rectangle' , 'Circle'].includes(feature.get('type'))">
                  <label for = "opacity" v-t = "'Opacity'"></label>
                  <input 
                    type    = "range" 
                    name    = "opacity" 
                    min     = "0" 
                    step    = "0.05"
                    max     = "1" 
                    v-model = "style.opacity"
                  />
                </div>

                <!-- SHAPE INFO -->
                <div v-if="feature" style = "display: flex; justify-content: space-between;">
                  <label :hidden = "'Text' === feature.get('type')">
                    <input 
                      name    = "feature-text"
                      type    = "checkbox"
                      v-model = "show_text"
                      style   = "width: 1.25em; aspect-ratio: 1; vertical-align: sub; accent-color: var(--skin-color);"
                    />
                    <span v-t = "'Show Text'" ></span>
                  </label>
                  <label :hidden = "'Text' === feature.get('type')">
                    <input 
                      name    = "feature-info"
                      type    = "checkbox" 
                      v-model = "show_info"
                      style   = "width: 1.25em; aspect-ratio: 1; vertical-align: sub; accent-color: var(--skin-color);"
                    />
                    <span v-t = "'Show Info'" ></span>
                  </label>
                </div>

                <!-- SHAPES ACTIONS -->
                <div style = "display: flex; justify-content: flex-end; gap: 5px; font-size: 1.2em; border-top: 1px solid #eee; padding: 10px 0; margin-top: 10px;">
                  <button :class = "$fa('link')"                                       @click.stop = "share"       style = "background:none; border: none;" v-t-tooltip:bottom = "'Share'"     :hidden = "!features.length || feature || type"></button>
                  <button :class = "$fa('file-upload')"                                @click.stop = "upload"      style = "background:none; border: none;" v-t-tooltip:bottom = "'Import'"    :hidden = "feature || type"></button>
                  <button :class = "$fa('file-download')"                              @click.stop = "download"    style = "background:none; border: none;" v-t-tooltip:bottom = "'Export'"    :hidden = "!features.length || (type && !feature)"></button>
                  <button :class = "layer.isVisible() ? $fa('eye') : $fa('eye-close')" @click.stop = "toggleLayer" style = "background:none; border: none;" v-t-tooltip:bottom = "'Show/Hide'" :hidden = "!features.length || feature || type"></button>
                  <section class = "annotations-close-back" style = "display: flex; gap: 5px; margin-left: auto;">
                    <button :class = "$fa('arrow-left')"    @click.stop = "showAll"  style = "background:none; border: none; margin-left: auto;" v-t-tooltip:bottom = "'Show All'" :hidden = "!type && !feature"></button>
                    <button :class = "$fa('close')"         @click.stop = "close"    style = "background:none; border: none; margin-left: auto;" v-t-tooltip:bottom = "'close'"    ></button>
                  </section>  
                </div>

              </div>`,computed:{features(){return this.layer.getSource().getFeatures().filter(l=>[void 0,F.project.getId()].includes(l.get("pid")))}},methods:{getShapeIconUrl(l){return`${window.initConfig.urls.clienturl}/images/${{Point:"mActionAddPoint",LineString:"mActionAddPolyline",Polygon:"mActionAddPolygon",Circle:"mActionAddBasicCircle",Rectangle:"mActionAddBasicRectangle",Text:"mActionTextAnnotation"}[l]}.svg`},showAll(){this.type=null,this.feature&&(this.feature.selected=!1,this.feature=null),this.layer.changed()},remove(l){if(l){this.layer.getSource().removeFeature(l);return}this.feature=null,this.type=null},editFeature(l){s.editFeature(l)},upload(){s.showUploadModal()},download:()=>{F.download=!0,Si(new Blob([new TextEncoder().encode(JSON.stringify(new ol.format.GeoJSON().writeFeaturesObject(this.#e(this._annotation.feature?[this._annotation.feature]:this._annotation.layer.getSource().getFeatures(),T.getService("map").getEpsg(),"EPSG:4326"),{featureProjection:"EPSG:4326"}),null,2))],{type:"application/json;charset=utf-8"}),"annotation.json"),F.download=!1},close(){s.toggle(!1)},share(){document.querySelector(".nav-embedmap").click()},toggleLayer(){this.layer.setVisible(!this.layer.getVisible())}},watch:{type(l){s.changeType(l)},text(l){this.feature&&this.feature.set("text",l),this.layer.changed()},show_text(l){this.feature&&this.feature.set("show_text",l),this.layer.changed()},show_info(l){this.feature&&this.feature.set("show_info",l),this.layer.changed()},feature:l=>{l&&this._interactions.select.getFeatures().getArray().length===0&&this._interactions.select.getFeatures().push(l),!l&&this._interactions.select.getFeatures().getArray().length&&this._interactions.select.getFeatures().clear(),this._measureTooltip&&(this._measureTooltip.remove(),this._measureTooltip=null),this._interactions.modify.setActive(!!l)},style:{deep:!0,handler(l){this.feature&&this.feature.set("style",Object.assign(this.feature.get("style")||{},{color:l.color,width:Number(l.width),radius:Number(l.radius),opacity:Number(l.opacity),rotation:Number(l.rotation),fontsize:Number(l.fontsize),direction:l.direction})),this.layer.changed()}},constraints:{deep:!0,handler(l){s.getInteraction()&&(l.circle&&(s.getInteraction().radius=l.circle.radius*l.circle.unit),l.line&&(s.getInteraction().length=l.line.length*l.line.unit),l.rectangle&&(s.getInteraction().width=l.rectangle.width,s.getInteraction().height=l.rectangle.height))}}},created(){this.layer.getSource().getFeatures().length>0&&s.changeType(),s.getMap().addInteraction(s._interactions.select),s.getMap().addInteraction(s._interactions.modify),s._interactions.select.setActive(!0)},beforeDestroy(){s.changeType(),s.getMap().removeInteraction(s._interactions.select),s.getMap().removeInteraction(s._interactions.modify),this.layer.getSource().getFeatures().forEach(l=>l.selected=!1),this.layer.changed()}}}})}),T.getService("map").on("set-layer-zindex",({zindex:o})=>o>this._annotation.layer.getZIndex()&&this._annotation.layer.setZIndex(o+1)),T.onbefore("getPermalink",(o,l)=>{let a=this._annotation.layer.getSource().getFeatures();a.length>0&&(l.annotations=JSON.parse(new ol.format.GeoJSON().writeFeatures(a)))}),T.onbefore("getPrintParams",(o={})=>{let l=this._annotation.layer.getSource().getFeatures();if(!l.length>0||!this._annotation.layer.isVisible())return;let a=u=>`#${u.slice(4,-1).split(",").map(h=>(+h).toString(16).padStart(2,0)).join("")}`;o.ANNOTATIONS=JSON.stringify(new ol.format.GeoJSON().writeFeaturesObject(l.map(u=>{let h=u.clone();return h.setId(u.getId()),h.unset("text"),h.unset("pid"),h.unset("show_info"),h.unset("show_text"),h.set("label",""),u.get("type")==="Text"&&(h.set("label",u.get("text")),h.set("style",{rotation:u.get("style").rotation,fontsize:u.get("style").fontsize})),u.get("type")==="Point"&&(h.set("label",`${h.get("show_info")&&`${`${ol.coordinate.format(h.getGeometry().getCoordinates(),"{x},{y}",2)}`} ${h.get("show_text")&&`
`||""}`||""}${h.get("show_text")&&h.get("text")||""}`),h.set("style",{color:a(u.get("style").color),radius:u.get("style").radius,fontsize:u.get("style").fontsize})),u.get("type")==="LineString"&&(h.set("label",`${u.get("show_info")&&Km(u.getGeometry(),"EPSG:4326","degrees")+`
`||""}${u.get("show_text")&&u.get("text")||""}`),h.set("style",{color:a(u.get("style").color),width:u.get("style").width,fontsize:u.get("style").fontsize,direction:u.get("style").direction})),u.get("type")==="Polygon"&&(h.set("label",`${u.get("show_info")&&uu(u.getGeometry(),"EPSG:4326","degrees")+`
`||""}${u.get("show_text")&&u.get("text")||""}`),h.set("style",{color:a(u.get("style").color),width:u.get("style").width,fontsize:u.get("style").fontsize,opacity:u.get("style").opacity})),u.get("type")==="Rectangle"&&(h.set("label",`${u.get("show_info")&&uu(u.getGeometry(),"EPSG:4326","degrees")+`
`||""}${u.get("show_text")&&u.get("text")||""}`),h.set("style",{color:a(u.get("style").color),width:u.get("style").width,fontsize:u.get("style").fontsize,opacity:u.get("style").opacity})),u.get("type")==="Circle"&&(T.getService("map").getProjection().getUnits()==="degrees"&&h.set("radius",ol.sphere.getLength(new ol.geom.LineString([u.get("center"),u.get("endCoordinates")]))),h.set("label",`${u.get("show_text")&&u.get("text")||""}`),h.set("label_radius",`${u.get("show_info")?P1(u.getGeometry(),"EPSG:4326","degrees"):""}`),h.set("label_angle",`${u.get("show_info")?O1(u.getGeometry().getCenter(),u.get("endCoordinates")):""}`),h.set("style",{color:a(u.get("style").color),width:u.get("style").width,fontsize:u.get("style").fontsize,opacity:u.get("style").opacity})),h})))})}setMap(t){super.setMap(t),t.addLayer(this._annotation.layer)}editFeature(t=null){if(this._annotation.feature&&(this._annotation.feature.selected=!1,this._annotation.feature.changed()),!t){this._annotation.feature=null,this._annotation.type=null;return}Object.assign(this._annotation,{feature:t,text:t.get("text"),show_text:t.get("show_text"),show_info:t.get("show_info"),style:t.get("style")}),this._annotation.style.color=t.get("style").color,this._annotation.style.direction=t.get("style").direction,this._annotation.layer.setVisible(!0),t.selected=!0,t.changed(),T.getService("map").getMap().getView().fit(t.getGeometry().getExtent(),{padding:[100,100,100,100]})}changeType(t){if(!t){this.getMap().removeInteraction(this._interaction),this._measureTooltip&&this._measureTooltip.remove(),this._interactions.select.setActive(!0),Object.assign(this._annotation,{constraints:{circle:{radius:0,unit:1},line:{length:0,unit:1},rectangle:{width:0,wunit:1,height:0,hunit:1}},style:{color:"rgb(244, 78, 59)",width:3,radius:8,opacity:.5,rotation:0,fontsize:15,direction:null},type:null,feature:null,text:"",show_text:!1,show_info:!1});return}this._interactions.select.setActive(!1),this._interaction&&(this.getMap().removeInteraction(this._interaction),this._interaction=null),t==="Rectangle"&&(this._interaction=new ol.interaction.DragBox),["Point","LineString","Polygon","Circle","Text"].includes(t)&&(this._interaction=new ol.interaction.Draw({type:t==="Text"?"Point":t,source:this._annotation.layer.getSource(),geometryFunction:!["Point","Text"].includes(t)&&this.#o.bind(this),style:this.#a.bind(this),finishCondition:this.#u.bind(this)})),this._interaction.on("boxstart",this.#d.bind(this)),this._interaction.on("boxdrag",this.#h.bind(this)),this._interaction.on("boxend",this.#p.bind(this)),this._interaction.on("drawstart",this.#l.bind(this)),this._interaction.on("drawend",this.#c.bind(this)),this._interaction&&this._annotation.feature&&(this._annotation.feature.selected=!1,this._annotation.feature=null,this._annotation.layer.changed()),this._interaction&&(this._annotation.layer.setVisible(!0),this._interaction.setActive(!0),this.getMap().addInteraction(this._interaction))}#e(t=[],n,s){return n===s?t:t.map(o=>{let l=o.clone();return l.setId(o.getId()),o.get("type")==="Circle"&&(l.set("center",ol.proj.transform(l.get("center"),n,s)),l.set("endCoordinates",ol.proj.transform(l.get("endCoordinates"),n,s))),o.get("type")!=="Circle"&&l.getGeometry().transform(n,s),l})}#n({feature:t}){if(this._upload){t.get("type")==="Circle"&&t.setGeometry(new ol.geom.Circle(t.get("center"),Number(t.get("radius"))));let n=Number(t.getId());Number.isNaN(n)&&t.setId(e.FID++),!Number.isNaN(n)&&e.FID<=n&&(e.FID=n+1),t.setStyle(this.#r(t.get("type")));return}this._interactions.select.getFeatures().clear(),this._annotation.type=this._annotation.type||t.get("type"),this._annotation.style=this._annotation.style||t.get("style"),t.setId(e.FID),t.set("pid",F.project.getId()),t.set("text",`${this._annotation.type} ${e.FID}`),t.set("show_text",this._annotation.type==="Text"),t.set("show_info",!1),t.set("type",this._annotation.type),this._annotation.type==="Circle"&&(t.set("radius",t.getGeometry().getRadius()),t.set("center",t.getGeometry().getCenter())),Object.assign(this._annotation.style,{color:"rgb(244, 78, 59)",radius:8,width:3,opacity:.5,rotation:0,fontsize:15,direction:null}),t.set("style",Object.assign(t.get("style")||{},this._annotation.style)),t.setStyle(this.#r(this._annotation.type)),this._annotation.show_text=this._annotation.type==="Text",this._annotation.show_info=!1,t.selected=!0,Object.assign(this._annotation,{feature:t,text:t.get("text")}),this._interactions.select.getFeatures().push(t),this._annotation.feature=t,this.getMap().removeInteraction(this._interaction),this._interactions.select.setActive(!0),e.FID++}#i(t){this._annotation.feature.set("endCoordinates",t.coordinate);let n=this._annotation.feature.get("type")==="Rectangle"&&this._annotation.feature.get("modifyGeometry"),s=n&&this._annotation.feature.getGeometry().getCoordinates()[0];if(n&&s){let[o,l,a,u]=s;switch(s.findIndex(h=>t.coordinate[0]===h[0]&&t.coordinate[1]===h[1])){case 0:l=[t.coordinate[0],l[1]],u=[u[0],t.coordinate[1]];break;case 1:o=[t.coordinate[0],o[1]],a=[a[0],t.coordinate[1]];break;case 2:l=[l[0],t.coordinate[1]],u=[t.coordinate[0],u[1]];break;case 3:o=[o[0],t.coordinate[1]],a=[t.coordinate[0],a[1]];break}n.geometry.setCoordinates([[o,l,a,u,o]])}this._annotation.layer.changed()}#t(t){["LineString","Polygon","Circle","Rectangle"].includes(this._annotation.feature.get("type"))&&(this._measureTooltip&&this._measureTooltip.remove(),this._measureTooltip=_a({map:this._interactions.modify.getMap(),feature:this._annotation.feature})),this._annotation.feature.get("type")==="Rectangle"&&this._annotation.feature.set("modifyGeometry",{geometry:this._annotation.feature.getGeometry().clone()},!0)}#s(t){if(this._annotation.feature.get("type")==="Rectangle"){let n=this._annotation.feature.get("modifyGeometry");n&&(this._annotation.feature.setGeometry(n.geometry),this._annotation.feature.unset("modifyGeometry",!0))}this._annotation.feature.get("type")==="Circle"&&(this._annotation.feature.set("radius",this._annotation.feature.getGeometry().getRadius()),this._annotation.feature.set("center",this._annotation.feature.getGeometry().getCenter()))}#l(t){["LineString","Polygon","Circle"].includes(this._annotation.type)&&(this._measureTooltip=_a({map:this._interaction.getMap(),feature:t.feature})),["LineString","Polygon"].includes(this._annotation.type)&&Number(this._annotation.constraints.line.length)>0&&(this._interaction.length=Number(this._annotation.constraints.line.length)*this._annotation.constraints.line.unit),this._annotation.type==="Circle"&&Number(this._annotation.constraints.circle.radius)>0&&(this._interaction.radius=Number(this._annotation.constraints.circle.radius)*this._annotation.constraints.circle.unit,t.feature.getGeometry().setRadius(this._interaction.radius)),this._interaction.geometry=t.feature.getGeometry()}#c(t){this._annotation.type==="Circle"&&t.feature.set("endCoordinates",t.feature.getGeometry().getClosestPoint(this._annotation.endCoordinates)),Object.assign(this._interaction,{radius:null,length:null,geometry:null})}#o(t,n){return this._annotation.type==="Circle"&&(n=n||new ol.geom.Circle(0,0),n.setCenterAndRadius(t.at(0),this._interaction.radius||Math.sqrt((t.at(0)[0]-t.at(-1)[0])**2+(t.at(0)[1]-t.at(-1)[1])**2))),this._annotation.type==="LineString"&&(n=n||new ol.geom.LineString([]),this._interaction.length&&t.push(...this.#f(t.splice(-2),this._interaction.length)),n.setCoordinates(t)),this._annotation.type==="Polygon"&&(n=n||new ol.geom.Polygon([]),this._interaction.length&&(t[0].push(...this.#f(t[0].splice(-2),this._interaction.length)),t=[t[0]]),n.setCoordinates([[...t[0],t[0][0]]]),this._interaction.geometry=n),n}#a(t,n){return this._annotation.type==="Circle"&&t.getGeometry().getType()==="Point"&&!this._interaction.geometry&&(this._annotation.endCoordinates=t.getGeometry().getCoordinates()),this._annotation.type==="Circle"&&t.getGeometry().getType()==="Point"&&this._interaction.geometry&&(this._annotation.endCoordinates=this._interaction.geometry.getClosestPoint(t.getGeometry().getCoordinates()),t.getGeometry().setCoordinates(this._annotation.endCoordinates)),this._annotation.type==="Circle"&&t.getGeometry().getType()==="Circle"?(this._annotation.endCoordinates=t.getGeometry().getClosestPoint(this._annotation.endCoordinates),t.set("endCoordinates",this._annotation.endCoordinates),this.#r(this._annotation.type)(t)):(this._annotation.type==="LineString"&&this._interaction.length&&t.getGeometry().getType()==="Point"&&this._interaction.geometry&&t.getGeometry().setCoordinates(this._interaction.geometry.getCoordinates()[0].at(-1)),this._annotation.type==="Polygon"&&this._interaction.length&&t.getGeometry().getType()==="Point"&&this._interaction.geometry&&t.getGeometry().setCoordinates(this._interaction.geometry.getCoordinates()[0].at(-2)),this._annotation.type==="Polygon"&&this._interaction.length&&t.getGeometry().getType()==="LineString"&&t.getGeometry().setCoordinates(this._interaction.geometry.getCoordinates()[0].slice(0,-1)),this._annotation.type==="Polygon"&&this._interaction.length&&t.getGeometry().getType()==="Polygon"&&t.getGeometry().setCoordinates(this._interaction.geometry.getCoordinates()),new ol.interaction.Draw({type:this._annotation.type==="Text"?"Point":this._annotation.type}).getOverlay().getStyleFunction()(t,n))}#u(t){return this._annotation.endCoordinates=t.coordinate,!0}#d({coordinate:t}){this._interaction._startC=t}#h(t){this.width=Number(this._annotation.constraints.rectangle.width),this.height=Number(this._annotation.constraints.rectangle.height),this.width>0&&this.height>0&&(this.width=this.width*this._annotation.constraints.rectangle.wunit,this.height=this.height*this._annotation.constraints.rectangle.hunit,this._interaction.endC=[this._interaction._startC[0]+(this._interaction._startC[0]>t.coordinate[0]?-1:1)*this.width,this._interaction._startC[1]+(this._interaction._startC[1]>t.coordinate[1]?-1:1)*this.height]);let n=ol.geom.Polygon.fromExtent(ol.extent.boundingExtent([this._interaction._startC,t.coordinate]));this._interaction.feature_||(this._interaction.feature_=new ol.Feature(n),this._measureTooltip=_a({map:this._interaction.getMap(),feature:this._interaction.feature_})),this._interaction.feature_.getGeometry().setCoordinates(n.getCoordinates())}#p({coordinate:t}){this._annotation.layer.getSource().addFeature(new ol.Feature(ol.geom.Polygon.fromExtent(ol.extent.boundingExtent([this._interaction._startC,this._interaction.endC||t])))),this._annotation.constraints.rectangle.width=this._annotation.constraints.rectangle.height=0,this._annotation.constraints.rectangle.wunit=this._annotation.constraints.rectangle.hunit=1,delete this._interaction.feature_}#f(t,n){if(t[0][0]===t[1][0]&&t[0][1]===t[1][1])return t;let s=[t[0]],o=[t[0]];for(let l=1;l<t.length;l++){let a=(n-ol.sphere.getLength(new ol.geom.LineString(s)))/(ol.sphere.getLength(new ol.geom.LineString([...s,t[l]]))-ol.sphere.getLength(new ol.geom.LineString(s))),u=[s[0][0]+a*(t[l][0]-s[0][0]),s[0][1]+a*(t[l][1]-s[0][1])];o.push(u),s=[u]}return o}#r(t){let n=F.project.getProjection().getCode(),s=F.project.getProjection().getUnits(),o=new ol.style.Fill({color:"#000"}),l=new ol.style.Stroke({color:"#FFF",width:3}),a="Titillium Web",u=new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"#000",width:3})});if(t==="Text")return h=>new ol.style.Style({text:new ol.style.Text({text:h.get("text"),rotation:h.get("style")?.rotation*(Math.PI/180),fill:o,font:`${h.get("style")?.fontsize}px ${a}`,placement:"point",stroke:new ol.style.Stroke({color:"#FFF",width:8})})});if(t==="Point")return h=>new ol.style.Style({text:new ol.style.Text({placement:"point",offsetY:-Number(h.get("style")?.radius)-10+(h.get("show_text")?-10:0),text:`${h.get("show_info")&&`${`${ol.coordinate.format(h.getGeometry().getCoordinates(),"{x},{y}",2)}`} ${h.get("show_text")&&`
`||""}`||""}${h.get("show_text")&&h.get("text")||""}`,fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),image:new ol.style.Circle({fill:new ol.style.Fill({color:h.get("style")?.color}),radius:h.get("style")?.radius})});if(t==="LineString")return h=>[h.selected&&new ol.style.Style({stroke:new ol.style.Stroke({width:h.get("style")?.width+3,color:"#FFF"})}),new ol.style.Style({text:new ol.style.Text({placement:"point",text:`${h.get("show_info")&&Km(h.getGeometry(),n,s)+`
`||""}${h.get("show_text")&&h.get("text")||""}`,fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),stroke:new ol.style.Stroke({width:h.get("style")?.width,color:h.get("style")?.color})}),h.selected&&new ol.style.Style({image:u,geometry:p=>new ol.geom.MultiPoint(p.getGeometry().getCoordinates())}),...h.get("style")?.direction?(()=>{let p=[];return h.getGeometry().forEachSegment((d,_)=>{let m=_[0]-d[0],v=_[1]-d[1];p.push(new ol.style.Style({geometry:new ol.geom.Point(h.get("style")?.direction==="forward"?_:d),image:new ol.style.RegularShape({fill:new ol.style.Fill({color:h.get("style")?.color}),points:3,radius:8,displacement:[0,0],rotation:-Math.atan2(v,m),angle:(h.get("style")?.direction==="forward"?1:-1)*Math.PI/2})}))}),p})():[]].filter(Boolean);if(t==="Polygon")return h=>[h.selected&&new ol.style.Style({stroke:new ol.style.Stroke({width:h.get("style")?.width+3,color:"#FFF"})}),new ol.style.Style({text:new ol.style.Text({placement:"point",text:`${h.get("show_info")&&uu(h.getGeometry(),n,s)+`
`||""}${h.get("show_text")&&h.get("text")||""}`,fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),stroke:new ol.style.Stroke({width:h.get("style")?.width,color:h.get("style")?.color}),fill:new ol.style.Fill({color:`rgba(${h.get("style")?.color?.replace?.(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/g,"$1, $2, $3")}, ${h.get("style")?.opacity})`})}),h.selected&&new ol.style.Style({image:u,geometry:p=>new ol.geom.MultiPoint(p.getGeometry().getCoordinates()[0])})].filter(Boolean);if(t==="Rectangle")return h=>[h.selected&&new ol.style.Style({stroke:new ol.style.Stroke({width:h.get("style")?.width+3,color:"#FFF"}),geometry:()=>h.get("modifyGeometry")?.geometry||h.getGeometry()}),new ol.style.Style({text:new ol.style.Text({placement:"point",text:`${h.get("show_info")&&uu(h.getGeometry(),n,s)+`
`||""}${h.get("show_text")&&h.get("text")||""}`,fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),stroke:new ol.style.Stroke({width:h.get("style")?.width,color:h.get("style")?.color}),fill:new ol.style.Fill({color:`rgba(${h.get("style")?.color?.replace?.(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/g,"$1, $2, $3")}, ${h.get("style")?.opacity})`}),geometry:()=>h.get("modifyGeometry")?.geometry||h.getGeometry()}),h.selected&&new ol.style.Style({image:u,geometry:()=>new ol.geom.MultiPoint((h.get("modifyGeometry")?.geometry||h.getGeometry()).getCoordinates()[0])})].filter(Boolean);if(t==="Circle")return h=>[h.selected&&new ol.style.Style({stroke:new ol.style.Stroke({width:(h.get("style")?.width||3)+3,color:"#FFF"})}),new ol.style.Style({text:new ol.style.Text({placement:"point",text:h.get("show_text")&&h.get("text")||"",fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),stroke:new ol.style.Stroke({width:h.get("style")?.width||3,color:h.get("style")?.color||"rgb(3, 169, 244)"}),fill:new ol.style.Fill({color:`rgba(${h.get("style")?.color?.replace?.(/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/g,"$1, $2, $3")||"255, 255, 255"}, ${h.get("style")?.opacity??.5})`})}),h.selected&&h.get("show_info")&&new ol.style.Style({stroke:new ol.style.Stroke({color:"#FFFFFF",width:6}),geometry:p=>new ol.geom.LineString([p.getGeometry().getCenter(),h.get("endCoordinates")])}),new ol.style.Style({text:new ol.style.Text({placement:"line",text:`${h.get("show_info")?`${h.getGeometry().getRadius()>100?Math.round(h.getGeometry().getRadius()/1e3*100)/100+" km":Math.round(h.getGeometry().getRadius()*100)/100+" m"} 
`:""}`,fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),...h.get("show_info")||h.get("show_info")===void 0?{stroke:new ol.style.Stroke({color:h.get("style")?.color||"rgb(3, 169, 244)",width:3}),geometry:p=>new ol.geom.LineString([p.getGeometry().getCenter(),h.get("endCoordinates")])}:{}}),new ol.style.Style({text:new ol.style.Text({placement:"point",offsetX:20,text:`${h.get("show_info")&&`${parseInt(Math.atan2(h.getGeometry().getCenter()[0]-h.get("endCoordinates")[0],h.getGeometry().getCenter()[1]-h.get("endCoordinates")[1])*180/Math.PI)}\xB0`||""}`,fill:o,font:`${h.get("style")?.fontsize}px ${a}`,stroke:l}),geometry:()=>new ol.geom.Point(h.get("endCoordinates"))})].filter(Boolean)}showUploadModal(){let t=Object.assign(document.createElement("template"),{innerHTML:`
        <dialog>
          <form method="dialog">
            <label for="file_input" style="font-size: 1.25em;">Upload a JSON File</label>
            <input id="file_input" type="file" accept="application/json" style="margin: 1em 0;" />
            <pre id="file_preview" hidden style="margin-top: 1em;" contenteditable></pre>
            <menu style="display: flex; justify-content: space-between;">
              <button type="submit" value="cancel" class="btn btn-secondary">Cancel</button>
              <button id="confirm_button" disabled type="submit" value="confirm" class="btn btn-success">Confirm</button>
            </menu>
          </form>
        </dialog>
      `.trim()}).content.firstChild,n=t.querySelector("#file_input"),s=t.querySelector("#file_preview"),o=t.querySelector("#confirm_button");n.addEventListener("change",async l=>{if(l.target.files[0])try{s.textContent=JSON.stringify(JSON.parse(await l.target.files[0].text()),null,2),s.hidden=!1,o.disabled=!1}catch(a){console.warn(a),alert("Invalid JSON file. Please upload a valid JSON."),s.hidden=!0,o.disabled=!0}}),t.addEventListener("close",()=>{if(t.returnValue==="confirm")try{this._upload=!0,this._annotation.layer.getSource().addFeatures(this.#e(new ol.format.GeoJSON({dataProjection:"EPSG:4326"}).readFeatures(JSON.parse(s.textContent)),"EPSG:4326",T.getService("map").getEpsg())),this._upload=!1}catch(l){console.warn(l),alert("Failed to add annotations. Please check the JSON content.")}t.remove()}),document.body.appendChild(t),t.showModal()}}});var GA=R(()=>{ze();lu();T.once("ready",()=>T.getService("map").once("ready",function(){let{header_terms_of_use_text:e,header_terms_of_use_link:t}=this.config,n=e?t?`<a href="${t}">${e}</a>`:`<span class="skin-color" style="font-weight: bold">${e}</span>`:!1;this.getMapLayers().forEach(s=>s.getSource().setAttributions(n)),(n||Zi({BASELAYER:!0}).length)&&this.getMap().addControl(new ol.control.Attribution({collapsible:!1,target:"map_footer_left"}))}))});function e_(e,t){let n=e.getType();if(!t||t===n)return e;let s=jo(n),o=jo(t);if(s&&!o){switch(e.getType()){case fe.MULTIPOLYGON:return e.getPolygons();case fe.MULTILINE:return e.getLineStrings();case fe.MULTILINESTRING:return e.getLineStrings();case fe.MULTIPOINT:return e.getPoints();default:console.warn("invalid geometry type",e.getType())}return[]}return!s&&o?new ol.geom[`Multi${n}`]([e.getCoordinates()]):e}var D1=R(()=>{ft();xp()});function aee(e){e.style.resize="both",e.addEventListener("toggle",async t=>{t.newState==="closed"&&(e.style.left=null,e.style.top=null,e.style.width=null,e.style.height=null,e.dispatchEvent(new Event("close")))}),document.addEventListener("keydown",function t(n){n.key==="Escape"&&(e?.hidePopover?.(),document.removeEventListener("keydown",t))}),e.addEventListener("mousedown",t=>{let n=e.getBoundingClientRect(),s=t.clientY<n.top-20||t.clientY>n.top+n.height||t.clientX<n.left||t.clientX>n.left+n.width-20,o=["label","button","select","input","textarea"].some(u=>t.target.closest(u));if(s||o||!t.target.closest("li.skin-background-color"))return;t.preventDefault();let l=({clientX:u,clientY:h})=>{Object.assign(e.style,{margin:0,left:`${u-t.clientX+n.left}px`,top:`${h-t.clientY+n.top}px`})},a=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",a)}),e.addEventListener("mousemove",t=>{let n=e.getBoundingClientRect(),s=t.clientY<n.top||t.clientY>n.top+n.height||t.clientX<n.left||t.clientX>n.left+n.width;e.style.cursor=s?null:"move"})}var va,G1,jA=R(()=>{ze();Ke();cc();gr();Wt();lv();Wy();D1();Xt();Us();Rt();va=window.initConfig.mapcontrols.geocoding?window.initConfig.mapcontrols.geocoding.providers:{};Object.keys(va).forEach(function(e){let t=document.createElement("script");t.src=window.initConfig.staticurl+"client/geocoding-providers/"+e+".js",t.async=!0,document.head.appendChild(t)});T.once("ready",async()=>{let e=T.getService("map");e.setupControl.geocoding=function(){e.addControl("geocoding",new G1,!1)}});G1=class extends ol.control.Control{RESULTS=[];LAYER=new ol.layer.Vector({id:"__g3w_marker",name:"Geocoding",source:new ol.source.Vector,style(t){return t.getId()==="g3w-coords"?new ol.style.Style({text:new ol.style.Text({offsetY:-15,text:"\uF3C5",font:'900 3em "Font Awesome 5 Free"',stroke:new ol.style.Stroke({color:"red",width:3}),fill:new ol.style.Fill({color:"rgba(255, 0,0, 0.7)"})})}):/^(Point|MultiPoint)/.test(t.getGeometry().getType())?[new ol.style.Style({image:new ol.style.Icon({opacity:1,src:"/static/client/images/pushpin.svg",scale:.8})}),new ol.style.Style({image:new ol.style.RegularShape({stroke:new ol.style.Stroke({color:[0,0,0,0]}),points:4,radius:50,angle:Math.PI/4})})]:new ol.style.Style({stroke:new ol.style.Stroke({color:"orange",width:4})})}});constructor(){super({element:Object.assign(document.createElement("template"),{innerHTML:`
          <div class="ol-geocoder">
            <form>
              <input  type="search" autocomplete="off" style="font-weight: bold;" />
              <button type="reset"                         data-i18n-title="Reset search"    data-placement="bottom"                                 hidden></button>
              <button type="submit" value="search"         data-i18n-title="Submit search"   data-placement="bottom" class="btn fas fa-search"></button>
              <button type="submit" value="trash"          data-i18n-title="Clear selection" data-placement="bottom" class="btn fas fa-trash"     hidden style="color:red;"></button>
              <button type="submit" value="toggle-layer"   data-i18n-title="Toggle layer"    data-placement="bottom" class="btn far fa-eye-slash" hidden></button>
              <button type="submit" value="toggle-sidebar" data-i18n-title="Toggle sidebar"  data-placement="bottom" class="btn"                  hidden><code></code></button>
            </form>
            <!-- SEARCH RESULTS -->
            <ul popover="manual"></ul>
          </div>
      `.trim()}).content.firstChild}),aee(this.element.querySelector("ul"));let t=T.getService("map"),n=T.getService("queryresults"),s=new Vue;T.on("i18n-ready",()=>{this.element.querySelector("ul").innerHTML="",this.element.querySelector('input[type="search"]').placeholder=_e("Search")}),s.$watch(()=>T.getCurrentContent(),o=>{this.element.querySelector('button[value="toggle-sidebar"] code').style.opacity=o?.5:null},{immediate:!0}),t.on("set-layer-zindex",this.#u.bind(this)),n.onafter("removeFeatureLayerFromResult",this.#d.bind(this)),n.onafter("addActionsForLayers",this.#h.bind(this)),t.getMap().addLayer(this.LAYER),n.registerVectorLayer(this.LAYER),this.element.querySelector("form").addEventListener("submit",this.#i.bind(this)),this.element.querySelector("form").addEventListener("reset",this.#i.bind(this)),this.element.querySelector('input[type="search"]').addEventListener("input",this.#l.bind(this)),this.element.querySelector("ul").addEventListener("click",this.#c.bind(this)),this.LAYER.on("change:visible",this.#e.bind(this)),this.LAYER.getSource().on("addfeature",this.#n.bind(this)),this.LAYER.getSource().on("removefeature",this.#n.bind(this)),t.getMap().getView().on("change",un(()=>{this.element?.querySelector?.('input[name="update_on_move"]')?.checked&&this.#s(this.element.querySelector('input[type="search"]').value)},600)),$(document).on("shown.bs.modal",()=>this.element.querySelector("ul").hidePopover())}#e(){let t=this.LAYER.getVisible(),n=this.element.querySelector('button[value="toggle-layer"]');n.classList.toggle("fa-eye-slash",t),n.classList.toggle("fa-eye",!t)}async#n(t){let n=this.LAYER.getSource().getFeatures().length;this.element.querySelectorAll('button:is([value="trash"], [value="toggle-layer"], [value="toggle-sidebar"])').forEach(l=>l.hidden=!n),this.element.querySelector('button[value="toggle-sidebar"] code').innerHTML=n>99?"99+":n;let s=t.feature.getId(),o=this.RESULTS.find(l=>s===l.__uid);o&&(this.element.querySelector(`li[data-uid="${s}"] input[type="checkbox"]`).checked=t.type==="addfeature",o.__selected=t.type==="addfeature"),n===0&&this.LAYER.setVisible(!0),t.type==="addfeature"&&T.getService("map").zoomToFeatures([t.feature]),t.type==="removefeature"&&!this.clearing&&(await T.closeContent(),n&&T.showQueryResults("Geocoding",{data:[{layer:this.LAYER,features:this.LAYER.getSource().getFeatures()}]}))}#i(t){if(t.preventDefault(),t.type=="reset"){this.element.querySelector('input[type="search"]').focus(),this.element.querySelector('input[type="search"]').value="",this.element.querySelector('button[type="reset"]').hidden=!0,this.element.querySelector("ul").innerHTML="",this.element.querySelector("ul").hidePopover(),this.RESULTS.splice(0),this.LAYER.getSource().getFeatureById("g3w-coords")&&this.LAYER.getSource().removeFeature(this.LAYER.getSource().getFeatureById("g3w-coords"));return}if(t.submitter.value=="search"&&this.#s(this.element.querySelector('input[type="search"]').value),t.submitter.value=="trash"){this.clearing=!0,this.LAYER.getSource().clear(),this.RESULTS.forEach(s=>s.__selected=!1);let n=T.getService("queryresults").getState().layers.find(s=>s.id===this.LAYER.get("id"));n&&n.features.forEach(s=>T.getService("queryresults").removeFeatureLayerFromResult(n,s)),this.clearing=!1}if(t.submitter.value=="toggle-layer"&&this.LAYER.setVisible(!this.LAYER.getVisible()),t.submitter.value=="toggle-sidebar"){let n=this.LAYER.getSource().getFeatures();!T.getCurrentContent()&&n.length?T.showQueryResults("Geocoding",{data:[{layer:this.LAYER,features:n}]}):T.closeContent()}}#t(t,n="___"){let s={},o={};return Object.entries(t).forEach(([l,a])=>{l.startsWith(n)?s[l]=a:o[l]=a}),{filtered:o,extracted:s}}async#s(t){if(this.#s.loading)return;this.#s.loading=!0,t=t.trim();let n=T.getService("map"),s=v=>typeof v=="number"&&!Number.isNaN(v),o=null,l=!1,[a,u,h]=(t||"").split(","),p=h&&await In.registerProjection(`EPSG:${h.trim()}`),d=this.element?.querySelector?.('input[name="update_on_move"]')?.checked,_=ol.proj.transformExtent(Object.keys(va).filter(v=>v!="nominatim").length>0?n.getMapExtent():n.getProject().state.initextent||n.getProject().state.extent,n.getProject().state.crs.epsg,"EPSG:4326");s(1*a)&&s(1*u)&&(o=[1*a,1*u]);try{p&&(o=ol.proj.transform(o,p.getCode(),"EPSG:4326"),l=!0)}catch(v){console.warn(v)}let m=this.LAYER.getSource();if(m.getFeatureById("g3w-coords")&&m.removeFeature(m.getFeatureById("g3w-coords")),o){let v=new ol.Feature({geometry:new ol.geom.Point(l?ol.proj.transform(o,"EPSG:4326",n.getEpsg()):o),lon:o[0],lat:o[1]});v.setId("g3w-coords"),this.LAYER.getSource().addFeature(v)}if(!o){this.element.querySelector('button[type="reset"]').classList.add("gcd-spin");let v=this.RESULTS.filter(b=>d&&b.__selected).map(b=>Object.assign(b,{___update_on_move:!0}));(await Promise.allSettled(Object.entries(va).map(([b,w={}])=>va[b].fetch({url:w.url,icon:w.icon,query:t,lang:F.language||"it-IT",limit:5,extent:_})))).filter(b=>b.status==="fulfilled").forEach(b=>{if(v.push({__heading:!0,provider:b.value.provider,label:va[b.value.provider].label||b.value.label}),!(b.value.results&&b.value.results.length)){v.push({__no_results:b.value.provider});return}b.value.results.forEach(w=>{let L=jd({...w,provider:b.value.provider,__uid:Qe(),__icon:w.icon||va[b.value.provider].icon||b.value.icon,__selected:!1}),D=this.#t(L,L.provider+"_").extracted;Object.keys(D).length&&(L.__selected=v.filter(G=>G.___update_on_move).some(G=>JSON.stringify(D)===JSON.stringify(this.#t(G,G.provider+"_").extracted))),v.push(L)})}),this.element.querySelector("ul").innerHTML=v.map(b=>`
        <li
          data-uid = "${b.__uid}"
          class      = "${[b.provider,b.__icon?"gcd-icon-"+b.__icon:"",b.__heading?"skin-background-color":"",b.__no_results?"gcd-noresult":""].filter(Boolean).join(" ")}"
          style       = "${b.__heading?"":"cursor: pointer;"}"
          ${d&&b.__selected?"hidden":""}
        >
          <!-- GEOCODING PROVIDER (eg. "Nominatim OSM") -->
          ${b.__heading?`<b style="padding: 5px; color: #FFF;">${b.label}</b>`:""}
            
          <!-- NO RESULTS -->
          ${!b.__heading&&b.__no_results?`<span>${_e("No results")}</span>`:""}

          <!-- RESULTS -->
          ${!b.__heading&&!b.__no_results?`
            <input type="checkbox" style="pointer-events: none; margin: 0;" ${b.__selected?"checked":""} />
            <img class="gcd-icon" src="/static/client/images/pushpin.svg" width="24" height="24" ${["poi","point"].includes(b.__icon)?"":"hidden"}/>
            <i class="fa fa-${b.__icon}" style="color: black"   ${!["poi","point"].includes(b.__icon)&&b.__icon!==void 0?"":"hidden"}></i>
            <span style="display: flex; flex-direction: column; padding: 3px 5px; color: #000;">
              <span class = "gcd-type">${b.type??""}</span>
              <span class = "gcd-name">${b.name??""}</span>
              <span class = "gcd-road">${b.address_name??""}</span>
              <span class = "gcd-road">${[b.address_building??"",b.address_road??"",b.address_house_number??""].join(" ")}</span>
              <span class = "gcd-city">${[b.address_postcode??"",b.address_city??"",b.address_town??"",b.address_village??""].join(" ")}</span>
              <span class = "gcd-country">${[b.address_state??"",b.address_country??""].join(" ")}</span>
            </span>
            `:""}
        </li>
      `).join("");let x=Array.from(document.querySelectorAll("#g3w-search li")).filter(b=>b.textContent.toLowerCase().includes(t.toLowerCase()));x.length&&this.element.querySelector("ul").insertAdjacentHTML("beforeend",`
          ${x.length?'<li class="skin-background-color"><b style="padding: 5px; color: #FFF;">Saved searches</b></li>':""}
        `),x.forEach(b=>{let w=document.createElement("li");w.style.cursor="pointer",w.innerHTML=`<i class="far fa-circle"></i> ${b.textContent}`,w.addEventListener("click",L=>{L.preventDefault(),(b.querySelector(".search-tools")||b).click(),this.element.querySelector('button[type="reset"]').click(),this.element.querySelector('input[type="search"]').blur()}),this.element.querySelector("ul").append(w)}),T.getComponent("search").actions.findLast(b=>{let w=document.createElement("li");w.style.cursor="pointer",w.className="action-tool",w.innerHTML=`<i class="${b.class.replace("sidebar-button","").replace("sidebar-button-icon","")}"></i> ${b.tooltip}`,w.addEventListener("click",L=>{L.preventDefault(),T.showSidebar(),b.fnc(),this.element.querySelector('button[type="reset"]').click(),this.element.querySelector('input[type="search"]').blur()}),this.element.querySelector("ul").insertAdjacentElement("beforeend",w)}),this.element.querySelector("ul").insertAdjacentHTML("beforeend",`
        <li style="position: sticky;bottom: 0;background: #fff;margin-bottom: -10px;" hidden>
          <label style="cursor: pointer;">
            <input type="checkbox" name="update_on_move" ${d?"checked":""}> Update results when map moves
          </label>
        </li>
      `),this.RESULTS=v,this.element.querySelector('button[type="reset"]').classList.remove("gcd-spin"),this.element.querySelector("ul").showPopover()}this.#s.loading=!1}#l(t){this.element.querySelector('button[type="reset"]').hidden=t.target.value.trim().length===0}async#c(t){try{let n=t.target.closest("li")?.dataset?.uid,s=n&&this.RESULTS.find(d=>n===d.__uid);if(s?.__uid&&this.LAYER.getSource().getFeatureById(s.__uid)){this.#a(s.__uid);return}if(!s)return;let o;if(va[s.provider]?.fetch_geom){let d=await va[s.provider].fetch_geom(s);o=d&&new ol.Feature({geometry:new ol.format.GeoJSON({dataProjection:"EPSG:4326",featureProjection:T.getService("map").getEpsg()}).readGeometry(d)})}if((!s.lat||!s.lon)&&!o)return;let{__uid:l,__icon:a,__selected:u,icon:h,...p}=s;o=o||new ol.Feature({geometry:new ol.geom.Point(ol.proj.transform([parseFloat(s.lon),parseFloat(s.lat)],"EPSG:4326",T.getService("map").getEpsg()))}),o.setId(l),o.setProperties(p),this.LAYER.getSource().addFeature(o),await T.closeContent(),T.showQueryResults("Geocoding",{data:[{layer:this.LAYER,features:[o]}]})}catch(n){console.warn(n)}}async#o(t,n){let s=qi.getPlugin("editing");if(s){this.element.classList.add("g3w-disabled");try{let o=De(t).getGeometryType(),l=bp({geometryType:o,feature:new ol.Feature({...Object.entries(n.attributes).reduce((a,u)=>({...a,[u[0].replace(n.attributes.provider+"_","").toLowerCase()]:u[1]}),{}),...n.attributes,geometry:e_(n.geometry,o)})});await s.addLayerFeature({layerId:t,feature:l})}catch(o){console.warn(o)}this.element.classList.remove("g3w-disabled")}}#a(t){let n=this.LAYER.getSource().getFeatureById(t);n&&this.LAYER.getSource().removeFeature(n)}#u({layer:t,zindex:n}){t.get("id")!==this.LAYER.get("id")&&this.LAYER.getZIndex()<n&&this.LAYER.setZIndex(n+1)}#d(t,n){this.LAYER.get("id")===t.id&&this.#a(n.id)}#h(t,n){let s=T.getService("queryresults"),o=n.find(a=>this.LAYER.get("id")===a.id);if(!o||o?.features?.some?.(a=>a?.attributes?.provider==="qes"))return;let l=Object.values(F.catalog).flatMap(a=>a.getLayers({EDITABLE:!0,GEOLAYER:!0})).filter(a=>/^(Point|MultiPoint)/.test(a.getGeometryType())).map(a=>({id:a.getId(),name:a.getName(),inediting:a.isInEditing()}));l.find(a=>a.inediting)||(s.state.actiontools.choose_layer={[o.id]:{layers:l,icon:"pencil",label:"Choose a layer where to add this feature",nolayers:"No editable point layers found on this project",cbk:this.#o}},t[o.id]=t[o.id]||[],t[o.id].push({id:"choose_layer",class:T.getFontClass("pencil"),state:Vue.observable({toggled:Array(o.features.length).fill(null)}),toggleable:!0,hint:"Choose a layer",cbk:(a,u,h,p)=>{if(l.length===1){this.#o(l[0].id,u);return}h.state.toggled[p]=!h.state.toggled[p];let d=s.state.currentactiontools[a.id],_=s.state.currentactionfeaturelayer[a.id];_[p]=h.state.toggled[p]?h:null,d[p]=h.state.toggled[p]?{name:"choose_layer",data:()=>({layerId:null}),props:{feature:{type:Object},config:{type:Object,default:()=>({icon:"pencil",label:"Choose a Layer",nolayers:"No layers found",layers:[],cbk:()=>{}})}},template:`
            <section class = "action-choose-layer">
              <label v-t = "config.label"></label>
              <div
                style               = "width: 100%; display: flex"
                @click.prevent.stop = ""
              >
                <select
                  v-select2 = "'layerId'"
                  :search   = "false"
                  style     = "flex-grow: 1;"
                  class     = "form-control"
                  :disabled = "!has_layers"
                >
                  <option
                    v-for   = "layer in config.layers"
                    :key    = "layer.id"
                    :value  = "layer.id">
                    <b>{{ layer.name }}</b>
                  </option>
                  <option v-if = "!has_layers" v-t = "config.nolayers"></option>
                </select>
                <button
                  v-if        = "has_layers"
                  style       = "border-radius: 0 3px 3px 0;"
                  class       = "btn skin-button"
                  @click.stop = "() => config.cbk(layerId, feature)"
                >
                  <span :class = "g3wtemplate.getFontClass(config.icon)"></span>
                </button>
              </div>
            </section>`,computed:{has_layers(){return this.config.layers&&this.config.layers.length>0}},created(){this.has_layers&&(this.layerId=this.config.layers[0].id)}}:null,d[p]&&h.id!==_[p].id&&_[p].toggleable&&(_[p].state.toggled[p]=!1)}}))}};document.head.insertAdjacentHTML("beforeend",`
<style>
  .ol-geocoder                                                         { width: 300px; margin-top: 3px; margin-left: 5px; --skin-color: #374146; }
  body:not(.sidebar-collapse) .ol-geocoder,
  body.is-iframe:not(.sidebar-mini).sidebar-collapse .ol-geocoder      { margin-left: 40px; }
  .ol-geocoder > ul                                                    { max-height: 400px; overflow-x: hidden; overflow-y: auto; transition: max-height 300ms ease-in; padding: 0; margin:unset; inset:unset; background: #fff;border: 1px solid #ccc; width: 300px; min-width: 215px; }
  .ol-geocoder > ul:not([style*="left"])                               { position-anchor: --ol-geocoder-form; position-area: bottom; }
  .ol-geocoder > ul > li                                               { width: 100%; overflow: hidden; padding: 0; min-height: 30px; padding-left: 3px; border-bottom: 2px solid var(--skin-color); min-height: 20px; padding: 10px; }
  .ol-geocoder > ul > li:hover                                         { background-color: #eee; }
  .ol-geocoder > ul > li:last-child                                    { border-bottom: 0 !important; }
  .ol-geocoder li:not(.skin-background-color, [hidden])                { display: flex; align-items: center; gap: 10px; }
  .ol-geocoder li.gcd-icon-road :is(.gcd-name, .gcd-type, .gcd-icon),
  .ol-geocoder li.gcd-icon-poi :is(.gcd-road, .gcd-city, .gcd-country) { display: none; }
  .ol-geocoder .btn                                                    { border-radius: 0 !important; color: #FFF; border-left: 1px solid #fff; }
  .ol-geocoder input[type="search"]                                    { border: 0; width: 100%; height: 100%;  text-indent: 6px; }
  .ol-geocoder button[type="reset"]::after                             { content: "\\d7"; display: inline-block; font-weight: bold; font-size: 2em; cursor: pointer; color: var(--skin-color); }
  .ol-geocoder button[type="reset"]:not([hidden])                      { width: 2.5em; height: 100%; line-height: 100%; border: none; background-color: transparent; display: inline-block; vertical-align: middle; outline: 0; cursor: pointer; }
  .ol-geocoder input[type="search"]:focus                              { outline: none; }
  .ol-geocoder input[type="search"]                                    { border: 0; width: 100%; height: 100%; padding: 5px 5px 5px 5px; text-indent: 6px; background-color: transparent; font-family: inherit; font-size: 1em; }
  .ol-geocoder input[type="search"]::-webkit-search-cancel-button      { display: none; }
  .ol-geocoder form                                                    { display: flex; justify-content: flex-end; height: 40px; background-color: #fff; overflow: hidden; width: 100%; border: 1px solid var(--skin-color); border-radius: 0 3px 3px 0; anchor-name: --ol-geocoder-form; }
  .ol-geocoder .gcd-road                                               { font-size: 0.875em; font-weight: 500; }
  .ol-geocoder .gcd-city                                               { font-size: 1em; font-weight: bold; }
  .ol-geocoder .gcd-country                                            { font-size: 0.75em; }
  .ol-geocoder .gcd-spin                                               { animation: ol-geocoder-spin .7s linear infinite; }
  .ol-geocoder .gcd-hidden                                             { display: none !important; }
  .ol-geocoder li.skin-background-color                                { position: sticky; top: 0; }
  .ol-geocoder li:has(input[type="checkbox"]:checked)                  { background-color: #f7fabf !important; }
  .ol-geocoder li.gcd-noresult:hover                                   { background-color: transparent !important; }
  .ol-geocoder li.gcd-noresult                                         { font-weight: bold; color: #384247; margin: 10px; border-bottom: 0 !important; }
  .ol-geocoder [hidden]                                                { display: none; }
  .ol-geocoder .btn                                                    { font-weight: 900; background-color: var(--skin-color); }
  .ol-geocoder ul:not(:has(li)) + *                                    { display: none; }

  @keyframes ol-geocoder-spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  @media (max-width: 767px) {
    .ol-geocoder { left: 10px; }
  }
</style>
`)});var j1,qA=R(()=>{ze();ma();dr();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.geolocation=function(){e.addControl("geolocation",new j1),e.getMapControlByType("geolocation").on("click",En(t=>e.showMarker(t.coordinates)))}});j1=class extends Kn{constructor(){super({visible:!0,offline:!1,enabled:!0,name:"geolocation",tipLabel:"Geolocation"}),this._layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({text:"\uF3C5",font:'900 3em "Font Awesome 5 Free"',fill:new ol.style.Fill({color:"red"}),offsetY:-15})})}),this._geolocation=new ol.Geolocation({trackingOptions:{enableHighAccuracy:!0}}),this.on("controlclick",t=>{this._geolocation.getTracking()?this._geolocation.setTracking(!1):this.geolocate()})}_showMarker({map:t,coordinates:n,show:s=!0}){this._layer&&(this._layer.getSource().clear(),s?(t.getView().setCenter(n),this._layer.getSource().addFeature(new ol.Feature({geometry:new ol.geom.Point(n)})),t.addLayer(this._layer)):t.removeLayer(this._layer))}geolocate(){let t=this.getMap();if(!t)return;let n;this._geolocation.on("change:position",()=>{let s=this._geolocation.getPosition();s&&(n=this.on("toggled",()=>{this._showMarker({map:t,coordinates:this._geolocation.getPosition(),show:this.isToggled()})}),$(this.element).removeClass("g3w-ol-disabled"),this._showMarker({map:t,coordinates:s,show:this.isToggled()}))}),this._geolocation.on("error",s=>{this._layer=null,T.showUserMessage({type:"warning",title:"Can't get your position",message:s.message}),this.toggle(!1),ol.Observable.unByKey(n),n=null}),this._geolocation.setProjection(t.getView().getProjection()),this._geolocation.setTracking(!0)}}});var du,q1,$1=R(()=>{ze();ma();ya();Rt();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.length=e.setupControl.area=function(){Object.keys(window.initConfig.mapcontrols).filter(t=>["length","area"].includes(t)).forEach(t=>{!isMobile.any&&t in window.initConfig.mapcontrols&&(e.getMapControlByType("measure")?e.getMapControlByType("measure").addType(t):e.addControl("measure",new q1({name:"measure",tipLabel:"Measure",types:[t],interactionClassOptions:{projection:e.getProjection(),help:`measure_descriptions.${t}`}})))})}});du=class extends ol.interaction.Draw{constructor(t){let n=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:t.drawColor||"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:3}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})}),s=new ol.source.Vector;super({source:s,type:t.geometryType||"LineString",style:n}),this._helpTooltip,this._featureGeometryChangelistener,this._poinOnMapMoveListener,this._helpTooltipElement,this._helpMsg=t.help,this._projection=t.projection,this.feature=t.feature,this._map=null,this._feature=null,this._layer=new ol.layer.Vector({source:s,style(){return[new ol.style.Style({stroke:new ol.style.Stroke({lineDash:[10,10],width:3}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})]}}),this.set("beforeRemove",this.clear),this.set("layer",this._layer),this.on("drawstart",this._drawStart),this.on("drawend",this._drawEnd)}clear(){this._layer.getSource().clear(),this._clearMessagesAndListeners(),this.measureTooltip&&(this.measureTooltip.remove(),this.measureTooltip=null),this._map&&this._map.removeLayer(this._layer)}_clearMessagesAndListeners(){this._feature=null,this._map&&(this._helpTooltipElement.innerHTML="",this._helpTooltipElement.classList.add("hidden"),ol.Observable.unByKey(this._featureGeometryChangelistener),ol.Observable.unByKey(this._poinOnMapMoveListener),$(document).off("keydown",this._keyDownEventHandler))}_drawStart(t){this._map=this.getMap(),this._map.removeLayer(this._layer),this._feature=t.feature,this.feature&&this._feature.setGeometry(this.feature.getGeometry()),this._keyDownEventHandler=n=>{let s=this._feature.getGeometry();n.keyCode===46&&(s instanceof ol.geom.Polygon&&s.getCoordinates()[0].length>2?this.removeLastPoint():s instanceof ol.geom.LineString&&s.getCoordinates().length>1&&this.removeLastPoint())},$(document).on("keydown",this._keyDownEventHandler),this._layer.getSource().clear(),this._poinOnMapMoveListener=this._map.on("pointermove",n=>{n.dragging||this._feature&&this._helpMsg&&(this._helpTooltipElement.innerHTML=_e(this._helpMsg),this._helpTooltip.setPosition(n.coordinate),this._helpTooltipElement.classList.remove("hidden"))}),this._helpTooltipElement&&this._helpTooltipElement.parentNode.removeChild(this._helpTooltipElement),this._helpTooltip&&this._map.removeOverlay(this._helpTooltip),this._helpTooltipElement=document.createElement("div"),this._helpTooltipElement.className="mtooltip hidden",this._helpTooltip=new ol.Overlay({element:this._helpTooltipElement,offset:[15,0],positioning:"center-left"}),this._map.addOverlay(this._helpTooltip),this.measureTooltip&&this.measureTooltip.remove(),this.measureTooltip=_a({map:this._map,feature:this._feature})}_drawEnd(){this.measureTooltip.tooltip.getElement().className="mtooltip mtooltip-static",this.measureTooltip.tooltip.setOffset([0,-7]),this._clearMessagesAndListeners(),this._map.addLayer(this._layer)}},q1=class extends Kn{constructor(t={}){super({...t,clickmap:!0,enabled:!0,onToggled(n){this._interaction.setActive(this.isToggled()),n||this._interaction.clear(),!n&&this.interactions[this.types[0]]!==this._interaction&&(this.getMap().removeInteraction(this._interaction),this._interaction=this.interactions[this.types[0]],this.getMap().addInteraction(this._interaction))}}),this.types=[],this.interactions={},(t.types||[]).forEach(n=>this.addType(n)),this.types.length===0&&this.setVisible(!1),this.on("setMap",n=>n.map.addInteraction(this._interaction))}addType(t){this.types.includes(t)||(this.types.push(t),this._interactionClassOptions.geometryType={area:"Polygon",length:"LineString"}[t],this.interactions[t]=new du(this._interactionClassOptions),this.interactions[t].setActive(!1),this._interaction||(this._interaction=this.interactions[t]),this.types.length>1&&(this.toggledTool=this.toggledTool||{__title:"Measure",__iconClass:"measure",data:()=>({types:this.types,type:this.types[0]}),template:`
          <div style="width: 100%; padding: 5px;">
            <select ref="select" style="width: 100%" :search="false" v-select2="'type'">
              <option v-for="type in types" :value="type" v-t="'measure_types.' + type"></option>
            </select>
          </div>`,watch:{type:(n,s)=>{this.interactions[s].setActive(!1),this.interactions[s].clear(),this.getMap().removeInteraction(this.interactions[s]),this.getMap().addInteraction(this.interactions[n]),this.interactions[n].setActive(!0),this._interaction=this.interactions[n]}},created(){T.toggleUserMessage(!1)},beforeDestroy(){T.toggleUserMessage(!0)}}))}}});var $A=R(()=>{ze();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.mouseposition=function(){if(isMobile.any)return;let t=e.getProjection().getUnits()==="degrees",n=e.getEpsg(),s=(o,l)=>o==="EPSG:4326"?ol.coordinate.format(ol.proj.transform(l,n,"EPSG:4326"),"\xA0Lng: {x}, Lat: {y}\xA0\xA0 [EPSG:4326]\xA0",4):ol.coordinate.format(l,`\xA0${t?"Lng":"X"}: {x}, ${t?"Lat":"Y"}: {y}\xA0\xA0 [${o}]\xA0`,t?4:2);e.addControl("mouseposition",Object.assign(new ol.control.MousePosition({coordinateFormat:s.bind(null,n),undefinedHTML:!1,projection:e.getCrs(),target:"mouse-position-control"}),{offline:!0}),!1),n!=="EPSG:4326"&&e.getMapControlByType("mouseposition").on("change:epsg",o=>e.getMapControlByType("mouseposition").setCoordinateFormat(s.bind(null,o.epsg)))}})});var BA,hu,B1=R(()=>{vn();$i();ii();BA=Ut(Qa()),hu=class extends nt{constructor(t={}){super(),this._features=t.features||[],this._provider=t.provider||null,this._loadedIds=[],this._lockIds=[],this.setters=["addFeatures","addFeature","removeFeature","updateFeature","clear","getFeatures","commit","featuresLockedByOtherUser"]}addFeatures(t=[]){t.forEach(n=>this._addFeature(n))}addFeature(t){this._addFeature(t)}removeFeature(t){this._removeFeature(t)}updateFeature(t){this._updateFeature(t)}clear(){this._clearFeatures()}getFeatures(t={}){return _t(async()=>{if(this._provider){let n=this._filterFeaturesResponse(await this._provider.getFeatures(t));return this.addFeatures(n),n}return this._features})}commit(t,n){return _t(async()=>t&&this._provider?(t.lockids=this._lockIds,await Ye.post({url:this._provider._layer.getUrl("commit"),data:JSON.stringify(Object.assign(t,{style:this._provider._layer.config?.editing?.layer_style||void 0})),contentType:"application/json"})):Promise.reject())}featuresLockedByOtherUser(t=[]){}clone(){return(0,BA.default)(this)}setProvider(t){this._provider=t}getProvider(){return this._provider}unlock(){return _t(async()=>await Ye.post({url:this._provider._layer.getUrl("unlock")}))}_filterFeaturesResponse(t={}){let{count:n,features:s=[],featurelocks:o=[]}=t;if(n>0&&s.length===0)return this.featuresLockedByOtherUser(s),[];let l=this._lockIds.map(({featureid:h})=>h);o.filter(({featureid:h})=>!l.includes(h)).forEach(h=>this._lockIds.push(h));let a=[],u=s.filter(h=>{let p=h.getId();return o.find(({featureid:d})=>p==d)?this._loadedIds.indexOf(p)===-1?(this._loadedIds.push(p),!0):!1:(a.push(h),!1)});return n>s.length&&this.featuresLockedByOtherUser(a),u}getLockIds(){return this._lockIds}addLockIds(t){this._lockIds=[...new Set(this._lockIds.concat(...t))],this._lockIds.forEach(({featureid:n})=>this._loadedIds.push(n))}getFeatureById(t){return this._features.find(n=>t==n.getId())}getFeatureByUid(t){return this._features.find(n=>t===n.getUid())}_addFeature(t){this._features.push(t)}_updateFeature(t){this._features.find((n,s)=>{if(t.getUid()===n.getUid())return this._features[s]=t,!0})}setFeatures(t=[]){this._features=t}_removeFeature(t){this._features=this._features.filter(n=>t.getUid()!==n.getUid())}_clearFeatures(){this._features=null,this._features=[],this._lockIds=[],this._loadedIds=[]}getDataProvider(){return this._provider}readFeatures(){return this._features}}});var U1,mo,t_=R(()=>{ft();Ja();$i();ii();Xt();bl();B1();Oh();U1=Ut(Qa()),mo=class extends Gn{constructor(t={},n={}){super(t,n),this.setters=["clearFeatures","addFeature","updateFeature","setFeatures","setColor","getFeatures","commit"],this.type=Gn.LayerTypes.TABLE,this._color=null,this.layerId=t.id,this.isEditable()&&(this.layerForEditing=(async()=>{try{let{vector:s,constraints:o={},capabilities:l,style:a}=await Ot(this.getProvider("data").getConfig(n));return await vi(()=>window.g3wsdk.core.hasOwnProperty("editing"),$n),this.config.editing={fields:s.fields||[],format:s.format,constraints:o,capabilities:l||window.g3wsdk.constant.DEFAULT_EDITING_CAPABILITIES,form:{perc:null},style:s.style,geometrytype:s.geometrytype,visible:(s.editing||{visible:!0}).visible,layer_style:(s.editing||{layer_style:null}).layer_style},s.style&&this.setColor(s.style.color),this._editor=new window.g3wsdk.core.editing.Editor({layer:this}),this.setReady(!0),this}catch(s){return console.warn(s),this.setReady(!1),Promise.reject(this)}})(),this.state={...this.state,editing:{started:!1,modified:!1,ready:!1}}),this._featuresstore=new hu({provider:this.providers.data})}clearFeatures(){this._featuresstore.clearFeatures()}addFeature(t){this._featuresstore.addFeature(t)}updateFeature(t){this._featuresstore.updateFeature(t)}setFeatures(t){this._featuresstore.setFeatures(t)}setColor(t){this._color=t}getFeatures(t={}){return _t(async()=>{let n=await Ot(this._featuresstore.getFeatures(t));return this.emit("getFeatures",n),n})}commit(t){return _t(async()=>{let n=await Ot(this._featuresstore.commit(t));if(n&&n.result)try{let s=De(this.getId());s.isGeoLayer()&&t.update.forEach(({id:o,geometry:l}={})=>{if(s.getOlSelectionFeature(o)){let a=s.getOlSelectionFeature(o);a&&(a.feature=l,GUI.getService("map").setSelectionFeatures("update",{feature:l}))}}),t.delete.forEach(o=>{s.hasSelectionFid(o)&&s.excludeSelectionFid(o)})}catch(s){console.warn(s)}return n})}setFormPercentage(t){this.config.editing.form.perc=t}getFormPercentage(){return this.config.editing.form.perc}clone(){return(0,U1.default)(this)}getColor(){return this._color}readFeatures(){return this._featuresstore.readFeatures()}async getLayerForEditing({vectorurl:t}={}){t&&(this.vectorUrl=t);try{return await this.clone().layerForEditing}catch(n){return console.warn(n),n}}getEditingSource(){return this._editor.getEditingSource()}readEditingFeatures(){return this._editor.readEditingFeatures()}getEditingLayer(){return this}getEditingConstrains(){return this.config.editing.constraints}getEditingCapabilities(){return this.config.editing.capabilities}isFieldRequired(t){return(this.getEditingFields().find(n=>t===n.name)||{validate:{required:!1}}).validate.required}unlock(){return _t(async()=>await Ot(this._featuresstore.unlock()))}getEditingFields(t=!1){return t?(this.config.editing.fields||[]).filter(n=>n.editable):this.config.editing.fields||[]}isPkField(t){return(this.getEditingFields().find(n=>t===n.name)||{}).pk}isEditingFieldEditable(t){return(this.getEditingFields().find(n=>n.name===t)||{editable:!1}).editable}getEditingNotEditableFields(){return this.config.editing.fields.filter(t=>!t.editable).map(t=>t.name)}getEditingMediaFields(t=null){return this.config.editing.fields.filter(n=>n.input.type==="media").map(n=>n.name)}isReady(){return this.state.editing.ready}setReady(t=!1){this.state.editing.ready=t}getWidgetData(t={}){return _t(async()=>await Ye.get({url:this.getProvider("data")._layer.getUrl("widget")[t.type],params:{fields:t.fields}}))}getEditor(){return this._editor}isStarted(){return this._editor.isStarted()}getFeaturesStore(){return this._featuresstore}setFeaturesStore(t){this._featuresstore=t}setSource(t){this.setFeaturesStore(t)}getSource(){return this._featuresstore}addFeatures(t=[]){t.forEach(n=>this.addFeature(n))}addLockIds(t){this._featuresstore.addLockIds(t)}setFieldsWithValues(t,n){let s=(l=[])=>l.reduce((a,u)=>(u.type==="child"?a[u.name]=s(u.fields):u.value==="null"&&(u.value=null),a[u.name]=u.value,a),{}),o=s(n);return t.setProperties(o),o}getFieldsWithValues(t,n={}){let{exclude:s=[],get_default_value:o=!0}=n,l=(0,U1.default)(this.getEditingFields()),a;if(t instanceof ps)a=t;else if(t instanceof ol.Feature)a=new ps({feature:t});else if(t)a=this.getFeatureById(t);else return l;let u=a.getProperties();return l.forEach(h=>{if(h.value=u[h.name],h._value=u[h.name],h.update=!1,h.visible=s.indexOf(h.name)===-1,h.validate===void 0&&(h.validate={}),h.nullOption=h.nullOption===void 0||h.nullOption,h.forceNull=!1,h.validate.valid=!0,h.validate._valid=!0,h.value_from_default_value=!1,h.get_default_value=o,h.validate.exclude_values=new Set,h.validate.unique=h.validate.unique||!1,h.validate.required=h.validate.required||!1,h.validate.mutually_valid=!0,h.validate.empty=!1,h.validate.message=null,h.input){let p=this.getEditingFields().find(d=>d.name===h.name).input.options;h.input.options.loading=p.loading||{state:null},h.input.options.values=p.values||[]}}),l}createNewFeature(){let t=new ps({feature:new ol.Feature(this.getEditingFields().reduce((n,s)=>(n[s.name]=null,n),{}))});return t.setNew(),t}}});var Qi,fu=R(()=>{vn();ze();wp();ud();dd();$i();bl();t_();Qi=class extends mo{constructor(t={},n={}){super(t,n),this._mapLayer=null,this.type=Gn.LayerTypes.VECTOR}getEditingLayer(){return this.getMapLayer().getOLLayer()}resetEditingSource(t=[]){this.getMapLayer().resetSource(t)}getEditingGeometryType(){return this.config.editing.geometrytype}getMapLayer(){if(this._mapLayer)return this._mapLayer;this._mapLayer=new nt;let t=`${this.config.servertype} ${this.config.source?.type}`=="G3WSUITE geojson",n=t?this.get("style"):this.config.editing?this.config.editing.style:this.getCustomStyle(),s=n?new ol.style.Style(Object.entries(n||{}).reduce((o,[l,a])=>(l==="point"&&a.icon&&(o.image=new ol.style.Icon({src:a.icon.url,imageSize:a.icon.width})),l==="line"&&(o.stroke=new ol.style.Stroke({color:a.color,width:a.width})),l==="polygon"&&(o.fill=new ol.style.Fill({color:a.color})),o),{})):null;return this._mapLayer._olLayer=new ol.layer.Vector({id:this.getId(),__g3w_editable:this.isEditable(),source:new ol.source.Vector({features:this._editor&&this._editor.getEditingSource().getFeaturesCollection()||[]})}),!s&&Wl(this.getGeometryType())&&(s=new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:this.getColor()}),radius:5})})),!s&&qo(this.getGeometryType())&&(s=new ol.style.Style({stroke:new ol.style.Stroke({color:this.getColor(),width:3})})),!s&&$o(this.getGeometryType())&&(s=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000",width:1}),fill:new ol.style.Fill({color:this.getColor()})}),this._mapLayer._olLayer.setOpacity(.6)),this._mapLayer._olLayer.setStyle(s),this._mapLayer._olLayer.getEditingSource=()=>super.getEditingSource(),Object.assign(this._mapLayer,{_olLayer:this._mapLayer._olLayer,mapService:T.getService("map"),geometryType:this.getGeometryType(),geometrytype:null,type:null,crs:null,id:this.getId(),name:t&&this.getName()||"",style:n,color:this.getColor(),projection:t?this.getProjection().getCode():T.getService("map").getProjection().getCode(),url:t?this.get("source").url:void 0,provider:this.getProvider("data"),getProvider:()=>this._mapLayer.provider,resetSource:(o=[])=>this._mapLayer.setSource(new ol.source.Vector({features:o})),getFeatures:(o={})=>_t(async()=>this._mapLayer.addFeatures(await Ot(this._mapLayer.provider.getFeatures(o)))),addFeatures:(o=[])=>this._mapLayer.getSource().addFeatures(o),addFeature:o=>o&&this.getSource().addFeature(o),getOLLayer:()=>this._mapLayer._olLayer,getSource:()=>this._mapLayer._olLayer.getSource(),setSource:o=>this._mapLayer._olLayer.setSource(o),setStyle:o=>this._mapLayer._olLayer.setStyle(o),getFeatureById:o=>o?this._mapLayer._olLayer.getSource().getFeatureById(o):null,isVisible:()=>this._mapLayer._olLayer.getVisible(),setVisible:o=>this._mapLayer._olLayer.setVisible(o),clear:()=>this._mapLayer.getSource().clear(),addToMap:o=>o.addLayer(this._mapLayer._olLayer)}),t&&this._mapLayer.getFeatures({url:this.get("source").url,mapProjection:T.getService("map").getProjection().getCode()}),this._mapLayer}}});function Pt(e,t){return[null,void 0].includes(t)?t:`${e}${t}`}var Ei,xl,n_=R(()=>{ft();vn();Ke();gr();bl();fu();v1();Ei=class e extends nt{constructor(t={},n={},s="GET"){super(),this.config=t,this.id=t.id,this.iframe_internal=t.iframe_internal||!1,this.extent=t.extent,this.projection=t.projection,this.layer=null,this.layers=t.layers||[],this.allLayers=[],this.showSpinnerWhenLoading=!0,this.config.type!=="XYZ"&&(this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.getInfoFormat=()=>"application/vnd.ogc.gml",this.getGetFeatureInfoUrl=(o,l,a,u)=>this.getOLLayer().getSource().getGetFeatureInfoUrl(o,l,a,u),this.getQueryUrl=()=>this.layers[0].infourl&&this.layers[0].infourl!==""?this.layers[0].infourl:this.config.url),this.extraParams=n,this._method=s}getId(){return this.id}getOLLayer(t){return this._olLayer||(this._olLayer=this._makeOlLayer(t)),this._olLayer}getSource(){return this.getOLLayer().getSource()}getLayerConfigs(){return this.layers}addLayer(t){this.allLayers.find(n=>t===n)||this.allLayers.push(t),this.layers.find(n=>t===n)||this.layers.push(t),this.config.type==="XYZ"&&(this.layer=t)}removeLayer(t){this.layers=this.layers.filter(n=>t!==n)}isVisible(){return this.layers.filter(t=>t.isVisible()).length>0}_makeOlLayer(t){let n,s="image";if(this.config.type==="ARCGISMAPSERVER")n=new ol.layer.Tile({visible:!0,source:new ol.source.TileArcGISRest({url:this.config.url,projection:this.config.projection})});else if(this.config.type==="WMTS"){s="tile";let o={url:this.config.cache_provider==="mapproxy"||!(this.layers[0]&&this.layers[0].getWmsUrl)?this.config.url:this.layers[0].getWmsUrl(),id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:t?this.layers.map(a=>a.getWMSLayerName()):this.layers,cache_provider:this.config.cache_provider,cache_type:this.config.cache_type,cache_layer:this.config.cache_layer,cache_extent:this.config.cache_extent,cache_grid:this.config.cache_grid,cache_grid_extent:this.config.cache_grid_extent},l=o.cache_provider==="mapproxy"&&ol.tilegrid.createXYZ({extent:o.cache_grid_extent}).getResolutions();n=l?new ol.layer.Tile({source:new ol.source.WMTS({url:o.url,layer:o.cache_layer,matrixSet:o.cache_grid,format:o.cache_format||"png",projection:o.layers[0].getProjection(),tileGrid:new ol.tilegrid.WMTS({resolutions:l,origin:ol.extent.getTopLeft(o.cache_grid_extent),matrixIds:l.map((a,u)=>u)}),style:o.style||"",transparent:!1})}):e._makeOlLayer({layerObj:o,extraParams:this.extraParams||{},tiled:!0})}else if(this.config.type==="XYZ"){let o=this.config.url&&this.projection?this.projection:this.layer.getProjection();n=new ol.layer.Tile({visible:!0,projection:o,source:new ol.source.XYZ({url:this.config.url,maxZoom:20,minZoom:void 0,projection:o,crossOrigin:void 0,tileLoadFunction:this.iframe_internal?(l,a)=>{fetch(this._method==="POST"?(a||"").split("?")[0]:a,{method:this._method,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:this._method==="POST"?a.split("?")[1]:void 0}).then(async u=>l.getImage().src=URL.createObjectURL(await u.blob())).catch(u=>{console.error("Invalid tile",ol.TileState.ERROR,u),l.setState(ol.TileState.ERROR)})}:void 0,tileGrid:o.getUnits()==="degrees"||this.config.cache_provider==="mapproxy"?new ol.tilegrid.TileGrid({resolutions:ol.tilegrid.createXYZ({extent:o.getExtent(),maxZoom:20}).getResolutions().slice(1),extent:o.getExtent()}):void 0})})}else n=e._makeOlLayer({layerObj:{url:this.layers[0]&&this.layers[0].getWmsUrl?this.layers[0].getWmsUrl():this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:t?this.layers.map(o=>o.getWMSLayerName()):this.layers,format:this.config.format},extraParams:this.extraParams},this._method);return n.getSource().on(`${s}loadstart`,()=>this.emit("loadstart")),n.getSource().on(`${s}loadend`,()=>this.emit("loadend")),n.getSource().on(`${s}loaderror`,()=>this.emit("loaderror")),n}update(t={},n={}){let{force:s,...o}=n,{resolution:l,mapUnits:a}=t;if(this.allLayers.forEach(m=>(m.setDisabled(l,a),m.isDisabled())),this.config.type==="XYZ"){this._olLayer.setVisible(this.layer.isVisible());return}let u=this.layers.filter(m=>m.isVisible())||[];if(u.length<=0){this._olLayer.setVisible(!1);return}let h=[],p=[],d,_;u.forEach(m=>{let{LEGEND_ON:v,LEGEND_OFF:x}=iu(m);h.push(m.getStyle()),p.push(parseInt(m.getOpacity()/100*255)),v&&(d=d===void 0?v:`${d};${v}`),x&&(_=_===void 0?x:`${_};${x}`)}),this._olLayer.setVisible(!0),this._olLayer.getSource().updateParams&&this._olLayer.getSource().updateParams({...o,LEGEND_ON:d,LEGEND_OFF:_,filtertoken:F.tokens.filtertoken,LAYERS:`${u[0].isArcgisMapserver()?"show:":""}${u.map(m=>m.getWMSLayerName()).join(",")}`,STYLES:h.join(","),OPACITIES:p.join(",")})}setupCustomMapParamsToLegendUrl(t={}){this.config.type!=="XYZ"&&[].concat(this.layer||this.layers).forEach(n=>Object.assign(n.customParams,t))}};Ei._makeOlLayer=function(e={},t="GET"){return new(e.tiled?ol.layer.Tile:ol.layer.Image)({id:e.layerObj.id,name:e.layerObj.name,opacity:e.layerObj.opacity!==void 0?e.layerObj.opacity:1,visible:e.layerObj.visible,extent:e.layerObj.extent,maxResolution:e.layerObj.maxResolution,source:new(e.tiled?ol.source.TileWMS:ol.source.ImageWMS)({ratio:1,url:e.layerObj.url,projection:e.layerObj.projection?e.layerObj.projection.getCode():null,params:{...Object.fromEntries(Object.entries({DPI:Gr,TRANSPARENT:!0,FORMAT:e.layerObj.format,LAYERS:e.layerObj.layers!==void 0?e.layerObj.layers:"",VERSION:e.layerObj.version!==void 0?e.layerObj.version:"1.3.0",SLD_VERSION:e.layerObj.sld_version!==void 0?e.layerObj.sld_version:"1.1.0"}).filter(([n,s])=>n!=="FORMAT"?!0:s!==void 0)),...e.extraParams||{}},imageLoadFunction:e.layerObj.iframe_internal||t==="POST"?(n,s)=>{fetch(t==="POST"?(s||"").split("?")[0]:s,{method:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:t==="POST"?s.split("?")[1]:void 0}).then(async o=>n.getImage().src=URL.createObjectURL(await o.blob())).catch(o=>{console.error("Invalid tile",ol.TileState.ERROR,o),n.setState(ol.TileState.ERROR)})}:void 0})})};xl=class extends Gn{constructor(t={},n={}){super(t,n),this._BASE_LAYER=n._BASE_LAYER,this.setters=["change"],this.type=Gn.LayerTypes.IMAGE,this.customParams={},this._BASE_LAYER==="OSM"&&(this._makeOlLayer=()=>new ol.layer.Tile({source:new ol.source.OSM({url:this.config.url}),id:this.config.name||"osm",title:this.config.title||"OSM",basemap:!0})),this._BASE_LAYER==="Bing"&&(this._makeOlLayer=()=>{let s={streets:"Road",aerial:"Aerial",aerialwithlabels:"AerialWithLabels"}[this.config.source&&this.config.source.subtype]||"Aerial";return new ol.layer.Tile({name:s,visible:!1,preload:1/0,source:new ol.source.BingMaps({imagerySet:s,key:F.keys.vendorkeys.bing}),basemap:!0})}),this._BASE_LAYER==="TMS"&&(this._makeOlLayer=()=>{let s=this.config.url!==void 0?this.config.url:null,o=s&&this.getProjectionFromCrs(this.config.crs);if(s)return new ol.layer.Tile({visible:!1,projection:o,source:new ol.source.XYZ({url:s,maxZoom:this.config.maxZoom,minZoom:this.config.minZoom,projection:o,crossOrigin:"anonymous",tileGrid:o.getUnits()==="degrees"?new ol.tilegrid.TileGrid({resolutions:ol.tilegrid.createXYZ({extent:o.getExtent(),maxZoom:this.config.maxZoom}).getResolutions().slice(1),extent:o.getExtent()}):void 0})})}),this._BASE_LAYER==="WMTS"&&(this._makeOlLayer=()=>{let{url:s,layer:o,attributions:l,matrixSet:a,format:u="image/png",style:h="default",requestEncoding:p,grid:d,grid_extent:_}=this.config,m=this.config.projection||this.getProjectionFromCrs(this.config.crs);if(a){let v=ol.extent.getWidth(m.getExtent())/256;return new ol.layer.Tile({opacity:.7,source:new ol.source.WMTS({url:s,projection:m,layer:o,matrixSet:a,requestEncoding:p,format:u,attributions:l,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(m.getExtent()),resolutions:Array.from({length:14},(x,b)=>v/Math.pow(2,b)),matrixIds:Array.from({length:14},(x,b)=>b)}),style:h})})}if(d&&_){let v=ol.tilegrid.createXYZ({extent:_}).getResolutions();return new ol.layer.Tile({source:new ol.source.WMTS({url:s,layer:o,projection:m,matrixSet:d,format:u||"png",tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(_),resolutions:v,matrixIds:v.map((x,b)=>b)}),style:h,transparent:!1})})}}),this._BASE_LAYER==="WMS"&&(this._makeOlLayer=()=>Ei._makeOlLayer({layerObj:{url:this.config.url,projection:this.getProjectionFromCrs(this.config.crs),attributions:this.config.attributions,layers:this.config.layers,tiled:this.config.singleTile===void 0?!1:this.config.singleTile,opacity:this.config.opacity===void 0?1:this.config.opacity}})),this._BASE_LAYER==="ARCGISMAPSERVER"&&(this._makeOlLayer=()=>{let{url:s,visible:o=!0,extent:l,projection:a,attributions:u,crossOrigin:h}=this.config;return new ol.layer.Tile({extent:l,visible:o,source:new ol.source.TileArcGISRest({url:s,projection:a,attributions:u,crossOrigin:h})})}),this._makeOlLayer&&this.isWMS()?(this._mapLayer=new Ei({url:this.getWmsUrl(),id:this.state.id,tiled:this.state.tiled}),this._mapLayer.addLayer(this)):this._makeOlLayer&&(this._mapLayer=this)}change(){}async getLayerForEditing({force:t=!1,vectorurl:n,project_type:s,project:o}={}){if(!t&&!this.isEditable())return null;try{let l=await new Qi(this.config,{vectorurl:n,project_type:s,project:o||F.project}).layerForEditing;return this.setEditingLayer(l),l}catch(l){return console.warn(l),Promise.reject(l)}}isBaseLayer(){return this.config.baselayer}isWMS(){return["QGIS","Mapserver","Geoserver","OGC"].includes(this.config.servertype)}getCrs(){return this.config.crs.epsg}isExternalWMS(){return!!(this.config.source&&this.config.source.external&&this.config.source.url)}isArcgisMapserver(){return this.isExternalWMS()&&this.config.source.type==="arcgismapserver"}_hasExternalWMSOrLegend(t="map"){let{source:n}=this.config;return n&&(t!=="map"||this.isExternalWMS()&&this.config.crs.epsg===this.config.map_crs)&&(t!=="legend"||n.external)}getWMSLayerName({type:t="map"}={}){let{source:n}=this.config||{source:{}},s=n.layers||n.layer;return s&&this._hasExternalWMSOrLegend(t)?s:this.config.wms_use_layer_ids?this.getId():this.getName()}getWmsUrl({type:t="map"}={}){let{source:n}=this.config||{source:{}};return n.url&&this._hasExternalWMSOrLegend(t)&&["wms","wmst"].includes(n.type)?n.url:this.config.wmsUrl}getWFSLayerName(){return(this.config.infolayer||this.getName()).replace(/\s/g,"_").replaceAll(":","-")}useProxy(){return this.isExternalWMS()&&this.config.crs.epsg===this.config.map_crs&&this.getInfoFormats()}getWMSInfoLayerName(){return this.useProxy()?this.getSource().layers:this.config.wms_use_layer_ids?this.getId():this.getName()}getPrintLayerName(){return this.config.wms_use_layer_ids?this.getId():this.getName()}isWfsActive(){return Array.isArray(this.config.ows)&&this.config.ows.some(t=>t==="WFS")}getWfsUrl(){return F.project.state.metadata.wms_url||this.config.wmsUrl}getQueryUrl(){let t=super.getQueryUrl(),n=this.getServerType()==="QGIS"&&this.isExternalWMS()&&this.config.crs.epsg===this.config.map_crs;return n&&this.getInfoFormats()?this.getSource().url:n?`${t}SOURCE=${this.config.source.type}`:t}getLegendUrl(t={},n={categories:!1,all:!1,format:"image/png"}){let s,o,{width:l,height:a,color:u="white",fontsize:h=10,transparent:p=!0,boxspace:d,layerspace:_,layertitle:m=!0,layertitlespace:v,symbolspace:x,iconlabelspace:b,symbolwidth:w,symbolheight:L,itemfontfamily:D,layerfontfamily:G,layerfontbold:W,itemfontbold:P,itemfontsize:j,layerfontitalic:V,layerfontsize:H,showfeaturecount:se,itemfontitalic:M,rulelabel:ie,crs:E,bbox:X,sld_version:K="1.1.0"}={...t,...this.customParams};if(this.isArcgisMapserver())s=this.getConfig().source.url.replace("/rest/","/")+"/WMSServer",o=["request=GetLegendGraphic","version=1.3.0","format=image/png",`LAYER=${this.getConfig().source.layer}`];else{let te=n.categories&&(["image/png",void 0].includes(n.format)||F.project.state.context_base_legend)?iu(this):void 0;s=this.getWmsUrl({type:"legend"}),o=["SERVICE=WMS","VERSION=1.3.0","REQUEST=GetLegendGraphic",Pt("SLD_VERSION=",K),Pt("WIDTH=",l),Pt("HEIGHT=",a),Pt("FORMAT=",n.format===void 0?"image/png":n.format),Pt("TRANSPARENT=",p),Pt("ITEMFONTCOLOR=",u),Pt("LAYERFONTCOLOR=",u),Pt("LAYERTITLE=",m),Pt("ITEMFONTSIZE=",j||h),Pt("CRS=",E),Pt("BBOX=",n.all===!0?void 0:[!1,void 0].includes(n.all)&&X&&X.join(",")),Pt("BOXSPACE=",d),Pt("LAYERSPACE=",_),Pt("LAYERTITLESPACE=",v),Pt("SYMBOLSPACE=",x),Pt("ICONLABELSPACE=",b),Pt("SYMBOLWIDTH=",n.categories&&n.format==="application/json"?16:w),Pt("SYMBOLHEIGHT=",n.categories&&n.format==="application/json"?16:L),Pt("LAYERFONTFAMILY=",G),Pt("ITEMFONTFAMILY=",D),Pt("LAYERFONTBOLD=",W),Pt("ITEMFONTBOLD=",P),Pt("LAYERFONTITALIC=",V),Pt("LAYERFONTSIZE=",H),Pt("SHOWFEATURECOUNT=",se),Pt("ITEMFONTITALIC=",M),Pt("RULELABEL=",ie),Pt("LEGEND_ON=",te&&te.LEGEND_ON),Pt("LEGEND_OFF=",te&&te.LEGEND_OFF),Pt("STYLES=",n.categories&&n.format==="application/json"?encodeURIComponent(this.getCurrentStyle().name):void 0),Pt("LAYER=",this.getWMSLayerName({type:"legend"}))]}return`${s}${s.indexOf("?")>-1?"&":"?"}${o.filter(te=>te).join("&")}`}getMapLayer(t={},n){if(this._mapLayer)return this._mapLayer;t.iframe_internal=F.iframe&&!this.isExternalWMS();let s=this.isExternalWMS()?"GET":this.getOwsMethod(),o=this.config.bbox?[this.config.bbox.minx,this.config.bbox.miny,this.config.bbox.maxx,this.config.bbox.maxy]:null,l=this.config.source,a=this.config.cache_provider,u=this.config.cache_service_type||"tms",h=this.config.cache_layer,p=this.config.cache_extent,d=this.config.cache_grid,_=this.config.cache_grid_extent,m=this.isCached()?this.getCacheUrl():t.url||this.getWmsUrl();return this.isCached()&&u==="tms"?new Ei({...t,extent:o,url:m,cache_provider:a,type:"XYZ"},{},s):this.isExternalWMS()&&l&&l.type==="arcgismapserver"?new Ei({...t,...l},n):this.isCached()&&u==="wmts"?new Ei({...t,url:m,cache_provider:a,cache_layer:h,cache_extent:p,cache_grid:d,cache_grid_extent:_,type:"WMTS"},n,s):this.isExternalWMS()&&l&&l.type==="wmst"?new Ei({...t,url:m,cache_provider:a,type:"WMTS"},n,s):new Ei({...t,url:m},n,s)}getFormat(){return this.isExternalWMS()&&this.getSource()?this.getSource().format:super.getFormat()}getOwsMethod(){return this.isExternalWMS()||!/^\/ows/.test(new URL(this.getQueryUrl(),window.initConfig.baseurl).pathname)?"GET":this.config.ows_method}update(t,n){this.isWMS()&&this._mapLayer.update(t,n)}setVisible(t){return this._mapLayer&&this.getOLLayer().setVisible(t),super.setVisible(t)}getSource(){return this._mapLayer?this.getOLLayer().getSource():super.getSource()}getProjectionFromCrs(t={}){return t.epsg=t.epsg?t.epsg:"EPSG:3857",In.get(t)}getOLLayer(){return!this._olLayer&&this._makeOlLayer&&(this._olLayer=this._makeOlLayer(),this._olLayer.getSource().on("imageloadstart",()=>this.emit("loadstart")),this._olLayer.getSource().on("imageloadend",()=>this.emit("loadend")),this._mapLayer.config.attributions&&this._olLayer.getSource().setAttributions(this._mapLayer.config.attributions),this._olLayer.setVisible(this._mapLayer.state.visible)),this._olLayer}}});var pu,z1=R(()=>{vn();Wt();pu=class extends nt{constructor(t={}){super(),this.config={id:t.id||Date.now(),projection:t.projection,extent:t.extent,initextent:t.initextent,wmsUrl:t.wmsUrl,catalog:t.catalog??!0},this.state={layerstree:[],relations:null},this._isQueryable=t.queryable??!0,this._layers=this.config.layers||{},this.setters=["setLayerSelected","addLayers","addLayer","removeLayer"]}setLayerSelected(t,n){this.getLayers().forEach(s=>s.state.selected=t===s.getId()?n:!1)}addLayers(t=[]){t.forEach(n=>this.addLayer(n))}addLayer(t){this._layers[t.getId()]=t}removeLayer(t){delete this._layers[t.getId()]}isQueryable(){return this._isQueryable}setQueryable(t){this._isQueryable=!!t}showOnCatalog(){return this.config.catalog}setOptions(t={}){this.config=t}getId(){return this.config.id}removeLayers(){Object.entries(this._layers).forEach(([t,n])=>this.removeLayer(n))}getLayersDict(t={},n={}){if(!t||[t.PRINTABLE,t.QUERYABLE,t.FILTERABLE,t.EDITABLE,t.VISIBLE,t.SELECTED,t.CACHED,t.SELECTED_OR_ALL,t.SERVERTYPE,t.BASELAYER,t.GEOLAYER,t.VECTORLAYER,t.HIDDEN,t.DISABLED,t.IDS].every(l=>l===void 0))return this._layers;let s=Object.values(this._layers);if(t.IDS){let l=[].concat(t.IDS);s=s.filter(a=>l.includes(a.getId()))}if(t.SELECTED_OR_ALL){let l=s.filter(a=>a.isSelected());s=l.length>0?l:s}let o=l=>typeof l=="boolean";if(o(t.SELECTED)&&!t.SELECTED_OR_ALL&&(s=s.filter(l=>t.SELECTED===l.isSelected())),o(t.QUERYABLE)&&(s=s.filter(l=>t.QUERYABLE===l.isQueryable())),o(t.FILTERABLE)&&(s=s.filter(l=>t.FILTERABLE===l.isFilterable(n.filtrable||null))),o(t.EDITABLE)&&(s=s.filter(l=>t.EDITABLE===l.isEditable())),o(t.VISIBLE)&&(s=s.filter(l=>t.VISIBLE===l.isVisible())),o(t.CACHED)&&(s=s.filter(l=>t.CACHED===l.isCached())),o(t.BASELAYER)&&(s=s.filter(l=>t.BASELAYER===l.isBaseLayer())),o(t.GEOLAYER)&&(s=s.filter(l=>t.GEOLAYER===l.state.geolayer)),o(t.VECTORLAYER)&&(s=s.filter(l=>t.VECTORLAYER===l.isType("vector"))),o(t.HIDDEN)&&(s=s.filter(l=>t.HIDDEN===l.isHidden())),o(t.DISABLED)&&(s=s.filter(l=>t.DISABLED===l.isDisabled())),typeof t.SERVERTYPE=="string"&&t.SERVERTYPE.length&&(s=s.filter(l=>t.SERVERTYPE===l.getServerType())),t.PRINTABLE&&(s=s.filter(l=>l.state.geolayer&&l.isPrintable({scale:t.PRINTABLE.scale}))),n.TOC_ORDER&&this.state.layerstree){let l=[],a=u=>{u.nodes.forEach(h=>{h.id?l.push(h.id):a(h)})};return a(this.state.layerstree[0]),l.map(u=>s.find(h=>u===h.getId())).filter(u=>u)}return s}getLayers(t={},n={}){return Object.values(this.getLayersDict(t,n))}getBaseLayers(){return this.getLayersDict({BASELAYER:!0})}getLayerById(t){return this.getLayersDict()[t]}getLayerByName(t){return this._layers.find(n=>t===n.getName())}getLayerAttributes(t){return this.getLayerById(t).getAttributes()}getLayerAttributeLabel(t,n){return this.getLayerById(t).getAttributeLabel(n)}getGeoLayers(){return this.getLayers({GEOLAYER:!0})}selectLayer(t,n){this.setLayerSelected(t,n)}getProjection(){return this.config.projection}getExtent(){return this.config.extent}getInitExtent(){return this.config.initextent}getWmsUrl(){return this.config.wmsUrl}removeLayersTree(){this.state.layerstree.splice(0,this.state.layerstree.length)}getLayersTree(){return this.state.layerstree}setLayersTree(t=[],n,s=!0){let[o,l,a,u]=this.getInitExtent(),h={title:n||this.config.id,root:!0,parentGroup:null,expanded:s,disabled:!1,checked:!0,bbox:{minx:o,miny:l,maxx:a,maxy:u},nodes:t,legendurls:[]};t.length>0&&(this._traverseLayersTree(t,h),this.state.layerstree.splice(0,0,h))}createLayersTree(t,n={layerstree:null,expanded:!1,full:!1}){let s=[];if(n.layerstree&&n.full===!0)return this.state.layerstree;if(n.layerstree&&n.full!==!0){let o=this.getLayers({BASELAYER:!1}).map(l=>l.getId());this._traverseLightLayersTree(n.layerstree,s,o)}n.layerstree||(s=this.getGeoLayers().map(o=>({id:o.getId(),name:o.getName(),title:o.getTitle(),visible:o.isVisible()||!1}))),this.setLayersTree(s,t,n.expanded)}_traverseLightLayersTree(t,n,s){t.forEach(o=>{let l=null;o.id!==null&&o.id!==void 0&&s.find(a=>o.id===a)&&(l={...l,...o}),o.nodes!==null&&o.nodes!==void 0&&(l={...l,name:o.name,title:o.name,groupId:Qe(),root:!1,nodes:[],checked:o.checked,mutually_exclusive:o["mutually-exclusive"],"mutually-exclusive":o["mutually-exclusive"]},this._traverseLightLayersTree(o.nodes,l.nodes,s)),l!==null&&(l.expanded=o.expanded,n.push(l))})}_traverseLayersTree(t,n){t.forEach((s,o)=>{s.id!==void 0&&(t[o]=this.getLayerById(s.id).getState()),s.id!==void 0&&(t[o]=this.getLayerById(s.id).getState(),t[o].bbox&&this._setLayersTreeGroupBBox(n,{bbox:t[o].bbox,epsg:t[o].epsg})),Array.isArray(s.nodes)&&(s.nodes.forEach(l=>l.parentGroup=n),this._traverseLayersTree(s.nodes,s)),t[o].parentGroup=n})}_setLayersTreeGroupBBox(t,{bbox:n,epsg:s}={}){let o=this.getProjection().getCode();if(s!==o){let[l,a,u,h]=ol.proj.transformExtent([n.minx,n.miny,n.maxx,n.maxy],s,o);n={minx:l,miny:a,maxx:u,maxy:h}}t.bbox===void 0?t.bbox=n:t.bbox=ol.extent.extend([t.bbox.minx,t.bbox.miny,t.bbox.maxx,t.bbox.maxy],[n.minx,n.miny,n.maxx,n.maxy]).reduce((l,a,u)=>{switch(u){case 0:l.minx=a;break;case 1:l.miny=a;break;case 2:l.maxx=a;break;case 3:l.maxy=a;break}return l},{minxx:null,miny:null,maxx:null,maxy:null}),t.parentGroup&&t.parentGroup.root===!1&&this._setLayersTreeGroupBBox(t.parentGroup,{bbox:t.bbox,epsg:o})}}});function V1(e){return[void 0,null].includes(e)||e&&!e.epsg?null:e&&e.epsg?(e.epsg=Vo(e.epsg),e):{epsg:Vo(e),proj4:"",axisinverted:!1,geographic:!1}}async function wl(e,t={}){let n=window.initConfig.projects.find(u=>e===u.gid);if(!n)return console.log("Project doesn't exist",e),Promise.reject("Project doesn't exist");let s=!Ft[e]&&await Ye.get({url:`${window.initConfig.urls.baseurl}${window.initConfig.urls.config}/${window.initConfig.id}/${n.type}/${n.id}?_t=${n.modified}`}),o=s&&t.map_theme&&Object.values(s.map_themes).flat().find(({theme:u})=>u===t.map_theme);if(o){let{result:u,data:h}=await Ye.get({url:`/${n.type}/api/prjtheme/${n.id}/${t.map_theme}`});u&&(s.layerstree=h,o.layetstree=h,o.default=!0)}Ft[e]=Object.assign(Ft[e]||{},Object.assign(n,s)),Ft[e]=Object.assign(Ft[e],{WMSUrl:`${window.initConfig.urls.baseurl}${window.initConfig.urls.ows}/${window.initConfig.id}/${Ft[e].type}/${Ft[e].id}/`,relations:(Ft[e].relations||[]).map(u=>(u.type==="ONE"&&Ft[e].layers.find(h=>{if(h.id===u.referencingLayer)return u.name=h.name,u.origname=h.origname,!0}),u)),catalog_tab:Ft[e].toc_tab_default||Ft[e]._catalog_tab||"layers",ows_method:Ft[e].ows_method||"GET",toc_layers_init_status:Ft[e].toc_layers_init_status||"not_collapsed",toc_themes_init_status:Ft[e].toc_themes_init_status||"collapsed",query_point_tolerance:Ft[e].query_point_tolerance||Go,crs:V1(Ft[e].crs),baselayers:Ft[e].baselayers.filter(u=>u.servertype==="Bing"?F.keys.vendorkeys.bing:!0).map(u=>Object.assign(u,{visible:u.id&&u.id===(F.baseLayerId!==null?F.baseLayerId:Ft[e].initbaselayer)||!!u.fixed,baselayer:!0}))});let l=Object.assign(new nt,{setters:{setBaseLayer(u){window.initConfig.baselayers.forEach(h=>{this._layersStore.getLayerById(h.id)?.setVisible(u===h.id),h.visible=u===h.id})}},state:Ft[e],urls:{map_themes:`/${Ft[e].type}/api/prjtheme/${Ft[e].id}/`,vector_data:`${Ft[e].vectorurl}data/${Ft[e].type}/${Ft[e].id}/`,featurecount:`${Ft[e].vectorurl}featurecount/${Ft[e].type}/${Ft[e].id}/`,editorformstructure:`${Ft[e].vectorurl}editorformstructure/${Ft[e].type}/${Ft[e].id}/`},_projection:In.get(V1(Ft[e].crs)),_layersStore:new pu,getQueryPointTolerance:()=>l.state.query_point_tolerance,getRelations:()=>l.state.relations,getRelationById:u=>l.state.relations.find(h=>u===h.id),getLayerById:u=>l._layersStore.getLayerById(u),getLayers:()=>[...l.state.layers,...l.state.baselayers],getState:()=>l.state,getPrint:()=>l.state.print||[],getId:()=>l.state.id,getType:()=>l.state.type,getGid:()=>l.state.gid,getName:()=>l.state.name,getCrs:()=>l._projection.getCode(),getProjection:()=>l._projection,getLayersStore:()=>l._layersStore,getUrl:u=>l.urls[u],getConfigLayers:({key:u}={})=>u?l.state.layers.filter(h=>h[u]!==void 0):l.state.layers}),a=u=>{for(let h=0;h<u.length;h++){let p=u[h];p.id!==void 0&&l.state.layers.forEach(d=>{if(p.id===d.id)return p.name=d.name,d.wmsUrl=l.state.WMSUrl,d.project=l,p[h]=Object.assign(d,p),!1}),Array.isArray(p.nodes)&&(p.title=p.name,a(p.nodes))}};return a(l.state.layerstree),l._layersStore.setOptions({id:l.state.gid,projection:l._projection,extent:l.state.extent,initextent:l.state.initextent,wmsUrl:l.state.WMSUrl,catalog:window.initConfig.overviewproject!==l.state.gid}),l._layersStore.addLayers(l.getLayers().flatMap(u=>{let h=Object.assign({},u,{crs:V1(u.crs||l.state.crs),projection:u.crs?In.get(u.crs):l._projection,ows_method:l.state.ows_method,wms_use_layer_ids:l.state.wms_use_layer_ids,styles:u.styles&&u.styles.map(d=>({...d}))}),p=`${h.servertype} ${h.source&&h.source.type}`;return h.geometrytype==="NoGeometry"&&["QGIS virtual","QGIS postgres","QGIS mssql","QGIS spatialite","QGIS wfs","QGIS delimitedtext","QGIS oracle","QGIS ogr","QGIS mdal"].includes(p)?new mo(h,{project:l}):h.geometrytype&&h.geometrytype!=="NoGeometry"&&!h.crs?[]:["OGC wfs","G3WSUITE geojson"].includes(p)||["Local","G3WSUITE"].includes(h.servertype)?new Qi(h,{project:l}):h.geometrytype&&h.geometrytype!=="NoGeometry"&&["OGC wms","QGIS postgresraster","QGIS virtual","QGIS postgres","QGIS mssql","QGIS spatialite","QGIS wfs","QGIS delimitedtext","QGIS oracle","QGIS ogr","QGIS mdal","QGIS arcgisfeatureserver"].includes(p)?new xl(h,{project:l}):!h.geometrytype&&["OGC wms","QGIS postgresraster","QGIS wmst","QGIS wcs","QGIS wms","QGIS gdal","QGIS vectortile","QGIS vector-tile","QGIS mdal","QGIS arcgismapserver"].includes(p)?new xl(h,{project:l}):["OSM","Bing","TMS","ARCGISMAPSERVER","WMTS","WMS"].includes(h.servertype)?new xl(h,{project:l,_BASE_LAYER:h.servertype}):(console.warn("Uknown layer type",h),[])})),l._layersStore.createLayersTree(l.state.name,{layerstree:l.state.layerstree,expanded:l.state.toc_layers_init_status==="not_collapsed"}),(l.state.search||[]).forEach(u=>u.search_endpoint="api"),l}var Ft,i_=R(()=>{ft();vn();Ke();gr();Qp();ii();t_();fu();n_();z1();Object.entries({TableLayer:mo,VectorLayer:Qi,ImageLayer:xl}).forEach(([e,t])=>console.assert(t!==void 0,`${e} is undefined`));Ft={}});var UA=R(()=>{ze();i_();n_();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.overview=async function(){if(!(isMobile.any||!window.initConfig.overviewproject))try{let t=await wl(window.initConfig.overviewproject);e.createMapControl({id:"overview",add:!1,options:{ol:new ol.control.OverviewMap({view:new ol.View(e._calculateViewOptions({project:t,width:200,height:150})),collapsed:!1,className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:$(`<span class="${T.getFontClass("arrow-left")}"></span>`)[0],label:$(`<span class="${T.getFontClass("arrow-right")}"></span>`)[0],layers:Object.entries(t.getLayersStore().getLayers({GEOLAYER:!0,BASELAYER:!1}).reduce((s,o)=>{let l=o.getMultiLayerId();return s[l]=s[l]||[],s[l].push(o),s},{})||[]).map(([s,o])=>{let l=new Ei({url:t.state.WMSUrl,id:`overview_layer_${s}`,tiled:o[0].state.tiled});return o.reverse().forEach(a=>l.addLayer(a)),l.getOLLayer(!0)}).reverse()}),position:"bl"}}),document.querySelector(".g3w-map-controls-left-bottom").style.left="230px",new MutationObserver(s=>{s.forEach(o=>{o.attributeName==="class"&&(document.querySelector(".g3w-map-controls-left-bottom").style.left=o.target.classList.contains("ol-collapsed")?"50px":"230px")})}).observe(document.querySelector(".ol-custom-overviewmap"),{attributes:!0})}catch(t){console.warn(t)}}})});var zA=R(()=>{Ke();ze();ei();_l();dr();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.query=function(){e.createMapControl({id:"query",options:{toggled:!0,offline:!1,tipLabel:"Query layer",clickmap:!0,interactionClass:gi,cursorClass:"ol-help",onSetMap({map:t,setter:n}){this.runQuery=this.runQuery||(async({coordinates:s})=>{T.closeSideBar();try{let o=F.project;await gt.getData("query:coordinates",{inputs:{coordinates:s,feature_count:o.state.feature_count||5,query_point_tolerance:o.getQueryPointTolerance(),multilayers:[].concat(o.state.querymultilayers).includes(this.name)}})}catch(o){console.warn("Error running spatial query: ",o)}}),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.runQuery)}),n==="after"&&this.getInteraction().on("picked",En(async s=>{this.dispatchEvent({type:"picked",coordinates:s.coordinate})}))}}})}})});var $t,_o=R(()=>{$t=new Vue});function Sl(e){let t=T.getService("map").getSelectedLayer();return(e.layers||[]).some(n=>n.isVisible()&&(e.name==="querybypolygon"?n!==t&&t&&t.isVisible():!0))}function H1(e){let{MapLayersStoresRegistry:t}=(gu(),kn(s_)).default,n=t.getQuerableLayersStores();return[...new Set([...n.flatMap(s=>s.getLayers({GEOLAYER:!0,QUERYABLE:!0,SELECTED_OR_ALL:!0})),...(T.getService("map").getLegacyExternalLayers()||[]).filter(s=>e==="querybypolygon"?W1.includes(s.getGeometryType()):!0),...e==="querybypolygon"?n.flatMap(s=>s.getLayers({GEOLAYER:!0,QUERYABLE:!0,SELECTED_OR_ALL:!0},{})):[]])]}var W1,Nn,ht,Y1,VA=R(()=>{ft();_o();ze();ei();Ke();ma();_l();dr();Xt();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.querybypolygon=e.setupControl.querybbox=e.setupControl.querybycircle=e.setupControl.querybydrawpolygon=e.setupControl.querybyfreehand=function(){isMobile.any||Object.keys(window.initConfig.mapcontrols).filter(t=>["querybypolygon","querybbox","querybycircle","querybydrawpolygon","querybyfreehand"].includes(t)).forEach(t=>{e.getMapControlByType("queryby")?e.getMapControlByType("queryby").addType(t):e.addControl("queryby",new Y1({types:[t]}))})}});W1=[fe.POLYGON,fe.POLYGONZ,fe.POLYGONM,fe.POLYGONZM,fe.POLYGON25D,fe.MULTIPOLYGON,fe.MULTIPOLYGONZ,fe.MULTIPOLYGONM,fe.MULTIPOLYGONZM,fe.MULTIPOLYGON25D],Nn={},ht=Vue.observable({bbox:null,dfeature:null,layer:null,feature:null,coordinates:null,radius:0}),Y1=class extends Kn{constructor(t={}){super({...t,name:"queryby",tipLabel:"mapcontrols.queryby.title",enabled:!0,cursorClass:null}),this.types=[],(t.types||[]).forEach(n=>this.addType(n)),this.types.length===0?this.setVisible(!1):this.element.classList.add("ol-"+this.types[0]),Nn.queryby=this,this.on("toggled",({toggled:n})=>{if(!n)return T.closeUserMessage();T.showUserMessage({title:"mapcontrols.queryby.title",type:"tool",size:"small",iconClass:"info",closable:!1,hooks:{body:{data:()=>({types:this.types,type:this.types[0],methods:rd,method:this.getSpatialMethod(),layers:[],selectedLayer:(T.getService("map").getSelectedLayer()||{getId(){return"__ALL__"}}).getId(),reloading:!0}),template:`
              <div style="width: 100%;">
                <!-- DOCS URL -->
                <a
                  :href           = "'https://g3w-suite.readthedocs.io/en/v3.9.x/g3wsuite_client.html#map-controls'"
                  target          = "_blank"
                  style           = "position: absolute;inset: 1em 1em auto auto;"
                  data-i18n-title = "Docs"
                  data-placement  = "bottom"
                >
                  <i :class = "$fa('external-link')"></i>
                </a>
                <!-- SPATIAL METHOD -->
                <div style="padding: 5px;">
                  <select :search="false" v-select2="'method'">
                    <option v-for="method in methods" :value="method" v-t="'mapcontrols.queryby.methods.' + method"></option>
                  </select>
                </div>
                <!-- QUERY TYPE -->
                <div style="padding: 5px;">
                  <select :search="false" v-select2="'type'" :templateSelection="templateType" :templateResult="templateType">
                    <option v-for="type in types" :value="type" v-t="'mapcontrols.queryby.' + type + '.tooltip'"></option>
                  </select>
                </div>
                <!-- RADIUS TYPE IN METERS-->
                <div v-if="'querybycircle' === type" style="padding: 5px;">
                  <label for="g3w_querybycircle_radius" v-t:pre="'mapcontrols.querybycircle.label'">[m]</label>
                  <div style = "display: flex">
                    <input
                      id      = "g3w_querybycircle_radius"
                      v-model = "radius"
                      class   =  "form-control"
                      step    = '1'
                      min     = '0'
                      type    = "number"/>
                    <!-- CLEAR RADIUS -->
                    <button 
                      type        = "button" 
                      @click.stop = "radius = 0" 
                      class       = "btn btn-default"
                    >
                      <i :class="$fa('clear')"></i>
                    </button>
                  </div>
                </div>
                <!-- SELECTED LAYER -->
                <div style = "padding: 5px;">
                  <label v-t="'mapcontrols.queryby.layer'"></label>
                  <select v-if="!reloading" ref="layer" :select2_value = "selectedLayer" v-select2="'selectedLayer'" :templateSelection="templateLayer" :templateResult="templateLayer">
                    <option v-t="all" :value ="'__ALL__'"></option>
                    <option v-for="layer in layers" :value="layer.getId()" :selected="selectedLayer === layer.getId()">{{ layer.get('name') }}</option>
                    <option :value="'__NEW__'" v-t="'mapcontrols.queryby.new'"></option>
                  </select>
                </div>
                <!-- HELP TEXT -->
                <div ref="help" v-t="help"></div>
                <!-- CLEAR SELECTION -->
                <button v-if = "!['__ALL__', '__NEW__'].includes(selectedLayer)" style="color: #FFF; background-color: var(--skin-color)" class="clear-selected-layer btn btn-block"  @click.stop="selectedLayer = '__ALL__'"><i :class = "$fa('clear')"></i> <span v-t="'Invert Selection'"></span></button>
              </div>`,computed:{control(){return Nn[this.type]},queryable(){return(this.control.layers||[]).filter(s=>this.type==="querybypolygon"?W1.includes(s.getGeometryType()):!0)},help(){return`mapcontrols.${this.type}.help.message`},all(){return`mapcontrols.queryby.${!this.queryable.length||!Sl(this.control)?"none":"all"}`},radius:{get(){return ht.radius},set(s){if(Number.isNaN(s)||s<0){this.radius=ht.radius;return}ht.radius=Math.floor(s*(T.getService("map").getMapUnits()==="m"?1:ol.proj.Units.METERS_PER_UNIT.degrees)),ht.dfeature&&ht.radius>0&&(ht.dfeature.getGeometry().setRadius(ht.radius),Nn.queryby.runSpatialQuery(this.type))}}},watch:{method(){this.reset()},type(){this.selectedLayer="__ALL__",this.reset()},control(){this.types.forEach(s=>Nn.queryby.element.classList.toggle("ol-"+s,s===this.type))},layers(){this.checkLayers()},selectedLayer:{immediate:!0,handler(s,o){if(this.checkLayers(),o===void 0)return;let l=T.getService("map");if(s==="__NEW__"){let u=l.onafter("loadExternalLayer",p=>{l.selectLayer(p.get("id")),this.reset()}),h=document.querySelector("#add-layer-type");h.value="file",h.dispatchEvent(new Event("change")),$("#modal-addlayer").one("hidden.bs.modal",()=>l.un("loadExternalLayer",u)),l.showAddLayerModal()}let a=(T.getService("map").getSelectedLayer()||{getId(){return"__ALL__"}}).getId();!["__ALL__","__NEW__"].includes(s)&&s!==a&&l.selectLayer(s),["__ALL__","__NEW__"].includes(s)&&a!=="__ALL__"&&l.selectLayer(),s!=="__NEW__"&&this.type!=="querybypolygon"&&this.reset()}}},methods:{checkLayers(){!["__ALL__","__NEW__"].includes(this.selectedLayer)&&this.layers.length&&!(this.layers||[]).map(s=>s.getId()).includes(this.selectedLayer)&&(this.selectedLayer="__ALL__")},async reset(){this.reloading=!0,this.layers.splice(0),this.types.filter(s=>s!==this.type).forEach(s=>{s==="querybycircle"&&(ht.radius=0),s==="querybbox"&&(ht.bbox=null),s==="querybypolygon"&&(ht.layer=null,ht.feature=null,ht.coordinates=null),["querybydrawpolygon","querybycircle"].includes(this.type)||(ht.dfeature=null),Nn[s].autorun=!1}),this.control.spatialMethod=this.method,this.control.toggle(!0,{parent:Nn.queryby.id}),await this.$nextTick(),this.layers.push(...this.queryable),this.control.autorun&&T.getContentLength()&&Nn.queryby.runSpatialQuery(this.type),this.control.setEnable(Sl(this.control)),this.reloading=!1},templateType(s){return s.id?$(`<span><i class="${{querybbox:"far fa-square",querybycircle:"far fa-circle",querybydrawpolygon:"fas fa-draw-polygon",querybypolygon:"fa fa-hand-pointer",querybyfreehand:"fas fa-pen-fancy"}[s.id]}"></i>&nbsp;&nbsp;${s.text}</span>`):s.text},templateLayer(s){if(!s.id||s.id==="__NEW__")return s.text;let o=T.getService("map").getLegacyExternalLayers(),l=De(s.id)||o.find(u=>u.get("id")===s.id),a=s.id==="__ALL__"||!l?"":`<i class="${T.getFontClass(l.isVisible()?"eye":"eye-close")}"></i>&nbsp;&nbsp;`;return $(`<span>${a}${s.text}</span>`)}},mounted(){Nn.queryby.usermessage=this,T.toggleUserMessage(!1),this.reset()},beforeDestroy:()=>{T.toggleUserMessage(!0),this.types.forEach(s=>{Nn[s].toggle(!1),Nn[s].autorun=!1,Nn.queryby.element.classList.toggle(`ol-${s}`,s===this.types[0])})}}}})})}addType(t){if(this.types.includes(t))return;this.types.splice(this.types.includes("querybypolygon")?this.types.indexOf("querybypoyling"):this.types.length,0,t);let n=Nn[t]=new Kn({name:t,offline:!1,visible:!1,geometryTypes:["querybypolygon","querybydrawpolygon","querybyfreehand"].includes(t)?W1:[],cursorClass:t==="querybypolygon"?"ol-pointer":"ol-crosshair",interactionClass:{querybbox:ol.interaction.DragBox,querybycircle:ol.interaction.Draw,querybydrawpolygon:ol.interaction.Draw,querybyfreehand:ol.interaction.Draw,querybypolygon:gi}[t],interactionClassOptions:["querybydrawpolygon","querybycircle","querybyfreehand"].includes(t)?{type:t==="querybycircle"?"Circle":"Polygon",freehand:t==="querybyfreehand"}:{},layers:H1(t),onSetMap({setter:s,map:o}){if(s==="after"){if(t==="querybbox"){let l=null;this._interaction.on("boxstart",a=>l=a.coordinate),this._interaction.on("boxend",En(a=>{ht.bbox=ol.extent.boundingExtent([l,a.coordinate]),this.dispatchEvent({type:"bboxend",extent:ht.bbox}),l=null,this._autountoggle&&this.toggle()})),this.setEventKey({eventType:"bboxend",eventKey:this.on("bboxend",()=>Nn.queryby.runSpatialQuery("querybbox"))})}t==="querybycircle"&&this._interaction.on("drawstart",l=>{let a=l.feature.getGeometry();a.setRadius(ht.radius),a.on("change",()=>ht.radius=a.getRadius()),ht.radius>0&&this._interaction.finishDrawing()}),["querybydrawpolygon","querybycircle","querybyfreehand"].includes(t)&&(this._interaction.on("drawend",En(l=>{if(t==="querybycircle"){let a=l.feature.getGeometry().getRadius();ht.radius=a*(T.getService("map").getMapUnits()==="m"?1:ol.proj.Units.METERS_PER_UNIT.degrees)}ht.dfeature=l.feature,this.dispatchEvent({type:"drawend",feature:ht.dfeature}),this._autountoggle&&this.toggle()})),this.setEventKey({eventType:"drawend",eventKey:this.on("drawend",()=>Nn.queryby.runSpatialQuery(t))})),t==="querybypolygon"&&(this._interaction.on("picked",En(async l=>{ht.coordinates=l.coordinate,this.dispatchEvent({type:"picked",coordinates:ht.coordinates}),this._autountoggle&&this.toggle()})),this.setEventKey({eventType:"picked",eventKey:this.on("picked",async()=>{T.closeSideBar();try{let{data:l=[]}=await gt.getData("query:coordinates",{inputs:{feature_count:F.project.state.feature_count||5,coordinates:ht.coordinates},outputs:{show({data:a=[],query:u}){let h=a.length===0;return u.coordinates=h?u.coordinates:null,h}}});l.length&&l[0].features.length&&(ht.feature=l[0].features[0],ht.layer=l[0].layer,Nn.queryby.runSpatialQuery("querybypolygon"))}catch(l){console.warn("Error running spatial query:",l)}})}),this.setEnable(!1))}},clickmap:!0});T.getService("map").addControl(t,n,!1),n._interaction.on("change:active",s=>{this.setMouseCursor(s.target.get(s.key),n.cursorClass),this.cursorClass=n.cursorClass}),this.unwatches=this.unwatches||[],this.unwatches.forEach(s=>s()),this.unwatches.splice(0),this.unwatches.push(...this.types.flatMap(s=>{let o=Nn[s];return(o.layers||[]).map(l=>$t.$watch(()=>l.state.visible,()=>{this.usermessage&&$(this.usermessage.$refs.layer).trigger("change"),o.setEnable(o.isToggled()&&Sl(o)),o._interaction.setActive(o.getEnable())}))}))}onSelectLayer(t){let n=document.querySelector(".usermessage-content .clear-selected-layer");n&&n.classList.toggle("hidden",!t),this.usermessage&&(this.usermessage.selectedLayer=t?t.getId():"__ALL__"),this.types.forEach(s=>{let o=Nn[s],l=t&&o.layers.find(u=>u===t),a=t&&t.isQueryable()&&(o.getGeometryTypes()||[]).includes(t.getGeometryType());["querybbox","querybydrawpolygon","querybycircle"].includes(s)&&o.setEnable(o.isToggled()&&(t?l&&l.isVisible():Sl(o))),s==="querybypolygon"&&o.setEnable(o.isToggled()&&a&&Sl(o)),o._interaction.setActive(o.getEnable())})}onAddExternalLayer({layer:t,unWatches:n}){this.types.forEach(s=>{let o=Nn[s];o.layers=H1(s),n.push($t.$watch(()=>[t.selected,t.visible],()=>{o.setEnable(o.isToggled()&&(t.selected?t.visible:Sl(o))),o._interaction.setActive(o.getEnable())},{immediate:!0}))})}onRemoveExternalLayer(t){this.types.forEach(n=>{let s=Nn[n];s.layers=H1(n).filter(o=>o.getId()!==t.getId()),s.setEnable(s.isToggled()&&Sl(Nn[n])),s._interaction.setActive(s.getEnable())}),setTimeout(()=>{this.usermessage&&this.usermessage.reset()})}async runSpatialQuery(t){let n=!1,s=()=>{n=!0,this.toggle()};T.once("error-output-data",s);try{let o=Nn[t];if(T.closeSideBar(),t==="querybbox"&&ht.bbox===null||t==="querybypolygon"&&[ht.coordinates,ht.feature,ht.layer].includes(null))return;let l=T.getService("map").getSelectedLayer(),a=T.getService("map").getLegacyExternalLayers(),u=F.project;t==="querybbox"&&await gt.getData("query:bbox",{inputs:{bbox:ht.bbox,feature_count:u.state.feature_count||5,addExternal:!l||a.some(h=>h===l),layersFilterObject:{SELECTED_OR_ALL:!0,QUERYABLE:!0,VISIBLE:!0},multilayers:!1,filterConfig:{spatialMethod:o.getSpatialMethod()}}}),["querybypolygon","querybydrawpolygon","querybycircle","querybyfreehand"].includes(t)&&await gt.getData("query:polygon",{inputs:{layerName:t==="querybypolygon"?ht.layer.getName?ht.layer.getName():ht.layer.get("name"):"",excludeSelected:t==="querybypolygon"||!l,feature:(()=>{switch(t){case"querybypolygon":return ht.feature;case"querybydrawpolygon":return ht.dfeature;case"querybyfreehand":return ht.dfeature;case"querybycircle":let h=ht.dfeature.clone();return h.setGeometry(ol.geom.Polygon.fromCircle(ht.dfeature.getGeometry(),64)),h}})(),external:{add:t==="querybypolygon"||!l||a.some(h=>h===l),filter:{SELECTED:["querybydrawpolygon","querybycircle","querybyfreehand"].includes(t)&&!!l}},type:(t||"").replace("queryby","")||void 0,multilayers:!1,filterConfig:{spatialMethod:o.getSpatialMethod()}},outputs:{show:({error:h=!1})=>!h}}),o.autorun=!n}catch(o){console.warn("Error running spatial query: ",o)}T.off("error-output-data",s)}}});function ba(e,t="m"){return 1/((e>=1?1/e:e)*od[t]*Gr)}var qh=R(()=>{ft()});var X1,HA=R(()=>{ze();ft();qh();su();Rt();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.scale=function(){e.addControl("scale",new X1({coordinateFormat:ol.coordinate.createStringXY(4),projection:e.getCrs(),isMobile:isMobile.any}),!1)}});X1=class extends ol.control.Control{constructor(t={}){t.target="scale-control",t.offline=!0,super(t),this.isMobile=t.isMobile||!1}layout(t){let n=this,s=!1,o=!1,l=$(this.element).children("select").select2({tags:!0,dropdownParent:$(t.getTargetElement()),width:"120px",height:"20px",language:{noResults:()=>_e("Invalid Scale")},minimumResultsForSearch:this.isMobile?-1:0,createTag(p={}){let d=null,_;return p.term.includes("1:")?_=p.term.split("1:")[1]:Number.isInteger(Number(p.term))&&Number(p.term)>0&&(_=Number(p.term),_<=n.scales[0]&&(d={id:_,text:`1:${p.term}`,new:!0},a())),d}});t.on("change:size",()=>l.select2("close"));function a(){l.find("option").each((p,d)=>!n.scales.includes(1*d.value)&&$(d).remove())}function u(p){l.find("option[value='"+p.id+"']").length?l.val(p.id).trigger("change"):(a(),l.append(new Option(p.text,p.id,!0,!0)).trigger("change"))}t.on("moveend",function(){if(s){let p=parseInt(Ks(this.getView().getResolution(),this.getView().getProjection().getUnits()));u({id:p,text:`1:${p}`,new:!0}),s=!1}else o=!1});let h=()=>{t.getView().on("change:resolution",()=>s=!o)};h(),t.on("change:view",()=>h()),l.on("select2:select",p=>{o=!0;let d=p.params.data;d.new&&(a(),u(d)),t.getView().setResolution(ba(1*d.id,t.getView().getProjection().getUnits()))})}setMap(t){if(!t)return;let n=parseInt(Ks(t.getView().getResolution(),t.getView().getProjection().getUnits()));this.scales=Ul.map(a=>a.value).filter(a=>a<n),this.scales.unshift(n);let s=document.createElement("div"),o=document.createElement("select"),l=Object.assign(document.createElement("optgroup"),{label:""});if(this.scales.forEach((a,u)=>{l.appendChild(Object.assign(document.createElement("option"),{value:a,text:`1:${a}`,selected:u===0}))}),o.appendChild(l),!this.isMobile){let a=document.createElement("optgroup");a.label=_e("Custom"),o.appendChild(a)}s.appendChild(o),this.element=s,$(this.element).css("height","20px"),this.layout(t),super.setMap(t)}}});var WA=R(()=>{ze();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.scaleline=function(){e.createMapControl({id:"scaleline",add:!1,options:{ol:new ol.control.ScaleLine,position:"br"}})}})});function $h(e,t){try{return new URL(e).origin===new URL(t).origin}catch(n){return console.warn(n),!1}}var Z1=R(()=>{});function lee(e){let t;return e.getVisible&&!e.getVisible()||e instanceof ol.layer.Vector?!1:e instanceof ol.layer.Tile||e instanceof ol.layer.Image?(t=e.getSource().getUrl(),t&&!$h(t,location)):(e.getConfig().source||{}).external?(t=e.getConfig().source.url,t&&!$h(t,location)):!1}var Q1,YA=R(()=>{Ke();ze();ga();Z1();ma();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.screenshot=e.setupControl.geoscreenshot=function(){isMobile.any||Object.keys(window.initConfig.mapcontrols).filter(t=>["screenshot","geoscreenshot"].includes(t)).forEach(t=>{e.getMapControlByType("screenshot")?e.getMapControlByType("screenshot").addType(t):e.addControl("screenshot",new Q1({types:[t],layers:[...g3wsdk.core.map.MapLayersStoreRegistry.getLayers(),...e._layers.external]}))})}});Q1=class extends Kn{constructor(t={}){t.layers=t.layers===void 0?[]:t.layers,super({name:"maptoimage",tipLabel:"Screenshot",clickmap:!0,enabled:!0,layers:[],...t}),this.types=[],(t.types||[]).forEach(n=>this.addType(n)),this.layers=t.layers,this.setVisible(this.checkVisible(this.layers)),this.isVisible()&&(T.getService("map").onafter("loadExternalLayer",this._addLayer.bind(this)),T.getService("map").onafter("unloadExternalLayer",this._removeLayer.bind(this)))}addType(t){this.types.includes(t)||(this.types.push(t),this.toggledTool=this.toggledTool||{__title:"Screen capture",__iconClass:"camera",data:()=>({types:this.types,type:this.types[0]}),template:`
        <div style="width: 100%; padding: 5px;">
          <select ref="select" style="width: 100%;" :search="false" v-select2="'type'">
            <option v-for="type in types" :value="type" v-t="({ screenshot: 'PNG', geoscreenshot: 'GeoTIFF'})[type]"></option>
          </select>
          <button v-disabled = "loading" style="margin-top: 5px" class="btn btn-block btn-success" @click.stop="download(type)" v-t="'Generate'"></button>
        </div>`,computed:{loading:()=>F.download},methods:{download:async n=>{let s=T.getService("map");F.download=!0;try{let o=n==="screenshot"?await s.createMapImage():await(await fetch(`/${s.project.getType()}/api/asgeotiff/${s.project.getId()}/`,{method:"POST",body:Object.entries({image:await s.createMapImage(),csrfmiddlewaretoken:s.getCookie("csrftoken"),bbox:s.getMapBBOX().toString()}).reduce((l,a)=>(l.append(a[0],a[1]),l),new FormData)})).blob();(this._onclick||Si)(o,`map_${Date.now()}`)}catch(o){T.showUserMessage({type:o.name==="SecurityError"?"warning":"alert",message:o.name==="SecurityError"?"screenshot_error":"Screenshot error creation"}),console.warn(o)}return F.download=!1,!0}},created(){T.toggleUserMessage(!1)},beforeDestroy(){T.toggleUserMessage(!0)}})}_addLayer(t){this.layers.push(t),this.change(this.layers),t.on("change:visible",()=>this.change(this.layers))}_removeLayer(t){this.layers=this.layers.filter(n=>n!==t),this.change(this.layers)}change(t=[]){this.setVisible(this.checkVisible(t))}checkVisible(t=[]){return this.isVisible()&&!t.some(lee)}}});var K1,XA=R(()=>{Rt();Ke();ze();ii();ma();_l();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.streetview=function(){e.addControl("streetview",new K1)}});K1=class extends Kn{constructor(t={}){super({...t,offline:!1,visible:!0,name:"streetview",tipLabel:_e("StreetView"),clickmap:!0,interactionClass:gi,interactionClassOptions:{cursor:"ol-streetview"},cursorClass:"ol-streetview"}),this.key=F.keys.vendorkeys.google,this.key&&Ye.get({url:"https://maps.googleapis.com/maps/api/streetview",params:{location:0,size:"456x456",key:this.key}}).catch(n=>{console.warn(n),this.keyError=n.responseText}),$script(`https://maps.googleapis.com/maps/api/js?${this.key?"key="+this.key:""}`),this._sv=null,this._panorama=null,this._map=null,this._projection=null,this._lastposition=null,this._streetViewFeature=new ol.Feature,this.active=!1,this._layer=new ol.layer.Vector({source:new ol.source.Vector({features:[]}),style:n=>{let s=n.getGeometry().getCoordinates();this._lastposition=this._lastposition?this._lastposition:s;let o=s[0]-this._lastposition[0],l=s[1]-this._lastposition[1],a=-Math.atan2(l,o),u=[new ol.style.Style({image:new ol.style.Icon({src:"/static/client/images/streetviewarrow.png",rotation:a})}),new ol.style.Style({image:new ol.style.Icon({src:"/static/client/images/streetview.svg"})})];return this._lastposition=s,u}}),this.key&&T.on("closecontent",()=>{this.isToggled()&&this._layer.getSource().clear()})}setProjection(t){this._projection=t}setPosition(t){let n,s=this;this.active=!0,this._sv||(this._sv=new google.maps.StreetViewService),this._sv.getPanorama({location:t},o=>{s._panorama=new google.maps.StreetViewPanorama(document.getElementById("streetview"),{imageDateControl:!0}),s._panorama.addListener("position_changed",function(){if(s.isToggled()){let l=ol.proj.transform([this.getPosition().lng(),this.getPosition().lat()],"EPSG:4326",s._projection.getCode());s._streetViewFeature.setGeometry(new ol.geom.Point(l)),n=s._map.getPixelFromCoordinate(l),(n[0]+15>s._map.getSize()[0]||n[1]+15>s._map.getSize()[1]||n[0]<15||n[1]<15)&&s._map.getView().setCenter(l)}}),o&&o.location&&(s._panorama.setPov({pitch:0,heading:0}),s._panorama.setPosition(o.location.latLng))}).then(o=>{o===void 0&&T.closeContent()}).catch(o=>{console.warn(o),this.toggle()})}setMap(t){this._map=t,super.setMap(t),this.setProjection(this._map.getView().getProjection()),this._map.addLayer(this._layer),this._interaction.on("picked",({coordinate:n})=>{this.showStreetView(n),this._autountoggle&&this.toggle()})}showStreetView(t){let[n,s]=ol.proj.transform(t,this._map.getView().getProjection().getCode(),"EPSG:4326");this.key?(T.setContent({title:"StreetView",content:'<div id="streetview" style="height:100%; width:100%;">'+(this.keyError?`<div
          style = "display: flex;justify-content: center;align-items: center;font-weight: bold;height: 100%;padding: 10px;background-color: #FFF;"
          class = "skin-color"
        >${this.keyError}</div>`:"")+"</div>"}),this.keyError||this.setPosition({lng:n,lat:s})):(this._streetViewFeature.setGeometry(new ol.geom.Point(t)),window.open(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${s},${n}`))}clearMarker(){this._streetViewFeature.setGeometry(null)}clear(){this._layer.getSource().clear(),this._streetViewFeature.setGeometry(null),this.clearMarker(),this._panorama=null,this.active&&T.closeContent(),this.active=!1}toggle(t){super.toggle(t),this.isToggled()?this._layer.getSource().addFeatures([this._streetViewFeature]):this.clear()}}});var ZA=R(()=>{Rt();ze();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.zoom=function(){e.createMapControl({id:"zoom",options:{ol:new ol.control.Zoom({zoomInTipLabel:_e("Zoom in"),zoomOutLabel:_e("Zoom out")})}})}})});var QA=R(()=>{Rt();ze();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.zoombox=function(){isMobile.any||(e.createMapControl({id:"zoombox",options:{tipLabel:_e("Zoom to box"),interactionClass:ol.interaction.DragBox,cursorClass:"ol-crosshair",onSetMap({setter:t,map:n}){t==="after"&&(this._startCoordinate=null,this._interaction.on("boxstart",s=>this._startCoordinate=s.coordinate),this._interaction.on("boxend",s=>{this.dispatchEvent({type:"zoomend",extent:ol.extent.boundingExtent([this._startCoordinate,s.coordinate])}),this._startCoordinate=null}))}}}),e.getMapControlByType("zoombox").on("zoomend",t=>e.viewer.fit(t.extent)))}})});var KA=R(()=>{ze();Us();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.zoomhistory=function(){e.createMapControl({id:"zoomhistory",add:!1,options:{ol:new class extends ol.control.Control{constructor(){super({element:Object.assign(document.createElement("div"),{className:"ol-zoom-history ol-unselectable ol-control"}),target:document.querySelector(".g3w-map-controls-left-bottom")});let t=T.getService("map").getMap(),n=[],s=0;this.element.style.display="flex",this.element.style.gap="5px",this.element.innerHTML=`
              <div data-i18n-title="Zoom Last"><button type="button" value="last" class="fas fa-reply g3w-disabled" style="font-weight: 900;"></button></div>
              <div data-i18n-title="Zoom Next"><button type="button" value="next" class="fas fa-share g3w-disabled" style="font-weight: 900;"></button></div>
            `,this.element.querySelectorAll("button").forEach(o=>{o.parentElement.setAttribute("data-placement","top"),o.addEventListener("click",l=>{s+=l.currentTarget.value==="last"?-1:1,T.getService("map").getMap().getView().fit(n.at(s)),this.element.querySelector("button[value=last]").classList.toggle("g3w-disabled",s===0),this.element.querySelector("button[value=next]").classList.toggle("g3w-disabled",n.length-1===s)})}),n.push(t.getView().calculateExtent(t.getSize())),t.getView().on("change",un(()=>{s!==n.length-1&&n.splice(s-n.length+1),n.push(t.getView().calculateExtent(t.getSize())),s++,this.element.querySelector("button[value=last]").classList.toggle("g3w-disabled",s===0),this.element.querySelector("button[value=next]").classList.toggle("g3w-disabled",n.length-1===s)},600)),T.getService("map").getMap().addControl(this)}}}})}})});var JA=R(()=>{Rt();ze();T.once("ready",async()=>{let e=T.getService("map");e.setupControl.zoomtoextent=function(){e.createMapControl({id:"zoomtoextent",options:{ol:new ol.control.ZoomToExtent({extent:e.project.state.extent,tipLabel:_e("Fit map extent")})}})}})});var e4=R(()=>{PA();DA();GA();jA();qA();$1();$A();UA();zA();VA();HA();WA();YA();XA();ZA();QA();KA();JA()});function mu({filter:e=""}){return e=t4.reduce((t,[n,s])=>t.replace(new RegExp(`\\s+${s}\\s+`,"g"),`${s}`).replace(new RegExp(`'${s}`,"g"),`${s}`).replace(new RegExp(`${s}'`,"g"),`${s}`),e).replace(/'$/g,"").replace(/"/g,""),e=t4.reduce((t,[n,s])=>t.replace(new RegExp(s,"g"),["AND","OR"].includes(s)?`|${n},`:`|${n}|`),e).split("|").map((t,n)=>(n+1)%3===0?encodeURIComponent(t):t).join("|"),e}var t4,r_=R(()=>{ft();t4=Object.entries(sd)});function _u(e,t={}){return Object.values(F.catalog).flatMap(n=>n.getLayers(e,t))}var o_=R(()=>{Ke()});var s_={};qn(s_,{MapLayersStoresRegistry:()=>El,default:()=>cee});var yu,wt,J1,El,cee,gu=R(()=>{yu=Ut(z0());vn();Ke();cc();gr();ei();Hl();ze();ma();e4();wp();ud();dd();B0();lu();su();qh();Wt();r_();Wm();Xt();o_();Ja();Us();fu();wt={maxZoom:1e3,controls:{},offlineids:[],selectedLayer:null,stores:{},externalLayers:[],animatingHighlight:!1,layers:Object.assign(new nt({setters:{addLayersStore:e=>{wt.stores[e.getId()]=e},removeLayersStore:e=>{e&&delete wt.layers.stores[e.getId()]}}}),{getLayerById:e=>Object.values(wt.stores).map(t=>t.getLayerById(e)).find(t=>t),getLayers:e=>Object.values(wt.stores).flatMap(t=>t.getLayers(e)),getQuerableLayersStores:()=>Object.values(wt.stores).filter(e=>e.isQueryable()),getLayersStore:e=>wt.stores[e],getLayersStores:()=>Object.values(wt.stores)})},J1=class extends nt{setupControl={};constructor(){super(),this.state={mapUnits:"m",bbox:[],hidemaps:[],resolution:null,center:null,loading:!1,hidden:!0,scale:0,map_info:{info:null,style:null},mapunits:["metric"]},this._ready=new Promise(t=>this.once("viewerset",t)),this.viewer=null,this.target="map",this.layersCount=0,this.project=F.project,this._controls=[],this._layers={base:{},g3w:[],external_wms:[],external_vector:[],external:[]},this._externalInteractions=[],this.defaultsLayers={mapcenter:new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({image:new ol.style.Icon({opacity:1,src:"/static/client/images/mapcentermarker.svg",scale:.8})})}),_style:{highlightLayer:{color:void 0},selectionLayer:{color:"red"}},highlightLayer:new ol.layer.Vector({source:new ol.source.Vector,style:t=>[Wa({geometryType:t.getGeometry().getType(),color:this.defaultsLayers._style.highlightLayer.color,fill:!0})]}),selectionLayer:new ol.layer.Vector({source:new ol.source.Vector})},this.layersExtraParams={},this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null,listener:null},this.config=window.initConfig,this._howManyAreLoading=0,this._marker=null,this.onLayerLoadStart=this.onLayerLoadStart.bind(this),this.onLayerLoadEnd=this.onLayerLoadEnd.bind(this),this.onLayerLoadError=this.onLayerLoadError.bind(this),this.onExtraParamsSet=this.onExtraParamsSet.bind(this),this.updateMapLayers=this.updateMapLayers.bind(this),this._keyEvents={ol:[],stores:[],unwatches:[]},this.project.onafter("setBaseLayer",()=>this.updateMapLayers()),this.setupCustomMapParamsToLegendUrl=un(this.setupCustomMapParamsToLegendUrl.bind(this),1e3),this.setters=["setupControls","addHideMap","setHidden","setupViewer","controlClick","loadExternalLayer","unloadExternalLayer"],this.on("extraParamsSet",this.onExtraParamsSet)}onExtraParamsSet(t,n){n&&this.getMapLayers().forEach(s=>s.update(this.state,t))}onLayerLoadStart(){this._howManyAreLoading===0&&(this.emit("loadstart"),T.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})),this._howManyAreLoading+=1}onLayerLoadEnd(){this._howManyAreLoading-=1,this._howManyAreLoading===0&&(this.emit("loadend"),T.hideSpinner("maploadspinner"))}onLayerLoadError(){this.project.state.show_load_layer_error&&(this.onLayerLoadError.shown||(T.notify.warning("Some layers are not available"),this.onLayerLoadError.shown=!0),this.onLayerLoadEnd())}isReady(){return this._ready}setUpMapOlEvents(){let t=this.project.state.context_base_legend;this._keyEvents.ol.forEach(n=>ol.Observable.unByKey(n)),this._keyEvents.ol.push(this.viewer.map.getView().on("change:resolution",()=>{this.state.bbox=this.getMapBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this.updateMapLayers(),t&&this.setupCustomMapParamsToLegendUrl()})),t?this._keyEvents.ol.push(this.viewer.map.on("moveend",()=>this.setupCustomMapParamsToLegendUrl())):this.setupCustomMapParamsToLegendUrl()}clear(){this.removeListener("extraParamsSet",this.onExtraParamsSet),this._keyEvents.ol.forEach(t=>ol.Observable.unByKey(t)),this._keyEvents.ol.splice(0),wt.layers.getLayersStores().forEach(this._removeEventsKeysToLayersStore.bind(this))}_addHideMap({ratio:t,layers:n=[],mainview:s=!1}={}){let o=this.state.hidemaps.at(-1),l=this.getMap().getView(),a=s?l:{projection:l.getProjection(),center:l.getCenter(),resolution:this.getResolution()};if(o.map=new ol.Map({controls:ol.control.defaults({attribution:!1,zoom:!1}),interactions:ol.interaction.defaults(),ol3Logo:!1,view:a instanceof ol.View?a:new ol.View(a),keyboardEventTarget:document,target:o.id}),t){let[u,h]=o.map.getSize();o.map.setSize([u,u*t])}return(n||[]).forEach(u=>o.map.addLayer(u)),o.map}removeHideMap(t){let n=(this.state.hidemaps||[]).findIndex(s=>t===s.id);n!==-1&&this.state.hidemaps.splice(n,1)}createMapImage({map:t}={}){return new Promise((n,s)=>{try{(t||this.getMap()).getViewport().querySelector("canvas").toBlob(l=>n(l))}catch(o){console.warn(o),s(o)}})}getProject(){return this.project}getMap(){try{return this.viewer.map}catch(t){console.warn(t)}}getProjection(){return this.project.getProjection()}isMapHidden(){return this.state.hidden}getCrs(){return this.project.getProjection().getCode()}getViewport(){return this.viewer.map.getViewport()}getResolution(){return this.viewer.map.getView().getResolution()}getEpsg(){return this.viewer.map.getView().getProjection().getCode()}showMarker(t,n=1e3){this._marker.setPosition(t),setTimeout(()=>this._marker.setPosition(),n)}getLayerByName(t){return this.getMap().getLayers().getArray().find(n=>t===n.get("name"))}getLayerById(t){return this.getMap().getLayers().getArray().find(n=>t===n.get("id"))}getVectorLayerFeaturesFromCoordinates(t,n){let s,o=[],l=this.getMap(),a=this.getLayerById(t);if(Array.isArray(n)){if(n.length===2){let u=l.getPixelFromCoordinate(n);l.forEachFeatureAtPixel(u,h=>o.push(h),{layerFilter(h){return h===a}})}else if(n.length===4)switch(s=ol.geom.Polygon.fromExtent(n),a.constructor){case Qi:o=a.getIntersectedFeatures(s);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(u=>s.intersectsExtent(u.getGeometry().getExtent())&&o.push(u));break}}else if(n instanceof ol.geom.Polygon||n instanceof ol.geom.MultiPolygon)switch(s=n,a.constructor){case Qi:o=a.getIntersectedFeatures(s);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(u=>s.intersectsExtent(feature.getGeometry().getExtent())&&o.push(u));break}return o}getQueryLayerByCoordinates({layer:t,coordinates:n}={}){return new Promise((s,o)=>{t.query({coordinates:n,mapProjection:this.getProjection(),resolution:this.getResolution()}).then(l=>s(l)).fail(l=>{console.warn(l),o(l)})})}createMapControl(t,{id:n,add:s=!0,options:o={}}={}){typeof t!="string"&&(n=t.id,s=t.add??!0,o=t.options??{},t=n);let l=new Kn({name:n,...o});return this.addControl(n||t,l,s),l}showAddLayerModal(){$("#modal-addlayer").modal("show"),this.emit("addexternallayer")}getCenter(){return this.getMap().getView().getCenter()}async zoomToFid(t="",n="|"){let[s,o]=t.split(n);if(s===void 0&&o===void 0)return;let l=this.project.getLayerById(s),{data:a=[]}=await gt.getData("search:fids",{inputs:{layer:l,fids:[o]},outputs:{show:{loading:!1,async condition({data:h=[]}={}){return l.isEditable()&&await vi(()=>l.config.editing!==void 0),!!(h[0]&&h[0].features.length>0)}}}}),u=a[0]&&a[0].features[0];u&&await this.zoomToFeatures([u])}async zoomToFeaturesUrl(t=""){try{let[n,s]=t.split(":");if(!n||!s)return;let o=this.project.getLayers().find(h=>n===h.id||n===h.name||n===h.origname),l=o&&this.project.getLayerById(o.id),a=o&&await gt.getData("search:features",{inputs:{layer:l,filter:mu({layer:l,filter:s})},outputs:{show:{loading:!1,async condition({data:h=[]}={}){return l.isEditable()&&await vi(()=>l.config.editing!==void 0),!!(h[0]&&h[0].features.length>0)}}}}),u=a&&a.data&&a.data[0]&&a.data[0].features;u&&this.zoomToFeatures(u)}catch(n){console.warn(n)}}getMapExtent(){let t=this.getMap();return t.getView().calculateExtent(t.getSize())}async addMapExtentUrlParameterToUrl(t,n){t=new URL(t);let s=n!==void 0&&n!==this.getEpsg();return s&&await In.registerProjection(n),t.searchParams.set("map_extent",(s?ol.proj.transformExtent(this.getMapExtent(),this.getEpsg(),n):this.getMapExtent()).toString()),t.toString()}getMapControlByType(t){return typeof t!="string"&&(t=t.type),(this._controls.find(n=>t===n.type)||{}).control}addControl(t,n,s,o=!0,l=s?.isVisible?.()??!0){typeof n!="string"&&([t,n,s,o,l]=[t,t,n,s??!0,o??!0]),this.viewer.map.addControl(s),s.on("toggled",a=>this.emit("mapcontrol:toggled",a)),this._controls.push({id:t,type:n,control:s,visible:l,mapcontrol:o&&l}),s.on("controlclick",({target:a})=>{let u=!!(a.isClickMap&&a.isClickMap());u&&this._externalInteractions.forEach(h=>h.setActive(!1)),this.controlClick(a,{clickmap:u})}),$(s.element).find("button")[0]?.setAttribute("data-placement","left"),o&&!l&&(s.element.style.display="none"),o&&$(".g3w-map-controls").append(s.element),wt.controls[n]=s,s.offline===!1&&wt.offlineids.push({id:n,enable:s.getEnable()}),s.offline===!1&&s.getEnable()&&s.setEnable(F.online)}showControls(t){this._controls.forEach(n=>this.viewer.map.removeControl(n.control)),this._controls.forEach(n=>{n.visible=!t||t.indexOf(n.type)>-1?!0:n.visible,n.visible&&this.viewer.map.addControl(n.control)})}getMapControls(){return this._controls}removeControlById(t){this._controls.find((n,s)=>{if(t===n.id)return this._controls.splice(s,1),this.viewer.map.removeControl(n.control),n.control.hideControl&&n.control.hideControl(),!0})}removeControl(t){this._controls.find((n,s)=>{if(t===n.type)return this._controls.splice(s,1),this.viewer.map.removeControl(n.control),n.control.hideControl&&n.control.hideControl(),!0})}_unToggleControls({close:t=!0}={}){this._controls.forEach(n=>{n.control.isToggled&&n.control.isToggled()&&(n.control.toggle(!1),t&&T.closeContent())})}deactiveMapControls(){this._unToggleControls({close:!1})}disableClickMapControls(t=!0){this._controls.filter(n=>n.control.isClickMap&&n.control.isClickMap()).forEach(n=>{n.control.isToggled()&&n.control.toggle(),n.control[t?"disable":"enable"]()})}setupCustomMapParamsToLegendUrl(t=!0){if(t){let n=this.getMap(),s=n&&n.getSize().filter(l=>l>0)||null,o=s&&s.length===2?n.getView().calculateExtent(s):this.project.state.initextent;this.getMapLayers().forEach(l=>l.setupCustomMapParamsToLegendUrl&&l.setupCustomMapParamsToLegendUrl({crs:this.getEpsg(),bbox:n.getView().getProjection().getAxisOrientation()==="neu"?[o[1],o[0],o[3],o[2]]:o})),this.emit("change-map-legend-params")}}getMapLayerByLayerId(t){return this.getMapLayers().find(n=>n.getLayerConfigs().find(s=>t===s.getId()))}getMapLayers(){return this._layers.g3w}getBaseLayers(){return this._layers.base}getMapLayerForLayer(t){return this.getMapLayers().find(n=>`layer_${t.getMultiLayerId()}`===n.getId())}getProjectLayer(t){return wt.layers.getLayerById(t)}_calculateViewOptions({project:t,width:n,height:s,map_extent:o}={}){let l=o?o.split(",").map(u=>1*u):t.state.initextent,a=t.state.extent;return{extent:a,projection:this.getProjection(),center:ol.extent.getCenter(l),maxResolution:Math.max(ol.extent.getWidth(a)/n,ol.extent.getHeight(a)/s),resolution:Math.max(ol.extent.getWidth(l)/n,ol.extent.getHeight(l)/s)}}getMapUnits(){return this.state.mapUnits}async setupControls(){for(let t of Object.keys(this?.config?.mapcontrols||{}))try{await this.setupControl[t]()}catch(n){console.warn(n)}return this.getMapControls()}addHideMap({switchable:t=!1}={}){let n={id:`hidemap_${Date.now()}`,map:null,switchable:t};return this.state.hidemaps.push(n),n}setHidden(t){this.state.hidden=t}async setupViewer(t,n){if(t===0||n===0){console.warn("[G3W-CLIENT] map was hidden during bootstrap");return}let s=new URLSearchParams(location.search),o=1*(s.get("showmarker")||0),l=s.get("iframetype"),a=s.get("zoom_to_fid"),u=s.get("ztf"),h={lat:parseFloat(s.get("lat")),lon:parseFloat(s.get("lon")),x:parseFloat(s.get("x")),y:parseFloat(s.get("y"))},p=new URL(window.location);["zoom_to_fid","ztf"].forEach(b=>p.searchParams.delete(b)),window.history.replaceState(null,null,p),this.viewer&&this.viewer.destroy();let d=new ol.Map({controls:ol.control.defaults({attribution:!1,zoom:!1,rotateOptions:{autoHide:!0,tipLabel:"Reset rotation (CTRL+DRAG to rotate)"}}),interactions:ol.interaction.defaults().extend([new ol.interaction.DragRotate({condition:ol.events.condition.platformModifierKeyOnly})]),ol3Logo:!1,keyboardEventTarget:document,target:this.target,view:new ol.View(this._calculateViewOptions({width:t,height:n,project:this.project,map_extent:s.get("map_extent")}))});this.viewer={map:d,getMap:()=>this.viewer.map,getView:()=>this.viewer.map.getView(),getZoom:()=>this.viewer.map.getView().getZoom(),getResolution:()=>this.viewer.map.getView().getResolution(),getCenter:()=>this.viewer.map.getView().getCenter(),destroy:()=>{this.viewer.map&&(this.viewer.map.dispose(),this.viewer.map=null)},zoomTo:this.zoomTo.bind(this),goTo:this.goTo.bind(this),fit:this._fit.bind(this),changeBaseLayer:b=>this.map.getLayers().insertAt(0,this.map.getLayers().find(w=>b===w.get("name")))};let _=this.viewer.getMap();F.map.epsg=this.getEpsg(),F.map.unit=_.getView().getProjection().getUnits(),_.getInteractions().getArray().find(b=>b instanceof ol.interaction.DoubleClickZoom).setActive(!1),_.on("click",({coordinate:b})=>{let w=new ol.layer.Vector({source:new ol.source.Vector({features:[new ol.Feature({geometry:new ol.geom.Point(b)})]}),style:new ol.style.Style}),L=+new Date,D=1700,G=w.on("postcompose",({frameState:W})=>{let P=W.time-L,j=ol.easing.easeOut(P/D);w.setStyle(new ol.style.Style({image:new ol.style.Circle({radius:40*j,fill:new ol.style.Fill({color:[225,227,228,.1]}),stroke:new ol.style.Stroke({color:[225,227,228,1],width:1.85*(1-j)})})})),P>D&&(_.removeLayer(w),ol.Observable.unByKey(G))});_.addLayer(w)});let m,v=!1;new Vue().$watch(()=>[this.getCurrentToggledMapControl(),qi.getPlugin("editing")&&qi.getPlugin("editing").getActiveTool()],([b,w])=>{m=b,v=!b&&!w,_.getViewport().classList.toggle("ol-grab",v),_.getInteractions().getArray().find(L=>L instanceof ol.interaction.DoubleClickZoom).setActive(v)}),_.on(["pointerdrag","pointerup"],b=>{_.getViewport().classList.toggle("ol-grabbing",b.type=="pointerdrag"&&(!m||!(m.getInteraction()instanceof ol.interaction.DragBox))),_.getViewport().classList.toggle("ol-grab",b.type=="pointerup"&&v)});let x;a?await this.zoomToFid(a):u?await this.zoomToFeaturesUrl(u):!isNaN(h.lat)&&!isNaN(h.lon)?x=new ol.geom.Point(ol.proj.transform([h.lon,h.lat],"EPSG:4326",this.getEpsg())):!isNaN(h.x)&&!isNaN(h.y)&&(x=new ol.geom.Point([h.x,h.y])),x&&x.getExtent()&&await this.zoomToGeometry(x),o===1&&this.defaultsLayers.mapcenter.getSource().addFeature(new ol.Feature({geometry:new ol.geom.Point(this.getCenter())})),l==="map"&&(this.config.mapcontrols={}),wt.maxZoom=Math.min(Ks(this.getMap().getView().getResolutionForExtent(this.project.state.initextent,this.getMap().getSize()),this.getMapUnits()),wt.maxZoom),this.state.size=this.viewer.map.getSize(),this.state.mapUnits=this.viewer.map.getView().getProjection().getUnits(),this.config.background_color&&$("#"+this.target).css("background-color",this.config.background_color),$(this.viewer.map.getViewport()).prepend('<div id="map-spinner" style="position:absolute; top: 50%; right: 50%; z-index: 1;"></div>'),this.viewer.map.getInteractions().forEach(b=>this._watchInteraction(b)),this.viewer.map.getInteractions().on("add",b=>this._watchInteraction(b.element)),this._marker=new ol.Overlay({position:null,positioning:"center-center",element:document.getElementById("marker"),stopEvent:!1}),this.viewer.map.addOverlay(this._marker),this.viewer.map.getLayers().on("add",b=>{let w=this.setLayerZIndex({layer:b.element,zindex:b.element.get("basemap")||b.element.get("position")==="bottom"?0:void 0});this.defaultsLayers.mapcenter&&this.defaultsLayers.mapcenter.getZIndex()<w&&this.defaultsLayers.mapcenter.setZIndex(w+1),this.defaultsLayers.highlightLayer&&this.defaultsLayers.highlightLayer.getZIndex()<w&&this.defaultsLayers.highlightLayer.setZIndex(w+1),this.defaultsLayers.selectionLayer&&this.defaultsLayers.selectionLayer.getZIndex()<w&&this.defaultsLayers.selectionLayer.setZIndex(w+2)}),this.viewer.map.getLayers().on("remove",b=>{b.element.getZIndex()===this.layersCount&&this.layersCount--}),this.state.bbox=this.getMapBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this._setupAllLayers(),this.setUpMapOlEvents(),wt.layers.getLayersStores().forEach(this._setUpEventsKeysToLayersStore.bind(this)),wt.layers.onafter("addLayersStore",this._setUpEventsKeysToLayersStore.bind(this)),wt.layers.onafter("removeLayersStore",this._removeEventsKeysToLayersStore.bind(this)),this.emit("viewerset"),await this.setupControls(),this.emit("ready")}controlClick(t,n={}){}loadExternalLayer(t){}unloadExternalLayer(t){}_removeEventsKeysToLayersStore(t){let n=t.getId();this._keyEvents.stores[n]&&(this._keyEvents.stores[n].forEach(s=>{Object.entries(s).forEach(([o,l])=>t.un(o,l))}),delete this._keyEvents.stores[n])}_setUpEventsKeysToLayersStore(t){let n=t.getId();this._keyEvents.stores[n]=[],t.getLayers().forEach(s=>s.getType()==="vector"&&this.addLayerToMap(s.getMapLayer())),this._keyEvents.stores[n].push({addLayer:t.onafter("addLayer",s=>{s.getType()==="vector"&&this.addLayerToMap(s.getMapLayer())})}),this._keyEvents.stores[n].push({removeLayer:t.onafter("removeLayer",s=>{s.getType()==="vector"&&this.viewer.map.removeLayer(s.getOLLayer())})})}_setupAllLayers(){let t=Zi({BASELAYER:!0});t.forEach(u=>{let h=u.getMapLayer();this.registerMapLayerListeners(h),this._layers.base[u.getId()]=h}),Object.values(t.length?this._layers.base:{}).reverse().forEach(u=>{u.update(this.state,this.layersExtraParams),this.addLayerToMap(u)});let n=Zi({BASELAYER:!1,VECTORLAYER:!1}),s={},o=[];Object.entries(yl(n,u=>{let h=u.getMultiLayerId();return u.isQtimeseries()?(s[h]=s[h]===void 0?0:s[h]+1,`${h}_${s[h]}`):s[h]===void 0?h:`${h}_${s[h]+1}`})).forEach(([u,h])=>{let p=h[0]||[],d=p.getMapLayer({id:`layer_${u}`,projection:this.getProjection(),format:p.getFormat()},this.layersExtraParams);h.reverse().forEach(_=>d.addLayer(_)),o.push(d),this.registerMapLayerListeners(d)}),o.reverse().forEach(u=>{this._layers.g3w.push(u),this.addLayerToMap(u)}),this.updateMapLayers(),Zi({VECTORLAYER:!0}).forEach(u=>this.addLayerToMap(u.getMapLayer()));let a=this.getMap();a.addLayer(this.defaultsLayers.mapcenter),a.addLayer(this.defaultsLayers.selectionLayer),a.addLayer(this.defaultsLayers.highlightLayer),yu.default.getItem("externalLayers").then(u=>{Object.entries(u||{}).forEach(([h,p])=>{let d=new ol.layer.Vector({source:new ol.source.Vector({features:new ol.format.GeoJSON().readFeatures(p.features)})});d.set("name",h),this.addExternalLayer(d,{...p.options,zoomToExtent:!1})})})}removeLayers(){Object.keys(this._layers.base).forEach(t=>this.viewer.map.removeLayer(this._layers.base[t].getOLLayer())),this.getMapLayers().forEach(t=>{this.unregisterMapLayerListeners(t),this.viewer.map.removeLayer(t.getOLLayer())}),this._layers.g3w=[],this._layers.external.forEach(t=>{this.removeExternalLayer(t.get("name"))}),this._layers.external.splice(0),this.defaultsLayers.mapcenter.getSource().clear(),this.defaultsLayers.highlightLayer.getSource().clear(),this.defaultsLayers.selectionLayer.getSource().clear(),this.getMap().removeLayer(this.defaultsLayers.mapcenter),this.getMap().removeLayer(this.defaultsLayers.highlightLayer),this.getMap().removeLayer(this.defaultsLayers.selectionLayer)}setLayerZIndex({layer:t,zindex:n=this.layersCount+=1}){return n=n+(t.get("__g3w_editable")?1e3:0),t.setZIndex(n),this.emit("set-layer-zindex",{layer:t,zindex:n}),n}addLayerToMap(t){let n=t.getOLLayer();n&&this.getMap().addLayer(n)}createMapLayer(t){let n=t.getMapLayer({id:`layer_${t.getMultiLayerId()}`,projection:this.getProjection()},this.layersExtraParams);return n.addLayer(t),n}updateMapLayer(t,n={force:!1},{showSpinner:s=!0}={}){return n.force&&(n.g3w_time=Date.now()),s!==t.showSpinnerWhenLoading&&(t.showSpinnerWhenLoading=s,s?(t.on("loadstart",this.onLayerLoadStart),t.on("loadend",this.onLayerLoadEnd),t.on("loaderror",this.onLayerLoadError)):(t.off("loadstart",this.onLayerLoadStart),t.off("loadend",this.onLayerLoadEnd),t.off("loaderror",this.onLayerLoadError))),t.update(this.state,n),t}updateMapLayers(t={}){this.getMapLayers().forEach(n=>this.updateMapLayer(n,t)),Object.values(this.getBaseLayers()).forEach(n=>n.update(this.state,this.layersExtraParams))}registerMapLayerListeners(t,n=!0){t.on("loadstart",this.onLayerLoadStart),t.on("loadend",this.onLayerLoadEnd),t.on("loaderror",this.onLayerLoadError),n&&(Array.isArray(t.layers)?t.layers:[]).forEach(s=>{s.onbefore("change",()=>this.updateMapLayer(t,{force:!0})),s.on("filtertokenchange",({layerId:o})=>{this.updateMapLayer(t,{force:!0,layerId:o})})})}unregisterMapLayerListeners(t,n=!1){t.un("loadstart",this.onLayerLoadStart),t.un("loadend",this.onLayerLoadEnd),t.un("loaderror",this.onLayerLoadError),n&&(Array.isArray(t.layers)?t.layers:[]).forEach(s=>{s.un("change"),s.removeEvent("filtertokenchange")})}setTarget(t){this.target=t}getCurrentToggledMapControl(){return(this._controls.find(t=>t.control&&t.control.isToggled&&t.control.isToggled())||{}).control}addInteraction(t,n={active:!0,close:!0}){let{active:s=!0}=n,o=this.getCurrentToggledMapControl(),l=o&&o.isToggled&&o.isToggled()||!1;return(o&&o.isClickMap?o.isClickMap():!0)&&s&&this._unToggleControls(n),this.getMap().addInteraction(t),t.setActive(s),this._externalInteractions.push(t),{control:o,toggled:l}}removeInteraction(t){t&&t.setActive(!1),this.viewer.map.removeInteraction(t),this._externalInteractions=this._externalInteractions.filter(n=>t!==n)}_watchInteraction(t){t.on("change:active",n=>{n.target instanceof ol.interaction.Pointer&&n.target.getActive()&&this.emit("mapcontrol:active",n.target)})}showMapInfo({info:t,style:n}={}){this.state.map_info.info=t,this.state.map_info.style=n||this.state.map_info.style}zoomTo(t,n=6){let s=this.viewer.map.getView();s.setCenter(t),s.setZoom(n)}goTo(t,n,s=!0){let o=this.viewer.map.getView();n=n||6,s?o.animate({duration:300,center:t},n?{zoom:n,duration:300}:{duration:300,resolution:o.getResolution()}):o.setCenter(t),n&&!s&&o.setZoom(n)}async goToRes(t,n,s=!0){n=n||this.viewer.map.getView().getResolution(),await new Promise(o=>{this.viewer.map.getView().once("change:center",()=>setTimeout(o,500)),s?this.viewer.map.getView().animate({duration:200,center:t},{duration:200,resolution:n}):(this.viewer.map.getView().setCenter(t),this.viewer.map.getView().setResolution(n))})}getGeometryAndExtentFromFeatures(t=[]){let n,s,o,l=[];if(t.filter(a=>a.getGeometry?a.getGeometry():a.geometry).forEach(a=>{let u=a.getGeometry?a.getGeometry():a.geometry,h=u instanceof ol.geom.Geometry,p=h?[...u.getExtent()]:a.bbox;n=ol.extent.extend(n===void 0?p:n,p),s=s||(h?u.getType():u.type);let d=h?u.getCoordinates():u.coordinates;l.push(d)}),l.length>0){let a=s.includes("Multi");try{o=new ol.geom[a?s:`Multi${s}`](a?l.flat():l),n=n===void 0?o.getExtent():n}catch(u){console.warn(u)}}return{extent:n,geometry:o}}highlightFeatures(t,n={}){let{geometry:s}=this.getGeometryAndExtentFromFeatures(t);n.zoom=!1,this.highlightGeometry(s,n)}zoomToGeometry(t,n={highlight:!1}){let s=t&&t.getExtent();return n.highlight&&s&&(n.highLightGeometry=t),this.zoomToExtent(s,n)}zoomToFeatures(t,n={highlight:!1}){let{geometry:s,extent:o}=this.getGeometryAndExtentFromFeatures(t);return n.highlight&&o&&(n.highLightGeometry=s),this.zoomToExtent(o,n)}async zoomToExtent(t,n={}){if(!t)return Promise.resolve();let s=this.getMap(),o;if(ol.extent.containsExtent(this.project.state.extent,t)===!1)o=s.getView().getResolutionForExtent(this.project.state.extent,s.getSize());else if(n.force===!0)o=s.getView().getResolutionForExtent(t,s.getSize());else{let l=s.getView().getResolution();o=Math.max(s.getView().getResolutionForExtent(t,s.getSize()),ba(wt.maxZoom,this.getMapUnits())),o=l<o&&l>o?l:o}await this.goToRes(ol.extent.getCenter(t),o),n.highLightGeometry&&await this.highlightGeometry(n.highLightGeometry,{zoom:!1,duration:n.duration})}goToBBox(t,n=this.getEpsg()){t=n===this.getEpsg()?t:ol.proj.transformExtent(t,n,this.getEpsg()),this.viewer.fit(ol.extent.containsExtent(this.project.state.extent,t)?t:this.project.state.extent)}_fit(t,n={}){let s=this.viewer.map.getView();(typeof n.animate=="boolean"?n.animate:!0)&&(s.animate({duration:200,center:s.getCenter()}),s.animate({duration:200,resolution:s.getResolution()})),delete n.animate,s.fit(t,{...n,constrainResolution:n.constrainResolution!==void 0?n.constrainResolution:!0,size:this.viewer.map.getSize()})}setSelectionFeatures(t="add",n={}){n.color&&(this.defaultsLayers._style.selectionLayer={color:n.color});let s=this.defaultsLayers.selectionLayer.getSource();switch(t){case"add":n.feature.setStyle(Wa({geometryType:n.feature.getGeometry().getType(),color:this.defaultsLayers._style.selectionLayer.color,fill:!0})),s.addFeature(n.feature);break;case"remove":s.removeFeature(n.feature);break;case"update":s.getFeatureById(n.feature.getId()).setGeometry(n.feature.getGeometry());break;case"clear":s.clear();break}}toggleSelection(t=!0,n){let s=this.defaultsLayers.selectionLayer;n?s.getSource().getFeatures().filter(o=>n===o.__layerId).forEach(o=>o.setStyle(t?Wa({geometryType:o.getGeometry().getType(),color:this.defaultsLayers._style.selectionLayer.color,fill:!0}):new ol.style.Style(null))):s.setVisible(t)}async highlightGeometry(t,n={}){let s=n.duration||2e3,o=this.defaultsLayers.highlightLayer,l=typeof n.hide=="function"?n.hide:null,a=typeof n.highlight=="boolean"?n.highlight:!0,u=typeof n.zoom=="boolean"?n.zoom:!0,h=t instanceof ol.geom.Geometry?t:new ol.format.GeoJSON().readGeometry(t);if(this.clearHighlightGeometry(),this.defaultsLayers._style.highlightLayer={color:n.color},u&&await this.zoomToExtent(h.getExtent()),!!a)return n.style&&o.setStyle(n.style),o.getSource().addFeature(new ol.Feature({geometry:h})),new Promise(async p=>{let d=()=>{o.getSource().clear(),n.style&&o.setStyle(_=>[Wa({geometryType:_.getGeometry().getType(),color:n.color,fill:!0})]),l||(wt.animatingHighlight=!1),p()};l&&l(d),s&&s!==1/0&&!l&&(wt.animatingHighlight=!0,setTimeout(d,s))})}clearHighlightGeometry(){wt.animatingHighlight||this.defaultsLayers.highlightLayer.getSource().clear(),this.defaultsLayers._style.highlightLayer={color:void 0}}refreshMap(t={force:!0}){this.updateMapLayers(t)}layout({width:t,height:n}){let s=document.getElementById(this.target);s&&(s.style.height=n+"px",s.style.width=t+"px");let o=t<=0||n<=0,l=!!this.viewer;l&&!o&&(this.getMap().updateSize(),this.state.hidemaps.forEach(a=>a.map.updateSize()),this.state.bbox=this.getMapBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this.updateMapLayers()),l||this.setupViewer(t,n),this.setHidden(o)}getMapBBOX(){return this.viewer.map.getView().calculateExtent(this.viewer.map.getSize())}setInnerGreyCoverBBox(t={}){let n=this.viewer.map,s,o;if(t.inner){switch(t.type){case"pixel":s=[t.inner[0],t.inner[1]],o=[t.inner[2],t.inner[3]];break;case"coordinate":default:s=n.getPixelFromCoordinate([t.inner[0],t.inner[1]]),o=n.getPixelFromCoordinate([t.inner[2],t.inner[3]]);break}this._drawShadow.inner[0]=s[0]*ol.has.DEVICE_PIXEL_RATIO,this._drawShadow.inner[1]=s[1]*ol.has.DEVICE_PIXEL_RATIO,this._drawShadow.inner[2]=o[0]*ol.has.DEVICE_PIXEL_RATIO,this._drawShadow.inner[3]=o[1]*ol.has.DEVICE_PIXEL_RATIO}this._drawShadow.scale=[null,void 0].includes(t.scale)?this._drawShadow.scale||1:t.scale,this._drawShadow.rotation=[null,void 0].includes(t.rotation)?this._drawShadow.rotation||0:t.rotation,this._drawShadow.outer&&n.render()}startDrawGreyCover(t){let n=this.viewer.map,s,o,l,a,u,h;this.stopDrawGreyCover(),this._drawShadow.listener=n.on("postcompose",p=>{let d=this.getMap().getViewport().querySelector("canvas").getContext("2d"),_=this.getMap().getSize(),m=_[1]*ol.has.DEVICE_PIXEL_RATIO,v=_[0]*ol.has.DEVICE_PIXEL_RATIO;this._drawShadow.outer=[0,0,v,m],d.restore(),d.beginPath(),d.moveTo(0,0),d.lineTo(v,0),d.lineTo(v,m),d.lineTo(0,m),d.lineTo(0,0),d.closePath(),this._drawShadow.inner.length&&(d.save(),s=this._drawShadow.inner[0],l=this._drawShadow.inner[3],o=this._drawShadow.inner[2],a=this._drawShadow.inner[1],u=this._drawShadow.rotation,h=this._drawShadow.scale,d.translate((o+s)/2,(a+l)/2),d.rotate(u*Math.PI/180),d.moveTo(-((o-s)/2),(a-l)/2),d.lineTo((o-s)/2,(a-l)/2),d.lineTo((o-s)/2,-((a-l)/2)),d.lineTo(-((o-s)/2),-((a-l)/2)),d.lineTo(-((o-s)/2),(a-l)/2),d.closePath()),d.fillStyle="rgba(0, 5, 25, 0.40)",d.fill(),t&&(d.font="bold 25px Arial",d.fillStyle="#ffffff",d.textAlign="center",t.split(`
`).forEach((x,b)=>d.fillText(x,v/2,m/2+30*b))),d.restore()})}stopDrawGreyCover(){this._drawShadow.listener&&(ol.Observable.unByKey(this._drawShadow.listener),this._drawShadow.inner.length&&(this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null}),this._drawShadow.listener=null),this.getMap().render()}removeExternalLayer(t){let n=this.getLayerByName(t),s=n._type||"vector";if(T.getService("queryresults").unregisterVectorLayer(n),T.getService("catalog").removeExternalLayer({name:t,type:s}),this.viewer.map.removeLayer(n),s==="vector"){let o=n.get("id");this.defaultsLayers.selectionLayer.getSource().getFeatures().filter(l=>o===l.__layerId).forEach(l=>this.defaultsLayers.selectionLayer.getSource().removeFeature(l))}s==="vector"&&(this._keyEvents.unwatches[t].forEach(o=>o()),delete this._keyEvents.unwatches[t]),s==="vector"&&yu.default.getItem("externalLayers").then(o=>{o=o||{},t in o&&delete o[t],yu.default.setItem("externalLayers",o)}),s==="vector"&&(this._layers.external_vector=this._layers.external_vector.filter(o=>{if(t!==o.name)return!0;Object.values(wt.controls).forEach(l=>l.onRemoveExternalLayer&&l.onRemoveExternalLayer(o)),o===wt.selectedLayer&&(wt.selectedLayer=null)})),s==="wms"&&(this._layers.external_wms=this._layers.external_wms.filter(o=>{if(o.getId()!==n.id)return!0;this.unregisterMapLayerListeners(o,n.projectLayer)})),this._layers.external=this._layers.external.filter(o=>o.get("id")!==n.get("id")),this.unloadExternalLayer(n),this.emit("remove-external-layer",t)}getLegacyExternalLayers(){return this._layers.external_vector}getExternalLayers(t){return t===void 0?this._layers.external:this._layers.external.filter(n=>t===n._type)}async addExternalLayer(t,n={}){let s=t,o=t.getOLLayer?t.getOLLayer():t;o!==t&&(o.set("id",t.getId()),o.set("name",t.getId())),t=o;let l;if(n.position=n.position===void 0?"top":n.position,n.opacity=n.opacity===void 0?1:n.opacity,n.visible=n.visible===void 0||n.visible,n.persistent=n.persistent===void 0||n.persistent,t instanceof ol.layer.Vector){t.set("id",t.get("id")||Qe()),l=t,l.filter={active:!1},l.selection={active:!1,features:[]},n.color&&l.setStyle(Object.assign(_=>{n.color=n.color.rgba?"rgba("+[n.color.rgba.r,n.color.rgba.g,n.color.rgba.b,n.color.rgba.a].join()+")":n.color;let m=_.getGeometry().getType(),{color:v}=n,x;return Wl(m)?x=new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:v}),stroke:new ol.style.Stroke({color:v,width:1}),radius:5})}):qo(m)?x=new ol.style.Style({stroke:new ol.style.Stroke({color:v,width:3})}):$o(m)?x=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:v,width:3})}):console.warn("invalid geometry type: ",m),n.field&&x.setText(new ol.style.Text({text:`${_.get(n.field)}`,font:"bold",scale:2,offsetY:15,fill:new ol.style.Fill({color:n.color}),stroke:new ol.style.Stroke({color:"#FFF",width:2})})),x},{_g3w_options:n}));let d;try{let _=t.getStyle();d=_._g3w_options?_._g3w_options.color:"blue"}catch(_){console.warn(_)}t={id:t.get("id"),name:l.get("name")||l.get("id"),projectLayer:!1,title:l.get("name")||l.get("id"),removable:!0,external:!0,crs:n.crs,type:n.type,_type:"vector",visible:n.visible,checked:!0,position:n.position,opacity:n.opacity,color:d||"blue",filter:l.filter,selection:l.selection,tochighlightable:!1,download:n.download||!1,downloadUrl:n.downloadUrl}}t instanceof ol.layer.Image&&(t.id=t.get("id"),t.removable=!0,t.projectLayer=!1,t.name=t.get("name"),t.title=t.get("name"),t._type="wms",t.opacity=n.opacity,t.position=n.position,t.external=!0,t.checked=n.visible),this.getLayerByName(t.name)&&T.notify.warning("Layer with same name already added",!1);let a=(t._type||t.type||"").toLowerCase().trim("").trim(),u={vector:l,wms:t}[a];if(!u)return console.warn("layer type: ",a,t),Promise.reject("not a valid layer");let h=a==="vector"&&u.getSource().getFeatures()||[],p=a==="vector"&&u.getSource().getExtent()||[];return h.forEach((d,_)=>d.setId(`${t.id}_${_}`)),h.length&&(t.geometryType=h[0].getGeometry().getType(),t.selected=!1),p.length&&(t.bbox={minx:p[0],miny:p[1],maxx:p[2],maxy:p[3]}),u.set("position",n.position),u.setOpacity(n.opacity),u.setVisible(n.visible),t.set=t.set||((d,_)=>t[d]=_),t.get=t.get||(d=>t[d]),t.getId=t.getId||(()=>t.id),t.getName=t.getName||(()=>t.name),t.getGeometryType=t.getGeometryType||(()=>t.geometryType),t.setTocHighlightable=t.setTocHighlightable||(d=>t.tochighlightable=d),t.getTocHighlightable=t.getTocHighlightable||(()=>t.tochighlightable),t.isSelected=t.isSelected||(()=>t.selected),t.setSelected=t.setSelected||(d=>t.selected=d),t.isQueryable=t.isQueryable||(()=>!!l),t.isVisible=t.isVisible||(()=>(l&&(t.visible=l.getVisible()),t.visible)),t.setVisible=t.setVisible||(d=>{l&&l.setVisible(d),t.visible=d}),this.viewer.map.addLayer(u),this._layers.external.push(u),a==="vector"&&this._layers.external_vector.push(t),a==="wms"&&(this._layers.external_wms.push(t),this.registerMapLayerListeners(s,!1)),l&&n.persistent!==!1&&yu.default.getItem("externalLayers").then(d=>{yu.default.setItem("externalLayers",{...d||{},[l.get("name")]:{features:new ol.format.GeoJSON().writeFeatures(l.getSource().getFeatures()),options:n}})}),T.getService("catalog").addExternalLayer({layer:t,type:a}),a==="vector"&&(T.getService("queryresults").registerVectorLayer(u),this._keyEvents.unwatches[t.name]=[],Object.values(wt.controls).forEach(d=>d.onAddExternalLayer&&d.onAddExternalLayer({layer:t,unWatches:this._keyEvents.unwatches[t.name]}))),p&&n.zoomToExtent&&this.viewer.map.getView().fit(p),this.loadExternalLayer(u),u}getCookie(t){Vue.cookie.get(t)}selectLayer(t){let n=typeof t=="string"?t:t&&t.getId();wt.selectedLayer&&n===wt.selectedLayer.getId()&&(n=null),t=De(n)||this.getLegacyExternalLayers().find(s=>n===s.getId()),_u().concat(this.getLegacyExternalLayers()).forEach(s=>s.setSelected(s.getId()===n)),wt.selectedLayer=t&&t.isSelected()?t:null,Object.values(wt.controls).forEach(s=>s.onSelectLayer&&s.onSelectLayer(wt.selectedLayer))}getSelectedLayer(){return wt.selectedLayer}};Mn.onbefore("offline",()=>wt.offlineids.forEach(e=>{e.enable=wt.controls[e.id].getEnable(),wt.controls[e.id].setEnable(!1)}));Mn.onbefore("online",()=>wt.offlineids.forEach(({id:e,enable:t})=>wt.controls[e].setEnable(t)));El=wt.layers,cee={MapService:J1,MapLayersStoresRegistry:El}});function Zi(e={},t={}){let{MapLayersStoresRegistry:n}=(gu(),kn(s_)).default;return n.getQuerableLayersStores().flatMap(s=>s.getLayers({GEOLAYER:!0,...e||{}},t))}var lu=R(()=>{});var Uh=R(()=>{(function(e,t){typeof exports=="object"&&typeof module<"u"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t((e=typeof globalThis<"u"?globalThis:e||self).jsts={})})(void 0,function(e){"use strict";class t{static equalsWithTolerance(i,r,c){return Math.abs(i-r)<=c}}class n extends Error{constructor(i){super(i),this.name=Object.keys({Exception:n})[0]}toString(){return this.message}}class s extends n{constructor(i){super(i),this.name=Object.keys({IllegalArgumentException:s})[0]}}class o{constructor(i,r){this.low=r||0,this.high=i||0}static toBinaryString(i){let r,c="";for(r=2147483648;r>0;r>>>=1)c+=(i.high&r)===r?"1":"0";for(r=2147483648;r>0;r>>>=1)c+=(i.low&r)===r?"1":"0";return c}}function l(){}function a(){}function u(){}l.NaN=NaN,l.isNaN=A=>Number.isNaN(A),l.isInfinite=A=>!Number.isFinite(A),l.MAX_VALUE=Number.MAX_VALUE,l.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,l.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?function(){let i=new Float64Array(1),r=new Int32Array(i.buffer);l.doubleToLongBits=function(c){i[0]=c;let f=0|r[0],g=0|r[1];return(g&2146435072)===2146435072&&1048575&g&&f!==0&&(f=0,g=2146959360),new o(g,f)},l.longBitsToDouble=function(c){return r[0]=c.low,r[1]=c.high,i[0]}}():function(){let i=Math.log2,r=Math.floor,c=Math.pow,f=function(){for(let g=53;g>0;g--){let y=c(2,g)-1;if(r(i(y))+1===g)return y}return 0}();l.doubleToLongBits=function(g){let y,S,I,z,ne,he,Ie,Oe,Ue;if(g<0||1/g===Number.NEGATIVE_INFINITY?(he=1<<31,g=-g):he=0,g===0)return Ue=0,Oe=he,new o(Oe,Ue);if(g===1/0)return Ue=0,Oe=2146435072|he,new o(Oe,Ue);if(g!=g)return Ue=0,Oe=2146959360,new o(Oe,Ue);if(z=0,Ue=0,y=r(g),y>1)if(y<=f)z=r(i(y)),z<=20?(Ue=0,Oe=y<<20-z&1048575):(I=z-20,S=c(2,I),Ue=y%S<<32-I,Oe=y/S&1048575);else for(I=y,Ue=0;S=I/2,I=r(S),I!==0;)z++,Ue>>>=1,Ue|=(1&Oe)<<31,Oe>>>=1,S!==I&&(Oe|=524288);if(Ie=z+1023,ne=y===0,y=g-y,z<52&&y!==0)for(I=0;;){if(S=2*y,S>=1?(y=S-1,ne?(Ie--,ne=!1):(I<<=1,I|=1,z++)):(y=S,ne?--Ie==0&&(z++,ne=!1):(I<<=1,z++)),z===20)Oe|=I,I=0;else if(z===52){Ue|=I;break}if(S===1){z<20?Oe|=I<<20-z:z<52&&(Ue|=I<<52-z);break}}return Oe|=Ie<<20,Oe|=he,new o(Oe,Ue)},l.longBitsToDouble=function(g){let y,S,I,z,ne=g.high,he=g.low,Ie=ne&1<<31?-1:1;for(I=((2146435072&ne)>>20)-1023,z=0,S=1<<19,y=1;y<=20;y++)ne&S&&(z+=c(2,-y)),S>>>=1;for(S=1<<31,y=21;y<=52;y++)he&S&&(z+=c(2,-y)),S>>>=1;if(I===-1023){if(z===0)return 0*Ie;I=-1022}else{if(I===1024)return z===0?Ie/0:NaN;z+=1}return Ie*z*c(2,I)}}();class h extends n{constructor(i){super(i),this.name=Object.keys({RuntimeException:h})[0]}}class p extends h{constructor(){super(),p.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)h.constructor_.call(this);else if(arguments.length===1){let i=arguments[0];h.constructor_.call(this,i)}}}class d{static isTrue(){if(arguments.length===1){let i=arguments[0];d.isTrue(i,null)}else if(arguments.length===2){let i=arguments[1];if(!arguments[0])throw i===null?new p:new p(i)}}static shouldNeverReachHere(){if(arguments.length===0)d.shouldNeverReachHere(null);else if(arguments.length===1){let i=arguments[0];throw new p("Should never reach here"+(i!==null?": "+i:""))}}static equals(){if(arguments.length===2){let i=arguments[0],r=arguments[1];d.equals(i,r,null)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(!r.equals(i))throw new p("Expected "+i+" but encountered "+r+(c!==null?": "+c:""))}}}function _(){}function m(){}let v=new ArrayBuffer(8),x=new Float64Array(v),b=new Int32Array(v);class w{constructor(){w.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)w.constructor_.call(this,0,0);else if(arguments.length===1){let i=arguments[0];w.constructor_.call(this,i.x,i.y,i.getZ())}else if(arguments.length===2){let i=arguments[0],r=arguments[1];w.constructor_.call(this,i,r,w.NULL_ORDINATE)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this.x=i,this.y=r,this.z=c}}static hashCode(i){return x[0]=i,b[0]^b[1]}equals2D(){if(arguments.length===1){let i=arguments[0];return this.x===i.x&&this.y===i.y}if(arguments.length===2){let i=arguments[0],r=arguments[1];return!!t.equalsWithTolerance(this.x,i.x,r)&&!!t.equalsWithTolerance(this.y,i.y,r)}}setM(i){throw new s("Invalid ordinate index: "+w.M)}equals3D(i){return this.x===i.x&&this.y===i.y&&(this.getZ()===i.getZ()||l.isNaN(this.getZ())&&l.isNaN(i.getZ()))}setX(i){this.x=i}compareTo(i){let r=i;return this.x<r.x?-1:this.x>r.x?1:this.y<r.y?-1:this.y>r.y?1:0}getX(){return this.x}copy(){return new w(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(i){let r=this.x-i.x,c=this.y-i.y,f=this.getZ()-i.getZ();return Math.sqrt(r*r+c*c+f*f)}getY(){return this.y}getM(){return l.NaN}setOrdinate(i,r){switch(i){case w.X:this.x=r;break;case w.Y:this.y=r;break;case w.Z:this.setZ(r);break;default:throw new s("Invalid ordinate index: "+i)}}getZ(){return this.z}getOrdinate(i){switch(i){case w.X:return this.x;case w.Y:return this.y;case w.Z:return this.getZ()}throw new s("Invalid ordinate index: "+i)}equals(i){return i instanceof w&&this.equals2D(i)}equalInZ(i,r){return t.equalsWithTolerance(this.getZ(),i.getZ(),r)}setZ(i){this.z=i}clone(){try{return null}catch(i){if(i instanceof CloneNotSupportedException)return d.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw i}}setY(i){this.y=i}distance(i){let r=this.x-i.x,c=this.y-i.y;return Math.sqrt(r*r+c*c)}hashCode(){let i=17;return i=37*i+w.hashCode(this.x),i=37*i+w.hashCode(this.y),i}setCoordinate(i){this.x=i.x,this.y=i.y,this.z=i.getZ()}get interfaces_(){return[a,_,u]}}class L{constructor(){L.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,arguments.length===0)L.constructor_.call(this,2);else if(arguments.length===1){let i=arguments[0];if(i!==2&&i!==3)throw new s("only 2 or 3 dimensions may be specified");this._dimensionsToTest=i}}static compare(i,r){return i<r?-1:i>r?1:l.isNaN(i)?l.isNaN(r)?0:-1:l.isNaN(r)?1:0}compare(i,r){let c=L.compare(i.x,r.x);if(c!==0)return c;let f=L.compare(i.y,r.y);return f!==0?f:this._dimensionsToTest<=2?0:L.compare(i.getZ(),r.getZ())}get interfaces_(){return[m]}}w.DimensionalComparator=L,w.NULL_ORDINATE=l.NaN,w.X=0,w.Y=1,w.Z=2,w.M=3;class D extends w{constructor(){super(),D.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)w.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof D){let i=arguments[0];w.constructor_.call(this,i.x,i.y)}else if(arguments[0]instanceof w){let i=arguments[0];w.constructor_.call(this,i.x,i.y)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];w.constructor_.call(this,i,r,w.NULL_ORDINATE)}}setOrdinate(i,r){switch(i){case D.X:this.x=r;break;case D.Y:this.y=r;break;default:throw new s("Invalid ordinate index: "+i)}}setZ(i){throw new s("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new D(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(i){this.x=i.x,this.y=i.y,this.z=i.getZ()}getZ(){return w.NULL_ORDINATE}getOrdinate(i){switch(i){case D.X:return this.x;case D.Y:return this.y}throw new s("Invalid ordinate index: "+i)}}D.X=0,D.Y=1,D.Z=-1,D.M=-1;class G extends w{constructor(){super(),G.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)w.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof G){let i=arguments[0];w.constructor_.call(this,i.x,i.y),this._m=i._m}else if(arguments[0]instanceof w){let i=arguments[0];w.constructor_.call(this,i.x,i.y),this._m=this.getM()}}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];w.constructor_.call(this,i,r,w.NULL_ORDINATE),this._m=c}}setM(i){this._m=i}setZ(i){throw new s("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new G(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(i){this.x=i.x,this.y=i.y,this.z=i.getZ(),this._m=i.getM()}getM(){return this._m}setOrdinate(i,r){switch(i){case G.X:this.x=r;break;case G.Y:this.y=r;break;case G.M:this._m=r;break;default:throw new s("Invalid ordinate index: "+i)}}getZ(){return w.NULL_ORDINATE}getOrdinate(i){switch(i){case G.X:return this.x;case G.Y:return this.y;case G.M:return this._m}throw new s("Invalid ordinate index: "+i)}}G.X=0,G.Y=1,G.Z=-1,G.M=2;class W extends w{constructor(){super(),W.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)w.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof W){let i=arguments[0];w.constructor_.call(this,i),this._m=i._m}else if(arguments[0]instanceof w){let i=arguments[0];w.constructor_.call(this,i),this._m=this.getM()}}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];w.constructor_.call(this,i,r,c),this._m=f}}setM(i){this._m=i}getOrdinate(i){switch(i){case w.X:return this.x;case w.Y:return this.y;case w.Z:return this.getZ();case w.M:return this.getM()}throw new s("Invalid ordinate index: "+i)}copy(){return new W(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(i){this.x=i.x,this.y=i.y,this.z=i.getZ(),this._m=i.getM()}getM(){return this._m}setOrdinate(i,r){switch(i){case w.X:this.x=r;break;case w.Y:this.y=r;break;case w.Z:this.z=r;break;case w.M:this._m=r;break;default:throw new s("Invalid ordinate index: "+i)}}}function P(A,i){return A.interfaces_&&A.interfaces_.indexOf(i)>-1}class j{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class V extends n{constructor(i){super(i),this.name=Object.keys({IndexOutOfBoundsException:V})[0]}}class H extends j{get(){}set(){}isEmpty(){}}class se extends n{constructor(i){super(i),this.name=Object.keys({NoSuchElementException:se})[0]}}class M extends H{constructor(i){super(),this.array=[],i instanceof j&&this.addAll(i)}get interfaces_(){return[H,j]}ensureCapacity(){}add(i){return arguments.length===1?this.array.push(i):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(i){for(let r of i)this.array.push(r)}set(i,r){let c=this.array[i];return this.array[i]=r,c}iterator(){return new ie(this)}get(i){if(i<0||i>=this.size())throw new V;return this.array[i]}isEmpty(){return this.array.length===0}sort(i){i?this.array.sort((r,c)=>i.compare(r,c)):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(i){for(let r=0,c=this.array.length;r<c;r++)if(this.array[r]===i)return!!this.array.splice(r,1);return!1}[Symbol.iterator](){return this.array.values()}}let ie=class{constructor(A){this.arrayList=A,this.position=0}next(){if(this.position===this.arrayList.size())throw new se;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(A){return this.arrayList.set(this.position-1,A)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}};class E extends M{constructor(){super(),E.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length!==0){if(arguments.length===1){let i=arguments[0];this.ensureCapacity(i.length),this.add(i,!0)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.ensureCapacity(i.length),this.add(i,r)}}}getCoordinate(i){return this.get(i)}addAll(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&P(arguments[0],j)){let i=arguments[1],r=!1;for(let c=arguments[0].iterator();c.hasNext();)this.add(c.next(),i),r=!0;return r}return super.addAll.apply(this,arguments)}clone(){let i=super.clone.call(this);for(let r=0;r<this.size();r++)i.add(r,this.get(r).clone());return i}closeRing(){if(this.size()>0){let i=this.get(0).copy();this.add(i,!1)}}toCoordinateArray(){if(arguments.length===0)return this.toArray(E.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(E.coordArrayType);let i=this.size(),r=new Array(i).fill(null);for(let c=0;c<i;c++)r[c]=this.get(i-c-1);return r}}add(){if(arguments.length===1){let i=arguments[0];return super.add.call(this,i)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){let i=arguments[0],r=arguments[1];return this.add(i,r,!0),!0}if(arguments[0]instanceof w&&typeof arguments[1]=="boolean"){let i=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(i))return null;super.add.call(this,i)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){let i=arguments[0],r=arguments[1];return this.add(i,r),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){let i=arguments[0],r=arguments[1];if(arguments[2])for(let c=0;c<i.length;c++)this.add(i[c],r);else for(let c=i.length-1;c>=0;c--)this.add(i[c],r);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1];if(!arguments[2]){let c=this.size();if(c>0&&(i>0&&this.get(i-1).equals2D(r)||i<c&&this.get(i).equals2D(r)))return null}super.add.call(this,i,r)}}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=1;c>f&&(g=-1);for(let y=c;y!==f;y+=g)this.add(i[y],r);return!0}}}E.coordArrayType=new Array(0).fill(null);class X{filter(i,r){}isGeometryChanged(){}isDone(){}}class K{constructor(){K.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof w){let i=arguments[0];this.init(i.x,i.x,i.y,i.y)}else if(arguments[0]instanceof K){let i=arguments[0];this.init(i)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this.init(i,r,c,f)}}static intersects(){if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return c.x>=(i.x<r.x?i.x:r.x)&&c.x<=(i.x>r.x?i.x:r.x)&&c.y>=(i.y<r.y?i.y:r.y)&&c.y<=(i.y>r.y?i.y:r.y)}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=Math.min(c.x,f.x),y=Math.max(c.x,f.x),S=Math.min(i.x,r.x),I=Math.max(i.x,r.x);return!(S>y)&&!(I<g)&&(g=Math.min(c.y,f.y),y=Math.max(c.y,f.y),S=Math.min(i.y,r.y),I=Math.max(i.y,r.y),!(S>y)&&!(I<g))}}getArea(){return this.getWidth()*this.getHeight()}getMinX(){return this._minx}expandToInclude(){if(arguments.length===1){if(arguments[0]instanceof w){let i=arguments[0];this.expandToInclude(i.x,i.y)}else if(arguments[0]instanceof K){let i=arguments[0];if(i.isNull())return null;this.isNull()?(this._minx=i.getMinX(),this._maxx=i.getMaxX(),this._miny=i.getMinY(),this._maxy=i.getMaxY()):(i._minx<this._minx&&(this._minx=i._minx),i._maxx>this._maxx&&(this._maxx=i._maxx),i._miny<this._miny&&(this._miny=i._miny),i._maxy>this._maxy&&(this._maxy=i._maxy))}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=r,this._maxy=r):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}}compareTo(i){let r=i;return this.isNull()?r.isNull()?0:-1:r.isNull()?1:this._minx<r._minx?-1:this._minx>r._minx?1:this._miny<r._miny?-1:this._miny>r._miny?1:this._maxx<r._maxx?-1:this._maxx>r._maxx?1:this._maxy<r._maxy?-1:this._maxy>r._maxy?1:0}translate(i,r){if(this.isNull())return null;this.init(this.getMinX()+i,this.getMaxX()+i,this.getMinY()+r,this.getMaxY()+r)}copy(){return new K(this)}expandBy(){if(arguments.length===1){let i=arguments[0];this.expandBy(i,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=i,this._maxx+=i,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(arguments.length===1){if(arguments[0]instanceof K){let i=arguments[0];return this.covers(i)}if(arguments[0]instanceof w){let i=arguments[0];return this.covers(i)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.covers(i,r)}}hashCode(){let i=17;return i=37*i+w.hashCode(this._minx),i=37*i+w.hashCode(this._maxx),i=37*i+w.hashCode(this._miny),i=37*i+w.hashCode(this._maxy),i}equals(i){if(!(i instanceof K))return!1;let r=i;return this.isNull()?r.isNull():this._maxx===r.getMaxX()&&this._maxy===r.getMaxY()&&this._minx===r.getMinX()&&this._miny===r.getMinY()}intersection(i){if(this.isNull()||i.isNull()||!this.intersects(i))return new K;let r=this._minx>i._minx?this._minx:i._minx,c=this._miny>i._miny?this._miny:i._miny,f=this._maxx<i._maxx?this._maxx:i._maxx,g=this._maxy<i._maxy?this._maxy:i._maxy;return new K(r,f,c,g)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(arguments.length===1){if(arguments[0]instanceof w){let i=arguments[0];return this.covers(i.x,i.y)}if(arguments[0]instanceof K){let i=arguments[0];return!this.isNull()&&!i.isNull()&&i.getMinX()>=this._minx&&i.getMaxX()<=this._maxx&&i.getMinY()>=this._miny&&i.getMaxY()<=this._maxy}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];return!this.isNull()&&i>=this._minx&&i<=this._maxx&&r>=this._miny&&r<=this._maxy}}intersects(){if(arguments.length===1){if(arguments[0]instanceof K){let i=arguments[0];return!this.isNull()&&!i.isNull()&&!(i._minx>this._maxx||i._maxx<this._minx||i._miny>this._maxy||i._maxy<this._miny)}if(arguments[0]instanceof w){let i=arguments[0];return this.intersects(i.x,i.y)}}else if(arguments.length===2){if(arguments[0]instanceof w&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1];return this.isNull()||(i.x<r.x?i.x:r.x)>this._maxx||(i.x>r.x?i.x:r.x)<this._minx||(i.y<r.y?i.y:r.y)>this._maxy?!1:!((i.y>r.y?i.y:r.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1];return!this.isNull()&&!(i>this._maxx||i<this._minx||r>this._maxy||r<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;let i=this.getWidth(),r=this.getHeight();return Math.sqrt(i*i+r*r)}minExtent(){if(this.isNull())return 0;let i=this.getWidth(),r=this.getHeight();return i<r?i:r}getWidth(){return this.isNull()?0:this._maxx-this._minx}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(i){return!(!this.isNull()&&!i.isNull())||i._minx>this._maxx||i._maxx<this._minx||i._miny>this._maxy||i._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;let i=this.getWidth(),r=this.getHeight();return i>r?i:r}centre(){return this.isNull()?null:new w((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof w){let i=arguments[0];this.init(i.x,i.x,i.y,i.y)}else if(arguments[0]instanceof K){let i=arguments[0];this._minx=i._minx,this._maxx=i._maxx,this._miny=i._miny,this._maxy=i._maxy}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];i<r?(this._minx=i,this._maxx=r):(this._minx=r,this._maxx=i),c<f?(this._miny=c,this._maxy=f):(this._miny=f,this._maxy=c)}}getMaxY(){return this._maxy}distance(i){if(this.intersects(i))return 0;let r=0;this._maxx<i._minx?r=i._minx-this._maxx:this._minx>i._maxx&&(r=this._minx-i._maxx);let c=0;return this._maxy<i._miny?c=i._miny-this._maxy:this._miny>i._maxy&&(c=this._miny-i._maxy),r===0?c:c===0?r:Math.sqrt(r*r+c*c)}get interfaces_(){return[a,u]}}class te{constructor(i){this.str=i}append(i){this.str+=i}setCharAt(i,r){this.str=this.str.substr(0,i)+r+this.str.substr(i+1)}toString(){return this.str}}class Ge{constructor(i){this.value=i}intValue(){return this.value}compareTo(i){return this.value<i?-1:this.value>i?1:0}static compare(i,r){return i<r?-1:i>r?1:0}static isNan(i){return Number.isNaN(i)}static valueOf(i){return new Ge(i)}}class ye{static isWhitespace(i){return i<=32&&i>=0||i===127}static toUpperCase(i){return i.toUpperCase()}}class Re extends n{constructor(i){super(i),this.name=Object.keys({IllegalStateException:Re})[0]}}class U{constructor(){U.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){let i=arguments[0];this.init(i)}else if(arguments[0]instanceof U){let i=arguments[0];this.init(i)}else if(typeof arguments[0]=="string"){let i=arguments[0];U.constructor_.call(this,U.parse(i))}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.init(i,r)}}static determinant(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];return U.determinant(U.valueOf(i),U.valueOf(r),U.valueOf(c),U.valueOf(f))}if(arguments[3]instanceof U&&arguments[2]instanceof U&&arguments[0]instanceof U&&arguments[1]instanceof U){let i=arguments[1],r=arguments[2],c=arguments[3];return arguments[0].multiply(c).selfSubtract(i.multiply(r))}}static sqr(i){return U.valueOf(i).selfMultiply(i)}static valueOf(){if(typeof arguments[0]=="string"){let i=arguments[0];return U.parse(i)}if(typeof arguments[0]=="number")return new U(arguments[0])}static sqrt(i){return U.valueOf(i).sqrt()}static parse(i){let r=0,c=i.length;for(;ye.isWhitespace(i.charAt(r));)r++;let f=!1;if(r<c){let Ie=i.charAt(r);Ie!=="-"&&Ie!=="+"||(r++,Ie==="-"&&(f=!0))}let g=new U,y=0,S=0,I=0,z=!1;for(;!(r>=c);){let Ie=i.charAt(r);if(r++,ye.isDigit(Ie)){let Oe=Ie-"0";g.selfMultiply(U.TEN),g.selfAdd(Oe),y++}else{if(Ie!=="."){if(Ie==="e"||Ie==="E"){let Oe=i.substring(r);try{I=Ge.parseInt(Oe)}catch(Ue){throw Ue instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+Oe+" in string "+i):Ue}break}throw new NumberFormatException("Unexpected character '"+Ie+"' at position "+r+" in string "+i)}S=y,z=!0}}let ne=g;z||(S=y);let he=y-S-I;if(he===0)ne=g;else if(he>0){let Ie=U.TEN.pow(he);ne=g.divide(Ie)}else if(he<0){let Ie=U.TEN.pow(-he);ne=g.multiply(Ie)}return f?ne.negate():ne}static createNaN(){return new U(l.NaN,l.NaN)}static copy(i){return new U(i)}static magnitude(i){let r=Math.abs(i),c=Math.log(r)/Math.log(10),f=Math.trunc(Math.floor(c));return 10*Math.pow(10,f)<=r&&(f+=1),f}static stringOfChar(i,r){let c=new te;for(let f=0;f<r;f++)c.append(i);return c.toString()}le(i){return this._hi<i._hi||this._hi===i._hi&&this._lo<=i._lo}extractSignificantDigits(i,r){let c=this.abs(),f=U.magnitude(c._hi),g=U.TEN.pow(f);c=c.divide(g),c.gt(U.TEN)?(c=c.divide(U.TEN),f+=1):c.lt(U.ONE)&&(c=c.multiply(U.TEN),f-=1);let y=f+1,S=new te,I=U.MAX_PRINT_DIGITS-1;for(let z=0;z<=I;z++){i&&z===y&&S.append(".");let ne=Math.trunc(c._hi);if(ne<0)break;let he=!1,Ie=0;ne>9?(he=!0,Ie="9"):Ie="0"+ne,S.append(Ie),c=c.subtract(U.valueOf(ne)).multiply(U.TEN),he&&c.selfAdd(U.TEN);let Oe=!0,Ue=U.magnitude(c._hi);if(Ue<0&&Math.abs(Ue)>=I-z&&(Oe=!1),!Oe)break}return r[0]=f,S.toString()}sqr(){return this.multiply(this)}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}setValue(){if(arguments[0]instanceof U){let i=arguments[0];return this.init(i),this}if(typeof arguments[0]=="number"){let i=arguments[0];return this.init(i),this}}multiply(){if(arguments[0]instanceof U){let i=arguments[0];return i.isNaN()?U.createNaN():U.copy(this).selfMultiply(i)}if(typeof arguments[0]=="number"){let i=arguments[0];return l.isNaN(i)?U.createNaN():U.copy(this).selfMultiply(i,0)}}isNaN(){return l.isNaN(this._hi)}reciprocal(){let i=null,r=null,c=null,f=null,g=null,y=null,S=null,I=null;g=1/this._hi,y=U.SPLIT*g,i=y-g,I=U.SPLIT*this._hi,i=y-i,r=g-i,c=I-this._hi,S=g*this._hi,c=I-c,f=this._hi-c,I=i*c-S+i*f+r*c+r*f,y=(1-S-I-g*this._lo)/this._hi;let z=g+y;return new U(z,g-z+y)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof U){let i=arguments[0];return this.add(i.negate())}if(typeof arguments[0]=="number"){let i=arguments[0];return this.add(-i)}}equals(){if(arguments.length===1&&arguments[0]instanceof U){let i=arguments[0];return this._hi===i._hi&&this._lo===i._lo}}isZero(){return this._hi===0&&this._lo===0}selfSubtract(){if(arguments[0]instanceof U){let i=arguments[0];return this.isNaN()?this:this.selfAdd(-i._hi,-i._lo)}if(typeof arguments[0]=="number"){let i=arguments[0];return this.isNaN()?this:this.selfAdd(-i,0)}}min(i){return this.le(i)?this:i}selfDivide(){if(arguments.length===1){if(arguments[0]instanceof U){let i=arguments[0];return this.selfDivide(i._hi,i._lo)}if(typeof arguments[0]=="number"){let i=arguments[0];return this.selfDivide(i,0)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=null,f=null,g=null,y=null,S=null,I=null,z=null,ne=null;return S=this._hi/i,I=U.SPLIT*S,c=I-S,ne=U.SPLIT*i,c=I-c,f=S-c,g=ne-i,z=S*i,g=ne-g,y=i-g,ne=c*g-z+c*y+f*g+f*y,I=(this._hi-z-ne+this._lo-S*r)/i,ne=S+I,this._hi=ne,this._lo=S-ne+I,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof U){let i=arguments[0],r=null,c=null,f=null,g=null,y=null,S=null,I=null,z=null;return y=this._hi/i._hi,S=U.SPLIT*y,r=S-y,z=U.SPLIT*i._hi,r=S-r,c=y-r,f=z-i._hi,I=y*i._hi,f=z-f,g=i._hi-f,z=r*f-I+r*g+c*f+c*g,S=(this._hi-I-z+this._lo-y*i._lo)/i._hi,z=y+S,new U(z,y-z+S)}if(typeof arguments[0]=="number"){let i=arguments[0];return l.isNaN(i)?U.createNaN():U.copy(this).selfDivide(i,0)}}ge(i){return this._hi>i._hi||this._hi===i._hi&&this._lo>=i._lo}pow(i){if(i===0)return U.valueOf(1);let r=new U(this),c=U.valueOf(1),f=Math.abs(i);if(f>1)for(;f>0;)f%2==1&&c.selfMultiply(r),f/=2,f>0&&(r=r.sqr());else c=r;return i<0?c.reciprocal():c}ceil(){if(this.isNaN())return U.NaN;let i=Math.ceil(this._hi),r=0;return i===this._hi&&(r=Math.ceil(this._lo)),new U(i,r)}compareTo(i){let r=i;return this._hi<r._hi?-1:this._hi>r._hi?1:this._lo<r._lo?-1:this._lo>r._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}max(i){return this.ge(i)?this:i}sqrt(){if(this.isZero())return U.valueOf(0);if(this.isNegative())return U.NaN;let i=1/Math.sqrt(this._hi),r=this._hi*i,c=U.valueOf(r),f=this.subtract(c.sqr())._hi*(.5*i);return c.add(f)}selfAdd(){if(arguments.length===1){if(arguments[0]instanceof U){let i=arguments[0];return this.selfAdd(i._hi,i._lo)}if(typeof arguments[0]=="number"){let i=arguments[0],r=null,c=null,f=null,g=null,y=null,S=null;return f=this._hi+i,y=f-this._hi,g=f-y,g=i-y+(this._hi-g),S=g+this._lo,r=f+S,c=S+(f-r),this._hi=r+c,this._lo=c+(r-this._hi),this}}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=null,f=null,g=null,y=null,S=null,I=null,z=null,ne=null;S=this._hi+i,g=this._lo+r,z=S-this._hi,ne=g-this._lo,I=S-z,y=g-ne,I=i-z+(this._hi-I),y=r-ne+(this._lo-y),z=I+g,c=S+z,f=z+(S-c),z=y+f;let he=c+z,Ie=z+(c-he);return this._hi=he,this._lo=Ie,this}}selfMultiply(){if(arguments.length===1){if(arguments[0]instanceof U){let i=arguments[0];return this.selfMultiply(i._hi,i._lo)}if(typeof arguments[0]=="number"){let i=arguments[0];return this.selfMultiply(i,0)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=null,f=null,g=null,y=null,S=null,I=null;S=U.SPLIT*this._hi,c=S-this._hi,I=U.SPLIT*i,c=S-c,f=this._hi-c,g=I-i,S=this._hi*i,g=I-g,y=i-g,I=c*g-S+c*y+f*g+f*y+(this._hi*r+this._lo*i);let z=S+I;c=S-z;let ne=I+c;return this._hi=z,this._lo=ne,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return U.NaN;let i=Math.floor(this._hi),r=0;return i===this._hi&&(r=Math.floor(this._lo)),new U(i,r)}negate(){return this.isNaN()?this:new U(-this._hi,-this._lo)}clone(){try{return null}catch(i){if(i instanceof CloneNotSupportedException)return null;throw i}}intValue(){return Math.trunc(this._hi)}toString(){let i=U.magnitude(this._hi);return i>=-3&&i<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){let i=this.getSpecialNumberString();if(i!==null)return i;let r=new Array(1).fill(null),c=this.extractSignificantDigits(!0,r),f=r[0]+1,g=c;if(c.charAt(0)===".")g="0"+c;else if(f<0)g="0."+U.stringOfChar("0",-f)+c;else if(c.indexOf(".")===-1){let y=f-c.length;g=c+U.stringOfChar("0",y)+".0"}return this.isNegative()?"-"+g:g}toSciNotation(){if(this.isZero())return U.SCI_NOT_ZERO;let i=this.getSpecialNumberString();if(i!==null)return i;let r=new Array(1).fill(null),c=this.extractSignificantDigits(!1,r),f=U.SCI_NOT_EXPONENT_CHAR+r[0];if(c.charAt(0)==="0")throw new Re("Found leading zero: "+c);let g="";c.length>1&&(g=c.substring(1));let y=c.charAt(0)+"."+g;return this.isNegative()?"-"+y+f:y+f}abs(){return this.isNaN()?U.NaN:this.isNegative()?this.negate():new U(this)}isPositive(){return this._hi>0||this._hi===0&&this._lo>0}lt(i){return this._hi<i._hi||this._hi===i._hi&&this._lo<i._lo}add(){if(arguments[0]instanceof U){let i=arguments[0];return U.copy(this).selfAdd(i)}if(typeof arguments[0]=="number"){let i=arguments[0];return U.copy(this).selfAdd(i)}}init(){if(arguments.length===1){if(typeof arguments[0]=="number"){let i=arguments[0];this._hi=i,this._lo=0}else if(arguments[0]instanceof U){let i=arguments[0];this._hi=i._hi,this._lo=i._lo}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._hi=i,this._lo=r}}gt(i){return this._hi>i._hi||this._hi===i._hi&&this._lo>i._lo}isNegative(){return this._hi<0||this._hi===0&&this._lo<0}trunc(){return this.isNaN()?U.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[u,a,_]}}U.PI=new U(3.141592653589793,12246467991473532e-32),U.TWO_PI=new U(6.283185307179586,24492935982947064e-32),U.PI_2=new U(1.5707963267948966,6123233995736766e-32),U.E=new U(2.718281828459045,14456468917292502e-32),U.NaN=new U(l.NaN,l.NaN),U.EPS=123259516440783e-46,U.SPLIT=134217729,U.MAX_PRINT_DIGITS=32,U.TEN=U.valueOf(10),U.ONE=U.valueOf(1),U.SCI_NOT_EXPONENT_CHAR="E",U.SCI_NOT_ZERO="0.0E0";class ce{static orientationIndex(i,r,c){let f=ce.orientationIndexFilter(i,r,c);if(f<=1)return f;let g=U.valueOf(r.x).selfAdd(-i.x),y=U.valueOf(r.y).selfAdd(-i.y),S=U.valueOf(c.x).selfAdd(-r.x),I=U.valueOf(c.y).selfAdd(-r.y);return g.selfMultiply(I).selfSubtract(y.selfMultiply(S)).signum()}static signOfDet2x2(){if(arguments[3]instanceof U&&arguments[2]instanceof U&&arguments[0]instanceof U&&arguments[1]instanceof U){let i=arguments[1],r=arguments[2],c=arguments[3];return arguments[0].multiply(c).selfSubtract(i.multiply(r)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=U.valueOf(i),y=U.valueOf(r),S=U.valueOf(c),I=U.valueOf(f);return g.multiply(I).selfSubtract(y.multiply(S)).signum()}}static intersection(i,r,c,f){let g=new U(i.y).selfSubtract(r.y),y=new U(r.x).selfSubtract(i.x),S=new U(i.x).selfMultiply(r.y).selfSubtract(new U(r.x).selfMultiply(i.y)),I=new U(c.y).selfSubtract(f.y),z=new U(f.x).selfSubtract(c.x),ne=new U(c.x).selfMultiply(f.y).selfSubtract(new U(f.x).selfMultiply(c.y)),he=y.multiply(ne).selfSubtract(z.multiply(S)),Ie=I.multiply(S).selfSubtract(g.multiply(ne)),Oe=g.multiply(z).selfSubtract(I.multiply(y)),Ue=he.selfDivide(Oe).doubleValue(),ut=Ie.selfDivide(Oe).doubleValue();return l.isNaN(Ue)||l.isInfinite(Ue)||l.isNaN(ut)||l.isInfinite(ut)?null:new w(Ue,ut)}static orientationIndexFilter(i,r,c){let f=null,g=(i.x-c.x)*(r.y-c.y),y=(i.y-c.y)*(r.x-c.x),S=g-y;if(g>0){if(y<=0)return ce.signum(S);f=g+y}else{if(!(g<0)||y>=0)return ce.signum(S);f=-g-y}let I=ce.DP_SAFE_EPSILON*f;return S>=I||-S>=I?ce.signum(S):2}static signum(i){return i>0?1:i<0?-1:0}}ce.DP_SAFE_EPSILON=1e-15;class we{getCoordinate(){}getCoordinateCopy(i){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(i){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(i){}copy(){}getY(i){}toCoordinateArray(){}getM(i){if(this.hasM()){let r=this.getDimension()-this.getMeasures();return this.getOrdinate(i,r)}return l.NaN}setOrdinate(i,r,c){}getZ(i){return this.hasZ()?this.getOrdinate(i,2):l.NaN}size(){}getOrdinate(i,r){}get interfaces_(){return[_]}}we.X=0,we.Y=1,we.Z=2,we.M=3;class pe{static isCCW(){if(arguments[0]instanceof Array){let i=arguments[0],r=i.length-1;if(r<3)throw new s("Ring has fewer than 4 points, so orientation cannot be determined");let c=i[0],f=0;for(let he=1;he<=r;he++){let Ie=i[he];Ie.y>c.y&&(c=Ie,f=he)}let g=f;do g-=1,g<0&&(g=r);while(i[g].equals2D(c)&&g!==f);let y=f;do y=(y+1)%r;while(i[y].equals2D(c)&&y!==f);let S=i[g],I=i[y];if(S.equals2D(c)||I.equals2D(c)||S.equals2D(I))return!1;let z=pe.index(S,c,I),ne=null;return ne=z===0?S.x>I.x:z>0,ne}if(P(arguments[0],we)){let i=arguments[0],r=i.size()-1;if(r<3)throw new s("Ring has fewer than 4 points, so orientation cannot be determined");let c=i.getCoordinate(0),f=0;for(let he=1;he<=r;he++){let Ie=i.getCoordinate(he);Ie.y>c.y&&(c=Ie,f=he)}let g=null,y=f;do y-=1,y<0&&(y=r),g=i.getCoordinate(y);while(g.equals2D(c)&&y!==f);let S=null,I=f;do I=(I+1)%r,S=i.getCoordinate(I);while(S.equals2D(c)&&I!==f);if(g.equals2D(c)||S.equals2D(c)||g.equals2D(S))return!1;let z=pe.index(g,c,S),ne=null;return ne=z===0?g.x>S.x:z>0,ne}}static index(i,r,c){return ce.orientationIndex(i,r,c)}}pe.CLOCKWISE=-1,pe.RIGHT=pe.CLOCKWISE,pe.COUNTERCLOCKWISE=1,pe.LEFT=pe.COUNTERCLOCKWISE,pe.COLLINEAR=0,pe.STRAIGHT=pe.COLLINEAR;class Ee{static intersection(i,r,c,f){let g=i.x<r.x?i.x:r.x,y=i.y<r.y?i.y:r.y,S=i.x>r.x?i.x:r.x,I=i.y>r.y?i.y:r.y,z=c.x<f.x?c.x:f.x,ne=c.y<f.y?c.y:f.y,he=c.x>f.x?c.x:f.x,Ie=c.y>f.y?c.y:f.y,Oe=((g>z?g:z)+(S<he?S:he))/2,Ue=((y>ne?y:ne)+(I<Ie?I:Ie))/2,ut=i.x-Oe,cn=i.y-Ue,Oi=r.x-Oe,Dr=r.y-Ue,MS=c.x-Oe,AS=c.y-Ue,OS=f.x-Oe,PS=f.y-Ue,FS=cn-Dr,DS=Oi-ut,GS=ut*Dr-Oi*cn,jS=AS-PS,qS=OS-MS,$S=MS*PS-OS*AS,BS=FS*qS-jS*DS,Uy=(DS*$S-qS*GS)/BS,zy=(jS*GS-FS*$S)/BS;return l.isNaN(Uy)||l.isInfinite(Uy)||l.isNaN(zy)||l.isInfinite(zy)?null:new w(Uy+Oe,zy+Ue)}}class Fe{static arraycopy(i,r,c,f,g){let y=0;for(let S=r;S<r+g;S++)c[f+y]=i[S],y++}static getProperty(i){return{"line.separator":`
`}[i]}}class lt{static log10(i){let r=Math.log(i);return l.isInfinite(r)||l.isNaN(r)?r:r/lt.LOG_10}static min(i,r,c,f){let g=i;return r<g&&(g=r),c<g&&(g=c),f<g&&(g=f),g}static clamp(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1],c=arguments[2];return i<r?r:i>c?c:i}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1],c=arguments[2];return i<r?r:i>c?c:i}}static average(i,r){return(i+r)/2}static wrap(i,r){return i<0?r- -i%r:i%r}static max(){if(arguments.length===3){let i=arguments[1],r=arguments[2],c=arguments[0];return i>c&&(c=i),r>c&&(c=r),c}if(arguments.length===4){let i=arguments[1],r=arguments[2],c=arguments[3],f=arguments[0];return i>f&&(f=i),r>f&&(f=r),c>f&&(f=c),f}}}lt.LOG_10=Math.log(10);class qe{static pointToSegmentString(i,r){if(r.length===0)throw new s("Line array must contain at least one vertex");let c=i.distance(r[0]);for(let f=0;f<r.length-1;f++){let g=qe.pointToSegment(i,r[f],r[f+1]);g<c&&(c=g)}return c}static segmentToSegment(i,r,c,f){if(i.equals(r))return qe.pointToSegment(i,c,f);if(c.equals(f))return qe.pointToSegment(f,i,r);let g=!1;if(K.intersects(i,r,c,f)){let y=(r.x-i.x)*(f.y-c.y)-(r.y-i.y)*(f.x-c.x);if(y===0)g=!0;else{let S=(i.y-c.y)*(f.x-c.x)-(i.x-c.x)*(f.y-c.y),I=((i.y-c.y)*(r.x-i.x)-(i.x-c.x)*(r.y-i.y))/y,z=S/y;(z<0||z>1||I<0||I>1)&&(g=!0)}}else g=!0;return g?lt.min(qe.pointToSegment(i,c,f),qe.pointToSegment(r,c,f),qe.pointToSegment(c,i,r),qe.pointToSegment(f,i,r)):0}static pointToLinePerpendicular(i,r,c){let f=(c.x-r.x)*(c.x-r.x)+(c.y-r.y)*(c.y-r.y),g=((r.y-i.y)*(c.x-r.x)-(r.x-i.x)*(c.y-r.y))/f;return Math.abs(g)*Math.sqrt(f)}static pointToSegment(i,r,c){if(r.x===c.x&&r.y===c.y)return i.distance(r);let f=(c.x-r.x)*(c.x-r.x)+(c.y-r.y)*(c.y-r.y),g=((i.x-r.x)*(c.x-r.x)+(i.y-r.y)*(c.y-r.y))/f;if(g<=0)return i.distance(r);if(g>=1)return i.distance(c);let y=((r.y-i.y)*(c.x-r.x)-(r.x-i.x)*(c.y-r.y))/f;return Math.abs(y)*Math.sqrt(f)}}class rt{static ofLine(i){let r=i.size();if(r<=1)return 0;let c=0,f=new w;i.getCoordinate(0,f);let g=f.x,y=f.y;for(let S=1;S<r;S++){i.getCoordinate(S,f);let I=f.x,z=f.y,ne=I-g,he=z-y;c+=Math.sqrt(ne*ne+he*he),g=I,y=z}return c}}class Pe{filter(i){}}class Je extends n{constructor(i){super(i),this.name=Object.keys({UnsupportedOperationException:Je})[0]}}class et{static measures(i){return i instanceof D?0:i instanceof G||i instanceof W?1:0}static create(){if(arguments.length===1){let i=arguments[0];return et.create(i,0)}if(arguments.length===2){let i=arguments[0],r=arguments[1];return i===2?new D:i===3&&r===0?new w:i===3&&r===1?new G:i===4&&r===1?new W:new w}}static dimension(i){return i instanceof D?2:i instanceof G?3:i instanceof W?4:3}}class Be{static scroll(i,r){let c=Be.indexOf(r,i);if(c<0)return null;let f=new Array(i.length).fill(null);Fe.arraycopy(i,c,f,0,i.length-c),Fe.arraycopy(i,0,f,i.length-c,c),Fe.arraycopy(f,0,i,0,i.length)}static removeRepeatedPoints(i){return Be.hasRepeatedPoints(i)?new E(i,!1).toCoordinateArray():i}static reverse(i){let r=i.length-1,c=Math.trunc(r/2);for(let f=0;f<=c;f++){let g=i[f];i[f]=i[r-f],i[r-f]=g}}static removeNull(i){let r=0;for(let g=0;g<i.length;g++)i[g]!==null&&r++;let c=new Array(r).fill(null);if(r===0)return c;let f=0;for(let g=0;g<i.length;g++)i[g]!==null&&(c[f++]=i[g]);return c}static copyDeep(){if(arguments.length===1){let i=arguments[0],r=new Array(i.length).fill(null);for(let c=0;c<i.length;c++)r[c]=i[c].copy();return r}if(arguments.length===5){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4];for(let y=0;y<g;y++)c[f+y]=i[r+y].copy()}}static isEqualReversed(i,r){for(let c=0;c<i.length;c++){let f=i[c],g=r[i.length-c-1];if(f.compareTo(g)!==0)return!1}return!0}static envelope(i){let r=new K;for(let c=0;c<i.length;c++)r.expandToInclude(i[c]);return r}static extract(i,r,c){r=lt.clamp(r,0,i.length);let f=(c=lt.clamp(c,-1,i.length))-r+1;c<0&&(f=0),r>=i.length&&(f=0),c<r&&(f=0);let g=new Array(f).fill(null);if(f===0)return g;let y=0;for(let S=r;S<=c;S++)g[y++]=i[S];return g}static isRing(i){return!(i.length<4)&&!!i[0].equals2D(i[i.length-1])}static ptNotInList(i,r){for(let c=0;c<i.length;c++){let f=i[c];if(Be.indexOf(f,r)<0)return f}return null}static equals(){if(arguments.length===2){let i=arguments[0],r=arguments[1];if(i===r)return!0;if(i===null||r===null||i.length!==r.length)return!1;for(let c=0;c<i.length;c++)if(!i[c].equals(r[c]))return!1;return!0}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(i===r)return!0;if(i===null||r===null||i.length!==r.length)return!1;for(let f=0;f<i.length;f++)if(c.compare(i[f],r[f])!==0)return!1;return!0}}static intersection(i,r){let c=new E;for(let f=0;f<i.length;f++)r.intersects(i[f])&&c.add(i[f],!0);return c.toCoordinateArray()}static measures(i){if(i===null||i.length===0)return 0;let r=0;for(let c of i)r=Math.max(r,et.measures(c));return r}static hasRepeatedPoints(i){for(let r=1;r<i.length;r++)if(i[r-1].equals(i[r]))return!0;return!1}static toCoordinateArray(i){return i.toArray(Be.coordArrayType)}static dimension(i){if(i===null||i.length===0)return 3;let r=0;for(let c of i)r=Math.max(r,et.dimension(c));return r}static atLeastNCoordinatesOrNothing(i,r){return r.length>=i?r:[]}static indexOf(i,r){for(let c=0;c<r.length;c++)if(i.equals(r[c]))return c;return-1}static increasingDirection(i){for(let r=0;r<Math.trunc(i.length/2);r++){let c=i.length-1-r,f=i[r].compareTo(i[c]);if(f!==0)return f}return 1}static compare(i,r){let c=0;for(;c<i.length&&c<r.length;){let f=i[c].compareTo(r[c]);if(f!==0)return f;c++}return c<r.length?-1:c<i.length?1:0}static minCoordinate(i){let r=null;for(let c=0;c<i.length;c++)(r===null||r.compareTo(i[c])>0)&&(r=i[c]);return r}}Be.ForwardComparator=class{compare(A,i){let r=A,c=i;return Be.compare(r,c)}get interfaces_(){return[m]}},Be.BidirectionalComparator=class{compare(A,i){let r=A,c=i;if(r.length<c.length)return-1;if(r.length>c.length)return 1;if(r.length===0)return 0;let f=Be.compare(r,c);return Be.isEqualReversed(r,c)?0:f}OLDcompare(A,i){let r=A,c=i;if(r.length<c.length)return-1;if(r.length>c.length)return 1;if(r.length===0)return 0;let f=Be.increasingDirection(r),g=Be.increasingDirection(c),y=f>0?0:r.length-1,S=g>0?0:r.length-1;for(let I=0;I<r.length;I++){let z=r[y].compareTo(c[S]);if(z!==0)return z;y+=f,S+=g}return 0}get interfaces_(){return[m]}},Be.coordArrayType=new Array(0).fill(null);class C{static toDimensionSymbol(i){switch(i){case C.FALSE:return C.SYM_FALSE;case C.TRUE:return C.SYM_TRUE;case C.DONTCARE:return C.SYM_DONTCARE;case C.P:return C.SYM_P;case C.L:return C.SYM_L;case C.A:return C.SYM_A}throw new s("Unknown dimension value: "+i)}static toDimensionValue(i){switch(ye.toUpperCase(i)){case C.SYM_FALSE:return C.FALSE;case C.SYM_TRUE:return C.TRUE;case C.SYM_DONTCARE:return C.DONTCARE;case C.SYM_P:return C.P;case C.SYM_L:return C.L;case C.SYM_A:return C.A}throw new s("Unknown dimension symbol: "+i)}}C.P=0,C.L=1,C.A=2,C.FALSE=-1,C.TRUE=-2,C.DONTCARE=-3,C.SYM_FALSE="F",C.SYM_TRUE="T",C.SYM_DONTCARE="*",C.SYM_P="0",C.SYM_L="1",C.SYM_A="2";class Q{constructor(){Q.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===Q.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(i){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(i){return this===i||this.equalsExact(i,0)}geometryChanged(){this.apply(Q.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(i){return i!==null&&this.norm().equalsExact(i.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let i;if(arguments.length===1){let r=arguments[0];return i=r,this.getTypeCode()!==i.getTypeCode()?this.getTypeCode()-i.getTypeCode():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(r)}if(arguments.length===2){let r=arguments[0],c=arguments[1];return i=r,this.getTypeCode()!==i.getTypeCode()?this.getTypeCode()-i.getTypeCode():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(r,c)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(i){if(i.getTypeCode()===Q.TYPECODE_GEOMETRYCOLLECTION)throw new s("This method does not support GeometryCollection arguments")}equal(i,r,c){return c===0?i.equals(r):i.distance(r)<=c}norm(){let i=this.copy();return i.normalize(),i}reverse(){let i=this.reverseInternal();return this.envelope!=null&&(i.envelope=this.envelope.copy()),i.setSRID(this.getSRID()),i}copy(){let i=this.copyInternal();return i.envelope=this._envelope==null?null:this._envelope.copy(),i._SRID=this._SRID,i._userData=this._userData,i}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new K(this._envelope)}setSRID(i){this._SRID=i}setUserData(i){this._userData=i}compare(i,r){let c=i.iterator(),f=r.iterator();for(;c.hasNext()&&f.hasNext();){let g=c.next(),y=f.next(),S=g.compareTo(y);if(S!==0)return S}return c.hasNext()?1:f.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(i){return this.getTypeCode()==i.getTypeCode()}get interfaces_(){return[_,a,u]}getClass(){return Q}static hasNonEmptyElements(i){for(let r=0;r<i.length;r++)if(!i[r].isEmpty())return!0;return!1}static hasNullElements(i){for(let r=0;r<i.length;r++)if(i[r]===null)return!0;return!1}}Q.constructor_=function(A){A&&(this._envelope=null,this._userData=null,this._factory=A,this._SRID=A.getSRID())},Q.TYPECODE_POINT=0,Q.TYPECODE_MULTIPOINT=1,Q.TYPECODE_LINESTRING=2,Q.TYPECODE_LINEARRING=3,Q.TYPECODE_MULTILINESTRING=4,Q.TYPECODE_POLYGON=5,Q.TYPECODE_MULTIPOLYGON=6,Q.TYPECODE_GEOMETRYCOLLECTION=7,Q.TYPENAME_POINT="Point",Q.TYPENAME_MULTIPOINT="MultiPoint",Q.TYPENAME_LINESTRING="LineString",Q.TYPENAME_LINEARRING="LinearRing",Q.TYPENAME_MULTILINESTRING="MultiLineString",Q.TYPENAME_POLYGON="Polygon",Q.TYPENAME_MULTIPOLYGON="MultiPolygon",Q.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",Q.geometryChangedFilter={get interfaces_(){return[Pe]},filter(A){A.geometryChangedAction()}};class ge{filter(i){}}class N{}class k{static scroll(){if(arguments.length===2){if(P(arguments[0],we)&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1];k.scroll(i,r,k.isRing(i))}else if(P(arguments[0],we)&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=k.indexOf(r,i);if(c<=0)return null;k.scroll(i,c)}}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(r<=0)return null;let f=i.copy(),g=c?i.size()-1:i.size();for(let y=0;y<g;y++)for(let S=0;S<i.getDimension();S++)i.setOrdinate(y,S,f.getOrdinate((r+y)%g,S));if(c)for(let y=0;y<i.getDimension();y++)i.setOrdinate(g,y,i.getOrdinate(0,y))}}static isEqual(i,r){let c=i.size();if(c!==r.size())return!1;let f=Math.min(i.getDimension(),r.getDimension());for(let g=0;g<c;g++)for(let y=0;y<f;y++){let S=i.getOrdinate(g,y),I=r.getOrdinate(g,y);if(i.getOrdinate(g,y)!==r.getOrdinate(g,y)&&(!l.isNaN(S)||!l.isNaN(I)))return!1}return!0}static minCoordinateIndex(){if(arguments.length===1){let i=arguments[0];return k.minCoordinateIndex(i,0,i.size()-1)}if(arguments.length===3){let i=arguments[0],r=arguments[2],c=-1,f=null;for(let g=arguments[1];g<=r;g++){let y=i.getCoordinate(g);(f===null||f.compareTo(y)>0)&&(f=y,c=g)}return c}}static extend(i,r,c){let f=i.create(c,r.getDimension()),g=r.size();if(k.copy(r,0,f,0,g),g>0)for(let y=g;y<c;y++)k.copy(r,g-1,f,y,1);return f}static reverse(i){let r=i.size()-1,c=Math.trunc(r/2);for(let f=0;f<=c;f++)k.swap(i,f,r-f)}static ensureValidRing(i,r){let c=r.size();return c===0?r:c<=3?k.createClosedRing(i,r,4):r.getOrdinate(0,we.X)===r.getOrdinate(c-1,we.X)&&r.getOrdinate(0,we.Y)===r.getOrdinate(c-1,we.Y)?r:k.createClosedRing(i,r,c+1)}static minCoordinate(i){let r=null;for(let c=0;c<i.size();c++){let f=i.getCoordinate(c);(r===null||r.compareTo(f)>0)&&(r=f)}return r}static copyCoord(i,r,c,f){let g=Math.min(i.getDimension(),c.getDimension());for(let y=0;y<g;y++)c.setOrdinate(f,y,i.getOrdinate(r,y))}static isRing(i){let r=i.size();return r===0||!(r<=3)&&i.getOrdinate(0,we.X)===i.getOrdinate(r-1,we.X)&&i.getOrdinate(0,we.Y)===i.getOrdinate(r-1,we.Y)}static swap(i,r,c){if(r===c)return null;for(let f=0;f<i.getDimension();f++){let g=i.getOrdinate(r,f);i.setOrdinate(r,f,i.getOrdinate(c,f)),i.setOrdinate(c,f,g)}}static copy(i,r,c,f,g){for(let y=0;y<g;y++)k.copyCoord(i,r+y,c,f+y)}static indexOf(i,r){for(let c=0;c<r.size();c++)if(i.x===r.getOrdinate(c,we.X)&&i.y===r.getOrdinate(c,we.Y))return c;return-1}static createClosedRing(i,r,c){let f=i.create(c,r.getDimension()),g=r.size();k.copy(r,0,f,0,g);for(let y=g;y<c;y++)k.copy(r,0,f,y,1);return f}}class O{filter(i){}}class Z extends Q{constructor(){super(),Z.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,arguments.length!==0){if(arguments.length===2){let i=arguments[0],r=arguments[1];Q.constructor_.call(this,r),this.init(i)}}}computeEnvelopeInternal(){return this.isEmpty()?new K:this._points.expandEnvelope(new K)}isRing(){return this.isClosed()&&Be.isRing(this.getCoordinates())}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new Z(this._points.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];if(!this.isEquivalentClass(i))return!1;let c=i;if(this._points.size()!==c._points.size())return!1;for(let f=0;f<this._points.size();f++)if(!this.equal(this._points.getCoordinate(f),c._points.getCoordinate(f),r))return!1;return!0}return super.equalsExact.apply(this,arguments)}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){let i=this._points.copy();return k.reverse(i),this.getFactory().createLineString(i)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return Q.TYPECODE_LINESTRING}getDimension(){return 1}getBoundary(){throw new Je}isEquivalentClass(i){return i instanceof Z}getCoordinateSequence(){return this._points}getPointN(i){return this.getFactory().createPoint(this._points.getCoordinate(i))}normalize(){for(let i=0;i<Math.trunc(this._points.size()/2);i++){let r=this._points.size()-1-i;if(!this._points.getCoordinate(i).equals(this._points.getCoordinate(r))){if(this._points.getCoordinate(i).compareTo(this._points.getCoordinate(r))>0){let c=this._points.copy();k.reverse(c),this._points=c}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?C.FALSE:0}getLength(){return rt.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(arguments.length===1){let i=arguments[0],r=0,c=0;for(;r<this._points.size()&&c<i._points.size();){let f=this._points.getCoordinate(r).compareTo(i._points.getCoordinate(c));if(f!==0)return f;r++,c++}return r<this._points.size()?1:c<i._points.size()?-1:0}if(arguments.length===2){let i=arguments[0];return arguments[1].compare(this._points,i._points)}}apply(){if(P(arguments[0],ge)){let i=arguments[0];for(let r=0;r<this._points.size();r++)i.filter(this._points.getCoordinate(r))}else if(P(arguments[0],X)){let i=arguments[0];if(this._points.size()===0)return null;for(let r=0;r<this._points.size()&&(i.filter(this._points,r),!i.isDone());r++);i.isGeometryChanged()&&this.geometryChanged()}else P(arguments[0],O)?arguments[0].filter(this):P(arguments[0],Pe)&&arguments[0].filter(this)}getCoordinateN(i){return this._points.getCoordinate(i)}getGeometryType(){return Q.TYPENAME_LINESTRING}isEmpty(){return this._points.size()===0}init(i){if(i===null&&(i=this.getFactory().getCoordinateSequenceFactory().create([])),i.size()===1)throw new s("Invalid number of points in LineString (found "+i.size()+" - must be 0 or >= 2)");this._points=i}isCoordinate(i){for(let r=0;r<this._points.size();r++)if(this._points.getCoordinate(r).equals(i))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}get interfaces_(){return[N]}}class ae extends Z{constructor(){super(),ae.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];Z.constructor_.call(this,i,r),this.validateConstruction()}copyInternal(){return new ae(this._points.copy(),this._factory)}getBoundaryDimension(){return C.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}reverseInternal(){let i=this._points.copy();return k.reverse(i),this.getFactory().createLinearRing(i)}getTypeCode(){return Q.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new s("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<ae.MINIMUM_VALID_SIZE)throw new s("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return Q.TYPENAME_LINEARRING}}ae.MINIMUM_VALID_SIZE=4;class J{create(){if(arguments.length===1)arguments[0]instanceof Array||P(arguments[0],we);else if(arguments.length!==2){if(arguments.length===3){let i=arguments[0],r=arguments[1];return this.create(i,r)}}}}class re{constructor(i){this.str=i}append(i){this.str+=i}setCharAt(i,r){this.str=this.str.substr(0,i)+r+this.str.substr(i+1)}toString(){return this.str}}class de{constructor(){de.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){let i=arguments[0];de.constructor_.call(this,i,Be.dimension(i),Be.measures(i))}else if(Number.isInteger(arguments[0])){let i=arguments[0];this._coordinates=new Array(i).fill(null);for(let r=0;r<i;r++)this._coordinates[r]=new w}else if(P(arguments[0],we)){let i=arguments[0];if(i===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._measures=i.getMeasures(),this._coordinates=new Array(i.size()).fill(null);for(let r=0;r<this._coordinates.length;r++)this._coordinates[r]=i.getCoordinateCopy(r)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1];de.constructor_.call(this,i,r,Be.measures(i))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1];this._coordinates=new Array(i).fill(null),this._dimension=r;for(let c=0;c<i;c++)this._coordinates[c]=et.create(r)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1],c=arguments[2];this._dimension=r,this._measures=c,this._coordinates=i===null?new Array(0).fill(null):i}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1],c=arguments[2];this._coordinates=new Array(i).fill(null),this._dimension=r,this._measures=c;for(let f=0;f<i;f++)this._coordinates[f]=this.createCoordinate()}}}getCoordinate(){if(arguments.length===1){let i=arguments[0];return this._coordinates[i]}if(arguments.length===2){let i=arguments[0];arguments[1].setCoordinate(this._coordinates[i])}}getCoordinateCopy(i){let r=this.createCoordinate();return r.setCoordinate(this._coordinates[i]),r}createCoordinate(){return et.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(i){return this._coordinates[i].x}getMeasures(){return this._measures}expandEnvelope(i){for(let r=0;r<this._coordinates.length;r++)i.expandToInclude(this._coordinates[r]);return i}copy(){let i=new Array(this.size()).fill(null);for(let r=0;r<this._coordinates.length;r++){let c=this.createCoordinate();c.setCoordinate(this._coordinates[r]),i[r]=c}return new de(i,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){let i=new re(17*this._coordinates.length);i.append("("),i.append(this._coordinates[0]);for(let r=1;r<this._coordinates.length;r++)i.append(", "),i.append(this._coordinates[r]);return i.append(")"),i.toString()}return"()"}getY(i){return this._coordinates[i].y}toCoordinateArray(){return this._coordinates}getM(i){return this.hasM()?this._coordinates[i].getM():l.NaN}setOrdinate(i,r,c){switch(r){case we.X:this._coordinates[i].x=c;break;case we.Y:this._coordinates[i].y=c;break;default:this._coordinates[i].setOrdinate(r,c)}}getZ(i){return this.hasZ()?this._coordinates[i].getZ():l.NaN}size(){return this._coordinates.length}getOrdinate(i,r){switch(r){case we.X:return this._coordinates[i].x;case we.Y:return this._coordinates[i].y;default:return this._coordinates[i].getOrdinate(r)}}get interfaces_(){return[we,u]}}class me{static instance(){return me.instanceObject}readResolve(){return me.instance()}create(){if(arguments.length===1){if(arguments[0]instanceof Array)return new de(arguments[0]);if(P(arguments[0],we))return new de(arguments[0])}else{if(arguments.length===2){let i=arguments[1];return i>3&&(i=3),i<2&&(i=2),new de(arguments[0],i)}if(arguments.length===3){let i=arguments[2],r=arguments[1]-i;return i>1&&(i=1),r>3&&(r=3),r<2&&(r=2),new de(arguments[0],r+i,i)}}}get interfaces_(){return[J,u]}}me.instanceObject=new me;class Ae extends j{contains(){}}class it extends Ae{}class Xe extends it{constructor(i){super(),this.array=[],i instanceof j&&this.addAll(i)}contains(i){for(let r of this.array)if(r.compareTo(i)===0)return!0;return!1}add(i){if(this.contains(i))return!1;for(let r=0,c=this.array.length;r<c;r++)if(this.array[r].compareTo(i)===1)return!!this.array.splice(r,0,i);return this.array.push(i),!0}addAll(i){for(let r of i)this.add(r);return!0}remove(){throw new Je}size(){return this.array.length}isEmpty(){return this.array.length===0}toArray(){return this.array.slice()}iterator(){return new mn(this.array)}}let mn=class{constructor(A){this.array=A,this.position=0}next(){if(this.position===this.array.length)throw new se;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new Je}};class Hn{static sort(){let i=arguments[0];if(arguments.length===1)i.sort((r,c)=>r.compareTo(c));else if(arguments.length===2)i.sort((r,c)=>arguments[1].compare(r,c));else if(arguments.length===3){let r=i.slice(arguments[1],arguments[2]);r.sort();let c=i.slice(0,arguments[1]).concat(r,i.slice(arguments[2],i.length));i.splice(0,i.length);for(let f of c)i.push(f)}else if(arguments.length===4){let r=i.slice(arguments[1],arguments[2]);r.sort((f,g)=>arguments[3].compare(f,g));let c=i.slice(0,arguments[1]).concat(r,i.slice(arguments[2],i.length));i.splice(0,i.length);for(let f of c)i.push(f)}}static asList(i){let r=new M;for(let c of i)r.add(c);return r}static copyOf(i,r){return i.slice(0,r)}}class tt extends Q{constructor(){super(),tt.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){let i=arguments[0],r=arguments[1];if(Q.constructor_.call(this,r),i===null&&(i=[]),Q.hasNullElements(i))throw new s("geometries must not contain null elements");this._geometries=i}}}computeEnvelopeInternal(){let i=new K;for(let r=0;r<this._geometries.length;r++)i.expandToInclude(this._geometries[r].getEnvelopeInternal());return i}getGeometryN(i){return this._geometries[i]}getCoordinates(){let i=new Array(this.getNumPoints()).fill(null),r=-1;for(let c=0;c<this._geometries.length;c++){let f=this._geometries[c].getCoordinates();for(let g=0;g<f.length;g++)r++,i[r]=f[g]}return i}getArea(){let i=0;for(let r=0;r<this._geometries.length;r++)i+=this._geometries[r].getArea();return i}copyInternal(){let i=new Array(this._geometries.length).fill(null);for(let r=0;r<i.length;r++)i[r]=this._geometries[r].copy();return new tt(i,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];if(!this.isEquivalentClass(i))return!1;let c=i;if(this._geometries.length!==c._geometries.length)return!1;for(let f=0;f<this._geometries.length;f++)if(!this._geometries[f].equalsExact(c._geometries[f],r))return!1;return!0}return super.equalsExact.apply(this,arguments)}reverseInternal(){let i=this._geometries.length,r=new M(i);for(let c=0;c<i;c++)r.add(this._geometries[c].reverse());return this.getFactory().buildGeometry(r)}getTypeCode(){return Q.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let i=C.FALSE;for(let r=0;r<this._geometries.length;r++)i=Math.max(i,this._geometries[r].getDimension());return i}getNumGeometries(){return this._geometries.length}getBoundary(){return Q.checkNotGeometryCollection(this),d.shouldNeverReachHere(),null}getGeometryType(){return Q.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let i=0;i<this._geometries.length;i++)if(!this._geometries[i].isEmpty())return!1;return!0}normalize(){for(let i=0;i<this._geometries.length;i++)this._geometries[i].normalize();Hn.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let i=C.FALSE;for(let r=0;r<this._geometries.length;r++)i=Math.max(i,this._geometries[r].getBoundaryDimension());return i}getLength(){let i=0;for(let r=0;r<this._geometries.length;r++)i+=this._geometries[r].getLength();return i}getNumPoints(){let i=0;for(let r=0;r<this._geometries.length;r++)i+=this._geometries[r].getNumPoints();return i}compareToSameClass(){if(arguments.length===1){let i=arguments[0],r=new Xe(Hn.asList(this._geometries)),c=new Xe(Hn.asList(i._geometries));return this.compare(r,c)}if(arguments.length===2){let i=arguments[1],r=arguments[0],c=this.getNumGeometries(),f=r.getNumGeometries(),g=0;for(;g<c&&g<f;){let y=this.getGeometryN(g),S=r.getGeometryN(g),I=y.compareToSameClass(S,i);if(I!==0)return I;g++}return g<c?1:g<f?-1:0}}apply(){if(P(arguments[0],ge)){let i=arguments[0];for(let r=0;r<this._geometries.length;r++)this._geometries[r].apply(i)}else if(P(arguments[0],X)){let i=arguments[0];if(this._geometries.length===0)return null;for(let r=0;r<this._geometries.length&&(this._geometries[r].apply(i),!i.isDone());r++);i.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],O)){let i=arguments[0];i.filter(this);for(let r=0;r<this._geometries.length;r++)this._geometries[r].apply(i)}else if(P(arguments[0],Pe)){let i=arguments[0];i.filter(this);for(let r=0;r<this._geometries.length;r++)this._geometries[r].apply(i)}}}class Jn{}class at extends tt{constructor(){super(),at.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];tt.constructor_.call(this,i,r)}copyInternal(){let i=new Array(this._geometries.length).fill(null);for(let r=0;r<i.length;r++)i[r]=this._geometries[r].copy();return new at(i,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];return!!this.isEquivalentClass(i)&&super.equalsExact.call(this,i,r)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return Q.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();let i=new M;for(let c=0;c<this._geometries.length;c++){let f=this._geometries[c].getBoundary();for(let g=0;g<f.getNumGeometries();g++)i.add(f.getGeometryN(g))}let r=new Array(i.size()).fill(null);return this.getFactory().createMultiLineString(i.toArray(r))}getGeometryType(){return Q.TYPENAME_MULTIPOLYGON}get interfaces_(){return[Jn]}}let Js=class{get(){}put(){}size(){}values(){}entrySet(){}};class xn extends Ae{constructor(i){super(),this.map=new Map,i instanceof j&&this.addAll(i)}contains(i){let r=i.hashCode?i.hashCode():i;return!!this.map.has(r)}add(i){let r=i.hashCode?i.hashCode():i;return!this.map.has(r)&&!!this.map.set(r,i)}addAll(i){for(let r of i)this.add(r);return!0}remove(){throw new Je}size(){return this.map.size}isEmpty(){return this.map.size===0}toArray(){return Array.from(this.map.values())}iterator(){return new Ci(this.map)}[Symbol.iterator](){return this.map}}let Ci=class{constructor(A){this.iterator=A.values();let{done:i,value:r}=this.iterator.next();this.done=i,this.value=r}next(){if(this.done)throw new se;let A=this.value,{done:i,value:r}=this.iterator.next();return this.done=i,this.value=r,A}hasNext(){return!this.done}remove(){throw new Je}};class _s extends Js{constructor(){super(),this.map=new Map}get(i){return this.map.get(i)||null}put(i,r){return this.map.set(i,r),r}values(){let i=new M,r=this.map.values(),c=r.next();for(;!c.done;)i.add(c.value),c=r.next();return i}entrySet(){let i=new xn;return this.map.entries().forEach(r=>i.add(r)),i}size(){return this.map.size()}}class St{constructor(){St.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=St.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ii){let i=arguments[0];this._modelType=i,i===St.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){let i=arguments[0];this._modelType=St.FIXED,this.setScale(i)}else if(arguments[0]instanceof St){let i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}}}static mostPrecise(i,r){return i.compareTo(r)>=0?i:r}equals(i){if(!(i instanceof St))return!1;let r=i;return this._modelType===r._modelType&&this._scale===r._scale}compareTo(i){let r=i,c=this.getMaximumSignificantDigits(),f=r.getMaximumSignificantDigits();return Ge.compare(c,f)}getType(){return this._modelType}toString(){let i="UNKNOWN";return this._modelType===St.FLOATING?i="Floating":this._modelType===St.FLOATING_SINGLE?i="Floating-Single":this._modelType===St.FIXED&&(i="Fixed (Scale="+this.getScale()+")"),i}makePrecise(){if(typeof arguments[0]=="number"){let i=arguments[0];return l.isNaN(i)||this._modelType===St.FLOATING_SINGLE?i:this._modelType===St.FIXED?Math.round(i*this._scale)/this._scale:i}if(arguments[0]instanceof w){let i=arguments[0];if(this._modelType===St.FLOATING)return null;i.x=this.makePrecise(i.x),i.y=this.makePrecise(i.y)}}getMaximumSignificantDigits(){let i=16;return this._modelType===St.FLOATING?i=16:this._modelType===St.FLOATING_SINGLE?i=6:this._modelType===St.FIXED&&(i=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),i}setScale(i){this._scale=Math.abs(i)}getScale(){return this._scale}isFloating(){return this._modelType===St.FLOATING||this._modelType===St.FLOATING_SINGLE}get interfaces_(){return[u,a]}}class Ii{constructor(){Ii.constructor_.apply(this,arguments)}static constructor_(){this._name=null;let i=arguments[0];this._name=i,Ii.nameToTypeMap.put(i,this)}readResolve(){return Ii.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[u]}}Ii.nameToTypeMap=new _s,St.Type=Ii,St.FIXED=new Ii("FIXED"),St.FLOATING=new Ii("FLOATING"),St.FLOATING_SINGLE=new Ii("FLOATING SINGLE"),St.maximumPreciseValue=9007199254740992;class _n extends tt{constructor(){super(),_n.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];tt.constructor_.call(this,i,r)}copyInternal(){let i=new Array(this._geometries.length).fill(null);for(let r=0;r<i.length;r++)i[r]=this._geometries[r].copy();return new _n(i,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];return!!this.isEquivalentClass(i)&&super.equalsExact.call(this,i,r)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?C.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let i=0;i<this._geometries.length;i++)if(!this._geometries[i].isClosed())return!1;return!0}getTypeCode(){return Q.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new Je}getGeometryType(){return Q.TYPENAME_MULTILINESTRING}get interfaces_(){return[N]}}class vo{}class yt extends Q{constructor(){super(),yt.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;let i=arguments[0],r=arguments[1];Q.constructor_.call(this,r),this.init(i)}computeEnvelopeInternal(){if(this.isEmpty())return new K;let i=new K;return i.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),i}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new yt(this._coordinates.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];return!!this.isEquivalentClass(i)&&(!(!this.isEmpty()||!i.isEmpty())||this.isEmpty()===i.isEmpty()&&this.equal(i.getCoordinate(),this.getCoordinate(),r))}return super.equalsExact.apply(this,arguments)}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return Q.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(this.getCoordinate()===null)throw new Re("getX called on empty Point");return this.getCoordinate().x}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return Q.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(this.getCoordinate()===null)throw new Re("getY called on empty Point");return this.getCoordinate().y}isSimple(){return!0}normalize(){}getCoordinate(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return C.FALSE}compareToSameClass(){if(arguments.length===1){let i=arguments[0];return this.getCoordinate().compareTo(i.getCoordinate())}if(arguments.length===2){let i=arguments[0];return arguments[1].compare(this._coordinates,i._coordinates)}}apply(){if(P(arguments[0],ge)){let i=arguments[0];if(this.isEmpty())return null;i.filter(this.getCoordinate())}else if(P(arguments[0],X)){let i=arguments[0];if(this.isEmpty())return null;i.filter(this._coordinates,0),i.isGeometryChanged()&&this.geometryChanged()}else P(arguments[0],O)?arguments[0].filter(this):P(arguments[0],Pe)&&arguments[0].filter(this)}isEmpty(){return this._coordinates.size()===0}init(i){i===null&&(i=this.getFactory().getCoordinateSequenceFactory().create([])),d.isTrue(i.size()<=1),this._coordinates=i}get interfaces_(){return[vo]}}class Tn{static ofRingSigned(){if(arguments[0]instanceof Array){let i=arguments[0];if(i.length<3)return 0;let r=0,c=i[0].x;for(let f=1;f<i.length-1;f++){let g=i[f].x-c,y=i[f+1].y;r+=g*(i[f-1].y-y)}return r/2}if(P(arguments[0],we)){let i=arguments[0],r=i.size();if(r<3)return 0;let c=new w,f=new w,g=new w;i.getCoordinate(0,f),i.getCoordinate(1,g);let y=f.x;g.x-=y;let S=0;for(let I=1;I<r-1;I++)c.y=f.y,f.x=g.x,f.y=g.y,i.getCoordinate(I+1,g),g.x-=y,S+=f.x*(c.y-g.y);return S/2}}static ofRing(){if(arguments[0]instanceof Array){let i=arguments[0];return Math.abs(Tn.ofRingSigned(i))}if(P(arguments[0],we)){let i=arguments[0];return Math.abs(Tn.ofRingSigned(i))}}}class Et extends Q{constructor(){super(),Et.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let i=arguments[0],r=arguments[1],c=arguments[2];if(Q.constructor_.call(this,c),i===null&&(i=this.getFactory().createLinearRing()),r===null&&(r=[]),Q.hasNullElements(r))throw new s("holes must not contain null elements");if(i.isEmpty()&&Q.hasNonEmptyElements(r))throw new s("shell is empty but holes are not");this._shell=i,this._holes=r}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];let i=new Array(this.getNumPoints()).fill(null),r=-1,c=this._shell.getCoordinates();for(let f=0;f<c.length;f++)r++,i[r]=c[f];for(let f=0;f<this._holes.length;f++){let g=this._holes[f].getCoordinates();for(let y=0;y<g.length;y++)r++,i[r]=g[y]}return i}getArea(){let i=0;i+=Tn.ofRing(this._shell.getCoordinateSequence());for(let r=0;r<this._holes.length;r++)i-=Tn.ofRing(this._holes[r].getCoordinateSequence());return i}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];if(!this.isEquivalentClass(i))return!1;let c=i,f=this._shell,g=c._shell;if(!f.equalsExact(g,r)||this._holes.length!==c._holes.length)return!1;for(let y=0;y<this._holes.length;y++)if(!this._holes[y].equalsExact(c._holes[y],r))return!1;return!0}return super.equalsExact.apply(this,arguments)}reverseInternal(){let i=this.getExteriorRing().reverse(),r=new Array(this.getNumInteriorRing()).fill(null);for(let c=0;c<r.length;c++)r[c]=this.getInteriorRingN(c).reverse();return this.getFactory().createPolygon(i,r)}getTypeCode(){return Q.TYPECODE_POLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();let i=new Array(this._holes.length+1).fill(null);i[0]=this._shell;for(let r=0;r<this._holes.length;r++)i[r+1]=this._holes[r];return i.length<=1?this.getFactory().createLinearRing(i[0].getCoordinateSequence()):this.getFactory().createMultiLineString(i)}getGeometryType(){return Q.TYPENAME_POLYGON}getExteriorRing(){return this._shell}copyInternal(){let i=this._shell.copy(),r=new Array(this._holes.length).fill(null);for(let c=0;c<this._holes.length;c++)r[c]=this._holes[c].copy();return new Et(i,r,this._factory)}isRectangle(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;let i=this._shell.getCoordinateSequence(),r=this.getEnvelopeInternal();for(let g=0;g<5;g++){let y=i.getX(g);if(y!==r.getMinX()&&y!==r.getMaxX())return!1;let S=i.getY(g);if(S!==r.getMinY()&&S!==r.getMaxY())return!1}let c=i.getX(0),f=i.getY(0);for(let g=1;g<=4;g++){let y=i.getX(g),S=i.getY(g);if(y!==c==(S!==f))return!1;c=y,f=S}return!0}normalize(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(let i=0;i<this._holes.length;i++)this._holes[i]=this.normalized(this._holes[i],!1);Hn.sort(this._holes)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];if(i.isEmpty())return null;let c=i.getCoordinateSequence(),f=k.minCoordinateIndex(c,0,c.size()-2);k.scroll(c,f,!0),pe.isCCW(c)===r&&k.reverse(c)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getLength(){let i=0;i+=this._shell.getLength();for(let r=0;r<this._holes.length;r++)i+=this._holes[r].getLength();return i}getNumPoints(){let i=this._shell.getNumPoints();for(let r=0;r<this._holes.length;r++)i+=this._holes[r].getNumPoints();return i}convexHull(){return this.getExteriorRing().convexHull()}normalized(i,r){let c=i.copy();return this.normalize(c,r),c}compareToSameClass(){if(arguments.length===1){let i=arguments[0],r=this._shell,c=i._shell;return r.compareToSameClass(c)}if(arguments.length===2){let i=arguments[1],r=arguments[0],c=this._shell,f=r._shell,g=c.compareToSameClass(f,i);if(g!==0)return g;let y=this.getNumInteriorRing(),S=r.getNumInteriorRing(),I=0;for(;I<y&&I<S;){let z=this.getInteriorRingN(I),ne=r.getInteriorRingN(I),he=z.compareToSameClass(ne,i);if(he!==0)return he;I++}return I<y?1:I<S?-1:0}}apply(){if(P(arguments[0],ge)){let i=arguments[0];this._shell.apply(i);for(let r=0;r<this._holes.length;r++)this._holes[r].apply(i)}else if(P(arguments[0],X)){let i=arguments[0];if(this._shell.apply(i),!i.isDone())for(let r=0;r<this._holes.length&&(this._holes[r].apply(i),!i.isDone());r++);i.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],O))arguments[0].filter(this);else if(P(arguments[0],Pe)){let i=arguments[0];i.filter(this),this._shell.apply(i);for(let r=0;r<this._holes.length;r++)this._holes[r].apply(i)}}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(i){return this._holes[i]}get interfaces_(){return[Jn]}}class Li extends tt{constructor(){super(),Li.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];tt.constructor_.call(this,i,r)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Q){let i=arguments[0],r=arguments[1];return!!this.isEquivalentClass(i)&&super.equalsExact.call(this,i,r)}return super.equalsExact.apply(this,arguments)}getTypeCode(){return Q.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return Q.TYPENAME_MULTIPOINT}copyInternal(){let i=new Array(this._geometries.length).fill(null);for(let r=0;r<i.length;r++)i[r]=this._geometries[r].copy();return new Li(i,this._factory)}isValid(){return!0}getCoordinate(){if(arguments.length===1&&Number.isInteger(arguments[0])){let i=arguments[0];return this._geometries[i].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return C.FALSE}get interfaces_(){return[vo]}}class vt{constructor(){vt.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)vt.constructor_.call(this,new St,0);else if(arguments.length===1){if(P(arguments[0],J)){let i=arguments[0];vt.constructor_.call(this,new St,0,i)}else if(arguments[0]instanceof St){let i=arguments[0];vt.constructor_.call(this,i,0,vt.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];vt.constructor_.call(this,i,r,vt.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._precisionModel=i,this._coordinateSequenceFactory=c,this._SRID=r}}static toMultiPolygonArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static toGeometryArray(i){if(i===null)return null;let r=new Array(i.size()).fill(null);return i.toArray(r)}static getDefaultCoordinateSequenceFactory(){return me.instance()}static toMultiLineStringArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static toLineStringArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static toMultiPointArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static toLinearRingArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static toPointArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static toPolygonArray(i){let r=new Array(i.size()).fill(null);return i.toArray(r)}static createPointFromInternalCoord(i,r){return r.getPrecisionModel().makePrecise(i),r.getFactory().createPoint(i)}createEmpty(i){switch(i){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new s("Invalid dimension: "+i)}}toGeometry(i){return i.isNull()?this.createPoint():i.getMinX()===i.getMaxX()&&i.getMinY()===i.getMaxY()?this.createPoint(new w(i.getMinX(),i.getMinY())):i.getMinX()===i.getMaxX()||i.getMinY()===i.getMaxY()?this.createLineString([new w(i.getMinX(),i.getMinY()),new w(i.getMaxX(),i.getMaxY())]):this.createPolygon(this.createLinearRing([new w(i.getMinX(),i.getMinY()),new w(i.getMinX(),i.getMaxY()),new w(i.getMaxX(),i.getMaxY()),new w(i.getMaxX(),i.getMinY()),new w(i.getMinX(),i.getMinY())]),null)}createLineString(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){let i=arguments[0];return this.createLineString(i!==null?this.getCoordinateSequenceFactory().create(i):null)}if(P(arguments[0],we))return new Z(arguments[0],this)}}createMultiLineString(){if(arguments.length===0)return new _n(null,this);if(arguments.length===1)return new _n(arguments[0],this)}createPolygon(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(P(arguments[0],we)){let i=arguments[0];return this.createPolygon(this.createLinearRing(i))}if(arguments[0]instanceof Array){let i=arguments[0];return this.createPolygon(this.createLinearRing(i))}if(arguments[0]instanceof ae){let i=arguments[0];return this.createPolygon(i,null)}}else if(arguments.length===2)return new Et(arguments[0],arguments[1],this)}getSRID(){return this._SRID}createGeometryCollection(){if(arguments.length===0)return new tt(null,this);if(arguments.length===1)return new tt(arguments[0],this)}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){let i=arguments[0];return this.createLinearRing(i!==null?this.getCoordinateSequenceFactory().create(i):null)}if(P(arguments[0],we))return new ae(arguments[0],this)}}createMultiPolygon(){if(arguments.length===0)return new at(null,this);if(arguments.length===1)return new at(arguments[0],this)}createMultiPoint(){if(arguments.length===0)return new Li(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Li(arguments[0],this);if(P(arguments[0],we)){let i=arguments[0];if(i===null)return this.createMultiPoint(new Array(0).fill(null));let r=new Array(i.size()).fill(null);for(let c=0;c<i.size();c++){let f=this.getCoordinateSequenceFactory().create(1,i.getDimension(),i.getMeasures());k.copy(i,c,f,0,1),r[c]=this.createPoint(f)}return this.createMultiPoint(r)}}}buildGeometry(i){let r=null,c=!1,f=!1;for(let y=i.iterator();y.hasNext();){let S=y.next(),I=S.getTypeCode();r===null&&(r=I),I!==r&&(c=!0),S instanceof tt&&(f=!0)}if(r===null)return this.createGeometryCollection();if(c||f)return this.createGeometryCollection(vt.toGeometryArray(i));let g=i.iterator().next();if(i.size()>1){if(g instanceof Et)return this.createMultiPolygon(vt.toPolygonArray(i));if(g instanceof Z)return this.createMultiLineString(vt.toLineStringArray(i));if(g instanceof yt)return this.createMultiPoint(vt.toPointArray(i));d.shouldNeverReachHere("Unhandled geometry type: "+g.getGeometryType())}return g}createMultiPointFromCoords(i){return this.createMultiPoint(i!==null?this.getCoordinateSequenceFactory().create(i):null)}createPoint(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof w){let i=arguments[0];return this.createPoint(i!==null?this.getCoordinateSequenceFactory().create([i]):null)}if(P(arguments[0],we))return new yt(arguments[0],this)}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}get interfaces_(){return[u]}}let Cu="XY",O_="XYZ",P_="XYM",F_="XYZM",Kh={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Jh="EMPTY",Cl=1,Fs=2,er=3,ef=4,Ir=5,D_=6;for(let A in Kh)Kh[A].toUpperCase();class G_{constructor(i){this.wkt=i,this.index_=-1}isAlpha_(i){return i>="a"&&i<="z"||i>="A"&&i<="Z"}isNumeric_(i,r){return i>="0"&&i<="9"||i=="."&&!(r!==void 0&&r)}isWhiteSpace_(i){return i==" "||i=="	"||i=="\r"||i==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){let i=this.nextChar_(),r=this.index_,c,f=i;if(i=="(")c=Fs;else if(i==",")c=Ir;else if(i==")")c=er;else if(this.isNumeric_(i)||i=="-")c=ef,f=this.readNumber_();else if(this.isAlpha_(i))c=Cl,f=this.readText_();else{if(this.isWhiteSpace_(i))return this.nextToken();if(i!=="")throw new Error("Unexpected character: "+i);c=D_}return{position:r,value:f,type:c}}readNumber_(){let i,r=this.index_,c=!1,f=!1;do i=="."?c=!0:i!="e"&&i!="E"||(f=!0),i=this.nextChar_();while(this.isNumeric_(i,c)||!f&&(i=="e"||i=="E")||f&&(i=="-"||i=="+"));return parseFloat(this.wkt.substring(r,this.index_--))}readText_(){let i,r=this.index_;do i=this.nextChar_();while(this.isAlpha_(i));return this.wkt.substring(r,this.index_--).toUpperCase()}}class j_{constructor(i,r){this.lexer_=i,this.token_,this.layout_=Cu,this.factory=r}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(i){return this.token_.type==i}match(i){let r=this.isTokenType(i);return r&&this.consume_(),r}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let i=Cu,r=this.token_;if(this.isTokenType(Cl)){let c=r.value;c==="Z"?i=O_:c==="M"?i=P_:c==="ZM"&&(i=F_),i!==Cu&&this.consume_()}return i}parseGeometryCollectionText_(){if(this.match(Fs)){let i=[];do i.push(this.parseGeometry_());while(this.match(Ir));if(this.match(er))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(Fs)){let i=this.parsePoint_();if(this.match(er))return i}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(Fs)){let i=this.parsePointList_();if(this.match(er))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(Fs)){let i=this.parseLineStringTextList_();if(this.match(er))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(Fs)){let i;if(i=this.token_.type==Fs?this.parsePointTextList_():this.parsePointList_(),this.match(er))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(Fs)){let i=this.parseLineStringTextList_();if(this.match(er))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(Fs)){let i=this.parsePolygonTextList_();if(this.match(er))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePoint_(){let i=[],r=this.layout_.length;for(let c=0;c<r;++c){let f=this.token_;if(!this.match(ef))break;i.push(f.value)}if(i.length==r)return i;throw new Error(this.formatErrorMessage_())}parsePointList_(){let i=[this.parsePoint_()];for(;this.match(Ir);)i.push(this.parsePoint_());return i}parsePointTextList_(){let i=[this.parsePointText_()];for(;this.match(Ir);)i.push(this.parsePointText_());return i}parseLineStringTextList_(){let i=[this.parseLineStringText_()];for(;this.match(Ir);)i.push(this.parseLineStringText_());return i}parsePolygonTextList_(){let i=[this.parsePolygonText_()];for(;this.match(Ir);)i.push(this.parsePolygonText_());return i}isEmptyGeometry_(){let i=this.isTokenType(Cl)&&this.token_.value==Jh;return i&&this.consume_(),i}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){let i=this.factory,r=g=>g?new w(...g):new w,c=g=>{let y=g.map(S=>i.createLinearRing(S.map(r)));return y.length>1?i.createPolygon(y[0],y.slice(1)):y.length===1?i.createPolygon(y[0]):i.createPolygon()},f=this.token_;if(this.match(Cl)){let g=f.value;if(this.layout_=this.parseGeometryLayout_(),g=="GEOMETRYCOLLECTION"){let y=this.parseGeometryCollectionText_();return i.createGeometryCollection(y)}switch(g){case"POINT":{let y=this.parsePointText_();return y?i.createPoint(new w(...y)):i.createPoint()}case"LINESTRING":{let y=this.parseLineStringText_().map(r);return i.createLineString(y)}case"LINEARRING":{let y=this.parseLineStringText_().map(r);return i.createLinearRing(y)}case"POLYGON":{let y=this.parsePolygonText_();return y&&y.length!==0?c(y):i.createPolygon()}case"MULTIPOINT":{let y=this.parseMultiPointText_();if(!y||y.length===0)return i.createMultiPoint();let S=y.map(r).map(I=>i.createPoint(I));return i.createMultiPoint(S)}case"MULTILINESTRING":{let y=this.parseMultiLineStringText_().map(S=>i.createLineString(S.map(r)));return i.createMultiLineString(y)}case"MULTIPOLYGON":{let y=this.parseMultiPolygonText_();if(!y||y.length===0)return i.createMultiPolygon();let S=y.map(c);return i.createMultiPolygon(S)}default:throw new Error("Invalid geometry type: "+g)}}throw new Error(this.formatErrorMessage_())}}function tf(A){if(A.isEmpty())return"";let i=A.getCoordinate(),r=[i.x,i.y];return i.z===void 0||Number.isNaN(i.z)||r.push(i.z),i.m===void 0||Number.isNaN(i.m)||r.push(i.m),r.join(" ")}function xa(A){let i=A.getCoordinates().map(c=>{let f=[c.x,c.y];return c.z===void 0||Number.isNaN(c.z)||f.push(c.z),c.m===void 0||Number.isNaN(c.m)||f.push(c.m),f}),r=[];for(let c=0,f=i.length;c<f;++c)r.push(i[c].join(" "));return r.join(", ")}function nf(A){let i=[];i.push("("+xa(A.getExteriorRing())+")");for(let r=0,c=A.getNumInteriorRing();r<c;++r)i.push("("+xa(A.getInteriorRingN(r))+")");return i.join(", ")}let q_={Point:tf,LineString:xa,LinearRing:xa,Polygon:nf,MultiPoint:function(A){let i=[];for(let r=0,c=A.getNumGeometries();r<c;++r)i.push("("+tf(A.getGeometryN(r))+")");return i.join(", ")},MultiLineString:function(A){let i=[];for(let r=0,c=A.getNumGeometries();r<c;++r)i.push("("+xa(A.getGeometryN(r))+")");return i.join(", ")},MultiPolygon:function(A){let i=[];for(let r=0,c=A.getNumGeometries();r<c;++r)i.push("("+nf(A.getGeometryN(r))+")");return i.join(", ")},GeometryCollection:function(A){let i=[];for(let r=0,c=A.getNumGeometries();r<c;++r)i.push(sf(A.getGeometryN(r)));return i.join(", ")}};function sf(A){let i=A.getGeometryType(),r=q_[i];i=i.toUpperCase();let c=function(f){let g="";if(f.isEmpty())return g;let y=f.getCoordinate();return y.z===void 0||Number.isNaN(y.z)||(g+="Z"),y.m===void 0||Number.isNaN(y.m)||(g+="M"),g}(A);return c.length>0&&(i+=" "+c),A.isEmpty()?i+" "+Jh:i+" ("+r(A)+")"}class rf{constructor(i){this.geometryFactory=i||new vt,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(i){let r=new G_(i);return new j_(r,this.geometryFactory).parse()}write(i){return sf(i)}}class rn{constructor(i){this.parser=new rf(i)}write(i){return this.parser.write(i)}static toLineString(i,r){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+i.x+" "+i.y+", "+r.x+" "+r.y+" )"}}class Mt{constructor(){Mt.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new w,this._intPt[1]=new w,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static nonRobustComputeEdgeDistance(i,r,c){let f=i.x-r.x,g=i.y-r.y,y=Math.sqrt(f*f+g*g);return d.isTrue(!(y===0&&!i.equals(r)),"Invalid distance calculation"),y}static computeEdgeDistance(i,r,c){let f=Math.abs(c.x-r.x),g=Math.abs(c.y-r.y),y=-1;if(i.equals(r))y=0;else if(i.equals(c))y=f>g?f:g;else{let S=Math.abs(i.x-r.x),I=Math.abs(i.y-r.y);y=f>g?S:I,y!==0||i.equals(r)||(y=Math.max(S,I))}return d.isTrue(!(y===0&&!i.equals(r)),"Bad distance calculation"),y}computeIntersection(i,r,c,f){this._inputLines[0][0]=i,this._inputLines[0][1]=r,this._inputLines[1][0]=c,this._inputLines[1][1]=f,this._result=this.computeIntersect(i,r,c,f)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){let i=arguments[0];this.getEdgeDistance(i,0)>this.getEdgeDistance(i,1)?(this._intLineIndex[i][0]=0,this._intLineIndex[i][1]=1):(this._intLineIndex[i][0]=1,this._intLineIndex[i][1]=0)}}isInteriorIntersection(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){let i=arguments[0];for(let r=0;r<this._result;r++)if(!this._intPt[r].equals2D(this._inputLines[i][0])&&!this._intPt[r].equals2D(this._inputLines[i][1]))return!0;return!1}}getIntersection(i){return this._intPt[i]}getEdgeDistance(i,r){return Mt.computeEdgeDistance(this._intPt[r],this._inputLines[i][0],this._inputLines[i][1])}isCollinear(){return this._result===Mt.COLLINEAR_INTERSECTION}toString(){return rn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+rn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(i,r){return this._inputLines[i][r]}getIndexAlongSegment(i,r){return this.computeIntLineIndex(),this._intLineIndex[i][r]}getTopologySummary(){let i=new re;return this.isEndPoint()&&i.append(" endpoint"),this._isProper&&i.append(" proper"),this.isCollinear()&&i.append(" collinear"),i.toString()}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(i){this._precisionModel=i}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==Mt.NO_INTERSECTION}isIntersection(i){for(let r=0;r<this._result;r++)if(this._intPt[r].equals2D(i))return!0;return!1}getIntersectionAlongSegment(i,r){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[i][r]]}}Mt.DONT_INTERSECT=0,Mt.DO_INTERSECT=1,Mt.COLLINEAR=2,Mt.NO_INTERSECTION=0,Mt.POINT_INTERSECTION=1,Mt.COLLINEAR_INTERSECTION=2;class wn extends Mt{constructor(){super()}static nearestEndpoint(i,r,c,f){let g=i,y=qe.pointToSegment(i,c,f),S=qe.pointToSegment(r,c,f);return S<y&&(y=S,g=r),S=qe.pointToSegment(c,i,r),S<y&&(y=S,g=c),S=qe.pointToSegment(f,i,r),S<y&&(y=S,g=f),g}isInSegmentEnvelopes(i){let r=new K(this._inputLines[0][0],this._inputLines[0][1]),c=new K(this._inputLines[1][0],this._inputLines[1][1]);return r.contains(i)&&c.contains(i)}computeIntersection(){if(arguments.length!==3)return super.computeIntersection.apply(this,arguments);{let i=arguments[0],r=arguments[1],c=arguments[2];if(this._isProper=!1,K.intersects(r,c,i)&&pe.index(r,c,i)===0&&pe.index(c,r,i)===0)return this._isProper=!0,(i.equals(r)||i.equals(c))&&(this._isProper=!1),this._result=Mt.POINT_INTERSECTION,null;this._result=Mt.NO_INTERSECTION}}intersection(i,r,c,f){let g=this.intersectionSafe(i,r,c,f);return this.isInSegmentEnvelopes(g)||(g=new w(wn.nearestEndpoint(i,r,c,f))),this._precisionModel!==null&&this._precisionModel.makePrecise(g),g}checkDD(i,r,c,f,g){let y=ce.intersection(i,r,c,f),S=this.isInSegmentEnvelopes(y);Fe.out.println("DD in env = "+S+"  --------------------- "+y),g.distance(y)>1e-4&&Fe.out.println("Distance = "+g.distance(y))}intersectionSafe(i,r,c,f){let g=Ee.intersection(i,r,c,f);return g===null&&(g=wn.nearestEndpoint(i,r,c,f)),g}computeCollinearIntersection(i,r,c,f){let g=K.intersects(i,r,c),y=K.intersects(i,r,f),S=K.intersects(c,f,i),I=K.intersects(c,f,r);return g&&y?(this._intPt[0]=c,this._intPt[1]=f,Mt.COLLINEAR_INTERSECTION):S&&I?(this._intPt[0]=i,this._intPt[1]=r,Mt.COLLINEAR_INTERSECTION):g&&S?(this._intPt[0]=c,this._intPt[1]=i,!c.equals(i)||y||I?Mt.COLLINEAR_INTERSECTION:Mt.POINT_INTERSECTION):g&&I?(this._intPt[0]=c,this._intPt[1]=r,!c.equals(r)||y||S?Mt.COLLINEAR_INTERSECTION:Mt.POINT_INTERSECTION):y&&S?(this._intPt[0]=f,this._intPt[1]=i,!f.equals(i)||g||I?Mt.COLLINEAR_INTERSECTION:Mt.POINT_INTERSECTION):y&&I?(this._intPt[0]=f,this._intPt[1]=r,!f.equals(r)||g||S?Mt.COLLINEAR_INTERSECTION:Mt.POINT_INTERSECTION):Mt.NO_INTERSECTION}computeIntersect(i,r,c,f){if(this._isProper=!1,!K.intersects(i,r,c,f))return Mt.NO_INTERSECTION;let g=pe.index(i,r,c),y=pe.index(i,r,f);if(g>0&&y>0||g<0&&y<0)return Mt.NO_INTERSECTION;let S=pe.index(c,f,i),I=pe.index(c,f,r);return S>0&&I>0||S<0&&I<0?Mt.NO_INTERSECTION:g===0&&y===0&&S===0&&I===0?this.computeCollinearIntersection(i,r,c,f):(g===0||y===0||S===0||I===0?(this._isProper=!1,i.equals2D(c)||i.equals2D(f)?this._intPt[0]=i:r.equals2D(c)||r.equals2D(f)?this._intPt[0]=r:g===0?this._intPt[0]=new w(c):y===0?this._intPt[0]=new w(f):S===0?this._intPt[0]=new w(i):I===0&&(this._intPt[0]=new w(r))):(this._isProper=!0,this._intPt[0]=this.intersection(i,r,c,f)),Mt.POINT_INTERSECTION)}}class Ze{constructor(){Ze.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,arguments.length===0)Ze.constructor_.call(this,new w,new w);else if(arguments.length===1){let i=arguments[0];Ze.constructor_.call(this,i.p0,i.p1)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.p0=i,this.p1=r}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];Ze.constructor_.call(this,new w(i,r),new w(c,f))}}static midPoint(i,r){return new w((i.x+r.x)/2,(i.y+r.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof Ze){let i=arguments[0],r=pe.index(this.p0,this.p1,i.p0),c=pe.index(this.p0,this.p1,i.p1);return r>=0&&c>=0||r<=0&&c<=0?Math.max(r,c):0}if(arguments[0]instanceof w){let i=arguments[0];return pe.index(this.p0,this.p1,i)}}toGeometry(i){return i.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return Ze.midPoint(this.p0,this.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(i,r){let c=this.p0.x+i*(this.p1.x-this.p0.x),f=this.p0.y+i*(this.p1.y-this.p0.y),g=this.p1.x-this.p0.x,y=this.p1.y-this.p0.y,S=Math.sqrt(g*g+y*y),I=0,z=0;if(r!==0){if(S<=0)throw new Re("Cannot compute offset from zero-length line segment");I=r*g/S,z=r*y/S}return new w(c-z,f+I)}setCoordinates(){if(arguments.length===1){let i=arguments[0];this.setCoordinates(i.p0,i.p1)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.p0.x=i.x,this.p0.y=i.y,this.p1.x=r.x,this.p1.y=r.y}}segmentFraction(i){let r=this.projectionFactor(i);return r<0?r=0:(r>1||l.isNaN(r))&&(r=1),r}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}distance(){if(arguments[0]instanceof Ze){let i=arguments[0];return qe.segmentToSegment(this.p0,this.p1,i.p0,i.p1)}if(arguments[0]instanceof w){let i=arguments[0];return qe.pointToSegment(i,this.p0,this.p1)}}equals(i){if(!(i instanceof Ze))return!1;let r=i;return this.p0.equals(r.p0)&&this.p1.equals(r.p1)}intersection(i){let r=new wn;return r.computeIntersection(this.p0,this.p1,i.p0,i.p1),r.hasIntersection()?r.getIntersection(0):null}project(){if(arguments[0]instanceof w){let i=arguments[0];if(i.equals(this.p0)||i.equals(this.p1))return new w(i);let r=this.projectionFactor(i),c=new w;return c.x=this.p0.x+r*(this.p1.x-this.p0.x),c.y=this.p0.y+r*(this.p1.y-this.p0.y),c}if(arguments[0]instanceof Ze){let i=arguments[0],r=this.projectionFactor(i.p0),c=this.projectionFactor(i.p1);if(r>=1&&c>=1||r<=0&&c<=0)return null;let f=this.project(i.p0);r<0&&(f=this.p0),r>1&&(f=this.p1);let g=this.project(i.p1);return c<0&&(g=this.p0),c>1&&(g=this.p1),new Ze(f,g)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(i){return i===0?this.p0:this.p1}distancePerpendicular(i){return qe.pointToLinePerpendicular(i,this.p0,this.p1)}closestPoint(i){let r=this.projectionFactor(i);return r>0&&r<1?this.project(i):this.p0.distance(i)<this.p1.distance(i)?this.p0:this.p1}projectionFactor(i){if(i.equals(this.p0))return 0;if(i.equals(this.p1))return 1;let r=this.p1.x-this.p0.x,c=this.p1.y-this.p0.y,f=r*r+c*c;return f<=0?l.NaN:((i.x-this.p0.x)*r+(i.y-this.p0.y)*c)/f}closestPoints(i){let r=this.intersection(i);if(r!==null)return[r,r];let c=new Array(2).fill(null),f=l.MAX_VALUE,g=null,y=this.closestPoint(i.p0);f=y.distance(i.p0),c[0]=y,c[1]=i.p0;let S=this.closestPoint(i.p1);g=S.distance(i.p1),g<f&&(f=g,c[0]=S,c[1]=i.p1);let I=i.closestPoint(this.p0);g=I.distance(this.p0),g<f&&(f=g,c[0]=this.p0,c[1]=I);let z=i.closestPoint(this.p1);return g=z.distance(this.p1),g<f&&(f=g,c[0]=this.p1,c[1]=z),c}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(i){let r=i,c=this.p0.compareTo(r.p0);return c!==0?c:this.p1.compareTo(r.p1)}reverse(){let i=this.p0;this.p0=this.p1,this.p1=i}equalsTopo(i){return this.p0.equals(i.p0)&&this.p1.equals(i.p1)||this.p0.equals(i.p1)&&this.p1.equals(i.p0)}lineIntersection(i){return Ee.intersection(this.p0,this.p1,i.p0,i.p1)}isHorizontal(){return this.p0.y===this.p1.y}reflect(i){let r=this.p1.getY()-this.p0.getY(),c=this.p0.getX()-this.p1.getX(),f=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),g=r*r+c*c,y=r*r-c*c,S=i.getX(),I=i.getY();return new w((-y*S-2*r*c*I-2*r*f)/g,(y*I-2*r*c*S-2*c*f)/g)}pointAlong(i){let r=new w;return r.x=this.p0.x+i*(this.p1.x-this.p0.x),r.y=this.p0.y+i*(this.p1.y-this.p0.y),r}hashCode(){let i=l.doubleToLongBits(this.p0.x);i^=31*l.doubleToLongBits(this.p0.y);let r=Math.trunc(i)^Math.trunc(i>>32),c=l.doubleToLongBits(this.p1.x);return c^=31*l.doubleToLongBits(this.p1.y),r^(Math.trunc(c)^Math.trunc(c>>32))}get interfaces_(){return[a,u]}}class B{static toLocationSymbol(i){switch(i){case B.EXTERIOR:return"e";case B.BOUNDARY:return"b";case B.INTERIOR:return"i";case B.NONE:return"-"}throw new s("Unknown location value: "+i)}}B.INTERIOR=0,B.BOUNDARY=1,B.EXTERIOR=2,B.NONE=-1;class Ct{constructor(){Ct.constructor_.apply(this,arguments)}static constructor_(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(()=>Array(3)),this.setAll(C.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){let i=arguments[0];Ct.constructor_.call(this),this.set(i)}else if(arguments[0]instanceof Ct){let i=arguments[0];Ct.constructor_.call(this),this._matrix[B.INTERIOR][B.INTERIOR]=i._matrix[B.INTERIOR][B.INTERIOR],this._matrix[B.INTERIOR][B.BOUNDARY]=i._matrix[B.INTERIOR][B.BOUNDARY],this._matrix[B.INTERIOR][B.EXTERIOR]=i._matrix[B.INTERIOR][B.EXTERIOR],this._matrix[B.BOUNDARY][B.INTERIOR]=i._matrix[B.BOUNDARY][B.INTERIOR],this._matrix[B.BOUNDARY][B.BOUNDARY]=i._matrix[B.BOUNDARY][B.BOUNDARY],this._matrix[B.BOUNDARY][B.EXTERIOR]=i._matrix[B.BOUNDARY][B.EXTERIOR],this._matrix[B.EXTERIOR][B.INTERIOR]=i._matrix[B.EXTERIOR][B.INTERIOR],this._matrix[B.EXTERIOR][B.BOUNDARY]=i._matrix[B.EXTERIOR][B.BOUNDARY],this._matrix[B.EXTERIOR][B.EXTERIOR]=i._matrix[B.EXTERIOR][B.EXTERIOR]}}}static isTrue(i){return i>=0||i===C.TRUE}static matches(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){let i=arguments[0],r=arguments[1];return r===C.SYM_DONTCARE||r===C.SYM_TRUE&&(i>=0||i===C.TRUE)||r===C.SYM_FALSE&&i===C.FALSE||r===C.SYM_P&&i===C.P||r===C.SYM_L&&i===C.L||r===C.SYM_A&&i===C.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){let i=arguments[1];return new Ct(arguments[0]).matches(i)}}isIntersects(){return!this.isDisjoint()}set(){if(arguments.length===1){let i=arguments[0];for(let r=0;r<i.length;r++){let c=Math.trunc(r/3),f=r%3;this._matrix[c][f]=C.toDimensionValue(i.charAt(r))}}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._matrix[i][r]=c}}isContains(){return Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])&&this._matrix[B.EXTERIOR][B.INTERIOR]===C.FALSE&&this._matrix[B.EXTERIOR][B.BOUNDARY]===C.FALSE}isWithin(){return Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])&&this._matrix[B.INTERIOR][B.EXTERIOR]===C.FALSE&&this._matrix[B.BOUNDARY][B.EXTERIOR]===C.FALSE}isTouches(i,r){return i>r?this.isTouches(r,i):(i===C.A&&r===C.A||i===C.L&&r===C.L||i===C.L&&r===C.A||i===C.P&&r===C.A||i===C.P&&r===C.L)&&this._matrix[B.INTERIOR][B.INTERIOR]===C.FALSE&&(Ct.isTrue(this._matrix[B.INTERIOR][B.BOUNDARY])||Ct.isTrue(this._matrix[B.BOUNDARY][B.INTERIOR])||Ct.isTrue(this._matrix[B.BOUNDARY][B.BOUNDARY]))}isOverlaps(i,r){return i===C.P&&r===C.P||i===C.A&&r===C.A?Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])&&Ct.isTrue(this._matrix[B.INTERIOR][B.EXTERIOR])&&Ct.isTrue(this._matrix[B.EXTERIOR][B.INTERIOR]):i===C.L&&r===C.L&&this._matrix[B.INTERIOR][B.INTERIOR]===1&&Ct.isTrue(this._matrix[B.INTERIOR][B.EXTERIOR])&&Ct.isTrue(this._matrix[B.EXTERIOR][B.INTERIOR])}isEquals(i,r){return i===r&&Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])&&this._matrix[B.INTERIOR][B.EXTERIOR]===C.FALSE&&this._matrix[B.BOUNDARY][B.EXTERIOR]===C.FALSE&&this._matrix[B.EXTERIOR][B.INTERIOR]===C.FALSE&&this._matrix[B.EXTERIOR][B.BOUNDARY]===C.FALSE}matches(i){if(i.length!==9)throw new s("Should be length 9: "+i);for(let r=0;r<3;r++)for(let c=0;c<3;c++)if(!Ct.matches(this._matrix[r][c],i.charAt(3*r+c)))return!1;return!0}add(i){for(let r=0;r<3;r++)for(let c=0;c<3;c++)this.setAtLeast(r,c,i.get(r,c))}isDisjoint(){return this._matrix[B.INTERIOR][B.INTERIOR]===C.FALSE&&this._matrix[B.INTERIOR][B.BOUNDARY]===C.FALSE&&this._matrix[B.BOUNDARY][B.INTERIOR]===C.FALSE&&this._matrix[B.BOUNDARY][B.BOUNDARY]===C.FALSE}isCrosses(i,r){return i===C.P&&r===C.L||i===C.P&&r===C.A||i===C.L&&r===C.A?Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])&&Ct.isTrue(this._matrix[B.INTERIOR][B.EXTERIOR]):i===C.L&&r===C.P||i===C.A&&r===C.P||i===C.A&&r===C.L?Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])&&Ct.isTrue(this._matrix[B.EXTERIOR][B.INTERIOR]):i===C.L&&r===C.L&&this._matrix[B.INTERIOR][B.INTERIOR]===0}isCovers(){return(Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])||Ct.isTrue(this._matrix[B.INTERIOR][B.BOUNDARY])||Ct.isTrue(this._matrix[B.BOUNDARY][B.INTERIOR])||Ct.isTrue(this._matrix[B.BOUNDARY][B.BOUNDARY]))&&this._matrix[B.EXTERIOR][B.INTERIOR]===C.FALSE&&this._matrix[B.EXTERIOR][B.BOUNDARY]===C.FALSE}isCoveredBy(){return(Ct.isTrue(this._matrix[B.INTERIOR][B.INTERIOR])||Ct.isTrue(this._matrix[B.INTERIOR][B.BOUNDARY])||Ct.isTrue(this._matrix[B.BOUNDARY][B.INTERIOR])||Ct.isTrue(this._matrix[B.BOUNDARY][B.BOUNDARY]))&&this._matrix[B.INTERIOR][B.EXTERIOR]===C.FALSE&&this._matrix[B.BOUNDARY][B.EXTERIOR]===C.FALSE}setAtLeast(){if(arguments.length===1){let i=arguments[0];for(let r=0;r<i.length;r++){let c=Math.trunc(r/3),f=r%3;this.setAtLeast(c,f,C.toDimensionValue(i.charAt(r)))}}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._matrix[i][r]<c&&(this._matrix[i][r]=c)}}setAtLeastIfValid(i,r,c){i>=0&&r>=0&&this.setAtLeast(i,r,c)}toString(){let i=new re("123456789");for(let r=0;r<3;r++)for(let c=0;c<3;c++)i.setCharAt(3*r+c,C.toDimensionSymbol(this._matrix[r][c]));return i.toString()}setAll(i){for(let r=0;r<3;r++)for(let c=0;c<3;c++)this._matrix[r][c]=i}get(i,r){return this._matrix[i][r]}transpose(){let i=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=i,i=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=i,i=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=i,this}get interfaces_(){return[_]}}class ct{static toDegrees(i){return 180*i/Math.PI}static isAcute(i,r,c){let f=i.x-r.x,g=i.y-r.y;return f*(c.x-r.x)+g*(c.y-r.y)>0}static isObtuse(i,r,c){let f=i.x-r.x,g=i.y-r.y;return f*(c.x-r.x)+g*(c.y-r.y)<0}static interiorAngle(i,r,c){let f=ct.angle(r,i),g=ct.angle(r,c);return Math.abs(g-f)}static normalizePositive(i){if(i<0){for(;i<0;)i+=ct.PI_TIMES_2;i>=ct.PI_TIMES_2&&(i=0)}else{for(;i>=ct.PI_TIMES_2;)i-=ct.PI_TIMES_2;i<0&&(i=0)}return i}static angleBetween(i,r,c){let f=ct.angle(r,i),g=ct.angle(r,c);return ct.diff(f,g)}static diff(i,r){let c=null;return c=i<r?r-i:i-r,c>Math.PI&&(c=2*Math.PI-c),c}static toRadians(i){return i*Math.PI/180}static normalize(i){for(;i>Math.PI;)i-=ct.PI_TIMES_2;for(;i<=-Math.PI;)i+=ct.PI_TIMES_2;return i}static angle(){if(arguments.length===1){let i=arguments[0];return Math.atan2(i.y,i.x)}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=r.x-i.x,f=r.y-i.y;return Math.atan2(f,c)}}static getTurn(i,r){let c=Math.sin(r-i);return c>0?ct.COUNTERCLOCKWISE:c<0?ct.CLOCKWISE:ct.NONE}static angleBetweenOriented(i,r,c){let f=ct.angle(r,i),g=ct.angle(r,c)-f;return g<=-Math.PI?g+ct.PI_TIMES_2:g>Math.PI?g-ct.PI_TIMES_2:g}}ct.PI_TIMES_2=2*Math.PI,ct.PI_OVER_2=Math.PI/2,ct.PI_OVER_4=Math.PI/4,ct.COUNTERCLOCKWISE=pe.COUNTERCLOCKWISE,ct.CLOCKWISE=pe.CLOCKWISE,ct.NONE=pe.COLLINEAR;class Ds extends n{constructor(){super(),Ds.constructor_.apply(this,arguments)}static constructor_(){n.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}class Ni{constructor(){Ni.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){let i=arguments[0];this.x=i.x,this.y=i.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1];this.x=i,this.y=r,this.w=1}else if(arguments[0]instanceof Ni&&arguments[1]instanceof Ni){let i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof w&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1];this.x=i.y-r.y,this.y=r.x-i.x,this.w=i.x*r.y-r.x*i.y}}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this.x=i,this.y=r,this.w=c}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=i.y-r.y,y=r.x-i.x,S=i.x*r.y-r.x*i.y,I=c.y-f.y,z=f.x-c.x,ne=c.x*f.y-f.x*c.y;this.x=y*ne-z*S,this.y=I*S-g*ne,this.w=g*z-I*y}}getCoordinate(){let i=new w;return i.x=this.getX(),i.y=this.getY(),i}getX(){let i=this.x/this.w;if(l.isNaN(i)||l.isInfinite(i))throw new Ds;return i}getY(){let i=this.y/this.w;if(l.isNaN(i)||l.isInfinite(i))throw new Ds;return i}}class Gt{constructor(){Gt.constructor_.apply(this,arguments)}static constructor_(){this.p0=null,this.p1=null,this.p2=null;let i=arguments[0],r=arguments[1],c=arguments[2];this.p0=i,this.p1=r,this.p2=c}static isAcute(i,r,c){return!!ct.isAcute(i,r,c)&&!!ct.isAcute(r,c,i)&&!!ct.isAcute(c,i,r)}static circumcentre(i,r,c){let f=c.x,g=c.y,y=i.x-f,S=i.y-g,I=r.x-f,z=r.y-g,ne=2*Gt.det(y,S,I,z),he=Gt.det(S,y*y+S*S,z,I*I+z*z),Ie=Gt.det(y,y*y+S*S,I,I*I+z*z);return new w(f-he/ne,g+Ie/ne)}static perpendicularBisector(i,r){let c=r.x-i.x,f=r.y-i.y,g=new Ni(i.x+c/2,i.y+f/2,1),y=new Ni(i.x-f+c/2,i.y+c+f/2,1);return new Ni(g,y)}static angleBisector(i,r,c){let f=r.distance(i),g=f/(f+r.distance(c)),y=c.x-i.x,S=c.y-i.y;return new w(i.x+g*y,i.y+g*S)}static inCentre(i,r,c){let f=r.distance(c),g=i.distance(c),y=i.distance(r),S=f+g+y,I=(f*i.x+g*r.x+y*c.x)/S,z=(f*i.y+g*r.y+y*c.y)/S;return new w(I,z)}static area(i,r,c){return Math.abs(((c.x-i.x)*(r.y-i.y)-(r.x-i.x)*(c.y-i.y))/2)}static signedArea(i,r,c){return((c.x-i.x)*(r.y-i.y)-(r.x-i.x)*(c.y-i.y))/2}static det(i,r,c,f){return i*f-r*c}static interpolateZ(i,r,c,f){let g=r.x,y=r.y,S=c.x-g,I=f.x-g,z=c.y-y,ne=f.y-y,he=S*ne-I*z,Ie=i.x-g,Oe=i.y-y,Ue=(ne*Ie-I*Oe)/he,ut=(-z*Ie+S*Oe)/he;return r.getZ()+Ue*(c.getZ()-r.getZ())+ut*(f.getZ()-r.getZ())}static longestSideLength(i,r,c){let f=i.distance(r),g=r.distance(c),y=c.distance(i),S=f;return g>S&&(S=g),y>S&&(S=y),S}static circumcentreDD(i,r,c){let f=U.valueOf(i.x).subtract(c.x),g=U.valueOf(i.y).subtract(c.y),y=U.valueOf(r.x).subtract(c.x),S=U.valueOf(r.y).subtract(c.y),I=U.determinant(f,g,y,S).multiply(2),z=f.sqr().add(g.sqr()),ne=y.sqr().add(S.sqr()),he=U.determinant(g,z,S,ne),Ie=U.determinant(f,z,y,ne),Oe=U.valueOf(c.x).subtract(he.divide(I)).doubleValue(),Ue=U.valueOf(c.y).add(Ie.divide(I)).doubleValue();return new w(Oe,Ue)}static area3D(i,r,c){let f=r.x-i.x,g=r.y-i.y,y=r.getZ()-i.getZ(),S=c.x-i.x,I=c.y-i.y,z=c.getZ()-i.getZ(),ne=g*z-y*I,he=y*S-f*z,Ie=f*I-g*S,Oe=ne*ne+he*he+Ie*Ie;return Math.sqrt(Oe)/2}static centroid(i,r,c){let f=(i.x+r.x+c.x)/3,g=(i.y+r.y+c.y)/3;return new w(f,g)}interpolateZ(i){if(i===null)throw new s("Supplied point is null.");return Gt.interpolateZ(i,this.p0,this.p1,this.p2)}longestSideLength(){return Gt.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return Gt.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return Gt.circumcentre(this.p0,this.p1,this.p2)}inCentre(){return Gt.inCentre(this.p0,this.p1,this.p2)}area(){return Gt.area(this.p0,this.p1,this.p2)}signedArea(){return Gt.signedArea(this.p0,this.p1,this.p2)}area3D(){return Gt.area3D(this.p0,this.p1,this.p2)}centroid(){return Gt.centroid(this.p0,this.p1,this.p2)}}class Iu extends n{constructor(){super(),Iu.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)n.constructor_.call(this);else if(arguments.length===1){let i=arguments[0];n.constructor_.call(this,i)}}}class bt{constructor(){bt.constructor_.apply(this,arguments)}static constructor_(){if(this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null,arguments.length===0)this.setToIdentity();else if(arguments.length===1){if(arguments[0]instanceof Array){let i=arguments[0];this._m00=i[0],this._m01=i[1],this._m02=i[2],this._m10=i[3],this._m11=i[4],this._m12=i[5]}else if(arguments[0]instanceof bt){let i=arguments[0];this.setTransformation(i)}}else if(arguments.length===6&&typeof arguments[5]=="number"&&typeof arguments[4]=="number"&&typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5];this.setTransformation(i,r,c,f,g,y)}}static translationInstance(i,r){let c=new bt;return c.setToTranslation(i,r),c}static shearInstance(i,r){let c=new bt;return c.setToShear(i,r),c}static reflectionInstance(){if(arguments.length===2){let i=arguments[0],r=arguments[1],c=new bt;return c.setToReflection(i,r),c}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=new bt;return g.setToReflection(i,r,c,f),g}}static rotationInstance(){if(arguments.length===1){let i=arguments[0];return bt.rotationInstance(Math.sin(i),Math.cos(i))}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=new bt;return c.setToRotation(i,r),c}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return bt.rotationInstance(Math.sin(i),Math.cos(i),r,c)}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=new bt;return g.setToRotation(i,r,c,f),g}}static scaleInstance(){if(arguments.length===2){let i=arguments[0],r=arguments[1],c=new bt;return c.setToScale(i,r),c}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=new bt;return g.translate(-c,-f),g.scale(i,r),g.translate(c,f),g}}setToReflectionBasic(i,r,c,f){if(i===c&&r===f)throw new s("Reflection line points must be distinct");let g=c-i,y=f-r,S=Math.sqrt(g*g+y*y),I=y/S,z=g/S,ne=2*I*z,he=z*z-I*I;return this._m00=he,this._m01=ne,this._m02=0,this._m10=ne,this._m11=-he,this._m12=0,this}setToRotation(){if(arguments.length===1){let i=arguments[0];return this.setToRotation(Math.sin(i),Math.cos(i)),this}if(arguments.length===2){let i=arguments[0],r=arguments[1];return this._m00=r,this._m01=-i,this._m02=0,this._m10=i,this._m11=r,this._m12=0,this}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return this.setToRotation(Math.sin(i),Math.cos(i),r,c),this}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];return this._m00=r,this._m01=-i,this._m02=c-c*r+f*i,this._m10=i,this._m11=r,this._m12=f-c*i-f*r,this}}getMatrixEntries(){return[this._m00,this._m01,this._m02,this._m10,this._m11,this._m12]}filter(i,r){this.transform(i,r)}composeBefore(i){let r=this._m00*i._m00+this._m01*i._m10,c=this._m00*i._m01+this._m01*i._m11,f=this._m00*i._m02+this._m01*i._m12+this._m02,g=this._m10*i._m00+this._m11*i._m10,y=this._m10*i._m01+this._m11*i._m11,S=this._m10*i._m02+this._m11*i._m12+this._m12;return this._m00=r,this._m01=c,this._m02=f,this._m10=g,this._m11=y,this._m12=S,this}clone(){try{return null}catch(i){if(!(i instanceof n))throw i;d.shouldNeverReachHere()}return null}translate(i,r){return this.compose(bt.translationInstance(i,r)),this}setToReflection(){if(arguments.length===2){let i=arguments[0],r=arguments[1];if(i===0&&r===0)throw new s("Reflection vector must be non-zero");if(i===r)return this._m00=0,this._m01=1,this._m02=0,this._m10=1,this._m11=0,this._m12=0,this;let c=Math.sqrt(i*i+r*r),f=r/c,g=i/c;return this.rotate(-f,g),this.scale(1,-1),this.rotate(f,g),this}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];if(i===c&&r===f)throw new s("Reflection line points must be distinct");this.setToTranslation(-i,-r);let g=c-i,y=f-r,S=Math.sqrt(g*g+y*y),I=y/S,z=g/S;return this.rotate(-I,z),this.scale(1,-1),this.rotate(I,z),this.translate(i,r),this}}shear(i,r){return this.compose(bt.shearInstance(i,r)),this}getInverse(){let i=this.getDeterminant();if(i===0)throw new Iu("Transformation is non-invertible");let r=this._m11/i,c=-this._m10/i,f=-this._m01/i,g=this._m00/i,y=(this._m01*this._m12-this._m02*this._m11)/i,S=(-this._m00*this._m12+this._m10*this._m02)/i;return new bt(r,f,y,c,g,S)}compose(i){let r=i._m00*this._m00+i._m01*this._m10,c=i._m00*this._m01+i._m01*this._m11,f=i._m00*this._m02+i._m01*this._m12+i._m02,g=i._m10*this._m00+i._m11*this._m10,y=i._m10*this._m01+i._m11*this._m11,S=i._m10*this._m02+i._m11*this._m12+i._m12;return this._m00=r,this._m01=c,this._m02=f,this._m10=g,this._m11=y,this._m12=S,this}equals(i){if(i===null||!(i instanceof bt))return!1;let r=i;return this._m00===r._m00&&this._m01===r._m01&&this._m02===r._m02&&this._m10===r._m10&&this._m11===r._m11&&this._m12===r._m12}setToScale(i,r){return this._m00=i,this._m01=0,this._m02=0,this._m10=0,this._m11=r,this._m12=0,this}isIdentity(){return this._m00===1&&this._m01===0&&this._m02===0&&this._m10===0&&this._m11===1&&this._m12===0}scale(i,r){return this.compose(bt.scaleInstance(i,r)),this}setToIdentity(){return this._m00=1,this._m01=0,this._m02=0,this._m10=0,this._m11=1,this._m12=0,this}isGeometryChanged(){return!0}setTransformation(){if(arguments.length===1){let i=arguments[0];return this._m00=i._m00,this._m01=i._m01,this._m02=i._m02,this._m10=i._m10,this._m11=i._m11,this._m12=i._m12,this}if(arguments.length===6){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5];return this._m00=i,this._m01=r,this._m02=c,this._m10=f,this._m11=g,this._m12=y,this}}rotate(){if(arguments.length===1){let i=arguments[0];return this.compose(bt.rotationInstance(i)),this}if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.compose(bt.rotationInstance(i,r)),this}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return this.compose(bt.rotationInstance(i,r,c)),this}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];return this.compose(bt.rotationInstance(i,r,c,f)),this}}getDeterminant(){return this._m00*this._m11-this._m01*this._m10}setToShear(i,r){return this._m00=1,this._m01=i,this._m02=0,this._m10=r,this._m11=1,this._m12=0,this}isDone(){return!1}toString(){return"AffineTransformation[["+this._m00+", "+this._m01+", "+this._m02+"], ["+this._m10+", "+this._m11+", "+this._m12+"]]"}setToTranslation(i,r){return this._m00=1,this._m01=0,this._m02=i,this._m10=0,this._m11=1,this._m12=r,this}transform(){if(arguments.length===1){let i=arguments[0].copy();return i.apply(this),i}if(arguments.length===2){if(arguments[0]instanceof w&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=this._m00*i.x+this._m01*i.y+this._m02,f=this._m10*i.x+this._m11*i.y+this._m12;return r.x=c,r.y=f,r}if(P(arguments[0],we)&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1],c=this._m00*i.getOrdinate(r,0)+this._m01*i.getOrdinate(r,1)+this._m02,f=this._m10*i.getOrdinate(r,0)+this._m11*i.getOrdinate(r,1)+this._m12;i.setOrdinate(r,0,c),i.setOrdinate(r,1,f)}}}reflect(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.compose(bt.reflectionInstance(i,r)),this}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];return this.compose(bt.reflectionInstance(i,r,c,f)),this}}get interfaces_(){return[_,X]}}class bo{static solve(i,r){let c=r.length;if(i.length!==c||i[0].length!==c)throw new s("Matrix A is incorrectly sized");for(let g=0;g<c;g++){let y=g;for(let S=g+1;S<c;S++)Math.abs(i[S][g])>Math.abs(i[y][g])&&(y=S);if(i[y][g]===0)return null;bo.swapRows(i,g,y),bo.swapRows(r,g,y);for(let S=g+1;S<c;S++){let I=i[S][g]/i[g][g];for(let z=c-1;z>=g;z--)i[S][z]-=i[g][z]*I;r[S]-=r[g]*I}}let f=new Array(c).fill(null);for(let g=c-1;g>=0;g--){let y=0;for(let S=g+1;S<c;S++)y+=i[g][S]*f[S];f[g]=(r[g]-y)/i[g][g]}return f}static swapRows(){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1],c=arguments[2];if(r===c)return null;for(let f=0;f<i[0].length;f++){let g=i[r][f];i[r][f]=i[c][f],i[c][f]=g}}else if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let i=arguments[0],r=arguments[1],c=arguments[2];if(r===c)return null;let f=i[r];i[r]=i[c],i[c]=f}}}class Il{constructor(){Il.constructor_.apply(this,arguments)}static constructor_(){this._src0=null,this._src1=null,this._src2=null,this._dest0=null,this._dest1=null,this._dest2=null,this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null;let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5];this._src0=i,this._src1=r,this._src2=c,this._dest0=f,this._dest1=g,this._dest2=y}compute(){let i=[this._dest0.x,this._dest1.x,this._dest2.x],r=this.solve(i);if(r===null)return!1;this._m00=r[0],this._m01=r[1],this._m02=r[2];let c=[this._dest0.y,this._dest1.y,this._dest2.y],f=this.solve(c);return f!==null&&(this._m10=f[0],this._m11=f[1],this._m12=f[2],!0)}getTransformation(){return this.compute()?new bt(this._m00,this._m01,this._m02,this._m10,this._m11,this._m12):null}solve(i){let r=[[this._src0.x,this._src0.y,1],[this._src1.x,this._src1.y,1],[this._src2.x,this._src2.y,1]];return bo.solve(r,i)}}class wa{static createFromBaseLines(i,r,c,f){let g=new w(i.x+f.x-c.x,i.y+f.y-c.y),y=ct.angleBetweenOriented(r,i,g),S=r.distance(i),I=f.distance(c);if(S===0)return new bt;let z=I/S,ne=bt.translationInstance(-i.x,-i.y);return ne.rotate(y),ne.scale(z,z),ne.translate(c.x,c.y),ne}static createFromControlVectors(){if(arguments.length===2){if(arguments[0]instanceof w&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=r.x-i.x,f=r.y-i.y;return bt.translationInstance(c,f)}if(arguments[0]instanceof Array&&arguments[1]instanceof Array){let i=arguments[0],r=arguments[1];if(i.length!==r.length)throw new s("Src and Dest arrays are not the same length");if(i.length<=0)throw new s("Too few control points");if(i.length>3)throw new s("Too many control points");return i.length===1?wa.createFromControlVectors(i[0],r[0]):i.length===2?wa.createFromControlVectors(i[0],i[1],r[0],r[1]):wa.createFromControlVectors(i[0],i[1],i[2],r[0],r[1],r[2])}}else{if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=new w(f.x-c.x,f.y-c.y),y=ct.angleBetweenOriented(r,i,g),S=r.distance(i),I=f.distance(c);if(S===0)return null;let z=I/S,ne=bt.translationInstance(-i.x,-i.y);return ne.rotate(y),ne.scale(z,z),ne.translate(c.x,c.y),ne}if(arguments.length===6)return new Il(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]).getTransformation()}}}class xo{constructor(){xo.constructor_.apply(this,arguments)}static constructor_(){this._coords=null;let i=arguments[0];this._coords=i}static getCoordinates(i){let r=new M;return i.apply(new xo(r)),r}filter(i){(i instanceof Z||i instanceof yt)&&this._coords.add(i.getCoordinate())}get interfaces_(){return[Pe]}}class Sa{constructor(){Sa.constructor_.apply(this,arguments)}static constructor_(){this._mapOp=null;let i=arguments[0];this._mapOp=i}static map(i,r){return new Sa(r).map(i)}map(i){let r=new M;for(let c=0;c<i.getNumGeometries();c++){let f=this._mapOp.map(i.getGeometryN(c));f.isEmpty()||r.add(f)}return i.getFactory().createGeometryCollection(vt.toGeometryArray(r))}}class Ti{constructor(){Ti.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null;let i=arguments[0];this._geomFactory=Ti.extractFactory(i),this._inputGeoms=i}static extractFactory(i){return i.isEmpty()?null:i.iterator().next().getFactory()}static createList(){if(arguments.length===2){let i=arguments[0],r=arguments[1],c=new M;return c.add(i),c.add(r),c}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2],f=new M;return f.add(i),f.add(r),f.add(c),f}}static combine(){if(arguments.length===1)return new Ti(arguments[0]).combine();if(arguments.length===2){let i=arguments[0],r=arguments[1];return new Ti(Ti.createList(i,r)).combine()}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return new Ti(Ti.createList(i,r,c)).combine()}}extractElements(i,r){if(i===null)return null;for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c);this._skipEmpty&&f.isEmpty()||r.add(f)}}combine(){let i=new M;for(let r=this._inputGeoms.iterator();r.hasNext();){let c=r.next();this.extractElements(c,i)}return i.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection():null:this._geomFactory.buildGeometry(i)}}class q{constructor(){q.constructor_.apply(this,arguments)}static constructor_(){if(this._factory=null,this._isUserDataCopied=!1,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this._factory=i}}}setCopyUserData(i){this._isUserDataCopied=i}edit(i,r){if(i===null)return null;let c=this.editInternal(i,r);return this._isUserDataCopied&&c.setUserData(i.getUserData()),c}editInternal(i,r){return this._factory===null&&(this._factory=i.getFactory()),i instanceof tt?this.editGeometryCollection(i,r):i instanceof Et?this.editPolygon(i,r):i instanceof yt||i instanceof Z?r.edit(i,this._factory):(d.shouldNeverReachHere("Unsupported Geometry type: "+i.getGeometryType()),null)}editGeometryCollection(i,r){let c=r.edit(i,this._factory),f=new M;for(let g=0;g<c.getNumGeometries();g++){let y=this.edit(c.getGeometryN(g),r);y===null||y.isEmpty()||f.add(y)}return c.getGeometryType()===Q.TYPENAME_MULTIPOINT?this._factory.createMultiPoint(f.toArray([])):c.getGeometryType()===Q.TYPENAME_MULTILINESTRING?this._factory.createMultiLineString(f.toArray([])):c.getGeometryType()===Q.TYPENAME_MULTIPOLYGON?this._factory.createMultiPolygon(f.toArray([])):this._factory.createGeometryCollection(f.toArray([]))}editPolygon(i,r){let c=r.edit(i,this._factory);if(c===null&&(c=this._factory.createPolygon()),c.isEmpty())return c;let f=this.edit(c.getExteriorRing(),r);if(f===null||f.isEmpty())return this._factory.createPolygon();let g=new M;for(let y=0;y<c.getNumInteriorRing();y++){let S=this.edit(c.getInteriorRingN(y),r);S===null||S.isEmpty()||g.add(S)}return this._factory.createPolygon(f,g.toArray([]))}}function ee(){}q.GeometryEditorOperation=ee,q.NoOpGeometryOperation=class{edit(A,i){return A}get interfaces_(){return[ee]}},q.CoordinateOperation=class{edit(A,i){let r=this.edit(A.getCoordinates(),A);return A instanceof ae?r===null?i.createLinearRing():i.createLinearRing(r):A instanceof Z?r===null?i.createLineString():i.createLineString(r):A instanceof yt?r===null||r.length===0?i.createPoint():i.createPoint(r[0]):A}get interfaces_(){return[ee]}},q.CoordinateSequenceOperation=class{edit(A,i){return A instanceof ae?i.createLinearRing(this.edit(A.getCoordinateSequence(),A)):A instanceof Z?i.createLineString(this.edit(A.getCoordinateSequence(),A)):A instanceof yt?i.createPoint(this.edit(A.getCoordinateSequence(),A)):A}get interfaces_(){return[ee]}};class Y{constructor(){Y.constructor_.apply(this,arguments)}static constructor_(){this._geometryType=null,this._comps=null;let i=arguments[0],r=arguments[1];this._geometryType=i,this._comps=r}static extract(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return Y.extract(i,r,new M)}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return i.getGeometryType()===r?c.add(i):i instanceof tt&&i.apply(new Y(r,c)),c}}static isOfType(i,r){return i.getGeometryType()===r||r===Q.TYPENAME_LINESTRING&&i.getGeometryType()===Q.TYPENAME_LINEARRING}filter(i){(this._geometryType===null||Y.isOfType(i,this._geometryType))&&this._comps.add(i)}get interfaces_(){return[O]}}class le{static map(){if(arguments[0]instanceof Q&&P(arguments[1],ue)){let i=arguments[0],r=arguments[1],c=new M;for(let f=0;f<i.getNumGeometries();f++){let g=r.map(i.getGeometryN(f));g!==null&&c.add(g)}return i.getFactory().buildGeometry(c)}if(P(arguments[0],j)&&P(arguments[1],ue)){let i=arguments[0],r=arguments[1],c=new M;for(let f=i.iterator();f.hasNext();){let g=f.next(),y=r.map(g);y!==null&&c.add(y)}return c}}}function ue(){}le.MapOp=ue;class oe{constructor(){oe.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}transformPoint(i,r){return this._factory.createPoint(this.transformCoordinates(i.getCoordinateSequence(),i))}transformPolygon(i,r){let c=!0,f=this.transformLinearRing(i.getExteriorRing(),i);f!==null&&f instanceof ae&&!f.isEmpty()||(c=!1);let g=new M;for(let y=0;y<i.getNumInteriorRing();y++){let S=this.transformLinearRing(i.getInteriorRingN(y),i);S===null||S.isEmpty()||(S instanceof ae||(c=!1),g.add(S))}if(c)return this._factory.createPolygon(f,g.toArray([]));{let y=new M;return f!==null&&y.add(f),y.addAll(g),this._factory.buildGeometry(y)}}createCoordinateSequence(i){return this._factory.getCoordinateSequenceFactory().create(i)}getInputGeometry(){return this._inputGeom}transformMultiLineString(i,r){let c=new M;for(let f=0;f<i.getNumGeometries();f++){let g=this.transformLineString(i.getGeometryN(f),i);g!==null&&(g.isEmpty()||c.add(g))}return this._factory.buildGeometry(c)}transformCoordinates(i,r){return this.copy(i)}transformLineString(i,r){return this._factory.createLineString(this.transformCoordinates(i.getCoordinateSequence(),i))}transformMultiPoint(i,r){let c=new M;for(let f=0;f<i.getNumGeometries();f++){let g=this.transformPoint(i.getGeometryN(f),i);g!==null&&(g.isEmpty()||c.add(g))}return this._factory.buildGeometry(c)}transformMultiPolygon(i,r){let c=new M;for(let f=0;f<i.getNumGeometries();f++){let g=this.transformPolygon(i.getGeometryN(f),i);g!==null&&(g.isEmpty()||c.add(g))}return this._factory.buildGeometry(c)}copy(i){return i.copy()}transformLinearRing(i,r){let c=this.transformCoordinates(i.getCoordinateSequence(),i);if(c===null)return this._factory.createLinearRing(null);let f=c.size();return f>0&&f<4&&!this._preserveType?this._factory.createLineString(c):this._factory.createLinearRing(c)}transformGeometryCollection(i,r){let c=new M;for(let f=0;f<i.getNumGeometries();f++){let g=this.transform(i.getGeometryN(f));g!==null&&(this._pruneEmptyGeometry&&g.isEmpty()||c.add(g))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(vt.toGeometryArray(c)):this._factory.buildGeometry(c)}transform(i){if(this._inputGeom=i,this._factory=i.getFactory(),i instanceof yt)return this.transformPoint(i,null);if(i instanceof Li)return this.transformMultiPoint(i,null);if(i instanceof ae)return this.transformLinearRing(i,null);if(i instanceof Z)return this.transformLineString(i,null);if(i instanceof _n)return this.transformMultiLineString(i,null);if(i instanceof Et)return this.transformPolygon(i,null);if(i instanceof at)return this.transformMultiPolygon(i,null);if(i instanceof tt)return this.transformGeometryCollection(i,null);throw new s("Unknown Geometry subtype: "+i.getGeometryType())}}class be{constructor(){be.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;let i=arguments[0];this._comps=i}static getLines(){if(arguments.length===1){let i=arguments[0];return be.getLines(i,new M)}if(arguments.length===2){let i=arguments[0],r=arguments[1];return i instanceof Z?r.add(i):i instanceof tt&&i.apply(new be(r)),r}}static getGeometry(i){return i.getFactory().buildGeometry(be.getLines(i))}filter(i){i instanceof Z&&this._comps.add(i)}get interfaces_(){return[O]}}class Se{constructor(){Se.constructor_.apply(this,arguments)}static constructor_(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){let i=arguments[0];this._lines=i}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._lines=i,this._isForcedToLineString=r}}static getLines(){if(arguments.length===1){let i=arguments[0];return Se.getLines(i,!1)}if(arguments.length===2){if(P(arguments[0],j)&&P(arguments[1],j)){let i=arguments[1];for(let r=arguments[0].iterator();r.hasNext();){let c=r.next();Se.getLines(c,i)}return i}if(arguments[0]instanceof Q&&typeof arguments[1]=="boolean"){let i=arguments[0],r=arguments[1],c=new M;return i.apply(new Se(c,r)),c}if(arguments[0]instanceof Q&&P(arguments[1],j)){let i=arguments[0],r=arguments[1];return i instanceof Z?r.add(i):i.apply(new Se(r)),r}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&P(arguments[0],j)&&P(arguments[1],j)){let i=arguments[1],r=arguments[2];for(let c=arguments[0].iterator();c.hasNext();){let f=c.next();Se.getLines(f,i,r)}return i}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Q&&P(arguments[1],j)){let i=arguments[1],r=arguments[2];return arguments[0].apply(new Se(i,r)),i}}}static getGeometry(){if(arguments.length===1){let i=arguments[0];return i.getFactory().buildGeometry(Se.getLines(i))}if(arguments.length===2){let i=arguments[0],r=arguments[1];return i.getFactory().buildGeometry(Se.getLines(i,r))}}filter(i){if(this._isForcedToLineString&&i instanceof ae){let r=i.getFactory().createLineString(i.getCoordinateSequence());return this._lines.add(r),null}i instanceof Z&&this._lines.add(i)}setForceToLineString(i){this._isForcedToLineString=i}get interfaces_(){return[Pe]}}let Le={reverseOrder:function(){return{compare:(A,i)=>i.compareTo(A)}},min:function(A){return Le.sort(A),A.get(0)},sort:function(A,i){let r=A.toArray();i?Hn.sort(r,i):Hn.sort(r);let c=A.iterator();for(let f=0,g=r.length;f<g;f++)c.next(),c.set(r[f])},singletonList:function(A){let i=new M;return i.add(A),i}};class ke{constructor(){ke.constructor_.apply(this,arguments)}static constructor_(){this._pts=null;let i=arguments[0];this._pts=i}static getPoints(){if(arguments.length===1){let i=arguments[0];return i instanceof yt?Le.singletonList(i):ke.getPoints(i,new M)}if(arguments.length===2){let i=arguments[0],r=arguments[1];return i instanceof yt?r.add(i):i instanceof tt&&i.apply(new ke(r)),r}}filter(i){i instanceof yt&&this._pts.add(i)}get interfaces_(){return[O]}}class Me{constructor(){Me.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;let i=arguments[0];this._comps=i}static getPolygons(){if(arguments.length===1){let i=arguments[0];return Me.getPolygons(i,new M)}if(arguments.length===2){let i=arguments[0],r=arguments[1];return i instanceof Et?r.add(i):i instanceof tt&&i.apply(new Me(r)),r}}filter(i){i instanceof Et&&this._comps.add(i)}get interfaces_(){return[O]}}class Ve{constructor(){Ve.constructor_.apply(this,arguments)}static constructor_(){this._isDone=!1}applyTo(i){for(let r=0;r<i.getNumGeometries()&&!this._isDone;r++){let c=i.getGeometryN(r);if(c instanceof tt)this.applyTo(c);else if(this.visit(c),this.isDone())return this._isDone=!0,null}}}class st{constructor(){st.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFact=null,this._precModel=null,this._dim=new It,this._nPts=100,this._rotationAngle=0,arguments.length===0)st.constructor_.call(this,new vt);else if(arguments.length===1){let i=arguments[0];this._geomFact=i,this._precModel=i.getPrecisionModel()}}setBase(i){this._dim.setBase(i)}setRotation(i){this._rotationAngle=i}setWidth(i){this._dim.setWidth(i)}createEllipse(){let i=this._dim.getEnvelope(),r=i.getWidth()/2,c=i.getHeight()/2,f=i.getMinX()+r,g=i.getMinY()+c,y=new Array(this._nPts+1).fill(null),S=0;for(let ne=0;ne<this._nPts;ne++){let he=ne*(2*Math.PI/this._nPts),Ie=r*Math.cos(he)+f,Oe=c*Math.sin(he)+g;y[S++]=this.coord(Ie,Oe)}y[S]=new w(y[0]);let I=this._geomFact.createLinearRing(y),z=this._geomFact.createPolygon(I);return this.rotate(z)}createArc(i,r){let c=this._dim.getEnvelope(),f=c.getWidth()/2,g=c.getHeight()/2,y=c.getMinX()+f,S=c.getMinY()+g,I=r;(I<=0||I>2*Math.PI)&&(I=2*Math.PI);let z=I/(this._nPts-1),ne=new Array(this._nPts).fill(null),he=0;for(let Oe=0;Oe<this._nPts;Oe++){let Ue=i+Oe*z,ut=f*Math.cos(Ue)+y,cn=g*Math.sin(Ue)+S;ne[he++]=this.coord(ut,cn)}let Ie=this._geomFact.createLineString(ne);return this.rotate(Ie)}rotate(i){if(this._rotationAngle!==0){let r=bt.rotationInstance(this._rotationAngle,this._dim.getCentre().x,this._dim.getCentre().y);i.apply(r)}return i}coord(i,r){let c=new w(i,r);return this._precModel.makePrecise(c),c}createArcPolygon(i,r){let c=this._dim.getEnvelope(),f=c.getWidth()/2,g=c.getHeight()/2,y=c.getMinX()+f,S=c.getMinY()+g,I=r;(I<=0||I>2*Math.PI)&&(I=2*Math.PI);let z=I/(this._nPts-1),ne=new Array(this._nPts+2).fill(null),he=0;ne[he++]=this.coord(y,S);for(let Ue=0;Ue<this._nPts;Ue++){let ut=i+z*Ue,cn=f*Math.cos(ut)+y,Oi=g*Math.sin(ut)+S;ne[he++]=this.coord(cn,Oi)}ne[he++]=this.coord(y,S);let Ie=this._geomFact.createLinearRing(ne),Oe=this._geomFact.createPolygon(Ie);return this.rotate(Oe)}createRectangle(){let i=null,r=0,c=Math.trunc(this._nPts/4);c<1&&(c=1);let f=this._dim.getEnvelope().getWidth()/c,g=this._dim.getEnvelope().getHeight()/c,y=new Array(4*c+1).fill(null),S=this._dim.getEnvelope();for(i=0;i<c;i++){let ne=S.getMinX()+i*f,he=S.getMinY();y[r++]=this.coord(ne,he)}for(i=0;i<c;i++){let ne=S.getMaxX(),he=S.getMinY()+i*g;y[r++]=this.coord(ne,he)}for(i=0;i<c;i++){let ne=S.getMaxX()-i*f,he=S.getMaxY();y[r++]=this.coord(ne,he)}for(i=0;i<c;i++){let ne=S.getMinX(),he=S.getMaxY()-i*g;y[r++]=this.coord(ne,he)}y[r++]=new w(y[0]);let I=this._geomFact.createLinearRing(y),z=this._geomFact.createPolygon(I);return this.rotate(z)}createCircle(){return this.createEllipse()}setHeight(i){this._dim.setHeight(i)}setSize(i){this._dim.setSize(i)}createSupercircle(i){let r=1/i,c=this._dim.getMinSize()/2,f=this._dim.getCentre(),g=Math.pow(c,i),y=c,S=Math.pow(g/2,r),I=Math.trunc(this._nPts/8),z=new Array(8*I+1).fill(null),ne=S/I;for(let Oe=0;Oe<=I;Oe++){let Ue=0,ut=y;if(Oe!==0){Ue=ne*Oe;let cn=Math.pow(Ue,i);ut=Math.pow(g-cn,r)}z[Oe]=this.coordTrans(Ue,ut,f),z[2*I-Oe]=this.coordTrans(ut,Ue,f),z[2*I+Oe]=this.coordTrans(ut,-Ue,f),z[4*I-Oe]=this.coordTrans(Ue,-ut,f),z[4*I+Oe]=this.coordTrans(-Ue,-ut,f),z[6*I-Oe]=this.coordTrans(-ut,-Ue,f),z[6*I+Oe]=this.coordTrans(-ut,Ue,f),z[8*I-Oe]=this.coordTrans(-Ue,ut,f)}z[z.length-1]=new w(z[0]);let he=this._geomFact.createLinearRing(z),Ie=this._geomFact.createPolygon(he);return this.rotate(Ie)}setNumPoints(i){this._nPts=i}coordTrans(i,r,c){return this.coord(i+c.x,r+c.y)}createSquircle(){return this.createSupercircle(4)}setEnvelope(i){this._dim.setEnvelope(i)}setCentre(i){this._dim.setCentre(i)}}class It{constructor(){It.constructor_.apply(this,arguments)}static constructor_(){this.base=null,this.centre=null,this.width=null,this.height=null}setBase(i){this.base=i}setWidth(i){this.width=i}getBase(){return this.base}getWidth(){return this.width}getEnvelope(){return this.base!==null?new K(this.base.x,this.base.x+this.width,this.base.y,this.base.y+this.height):this.centre!==null?new K(this.centre.x-this.width/2,this.centre.x+this.width/2,this.centre.y-this.height/2,this.centre.y+this.height/2):new K(0,this.width,0,this.height)}getCentre(){return this.centre===null&&(this.centre=new w(this.base.x+this.width/2,this.base.y+this.height/2)),this.centre}getHeight(){return this.height}setHeight(i){this.height=i}setSize(i){this.height=i,this.width=i}setEnvelope(i){this.width=i.getWidth(),this.height=i.getHeight(),this.base=new w(i.getMinX(),i.getMinY()),this.centre=new w(i.centre())}setCentre(i){this.centre=i}getMinSize(){return Math.min(this.width,this.height)}}st.Dimensions=It;class Nt extends st{constructor(){super(),Nt.constructor_.apply(this,arguments)}static constructor_(){if(this._numArms=8,this._armLengthRatio=.5,arguments.length===0)st.constructor_.call(this);else if(arguments.length===1){let i=arguments[0];st.constructor_.call(this,i)}}static create(i,r,c,f,g){let y=new Nt;return y.setCentre(i),y.setSize(r),y.setNumPoints(c),y.setArmLengthRatio(g),y.setNumArms(f),y.createSineStar()}setArmLengthRatio(i){this._armLengthRatio=i}createSineStar(){let i=this._dim.getEnvelope(),r=i.getWidth()/2,c=this._armLengthRatio;c<0&&(c=0),c>1&&(c=1);let f=c*r,g=(1-c)*r,y=i.getMinX()+r,S=i.getMinY()+r,I=new Array(this._nPts+1).fill(null),z=0;for(let he=0;he<this._nPts;he++){let Ie=he/this._nPts*this._numArms,Oe=Ie-Math.floor(Ie),Ue=2*Math.PI*Oe,ut=g+f*((Math.cos(Ue)+1)/2),cn=he*(2*Math.PI/this._nPts),Oi=ut*Math.cos(cn)+y,Dr=ut*Math.sin(cn)+S;I[z++]=this.coord(Oi,Dr)}I[z]=new w(I[0]);let ne=this._geomFact.createLinearRing(I);return this._geomFact.createPolygon(ne)}setNumArms(i){this._numArms=i}}var yn=Object.freeze({__proto__:null,AffineTransformation:bt,AffineTransformationBuilder:Il,AffineTransformationFactory:wa,ComponentCoordinateExtracter:xo,GeometryCollectionMapper:Sa,GeometryCombiner:Ti,GeometryEditor:q,GeometryExtracter:Y,GeometryMapper:le,GeometryTransformer:oe,LineStringExtracter:be,LinearComponentExtracter:Se,PointExtracter:ke,PolygonExtracter:Me,ShortCircuitedGeometryVisitor:Ve,SineStarFactory:Nt}),on=Object.freeze({__proto__:null,Coordinate:w,CoordinateList:E,CoordinateSequenceFilter:X,CoordinateXY:D,CoordinateXYM:G,CoordinateXYZM:W,Dimension:C,Envelope:K,Geometry:Q,GeometryCollection:tt,GeometryFactory:vt,IntersectionMatrix:Ct,LineSegment:Ze,LineString:Z,LinearRing:ae,Location:B,MultiLineString:_n,MultiPoint:Li,MultiPolygon:at,Point:yt,Polygon:Et,PrecisionModel:St,Triangle:Gt,util:yn});class Qt{constructor(){Qt.constructor_.apply(this,arguments)}static constructor_(){this._pt=[new w,new w],this._distance=l.NaN,this._isNull=!0}getCoordinates(){return this._pt}getCoordinate(i){return this._pt[i]}setMinimum(){if(arguments.length===1){let i=arguments[0];this.setMinimum(i._pt[0],i._pt[1])}else if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(i,r),null;let c=i.distance(r);c<this._distance&&this.initialize(i,r,c)}}initialize(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=i.distance(r),this._isNull=!1}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=c,this._isNull=!1}}toString(){return rn.toLineString(this._pt[0],this._pt[1])}getDistance(){return this._distance}setMaximum(){if(arguments.length===1){let i=arguments[0];this.setMaximum(i._pt[0],i._pt[1])}else if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(i,r),null;let c=i.distance(r);c>this._distance&&this.initialize(i,r,c)}}}class si{static computeDistance(){if(arguments[2]instanceof Qt&&arguments[0]instanceof Z&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=arguments[2],f=new Ze,g=i.getCoordinates();for(let y=0;y<g.length-1;y++){f.setCoordinates(g[y],g[y+1]);let S=f.closestPoint(r);c.setMinimum(S,r)}}else if(arguments[2]instanceof Qt&&arguments[0]instanceof Et&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=arguments[2];si.computeDistance(i.getExteriorRing(),r,c);for(let f=0;f<i.getNumInteriorRing();f++)si.computeDistance(i.getInteriorRingN(f),r,c)}else if(arguments[2]instanceof Qt&&arguments[0]instanceof Q&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=arguments[2];if(i instanceof Z)si.computeDistance(i,r,c);else if(i instanceof Et)si.computeDistance(i,r,c);else if(i instanceof tt){let f=i;for(let g=0;g<f.getNumGeometries();g++){let y=f.getGeometryN(g);si.computeDistance(y,r,c)}}else c.setMinimum(i.getCoordinate(),r)}else if(arguments[2]instanceof Qt&&arguments[0]instanceof Ze&&arguments[1]instanceof w){let i=arguments[1],r=arguments[2],c=arguments[0].closestPoint(i);r.setMinimum(c,i)}}}class ys{constructor(){ys.constructor_.apply(this,arguments)}static constructor_(){this._g0=null,this._g1=null,this._ptDist=new Qt,this._densifyFrac=0;let i=arguments[0],r=arguments[1];this._g0=i,this._g1=r}static distance(){if(arguments.length===2)return new ys(arguments[0],arguments[1]).distance();if(arguments.length===3){let i=arguments[2],r=new ys(arguments[0],arguments[1]);return r.setDensifyFraction(i),r.distance()}}getCoordinates(){return this._ptDist.getCoordinates()}setDensifyFraction(i){if(i>1||i<=0)throw new s("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=i}compute(i,r){this.computeOrientedDistance(i,r,this._ptDist),this.computeOrientedDistance(r,i,this._ptDist)}distance(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}computeOrientedDistance(i,r,c){let f=new Ll(r);if(i.apply(f),c.setMaximum(f.getMaxPointDistance()),this._densifyFrac>0){let g=new wo(r,this._densifyFrac);i.apply(g),c.setMaximum(g.getMaxPointDistance())}}orientedDistance(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}}class Ll{constructor(){Ll.constructor_.apply(this,arguments)}static constructor_(){this._maxPtDist=new Qt,this._minPtDist=new Qt,this._euclideanDist=new si,this._geom=null;let i=arguments[0];this._geom=i}filter(i){this._minPtDist.initialize(),si.computeDistance(this._geom,i,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}getMaxPointDistance(){return this._maxPtDist}get interfaces_(){return[ge]}}class wo{constructor(){wo.constructor_.apply(this,arguments)}static constructor_(){this._maxPtDist=new Qt,this._minPtDist=new Qt,this._geom=null,this._numSubSegs=0;let i=arguments[0],r=arguments[1];this._geom=i,this._numSubSegs=Math.trunc(Math.round(1/r))}filter(i,r){if(r===0)return null;let c=i.getCoordinate(r-1),f=i.getCoordinate(r),g=(f.x-c.x)/this._numSubSegs,y=(f.y-c.y)/this._numSubSegs;for(let S=0;S<this._numSubSegs;S++){let I=c.x+S*g,z=c.y+S*y,ne=new w(I,z);this._minPtDist.initialize(),si.computeDistance(this._geom,ne,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}isGeometryChanged(){return!1}getMaxPointDistance(){return this._maxPtDist}isDone(){return!1}get interfaces_(){return[X]}}ys.MaxPointDistanceFilter=Ll,ys.MaxDensifiedByFractionDistanceFilter=wo;var uS=Object.freeze({__proto__:null,DiscreteHausdorffDistance:ys,DistanceToPoint:si,PointPairDistance:Qt});class Ea{visitItem(i){}}class Lu{locate(i){}}class Lr{constructor(){Lr.constructor_.apply(this,arguments)}static constructor_(){this._min=l.POSITIVE_INFINITY,this._max=l.NEGATIVE_INFINITY}getMin(){return this._min}intersects(i,r){return!(this._min>r||this._max<i)}getMax(){return this._max}toString(){return rn.toLineString(new w(this._min,0),new w(this._max,0))}}Lr.NodeComparator=class{compare(A,i){let r=A,c=i,f=(r._min+r._max)/2,g=(c._min+c._max)/2;return f<g?-1:f>g?1:0}get interfaces_(){return[m]}};class $_ extends Lr{constructor(){super(),$_.constructor_.apply(this,arguments)}static constructor_(){this._item=null;let i=arguments[0],r=arguments[1],c=arguments[2];this._min=i,this._max=r,this._item=c}query(i,r,c){if(!this.intersects(i,r))return null;c.visitItem(this._item)}}class B_ extends Lr{constructor(){super(),B_.constructor_.apply(this,arguments)}static constructor_(){this._node1=null,this._node2=null;let i=arguments[0],r=arguments[1];this._node1=i,this._node2=r,this.buildExtent(this._node1,this._node2)}buildExtent(i,r){this._min=Math.min(i._min,r._min),this._max=Math.max(i._max,r._max)}query(i,r,c){if(!this.intersects(i,r))return null;this._node1!==null&&this._node1.query(i,r,c),this._node2!==null&&this._node2.query(i,r,c)}}class U_{constructor(){U_.constructor_.apply(this,arguments)}static constructor_(){this._leaves=new M,this._root=null,this._level=0}buildTree(){Le.sort(this._leaves,new Lr.NodeComparator);let i=this._leaves,r=null,c=new M;for(;;){if(this.buildLevel(i,c),c.size()===1)return c.get(0);r=i,i=c,c=r}}insert(i,r,c){if(this._root!==null)throw new Re("Index cannot be added to once it has been queried");this._leaves.add(new $_(i,r,c))}query(i,r,c){if(this.init(),this._root===null)return null;this._root.query(i,r,c)}buildRoot(){if(this._root!==null)return null;this._root=this.buildTree()}printNode(i){Fe.out.println(rn.toLineString(new w(i._min,this._level),new w(i._max,this._level)))}init(){return this._root!==null||this._leaves.size()===0?null:void this.buildRoot()}buildLevel(i,r){this._level++,r.clear();for(let c=0;c<i.size();c+=2){let f=i.get(c);if((c+1<i.size()?i.get(c):null)===null)r.add(f);else{let g=new B_(i.get(c),i.get(c+1));r.add(g)}}}}class of{constructor(){of.constructor_.apply(this,arguments)}static constructor_(){this._items=new M}getItems(){return this._items}visitItem(i){this._items.add(i)}get interfaces_(){return[Ea]}}class Nl{constructor(){Nl.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;let i=arguments[0];this._p=i}static locatePointInRing(){if(arguments[0]instanceof w&&P(arguments[1],we)){let i=arguments[1],r=new Nl(arguments[0]),c=new w,f=new w;for(let g=1;g<i.size();g++)if(i.getCoordinate(g,c),i.getCoordinate(g-1,f),r.countSegment(c,f),r.isOnSegment())return r.getLocation();return r.getLocation()}if(arguments[0]instanceof w&&arguments[1]instanceof Array){let i=arguments[1],r=new Nl(arguments[0]);for(let c=1;c<i.length;c++){let f=i[c],g=i[c-1];if(r.countSegment(f,g),r.isOnSegment())return r.getLocation()}return r.getLocation()}}getLocation(){return this._isPointOnSegment?B.BOUNDARY:this._crossingCount%2==1?B.INTERIOR:B.EXTERIOR}isPointInPolygon(){return this.getLocation()!==B.EXTERIOR}isOnSegment(){return this._isPointOnSegment}countSegment(i,r){if(i.x<this._p.x&&r.x<this._p.x)return null;if(this._p.x===r.x&&this._p.y===r.y)return this._isPointOnSegment=!0,null;if(i.y===this._p.y&&r.y===this._p.y){let c=i.x,f=r.x;return c>f&&(c=r.x,f=i.x),this._p.x>=c&&this._p.x<=f&&(this._isPointOnSegment=!0),null}if(i.y>this._p.y&&r.y<=this._p.y||r.y>this._p.y&&i.y<=this._p.y){let c=pe.index(i,r,this._p);if(c===pe.COLLINEAR)return this._isPointOnSegment=!0,null;r.y<i.y&&(c=-c),c===pe.LEFT&&this._crossingCount++}}}class So{constructor(){So.constructor_.apply(this,arguments)}static constructor_(){this._geom=null,this._index=null;let i=arguments[0];if(!(P(i,Jn)||i instanceof ae))throw new s("Argument must be Polygonal or LinearRing");this._geom=i}locate(i){this._index===null&&(this._index=new lf(this._geom),this._geom=null);let r=new Nl(i),c=new af(r);return this._index.query(i.y,i.y,c),r.getLocation()}get interfaces_(){return[Lu]}}class af{constructor(){af.constructor_.apply(this,arguments)}static constructor_(){this._counter=null;let i=arguments[0];this._counter=i}visitItem(i){let r=i;this._counter.countSegment(r.getCoordinate(0),r.getCoordinate(1))}get interfaces_(){return[Ea]}}class lf{constructor(){lf.constructor_.apply(this,arguments)}static constructor_(){this._isEmpty=!1,this._index=new U_;let i=arguments[0];i.isEmpty()?this._isEmpty=!0:this.init(i)}init(i){for(let r=Se.getLines(i).iterator();r.hasNext();){let c=r.next().getCoordinates();this.addLine(c)}}addLine(i){for(let r=1;r<i.length;r++){let c=new Ze(i[r-1],i[r]),f=Math.min(c.p0.y,c.p1.y),g=Math.max(c.p0.y,c.p1.y);this._index.insert(f,g,c)}}query(){if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this._isEmpty)return new M;let c=new of;return this._index.query(i,r,c),c.getItems()}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(this._isEmpty)return null;this._index.query(i,r,c)}}}So.SegmentVisitor=af,So.IntervalIndexedGeometry=lf;class Ji{static isInRing(i,r){return Ji.locateInRing(i,r)!==B.EXTERIOR}static locateInRing(i,r){return Nl.locatePointInRing(i,r)}static isOnLine(){if(arguments[0]instanceof w&&P(arguments[1],we)){let i=arguments[0],r=arguments[1],c=new wn,f=new w,g=new w,y=r.size();for(let S=1;S<y;S++)if(r.getCoordinate(S-1,f),r.getCoordinate(S,g),c.computeIntersection(i,f,g),c.hasIntersection())return!0;return!1}if(arguments[0]instanceof w&&arguments[1]instanceof Array){let i=arguments[0],r=arguments[1],c=new wn;for(let f=1;f<r.length;f++){let g=r[f-1],y=r[f];if(c.computeIntersection(i,g,y),c.hasIntersection())return!0}return!1}}}class lP{hasNext(){}next(){}remove(){}}class Tl{constructor(){Tl.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;let i=arguments[0];this._parent=i,this._atStart=!0,this._index=0,this._max=i.getNumGeometries()}static isAtomic(i){return!(i instanceof tt)}next(){if(this._atStart)return this._atStart=!1,Tl.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new se;let i=this._parent.getGeometryN(this._index++);return i instanceof tt?(this._subcollectionIterator=new Tl(i),this._subcollectionIterator.next()):i}hasNext(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}remove(){throw new Je(this.getClass().getName())}get interfaces_(){return[lP]}}class es{constructor(){es.constructor_.apply(this,arguments)}static constructor_(){this._geom=null;let i=arguments[0];this._geom=i}static locatePointInPolygon(i,r){if(r.isEmpty())return B.EXTERIOR;let c=r.getExteriorRing(),f=es.locatePointInRing(i,c);if(f!==B.INTERIOR)return f;for(let g=0;g<r.getNumInteriorRing();g++){let y=r.getInteriorRingN(g),S=es.locatePointInRing(i,y);if(S===B.BOUNDARY)return B.BOUNDARY;if(S===B.INTERIOR)return B.EXTERIOR}return B.INTERIOR}static locatePointInRing(i,r){return r.getEnvelopeInternal().intersects(i)?Ji.locateInRing(i,r.getCoordinates()):B.EXTERIOR}static isContained(i,r){return B.EXTERIOR!==es.locate(i,r)}static locate(i,r){return r.isEmpty()?B.EXTERIOR:r.getEnvelopeInternal().intersects(i)?es.locateInGeometry(i,r):B.EXTERIOR}static containsPointInPolygon(i,r){return B.EXTERIOR!==es.locatePointInPolygon(i,r)}static locateInGeometry(i,r){if(r instanceof Et)return es.locatePointInPolygon(i,r);if(r instanceof tt){let c=new Tl(r);for(;c.hasNext();){let f=c.next();if(f!==r){let g=es.locateInGeometry(i,f);if(g!==B.EXTERIOR)return g}}}return B.EXTERIOR}locate(i){return es.locate(i,this._geom)}get interfaces_(){return[Lu]}}var cP=Object.freeze({__proto__:null,IndexedPointInAreaLocator:So,PointOnGeometryLocator:Lu,SimplePointInAreaLocator:es});class z_{measure(i,r){}}class mt{constructor(){mt.constructor_.apply(this,arguments)}static constructor_(){if(this._quadrantSegments=mt.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=mt.CAP_ROUND,this._joinStyle=mt.JOIN_ROUND,this._mitreLimit=mt.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=mt.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this.setQuadrantSegments(i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.setQuadrantSegments(i),this.setEndCapStyle(r)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(c),this.setMitreLimit(f)}}}static bufferDistanceError(i){let r=Math.PI/2/i;return 1-Math.cos(r/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(i){this._quadrantSegments=i,this._quadrantSegments===0&&(this._joinStyle=mt.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=mt.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),i<=0&&(this._quadrantSegments=1),this._joinStyle!==mt.JOIN_ROUND&&(this._quadrantSegments=mt.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(i){this._joinStyle=i}setSimplifyFactor(i){this._simplifyFactor=i<0?0:i}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(i){this._endCapStyle=i}getMitreLimit(){return this._mitreLimit}setMitreLimit(i){this._mitreLimit=i}setSingleSided(i){this._isSingleSided=i}}mt.CAP_ROUND=1,mt.CAP_FLAT=2,mt.CAP_SQUARE=3,mt.JOIN_ROUND=1,mt.JOIN_MITRE=2,mt.JOIN_BEVEL=3,mt.DEFAULT_QUADRANT_SEGMENTS=8,mt.DEFAULT_MITRE_LIMIT=5,mt.DEFAULT_SIMPLIFY_FACTOR=.01;class vs{static relativeSign(i,r){return i<r?-1:i>r?1:0}static compareValue(i,r){return i<0?-1:i>0?1:r<0?-1:r>0?1:0}static compare(i,r,c){if(r.equals2D(c))return 0;let f=vs.relativeSign(r.x,c.x),g=vs.relativeSign(r.y,c.y);switch(i){case 0:return vs.compareValue(f,g);case 1:return vs.compareValue(g,f);case 2:return vs.compareValue(g,-f);case 3:return vs.compareValue(-f,g);case 4:return vs.compareValue(-f,-g);case 5:return vs.compareValue(-g,-f);case 6:return vs.compareValue(-g,f);case 7:return vs.compareValue(f,-g)}return d.shouldNeverReachHere("invalid octant value"),0}}class V_{constructor(){V_.constructor_.apply(this,arguments)}static constructor_(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this._segString=i,this.coord=new w(r),this.segmentIndex=c,this._segmentOctant=f,this._isInterior=!r.equals2D(i.getCoordinate(c))}getCoordinate(){return this.coord}print(i){i.print(this.coord),i.print(" seg # = "+this.segmentIndex)}compareTo(i){let r=i;return this.segmentIndex<r.segmentIndex?-1:this.segmentIndex>r.segmentIndex?1:this.coord.equals2D(r.coord)?0:this._isInterior?r._isInterior?vs.compare(this._segmentOctant,this.coord,r.coord):1:-1}isEndPoint(i){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===i}toString(){return this.segmentIndex+":"+this.coord.toString()}isInterior(){return this._isInterior}get interfaces_(){return[a]}}class uP extends Js{}function dS(A){return A==null?0:A.color}function At(A){return A==null?null:A.parent}function tr(A,i){A!==null&&(A.color=i)}function H_(A){return A==null?null:A.left}function hS(A){return A==null?null:A.right}class bs extends uP{constructor(){super(),this.root_=null,this.size_=0}get(i){let r=this.root_;for(;r!==null;){let c=i.compareTo(r.key);if(c<0)r=r.left;else{if(!(c>0))return r.value;r=r.right}}return null}put(i,r){if(this.root_===null)return this.root_={key:i,value:r,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;let c,f,g=this.root_;do if(c=g,f=i.compareTo(g.key),f<0)g=g.left;else{if(!(f>0)){let S=g.value;return g.value=r,S}g=g.right}while(g!==null);let y={key:i,left:null,right:null,value:r,parent:c,color:0,getValue(){return this.value},getKey(){return this.key}};return f<0?c.left=y:c.right=y,this.fixAfterInsertion(y),this.size_++,null}fixAfterInsertion(i){let r;for(i.color=1;i!=null&&i!==this.root_&&i.parent.color===1;)At(i)===H_(At(At(i)))?(r=hS(At(At(i))),dS(r)===1?(tr(At(i),0),tr(r,0),tr(At(At(i)),1),i=At(At(i))):(i===hS(At(i))&&(i=At(i),this.rotateLeft(i)),tr(At(i),0),tr(At(At(i)),1),this.rotateRight(At(At(i))))):(r=H_(At(At(i))),dS(r)===1?(tr(At(i),0),tr(r,0),tr(At(At(i)),1),i=At(At(i))):(i===H_(At(i))&&(i=At(i),this.rotateRight(i)),tr(At(i),0),tr(At(At(i)),1),this.rotateLeft(At(At(i)))));this.root_.color=0}values(){let i=new M,r=this.getFirstEntry();if(r!==null)for(i.add(r.value);(r=bs.successor(r))!==null;)i.add(r.value);return i}entrySet(){let i=new xn,r=this.getFirstEntry();if(r!==null)for(i.add(r);(r=bs.successor(r))!==null;)i.add(r);return i}rotateLeft(i){if(i!=null){let r=i.right;i.right=r.left,r.left!=null&&(r.left.parent=i),r.parent=i.parent,i.parent==null?this.root_=r:i.parent.left===i?i.parent.left=r:i.parent.right=r,r.left=i,i.parent=r}}rotateRight(i){if(i!=null){let r=i.left;i.left=r.right,r.right!=null&&(r.right.parent=i),r.parent=i.parent,i.parent==null?this.root_=r:i.parent.right===i?i.parent.right=r:i.parent.left=r,r.right=i,i.parent=r}}getFirstEntry(){let i=this.root_;if(i!=null)for(;i.left!=null;)i=i.left;return i}static successor(i){let r;if(i===null)return null;if(i.right!==null){for(r=i.right;r.left!==null;)r=r.left;return r}{r=i.parent;let c=i;for(;r!==null&&c===r.right;)c=r,r=r.parent;return r}}size(){return this.size_}containsKey(i){let r=this.root_;for(;r!==null;){let c=i.compareTo(r.key);if(c<0)r=r.left;else{if(!(c>0))return!0;r=r.right}}return!1}}class W_{constructor(){W_.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new bs,this._edge=null;let i=arguments[0];this._edge=i}getSplitCoordinates(){let i=new E;this.addEndpoints();let r=this.iterator(),c=r.next();for(;r.hasNext();){let f=r.next();this.addEdgeCoordinates(c,f,i),c=f}return i.toCoordinateArray()}print(i){i.println("Intersections:");for(let r=this.iterator();r.hasNext();)r.next().print(i)}findCollapsesFromExistingVertices(i){for(let r=0;r<this._edge.size()-2;r++){let c=this._edge.getCoordinate(r);this._edge.getCoordinate(r+1);let f=this._edge.getCoordinate(r+2);c.equals2D(f)&&i.add(Ge.valueOf(r+1))}}addEdgeCoordinates(i,r,c){let f=this.createSplitEdgePts(i,r);c.add(f,!1)}findCollapseIndex(i,r,c){if(!i.coord.equals2D(r.coord))return!1;let f=r.segmentIndex-i.segmentIndex;return r.isInterior()||f--,f===1&&(c[0]=i.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(i){let r=new Array(1).fill(null),c=this.iterator(),f=c.next();for(;c.hasNext();){let g=c.next();this.findCollapseIndex(f,g,r)&&i.add(Ge.valueOf(r[0])),f=g}}getEdge(){return this._edge}addEndpoints(){let i=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(i),i)}createSplitEdge(i,r){let c=this.createSplitEdgePts(i,r);return new nr(c,this._edge.getData())}add(i,r){let c=new V_(this._edge,i,r,this._edge.getSegmentOctant(r)),f=this._nodeMap.get(c);return f!==null?(d.isTrue(f.coord.equals2D(i),"Found equal nodes with different coordinates"),f):(this._nodeMap.put(c,c),c)}checkSplitEdgesCorrectness(i){let r=this._edge.getCoordinates(),c=i.get(0).getCoordinate(0);if(!c.equals2D(r[0]))throw new h("bad split edge start point at "+c);let f=i.get(i.size()-1).getCoordinates(),g=f[f.length-1];if(!g.equals2D(r[r.length-1]))throw new h("bad split edge end point at "+g)}addCollapsedNodes(){let i=new M;this.findCollapsesFromInsertedNodes(i),this.findCollapsesFromExistingVertices(i);for(let r=i.iterator();r.hasNext();){let c=r.next().intValue();this.add(this._edge.getCoordinate(c),c)}}createSplitEdgePts(i,r){let c=r.segmentIndex-i.segmentIndex+2;if(c===2)return[new w(i.coord),new w(r.coord)];let f=this._edge.getCoordinate(r.segmentIndex),g=r.isInterior()||!r.coord.equals2D(f);g||c--;let y=new Array(c).fill(null),S=0;y[S++]=new w(i.coord);for(let I=i.segmentIndex+1;I<=r.segmentIndex;I++)y[S++]=this._edge.getCoordinate(I);return g&&(y[S]=new w(r.coord)),y}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(i){this.addEndpoints(),this.addCollapsedNodes();let r=this.iterator(),c=r.next();for(;r.hasNext();){let f=r.next(),g=this.createSplitEdge(c,f);i.add(g),c=f}}}class cf{static octant(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1];if(i===0&&r===0)throw new s("Cannot compute the octant for point ( "+i+", "+r+" )");let c=Math.abs(i),f=Math.abs(r);return i>=0?r>=0?c>=f?0:1:c>=f?7:6:r>=0?c>=f?3:2:c>=f?4:5}if(arguments[0]instanceof w&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1],c=r.x-i.x,f=r.y-i.y;if(c===0&&f===0)throw new s("Cannot compute the octant for two identical points "+i);return cf.octant(c,f)}}}class Y_{getCoordinates(){}size(){}getCoordinate(i){}isClosed(){}setData(i){}getData(){}}class dP{addIntersection(i,r){}get interfaces_(){return[Y_]}}class nr{constructor(){nr.constructor_.apply(this,arguments)}static constructor_(){this._nodeList=new W_(this),this._pts=null,this._data=null;let i=arguments[0],r=arguments[1];this._pts=i,this._data=r}static getNodedSubstrings(){if(arguments.length===1){let i=arguments[0],r=new M;return nr.getNodedSubstrings(i,r),r}if(arguments.length===2){let i=arguments[1];for(let r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(i){return this._pts[i]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(i){return i===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(i),this.getCoordinate(i+1))}toString(){return rn.toLineString(new de(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(i,r){let c=r,f=c+1;if(f<this._pts.length){let g=this._pts[f];i.equals2D(g)&&(c=f)}return this._nodeList.add(i,c)}addIntersections(i,r,c){for(let f=0;f<i.getIntersectionNum();f++)this.addIntersection(i,r,c,f)}setData(i){this._data=i}safeOctant(i,r){return i.equals2D(r)?0:cf.octant(i,r)}getData(){return this._data}addIntersection(){if(arguments.length===2){let i=arguments[0],r=arguments[1];this.addIntersectionNode(i,r)}else if(arguments.length===4){let i=arguments[1],r=arguments[3],c=new w(arguments[0].getIntersection(r));this.addIntersection(c,i)}}get interfaces_(){return[dP]}}class X_{getNodedSubstrings(){}computeNodes(i){}}class Nu{constructor(){Nu.constructor_.apply(this,arguments)}static constructor_(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){let i=arguments[0],r=arguments[1];Nu.constructor_.call(this,i,r,0,0)}else if(arguments.length===4){let i=arguments[0],r=arguments[1];this._noder=i,this._scaleFactor=r,this._isScaled=!this.isIntegerPrecision()}}rescale(){if(P(arguments[0],j))for(let i=arguments[0].iterator();i.hasNext();){let r=i.next();this.rescale(r.getCoordinates())}else if(arguments[0]instanceof Array){let i=arguments[0];for(let r=0;r<i.length;r++)i[r].x=i[r].x/this._scaleFactor+this._offsetX,i[r].y=i[r].y/this._scaleFactor+this._offsetY;i.length===2&&i[0].equals2D(i[1])&&Fe.out.println(i)}}scale(){if(P(arguments[0],j)){let i=arguments[0],r=new M(i.size());for(let c=i.iterator();c.hasNext();){let f=c.next();r.add(new nr(this.scale(f.getCoordinates()),f.getData()))}return r}if(arguments[0]instanceof Array){let i=arguments[0],r=new Array(i.length).fill(null);for(let c=0;c<i.length;c++)r[c]=new w(Math.round((i[c].x-this._offsetX)*this._scaleFactor),Math.round((i[c].y-this._offsetY)*this._scaleFactor),i[c].getZ());return Be.removeRepeatedPoints(r)}}isIntegerPrecision(){return this._scaleFactor===1}getNodedSubstrings(){let i=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(i),i}computeNodes(i){let r=i;this._isScaled&&(r=this.scale(i)),this._noder.computeNodes(r)}get interfaces_(){return[X_]}}class ts extends h{constructor(i,r){super(r?i+" [ "+r+" ]":i),this.pt=r?new w(r):void 0,this.name=Object.keys({TopologyException:ts})[0]}getCoordinate(){return this.pt}}class Tu{constructor(){Tu.constructor_.apply(this,arguments)}static constructor_(){this._li=new wn,this._segStrings=null;let i=arguments[0];this._segStrings=i}checkEndPtVertexIntersections(){if(arguments.length===0)for(let i=this._segStrings.iterator();i.hasNext();){let r=i.next().getCoordinates();this.checkEndPtVertexIntersections(r[0],this._segStrings),this.checkEndPtVertexIntersections(r[r.length-1],this._segStrings)}else if(arguments.length===2){let i=arguments[0];for(let r=arguments[1].iterator();r.hasNext();){let c=r.next().getCoordinates();for(let f=1;f<c.length-1;f++)if(c[f].equals(i))throw new h("found endpt/interior pt intersection at index "+f+" :pt "+i)}}}checkInteriorIntersections(){if(arguments.length===0)for(let i=this._segStrings.iterator();i.hasNext();){let r=i.next();for(let c=this._segStrings.iterator();c.hasNext();){let f=c.next();this.checkInteriorIntersections(r,f)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=i.getCoordinates(),f=r.getCoordinates();for(let g=0;g<c.length-1;g++)for(let y=0;y<f.length-1;y++)this.checkInteriorIntersections(i,g,r,y)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];if(i===c&&r===f)return null;let g=i.getCoordinates()[r],y=i.getCoordinates()[r+1],S=c.getCoordinates()[f],I=c.getCoordinates()[f+1];if(this._li.computeIntersection(g,y,S,I),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,y)||this.hasInteriorIntersection(this._li,S,I)))throw new h("found non-noded intersection at "+g+"-"+y+" and "+S+"-"+I)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(arguments.length===0)for(let i=this._segStrings.iterator();i.hasNext();){let r=i.next();this.checkCollapses(r)}else if(arguments.length===1){let i=arguments[0].getCoordinates();for(let r=0;r<i.length-2;r++)this.checkCollapse(i[r],i[r+1],i[r+2])}}hasInteriorIntersection(i,r,c){for(let f=0;f<i.getIntersectionNum();f++){let g=i.getIntersection(f);if(!g.equals(r)&&!g.equals(c))return!0}return!1}checkCollapse(i,r,c){if(i.equals(c))throw new h("found non-noded collapse at "+Tu.fact.createLineString([i,r,c]))}}Tu.fact=new vt;class fS{getBounds(){}}class ns{constructor(){ns.constructor_.apply(this,arguments)}static constructor_(){this._bounds=null,this._item=null;let i=arguments[0],r=arguments[1];this._bounds=i,this._item=r}getItem(){return this._item}getBounds(){return this._bounds}get interfaces_(){return[fS,u]}}function hP(A){return A&&A.__esModule&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A}var pS,gS,fP=function(){if(gS)return pS;gS=1;var A=function(r,c){return r<c};function i(r){if(!(this instanceof i))return new i(r);this.array=[],this.size=0,this.compare=r||A}return i.prototype.clone=function(){var r=new i(this.compare);return r.size=this.size,r.array=this.array.slice(0,this.size),r},i.prototype.add=function(r){var c,f,g=this.size;for(this.array[this.size]=r,this.size+=1;g>0&&(c=g-1>>1,f=this.array[c],this.compare(r,f));)this.array[g]=f,g=c;this.array[g]=r},i.prototype.heapify=function(r){var c;for(this.array=r,this.size=r.length,c=this.size>>1;c>=0;c--)this._percolateDown(c)},i.prototype._percolateUp=function(r,c){for(var f,g,y=this.array[r];r>0&&(f=r-1>>1,g=this.array[f],c||this.compare(y,g));)this.array[r]=g,r=f;this.array[r]=y},i.prototype._percolateDown=function(r){for(var c,f,g,y=this.size,S=this.size>>>1,I=this.array[r];r<S&&(f=(c=1+(r<<1))+1,g=this.array[c],f<y&&this.compare(this.array[f],g)&&(c=f,g=this.array[f]),this.compare(g,I));)this.array[r]=g,r=c;this.array[r]=I},i.prototype._removeAt=function(r){if(!(r>this.size-1||r<0))return this._percolateUp(r,!0),this.poll()},i.prototype.remove=function(r){for(var c=0;c<this.size;c++)if(!this.compare(this.array[c],r)&&!this.compare(r,this.array[c]))return this._removeAt(c),!0;return!1},i.prototype.removeOne=function(r){if(typeof r=="function"){for(var c=0;c<this.size;c++)if(r(this.array[c]))return this._removeAt(c)}},i.prototype.removeMany=function(r,c){if(typeof r!="function"||this.size<1)return[];c=c?Math.min(c,this.size):this.size;for(var f=0,g=new Array(c),y=0,S=new Array(this.size);f<c&&!this.isEmpty();){var I=this.poll();r(I)?g[f++]=I:S[y++]=I}g.length=f;for(var z=0;z<y;)this.add(S[z++]);return g},i.prototype.peek=function(){if(this.size!=0)return this.array[0]},i.prototype.poll=function(){if(this.size!=0){var r=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,r}},i.prototype.replaceTop=function(r){if(this.size!=0){var c=this.array[0];return this.array[0]=r,this._percolateDown(0),c}},i.prototype.trim=function(){this.array=this.array.slice(0,this.size)},i.prototype.isEmpty=function(){return this.size===0},i.prototype.forEach=function(r){if(!this.isEmpty()&&typeof r=="function")for(var c=0,f=this.clone();!f.isEmpty();)r(f.poll(),c++)},i.prototype.kSmallest=function(r){if(this.size==0||r<=0)return[];r=Math.min(this.size,r);let c=Math.min(this.size,2**(r-1)+1);if(c<2)return[this.peek()];let f=new i(this.compare);f.size=c,f.array=this.array.slice(0,c);let g=new Array(r);for(let y=0;y<r;y++)g[y]=f.poll();return g},pS=i}(),mS=hP(fP);let uf=class{constructor(){this._fpQueue=new mS((A,i)=>A.compareTo(i)<0)}poll(){return this._fpQueue.poll()}size(){return this._fpQueue.size}clear(){this._fpQueue=new mS}peek(){return this._fpQueue.peek()}remove(){return this._fpQueue.poll()}isEmpty(){return this._fpQueue.isEmpty()}add(A){this._fpQueue.add(A)}};class _S{query(){}insert(i,r){}remove(i,r){}}class ki{constructor(){ki.constructor_.apply(this,arguments)}static constructor_(){if(this._childBoundables=new M,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this._level=i}}}getLevel(){return this._level}addChildBoundable(i){d.isTrue(this._bounds===null),this._childBoundables.add(i)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}get interfaces_(){return[fS,u]}}class an{static distance(i,r,c,f){let g=c-i,y=f-r;return Math.sqrt(g*g+y*y)}static maximumDistance(i,r){let c=Math.min(i.getMinX(),r.getMinX()),f=Math.min(i.getMinY(),r.getMinY()),g=Math.max(i.getMaxX(),r.getMaxX()),y=Math.max(i.getMaxY(),r.getMaxY());return an.distance(c,f,g,y)}static minMaxDistance(i,r){let c=i.getMinX(),f=i.getMinY(),g=i.getMaxX(),y=i.getMaxY(),S=r.getMinX(),I=r.getMinY(),z=r.getMaxX(),ne=r.getMaxY(),he=an.maxDistance(c,f,c,y,S,I,S,ne);return he=Math.min(he,an.maxDistance(c,f,c,y,S,I,z,I)),he=Math.min(he,an.maxDistance(c,f,c,y,z,ne,S,ne)),he=Math.min(he,an.maxDistance(c,f,c,y,z,ne,z,I)),he=Math.min(he,an.maxDistance(c,f,g,f,S,I,S,ne)),he=Math.min(he,an.maxDistance(c,f,g,f,S,I,z,I)),he=Math.min(he,an.maxDistance(c,f,g,f,z,ne,S,ne)),he=Math.min(he,an.maxDistance(c,f,g,f,z,ne,z,I)),he=Math.min(he,an.maxDistance(g,y,c,y,S,I,S,ne)),he=Math.min(he,an.maxDistance(g,y,c,y,S,I,z,I)),he=Math.min(he,an.maxDistance(g,y,c,y,z,ne,S,ne)),he=Math.min(he,an.maxDistance(g,y,c,y,z,ne,z,I)),he=Math.min(he,an.maxDistance(g,y,g,f,S,I,S,ne)),he=Math.min(he,an.maxDistance(g,y,g,f,S,I,z,I)),he=Math.min(he,an.maxDistance(g,y,g,f,z,ne,S,ne)),he=Math.min(he,an.maxDistance(g,y,g,f,z,ne,z,I)),he}static maxDistance(i,r,c,f,g,y,S,I){let z=an.distance(i,r,g,y);return z=Math.max(z,an.distance(i,r,S,I)),z=Math.max(z,an.distance(c,f,g,y)),z=Math.max(z,an.distance(c,f,S,I)),z}}class ri{constructor(){ri.constructor_.apply(this,arguments)}static constructor_(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;let i=arguments[0],r=arguments[1],c=arguments[2];this._boundable1=i,this._boundable2=r,this._itemDistance=c,this._distance=this.distance()}static area(i){return i.getBounds().getArea()}static isComposite(i){return i instanceof ki}maximumDistance(){return an.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}expandToQueue(i,r){let c=ri.isComposite(this._boundable1),f=ri.isComposite(this._boundable2);if(c&&f)return ri.area(this._boundable1)>ri.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,i,r),null):(this.expand(this._boundable2,this._boundable1,!0,i,r),null);if(c)return this.expand(this._boundable1,this._boundable2,!1,i,r),null;if(f)return this.expand(this._boundable2,this._boundable1,!0,i,r),null;throw new s("neither boundable is composite")}isLeaves(){return!(ri.isComposite(this._boundable1)||ri.isComposite(this._boundable2))}getBoundable(i){return i===0?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}compareTo(i){let r=i;return this._distance<r._distance?-1:this._distance>r._distance?1:0}expand(i,r,c,f,g){for(let y=i.getChildBoundables().iterator();y.hasNext();){let S=y.next(),I=null;I=c?new ri(r,S,this._itemDistance):new ri(S,r,this._itemDistance),I.getDistance()<g&&f.add(I)}}get interfaces_(){return[a]}}class ir{constructor(){ir.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._built=!1,this._itemBoundables=new M,this._nodeCapacity=null,arguments.length===0)ir.constructor_.call(this,ir.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){let i=arguments[0];d.isTrue(i>1,"Node capacity must be greater than 1"),this._nodeCapacity=i}}static compareDoubles(i,r){return i>r?1:i<r?-1:0}queryInternal(){if(P(arguments[2],Ea)&&arguments[0]instanceof Object&&arguments[1]instanceof ki){let i=arguments[0],r=arguments[2],c=arguments[1].getChildBoundables();for(let f=0;f<c.size();f++){let g=c.get(f);this.getIntersectsOp().intersects(g.getBounds(),i)&&(g instanceof ki?this.queryInternal(i,g,r):g instanceof ns?r.visitItem(g.getItem()):d.shouldNeverReachHere())}}else if(P(arguments[2],H)&&arguments[0]instanceof Object&&arguments[1]instanceof ki){let i=arguments[0],r=arguments[2],c=arguments[1].getChildBoundables();for(let f=0;f<c.size();f++){let g=c.get(f);this.getIntersectsOp().intersects(g.getBounds(),i)&&(g instanceof ki?this.queryInternal(i,g,r):g instanceof ns?r.add(g.getItem()):d.shouldNeverReachHere())}}}insert(i,r){d.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ns(i,r))}boundablesAtLevel(){if(arguments.length===1){let i=arguments[0],r=new M;return this.boundablesAtLevel(i,this._root,r),r}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(d.isTrue(i>-2),r.getLevel()===i)return c.add(r),null;for(let f=r.getChildBoundables().iterator();f.hasNext();){let g=f.next();g instanceof ki?this.boundablesAtLevel(i,g,c):(d.isTrue(g instanceof ns),i===-1&&c.add(g))}return null}}getRoot(){return this.build(),this._root}remove(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.remove(i,this._root,r)}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2],f=this.removeItem(r,c);if(f)return!0;let g=null;for(let y=r.getChildBoundables().iterator();y.hasNext();){let S=y.next();if(this.getIntersectsOp().intersects(S.getBounds(),i)&&S instanceof ki&&(f=this.remove(i,S,c),f)){g=S;break}}return g!==null&&g.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(g),f}}createHigherLevels(i,r){d.isTrue(!i.isEmpty());let c=this.createParentBoundables(i,r+1);return c.size()===1?c.get(0):this.createHigherLevels(c,r+1)}depth(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){let i=0;for(let r=arguments[0].getChildBoundables().iterator();r.hasNext();){let c=r.next();if(c instanceof ki){let f=this.depth(c);f>i&&(i=f)}}return i+1}}createParentBoundables(i,r){d.isTrue(!i.isEmpty());let c=new M;c.add(this.createNode(r));let f=new M(i);Le.sort(f,this.getComparator());for(let g=f.iterator();g.hasNext();){let y=g.next();this.lastNode(c).getChildBoundables().size()===this.getNodeCapacity()&&c.add(this.createNode(r)),this.lastNode(c).addChildBoundable(y)}return c}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}getNodeCapacity(){return this._nodeCapacity}lastNode(i){return i.get(i.size()-1)}size(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){let i=0;for(let r=arguments[0].getChildBoundables().iterator();r.hasNext();){let c=r.next();c instanceof ki?i+=this.size(c):c instanceof ns&&(i+=1)}return i}}removeItem(i,r){let c=null;for(let f=i.getChildBoundables().iterator();f.hasNext();){let g=f.next();g instanceof ns&&g.getItem()===r&&(c=g)}return c!==null&&(i.getChildBoundables().remove(c),!0)}itemsTree(){if(arguments.length===0){this.build();let i=this.itemsTree(this._root);return i===null?new M:i}if(arguments.length===1){let i=arguments[0],r=new M;for(let c=i.getChildBoundables().iterator();c.hasNext();){let f=c.next();if(f instanceof ki){let g=this.itemsTree(f);g!==null&&r.add(g)}else f instanceof ns?r.add(f.getItem()):d.shouldNeverReachHere()}return r.size()<=0?null:r}}query(){if(arguments.length===1){let i=arguments[0];this.build();let r=new M;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.queryInternal(i,this._root,r),r}if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.queryInternal(i,this._root,r)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}get interfaces_(){return[u]}}ir.IntersectsOp=function(){},ir.DEFAULT_NODE_CAPACITY=10;class yS{distance(i,r){}}class Kt extends ir{constructor(){super(),Kt.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)Kt.constructor_.call(this,Kt.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){let i=arguments[0];ir.constructor_.call(this,i)}}static getItems(i){let r=new Array(i.size()).fill(null),c=0;for(;!i.isEmpty();){let f=i.poll();r[c]=f.getBoundable(0).getItem(),c++}return r}static avg(i,r){return(i+r)/2}static centreY(i){return Kt.avg(i.getMinY(),i.getMaxY())}static centreX(i){return Kt.avg(i.getMinX(),i.getMaxX())}size(){return arguments.length===0?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof K))return super.insert.apply(this,arguments);{let i=arguments[0],r=arguments[1];if(i.isNull())return null;super.insert.call(this,i,r)}}getIntersectsOp(){return Kt.intersectsOp}verticalSlices(i,r){let c=Math.trunc(Math.ceil(i.size()/r)),f=new Array(r).fill(null),g=i.iterator();for(let y=0;y<r;y++){f[y]=new M;let S=0;for(;g.hasNext()&&S<c;){let I=g.next();f[y].add(I),S++}}return f}query(){if(arguments.length===1){let i=arguments[0];return super.query.call(this,i)}if(arguments.length===2){let i=arguments[0],r=arguments[1];super.query.call(this,i,r)}}getComparator(){return Kt.yComparator}createParentBoundablesFromVerticalSlice(i,r){return super.createParentBoundables.call(this,i,r)}remove(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof K){let i=arguments[0],r=arguments[1];return super.remove.call(this,i,r)}return super.remove.apply(this,arguments)}depth(){return arguments.length===0?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(i,r){d.isTrue(!i.isEmpty());let c=Math.trunc(Math.ceil(i.size()/this.getNodeCapacity())),f=new M(i);Le.sort(f,Kt.xComparator);let g=this.verticalSlices(f,Math.trunc(Math.ceil(Math.sqrt(c))));return this.createParentBoundablesFromVerticalSlices(g,r)}nearestNeighbour(){if(arguments.length===1){if(P(arguments[0],yS)){let i=arguments[0];if(this.isEmpty())return null;let r=new ri(this.getRoot(),this.getRoot(),i);return this.nearestNeighbour(r)}if(arguments[0]instanceof ri){let i=arguments[0],r=l.POSITIVE_INFINITY,c=null,f=new uf;for(f.add(i);!f.isEmpty()&&r>0;){let g=f.poll(),y=g.getDistance();if(y>=r)break;g.isLeaves()?(r=y,c=g):g.expandToQueue(f,r)}return c===null?null:[c.getBoundable(0).getItem(),c.getBoundable(1).getItem()]}}else{if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this.isEmpty()||i.isEmpty())return null;let c=new ri(this.getRoot(),i.getRoot(),r);return this.nearestNeighbour(c)}if(arguments.length===3){let i=arguments[2],r=new ns(arguments[0],arguments[1]),c=new ri(this.getRoot(),r,i);return this.nearestNeighbour(c)[0]}if(arguments.length===4){let i=arguments[2],r=arguments[3],c=new ns(arguments[0],arguments[1]),f=new ri(this.getRoot(),c,i);return this.nearestNeighbourK(f,r)}}}isWithinDistance(){if(arguments.length===2){let i=arguments[0],r=arguments[1],c=l.POSITIVE_INFINITY,f=new uf;for(f.add(i);!f.isEmpty();){let g=f.poll(),y=g.getDistance();if(y>r)return!1;if(g.maximumDistance()<=r)return!0;if(g.isLeaves()){if(c=y,c<=r)return!0}else g.expandToQueue(f,c)}return!1}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2],f=new ri(this.getRoot(),i.getRoot(),r);return this.isWithinDistance(f,c)}}createParentBoundablesFromVerticalSlices(i,r){d.isTrue(i.length>0);let c=new M;for(let f=0;f<i.length;f++)c.addAll(this.createParentBoundablesFromVerticalSlice(i[f],r));return c}nearestNeighbourK(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.nearestNeighbourK(i,l.POSITIVE_INFINITY,r)}if(arguments.length===3){let i=arguments[0],r=arguments[2],c=arguments[1],f=new uf;f.add(i);let g=new uf;for(;!f.isEmpty()&&c>=0;){let y=f.poll(),S=y.getDistance();if(S>=c)break;y.isLeaves()?g.size()<r?g.add(y):(g.peek().getDistance()>S&&(g.poll(),g.add(y)),c=g.peek().getDistance()):y.expandToQueue(f,c)}return Kt.getItems(g)}}createNode(i){return new df(i)}get interfaces_(){return[_S,u]}}class df extends ki{constructor(){super(),df.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0];ki.constructor_.call(this,i)}computeBounds(){let i=null;for(let r=this.getChildBoundables().iterator();r.hasNext();){let c=r.next();i===null?i=new K(c.getBounds()):i.expandToInclude(c.getBounds())}return i}}Kt.STRtreeNode=df,Kt.xComparator=new class{get interfaces_(){return[m]}compare(A,i){return ir.compareDoubles(Kt.centreX(A.getBounds()),Kt.centreX(i.getBounds()))}},Kt.yComparator=new class{get interfaces_(){return[m]}compare(A,i){return ir.compareDoubles(Kt.centreY(A.getBounds()),Kt.centreY(i.getBounds()))}},Kt.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(A,i){return A.intersects(i)}},Kt.DEFAULT_NODE_CAPACITY=10;class Z_{constructor(){Z_.constructor_.apply(this,arguments)}static constructor_(){this._overlapSeg1=new Ze,this._overlapSeg2=new Ze}overlap(){if(arguments.length!==2){if(arguments.length===4){let i=arguments[1],r=arguments[2],c=arguments[3];arguments[0].getLineSegment(i,this._overlapSeg1),r.getLineSegment(c,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}let vS=class i4{constructor(){i4.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this._pts=i,this._start=r,this._end=c,this._context=f}computeOverlaps(){if(arguments.length===2){let i=arguments[0],r=arguments[1];this.computeOverlaps(this._start,this._end,i,i._start,i._end,r)}else if(arguments.length===6){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5];if(r-i==1&&g-f==1)return y.overlap(this,i,c,f),null;if(!this.overlaps(i,r,c,f,g))return null;let S=Math.trunc((i+r)/2),I=Math.trunc((f+g)/2);i<S&&(f<I&&this.computeOverlaps(i,S,c,f,I,y),I<g&&this.computeOverlaps(i,S,c,I,g,y)),S<r&&(f<I&&this.computeOverlaps(S,r,c,f,I,y),I<g&&this.computeOverlaps(S,r,c,I,g,y))}}setId(i){this._id=i}select(i,r){this.computeSelect(i,this._start,this._end,r)}getEnvelope(){if(this._env===null){let i=this._pts[this._start],r=this._pts[this._end];this._env=new K(i,r)}return this._env}overlaps(i,r,c,f,g){return K.intersects(this._pts[i],this._pts[r],c._pts[f],c._pts[g])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}getLineSegment(i,r){r.p0=this._pts[i],r.p1=this._pts[i+1]}computeSelect(i,r,c,f){let g=this._pts[r],y=this._pts[c];if(c-r==1)return f.select(this,r),null;if(!i.intersects(g,y))return null;let S=Math.trunc((r+c)/2);r<S&&this.computeSelect(i,r,S,f),S<c&&this.computeSelect(i,S,c,f)}getCoordinates(){let i=new Array(this._end-this._start+1).fill(null),r=0;for(let c=this._start;c<=this._end;c++)i[r++]=this._pts[c];return i}};class kt{static isNorthern(i){return i===kt.NE||i===kt.NW}static isOpposite(i,r){return i===r?!1:(i-r+4)%4===2}static commonHalfPlane(i,r){if(i===r)return i;if((i-r+4)%4===2)return-1;let c=i<r?i:r;return c===0&&(i>r?i:r)===3?3:c}static isInHalfPlane(i,r){return r===kt.SE?i===kt.SE||i===kt.SW:i===r||i===r+1}static quadrant(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1];if(i===0&&r===0)throw new s("Cannot compute the quadrant for point ( "+i+", "+r+" )");return i>=0?r>=0?kt.NE:kt.SE:r>=0?kt.NW:kt.SW}if(arguments[0]instanceof w&&arguments[1]instanceof w){let i=arguments[0],r=arguments[1];if(r.x===i.x&&r.y===i.y)throw new s("Cannot compute the quadrant for two identical points "+i);return r.x>=i.x?r.y>=i.y?kt.NE:kt.SE:r.y>=i.y?kt.NW:kt.SW}}}kt.NE=0,kt.NW=1,kt.SW=2,kt.SE=3;class hf{static findChainEnd(i,r){let c=r;for(;c<i.length-1&&i[c].equals2D(i[c+1]);)c++;if(c>=i.length-1)return i.length-1;let f=kt.quadrant(i[c],i[c+1]),g=r+1;for(;g<i.length&&!(!i[g-1].equals2D(i[g])&&kt.quadrant(i[g-1],i[g])!==f);)g++;return g-1}static getChains(){if(arguments.length===1){let i=arguments[0];return hf.getChains(i,null)}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=new M,f=0;do{let g=hf.findChainEnd(i,f),y=new vS(i,f,g,r);c.add(y),f=g}while(f<i.length-1);return c}}}class ff{constructor(){ff.constructor_.apply(this,arguments)}static constructor_(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this.setSegmentIntersector(i)}}}setSegmentIntersector(i){this._segInt=i}get interfaces_(){return[X_]}}class Ca extends ff{constructor(){super(),Ca.constructor_.apply(this,arguments)}static constructor_(){if(this._monoChains=new M,this._index=new Kt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){let i=arguments[0];ff.constructor_.call(this,i)}}}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return nr.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(i){for(let r=hf.getChains(i.getCoordinates(),i).iterator();r.hasNext();){let c=r.next();c.setId(this._idCounter++),this._index.insert(c.getEnvelope(),c),this._monoChains.add(c)}}computeNodes(i){this._nodedSegStrings=i;for(let r=i.iterator();r.hasNext();)this.add(r.next());this.intersectChains()}intersectChains(){let i=new pf(this._segInt);for(let r=this._monoChains.iterator();r.hasNext();){let c=r.next();for(let f=this._index.query(c.getEnvelope()).iterator();f.hasNext();){let g=f.next();if(g.getId()>c.getId()&&(c.computeOverlaps(g,i),this._nOverlaps++),this._segInt.isDone())return null}}}}class pf extends Z_{constructor(){super(),pf.constructor_.apply(this,arguments)}static constructor_(){this._si=null;let i=arguments[0];this._si=i}overlap(){if(arguments.length!==4)return super.overlap.apply(this,arguments);{let i=arguments[1],r=arguments[2],c=arguments[3],f=arguments[0].getContext(),g=r.getContext();this._si.processIntersections(f,i,g,c)}}}Ca.SegmentOverlapAction=pf;class kl{constructor(){kl.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;let i=arguments[0],r=arguments[1],c=arguments[2];if(this._originalPt=i,this._pt=i,this._scaleFactor=r,this._li=c,r<=0)throw new s("Scale factor must be non-zero");r!==1&&(this._pt=new w(this.scale(i.x),this.scale(i.y)),this._p0Scaled=new w,this._p1Scaled=new w),this.initCorners(this._pt)}intersectsScaled(i,r){let c=Math.min(i.x,r.x),f=Math.max(i.x,r.x),g=Math.min(i.y,r.y),y=Math.max(i.y,r.y),S=this._maxx<c||this._minx>f||this._maxy<g||this._miny>y;if(S)return!1;let I=this.intersectsToleranceSquare(i,r);return d.isTrue(!(S&&I),"Found bad envelope test"),I}copyScaled(i,r){r.x=this.scale(i.x),r.y=this.scale(i.y)}getSafeEnvelope(){if(this._safeEnv===null){let i=kl.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new K(this._originalPt.x-i,this._originalPt.x+i,this._originalPt.y-i,this._originalPt.y+i)}return this._safeEnv}intersectsPixelClosure(i,r){return this._li.computeIntersection(i,r,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(i,r,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(i,r,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(i,r,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}intersectsToleranceSquare(i,r){let c=!1,f=!1;return this._li.computeIntersection(i,r,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(i,r,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(c=!0),this._li.computeIntersection(i,r,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(f=!0),this._li.computeIntersection(i,r,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!c||!f)||!!i.equals(this._pt)||!!r.equals(this._pt))))}addSnappedNode(i,r){let c=i.getCoordinate(r),f=i.getCoordinate(r+1);return!!this.intersects(c,f)&&(i.addIntersection(this.getCoordinate(),r),!0)}initCorners(i){this._minx=i.x-.5,this._maxx=i.x+.5,this._miny=i.y-.5,this._maxy=i.y+.5,this._corner[0]=new w(this._maxx,this._maxy),this._corner[1]=new w(this._minx,this._maxy),this._corner[2]=new w(this._minx,this._miny),this._corner[3]=new w(this._maxx,this._miny)}intersects(i,r){return this._scaleFactor===1?this.intersectsScaled(i,r):(this.copyScaled(i,this._p0Scaled),this.copyScaled(r,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(i){return Math.round(i*this._scaleFactor)}getCoordinate(){return this._originalPt}}kl.SAFE_ENV_EXPANSION_FACTOR=.75;class Q_{constructor(){Q_.constructor_.apply(this,arguments)}static constructor_(){this.selectedSegment=new Ze}select(){if(arguments.length!==1){if(arguments.length===2){let i=arguments[1];arguments[0].getLineSegment(i,this.selectedSegment),this.select(this.selectedSegment)}}}}class gf{constructor(){gf.constructor_.apply(this,arguments)}static constructor_(){this._index=null;let i=arguments[0];this._index=i}snap(){if(arguments.length===1){let i=arguments[0];return this.snap(i,null,-1)}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2],f=i.getSafeEnvelope(),g=new mf(i,r,c);return this._index.query(f,new class{get interfaces_(){return[Ea]}visitItem(y){y.select(f,g)}}),g.isNodeAdded()}}}class mf extends Q_{constructor(){super(),mf.constructor_.apply(this,arguments)}static constructor_(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;let i=arguments[0],r=arguments[1],c=arguments[2];this._hotPixel=i,this._parentEdge=r,this._hotPixelVertexIndex=c}select(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof vS))return super.select.apply(this,arguments);{let i=arguments[1],r=arguments[0].getContext();if(this._parentEdge===r&&(i===this._hotPixelVertexIndex||i+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(r,i)}}isNodeAdded(){return this._isNodeAdded}}gf.HotPixelSnapAction=mf;let K_=class{isDone(){}processIntersections(A,i,r,c){}};class J_{constructor(){J_.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._interiorIntersections=null;let i=arguments[0];this._li=i,this._interiorIntersections=new M}isDone(){return!1}processIntersections(i,r,c,f){if(i===c&&r===f)return null;let g=i.getCoordinates()[r],y=i.getCoordinates()[r+1],S=c.getCoordinates()[f],I=c.getCoordinates()[f+1];if(this._li.computeIntersection(g,y,S,I),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(let z=0;z<this._li.getIntersectionNum();z++)this._interiorIntersections.add(this._li.getIntersection(z));i.addIntersections(this._li,r,0),c.addIntersections(this._li,f,1)}}getInteriorIntersections(){return this._interiorIntersections}get interfaces_(){return[K_]}}class ey{constructor(){ey.constructor_.apply(this,arguments)}static constructor_(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;let i=arguments[0];this._pm=i,this._li=new wn,this._li.setPrecisionModel(i),this._scaleFactor=i.getScale()}checkCorrectness(i){let r=nr.getNodedSubstrings(i),c=new Tu(r);try{c.checkValid()}catch(f){if(!(f instanceof n))throw f;f.printStackTrace()}}getNodedSubstrings(){return nr.getNodedSubstrings(this._nodedSegStrings)}snapRound(i,r){let c=this.findInteriorIntersections(i,r);this.computeIntersectionSnaps(c),this.computeVertexSnaps(i)}findInteriorIntersections(i,r){let c=new J_(r);return this._noder.setSegmentIntersector(c),this._noder.computeNodes(i),c.getInteriorIntersections()}computeVertexSnaps(){if(P(arguments[0],j))for(let i=arguments[0].iterator();i.hasNext();){let r=i.next();this.computeVertexSnaps(r)}else if(arguments[0]instanceof nr){let i=arguments[0],r=i.getCoordinates();for(let c=0;c<r.length;c++){let f=new kl(r[c],this._scaleFactor,this._li);this._pointSnapper.snap(f,i,c)&&i.addIntersection(r[c],c)}}}computeNodes(i){this._nodedSegStrings=i,this._noder=new Ca,this._pointSnapper=new gf(this._noder.getIndex()),this.snapRound(i,this._li)}computeIntersectionSnaps(i){for(let r=i.iterator();r.hasNext();){let c=r.next(),f=new kl(c,this._scaleFactor,this._li);this._pointSnapper.snap(f)}}get interfaces_(){return[X_]}}class Ce{static opposite(i){return i===Ce.LEFT?Ce.RIGHT:i===Ce.RIGHT?Ce.LEFT:i}}Ce.ON=0,Ce.LEFT=1,Ce.RIGHT=2;class _f extends n{constructor(i){super(i),this.name=Object.keys({EmptyStackException:_f})[0]}}class Ia extends H{constructor(){super(),this.array=[]}add(i){return this.array.push(i),!0}get(i){if(i<0||i>=this.size())throw new V;return this.array[i]}push(i){return this.array.push(i),i}pop(){if(this.array.length===0)throw new _f;return this.array.pop()}peek(){if(this.array.length===0)throw new _f;return this.array[this.array.length-1]}empty(){return this.array.length===0}isEmpty(){return this.empty()}search(i){return this.array.indexOf(i)}size(){return this.array.length}toArray(){return this.array.slice()}}class ty{constructor(){ty.constructor_.apply(this,arguments)}static constructor_(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}getCoordinate(){return this._minCoord}getRightmostSide(i,r){let c=this.getRightmostSideOfSegment(i,r);return c<0&&(c=this.getRightmostSideOfSegment(i,r-1)),c<0&&(this._minCoord=null,this.checkForRightmostCoordinate(i)),c}findRightmostEdgeAtVertex(){let i=this._minDe.getEdge().getCoordinates();d.isTrue(this._minIndex>0&&this._minIndex<i.length,"rightmost point expected to be interior vertex of edge");let r=i[this._minIndex-1],c=i[this._minIndex+1],f=pe.index(this._minCoord,c,r),g=!1;(r.y<this._minCoord.y&&c.y<this._minCoord.y&&f===pe.COUNTERCLOCKWISE||r.y>this._minCoord.y&&c.y>this._minCoord.y&&f===pe.CLOCKWISE)&&(g=!0),g&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(i,r){let c=i.getEdge().getCoordinates();if(r<0||r+1>=c.length||c[r].y===c[r+1].y)return-1;let f=Ce.LEFT;return c[r].y<c[r+1].y&&(f=Ce.RIGHT),f}getEdge(){return this._orientedDe}checkForRightmostCoordinate(i){let r=i.getEdge().getCoordinates();for(let c=0;c<r.length-1;c++)(this._minCoord===null||r[c].x>this._minCoord.x)&&(this._minDe=i,this._minIndex=c,this._minCoord=r[c])}findRightmostEdgeAtNode(){let i=this._minDe.getNode().getEdges();this._minDe=i.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(i){for(let r=i.iterator();r.hasNext();){let c=r.next();c.isForward()&&this.checkForRightmostCoordinate(c)}d.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ce.LEFT&&(this._orientedDe=this._minDe.getSym())}}class ny{constructor(){this.array=[]}addLast(i){this.array.push(i)}removeFirst(){return this.array.shift()}isEmpty(){return this.array.length===0}}class iy{constructor(){iy.constructor_.apply(this,arguments)}static constructor_(){this._finder=null,this._dirEdgeList=new M,this._nodes=new M,this._rightMostCoord=null,this._env=null,this._finder=new ty}clearVisitedEdges(){for(let i=this._dirEdgeList.iterator();i.hasNext();)i.next().setVisited(!1)}compareTo(i){let r=i;return this._rightMostCoord.x<r._rightMostCoord.x?-1:this._rightMostCoord.x>r._rightMostCoord.x?1:0}getEnvelope(){if(this._env===null){let i=new K;for(let r=this._dirEdgeList.iterator();r.hasNext();){let c=r.next().getEdge().getCoordinates();for(let f=0;f<c.length-1;f++)i.expandToInclude(c[f])}this._env=i}return this._env}addReachable(i){let r=new Ia;for(r.add(i);!r.empty();){let c=r.pop();this.add(c,r)}}copySymDepths(i){let r=i.getSym();r.setDepth(Ce.LEFT,i.getDepth(Ce.RIGHT)),r.setDepth(Ce.RIGHT,i.getDepth(Ce.LEFT))}add(i,r){i.setVisited(!0),this._nodes.add(i);for(let c=i.getEdges().iterator();c.hasNext();){let f=c.next();this._dirEdgeList.add(f);let g=f.getSym().getNode();g.isVisited()||r.push(g)}}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(i){let r=null;for(let c=i.getEdges().iterator();c.hasNext();){let f=c.next();if(f.isVisited()||f.getSym().isVisited()){r=f;break}}if(r===null)throw new ts("unable to find edge to compute depths at "+i.getCoordinate());i.getEdges().computeDepths(r);for(let c=i.getEdges().iterator();c.hasNext();){let f=c.next();f.setVisited(!0),this.copySymDepths(f)}}computeDepth(i){this.clearVisitedEdges();let r=this._finder.getEdge();r.getNode(),r.getLabel(),r.setEdgeDepths(Ce.RIGHT,i),this.copySymDepths(r),this.computeDepths(r)}create(i){this.addReachable(i),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(let i=this._dirEdgeList.iterator();i.hasNext();){let r=i.next();r.getDepth(Ce.RIGHT)>=1&&r.getDepth(Ce.LEFT)<=0&&!r.isInteriorAreaEdge()&&r.setInResult(!0)}}computeDepths(i){let r=new xn,c=new ny,f=i.getNode();for(c.addLast(f),r.add(f),i.setVisited(!0);!c.isEmpty();){let g=c.removeFirst();r.add(g),this.computeNodeDepth(g);for(let y=g.getEdges().iterator();y.hasNext();){let S=y.next().getSym();if(S.isVisited())continue;let I=S.getNode();r.contains(I)||(c.addLast(I),r.add(I))}}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}get interfaces_(){return[a]}}class Wn{constructor(){Wn.constructor_.apply(this,arguments)}static constructor_(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=pe.COUNTERCLOCKWISE;let i=arguments[0];this._inputLine=i}static simplify(i,r){return new Wn(i).simplify(r)}isDeletable(i,r,c,f){let g=this._inputLine[i],y=this._inputLine[r],S=this._inputLine[c];return!!this.isConcave(g,y,S)&&!!this.isShallow(g,y,S,f)&&this.isShallowSampled(g,y,i,c,f)}deleteShallowConcavities(){let i=1,r=this.findNextNonDeletedIndex(i),c=this.findNextNonDeletedIndex(r),f=!1;for(;c<this._inputLine.length;){let g=!1;this.isDeletable(i,r,c,this._distanceTol)&&(this._isDeleted[r]=Wn.DELETE,g=!0,f=!0),i=g?c:r,r=this.findNextNonDeletedIndex(i),c=this.findNextNonDeletedIndex(r)}return f}isShallowConcavity(i,r,c,f){return pe.index(i,r,c)!==this._angleOrientation?!1:qe.pointToSegment(r,i,c)<f}isShallowSampled(i,r,c,f,g){let y=Math.trunc((f-c)/Wn.NUM_PTS_TO_CHECK);y<=0&&(y=1);for(let S=c;S<f;S+=y)if(!this.isShallow(i,r,this._inputLine[S],g))return!1;return!0}isConcave(i,r,c){return pe.index(i,r,c)===this._angleOrientation}simplify(i){this._distanceTol=Math.abs(i),i<0&&(this._angleOrientation=pe.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);let r=!1;do r=this.deleteShallowConcavities();while(r);return this.collapseLine()}findNextNonDeletedIndex(i){let r=i+1;for(;r<this._inputLine.length&&this._isDeleted[r]===Wn.DELETE;)r++;return r}isShallow(i,r,c,f){return qe.pointToSegment(r,i,c)<f}collapseLine(){let i=new E;for(let r=0;r<this._inputLine.length;r++)this._isDeleted[r]!==Wn.DELETE&&i.add(this._inputLine[r]);return i.toCoordinateArray()}}Wn.INIT=0,Wn.DELETE=1,Wn.KEEP=1,Wn.NUM_PTS_TO_CHECK=10;class ku{constructor(){ku.constructor_.apply(this,arguments)}static constructor_(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new M}getCoordinates(){return this._ptList.toArray(ku.COORDINATE_ARRAY_TYPE)}setPrecisionModel(i){this._precisionModel=i}addPt(i){let r=new w(i);if(this._precisionModel.makePrecise(r),this.isRedundant(r))return null;this._ptList.add(r)}reverse(){}addPts(i,r){if(r)for(let c=0;c<i.length;c++)this.addPt(i[c]);else for(let c=i.length-1;c>=0;c--)this.addPt(i[c])}isRedundant(i){if(this._ptList.size()<1)return!1;let r=this._ptList.get(this._ptList.size()-1);return i.distance(r)<this._minimimVertexDistance}toString(){return new vt().createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;let i=new w(this._ptList.get(0)),r=this._ptList.get(this._ptList.size()-1);if(i.equals(r))return null;this._ptList.add(i)}setMinimumVertexDistance(i){this._minimimVertexDistance=i}}ku.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class Gs{constructor(){Gs.constructor_.apply(this,arguments)}static constructor_(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Ze,this._seg1=new Ze,this._offset0=new Ze,this._offset1=new Ze,this._side=0,this._hasNarrowConcaveAngle=!1;let i=arguments[0],r=arguments[1],c=arguments[2];this._precisionModel=i,this._bufParams=r,this._li=new wn,this._filletAngleQuantum=Math.PI/2/r.getQuadrantSegments(),r.getQuadrantSegments()>=8&&r.getJoinStyle()===mt.JOIN_ROUND&&(this._closingSegLengthFactor=Gs.MAX_CLOSING_SEG_LEN_FACTOR),this.init(c)}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(i,r,c,f){let g=Ee.intersection(r.p0,r.p1,c.p0,c.p1);if(g!==null&&(f<=0?1:g.distance(i)/Math.abs(f))<=this._bufParams.getMitreLimit())return this._segList.addPt(g),null;this.addLimitedMitreJoin(r,c,f,this._bufParams.getMitreLimit())}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(i,r,c){this._s1=i,this._s2=r,this._side=c,this._seg1.setCoordinates(i,r),this.computeOffsetSegment(this._seg1,c,this._distance,this._offset1)}addLimitedMitreJoin(i,r,c,f){let g=this._seg0.p1,y=ct.angle(g,this._seg0.p0),S=ct.angleBetweenOriented(this._seg0.p0,g,this._seg1.p1)/2,I=ct.normalize(y+S),z=ct.normalize(I+Math.PI),ne=f*c,he=c-ne*Math.abs(Math.sin(S)),Ie=g.x+ne*Math.cos(z),Oe=g.y+ne*Math.sin(z),Ue=new w(Ie,Oe),ut=new Ze(g,Ue),cn=ut.pointAlongOffset(1,he),Oi=ut.pointAlongOffset(1,-he);this._side===Ce.LEFT?(this._segList.addPt(cn),this._segList.addPt(Oi)):(this._segList.addPt(Oi),this._segList.addPt(cn))}addDirectedFillet(i,r,c,f,g){let y=f===pe.CLOCKWISE?-1:1,S=Math.abs(r-c),I=Math.trunc(S/this._filletAngleQuantum+.5);if(I<1)return null;let z=S/I,ne=new w;for(let he=0;he<I;he++){let Ie=r+y*he*z;ne.x=i.x+g*Math.cos(Ie),ne.y=i.y+g*Math.sin(Ie),this._segList.addPt(ne)}}computeOffsetSegment(i,r,c,f){let g=r===Ce.LEFT?1:-1,y=i.p1.x-i.p0.x,S=i.p1.y-i.p0.y,I=Math.sqrt(y*y+S*S),z=g*c*y/I,ne=g*c*S/I;f.p0.x=i.p0.x-ne,f.p0.y=i.p0.y+z,f.p1.x=i.p1.x-ne,f.p1.y=i.p1.y+z}addInsideTurn(i,r){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Gs.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){let c=new w((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(c);let f=new w((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(f)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(i){let r=new w(i.x+this._distance,i.y);this._segList.addPt(r),this.addDirectedFillet(i,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(i,r){this._segList.addPt(i.p1),this._segList.addPt(r.p0)}init(i){this._distance=i,this._maxCurveSegmentError=i*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ku,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(i*Gs.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(i){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===mt.JOIN_BEVEL||this._bufParams.getJoinStyle()===mt.JOIN_MITRE?(i&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,pe.CLOCKWISE,this._distance))}addNextSegment(i,r){if(this._s0=this._s1,this._s1=this._s2,this._s2=i,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;let c=pe.index(this._s0,this._s1,this._s2),f=c===pe.CLOCKWISE&&this._side===Ce.LEFT||c===pe.COUNTERCLOCKWISE&&this._side===Ce.RIGHT;c===0?this.addCollinear(r):f?this.addOutsideTurn(c,r):this.addInsideTurn(c,r)}addLineEndCap(i,r){let c=new Ze(i,r),f=new Ze;this.computeOffsetSegment(c,Ce.LEFT,this._distance,f);let g=new Ze;this.computeOffsetSegment(c,Ce.RIGHT,this._distance,g);let y=r.x-i.x,S=r.y-i.y,I=Math.atan2(S,y);switch(this._bufParams.getEndCapStyle()){case mt.CAP_ROUND:this._segList.addPt(f.p1),this.addDirectedFillet(r,I+Math.PI/2,I-Math.PI/2,pe.CLOCKWISE,this._distance),this._segList.addPt(g.p1);break;case mt.CAP_FLAT:this._segList.addPt(f.p1),this._segList.addPt(g.p1);break;case mt.CAP_SQUARE:let z=new w;z.x=Math.abs(this._distance)*Math.cos(I),z.y=Math.abs(this._distance)*Math.sin(I);let ne=new w(f.p1.x+z.x,f.p1.y+z.y),he=new w(g.p1.x+z.x,g.p1.y+z.y);this._segList.addPt(ne),this._segList.addPt(he)}}addOutsideTurn(i,r){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Gs.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===mt.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===mt.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(r&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,i,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(i){this._segList.addPt(new w(i.x+this._distance,i.y+this._distance)),this._segList.addPt(new w(i.x+this._distance,i.y-this._distance)),this._segList.addPt(new w(i.x-this._distance,i.y-this._distance)),this._segList.addPt(new w(i.x-this._distance,i.y+this._distance)),this._segList.closeRing()}addSegments(i,r){this._segList.addPts(i,r)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(i,r,c,f,g){let y=r.x-i.x,S=r.y-i.y,I=Math.atan2(S,y),z=c.x-i.x,ne=c.y-i.y,he=Math.atan2(ne,z);f===pe.CLOCKWISE?I<=he&&(I+=2*Math.PI):I>=he&&(I-=2*Math.PI),this._segList.addPt(r),this.addDirectedFillet(i,I,he,f,g),this._segList.addPt(c)}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}}Gs.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Gs.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Gs.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Gs.MAX_CLOSING_SEG_LEN_FACTOR=80;class yf{constructor(){yf.constructor_.apply(this,arguments)}static constructor_(){this._distance=0,this._precisionModel=null,this._bufParams=null;let i=arguments[0],r=arguments[1];this._precisionModel=i,this._bufParams=r}static copyCoordinates(i){let r=new Array(i.length).fill(null);for(let c=0;c<r.length;c++)r[c]=new w(i[c]);return r}getOffsetCurve(i,r){if(this._distance=r,r===0)return null;let c=r<0,f=Math.abs(r),g=this.getSegGen(f);i.length<=1?this.computePointCurve(i[0],g):this.computeOffsetCurve(i,c,g);let y=g.getCoordinates();return c&&Be.reverse(y),y}computeSingleSidedBufferCurve(i,r,c){let f=this.simplifyTolerance(this._distance);if(r){c.addSegments(i,!0);let g=Wn.simplify(i,-f),y=g.length-1;c.initSideSegments(g[y],g[y-1],Ce.LEFT),c.addFirstSegment();for(let S=y-2;S>=0;S--)c.addNextSegment(g[S],!0)}else{c.addSegments(i,!1);let g=Wn.simplify(i,f),y=g.length-1;c.initSideSegments(g[0],g[1],Ce.LEFT),c.addFirstSegment();for(let S=2;S<=y;S++)c.addNextSegment(g[S],!0)}c.addLastSegment(),c.closeRing()}computeRingBufferCurve(i,r,c){let f=this.simplifyTolerance(this._distance);r===Ce.RIGHT&&(f=-f);let g=Wn.simplify(i,f),y=g.length-1;c.initSideSegments(g[y-1],g[0],r);for(let S=1;S<=y;S++){let I=S!==1;c.addNextSegment(g[S],I)}c.closeRing()}computeLineBufferCurve(i,r){let c=this.simplifyTolerance(this._distance),f=Wn.simplify(i,c),g=f.length-1;r.initSideSegments(f[0],f[1],Ce.LEFT);for(let I=2;I<=g;I++)r.addNextSegment(f[I],!0);r.addLastSegment(),r.addLineEndCap(f[g-1],f[g]);let y=Wn.simplify(i,-c),S=y.length-1;r.initSideSegments(y[S],y[S-1],Ce.LEFT);for(let I=S-2;I>=0;I--)r.addNextSegment(y[I],!0);r.addLastSegment(),r.addLineEndCap(y[1],y[0]),r.closeRing()}computePointCurve(i,r){switch(this._bufParams.getEndCapStyle()){case mt.CAP_ROUND:r.createCircle(i);break;case mt.CAP_SQUARE:r.createSquare(i)}}getLineCurve(i,r){if(this._distance=r,this.isLineOffsetEmpty(r))return null;let c=Math.abs(r),f=this.getSegGen(c);if(i.length<=1)this.computePointCurve(i[0],f);else if(this._bufParams.isSingleSided()){let g=r<0;this.computeSingleSidedBufferCurve(i,g,f)}else this.computeLineBufferCurve(i,f);return f.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(i){return i*this._bufParams.getSimplifyFactor()}getRingCurve(i,r,c){if(this._distance=c,i.length<=2)return this.getLineCurve(i,c);if(c===0)return yf.copyCoordinates(i);let f=this.getSegGen(c);return this.computeRingBufferCurve(i,r,f),f.getCoordinates()}computeOffsetCurve(i,r,c){let f=this.simplifyTolerance(this._distance);if(r){let g=Wn.simplify(i,-f),y=g.length-1;c.initSideSegments(g[y],g[y-1],Ce.LEFT),c.addFirstSegment();for(let S=y-2;S>=0;S--)c.addNextSegment(g[S],!0)}else{let g=Wn.simplify(i,f),y=g.length-1;c.initSideSegments(g[0],g[1],Ce.LEFT),c.addFirstSegment();for(let S=2;S<=y;S++)c.addNextSegment(g[S],!0)}c.addLastSegment()}isLineOffsetEmpty(i){return i===0||i<0&&!this._bufParams.isSingleSided()}getSegGen(i){return new Gs(this._precisionModel,this._bufParams,i)}}class mi{constructor(){mi.constructor_.apply(this,arguments)}static constructor_(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){let i=arguments[0];this.init(i.length)}else if(Number.isInteger(arguments[0])){let i=arguments[0];this.init(1),this.location[Ce.ON]=i}else if(arguments[0]instanceof mi){let i=arguments[0];if(this.init(i.location.length),i!==null)for(let r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this.init(3),this.location[Ce.ON]=i,this.location[Ce.LEFT]=r,this.location[Ce.RIGHT]=c}}setAllLocations(i){for(let r=0;r<this.location.length;r++)this.location[r]=i}isNull(){for(let i=0;i<this.location.length;i++)if(this.location[i]!==B.NONE)return!1;return!0}setAllLocationsIfNull(i){for(let r=0;r<this.location.length;r++)this.location[r]===B.NONE&&(this.location[r]=i)}isLine(){return this.location.length===1}merge(i){if(i.location.length>this.location.length){let r=new Array(3).fill(null);r[Ce.ON]=this.location[Ce.ON],r[Ce.LEFT]=B.NONE,r[Ce.RIGHT]=B.NONE,this.location=r}for(let r=0;r<this.location.length;r++)this.location[r]===B.NONE&&r<i.location.length&&(this.location[r]=i.location[r])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;let i=this.location[Ce.LEFT];this.location[Ce.LEFT]=this.location[Ce.RIGHT],this.location[Ce.RIGHT]=i}get(i){return i<this.location.length?this.location[i]:B.NONE}isEqualOnSide(i,r){return this.location[r]===i.location[r]}allPositionsEqual(i){for(let r=0;r<this.location.length;r++)if(this.location[r]!==i)return!1;return!0}toString(){let i=new te;return this.location.length>1&&i.append(B.toLocationSymbol(this.location[Ce.LEFT])),i.append(B.toLocationSymbol(this.location[Ce.ON])),this.location.length>1&&i.append(B.toLocationSymbol(this.location[Ce.RIGHT])),i.toString()}setLocations(i,r,c){this.location[Ce.ON]=i,this.location[Ce.LEFT]=r,this.location[Ce.RIGHT]=c}isArea(){return this.location.length>1}isAnyNull(){for(let i=0;i<this.location.length;i++)if(this.location[i]===B.NONE)return!0;return!1}setLocation(){if(arguments.length===1){let i=arguments[0];this.setLocation(Ce.ON,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.location[i]=r}}init(i){this.location=new Array(i).fill(null),this.setAllLocations(B.NONE)}}class Jt{constructor(){Jt.constructor_.apply(this,arguments)}static constructor_(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){let i=arguments[0];this.elt[0]=new mi(i),this.elt[1]=new mi(i)}else if(arguments[0]instanceof Jt){let i=arguments[0];this.elt[0]=new mi(i.elt[0]),this.elt[1]=new mi(i.elt[1])}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.elt[0]=new mi(B.NONE),this.elt[1]=new mi(B.NONE),this.elt[i].setLocation(r)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this.elt[0]=new mi(i,r,c),this.elt[1]=new mi(i,r,c)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this.elt[0]=new mi(B.NONE,B.NONE,B.NONE),this.elt[1]=new mi(B.NONE,B.NONE,B.NONE),this.elt[i].setLocations(r,c,f)}}static toLineLabel(i){let r=new Jt(B.NONE);for(let c=0;c<2;c++)r.setLocation(c,i.getLocation(c));return r}getGeometryCount(){let i=0;return this.elt[0].isNull()||i++,this.elt[1].isNull()||i++,i}setAllLocations(i,r){this.elt[i].setAllLocations(r)}isNull(i){return this.elt[i].isNull()}setAllLocationsIfNull(){if(arguments.length===1){let i=arguments[0];this.setAllLocationsIfNull(0,i),this.setAllLocationsIfNull(1,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.elt[i].setAllLocationsIfNull(r)}}isLine(i){return this.elt[i].isLine()}merge(i){for(let r=0;r<2;r++)this.elt[r]===null&&i.elt[r]!==null?this.elt[r]=new mi(i.elt[r]):this.elt[r].merge(i.elt[r])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(arguments.length===1){let i=arguments[0];return this.elt[i].get(Ce.ON)}if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.elt[i].get(r)}}toString(){let i=new te;return this.elt[0]!==null&&(i.append("A:"),i.append(this.elt[0].toString())),this.elt[1]!==null&&(i.append(" B:"),i.append(this.elt[1].toString())),i.toString()}setLocation(){if(arguments.length===2){let i=arguments[0],r=arguments[1];this.elt[i].setLocation(Ce.ON,r)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this.elt[i].setLocation(r,c)}}isEqualOnSide(i,r){return this.elt[0].isEqualOnSide(i.elt[0],r)&&this.elt[1].isEqualOnSide(i.elt[1],r)}allPositionsEqual(i,r){return this.elt[i].allPositionsEqual(r)}toLine(i){this.elt[i].isArea()&&(this.elt[i]=new mi(this.elt[i].location[0]))}isArea(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){let i=arguments[0];return this.elt[i].isArea()}}isAnyNull(i){return this.elt[i].isAnyNull()}}let bS=class s4{constructor(){s4.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this._label=i}}}setVisited(i){this._isVisited=i}setInResult(i){this._isInResult=i}setLabel(i){this._label=i}getLabel(){return this._label}setCovered(i){this._isCovered=i,this._isCoveredSet=!0}updateIM(i){d.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(i)}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}isInResult(){return this._isInResult}isVisited(){return this._isVisited}},Rl=class ew extends bS{constructor(){super(),ew.constructor_.apply(this,arguments)}static constructor_(){this._coord=null,this._edges=null;let i=arguments[0],r=arguments[1];this._coord=i,this._edges=r,this._label=new Jt(0,B.NONE)}isIncidentEdgeInResult(){for(let i=this.getEdges().getEdges().iterator();i.hasNext();)if(i.next().getEdge().isInResult())return!0;return!1}isIsolated(){return this._label.getGeometryCount()===1}getCoordinate(){return this._coord}computeMergedLocation(i,r){let c=B.NONE;if(c=this._label.getLocation(r),!i.isNull(r)){let f=i.getLocation(r);c!==B.BOUNDARY&&(c=f)}return c}setLabel(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{let i=arguments[0],r=arguments[1];this._label===null?this._label=new Jt(i,r):this._label.setLocation(i,r)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof ew){let i=arguments[0];this.mergeLabel(i._label)}else if(arguments[0]instanceof Jt){let i=arguments[0];for(let r=0;r<2;r++){let c=this.computeMergedLocation(i,r);this._label.getLocation(r)===B.NONE&&this._label.setLocation(r,c)}}}add(i){this._edges.insert(i),i.setNode(this)}setLabelBoundary(i){if(this._label===null)return null;let r=B.NONE;this._label!==null&&(r=this._label.getLocation(i));let c=null;switch(r){case B.BOUNDARY:c=B.INTERIOR;break;case B.INTERIOR:default:c=B.BOUNDARY}this._label.setLocation(i,c)}print(i){i.println("node "+this._coord+" lbl: "+this._label)}computeIM(i){}},vf=class r4{constructor(){r4.constructor_.apply(this,arguments)}static constructor_(){this.nodeMap=new bs,this.nodeFact=null;let i=arguments[0];this.nodeFact=i}print(i){for(let r=this.iterator();r.hasNext();)r.next().print(i)}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(i){let r=new M;for(let c=this.iterator();c.hasNext();){let f=c.next();f.getLabel().getLocation(i)===B.BOUNDARY&&r.add(f)}return r}add(i){let r=i.getCoordinate();this.addNode(r).add(i)}find(i){return this.nodeMap.get(i)}addNode(){if(arguments[0]instanceof w){let i=arguments[0],r=this.nodeMap.get(i);return r===null&&(r=this.nodeFact.createNode(i),this.nodeMap.put(i,r)),r}if(arguments[0]instanceof Rl){let i=arguments[0],r=this.nodeMap.get(i.getCoordinate());return r===null?(this.nodeMap.put(i.getCoordinate(),i),i):(r.mergeLabel(i),r)}}};class sy{createNode(i){return new Rl(i,null)}}class sr{constructor(){sr.constructor_.apply(this,arguments)}static constructor_(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){let i=arguments[0];this._edge=i}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];sr.constructor_.call(this,i,r,c,null)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];sr.constructor_.call(this,i),this.init(r,c),this._label=f}}compareDirection(i){return this._dx===i._dx&&this._dy===i._dy?0:this._quadrant>i._quadrant?1:this._quadrant<i._quadrant?-1:pe.index(i._p0,i._p1,this._p1)}getDy(){return this._dy}print(i){let r=Math.atan2(this._dy,this._dx),c=this.getClass().getName(),f=c.lastIndexOf("."),g=c.substring(f+1);i.print("  "+g+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+r+"   "+this._label)}getLabel(){return this._label}getEdge(){return this._edge}toString(){let i=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),c=r.lastIndexOf(".");return"  "+r.substring(c+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+i+"   "+this._label}computeLabel(i){}init(i,r){this._p0=i,this._p1=r,this._dx=r.x-i.x,this._dy=r.y-i.y,this._quadrant=kt.quadrant(this._dx,this._dy),d.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}getCoordinate(){return this._p0}setNode(i){this._node=i}compareTo(i){let r=i;return this.compareDirection(r)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getQuadrant(){return this._quadrant}getNode(){return this._node}get interfaces_(){return[a]}}let ry=class o4 extends sr{constructor(){super(),o4.constructor_.apply(this,arguments)}static constructor_(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];let i=arguments[0],r=arguments[1];if(sr.constructor_.call(this,i),this._isForward=r,r)this.init(i.getCoordinate(0),i.getCoordinate(1));else{let c=i.getNumPoints()-1;this.init(i.getCoordinate(c),i.getCoordinate(c-1))}this.computeDirectedLabel()}static depthFactor(i,r){return i===B.EXTERIOR&&r===B.INTERIOR?1:i===B.INTERIOR&&r===B.EXTERIOR?-1:0}setVisited(i){this._isVisited=i}setDepth(i,r){if(this._depth[i]!==-999&&this._depth[i]!==r)throw new ts("assigned depths do not match",this.getCoordinate());this._depth[i]=r}isInteriorAreaEdge(){let i=!0;for(let r=0;r<2;r++)this._label.isArea(r)&&this._label.getLocation(r,Ce.LEFT)===B.INTERIOR&&this._label.getLocation(r,Ce.RIGHT)===B.INTERIOR||(i=!1);return i}setNextMin(i){this._nextMin=i}print(i){super.print.call(this,i),i.print(" "+this._depth[Ce.LEFT]+"/"+this._depth[Ce.RIGHT]),i.print(" ("+this.getDepthDelta()+")"),this._isInResult&&i.print(" inResult")}setMinEdgeRing(i){this._minEdgeRing=i}getSym(){return this._sym}isForward(){return this._isForward}setSym(i){this._sym=i}setVisitedEdge(i){this.setVisited(i),this._sym.setVisited(i)}getNextMin(){return this._nextMin}getDepth(i){return this._depth[i]}computeDirectedLabel(){this._label=new Jt(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}isLineEdge(){let i=this._label.isLine(0)||this._label.isLine(1),r=!this._label.isArea(0)||this._label.allPositionsEqual(0,B.EXTERIOR),c=!this._label.isArea(1)||this._label.allPositionsEqual(1,B.EXTERIOR);return i&&r&&c}setEdgeRing(i){this._edgeRing=i}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){let i=this._edge.getDepthDelta();return this._isForward||(i=-i),i}setInResult(i){this._isInResult=i}getEdge(){return this._edge}printEdge(i){this.print(i),i.print(" "),this._isForward?this._edge.print(i):this._edge.printReverse(i)}setEdgeDepths(i,r){let c=this.getEdge().getDepthDelta();this._isForward||(c=-c);let f=1;i===Ce.LEFT&&(f=-1);let g=Ce.opposite(i),y=r+c*f;this.setDepth(i,r),this.setDepth(g,y)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(i){this._next=i}isVisited(){return this._isVisited}},Ru=class a4{constructor(){a4.constructor_.apply(this,arguments)}static constructor_(){if(this._edges=new M,this._nodes=null,this._edgeEndList=new M,arguments.length===0)this._nodes=new vf(new sy);else if(arguments.length===1){let i=arguments[0];this._nodes=new vf(i)}}static linkResultDirectedEdges(i){for(let r=i.iterator();r.hasNext();)r.next().getEdges().linkResultDirectedEdges()}printEdges(i){i.println("Edges:");for(let r=0;r<this._edges.size();r++){i.println("edge "+r+":");let c=this._edges.get(r);c.print(i),c.eiList.print(i)}}debugPrintln(i){Fe.out.println(i)}isBoundaryNode(i,r){let c=this._nodes.find(r);if(c===null)return!1;let f=c.getLabel();return f!==null&&f.getLocation(i)===B.BOUNDARY}linkAllDirectedEdges(){for(let i=this._nodes.iterator();i.hasNext();)i.next().getEdges().linkAllDirectedEdges()}debugPrint(i){Fe.out.print(i)}findEdgeEnd(i){for(let r=this.getEdgeEnds().iterator();r.hasNext();){let c=r.next();if(c.getEdge()===i)return c}return null}getNodes(){return this._nodes.values()}findEdge(i,r){for(let c=0;c<this._edges.size();c++){let f=this._edges.get(c),g=f.getCoordinates();if(i.equals(g[0])&&r.equals(g[1]))return f}return null}find(i){return this._nodes.find(i)}addNode(){if(arguments[0]instanceof Rl){let i=arguments[0];return this._nodes.addNode(i)}if(arguments[0]instanceof w){let i=arguments[0];return this._nodes.addNode(i)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(let i=this._nodes.iterator();i.hasNext();)i.next().getEdges().linkResultDirectedEdges()}matchInSameDirection(i,r,c,f){return!!i.equals(c)&&pe.index(i,r,f)===pe.COLLINEAR&&kt.quadrant(i,r)===kt.quadrant(c,f)}getEdgeEnds(){return this._edgeEndList}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(i,r){for(let c=0;c<this._edges.size();c++){let f=this._edges.get(c),g=f.getCoordinates();if(this.matchInSameDirection(i,r,g[0],g[1])||this.matchInSameDirection(i,r,g[g.length-1],g[g.length-2]))return f}return null}insertEdge(i){this._edges.add(i)}addEdges(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this._edges.add(c);let f=new ry(c,!0),g=new ry(c,!1);f.setSym(g),g.setSym(f),this.add(f),this.add(g)}}add(i){this._nodes.add(i),this._edgeEndList.add(i)}},bf=class l4{constructor(){l4.constructor_.apply(this,arguments)}static constructor_(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new M,this._pts=new M,this._label=new Jt(B.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new M,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){let i=arguments[0],r=arguments[1];this._geometryFactory=r,this.computePoints(i),this.computeRing()}}}computeRing(){if(this._ring!==null)return null;let i=new Array(this._pts.size()).fill(null);for(let r=0;r<this._pts.size();r++)i[r]=this._pts.get(r);this._ring=this._geometryFactory.createLinearRing(i),this._isHole=pe.isCCW(this._ring.getCoordinates())}isIsolated(){return this._label.getGeometryCount()===1}computePoints(i){this._startDe=i;let r=i,c=!0;do{if(r===null)throw new ts("Found null DirectedEdge");if(r.getEdgeRing()===this)throw new ts("Directed Edge visited twice during ring-building at "+r.getCoordinate());this._edges.add(r);let f=r.getLabel();d.isTrue(f.isArea()),this.mergeLabel(f),this.addPoints(r.getEdge(),r.isForward(),c),c=!1,this.setEdgeRing(r,this),r=this.getNext(r)}while(r!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(i){return this._pts.get(i)}computeMaxNodeDegree(){this._maxNodeDegree=0;let i=this._startDe;do{let r=i.getNode().getEdges().getOutgoingDegree(this);r>this._maxNodeDegree&&(this._maxNodeDegree=r),i=this.getNext(i)}while(i!==this._startDe);this._maxNodeDegree*=2}addPoints(i,r,c){let f=i.getCoordinates();if(r){let g=1;c&&(g=0);for(let y=g;y<f.length;y++)this._pts.add(f[y])}else{let g=f.length-2;c&&(g=f.length-1);for(let y=g;y>=0;y--)this._pts.add(f[y])}}containsPoint(i){let r=this.getLinearRing();if(!r.getEnvelopeInternal().contains(i)||!Ji.isInRing(i,r.getCoordinates()))return!1;for(let c=this._holes.iterator();c.hasNext();)if(c.next().containsPoint(i))return!1;return!0}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}setShell(i){this._shell=i,i!==null&&i.addHole(this)}toPolygon(i){let r=new Array(this._holes.size()).fill(null);for(let c=0;c<this._holes.size();c++)r[c]=this._holes.get(c).getLinearRing();return i.createPolygon(this.getLinearRing(),r)}isHole(){return this._isHole}setInResult(){let i=this._startDe;do i.getEdge().setInResult(!0),i=i.getNext();while(i!==this._startDe)}addHole(i){this._holes.add(i)}isShell(){return this._shell===null}getLabel(){return this._label}getEdges(){return this._edges}getShell(){return this._shell}mergeLabel(){if(arguments.length===1){let i=arguments[0];this.mergeLabel(i,0),this.mergeLabel(i,1)}else if(arguments.length===2){let i=arguments[1],r=arguments[0].getLocation(i,Ce.RIGHT);if(r===B.NONE)return null;if(this._label.getLocation(i)===B.NONE)return this._label.setLocation(i,r),null}}};class oy extends bf{constructor(){super(),oy.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];bf.constructor_.call(this,i,r)}getNext(i){return i.getNextMin()}setEdgeRing(i,r){i.setMinEdgeRing(r)}}class xf extends bf{constructor(){super(),xf.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];bf.constructor_.call(this,i,r)}linkDirectedEdgesForMinimalEdgeRings(){let i=this._startDe;do i.getNode().getEdges().linkMinimalDirectedEdges(this),i=i.getNext();while(i!==this._startDe)}buildMinimalRings(){let i=new M,r=this._startDe;do{if(r.getMinEdgeRing()===null){let c=new oy(r,this._geometryFactory);i.add(c)}r=r.getNext()}while(r!==this._startDe);return i}getNext(i){return i.getNext()}setEdgeRing(i,r){i.setEdgeRing(r)}}class Mu{constructor(){Mu.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=null,this._shellList=new M;let i=arguments[0];this._geometryFactory=i}static findEdgeRingContaining(i,r){let c=i.getLinearRing(),f=c.getEnvelopeInternal(),g=c.getCoordinateN(0),y=null,S=null;for(let I=r.iterator();I.hasNext();){let z=I.next(),ne=z.getLinearRing(),he=ne.getEnvelopeInternal();if(he.equals(f)||!he.contains(f))continue;g=Be.ptNotInList(c.getCoordinates(),ne.getCoordinates());let Ie=!1;Ji.isInRing(g,ne.getCoordinates())&&(Ie=!0),Ie&&(y===null||S.contains(he))&&(y=z,S=y.getLinearRing().getEnvelopeInternal())}return y}sortShellsAndHoles(i,r,c){for(let f=i.iterator();f.hasNext();){let g=f.next();g.isHole()?c.add(g):r.add(g)}}computePolygons(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next().toPolygon(this._geometryFactory);r.add(f)}return r}placeFreeHoles(i,r){for(let c=r.iterator();c.hasNext();){let f=c.next();if(f.getShell()===null){let g=Mu.findEdgeRingContaining(f,i);if(g===null)throw new ts("unable to assign hole to a shell",f.getCoordinate(0));f.setShell(g)}}}buildMinimalEdgeRings(i,r,c){let f=new M;for(let g=i.iterator();g.hasNext();){let y=g.next();if(y.getMaxNodeDegree()>2){y.linkDirectedEdgesForMinimalEdgeRings();let S=y.buildMinimalRings(),I=this.findShell(S);I!==null?(this.placePolygonHoles(I,S),r.add(I)):c.addAll(S)}else f.add(y)}return f}buildMaximalEdgeRings(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next();if(f.isInResult()&&f.getLabel().isArea()&&f.getEdgeRing()===null){let g=new xf(f,this._geometryFactory);r.add(g),g.setInResult()}}return r}placePolygonHoles(i,r){for(let c=r.iterator();c.hasNext();){let f=c.next();f.isHole()&&f.setShell(i)}}getPolygons(){return this.computePolygons(this._shellList)}findShell(i){let r=0,c=null;for(let f=i.iterator();f.hasNext();){let g=f.next();g.isHole()||(c=g,r++)}return d.isTrue(r<=1,"found two shells in MinimalEdgeRing list"),c}add(){if(arguments.length===1){let i=arguments[0];this.add(i.getEdgeEnds(),i.getNodes())}else if(arguments.length===2){let i=arguments[0],r=arguments[1];Ru.linkResultDirectedEdges(r);let c=this.buildMaximalEdgeRings(i),f=new M,g=this.buildMinimalEdgeRings(c,this._shellList,f);this.sortShellsAndHoles(g,this._shellList,f),this.placeFreeHoles(this._shellList,f)}}}class wf{constructor(){wf.constructor_.apply(this,arguments)}static constructor_(){this._subgraphs=null,this._seg=new Ze;let i=arguments[0];this._subgraphs=i}findStabbedSegments(){if(arguments.length===1){let i=arguments[0],r=new M;for(let c=this._subgraphs.iterator();c.hasNext();){let f=c.next(),g=f.getEnvelope();i.y<g.getMinY()||i.y>g.getMaxY()||this.findStabbedSegments(i,f.getDirectedEdges(),r)}return r}if(arguments.length===3){if(P(arguments[2],H)&&arguments[0]instanceof w&&arguments[1]instanceof ry){let i=arguments[0],r=arguments[1],c=arguments[2],f=r.getEdge().getCoordinates();for(let g=0;g<f.length-1;g++){if(this._seg.p0=f[g],this._seg.p1=f[g+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),Math.max(this._seg.p0.x,this._seg.p1.x)<i.x||this._seg.isHorizontal()||i.y<this._seg.p0.y||i.y>this._seg.p1.y||pe.index(this._seg.p0,this._seg.p1,i)===pe.RIGHT)continue;let y=r.getDepth(Ce.LEFT);this._seg.p0.equals(f[g])||(y=r.getDepth(Ce.RIGHT));let S=new Sf(this._seg,y);c.add(S)}}else if(P(arguments[2],H)&&arguments[0]instanceof w&&P(arguments[1],H)){let i=arguments[0],r=arguments[2];for(let c=arguments[1].iterator();c.hasNext();){let f=c.next();f.isForward()&&this.findStabbedSegments(i,f,r)}}}}getDepth(i){let r=this.findStabbedSegments(i);return r.size()===0?0:Le.min(r)._leftDepth}}class Sf{constructor(){Sf.constructor_.apply(this,arguments)}static constructor_(){this._upwardSeg=null,this._leftDepth=null;let i=arguments[0],r=arguments[1];this._upwardSeg=new Ze(i),this._leftDepth=r}compareX(i,r){let c=i.p0.compareTo(r.p0);return c!==0?c:i.p1.compareTo(r.p1)}toString(){return this._upwardSeg.toString()}compareTo(i){let r=i;if(this._upwardSeg.minX()>=r._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=r._upwardSeg.minX())return-1;let c=this._upwardSeg.orientationIndex(r._upwardSeg);return c!==0?c:(c=-1*r._upwardSeg.orientationIndex(this._upwardSeg),c!==0?c:this._upwardSeg.compareTo(r._upwardSeg))}get interfaces_(){return[a]}}wf.DepthSegment=Sf;class ay{constructor(){ay.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new M;let i=arguments[0],r=arguments[1],c=arguments[2];this._inputGeom=i,this._distance=r,this._curveBuilder=c}addRingSide(i,r,c,f,g){if(r===0&&i.length<ae.MINIMUM_VALID_SIZE)return null;let y=f,S=g;i.length>=ae.MINIMUM_VALID_SIZE&&pe.isCCW(i)&&(y=g,S=f,c=Ce.opposite(c));let I=this._curveBuilder.getRingCurve(i,c,r);this.addCurve(I,y,S)}addRingBothSides(i,r){this.addRingSide(i,r,Ce.LEFT,B.EXTERIOR,B.INTERIOR),this.addRingSide(i,r,Ce.RIGHT,B.INTERIOR,B.EXTERIOR)}addPoint(i){if(this._distance<=0)return null;let r=i.getCoordinates(),c=this._curveBuilder.getLineCurve(r,this._distance);this.addCurve(c,B.EXTERIOR,B.INTERIOR)}addPolygon(i){let r=this._distance,c=Ce.LEFT;this._distance<0&&(r=-this._distance,c=Ce.RIGHT);let f=i.getExteriorRing(),g=Be.removeRepeatedPoints(f.getCoordinates());if(this._distance<0&&this.isErodedCompletely(f,this._distance)||this._distance<=0&&g.length<3)return null;this.addRingSide(g,r,c,B.EXTERIOR,B.INTERIOR);for(let y=0;y<i.getNumInteriorRing();y++){let S=i.getInteriorRingN(y),I=Be.removeRepeatedPoints(S.getCoordinates());this._distance>0&&this.isErodedCompletely(S,-this._distance)||this.addRingSide(I,r,Ce.opposite(c),B.INTERIOR,B.EXTERIOR)}}isTriangleErodedCompletely(i,r){let c=new Gt(i[0],i[1],i[2]),f=c.inCentre();return qe.pointToSegment(f,c.p0,c.p1)<Math.abs(r)}addLineString(i){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;let r=Be.removeRepeatedPoints(i.getCoordinates());if(Be.isRing(r)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(r,this._distance);else{let c=this._curveBuilder.getLineCurve(r,this._distance);this.addCurve(c,B.EXTERIOR,B.INTERIOR)}}add(i){if(i.isEmpty())return null;if(i instanceof Et)this.addPolygon(i);else if(i instanceof Z)this.addLineString(i);else if(i instanceof yt)this.addPoint(i);else if(i instanceof Li)this.addCollection(i);else if(i instanceof _n)this.addCollection(i);else if(i instanceof at)this.addCollection(i);else{if(!(i instanceof tt))throw new Je(i.getGeometryType());this.addCollection(i)}}addCurve(i,r,c){if(i===null||i.length<2)return null;let f=new nr(i,new Jt(0,B.BOUNDARY,r,c));this._curveList.add(f)}getCurves(){return this.add(this._inputGeom),this._curveList}isErodedCompletely(i,r){let c=i.getCoordinates();if(c.length<4)return r<0;if(c.length===4)return this.isTriangleErodedCompletely(c,r);let f=i.getEnvelopeInternal(),g=Math.min(f.getHeight(),f.getWidth());return r<0&&2*Math.abs(r)>g}addCollection(i){for(let r=0;r<i.getNumGeometries();r++){let c=i.getGeometryN(r);this.add(c)}}}class Ef{constructor(){Ef.constructor_.apply(this,arguments)}static constructor_(){this._edgeMap=new bs,this._edgeList=null,this._ptInAreaLocation=[B.NONE,B.NONE]}getNextCW(i){this.getEdges();let r=this._edgeList.indexOf(i),c=r-1;return r===0&&(c=this._edgeList.size()-1),this._edgeList.get(c)}propagateSideLabels(i){let r=B.NONE;for(let f=this.iterator();f.hasNext();){let g=f.next().getLabel();g.isArea(i)&&g.getLocation(i,Ce.LEFT)!==B.NONE&&(r=g.getLocation(i,Ce.LEFT))}if(r===B.NONE)return null;let c=r;for(let f=this.iterator();f.hasNext();){let g=f.next(),y=g.getLabel();if(y.getLocation(i,Ce.ON)===B.NONE&&y.setLocation(i,Ce.ON,c),y.isArea(i)){let S=y.getLocation(i,Ce.LEFT),I=y.getLocation(i,Ce.RIGHT);if(I!==B.NONE){if(I!==c)throw new ts("side location conflict",g.getCoordinate());S===B.NONE&&d.shouldNeverReachHere("found single null side (at "+g.getCoordinate()+")"),c=S}else d.isTrue(y.getLocation(i,Ce.LEFT)===B.NONE,"found single null side"),y.setLocation(i,Ce.RIGHT,c),y.setLocation(i,Ce.LEFT,c)}}}getCoordinate(){let i=this.iterator();return i.hasNext()?i.next().getCoordinate():null}checkAreaLabelsConsistent(i){let r=this.getEdges();if(r.size()<=0)return!0;let c=r.size()-1,f=r.get(c).getLabel().getLocation(i,Ce.LEFT);d.isTrue(f!==B.NONE,"Found unlabelled area edge");let g=f;for(let y=this.iterator();y.hasNext();){let S=y.next().getLabel();d.isTrue(S.isArea(i),"Found non-area edge");let I=S.getLocation(i,Ce.LEFT),z=S.getLocation(i,Ce.RIGHT);if(I===z||z!==g)return!1;g=I}return!0}findIndex(i){this.iterator();for(let r=0;r<this._edgeList.size();r++)if(this._edgeList.get(r)===i)return r;return-1}iterator(){return this.getEdges().iterator()}getEdges(){return this._edgeList===null&&(this._edgeList=new M(this._edgeMap.values())),this._edgeList}getLocation(i,r,c){return this._ptInAreaLocation[i]===B.NONE&&(this._ptInAreaLocation[i]=es.locate(r,c[i].getGeometry())),this._ptInAreaLocation[i]}toString(){let i=new te;i.append("EdgeEndStar:   "+this.getCoordinate()),i.append(`
`);for(let r=this.iterator();r.hasNext();){let c=r.next();i.append(c),i.append(`
`)}return i.toString()}computeEdgeEndLabels(i){for(let r=this.iterator();r.hasNext();)r.next().computeLabel(i)}computeLabelling(i){this.computeEdgeEndLabels(i[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);let r=[!1,!1];for(let c=this.iterator();c.hasNext();){let f=c.next().getLabel();for(let g=0;g<2;g++)f.isLine(g)&&f.getLocation(g)===B.BOUNDARY&&(r[g]=!0)}for(let c=this.iterator();c.hasNext();){let f=c.next(),g=f.getLabel();for(let y=0;y<2;y++)if(g.isAnyNull(y)){let S=B.NONE;if(r[y])S=B.EXTERIOR;else{let I=f.getCoordinate();S=this.getLocation(y,I,i)}g.setAllLocationsIfNull(y,S)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(i,r){this._edgeMap.put(i,r),this._edgeList=null}print(i){Fe.out.println("EdgeEndStar:   "+this.getCoordinate());for(let r=this.iterator();r.hasNext();)r.next().print(i)}isAreaLabelsConsistent(i){return this.computeEdgeEndLabels(i.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}}let pP=class c4 extends Ef{constructor(){super(),c4.constructor_.apply(this,arguments)}static constructor_(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}linkResultDirectedEdges(){this.getResultAreaEdges();let i=null,r=null,c=this._SCANNING_FOR_INCOMING;for(let f=0;f<this._resultAreaEdgeList.size();f++){let g=this._resultAreaEdgeList.get(f),y=g.getSym();if(g.getLabel().isArea())switch(i===null&&g.isInResult()&&(i=g),c){case this._SCANNING_FOR_INCOMING:if(!y.isInResult())continue;r=y,c=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!g.isInResult())continue;r.setNext(g),c=this._SCANNING_FOR_INCOMING}}if(c===this._LINKING_TO_OUTGOING){if(i===null)throw new ts("no outgoing dirEdge found",this.getCoordinate());d.isTrue(i.isInResult(),"unable to link last incoming dirEdge"),r.setNext(i)}}insert(i){let r=i;this.insertEdgeEnd(r,r)}getRightmostEdge(){let i=this.getEdges(),r=i.size();if(r<1)return null;let c=i.get(0);if(r===1)return c;let f=i.get(r-1),g=c.getQuadrant(),y=f.getQuadrant();return kt.isNorthern(g)&&kt.isNorthern(y)?c:kt.isNorthern(g)||kt.isNorthern(y)?c.getDy()!==0?c:f.getDy()!==0?f:(d.shouldNeverReachHere("found two horizontal edges incident on node"),null):f}updateLabelling(i){for(let r=this.iterator();r.hasNext();){let c=r.next().getLabel();c.setAllLocationsIfNull(0,i.getLocation(0)),c.setAllLocationsIfNull(1,i.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();let i=null,r=null;for(let c=this._edgeList.size()-1;c>=0;c--){let f=this._edgeList.get(c),g=f.getSym();r===null&&(r=g),i!==null&&g.setNext(i),i=f}r.setNext(i)}computeDepths(){if(arguments.length===1){let i=arguments[0],r=this.findIndex(i),c=i.getDepth(Ce.LEFT),f=i.getDepth(Ce.RIGHT),g=this.computeDepths(r+1,this._edgeList.size(),c);if(this.computeDepths(0,r,g)!==f)throw new ts("depth mismatch at "+i.getCoordinate())}else if(arguments.length===3){let i=arguments[1],r=arguments[2];for(let c=arguments[0];c<i;c++){let f=this._edgeList.get(c);f.setEdgeDepths(Ce.RIGHT,r),r=f.getDepth(Ce.LEFT)}return r}}mergeSymLabels(){for(let i=this.iterator();i.hasNext();){let r=i.next();r.getLabel().merge(r.getSym().getLabel())}}linkMinimalDirectedEdges(i){let r=null,c=null,f=this._SCANNING_FOR_INCOMING;for(let g=this._resultAreaEdgeList.size()-1;g>=0;g--){let y=this._resultAreaEdgeList.get(g),S=y.getSym();switch(r===null&&y.getEdgeRing()===i&&(r=y),f){case this._SCANNING_FOR_INCOMING:if(S.getEdgeRing()!==i)continue;c=S,f=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(y.getEdgeRing()!==i)continue;c.setNextMin(y),f=this._SCANNING_FOR_INCOMING}}f===this._LINKING_TO_OUTGOING&&(d.isTrue(r!==null,"found null for first outgoing dirEdge"),d.isTrue(r.getEdgeRing()===i,"unable to link last incoming dirEdge"),c.setNextMin(r))}getOutgoingDegree(){if(arguments.length===0){let i=0;for(let r=this.iterator();r.hasNext();)r.next().isInResult()&&i++;return i}if(arguments.length===1){let i=arguments[0],r=0;for(let c=this.iterator();c.hasNext();)c.next().getEdgeRing()===i&&r++;return r}}getLabel(){return this._label}findCoveredLineEdges(){let i=B.NONE;for(let c=this.iterator();c.hasNext();){let f=c.next(),g=f.getSym();if(!f.isLineEdge()){if(f.isInResult()){i=B.INTERIOR;break}if(g.isInResult()){i=B.EXTERIOR;break}}}if(i===B.NONE)return null;let r=i;for(let c=this.iterator();c.hasNext();){let f=c.next(),g=f.getSym();f.isLineEdge()?f.getEdge().setCovered(r===B.INTERIOR):(f.isInResult()&&(r=B.EXTERIOR),g.isInResult()&&(r=B.INTERIOR))}}computeLabelling(i){super.computeLabelling.call(this,i),this._label=new Jt(B.NONE);for(let r=this.iterator();r.hasNext();){let c=r.next().getEdge().getLabel();for(let f=0;f<2;f++){let g=c.getLocation(f);g!==B.INTERIOR&&g!==B.BOUNDARY||this._label.setLocation(f,B.INTERIOR)}}}print(i){Fe.out.println("DirectedEdgeStar: "+this.getCoordinate());for(let r=this.iterator();r.hasNext();){let c=r.next();i.print("out "),c.print(i),i.println(),i.print("in "),c.getSym().print(i),i.println()}}getResultAreaEdges(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new M;for(let i=this.iterator();i.hasNext();){let r=i.next();(r.isInResult()||r.getSym().isInResult())&&this._resultAreaEdgeList.add(r)}return this._resultAreaEdgeList}};class ly extends sy{constructor(){super()}createNode(i){return new Rl(i,new pP)}}class Ml{constructor(){Ml.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._orientation=null;let i=arguments[0];this._pts=i,this._orientation=Ml.orientation(i)}static orientation(i){return Be.increasingDirection(i)===1}static compareOriented(i,r,c,f){let g=r?1:-1,y=f?1:-1,S=r?i.length:-1,I=f?c.length:-1,z=r?0:i.length-1,ne=f?0:c.length-1;for(;;){let he=i[z].compareTo(c[ne]);if(he!==0)return he;z+=g,ne+=y;let Ie=z===S,Oe=ne===I;if(Ie&&!Oe)return-1;if(!Ie&&Oe)return 1;if(Ie&&Oe)return 0}}compareTo(i){let r=i;return Ml.compareOriented(this._pts,this._orientation,r._pts,r._orientation)}get interfaces_(){return[a]}}class Cf{constructor(){Cf.constructor_.apply(this,arguments)}static constructor_(){this._edges=new M,this._ocaMap=new bs}print(i){i.print("MULTILINESTRING ( ");for(let r=0;r<this._edges.size();r++){let c=this._edges.get(r);r>0&&i.print(","),i.print("(");let f=c.getCoordinates();for(let g=0;g<f.length;g++)g>0&&i.print(","),i.print(f[g].x+" "+f[g].y);i.println(")")}i.print(")  ")}addAll(i){for(let r=i.iterator();r.hasNext();)this.add(r.next())}findEdgeIndex(i){for(let r=0;r<this._edges.size();r++)if(this._edges.get(r).equals(i))return r;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(i){return this._edges.get(i)}findEqualEdge(i){let r=new Ml(i.getCoordinates());return this._ocaMap.get(r)}add(i){this._edges.add(i);let r=new Ml(i.getCoordinates());this._ocaMap.put(r,i)}}class If{constructor(){If.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;let i=arguments[0];this._li=i}static isAdjacentSegments(i,r){return Math.abs(i-r)===1}isTrivialIntersection(i,r,c,f){if(i===c&&this._li.getIntersectionNum()===1){if(If.isAdjacentSegments(r,f))return!0;if(i.isClosed()){let g=i.size()-1;if(r===0&&f===g||f===0&&r===g)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(i,r,c,f){if(i===c&&r===f)return null;this.numTests++;let g=i.getCoordinates()[r],y=i.getCoordinates()[r+1],S=c.getCoordinates()[f],I=c.getCoordinates()[f+1];this._li.computeIntersection(g,y,S,I),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(i,r,c,f)||(this._hasIntersection=!0,i.addIntersections(this._li,r,0),c.addIntersections(this._li,f,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}get interfaces_(){return[K_]}}class cy{constructor(){cy.constructor_.apply(this,arguments)}static constructor_(){this.coord=null,this.segmentIndex=null,this.dist=null;let i=arguments[0],r=arguments[1],c=arguments[2];this.coord=new w(i),this.segmentIndex=r,this.dist=c}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(i){i.print(this.coord),i.print(" seg # = "+this.segmentIndex),i.println(" dist = "+this.dist)}compareTo(i){let r=i;return this.compare(r.segmentIndex,r.dist)}isEndPoint(i){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===i}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(i,r){return this.segmentIndex<i?-1:this.segmentIndex>i?1:this.dist<r?-1:this.dist>r?1:0}get interfaces_(){return[a]}}class uy{constructor(){uy.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new bs,this.edge=null;let i=arguments[0];this.edge=i}print(i){i.println("Intersections:");for(let r=this.iterator();r.hasNext();)r.next().print(i)}addEndpoints(){let i=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[i],i,0)}createSplitEdge(i,r){let c=r.segmentIndex-i.segmentIndex+2,f=this.edge.pts[r.segmentIndex],g=r.dist>0||!r.coord.equals2D(f);g||c--;let y=new Array(c).fill(null),S=0;y[S++]=new w(i.coord);for(let I=i.segmentIndex+1;I<=r.segmentIndex;I++)y[S++]=this.edge.pts[I];return g&&(y[S]=r.coord),new Au(y,new Jt(this.edge._label))}add(i,r,c){let f=new cy(i,r,c),g=this._nodeMap.get(f);return g!==null?g:(this._nodeMap.put(f,f),f)}isIntersection(i){for(let r=this.iterator();r.hasNext();)if(r.next().coord.equals(i))return!0;return!1}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(i){this.addEndpoints();let r=this.iterator(),c=r.next();for(;r.hasNext();){let f=r.next(),g=this.createSplitEdge(c,f);i.add(g),c=f}}}class js{constructor(){js.constructor_.apply(this,arguments)}static constructor_(){this._depth=Array(2).fill().map(()=>Array(3));for(let i=0;i<2;i++)for(let r=0;r<3;r++)this._depth[i][r]=js.NULL_VALUE}static depthAtLocation(i){return i===B.EXTERIOR?0:i===B.INTERIOR?1:js.NULL_VALUE}getDepth(i,r){return this._depth[i][r]}setDepth(i,r,c){this._depth[i][r]=c}isNull(){if(arguments.length===0){for(let i=0;i<2;i++)for(let r=0;r<3;r++)if(this._depth[i][r]!==js.NULL_VALUE)return!1;return!0}if(arguments.length===1){let i=arguments[0];return this._depth[i][1]===js.NULL_VALUE}if(arguments.length===2){let i=arguments[0],r=arguments[1];return this._depth[i][r]===js.NULL_VALUE}}normalize(){for(let i=0;i<2;i++)if(!this.isNull(i)){let r=this._depth[i][1];this._depth[i][2]<r&&(r=this._depth[i][2]),r<0&&(r=0);for(let c=1;c<3;c++){let f=0;this._depth[i][c]>r&&(f=1),this._depth[i][c]=f}}}getDelta(i){return this._depth[i][Ce.RIGHT]-this._depth[i][Ce.LEFT]}getLocation(i,r){return this._depth[i][r]<=0?B.EXTERIOR:B.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(arguments.length===1){let i=arguments[0];for(let r=0;r<2;r++)for(let c=1;c<3;c++){let f=i.getLocation(r,c);f!==B.EXTERIOR&&f!==B.INTERIOR||(this.isNull(r,c)?this._depth[r][c]=js.depthAtLocation(f):this._depth[r][c]+=js.depthAtLocation(f))}}else if(arguments.length===3){let i=arguments[0],r=arguments[1];arguments[2]===B.INTERIOR&&this._depth[i][r]++}}}js.NULL_VALUE=-1;class Lf{constructor(){Lf.constructor_.apply(this,arguments)}static constructor_(){if(this._data=null,this._size=0,arguments.length===0)Lf.constructor_.call(this,10);else if(arguments.length===1){let i=arguments[0];this._data=new Array(i).fill(null)}}size(){return this._size}addAll(i){return i===null||i.length===0?null:(this.ensureCapacity(this._size+i.length),Fe.arraycopy(i,0,this._data,this._size,i.length),void(this._size+=i.length))}ensureCapacity(i){if(i<=this._data.length)return null;let r=Math.max(i,2*this._data.length);this._data=Hn.copyOf(this._data,r)}toArray(){let i=new Array(this._size).fill(null);return Fe.arraycopy(this._data,0,i,0,this._size),i}add(i){this.ensureCapacity(this._size+1),this._data[this._size]=i,++this._size}}class dy{static toIntArray(i){let r=new Array(i.size()).fill(null);for(let c=0;c<r.length;c++)r[c]=i.get(c).intValue();return r}findChainEnd(i,r){let c=kt.quadrant(i[r],i[r+1]),f=r+1;for(;f<i.length&&kt.quadrant(i[f-1],i[f])===c;)f++;return f-1}OLDgetChainStartIndices(i){let r=0,c=new M;c.add(r);do{let f=this.findChainEnd(i,r);c.add(f),r=f}while(r<i.length-1);return dy.toIntArray(c)}getChainStartIndices(i){let r=0,c=new Lf(Math.trunc(i.length/2));c.add(r);do{let f=this.findChainEnd(i,r);c.add(f),r=f}while(r<i.length-1);return c.toArray()}}class hy{constructor(){hy.constructor_.apply(this,arguments)}static constructor_(){this.e=null,this.pts=null,this.startIndex=null;let i=arguments[0];this.e=i,this.pts=i.getCoordinates();let r=new dy;this.startIndex=r.getChainStartIndices(this.pts)}getCoordinates(){return this.pts}getMaxX(i){let r=this.pts[this.startIndex[i]].x,c=this.pts[this.startIndex[i+1]].x;return r>c?r:c}getMinX(i){let r=this.pts[this.startIndex[i]].x,c=this.pts[this.startIndex[i+1]].x;return r<c?r:c}computeIntersectsForChain(){if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this.computeIntersectsForChain(this.startIndex[i],this.startIndex[i+1],r,r.startIndex[c],r.startIndex[c+1],f)}else if(arguments.length===6){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5];if(r-i==1&&g-f==1)return y.addIntersections(this.e,i,c.e,f),null;if(!this.overlaps(i,r,c,f,g))return null;let S=Math.trunc((i+r)/2),I=Math.trunc((f+g)/2);i<S&&(f<I&&this.computeIntersectsForChain(i,S,c,f,I,y),I<g&&this.computeIntersectsForChain(i,S,c,I,g,y)),S<r&&(f<I&&this.computeIntersectsForChain(S,r,c,f,I,y),I<g&&this.computeIntersectsForChain(S,r,c,I,g,y))}}overlaps(i,r,c,f,g){return K.intersects(this.pts[i],this.pts[r],c.pts[f],c.pts[g])}getStartIndexes(){return this.startIndex}computeIntersects(i,r){for(let c=0;c<this.startIndex.length-1;c++)for(let f=0;f<i.startIndex.length-1;f++)this.computeIntersectsForChain(c,i,f,r)}}let Au=class vu extends bS{constructor(){super(),vu.constructor_.apply(this,arguments)}static constructor_(){if(this.pts=null,this._env=null,this.eiList=new uy(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new js,this._depthDelta=0,arguments.length===1){let i=arguments[0];vu.constructor_.call(this,i,null)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}static updateIM(){if(!(arguments.length===2&&arguments[1]instanceof Ct&&arguments[0]instanceof Jt))return super.updateIM.apply(this,arguments);{let i=arguments[0],r=arguments[1];r.setAtLeastIfValid(i.getLocation(0,Ce.ON),i.getLocation(1,Ce.ON),1),i.isArea()&&(r.setAtLeastIfValid(i.getLocation(0,Ce.LEFT),i.getLocation(1,Ce.LEFT),2),r.setAtLeastIfValid(i.getLocation(0,Ce.RIGHT),i.getLocation(1,Ce.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){let i=new Array(2).fill(null);return i[0]=this.pts[0],i[1]=this.pts[1],new vu(i,Jt.toLineLabel(this._label))}setIsolated(i){this._isIsolated=i}setName(i){this._name=i}equals(i){if(!(i instanceof vu))return!1;let r=i;if(this.pts.length!==r.pts.length)return!1;let c=!0,f=!0,g=this.pts.length;for(let y=0;y<this.pts.length;y++)if(this.pts[y].equals2D(r.pts[y])||(c=!1),this.pts[y].equals2D(r.pts[--g])||(f=!1),!c&&!f)return!1;return!0}getCoordinate(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){let i=arguments[0];return this.pts[i]}}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}setDepthDelta(i){this._depthDelta=i}getEdgeIntersectionList(){return this.eiList}addIntersections(i,r,c){for(let f=0;f<i.getIntersectionNum();f++)this.addIntersection(i,r,c,f)}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}print(i){i.print("edge "+this._name+": "),i.print("LINESTRING (");for(let r=0;r<this.pts.length;r++)r>0&&i.print(","),i.print(this.pts[r].x+" "+this.pts[r].y);i.print(")  "+this._label+" "+this._depthDelta)}computeIM(i){vu.updateIM(this._label,i)}isCollapsed(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(i){i.print("edge "+this._name+": ");for(let r=this.pts.length-1;r>=0;r--)i.print(this.pts[r]+" ");i.println("")}getMonotoneChainEdge(){return this._mce===null&&(this._mce=new hy(this)),this._mce}getEnvelope(){if(this._env===null){this._env=new K;for(let i=0;i<this.pts.length;i++)this._env.expandToInclude(this.pts[i])}return this._env}addIntersection(i,r,c,f){let g=new w(i.getIntersection(f)),y=r,S=i.getEdgeDistance(c,f),I=y+1;if(I<this.pts.length){let z=this.pts[I];g.equals2D(z)&&(y=I,S=0)}this.eiList.add(g,y,S)}toString(){let i=new re;i.append("edge "+this._name+": "),i.append("LINESTRING (");for(let r=0;r<this.pts.length;r++)r>0&&i.append(","),i.append(this.pts[r].x+" "+this.pts[r].y);return i.append(")  "+this._label+" "+this._depthDelta),i.toString()}isPointwiseEqual(i){if(this.pts.length!==i.pts.length)return!1;for(let r=0;r<this.pts.length;r++)if(!this.pts[r].equals2D(i.pts[r]))return!1;return!0}};class Al{constructor(){Al.constructor_.apply(this,arguments)}static constructor_(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Cf;let i=arguments[0];this._bufParams=i}static convertSegStrings(i){let r=new vt,c=new M;for(;i.hasNext();){let f=i.next(),g=r.createLineString(f.getCoordinates());c.add(g)}return r.buildGeometry(c)}static depthDelta(i){let r=i.getLocation(0,Ce.LEFT),c=i.getLocation(0,Ce.RIGHT);return r===B.INTERIOR&&c===B.EXTERIOR?1:r===B.EXTERIOR&&c===B.INTERIOR?-1:0}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(i){if(this._workingNoder!==null)return this._workingNoder;let r=new Ca,c=new wn;return c.setPrecisionModel(i),r.setSegmentIntersector(new If(c)),r}buffer(i,r){let c=this._workingPrecisionModel;c===null&&(c=i.getPrecisionModel()),this._geomFact=i.getFactory();let f=new yf(c,this._bufParams),g=new ay(i,r,f).getCurves();if(g.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(g,c),this._graph=new Ru(new ly),this._graph.addEdges(this._edgeList.getEdges());let y=this.createSubgraphs(this._graph),S=new Mu(this._geomFact);this.buildSubgraphs(y,S);let I=S.getPolygons();return I.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(I)}computeNodedEdges(i,r){let c=this.getNoder(r);c.computeNodes(i);for(let f=c.getNodedSubstrings().iterator();f.hasNext();){let g=f.next(),y=g.getCoordinates();if(y.length===2&&y[0].equals2D(y[1]))continue;let S=g.getData(),I=new Au(g.getCoordinates(),new Jt(S));this.insertUniqueEdge(I)}}setNoder(i){this._workingNoder=i}setWorkingPrecisionModel(i){this._workingPrecisionModel=i}insertUniqueEdge(i){let r=this._edgeList.findEqualEdge(i);if(r!==null){let c=r.getLabel(),f=i.getLabel();r.isPointwiseEqual(i)||(f=new Jt(i.getLabel()),f.flip()),c.merge(f);let g=Al.depthDelta(f),y=r.getDepthDelta()+g;r.setDepthDelta(y)}else this._edgeList.add(i),i.setDepthDelta(Al.depthDelta(i.getLabel()))}buildSubgraphs(i,r){let c=new M;for(let f=i.iterator();f.hasNext();){let g=f.next(),y=g.getRightmostCoordinate(),S=new wf(c).getDepth(y);g.computeDepth(S),g.findResultEdges(),c.add(g),r.add(g.getDirectedEdges(),g.getNodes())}}createSubgraphs(i){let r=new M;for(let c=i.getNodes().iterator();c.hasNext();){let f=c.next();if(!f.isVisited()){let g=new iy;g.create(f),r.add(g)}}return Le.sort(r,Le.reverseOrder()),r}}class Ht{constructor(){Ht.constructor_.apply(this,arguments)}static constructor_(){if(this._argGeom=null,this._distance=null,this._bufParams=new mt,this._resultGeometry=null,this._saveException=null,arguments.length===1){let i=arguments[0];this._argGeom=i}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._argGeom=i,this._bufParams=r}}static bufferOp(){if(arguments.length===2){let i=arguments[1];return new Ht(arguments[0]).getResultGeometry(i)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Q&&typeof arguments[1]=="number"){let i=arguments[1],r=arguments[2],c=new Ht(arguments[0]);return c.setQuadrantSegments(r),c.getResultGeometry(i)}if(arguments[2]instanceof mt&&arguments[0]instanceof Q&&typeof arguments[1]=="number"){let i=arguments[1];return new Ht(arguments[0],arguments[2]).getResultGeometry(i)}}else if(arguments.length===4){let i=arguments[1],r=arguments[2],c=arguments[3],f=new Ht(arguments[0]);return f.setQuadrantSegments(r),f.setEndCapStyle(c),f.getResultGeometry(i)}}static precisionScaleFactor(i,r,c){let f=i.getEnvelopeInternal(),g=lt.max(Math.abs(f.getMaxX()),Math.abs(f.getMaxY()),Math.abs(f.getMinX()),Math.abs(f.getMinY()))+2*(r>0?r:0),y=c-Math.trunc(Math.log(g)/Math.log(10)+1);return Math.pow(10,y)}bufferFixedPrecision(i){let r=new Nu(new ey(new St(1)),i.getScale()),c=new Al(this._bufParams);c.setWorkingPrecisionModel(i),c.setNoder(r),this._resultGeometry=c.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(arguments.length===0){for(let i=Ht.MAX_PRECISION_DIGITS;i>=0;i--){try{this.bufferReducedPrecision(i)}catch(r){if(!(r instanceof ts))throw r;this._saveException=r}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){let i=arguments[0],r=Ht.precisionScaleFactor(this._argGeom,this._distance,i),c=new St(r);this.bufferFixedPrecision(c)}}bufferOriginalPrecision(){try{let i=new Al(this._bufParams);this._resultGeometry=i.buffer(this._argGeom,this._distance)}catch(i){if(!(i instanceof h))throw i;this._saveException=i}}getResultGeometry(i){return this._distance=i,this.computeGeometry(),this._resultGeometry}setEndCapStyle(i){this._bufParams.setEndCapStyle(i)}computeGeometry(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;let i=this._argGeom.getFactory().getPrecisionModel();i.getType()===St.FIXED?this.bufferFixedPrecision(i):this.bufferReducedPrecision()}setQuadrantSegments(i){this._bufParams.setQuadrantSegments(i)}}Ht.CAP_ROUND=mt.CAP_ROUND,Ht.CAP_BUTT=mt.CAP_FLAT,Ht.CAP_FLAT=mt.CAP_FLAT,Ht.CAP_SQUARE=mt.CAP_SQUARE,Ht.MAX_PRECISION_DIGITS=12;class Ol{constructor(){Ol.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Ze,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Z&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1];Ol.constructor_.call(this,i.getCoordinates(),r)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){let i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=Ol.isClosed(i),this._snapTolerance=r}}static isClosed(i){return!(i.length<=1)&&i[0].equals2D(i[i.length-1])}snapVertices(i,r){let c=this._isClosed?i.size()-1:i.size();for(let f=0;f<c;f++){let g=i.get(f),y=this.findSnapForVertex(g,r);y!==null&&(i.set(f,new w(y)),f===0&&this._isClosed&&i.set(i.size()-1,new w(y)))}}findSnapForVertex(i,r){for(let c=0;c<r.length;c++){if(i.equals2D(r[c]))return null;if(i.distance(r[c])<this._snapTolerance)return r[c]}return null}snapTo(i){let r=new E(this._srcPts);return this.snapVertices(r,i),this.snapSegments(r,i),r.toCoordinateArray()}snapSegments(i,r){if(r.length===0)return null;let c=r.length;r[0].equals2D(r[r.length-1])&&(c=r.length-1);for(let f=0;f<c;f++){let g=r[f],y=this.findSegmentIndexToSnap(g,i);y>=0&&i.add(y+1,new w(g),!1)}}findSegmentIndexToSnap(i,r){let c=l.MAX_VALUE,f=-1;for(let g=0;g<r.size()-1;g++){if(this._seg.p0=r.get(g),this._seg.p1=r.get(g+1),this._seg.p0.equals2D(i)||this._seg.p1.equals2D(i)){if(this._allowSnappingToSourceVertices)continue;return-1}let y=this._seg.distance(i);y<this._snapTolerance&&y<c&&(c=y,f=g)}return f}setAllowSnappingToSourceVertices(i){this._allowSnappingToSourceVertices=i}}class Ri{constructor(){Ri.constructor_.apply(this,arguments)}static constructor_(){this._srcGeom=null;let i=arguments[0];this._srcGeom=i}static computeSizeBasedSnapTolerance(i){let r=i.getEnvelopeInternal();return Math.min(r.getHeight(),r.getWidth())*Ri.SNAP_PRECISION_FACTOR}static computeOverlaySnapTolerance(){if(arguments.length===1){let i=arguments[0],r=Ri.computeSizeBasedSnapTolerance(i),c=i.getPrecisionModel();if(c.getType()===St.FIXED){let f=1/c.getScale()*2/1.415;f>r&&(r=f)}return r}if(arguments.length===2){let i=arguments[0],r=arguments[1];return Math.min(Ri.computeOverlaySnapTolerance(i),Ri.computeOverlaySnapTolerance(r))}}static snapToSelf(i,r,c){return new Ri(i).snapToSelf(r,c)}static snap(i,r,c){let f=new Array(2).fill(null),g=new Ri(i);f[0]=g.snapTo(r,c);let y=new Ri(r);return f[1]=y.snapTo(f[0],c),f}computeSnapTolerance(i){return this.computeMinimumSegmentLength(i)/10}snapTo(i,r){let c=this.extractTargetCoordinates(i);return new Nf(r,c).transform(this._srcGeom)}snapToSelf(i,r){let c=this.extractTargetCoordinates(this._srcGeom),f=new Nf(i,c,!0).transform(this._srcGeom),g=f;return r&&P(g,Jn)&&(g=Ht.bufferOp(f,0)),g}extractTargetCoordinates(i){let r=new Xe,c=i.getCoordinates();for(let f=0;f<c.length;f++)r.add(c[f]);return r.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(i){let r=l.MAX_VALUE;for(let c=0;c<i.length-1;c++){let f=i[c].distance(i[c+1]);f<r&&(r=f)}return r}}Ri.SNAP_PRECISION_FACTOR=1e-9;class Nf extends oe{constructor(){super(),Nf.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,arguments.length===2){let i=arguments[0],r=arguments[1];this._snapTolerance=i,this._snapPts=r}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._snapTolerance=i,this._snapPts=r,this._isSelfSnap=c}}transformCoordinates(i,r){let c=i.toCoordinateArray(),f=this.snapLine(c,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(f)}snapLine(i,r){let c=new Ol(i,this._snapTolerance);return c.setAllowSnappingToSourceVertices(this._isSelfSnap),c.snapTo(r)}}class qs{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new o,this._commonSignExp=null}getCommon(){return l.longBitsToDouble(this._commonBits)}add(i){let r=l.doubleToLongBits(i);if(this._isFirst)return this._commonBits=r,this._commonSignExp=qs.signExpBits(this._commonBits),this._isFirst=!1,null;if(qs.signExpBits(r)!==this._commonSignExp)return this._commonBits.high=0,this._commonBits.low=0,null;this._commonMantissaBitsCount=qs.numCommonMostSigMantissaBits(this._commonBits,r),this._commonBits=qs.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))}toString(){if(arguments.length===1){let i=arguments[0],r=l.longBitsToDouble(i),c="0000000000000000000000000000000000000000000000000000000000000000"+o.toBinaryString(i),f=c.substring(c.length-64);return f.substring(0,1)+"  "+f.substring(1,12)+"(exp) "+f.substring(12)+" [ "+r+" ]"}}getClass(){return qs}get interfaces_(){return[]}static getBit(i,r){let c=1<<r%32;return r<32?i.low&c?1:0:i.high&c?1:0}static signExpBits(i){return i.high>>>20}static zeroLowerBits(i,r){let c="low";if(r>32&&(i.low=0,r%=32,c="high"),r>0){let f=r<32?~((1<<r)-1):0;i[c]&=f}return i}static numCommonMostSigMantissaBits(i,r){let c=0;for(let f=52;f>=0;f--){if(qs.getBit(i,f)!==qs.getBit(r,f))return c;c++}return 52}}class Eo{constructor(){Eo.constructor_.apply(this,arguments)}static constructor_(){this._commonCoord=null,this._ccFilter=new Tf}add(i){i.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}removeCommonBits(i){if(this._commonCoord.x===0&&this._commonCoord.y===0)return i;let r=new w(this._commonCoord);r.x=-r.x,r.y=-r.y;let c=new Ou(r);return i.apply(c),i.geometryChanged(),i}addCommonBits(i){let r=new Ou(this._commonCoord);i.apply(r),i.geometryChanged()}getCommonCoordinate(){return this._commonCoord}}class Tf{constructor(){Tf.constructor_.apply(this,arguments)}static constructor_(){this._commonBitsX=new qs,this._commonBitsY=new qs}filter(i){this._commonBitsX.add(i.x),this._commonBitsY.add(i.y)}getCommonCoordinate(){return new w(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}get interfaces_(){return[ge]}}class Ou{constructor(){Ou.constructor_.apply(this,arguments)}static constructor_(){this.trans=null;let i=arguments[0];this.trans=i}filter(i,r){let c=i.getOrdinate(r,0)+this.trans.x,f=i.getOrdinate(r,1)+this.trans.y;i.setOrdinate(r,0,c),i.setOrdinate(r,1,f)}isGeometryChanged(){return!0}isDone(){return!1}get interfaces_(){return[X]}}Eo.CommonCoordinateFilter=Tf,Eo.Translater=Ou;class fy{constructor(){fy.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new M,this._resultLineList=new M;let i=arguments[0],r=arguments[1],c=arguments[2];this._op=i,this._geometryFactory=r,this._ptLocator=c}collectLines(i){for(let r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){let c=r.next();this.collectLineEdge(c,i,this._lineEdgesList),this.collectBoundaryTouchEdge(c,i,this._lineEdgesList)}}labelIsolatedLine(i,r){let c=this._ptLocator.locate(i.getCoordinate(),this._op.getArgGeometry(r));i.getLabel().setLocation(r,c)}build(i){return this.findCoveredLineEdges(),this.collectLines(i),this.buildLines(i),this._resultLineList}collectLineEdge(i,r,c){let f=i.getLabel(),g=i.getEdge();i.isLineEdge()&&(i.isVisited()||!We.isResultOfOp(f,r)||g.isCovered()||(c.add(g),i.setVisitedEdge(!0)))}findCoveredLineEdges(){for(let i=this._op.getGraph().getNodes().iterator();i.hasNext();)i.next().getEdges().findCoveredLineEdges();for(let i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){let r=i.next(),c=r.getEdge();if(r.isLineEdge()&&!c.isCoveredSet()){let f=this._op.isCoveredByA(r.getCoordinate());c.setCovered(f)}}}labelIsolatedLines(i){for(let r=i.iterator();r.hasNext();){let c=r.next(),f=c.getLabel();c.isIsolated()&&(f.isNull(0)?this.labelIsolatedLine(c,0):this.labelIsolatedLine(c,1))}}buildLines(i){for(let r=this._lineEdgesList.iterator();r.hasNext();){let c=r.next(),f=this._geometryFactory.createLineString(c.getCoordinates());this._resultLineList.add(f),c.setInResult(!0)}}collectBoundaryTouchEdge(i,r,c){let f=i.getLabel();return i.isLineEdge()||i.isVisited()||i.isInteriorAreaEdge()||i.getEdge().isInResult()?null:(d.isTrue(!(i.isInResult()||i.getSym().isInResult())||!i.getEdge().isInResult()),void(We.isResultOfOp(f,r)&&r===We.INTERSECTION&&(c.add(i.getEdge()),i.setVisitedEdge(!0))))}}class py{constructor(){py.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._resultPointList=new M;let i=arguments[0],r=arguments[1];this._op=i,this._geometryFactory=r}build(i){return this.extractNonCoveredResultNodes(i),this._resultPointList}extractNonCoveredResultNodes(i){for(let r=this._op.getGraph().getNodes().iterator();r.hasNext();){let c=r.next();if(!c.isInResult()&&!c.isIncidentEdgeInResult()&&(c.getEdges().getDegree()===0||i===We.INTERSECTION)){let f=c.getLabel();We.isResultOfOp(f,i)&&this.filterCoveredNodeToPoint(c)}}}filterCoveredNodeToPoint(i){let r=i.getCoordinate();if(!this._op.isCoveredByLA(r)){let c=this._geometryFactory.createPoint(r);this._resultPointList.add(c)}}}class Yn{isInBoundary(i){}}class xS{isInBoundary(i){return i%2==1}get interfaces_(){return[Yn]}}class wS{isInBoundary(i){return i>0}get interfaces_(){return[Yn]}}class SS{isInBoundary(i){return i>1}get interfaces_(){return[Yn]}}class ES{isInBoundary(i){return i===1}get interfaces_(){return[Yn]}}Yn.Mod2BoundaryNodeRule=xS,Yn.EndPointBoundaryNodeRule=wS,Yn.MultiValentEndPointBoundaryNodeRule=SS,Yn.MonoValentEndPointBoundaryNodeRule=ES,Yn.MOD2_BOUNDARY_RULE=new xS,Yn.ENDPOINT_BOUNDARY_RULE=new wS,Yn.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new SS,Yn.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new ES,Yn.OGC_SFS_BOUNDARY_RULE=Yn.MOD2_BOUNDARY_RULE;class Co{constructor(){Co.constructor_.apply(this,arguments)}static constructor_(){if(this._boundaryRule=Yn.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){let i=arguments[0];if(i===null)throw new s("Rule must be non-null");this._boundaryRule=i}}}locateInPolygonRing(i,r){return r.getEnvelopeInternal().intersects(i)?Ji.locateInRing(i,r.getCoordinates()):B.EXTERIOR}intersects(i,r){return this.locate(i,r)!==B.EXTERIOR}updateLocationInfo(i){i===B.INTERIOR&&(this._isIn=!0),i===B.BOUNDARY&&this._numBoundaries++}computeLocation(i,r){if(r instanceof yt&&this.updateLocationInfo(this.locateOnPoint(i,r)),r instanceof Z)this.updateLocationInfo(this.locateOnLineString(i,r));else if(r instanceof Et)this.updateLocationInfo(this.locateInPolygon(i,r));else if(r instanceof _n){let c=r;for(let f=0;f<c.getNumGeometries();f++){let g=c.getGeometryN(f);this.updateLocationInfo(this.locateOnLineString(i,g))}}else if(r instanceof at){let c=r;for(let f=0;f<c.getNumGeometries();f++){let g=c.getGeometryN(f);this.updateLocationInfo(this.locateInPolygon(i,g))}}else if(r instanceof tt){let c=new Tl(r);for(;c.hasNext();){let f=c.next();f!==r&&this.computeLocation(i,f)}}}locateOnPoint(i,r){return r.getCoordinate().equals2D(i)?B.INTERIOR:B.EXTERIOR}locateOnLineString(i,r){if(!r.getEnvelopeInternal().intersects(i))return B.EXTERIOR;let c=r.getCoordinateSequence();return r.isClosed()||!i.equals(c.getCoordinate(0))&&!i.equals(c.getCoordinate(c.size()-1))?Ji.isOnLine(i,c)?B.INTERIOR:B.EXTERIOR:B.BOUNDARY}locateInPolygon(i,r){if(r.isEmpty())return B.EXTERIOR;let c=r.getExteriorRing(),f=this.locateInPolygonRing(i,c);if(f===B.EXTERIOR)return B.EXTERIOR;if(f===B.BOUNDARY)return B.BOUNDARY;for(let g=0;g<r.getNumInteriorRing();g++){let y=r.getInteriorRingN(g),S=this.locateInPolygonRing(i,y);if(S===B.INTERIOR)return B.EXTERIOR;if(S===B.BOUNDARY)return B.BOUNDARY}return B.INTERIOR}locate(i,r){return r.isEmpty()?B.EXTERIOR:r instanceof Z?this.locateOnLineString(i,r):r instanceof Et?this.locateInPolygon(i,r):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(i,r),this._boundaryRule.isInBoundary(this._numBoundaries)?B.BOUNDARY:this._numBoundaries>0||this._isIn?B.INTERIOR:B.EXTERIOR)}}class gy{constructor(){gy.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._data=null;let i=arguments[0],r=arguments[1];this._pts=i,this._data=r}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(i){return this._pts[i]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(i){return i===this._pts.length-1?-1:cf.octant(this.getCoordinate(i),this.getCoordinate(i+1))}setData(i){this._data=i}getData(){return this._data}toString(){return rn.toLineString(new de(this._pts))}get interfaces_(){return[Y_]}}class _i{constructor(){_i.constructor_.apply(this,arguments)}static constructor_(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._keepIntersections=!0,this._isInteriorIntersectionsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new M,this._intersectionCount=0;let i=arguments[0];this._li=i,this._interiorIntersection=null}static createAllIntersectionsFinder(i){let r=new _i(i);return r.setFindAllIntersections(!0),r}static isInteriorVertexIntersection(){if(arguments.length===4){let i=arguments[1];return(!arguments[2]||!arguments[3])&&!!arguments[0].equals2D(i)}if(arguments.length===8){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5],S=arguments[6],I=arguments[7];return!!_i.isInteriorVertexIntersection(i,c,g,S)||!!_i.isInteriorVertexIntersection(i,f,g,I)||!!_i.isInteriorVertexIntersection(r,c,y,S)||!!_i.isInteriorVertexIntersection(r,f,y,I)}}static createInteriorIntersectionCounter(i){let r=new _i(i);return r.setInteriorIntersectionsOnly(!0),r.setFindAllIntersections(!0),r.setKeepIntersections(!1),r}static createIntersectionCounter(i){let r=new _i(i);return r.setFindAllIntersections(!0),r.setKeepIntersections(!1),r}static isEndSegment(i,r){return r===0||r>=i.size()-2}static createAnyIntersectionFinder(i){return new _i(i)}static createInteriorIntersectionsFinder(i){let r=new _i(i);return r.setFindAllIntersections(!0),r.setInteriorIntersectionsOnly(!0),r}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(i){this._findAllIntersections=i}setKeepIntersections(i){this._keepIntersections=i}getIntersection(){return this._interiorIntersection}processIntersections(i,r,c,f){if(!this._findAllIntersections&&this.hasIntersection())return null;let g=i===c;if(g&&r===f||this._isCheckEndSegmentsOnly&&!(_i.isEndSegment(i,r)||_i.isEndSegment(c,f)))return null;let y=i.getCoordinate(r),S=i.getCoordinate(r+1),I=c.getCoordinate(f),z=c.getCoordinate(f+1),ne=r===0,he=r+2===i.size(),Ie=f===0,Oe=f+2===c.size();this._li.computeIntersection(y,S,I,z);let Ue=this._li.hasIntersection()&&this._li.isInteriorIntersection(),ut=!1;this._isInteriorIntersectionsOnly||(ut=!(g&&Math.abs(f-r)<=1)&&_i.isInteriorVertexIntersection(y,S,I,z,ne,he,Ie,Oe)),(Ue||ut)&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=y,this._intSegments[1]=S,this._intSegments[2]=I,this._intSegments[3]=z,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}hasIntersection(){return this._interiorIntersection!==null}isDone(){return!this._findAllIntersections&&this._interiorIntersection!==null}setInteriorIntersectionsOnly(i){this._isInteriorIntersectionsOnly=i}setCheckEndSegmentsOnly(i){this._isCheckEndSegmentsOnly=i}getIntersectionSegments(){return this._intSegments}get interfaces_(){return[K_]}}class kf{constructor(){kf.constructor_.apply(this,arguments)}static constructor_(){this._li=new wn,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;let i=arguments[0];this._segStrings=i}static computeIntersections(i){let r=new kf(i);return r.setFindAllIntersections(!0),r.isValid(),r.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(i){this._findAllIntersections=i}checkInteriorIntersections(){this._isValid=!0,this._segInt=new _i(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);let i=new Ca;if(i.setSegmentIntersector(this._segInt),i.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new ts(this.getErrorMessage(),this._segInt.getIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";let i=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+rn.toLineString(i[0],i[1])+" and "+rn.toLineString(i[2],i[3])}execute(){if(this._segInt!==null)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}}class Pu{constructor(){Pu.constructor_.apply(this,arguments)}static constructor_(){this._nv=null;let i=arguments[0];this._nv=new kf(Pu.toSegmentStrings(i))}static toSegmentStrings(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next();r.add(new gy(f.getCoordinates(),f))}return r}static checkValid(i){new Pu(i).checkValid()}checkValid(){this._nv.checkValid()}}class gP{}class La{constructor(){La.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;let i=arguments[0],r=arguments[1],c=arguments[2];this._li=i,this._includeProper=r,this._recordIsolated=c}static isAdjacentSegments(i,r){return Math.abs(i-r)===1}isTrivialIntersection(i,r,c,f){if(i===c&&this._li.getIntersectionNum()===1){if(La.isAdjacentSegments(r,f))return!0;if(i.isClosed()){let g=i.getNumPoints()-1;if(r===0&&f===g||f===0&&r===g)return!0}}return!1}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(i,r){for(let c=r.iterator();c.hasNext();){let f=c.next().getCoordinate();if(i.isIntersection(f))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(i,r){return r!==null&&(!!this.isBoundaryPointInternal(i,r[0])||!!this.isBoundaryPointInternal(i,r[1]))}setBoundaryNodes(i,r){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=i,this._bdyNodes[1]=r}addIntersections(i,r,c,f){if(i===c&&r===f)return null;this.numTests++;let g=i.getCoordinates()[r],y=i.getCoordinates()[r+1],S=c.getCoordinates()[f],I=c.getCoordinates()[f+1];this._li.computeIntersection(g,y,S,I),this._li.hasIntersection()&&(this._recordIsolated&&(i.setIsolated(!1),c.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(i,r,c,f)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(i.addIntersections(this._li,r,0),c.addIntersections(this._li,f,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(i){this._isDoneWhenProperInt=i}}class my{constructor(){my.constructor_.apply(this,arguments)}static constructor_(){this.mce=null,this.chainIndex=null;let i=arguments[0],r=arguments[1];this.mce=i,this.chainIndex=r}computeIntersections(i,r){this.mce.computeIntersectsForChain(this.chainIndex,i.mce,i.chainIndex,r)}}class rr{constructor(){rr.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){let i=arguments[0],r=arguments[1];this._eventType=rr.DELETE,this._xValue=i,this._insertEvent=r}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._eventType=rr.INSERT,this._label=i,this._xValue=r,this._obj=c}}getObject(){return this._obj}getDeleteEventIndex(){return this._deleteEventIndex}isDelete(){return this._eventType===rr.DELETE}setDeleteEventIndex(i){this._deleteEventIndex=i}compareTo(i){let r=i;return this._xValue<r._xValue?-1:this._xValue>r._xValue?1:this._eventType<r._eventType?-1:this._eventType>r._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===rr.INSERT}isSameLabel(i){return this._label!==null&&this._label===i._label}get interfaces_(){return[a]}}rr.INSERT=1,rr.DELETE=2;class _y extends gP{constructor(){super(),_y.constructor_.apply(this,arguments)}static constructor_(){this.events=new M,this.nOverlaps=null}prepareEvents(){Le.sort(this.events);for(let i=0;i<this.events.size();i++){let r=this.events.get(i);r.isDelete()&&r.getInsertEvent().setDeleteEventIndex(i)}}computeIntersections(){if(arguments.length===1){let i=arguments[0];this.nOverlaps=0,this.prepareEvents();for(let r=0;r<this.events.size();r++){let c=this.events.get(r);if(c.isInsert()&&this.processOverlaps(r,c.getDeleteEventIndex(),c,i),i.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof La&&P(arguments[0],H)&&P(arguments[1],H)){let i=arguments[0],r=arguments[1],c=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(c)}else if(typeof arguments[2]=="boolean"&&P(arguments[0],H)&&arguments[1]instanceof La){let i=arguments[0],r=arguments[1];arguments[2]?this.addEdges(i,null):this.addEdges(i),this.computeIntersections(r)}}}addEdge(i,r){let c=i.getMonotoneChainEdge(),f=c.getStartIndexes();for(let g=0;g<f.length-1;g++){let y=new my(c,g),S=new rr(r,c.getMinX(g),y);this.events.add(S),this.events.add(new rr(c.getMaxX(g),S))}}processOverlaps(i,r,c,f){let g=c.getObject();for(let y=i;y<r;y++){let S=this.events.get(y);if(S.isInsert()){let I=S.getObject();c.isSameLabel(S)||(g.computeIntersections(I,f),this.nOverlaps++)}}}addEdges(){if(arguments.length===1)for(let i=arguments[0].iterator();i.hasNext();){let r=i.next();this.addEdge(r,r)}else if(arguments.length===2){let i=arguments[1];for(let r=arguments[0].iterator();r.hasNext();){let c=r.next();this.addEdge(c,i)}}}}class Mi extends Ru{constructor(){super(),Mi.constructor_.apply(this,arguments)}static constructor_(){if(this._parentGeom=null,this._lineEdgeMap=new _s,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Co,arguments.length===2){let i=arguments[0],r=arguments[1];Mi.constructor_.call(this,i,r,Yn.OGC_SFS_BOUNDARY_RULE)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._argIndex=i,this._parentGeom=r,this._boundaryNodeRule=c,r!==null&&this.add(r)}}static determineBoundary(i,r){return i.isInBoundary(r)?B.BOUNDARY:B.INTERIOR}insertBoundaryPoint(i,r){let c=this._nodes.addNode(r).getLabel(),f=1,g=B.NONE;g=c.getLocation(i,Ce.ON),g===B.BOUNDARY&&f++;let y=Mi.determineBoundary(this._boundaryNodeRule,f);c.setLocation(i,y)}computeSelfNodes(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return this.computeSelfNodes(i,r,!1)}if(arguments.length===3){let i=arguments[1],r=arguments[2],c=new La(arguments[0],!0,!1);c.setIsDoneIfProperInt(r);let f=this.createEdgeSetIntersector(),g=this._parentGeom instanceof ae||this._parentGeom instanceof Et||this._parentGeom instanceof at,y=i||!g;return f.computeIntersections(this._edges,c,y),this.addSelfIntersectionNodes(this._argIndex),c}}addPolygon(i){this.addPolygonRing(i.getExteriorRing(),B.EXTERIOR,B.INTERIOR);for(let r=0;r<i.getNumInteriorRing();r++){let c=i.getInteriorRingN(r);this.addPolygonRing(c,B.INTERIOR,B.EXTERIOR)}}addEdge(i){this.insertEdge(i);let r=i.getCoordinates();this.insertPoint(this._argIndex,r[0],B.BOUNDARY),this.insertPoint(this._argIndex,r[r.length-1],B.BOUNDARY)}addLineString(i){let r=Be.removeRepeatedPoints(i.getCoordinates());if(r.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;let c=new Au(r,new Jt(this._argIndex,B.INTERIOR));this._lineEdgeMap.put(i,c),this.insertEdge(c),d.isTrue(r.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,r[0]),this.insertBoundaryPoint(this._argIndex,r[r.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){let i=this.getBoundaryNodes(),r=new Array(i.size()).fill(null),c=0;for(let f=i.iterator();f.hasNext();){let g=f.next();r[c++]=g.getCoordinate().copy()}return r}addSelfIntersectionNodes(i){for(let r=this._edges.iterator();r.hasNext();){let c=r.next(),f=c.getLabel().getLocation(i);for(let g=c.eiList.iterator();g.hasNext();){let y=g.next();this.addSelfIntersectionNode(i,y.coord,f)}}}add(){if(!(arguments.length===1&&arguments[0]instanceof Q))return super.add.apply(this,arguments);{let i=arguments[0];if(i.isEmpty())return null;if(i instanceof at&&(this._useBoundaryDeterminationRule=!1),i instanceof Et)this.addPolygon(i);else if(i instanceof Z)this.addLineString(i);else if(i instanceof yt)this.addPoint(i);else if(i instanceof Li)this.addCollection(i);else if(i instanceof _n)this.addCollection(i);else if(i instanceof at)this.addCollection(i);else{if(!(i instanceof tt))throw new Je(i.getGeometryType());this.addCollection(i)}}}addCollection(i){for(let r=0;r<i.getNumGeometries();r++){let c=i.getGeometryN(r);this.add(c)}}locate(i){return P(this._parentGeom,Jn)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new So(this._parentGeom)),this._areaPtLocator.locate(i)):this._ptLocator.locate(i,this._parentGeom)}findEdge(){if(arguments.length===1&&arguments[0]instanceof Z){let i=arguments[0];return this._lineEdgeMap.get(i)}return super.findEdge.apply(this,arguments)}computeSplitEdges(i){for(let r=this._edges.iterator();r.hasNext();)r.next().eiList.addSplitEdges(i)}computeEdgeIntersections(i,r,c){let f=new La(r,c,!0);return f.setBoundaryNodes(this.getBoundaryNodes(),i.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,i._edges,f),f}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof yt){let i=arguments[0].getCoordinate();this.insertPoint(this._argIndex,i,B.INTERIOR)}else if(arguments[0]instanceof w){let i=arguments[0];this.insertPoint(this._argIndex,i,B.INTERIOR)}}getBoundaryNodes(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(i,r,c){if(this.isBoundaryNode(i,r))return null;c===B.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(i,r):this.insertPoint(i,r,c)}addPolygonRing(i,r,c){if(i.isEmpty())return null;let f=Be.removeRepeatedPoints(i.getCoordinates());if(f.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=f[0],null;let g=r,y=c;pe.isCCW(f)&&(g=c,y=r);let S=new Au(f,new Jt(this._argIndex,B.BOUNDARY,g,y));this._lineEdgeMap.put(i,S),this.insertEdge(S),this.insertPoint(this._argIndex,f[0],B.BOUNDARY)}insertPoint(i,r,c){let f=this._nodes.addNode(r),g=f.getLabel();g===null?f._label=new Jt(i,c):g.setLocation(i,c)}createEdgeSetIntersector(){return new _y}}class Io{constructor(){Io.constructor_.apply(this,arguments)}static constructor_(){if(this._li=new wn,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){let i=arguments[0];this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Mi(0,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];Io.constructor_.call(this,i,r,Yn.OGC_SFS_BOUNDARY_RULE)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];i.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Mi(0,i,c),this._arg[1]=new Mi(1,r,c)}}setComputationPrecision(i){this._resultPrecisionModel=i,this._li.setPrecisionModel(this._resultPrecisionModel)}getArgGeometry(i){return this._arg[i].getGeometry()}}class We extends Io{constructor(){super(),We.constructor_.apply(this,arguments)}static constructor_(){this._ptLocator=new Co,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Cf,this._resultPolyList=new M,this._resultLineList=new M,this._resultPointList=new M;let i=arguments[0],r=arguments[1];Io.constructor_.call(this,i,r),this._graph=new Ru(new ly),this._geomFact=i.getFactory()}static overlayOp(i,r,c){return new We(i,r).getResultGeometry(c)}static union(i,r){if(i.isEmpty()||r.isEmpty()){if(i.isEmpty()&&r.isEmpty())return We.createEmptyResult(We.UNION,i,r,i.getFactory());if(i.isEmpty())return r.copy();if(r.isEmpty())return i.copy()}if(i.isGeometryCollection()||r.isGeometryCollection())throw new s("This method does not support GeometryCollection arguments");return is.overlayOp(i,r,We.UNION)}static intersection(i,r){if(i.isEmpty()||r.isEmpty())return We.createEmptyResult(We.INTERSECTION,i,r,i.getFactory());if(i.isGeometryCollection()){let c=r;return Sa.map(i,new class{get interfaces_(){return[MapOp]}map(f){return We.intersection(f,c)}})}return is.overlayOp(i,r,We.INTERSECTION)}static symDifference(i,r){if(i.isEmpty()||r.isEmpty()){if(i.isEmpty()&&r.isEmpty())return We.createEmptyResult(We.SYMDIFFERENCE,i,r,i.getFactory());if(i.isEmpty())return r.copy();if(r.isEmpty())return i.copy()}if(i.isGeometryCollection()||r.isGeometryCollection())throw new s("This method does not support GeometryCollection arguments");return is.overlayOp(i,r,We.SYMDIFFERENCE)}static resultDimension(i,r,c){let f=r.getDimension(),g=c.getDimension(),y=-1;switch(i){case We.INTERSECTION:y=Math.min(f,g);break;case We.UNION:y=Math.max(f,g);break;case We.DIFFERENCE:y=f;break;case We.SYMDIFFERENCE:y=Math.max(f,g)}return y}static createEmptyResult(i,r,c,f){let g=We.resultDimension(i,r,c);return f.createEmpty(g)}static difference(i,r){if(i.isEmpty())return We.createEmptyResult(We.DIFFERENCE,i,r,i.getFactory());if(r.isEmpty())return i.copy();if(i.isGeometryCollection()||r.isGeometryCollection())throw new s("This method does not support GeometryCollection arguments");return is.overlayOp(i,r,We.DIFFERENCE)}static isResultOfOp(){if(arguments.length===2){let i=arguments[0],r=arguments[1],c=i.getLocation(0),f=i.getLocation(1);return We.isResultOfOp(c,f,r)}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];switch(i===B.BOUNDARY&&(i=B.INTERIOR),r===B.BOUNDARY&&(r=B.INTERIOR),c){case We.INTERSECTION:return i===B.INTERIOR&&r===B.INTERIOR;case We.UNION:return i===B.INTERIOR||r===B.INTERIOR;case We.DIFFERENCE:return i===B.INTERIOR&&r!==B.INTERIOR;case We.SYMDIFFERENCE:return i===B.INTERIOR&&r!==B.INTERIOR||i!==B.INTERIOR&&r===B.INTERIOR}return!1}}insertUniqueEdge(i){let r=this._edgeList.findEqualEdge(i);if(r!==null){let c=r.getLabel(),f=i.getLabel();r.isPointwiseEqual(i)||(f=new Jt(i.getLabel()),f.flip());let g=r.getDepth();g.isNull()&&g.add(c),g.add(f),c.merge(f)}else this._edgeList.add(i)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(let i=this._graph.getEdgeEnds().iterator();i.hasNext();){let r=i.next(),c=r.getSym();r.isInResult()&&c.isInResult()&&(r.setInResult(!1),c.setInResult(!1))}}mergeSymLabels(){for(let i=this._graph.getNodes().iterator();i.hasNext();)i.next().getEdges().mergeSymLabels()}computeOverlay(i){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);let r=new M;this._arg[0].computeSplitEdges(r),this._arg[1].computeSplitEdges(r),this.insertUniqueEdges(r),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Pu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(i),this.cancelDuplicateResultEdges();let c=new Mu(this._geomFact);c.add(this._graph),this._resultPolyList=c.getPolygons();let f=new fy(this,this._geomFact,this._ptLocator);this._resultLineList=f.build(i);let g=new py(this,this._geomFact,this._ptLocator);this._resultPointList=g.build(i),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,i)}findResultAreaEdges(i){for(let r=this._graph.getEdgeEnds().iterator();r.hasNext();){let c=r.next(),f=c.getLabel();f.isArea()&&!c.isInteriorAreaEdge()&&We.isResultOfOp(f.getLocation(0,Ce.RIGHT),f.getLocation(1,Ce.RIGHT),i)&&c.setInResult(!0)}}computeLabelsFromDepths(){for(let i=this._edgeList.iterator();i.hasNext();){let r=i.next(),c=r.getLabel(),f=r.getDepth();if(!f.isNull()){f.normalize();for(let g=0;g<2;g++)c.isNull(g)||!c.isArea()||f.isNull(g)||(f.getDelta(g)===0?c.toLine(g):(d.isTrue(!f.isNull(g,Ce.LEFT),"depth of LEFT side has not been initialized"),c.setLocation(g,Ce.LEFT,f.getLocation(g,Ce.LEFT)),d.isTrue(!f.isNull(g,Ce.RIGHT),"depth of RIGHT side has not been initialized"),c.setLocation(g,Ce.RIGHT,f.getLocation(g,Ce.RIGHT))))}}}isCoveredByA(i){return!!this.isCovered(i,this._resultPolyList)}isCoveredByLA(i){return!!this.isCovered(i,this._resultLineList)||!!this.isCovered(i,this._resultPolyList)}computeGeometry(i,r,c,f){let g=new M;return g.addAll(i),g.addAll(r),g.addAll(c),g.isEmpty()?We.createEmptyResult(f,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(g)}isCovered(i,r){for(let c=r.iterator();c.hasNext();){let f=c.next();if(this._ptLocator.locate(i,f)!==B.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){let i=new M;for(let r=this._edgeList.iterator();r.hasNext();){let c=r.next();c.isCollapsed()&&(r.remove(),i.add(c.getCollapsedEdge()))}this._edgeList.addAll(i)}updateNodeLabelling(){for(let i=this._graph.getNodes().iterator();i.hasNext();){let r=i.next(),c=r.getEdges().getLabel();r.getLabel().merge(c)}}getResultGeometry(i){return this.computeOverlay(i),this._resultGeom}insertUniqueEdges(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this.insertUniqueEdge(c)}}labelIncompleteNode(i,r){let c=this._ptLocator.locate(i.getCoordinate(),this._arg[r].getGeometry());i.getLabel().setLocation(r,c)}copyPoints(i){for(let r=this._arg[i].getNodeIterator();r.hasNext();){let c=r.next();this._graph.addNode(c.getCoordinate()).setLabel(i,c.getLabel().getLocation(i))}}computeLabelling(){for(let i=this._graph.getNodes().iterator();i.hasNext();)i.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(let i=this._graph.getNodes().iterator();i.hasNext();){let r=i.next(),c=r.getLabel();r.isIsolated()&&(c.isNull(0)?this.labelIncompleteNode(r,0):this.labelIncompleteNode(r,1)),r.getEdges().updateLabelling(c)}}}We.INTERSECTION=1,We.UNION=2,We.DIFFERENCE=3,We.SYMDIFFERENCE=4;class Lo{constructor(){Lo.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;let i=arguments[0],r=arguments[1];this._geom[0]=i,this._geom[1]=r,this.computeSnapTolerance()}static overlayOp(i,r,c){return new Lo(i,r).getResultGeometry(c)}static union(i,r){return Lo.overlayOp(i,r,We.UNION)}static intersection(i,r){return Lo.overlayOp(i,r,We.INTERSECTION)}static symDifference(i,r){return Lo.overlayOp(i,r,We.SYMDIFFERENCE)}static difference(i,r){return Lo.overlayOp(i,r,We.DIFFERENCE)}selfSnap(i){return new Ri(i).snapTo(i,this._snapTolerance)}removeCommonBits(i){this._cbr=new Eo,this._cbr.add(i[0]),this._cbr.add(i[1]);let r=new Array(2).fill(null);return r[0]=this._cbr.removeCommonBits(i[0].copy()),r[1]=this._cbr.removeCommonBits(i[1].copy()),r}prepareResult(i){return this._cbr.addCommonBits(i),i}getResultGeometry(i){let r=this.snap(this._geom),c=We.overlayOp(r[0],r[1],i);return this.prepareResult(c)}checkValid(i){i.isValid()||Fe.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=Ri.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(i){let r=this.removeCommonBits(i);return Ri.snap(r[0],r[1],this._snapTolerance)}}class is{constructor(){is.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null);let i=arguments[0],r=arguments[1];this._geom[0]=i,this._geom[1]=r}static overlayOp(i,r,c){return new is(i,r).getResultGeometry(c)}static union(i,r){return is.overlayOp(i,r,We.UNION)}static intersection(i,r){return is.overlayOp(i,r,We.INTERSECTION)}static symDifference(i,r){return is.overlayOp(i,r,We.SYMDIFFERENCE)}static difference(i,r){return is.overlayOp(i,r,We.DIFFERENCE)}getResultGeometry(i){let r=null,c=!1,f=null;try{r=We.overlayOp(this._geom[0],this._geom[1],i),c=!0}catch(g){if(!(g instanceof h))throw g;f=g}if(!c)try{r=Lo.overlayOp(this._geom[0],this._geom[1],i)}catch(g){throw g instanceof h?f:g}return r}}class Fu{static union(i,r){if(i.isEmpty()||r.isEmpty()){if(i.isEmpty()&&r.isEmpty())return We.createEmptyResult(We.UNION,i,r,i.getFactory());if(i.isEmpty())return r.copy();if(r.isEmpty())return i.copy()}return Q.checkNotGeometryCollection(i),Q.checkNotGeometryCollection(r),is.overlayOp(i,r,We.UNION)}}class Du{static diagonalSize(i){if(i.isNull())return 0;let r=i.getWidth(),c=i.getHeight();return Math.sqrt(r*r+c*c)}measure(i,r){let c=ys.distance(i,r,Du.DENSIFY_FRACTION),f=new K(i.getEnvelopeInternal());return f.expandToInclude(r.getEnvelopeInternal()),1-c/Du.diagonalSize(f)}get interfaces_(){return[z_]}}Du.DENSIFY_FRACTION=.25;var mP=Object.freeze({__proto__:null,AreaSimilarityMeasure:class{measure(A,i){return We.intersection(A,i).getArea()/Fu.union(A,i).getArea()}get interfaces_(){return[z_]}},HausdorffSimilarityMeasure:Du,SimilarityMeasure:z_,SimilarityMeasureCombiner:class{static combine(A,i){return Math.min(A,i)}}});class Nr{constructor(){Nr.constructor_.apply(this,arguments)}static constructor_(){this._areaBasePt=null,this._triangleCent3=new w,this._areasum2=0,this._cg3=new w,this._lineCentSum=new w,this._totalLength=0,this._ptCount=0,this._ptCentSum=new w;let i=arguments[0];this._areaBasePt=null,this.add(i)}static centroid3(i,r,c,f){return f.x=i.x+r.x+c.x,f.y=i.y+r.y+c.y,null}static getCentroid(i){return new Nr(i).getCentroid()}static area2(i,r,c){return(r.x-i.x)*(c.y-i.y)-(c.x-i.x)*(r.y-i.y)}setAreaBasePoint(i){this._areaBasePt=i}addPoint(i){this._ptCount+=1,this._ptCentSum.x+=i.x,this._ptCentSum.y+=i.y}addLineSegments(i){let r=0;for(let c=0;c<i.length-1;c++){let f=i[c].distance(i[c+1]);if(f===0)continue;r+=f;let g=(i[c].x+i[c+1].x)/2;this._lineCentSum.x+=f*g;let y=(i[c].y+i[c+1].y)/2;this._lineCentSum.y+=f*y}this._totalLength+=r,r===0&&i.length>0&&this.addPoint(i[0])}addHole(i){let r=pe.isCCW(i);for(let c=0;c<i.length-1;c++)this.addTriangle(this._areaBasePt,i[c],i[c+1],r);this.addLineSegments(i)}getCentroid(){let i=new w;if(Math.abs(this._areasum2)>0)i.x=this._cg3.x/3/this._areasum2,i.y=this._cg3.y/3/this._areasum2;else if(this._totalLength>0)i.x=this._lineCentSum.x/this._totalLength,i.y=this._lineCentSum.y/this._totalLength;else{if(!(this._ptCount>0))return null;i.x=this._ptCentSum.x/this._ptCount,i.y=this._ptCentSum.y/this._ptCount}return i}add(){if(arguments[0]instanceof Et){let i=arguments[0];this.addShell(i.getExteriorRing().getCoordinates());for(let r=0;r<i.getNumInteriorRing();r++)this.addHole(i.getInteriorRingN(r).getCoordinates())}else if(arguments[0]instanceof Q){let i=arguments[0];if(i.isEmpty())return null;if(i instanceof yt)this.addPoint(i.getCoordinate());else if(i instanceof Z)this.addLineSegments(i.getCoordinates());else if(i instanceof Et){let r=i;this.add(r)}else if(i instanceof tt){let r=i;for(let c=0;c<r.getNumGeometries();c++)this.add(r.getGeometryN(c))}}}addShell(i){i.length>0&&this.setAreaBasePoint(i[0]);let r=!pe.isCCW(i);for(let c=0;c<i.length-1;c++)this.addTriangle(this._areaBasePt,i[c],i[c+1],r);this.addLineSegments(i)}addTriangle(i,r,c,f){let g=f?1:-1;Nr.centroid3(i,r,c,this._triangleCent3);let y=Nr.area2(i,r,c);this._cg3.x+=g*y*this._triangleCent3.x,this._cg3.y+=g*y*this._triangleCent3.y,this._areasum2+=g*y}}class Pl{constructor(){Pl.constructor_.apply(this,arguments)}static constructor_(){this._coordSet=new xn,this._list=new M}static filterCoordinates(i){let r=new Pl;for(let c=0;c<i.length;c++)r.filter(i[c]);return r.getCoordinates()}filter(i){this._coordSet.add(i)&&this._list.add(i)}getCoordinates(){let i=new Array(this._list.size()).fill(null);return this._list.toArray(i)}get interfaces_(){return[ge]}}class Tr{constructor(){Tr.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFactory=null,this._inputPts=null,arguments.length===1){let i=arguments[0];Tr.constructor_.call(this,Tr.extractCoordinates(i),i.getFactory())}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._inputPts=Pl.filterCoordinates(i),this._geomFactory=r}}static extractCoordinates(i){let r=new Pl;return i.apply(r),r.getCoordinates()}lineOrPolygon(i){if((i=this.cleanRing(i)).length===3)return this._geomFactory.createLineString([i[0],i[1]]);let r=this._geomFactory.createLinearRing(i);return this._geomFactory.createPolygon(r)}cleanRing(i){d.equals(i[0],i[i.length-1]);let r=new M,c=null;for(let g=0;g<=i.length-2;g++){let y=i[g],S=i[g+1];y.equals(S)||c!==null&&this.isBetween(c,y,S)||(r.add(y),c=y)}r.add(i[i.length-1]);let f=new Array(r.size()).fill(null);return r.toArray(f)}isBetween(i,r,c){return pe.index(i,r,c)!==0?!1:i.x!==c.x&&(i.x<=r.x&&r.x<=c.x||c.x<=r.x&&r.x<=i.x)||i.y!==c.y&&(i.y<=r.y&&r.y<=c.y||c.y<=r.y&&r.y<=i.y)}reduce(i){let r=this.computeOctRing(i);if(r===null)return i;let c=new Xe;for(let g=0;g<r.length;g++)c.add(r[g]);for(let g=0;g<i.length;g++)Ji.isInRing(i[g],r)||c.add(i[g]);let f=Be.toCoordinateArray(c);return f.length<3?this.padArray3(f):f}getConvexHull(){if(this._inputPts.length===0)return this._geomFactory.createGeometryCollection();if(this._inputPts.length===1)return this._geomFactory.createPoint(this._inputPts[0]);if(this._inputPts.length===2)return this._geomFactory.createLineString(this._inputPts);let i=this._inputPts;this._inputPts.length>50&&(i=this.reduce(this._inputPts));let r=this.preSort(i),c=this.grahamScan(r),f=this.toCoordinateArray(c);return this.lineOrPolygon(f)}padArray3(i){let r=new Array(3).fill(null);for(let c=0;c<r.length;c++)c<i.length?r[c]=i[c]:r[c]=i[0];return r}computeOctPts(i){let r=new Array(8).fill(null);for(let c=0;c<r.length;c++)r[c]=i[0];for(let c=1;c<i.length;c++)i[c].x<r[0].x&&(r[0]=i[c]),i[c].x-i[c].y<r[1].x-r[1].y&&(r[1]=i[c]),i[c].y>r[2].y&&(r[2]=i[c]),i[c].x+i[c].y>r[3].x+r[3].y&&(r[3]=i[c]),i[c].x>r[4].x&&(r[4]=i[c]),i[c].x-i[c].y>r[5].x-r[5].y&&(r[5]=i[c]),i[c].y<r[6].y&&(r[6]=i[c]),i[c].x+i[c].y<r[7].x+r[7].y&&(r[7]=i[c]);return r}toCoordinateArray(i){let r=new Array(i.size()).fill(null);for(let c=0;c<i.size();c++){let f=i.get(c);r[c]=f}return r}grahamScan(i){let r=null,c=new Ia;c.push(i[0]),c.push(i[1]),c.push(i[2]);for(let f=3;f<i.length;f++){for(r=c.pop();!c.empty()&&pe.index(c.peek(),r,i[f])>0;)r=c.pop();c.push(r),c.push(i[f])}return c.push(i[0]),c}preSort(i){let r=null;for(let c=1;c<i.length;c++)(i[c].y<i[0].y||i[c].y===i[0].y&&i[c].x<i[0].x)&&(r=i[0],i[0]=i[c],i[c]=r);return Hn.sort(i,1,i.length,new Gu(i[0])),i}computeOctRing(i){let r=this.computeOctPts(i),c=new E;return c.add(r,!1),c.size()<3?null:(c.closeRing(),c.toCoordinateArray())}}class Gu{constructor(){Gu.constructor_.apply(this,arguments)}static constructor_(){this._origin=null;let i=arguments[0];this._origin=i}static polarCompare(i,r,c){let f=r.x-i.x,g=r.y-i.y,y=c.x-i.x,S=c.y-i.y,I=pe.index(i,r,c);if(I===pe.COUNTERCLOCKWISE)return 1;if(I===pe.CLOCKWISE)return-1;let z=f*f+g*g,ne=y*y+S*S;return z<ne?-1:z>ne?1:0}compare(i,r){let c=i,f=r;return Gu.polarCompare(this._origin,c,f)}get interfaces_(){return[m]}}Tr.RadialComparator=Gu;class or{constructor(){or.constructor_.apply(this,arguments)}static constructor_(){this._interiorPoint=null,this._maxWidth=-1;let i=arguments[0];this.process(i)}static avg(i,r){return(i+r)/2}static getInteriorPoint(i){return new or(i).getInteriorPoint()}process(i){if(i.isEmpty())return null;if(i instanceof Et)this.processPolygon(i);else if(i instanceof tt){let r=i;for(let c=0;c<r.getNumGeometries();c++)this.process(r.getGeometryN(c))}}getInteriorPoint(){return this._interiorPoint}processPolygon(i){let r=new kr(i);r.process();let c=r.getWidth();c>this._maxWidth&&(this._maxWidth=c,this._interiorPoint=r.getInteriorPoint())}}class kr{constructor(){kr.constructor_.apply(this,arguments)}static constructor_(){this._polygon=null,this._interiorPointY=null,this._interiorSectionWidth=0,this._interiorPoint=null;let i=arguments[0];this._polygon=i,this._interiorPointY=ju.getScanLineY(i)}static isEdgeCrossingCounted(i,r,c){let f=i.getY(),g=r.getY();return f!==g&&!(f===c&&g<c)&&!(g===c&&f<c)}static intersectsHorizontalLine(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return!(r<i.getMinY())&&!(r>i.getMaxY())}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return!(i.getY()>c&&r.getY()>c)&&!(i.getY()<c&&r.getY()<c)}}static intersection(i,r,c){let f=i.getX(),g=r.getX();if(f===g)return f;let y=g-f,S=(r.getY()-i.getY())/y;return f+(c-i.getY())/S}findBestMidpoint(i){if(i.size()===0)return null;d.isTrue(i.size()%2==0,"Interior Point robustness failure: odd number of scanline crossings"),i.sort(new CS);for(let r=0;r<i.size();r+=2){let c=i.get(r),f=i.get(r+1),g=f-c;if(g>this._interiorSectionWidth){this._interiorSectionWidth=g;let y=or.avg(c,f);this._interiorPoint=new w(y,this._interiorPointY)}}}getWidth(){return this._interiorSectionWidth}getInteriorPoint(){return this._interiorPoint}addEdgeCrossing(i,r,c,f){if(!kr.intersectsHorizontalLine(i,r,c)||!kr.isEdgeCrossingCounted(i,r,c))return null;let g=kr.intersection(i,r,c);f.add(g)}process(){if(this._polygon.isEmpty())return null;this._interiorPoint=new w(this._polygon.getCoordinate());let i=new M;this.scanRing(this._polygon.getExteriorRing(),i);for(let r=0;r<this._polygon.getNumInteriorRing();r++)this.scanRing(this._polygon.getInteriorRingN(r),i);this.findBestMidpoint(i)}scanRing(i,r){if(!kr.intersectsHorizontalLine(i.getEnvelopeInternal(),this._interiorPointY))return null;let c=i.getCoordinateSequence();for(let f=1;f<c.size();f++){let g=c.getCoordinate(f-1),y=c.getCoordinate(f);this.addEdgeCrossing(g,y,this._interiorPointY,r)}}}class CS{compare(i,r){return i<r?-1:i>r?1:0}get interfaces_(){return[m]}}kr.DoubleComparator=CS;class ju{constructor(){ju.constructor_.apply(this,arguments)}static constructor_(){this._poly=null,this._centreY=null,this._hiY=l.MAX_VALUE,this._loY=-l.MAX_VALUE;let i=arguments[0];this._poly=i,this._hiY=i.getEnvelopeInternal().getMaxY(),this._loY=i.getEnvelopeInternal().getMinY(),this._centreY=or.avg(this._loY,this._hiY)}static getScanLineY(i){return new ju(i).getScanLineY()}process(i){let r=i.getCoordinateSequence();for(let c=0;c<r.size();c++){let f=r.getY(c);this.updateInterval(f)}}getScanLineY(){this.process(this._poly.getExteriorRing());for(let i=0;i<this._poly.getNumInteriorRing();i++)this.process(this._poly.getInteriorRingN(i));return or.avg(this._hiY,this._loY)}updateInterval(i){i<=this._centreY?i>this._loY&&(this._loY=i):i>this._centreY&&i<this._hiY&&(this._hiY=i)}}or.InteriorPointPolygon=kr,or.ScanLineYOrdinateFinder=ju;class qu{constructor(){qu.constructor_.apply(this,arguments)}static constructor_(){this._centroid=null,this._minDistance=l.MAX_VALUE,this._interiorPoint=null;let i=arguments[0];i.isEmpty()?this._centroid=null:(this._centroid=Nr.getCentroid(i),i.getPrecisionModel().makePrecise(this._centroid)),this.addInterior(i),this._interiorPoint===null&&this.addEndpoints(i)}static getInteriorPoint(i){return new qu(i).getInteriorPoint()}add(i){let r=i.distance(this._centroid);r<this._minDistance&&(this._interiorPoint=new w(i),this._minDistance=r)}getInteriorPoint(){return this._interiorPoint}addEndpoints(){if(arguments[0]instanceof Q){let i=arguments[0];if(i instanceof Z)this.addEndpoints(i.getCoordinates());else if(i instanceof tt){let r=i;for(let c=0;c<r.getNumGeometries();c++)this.addEndpoints(r.getGeometryN(c))}}else if(arguments[0]instanceof Array){let i=arguments[0];this.add(i[0]),this.add(i[i.length-1])}}addInterior(){if(arguments[0]instanceof Q){let i=arguments[0];if(i instanceof Z)this.addInterior(i.getCoordinates());else if(i instanceof tt){let r=i;for(let c=0;c<r.getNumGeometries();c++)this.addInterior(r.getGeometryN(c))}}else if(arguments[0]instanceof Array){let i=arguments[0];for(let r=1;r<i.length-1;r++)this.add(i[r])}}}class $u{constructor(){$u.constructor_.apply(this,arguments)}static constructor_(){this._centroid=null,this._minDistance=l.MAX_VALUE,this._interiorPoint=null;let i=arguments[0];this._centroid=Nr.getCentroid(i),this.add(i)}static getInteriorPoint(i){return new $u(i).getInteriorPoint()}add(){if(arguments[0]instanceof Q){let i=arguments[0];if(i instanceof yt)this.add(i.getCoordinate());else if(i instanceof tt){let r=i;for(let c=0;c<r.getNumGeometries();c++)this.add(r.getGeometryN(c))}}else if(arguments[0]instanceof w){let i=arguments[0],r=i.distance(this._centroid);r<this._minDistance&&(this._interiorPoint=new w(i),this._minDistance=r)}}getInteriorPoint(){return this._interiorPoint}}class Na{constructor(){Na.constructor_.apply(this,arguments)}static constructor_(){this._input=null,this._extremalPts=null,this._centre=null,this._radius=0;let i=arguments[0];this._input=i}static pointWithMinAngleWithSegment(i,r,c){let f=l.MAX_VALUE,g=null;for(let y=0;y<i.length;y++){let S=i[y];if(S===r||S===c)continue;let I=ct.angleBetween(r,S,c);I<f&&(f=I,g=S)}return g}static pointWitMinAngleWithX(i,r){let c=l.MAX_VALUE,f=null;for(let g=0;g<i.length;g++){let y=i[g];if(y===r)continue;let S=y.x-r.x,I=y.y-r.y;I<0&&(I=-I);let z=I/Math.sqrt(S*S+I*I);z<c&&(c=z,f=y)}return f}static lowestPoint(i){let r=i[0];for(let c=1;c<i.length;c++)i[c].y<r.y&&(r=i[c]);return r}static farthestPoints(i){let r=i[0].distance(i[1]),c=i[1].distance(i[2]),f=i[2].distance(i[0]);return r>=c&&r>=f?[i[0],i[1]]:c>=r&&c>=f?[i[1],i[2]]:[i[2],i[0]]}getRadius(){return this.compute(),this._radius}getDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}let i=this._extremalPts[0],r=this._extremalPts[1];return this._input.getFactory().createLineString([i,r])}getExtremalPoints(){return this.compute(),this._extremalPts}computeCirclePoints(){if(this._input.isEmpty())return this._extremalPts=new Array(0).fill(null),null;if(this._input.getNumPoints()===1){let g=this._input.getCoordinates();return this._extremalPts=[new w(g[0])],null}let i=this._input.convexHull().getCoordinates(),r=i;if(i[0].equals2D(i[i.length-1])&&(r=new Array(i.length-1).fill(null),Be.copyDeep(i,0,r,0,i.length-1)),r.length<=2)return this._extremalPts=Be.copyDeep(r),null;let c=Na.lowestPoint(r),f=Na.pointWitMinAngleWithX(r,c);for(let g=0;g<r.length;g++){let y=Na.pointWithMinAngleWithSegment(r,c,f);if(ct.isObtuse(c,y,f))return this._extremalPts=[new w(c),new w(f)],null;if(ct.isObtuse(y,c,f))c=y;else{if(!ct.isObtuse(y,f,c))return this._extremalPts=[new w(c),new w(f),new w(y)],null;f=y}}d.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")}compute(){if(this._extremalPts!==null)return null;this.computeCirclePoints(),this.computeCentre(),this._centre!==null&&(this._radius=this._centre.distance(this._extremalPts[0]))}getCircle(){if(this.compute(),this._centre===null)return this._input.getFactory().createPolygon();let i=this._input.getFactory().createPoint(this._centre);return this._radius===0?i:Ht.bufferOp(i,this._radius)}getCentre(){return this.compute(),this._centre}getMaximumDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre);case 2:return this._input.getFactory().createLineString([this._extremalPts[0],this._extremalPts[1]]);default:let i=Na.farthestPoints(this._extremalPts);return this._input.getFactory().createLineString(i)}}computeCentre(){switch(this._extremalPts.length){case 0:this._centre=null;break;case 1:this._centre=this._extremalPts[0];break;case 2:this._centre=new w((this._extremalPts[0].x+this._extremalPts[1].x)/2,(this._extremalPts[0].y+this._extremalPts[1].y)/2);break;case 3:this._centre=Gt.circumcentre(this._extremalPts[0],this._extremalPts[1],this._extremalPts[2])}}}class ss{constructor(){ss.constructor_.apply(this,arguments)}static constructor_(){if(this._inputGeom=null,this._isConvex=null,this._convexHullPts=null,this._minBaseSeg=new Ze,this._minWidthPt=null,this._minPtIndex=null,this._minWidth=0,arguments.length===1){let i=arguments[0];ss.constructor_.call(this,i,!1)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._inputGeom=i,this._isConvex=r}}static nextIndex(i,r){return++r>=i.length&&(r=0),r}static computeC(i,r,c){return i*c.y-r*c.x}static getMinimumDiameter(i){return new ss(i).getDiameter()}static getMinimumRectangle(i){return new ss(i).getMinimumRectangle()}static computeSegmentForLine(i,r,c){let f=null,g=null;return Math.abs(r)>Math.abs(i)?(f=new w(0,c/r),g=new w(1,c/r-i/r)):(f=new w(c/i,0),g=new w(c/i-r/i,1)),new Ze(f,g)}getWidthCoordinate(){return this.computeMinimumDiameter(),this._minWidthPt}getSupportingSegment(){return this.computeMinimumDiameter(),this._inputGeom.getFactory().createLineString([this._minBaseSeg.p0,this._minBaseSeg.p1])}getDiameter(){if(this.computeMinimumDiameter(),this._minWidthPt===null)return this._inputGeom.getFactory().createLineString();let i=this._minBaseSeg.project(this._minWidthPt);return this._inputGeom.getFactory().createLineString([i,this._minWidthPt])}computeWidthConvex(i){this._convexHullPts=i instanceof Et?i.getExteriorRing().getCoordinates():i.getCoordinates(),this._convexHullPts.length===0?(this._minWidth=0,this._minWidthPt=null,this._minBaseSeg=null):this._convexHullPts.length===1?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[0]):this._convexHullPts.length===2||this._convexHullPts.length===3?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[1]):this.computeConvexRingMinDiameter(this._convexHullPts)}computeConvexRingMinDiameter(i){this._minWidth=l.MAX_VALUE;let r=1,c=new Ze;for(let f=0;f<i.length-1;f++)c.p0=i[f],c.p1=i[f+1],r=this.findMaxPerpDistance(i,c,r)}findMaxPerpDistance(i,r,c){let f=r.distancePerpendicular(i[c]),g=f,y=c,S=y;for(;g>=f;)f=g,y=S,S=ss.nextIndex(i,y),g=r.distancePerpendicular(i[S]);return f<this._minWidth&&(this._minPtIndex=y,this._minWidth=f,this._minWidthPt=i[this._minPtIndex],this._minBaseSeg=new Ze(r)),y}getMinimumRectangle(){if(this.computeMinimumDiameter(),this._minWidth===0)return this._minBaseSeg.p0.equals2D(this._minBaseSeg.p1)?this._inputGeom.getFactory().createPoint(this._minBaseSeg.p0):this._minBaseSeg.toGeometry(this._inputGeom.getFactory());let i=this._minBaseSeg.p1.x-this._minBaseSeg.p0.x,r=this._minBaseSeg.p1.y-this._minBaseSeg.p0.y,c=l.MAX_VALUE,f=-l.MAX_VALUE,g=l.MAX_VALUE,y=-l.MAX_VALUE;for(let cn=0;cn<this._convexHullPts.length;cn++){let Oi=ss.computeC(i,r,this._convexHullPts[cn]);Oi>f&&(f=Oi),Oi<c&&(c=Oi);let Dr=ss.computeC(-r,i,this._convexHullPts[cn]);Dr>y&&(y=Dr),Dr<g&&(g=Dr)}let S=ss.computeSegmentForLine(-i,-r,y),I=ss.computeSegmentForLine(-i,-r,g),z=ss.computeSegmentForLine(-r,i,f),ne=ss.computeSegmentForLine(-r,i,c),he=z.lineIntersection(S),Ie=ne.lineIntersection(S),Oe=ne.lineIntersection(I),Ue=z.lineIntersection(I),ut=this._inputGeom.getFactory().createLinearRing([he,Ie,Oe,Ue,he]);return this._inputGeom.getFactory().createPolygon(ut)}computeMinimumDiameter(){if(this._minWidthPt!==null)return null;if(this._isConvex)this.computeWidthConvex(this._inputGeom);else{let i=new Tr(this._inputGeom).getConvexHull();this.computeWidthConvex(i)}}getLength(){return this.computeMinimumDiameter(),this._minWidth}}var _P=Object.freeze({__proto__:null,Angle:ct,Area:Tn,Centroid:Nr,ConvexHull:Tr,Distance:qe,InteriorPointArea:or,InteriorPointLine:qu,InteriorPointPoint:$u,Length:rt,MinimumBoundingCircle:Na,MinimumDiameter:ss,Orientation:pe,PointLocation:Ji,PointLocator:Co,RobustLineIntersector:wn,distance:uS,locate:cP,match:mP});class Fl{constructor(){Fl.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null;let i=arguments[0];this._inputGeom=i}static densify(i,r){let c=new Fl(i);return c.setDistanceTolerance(r),c.getResultGeometry()}static densifyPoints(i,r,c){let f=new Ze,g=new E;for(let y=0;y<i.length-1;y++){f.p0=i[y],f.p1=i[y+1],g.add(f.p0,!1);let S=f.getLength(),I=Math.trunc(S/r)+1;if(I>1){let z=S/I;for(let ne=1;ne<I;ne++){let he=ne*z/S,Ie=f.pointAlong(he);c.makePrecise(Ie),g.add(Ie,!1)}}}return g.add(i[i.length-1],!1),g.toCoordinateArray()}setDistanceTolerance(i){if(i<=0)throw new s("Tolerance must be positive");this._distanceTolerance=i}getResultGeometry(){return new Rf(this._distanceTolerance).transform(this._inputGeom)}}class Rf extends oe{constructor(){super(),Rf.constructor_.apply(this,arguments)}static constructor_(){this.distanceTolerance=null;let i=arguments[0];this.distanceTolerance=i}transformCoordinates(i,r){let c=i.toCoordinateArray(),f=Fl.densifyPoints(c,this.distanceTolerance,r.getPrecisionModel());return r instanceof Z&&f.length===1&&(f=new Array(0).fill(null)),this._factory.getCoordinateSequenceFactory().create(f)}transformPolygon(i,r){let c=super.transformPolygon.call(this,i,r);return r instanceof at?c:this.createValidArea(c)}createValidArea(i){return Ht.bufferOp(i,0)}transformMultiPolygon(i,r){let c=super.transformMultiPolygon.call(this,i,r);return this.createValidArea(c)}}Fl.DensifyTransformer=Rf;var yP=Object.freeze({__proto__:null,Densifier:Fl});class Ta{constructor(){Ta.constructor_.apply(this,arguments)}static constructor_(){this._orig=null,this._sym=null,this._next=null;let i=arguments[0];this._orig=i}static create(i,r){let c=new Ta(i),f=new Ta(r);return c.link(f),c}oNext(){return this._sym._next}directionY(){return this.directionPt().getY()-this._orig.getY()}equals(){if(arguments.length===2&&arguments[1]instanceof w&&arguments[0]instanceof w){let i=arguments[0],r=arguments[1];return this._orig.equals2D(i)&&this._sym._orig.equals(r)}}findLowest(){let i=this,r=this.oNext();do r.compareTo(i)<0&&(i=r),r=r.oNext();while(r!==this);return i}compareTo(i){let r=i;return this.compareAngularDirection(r)}toStringNode(){let i=this.orig();this.dest();let r=new re;r.append("Node( "+rn.format(i)+` )
`);let c=this;do r.append("  -> "+c),r.append(`
`),c=c.oNext();while(c!==this);return r.toString()}link(i){this.setSym(i),i.setSym(this),this.setNext(i),i.setNext(this)}orig(){return this._orig}setNext(i){this._next=i}find(i){let r=this;do{if(r===null)return null;if(r.dest().equals2D(i))return r;r=r.oNext()}while(r!==this);return null}dest(){return this._sym._orig}isEdgesSorted(){let i=this.findLowest(),r=i;do{let c=r.oNext();if(c===i)break;if(!(c.compareTo(r)>0))return!1;r=c}while(r!==i);return!0}insert(i){if(this.oNext()===this)return this.insertAfter(i),null;this.insertionEdge(i).insertAfter(i)}insertAfter(i){d.equals(this._orig,i.orig());let r=this.oNext();this._sym.setNext(i),i.sym().setNext(r)}degree(){let i=0,r=this;do i++,r=r.oNext();while(r!==this);return i}directionPt(){return this.dest()}sym(){return this._sym}prev(){return this._sym.next()._sym}compareAngularDirection(i){let r=this.directionX(),c=this.directionY(),f=i.directionX(),g=i.directionY();if(r===f&&c===g)return 0;let y=kt.quadrant(r,c),S=kt.quadrant(f,g);if(y>S)return 1;if(y<S)return-1;let I=this.directionPt(),z=i.directionPt();return pe.index(i._orig,z,I)}prevNode(){let i=this;for(;i.degree()===2;)if(i=i.prev(),i===this)return null;return i}directionX(){return this.directionPt().getX()-this._orig.getX()}insertionEdge(i){let r=this;do{let c=r.oNext();if(c.compareTo(r)>0&&i.compareTo(r)>=0&&i.compareTo(c)<=0||c.compareTo(r)<=0&&(i.compareTo(c)<=0||i.compareTo(r)>=0))return r;r=c}while(r!==this);return d.shouldNeverReachHere(),null}next(){return this._next}setSym(i){this._sym=i}toString(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"}toStringNodeEdge(){return"  -> ("+rn.format(this.dest())}}class Rr extends Ta{constructor(){super(),Rr.constructor_.apply(this,arguments)}static constructor_(){this._isMarked=!1;let i=arguments[0];Ta.constructor_.call(this,i)}static setMarkBoth(i,r){i.setMark(r),i.sym().setMark(r)}static isMarked(i){return i.isMarked()}static setMark(i,r){i.setMark(r)}static markBoth(i){i.mark(),i.sym().mark()}static mark(i){i.mark()}setMark(i){this._isMarked=i}mark(){this._isMarked=!0}isMarked(){return this._isMarked}}class Mf{constructor(){Mf.constructor_.apply(this,arguments)}static constructor_(){this._vertexMap=new _s}static isValidEdge(i,r){return r.compareTo(i)!==0}insert(i,r,c){let f=this.create(i,r);c!==null?c.insert(f):this._vertexMap.put(i,f);let g=this._vertexMap.get(r);return g!==null?g.insert(f.sym()):this._vertexMap.put(r,f.sym()),f}create(i,r){let c=this.createEdge(i),f=this.createEdge(r);return c.link(f),c}createEdge(i){return new Ta(i)}addEdge(i,r){if(!Mf.isValidEdge(i,r))return null;let c=this._vertexMap.get(i),f=null;return c!==null&&(f=c.find(r)),f!==null?f:this.insert(i,r,c)}getVertexEdges(){return this._vertexMap.values()}findEdge(i,r){let c=this._vertexMap.get(i);return c===null?null:c.find(r)}}class yy extends Rr{constructor(){super(),yy.constructor_.apply(this,arguments)}static constructor_(){this._isStart=!1;let i=arguments[0];Rr.constructor_.call(this,i)}setStart(){this._isStart=!0}isStart(){return this._isStart}}class vP extends Mf{constructor(){super()}createEdge(i){return new yy(i)}}class Af{constructor(){Af.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._factory=null,this._graph=null,this._lines=new M,this._nodeEdgeStack=new Ia,this._ringStartEdge=null,this._graph=new vP}static dissolve(i){let r=new Af;return r.add(i),r.getResult()}addLine(i){this._lines.add(this._factory.createLineString(i.toCoordinateArray()))}updateRingStartEdge(i){return i.isStart()||(i=i.sym()).isStart()?this._ringStartEdge===null?(this._ringStartEdge=i,null):void(i.orig().compareTo(this._ringStartEdge.orig())<0&&(this._ringStartEdge=i)):null}getResult(){return this._result===null&&this.computeResult(),this._result}process(i){let r=i.prevNode();r===null&&(r=i),this.stackEdges(r),this.buildLines()}stackEdges(i){let r=i;do Rr.isMarked(r)||this._nodeEdgeStack.add(r),r=r.oNext();while(r!==i)}computeResult(){for(let i=this._graph.getVertexEdges().iterator();i.hasNext();){let r=i.next();Rr.isMarked(r)||this.process(r)}this._result=this._factory.buildGeometry(this._lines)}buildLines(){for(;!this._nodeEdgeStack.empty();){let i=this._nodeEdgeStack.pop();Rr.isMarked(i)||this.buildLine(i)}}add(){if(arguments[0]instanceof Q)arguments[0].apply(new class{get interfaces_(){return[Pe]}filter(i){i instanceof Z&&this.add(i)}});else if(P(arguments[0],j))for(let i=arguments[0].iterator();i.hasNext();){let r=i.next();this.add(r)}else if(arguments[0]instanceof Z){let i=arguments[0];this._factory===null&&(this._factory=i.getFactory());let r=i.getCoordinateSequence(),c=!1;for(let f=1;f<r.size();f++){let g=this._graph.addEdge(r.getCoordinate(f-1),r.getCoordinate(f));g!==null&&(c||(g.setStart(),c=!0))}}}buildRing(i){let r=new E,c=i;for(r.add(c.orig().copy(),!1);c.sym().degree()===2;){let f=c.next();if(f===i)break;r.add(f.orig().copy(),!1),c=f}r.add(c.dest().copy(),!1),this.addLine(r)}buildLine(i){let r=new E,c=i;for(this._ringStartEdge=null,Rr.markBoth(c),r.add(c.orig().copy(),!1);c.sym().degree()===2;){this.updateRingStartEdge(c);let f=c.next();if(f===i)return this.buildRing(this._ringStartEdge),null;r.add(f.orig().copy(),!1),c=f,Rr.markBoth(c)}r.add(c.dest().clone(),!1),this.stackEdges(c.sym()),this.addLine(r)}}var bP=Object.freeze({__proto__:null,LineDissolver:Af}),xP=Object.freeze({__proto__:null,GeometryGraph:Mi});class vy{visit(i){}}class Of{constructor(){Of.constructor_.apply(this,arguments)}static constructor_(){if(this._p=null,this._data=null,this._left=null,this._right=null,this._count=null,arguments.length===2){let i=arguments[0],r=arguments[1];this._p=new w(i),this._left=null,this._right=null,this._count=1,this._data=r}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._p=new w(i,r),this._left=null,this._right=null,this._count=1,this._data=c}}isRepeated(){return this._count>1}getRight(){return this._right}getCoordinate(){return this._p}setLeft(i){this._left=i}getX(){return this._p.x}getData(){return this._data}getCount(){return this._count}increment(){this._count=this._count+1}setRight(i){this._right=i}getLeft(){return this._left}getY(){return this._p.y}}class ka{constructor(){ka.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._numberOfNodes=null,this._tolerance=null,arguments.length===0)ka.constructor_.call(this,0);else if(arguments.length===1){let i=arguments[0];this._tolerance=i}}static toCoordinates(){if(arguments.length===1){let i=arguments[0];return ka.toCoordinates(i,!1)}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=new E;for(let f=i.iterator();f.hasNext();){let g=f.next(),y=r?g.getCount():1;for(let S=0;S<y;S++)c.add(g.getCoordinate(),!0)}return c.toCoordinateArray()}}insert(){if(arguments.length===1){let i=arguments[0];return this.insert(i,null)}if(arguments.length===2){let i=arguments[0],r=arguments[1];if(this._root===null)return this._root=new Of(i,r),this._root;if(this._tolerance>0){let c=this.findBestMatchNode(i);if(c!==null)return c.increment(),c}return this.insertExact(i,r)}}query(){if(arguments.length===1){let i=arguments[0],r=new M;return this.query(i,r),r}if(arguments.length===2){if(arguments[0]instanceof K&&P(arguments[1],H)){let i=arguments[0],r=arguments[1];this.queryNode(this._root,i,!0,new class{get interfaces_(){return[vy]}visit(c){r.add(c)}})}else if(arguments[0]instanceof K&&P(arguments[1],vy)){let i=arguments[0],r=arguments[1];this.queryNode(this._root,i,!0,r)}}}queryNode(i,r,c,f){if(i===null)return null;let g=null,y=null,S=null;c?(g=r.getMinX(),y=r.getMaxX(),S=i.getX()):(g=r.getMinY(),y=r.getMaxY(),S=i.getY());let I=S<=y;g<S&&this.queryNode(i.getLeft(),r,!c,f),r.contains(i.getCoordinate())&&f.visit(i),I&&this.queryNode(i.getRight(),r,!c,f)}findBestMatchNode(i){let r=new Pf(i,this._tolerance);return this.query(r.queryEnvelope(),r),r.getNode()}isEmpty(){return this._root===null}insertExact(i,r){let c=this._root,f=this._root,g=!0,y=!0;for(;c!==null;){if(c!==null&&i.distance(c.getCoordinate())<=this._tolerance)return c.increment(),c;y=g?i.x<c.getX():i.y<c.getY(),f=c,c=y?c.getLeft():c.getRight(),g=!g}this._numberOfNodes=this._numberOfNodes+1;let S=new Of(i,r);return y?f.setLeft(S):f.setRight(S),S}}class Pf{constructor(){Pf.constructor_.apply(this,arguments)}static constructor_(){this._tolerance=null,this._matchNode=null,this._matchDist=0,this._p=null;let i=arguments[0],r=arguments[1];this._p=i,this._tolerance=r}queryEnvelope(){let i=new K(this._p);return i.expandBy(this._tolerance),i}getNode(){return this._matchNode}visit(i){let r=this._p.distance(i.getCoordinate());if(!(r<=this._tolerance))return null;let c=!1;(this._matchNode===null||r<this._matchDist||this._matchNode!==null&&r===this._matchDist&&i.getCoordinate().compareTo(this._matchNode.getCoordinate())<1)&&(c=!0),c&&(this._matchNode=i,this._matchDist=r)}get interfaces_(){return[vy]}}ka.BestMatchVisitor=Pf;var wP=Object.freeze({__proto__:null,KdTree:ka});class No{constructor(){No.constructor_.apply(this,arguments)}static constructor_(){this._items=new M,this._subnode=new Array(4).fill(null)}static getSubnodeIndex(i,r,c){let f=-1;return i.getMinX()>=r&&(i.getMinY()>=c&&(f=3),i.getMaxY()<=c&&(f=1)),i.getMaxX()<=r&&(i.getMinY()>=c&&(f=2),i.getMaxY()<=c&&(f=0)),f}size(){let i=0;for(let r=0;r<4;r++)this._subnode[r]!==null&&(i+=this._subnode[r].size());return i+this._items.size()}addAllItemsFromOverlapping(i,r){if(!this.isSearchMatch(i))return null;r.addAll(this._items);for(let c=0;c<4;c++)this._subnode[c]!==null&&this._subnode[c].addAllItemsFromOverlapping(i,r)}visitItems(i,r){for(let c=this._items.iterator();c.hasNext();)r.visitItem(c.next())}hasItems(){return!this._items.isEmpty()}remove(i,r){if(!this.isSearchMatch(i))return!1;let c=!1;for(let f=0;f<4;f++)if(this._subnode[f]!==null&&(c=this._subnode[f].remove(i,r),c)){this._subnode[f].isPrunable()&&(this._subnode[f]=null);break}return c||(c=this._items.remove(r),c)}visit(i,r){if(!this.isSearchMatch(i))return null;this.visitItems(i,r);for(let c=0;c<4;c++)this._subnode[c]!==null&&this._subnode[c].visit(i,r)}getItems(){return this._items}depth(){let i=0;for(let r=0;r<4;r++)if(this._subnode[r]!==null){let c=this._subnode[r].depth();c>i&&(i=c)}return i+1}hasChildren(){for(let i=0;i<4;i++)if(this._subnode[i]!==null)return!0;return!1}isPrunable(){return!(this.hasChildren()||this.hasItems())}addAllItems(i){i.addAll(this._items);for(let r=0;r<4;r++)this._subnode[r]!==null&&this._subnode[r].addAllItems(i);return i}getNodeCount(){let i=0;for(let r=0;r<4;r++)this._subnode[r]!==null&&(i+=this._subnode[r].size());return i+1}isEmpty(){let i=!0;if(this._items.isEmpty()){for(let r=0;r<4;r++)if(this._subnode[r]!==null&&!this._subnode[r].isEmpty()){i=!1;break}}else i=!1;return i}add(i){this._items.add(i)}get interfaces_(){return[u]}}function Bu(){}Bu.exponent=function(A){return function(i,r){let c,f,g,y,S={64:{d:32752,c:0,b:0,a:0}},I={64:11}[i];if(y||(c=r<0||1/r<0,isFinite(r)||(y=S[i],c&&(y.d+=1<<i/4-1),f=Math.pow(2,I)-1,g=0)),!y){for(f={64:1023}[i],g=Math.abs(r);g>=2;)f++,g/=2;for(;g<1&&f>0;)f--,g*=2;f<=0&&(g/=2)}return f}(64,A)-1023},Bu.powerOf2=function(A){return Math.pow(2,A)};class Ff{constructor(){Ff.constructor_.apply(this,arguments)}static constructor_(){this._pt=new w,this._level=0,this._env=null;let i=arguments[0];this.computeKey(i)}static computeQuadLevel(i){let r=i.getWidth(),c=i.getHeight(),f=r>c?r:c;return Bu.exponent(f)+1}getLevel(){return this._level}computeKey(){if(arguments.length===1){let i=arguments[0];for(this._level=Ff.computeQuadLevel(i),this._env=new K,this.computeKey(this._level,i);!this._env.contains(i);)this._level+=1,this.computeKey(this._level,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=Bu.powerOf2(i);this._pt.x=Math.floor(r.getMinX()/c)*c,this._pt.y=Math.floor(r.getMinY()/c)*c,this._env.init(this._pt.x,this._pt.x+c,this._pt.y,this._pt.y+c)}}getEnvelope(){return this._env}getCentre(){return new w((this._env.getMinX()+this._env.getMaxX())/2,(this._env.getMinY()+this._env.getMaxY())/2)}getPoint(){return this._pt}}let SP=class Bh extends No{constructor(){super(),Bh.constructor_.apply(this,arguments)}static constructor_(){this._env=null,this._centrex=null,this._centrey=null,this._level=null;let i=arguments[0],r=arguments[1];this._env=i,this._level=r,this._centrex=(i.getMinX()+i.getMaxX())/2,this._centrey=(i.getMinY()+i.getMaxY())/2}static createNode(i){let r=new Ff(i);return new Bh(r.getEnvelope(),r.getLevel())}static createExpanded(i,r){let c=new K(r);i!==null&&c.expandToInclude(i._env);let f=Bh.createNode(c);return i!==null&&f.insertNode(i),f}find(i){let r=No.getSubnodeIndex(i,this._centrex,this._centrey);return r===-1?this:this._subnode[r]!==null?this._subnode[r].find(i):this}isSearchMatch(i){return i!==null&&this._env.intersects(i)}getSubnode(i){return this._subnode[i]===null&&(this._subnode[i]=this.createSubnode(i)),this._subnode[i]}getEnvelope(){return this._env}getNode(i){let r=No.getSubnodeIndex(i,this._centrex,this._centrey);return r!==-1?this.getSubnode(r).getNode(i):this}createSubnode(i){let r=0,c=0,f=0,g=0;switch(i){case 0:r=this._env.getMinX(),c=this._centrex,f=this._env.getMinY(),g=this._centrey;break;case 1:r=this._centrex,c=this._env.getMaxX(),f=this._env.getMinY(),g=this._centrey;break;case 2:r=this._env.getMinX(),c=this._centrex,f=this._centrey,g=this._env.getMaxY();break;case 3:r=this._centrex,c=this._env.getMaxX(),f=this._centrey,g=this._env.getMaxY()}let y=new K(r,c,f,g);return new Bh(y,this._level-1)}insertNode(i){d.isTrue(this._env===null||this._env.contains(i._env));let r=No.getSubnodeIndex(i._env,this._centrex,this._centrey);if(i._level===this._level-1)this._subnode[r]=i;else{let c=this.createSubnode(r);c.insertNode(i),this._subnode[r]=c}}};class Uu{static isZeroWidth(i,r){let c=r-i;if(c===0)return!0;let f=c/Math.max(Math.abs(i),Math.abs(r));return Bu.exponent(f)<=Uu.MIN_BINARY_EXPONENT}}Uu.MIN_BINARY_EXPONENT=-50;class zu extends No{constructor(){super()}insertContained(i,r,c){d.isTrue(i.getEnvelope().contains(r));let f=Uu.isZeroWidth(r.getMinX(),r.getMaxX()),g=Uu.isZeroWidth(r.getMinY(),r.getMaxY()),y=null;y=f||g?i.find(r):i.getNode(r),y.add(c)}isSearchMatch(i){return!0}insert(i,r){let c=No.getSubnodeIndex(i,zu.origin.x,zu.origin.y);if(c===-1)return this.add(r),null;let f=this._subnode[c];if(f===null||!f.getEnvelope().contains(i)){let g=SP.createExpanded(f,i);this._subnode[c]=g}this.insertContained(this._subnode[c],i,r)}}zu.origin=new w(0,0);class Dl{constructor(){Dl.constructor_.apply(this,arguments)}static constructor_(){this._root=null,this._minExtent=1,this._root=new zu}static ensureExtent(i,r){let c=i.getMinX(),f=i.getMaxX(),g=i.getMinY(),y=i.getMaxY();return c!==f&&g!==y?i:(c===f&&(c-=r/2,f+=r/2),g===y&&(g-=r/2,y+=r/2),new K(c,f,g,y))}size(){return this._root!==null?this._root.size():0}insert(i,r){this.collectStats(i);let c=Dl.ensureExtent(i,this._minExtent);this._root.insert(c,r)}query(){if(arguments.length===1){let i=arguments[0],r=new of;return this.query(i,r),r.getItems()}if(arguments.length===2){let i=arguments[0],r=arguments[1];this._root.visit(i,r)}}queryAll(){let i=new M;return this._root.addAllItems(i),i}remove(i,r){let c=Dl.ensureExtent(i,this._minExtent);return this._root.remove(c,r)}collectStats(i){let r=i.getWidth();r<this._minExtent&&r>0&&(this._minExtent=r);let c=i.getHeight();c<this._minExtent&&c>0&&(this._minExtent=c)}depth(){return this._root!==null?this._root.depth():0}isEmpty(){return this._root===null||this._root.isEmpty()}get interfaces_(){return[_S,u]}}var EP=Object.freeze({__proto__:null,Quadtree:Dl}),CP=Object.freeze({__proto__:null,STRtree:Kt}),IP=Object.freeze({__proto__:null,kdtree:wP,quadtree:EP,strtree:CP});let LP=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class IS{constructor(i){this.geometryFactory=i||new vt}read(i){let r;r=typeof i=="string"?JSON.parse(i):i;let c=r.type;if(!xs[c])throw new Error("Unknown GeoJSON type: "+r.type);return LP.indexOf(c)!==-1?xs[c].call(this,r.coordinates):c==="GeometryCollection"?xs[c].call(this,r.geometries):xs[c].call(this,r)}write(i){let r=i.getGeometryType();if(!ar[r])throw new Error("Geometry is not supported");return ar[r].call(this,i)}}let xs={Feature:function(A){let i={};for(let r in A)i[r]=A[r];if(A.geometry){let r=A.geometry.type;if(!xs[r])throw new Error("Unknown GeoJSON type: "+A.type);i.geometry=this.read(A.geometry)}return A.bbox&&(i.bbox=xs.bbox.call(this,A.bbox)),i},FeatureCollection:function(A){let i={};if(A.features){i.features=[];for(let r=0;r<A.features.length;++r)i.features.push(this.read(A.features[r]))}return A.bbox&&(i.bbox=this.parse.bbox.call(this,A.bbox)),i},coordinates:function(A){let i=[];for(let r=0;r<A.length;++r){let c=A[r];i.push(new w(...c))}return i},bbox:function(A){return this.geometryFactory.createLinearRing([new w(A[0],A[1]),new w(A[2],A[1]),new w(A[2],A[3]),new w(A[0],A[3]),new w(A[0],A[1])])},Point:function(A){let i=new w(...A);return this.geometryFactory.createPoint(i)},MultiPoint:function(A){let i=[];for(let r=0;r<A.length;++r)i.push(xs.Point.call(this,A[r]));return this.geometryFactory.createMultiPoint(i)},LineString:function(A){let i=xs.coordinates.call(this,A);return this.geometryFactory.createLineString(i)},MultiLineString:function(A){let i=[];for(let r=0;r<A.length;++r)i.push(xs.LineString.call(this,A[r]));return this.geometryFactory.createMultiLineString(i)},Polygon:function(A){let i=xs.coordinates.call(this,A[0]),r=this.geometryFactory.createLinearRing(i),c=[];for(let f=1;f<A.length;++f){let g=A[f],y=xs.coordinates.call(this,g),S=this.geometryFactory.createLinearRing(y);c.push(S)}return this.geometryFactory.createPolygon(r,c)},MultiPolygon:function(A){let i=[];for(let r=0;r<A.length;++r){let c=A[r];i.push(xs.Polygon.call(this,c))}return this.geometryFactory.createMultiPolygon(i)},GeometryCollection:function(A){let i=[];for(let r=0;r<A.length;++r){let c=A[r];i.push(this.read(c))}return this.geometryFactory.createGeometryCollection(i)}},ar={coordinate:function(A){let i=[A.x,A.y];return A.z&&i.push(A.z),A.m&&i.push(A.m),i},Point:function(A){return{type:"Point",coordinates:ar.coordinate.call(this,A.getCoordinate())}},MultiPoint:function(A){let i=[];for(let r=0;r<A._geometries.length;++r){let c=A._geometries[r],f=ar.Point.call(this,c);i.push(f.coordinates)}return{type:"MultiPoint",coordinates:i}},LineString:function(A){let i=[],r=A.getCoordinates();for(let c=0;c<r.length;++c){let f=r[c];i.push(ar.coordinate.call(this,f))}return{type:"LineString",coordinates:i}},MultiLineString:function(A){let i=[];for(let r=0;r<A._geometries.length;++r){let c=A._geometries[r],f=ar.LineString.call(this,c);i.push(f.coordinates)}return{type:"MultiLineString",coordinates:i}},Polygon:function(A){let i=[],r=ar.LineString.call(this,A._shell);i.push(r.coordinates);for(let c=0;c<A._holes.length;++c){let f=A._holes[c],g=ar.LineString.call(this,f);i.push(g.coordinates)}return{type:"Polygon",coordinates:i}},MultiPolygon:function(A){let i=[];for(let r=0;r<A._geometries.length;++r){let c=A._geometries[r],f=ar.Polygon.call(this,c);i.push(f.coordinates)}return{type:"MultiPolygon",coordinates:i}},GeometryCollection:function(A){let i=[];for(let r=0;r<A._geometries.length;++r){let c=A._geometries[r],f=c.getGeometryType();i.push(ar[f].call(this,c))}return{type:"GeometryCollection",geometries:i}}};function Vu(A){return[A.x,A.y]}var NP=Object.freeze({__proto__:null,GeoJSONReader:class{constructor(A){this.parser=new IS(A||new vt)}read(A){return this.parser.read(A)}},GeoJSONWriter:class{constructor(){this.parser=new IS(this.geometryFactory)}write(A){return this.parser.write(A)}},OL3Parser:class{constructor(A,i){this.geometryFactory=A||new vt,this.ol=i||typeof ol<"u"&&ol}inject(A,i,r,c,f,g,y,S){this.ol={geom:{Point:A,LineString:i,LinearRing:r,Polygon:c,MultiPoint:f,MultiLineString:g,MultiPolygon:y,GeometryCollection:S}}}read(A){let i=this.ol;return A instanceof i.geom.Point?this.convertFromPoint(A):A instanceof i.geom.LineString?this.convertFromLineString(A):A instanceof i.geom.LinearRing?this.convertFromLinearRing(A):A instanceof i.geom.Polygon?this.convertFromPolygon(A):A instanceof i.geom.MultiPoint?this.convertFromMultiPoint(A):A instanceof i.geom.MultiLineString?this.convertFromMultiLineString(A):A instanceof i.geom.MultiPolygon?this.convertFromMultiPolygon(A):A instanceof i.geom.GeometryCollection?this.convertFromCollection(A):void 0}convertFromPoint(A){let i=A.getCoordinates();return this.geometryFactory.createPoint(new w(i[0],i[1]))}convertFromLineString(A){return this.geometryFactory.createLineString(A.getCoordinates().map(function(i){return new w(i[0],i[1])}))}convertFromLinearRing(A){return this.geometryFactory.createLinearRing(A.getCoordinates().map(function(i){return new w(i[0],i[1])}))}convertFromPolygon(A){let i=A.getLinearRings(),r=null,c=[];for(let f=0;f<i.length;f++){let g=this.convertFromLinearRing(i[f]);f===0?r=g:c.push(g)}return this.geometryFactory.createPolygon(r,c)}convertFromMultiPoint(A){let i=A.getPoints().map(function(r){return this.convertFromPoint(r)},this);return this.geometryFactory.createMultiPoint(i)}convertFromMultiLineString(A){let i=A.getLineStrings().map(function(r){return this.convertFromLineString(r)},this);return this.geometryFactory.createMultiLineString(i)}convertFromMultiPolygon(A){let i=A.getPolygons().map(function(r){return this.convertFromPolygon(r)},this);return this.geometryFactory.createMultiPolygon(i)}convertFromCollection(A){let i=A.getGeometries().map(function(r){return this.read(r)},this);return this.geometryFactory.createGeometryCollection(i)}write(A){return A.getGeometryType()==="Point"?this.convertToPoint(A.getCoordinate()):A.getGeometryType()==="LineString"?this.convertToLineString(A):A.getGeometryType()==="LinearRing"?this.convertToLinearRing(A):A.getGeometryType()==="Polygon"?this.convertToPolygon(A):A.getGeometryType()==="MultiPoint"?this.convertToMultiPoint(A):A.getGeometryType()==="MultiLineString"?this.convertToMultiLineString(A):A.getGeometryType()==="MultiPolygon"?this.convertToMultiPolygon(A):A.getGeometryType()==="GeometryCollection"?this.convertToCollection(A):void 0}convertToPoint(A){return new this.ol.geom.Point([A.x,A.y])}convertToLineString(A){let i=A._points._coordinates.map(Vu);return new this.ol.geom.LineString(i)}convertToLinearRing(A){let i=A._points._coordinates.map(Vu);return new this.ol.geom.LinearRing(i)}convertToPolygon(A){let i=[A._shell._points._coordinates.map(Vu)];for(let r=0;r<A._holes.length;r++)i.push(A._holes[r]._points._coordinates.map(Vu));return new this.ol.geom.Polygon(i)}convertToMultiPoint(A){return new this.ol.geom.MultiPoint(A.getCoordinates().map(Vu))}convertToMultiLineString(A){let i=[];for(let r=0;r<A._geometries.length;r++)i.push(this.convertToLineString(A._geometries[r]).getCoordinates());return new this.ol.geom.MultiLineString(i)}convertToMultiPolygon(A){let i=[];for(let r=0;r<A._geometries.length;r++)i.push(this.convertToPolygon(A._geometries[r]).getCoordinates());return new this.ol.geom.MultiPolygon(i)}convertToCollection(A){let i=[];for(let r=0;r<A._geometries.length;r++){let c=A._geometries[r];i.push(this.write(c))}return new this.ol.geom.GeometryCollection(i)}},WKTReader:class{constructor(A){this.parser=new rf(A||new vt)}read(A){return this.parser.read(A)}},WKTWriter:rn}),TP=Object.freeze({__proto__:null,MCIndexNoder:Ca,ScaledNoder:Nu,SegmentString:Y_});class To{constructor(){To.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){let i=arguments[0];To.constructor_.call(this,i,Yn.MOD2_BOUNDARY_RULE)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=r}}static getBoundary(){if(arguments.length===1)return new To(arguments[0]).getBoundary();if(arguments.length===2)return new To(arguments[0],arguments[1]).getBoundary()}boundaryMultiLineString(i){if(this._geom.isEmpty())return this.getEmptyMultiPoint();let r=this.computeBoundaryCoordinates(i);return r.length===1?this._geomFact.createPoint(r[0]):this._geomFact.createMultiPointFromCoords(r)}getBoundary(){return this._geom instanceof Z?this.boundaryLineString(this._geom):this._geom instanceof _n?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}boundaryLineString(i){return this._geom.isEmpty()?this.getEmptyMultiPoint():i.isClosed()?this._bnRule.isInBoundary(2)?i.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([i.getStartPoint(),i.getEndPoint()])}getEmptyMultiPoint(){return this._geomFact.createMultiPoint()}computeBoundaryCoordinates(i){let r=new M;this._endpointMap=new bs;for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c);f.getNumPoints()!==0&&(this.addEndpoint(f.getCoordinateN(0)),this.addEndpoint(f.getCoordinateN(f.getNumPoints()-1)))}for(let c=this._endpointMap.entrySet().iterator();c.hasNext();){let f=c.next(),g=f.getValue().count;this._bnRule.isInBoundary(g)&&r.add(f.getKey())}return Be.toCoordinateArray(r)}addEndpoint(i){let r=this._endpointMap.get(i);r===null&&(r=new kP,this._endpointMap.put(i,r)),r.count++}}let kP=class u4{constructor(){u4.constructor_.apply(this,arguments)}static constructor_(){this.count=null}};class Ra{constructor(){Ra.constructor_.apply(this,arguments)}static constructor_(){if(this._inputGeom=null,this._isClosedEndpointsInInterior=!0,this._nonSimpleLocation=null,arguments.length===1){let i=arguments[0];this._inputGeom=i}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._inputGeom=i,this._isClosedEndpointsInInterior=!r.isInBoundary(2)}}static isSimple(){if(arguments.length===1)return new Ra(arguments[0]).isSimple();if(arguments.length===2)return new Ra(arguments[0],arguments[1]).isSimple()}isSimpleMultiPoint(i){if(i.isEmpty())return!0;let r=new Xe;for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c).getCoordinate();if(r.contains(f))return this._nonSimpleLocation=f,!1;r.add(f)}return!0}isSimplePolygonal(i){for(let r=Se.getLines(i).iterator();r.hasNext();){let c=r.next();if(!this.isSimpleLinearGeometry(c))return!1}return!0}hasClosedEndpointIntersection(i){let r=new bs;for(let c=i.getEdgeIterator();c.hasNext();){let f=c.next(),g=f.isClosed(),y=f.getCoordinate(0);this.addEndpoint(r,y,g);let S=f.getCoordinate(f.getNumPoints()-1);this.addEndpoint(r,S,g)}for(let c=r.values().iterator();c.hasNext();){let f=c.next();if(f.isClosed&&f.degree!==2)return this._nonSimpleLocation=f.getCoordinate(),!0}return!1}getNonSimpleLocation(){return this._nonSimpleLocation}isSimpleLinearGeometry(i){if(i.isEmpty())return!0;let r=new Mi(0,i),c=new wn,f=r.computeSelfNodes(c,!0);return!f.hasIntersection()||(f.hasProperIntersection()?(this._nonSimpleLocation=f.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(r)&&(!this._isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(r)))}hasNonEndpointIntersection(i){for(let r=i.getEdgeIterator();r.hasNext();){let c=r.next(),f=c.getMaximumSegmentIndex();for(let g=c.getEdgeIntersectionList().iterator();g.hasNext();){let y=g.next();if(!y.isEndPoint(f))return this._nonSimpleLocation=y.getCoordinate(),!0}}return!1}addEndpoint(i,r,c){let f=i.get(r);f===null&&(f=new Df(r),i.put(r,f)),f.addEndpoint(c)}computeSimple(i){return this._nonSimpleLocation=null,!!i.isEmpty()||(i instanceof Z||i instanceof _n?this.isSimpleLinearGeometry(i):i instanceof Li?this.isSimpleMultiPoint(i):P(i,Jn)?this.isSimplePolygonal(i):!(i instanceof tt)||this.isSimpleGeometryCollection(i))}isSimple(){return this._nonSimpleLocation=null,this.computeSimple(this._inputGeom)}isSimpleGeometryCollection(i){for(let r=0;r<i.getNumGeometries();r++){let c=i.getGeometryN(r);if(!this.computeSimple(c))return!1}return!0}}class Df{constructor(){Df.constructor_.apply(this,arguments)}static constructor_(){this.pt=null,this.isClosed=null,this.degree=null;let i=arguments[0];this.pt=i,this.isClosed=!1,this.degree=0}getCoordinate(){return this.pt}addEndpoint(i){this.degree++,this.isClosed|=i}}Ra.EndpointInfo=Df;var RP=Object.freeze({__proto__:null,BufferOp:Ht,BufferParameters:mt});class Sn{constructor(){Sn.constructor_.apply(this,arguments)}static constructor_(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){let i=arguments[0],r=arguments[1];Sn.constructor_.call(this,i,Sn.INSIDE_AREA,r)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._component=i,this._segIndex=r,this._pt=c}}getSegmentIndex(){return this._segIndex}getCoordinate(){return this._pt}isInsideArea(){return this._segIndex===Sn.INSIDE_AREA}toString(){return this._component.getGeometryType()+"["+this._segIndex+"]-"+rn.toPoint(this._pt)}getGeometryComponent(){return this._component}}Sn.INSIDE_AREA=-1;class Gf{constructor(){Gf.constructor_.apply(this,arguments)}static constructor_(){this._locations=null;let i=arguments[0];this._locations=i}static getLocations(i){let r=new M;return i.apply(new Gf(r)),r}filter(i){if(i.isEmpty())return null;(i instanceof yt||i instanceof Z||i instanceof Et)&&this._locations.add(new Sn(i,0,i.getCoordinate()))}get interfaces_(){return[O]}}class Mr{constructor(){Mr.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Co,this._minDistanceLocation=null,this._minDistance=l.MAX_VALUE,arguments.length===2){let i=arguments[0],r=arguments[1];Mr.constructor_.call(this,i,r,0)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=r,this._terminateDistance=c}}static distance(i,r){return new Mr(i,r).distance()}static isWithinDistance(i,r,c){return i.getEnvelopeInternal().distance(r.getEnvelopeInternal())>c?!1:new Mr(i,r,c).distance()<=c}static nearestPoints(i,r){return new Mr(i,r).nearestPoints()}computeContainmentDistance(){if(arguments.length===0){let i=new Array(2).fill(null);if(this.computeContainmentDistance(0,i),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=this._geom[i];if(c.getDimension()<2)return null;let f=1-i,g=Me.getPolygons(c);if(g.size()>0){let y=Gf.getLocations(this._geom[f]);if(this.computeContainmentDistance(y,g,r),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[f]=r[0],this._minDistanceLocation[i]=r[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&P(arguments[0],H)&&P(arguments[1],H)){let i=arguments[0],r=arguments[1],c=arguments[2];for(let f=0;f<i.size();f++){let g=i.get(f);for(let y=0;y<r.size();y++)if(this.computeContainmentDistance(g,r.get(y),c),this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Sn&&arguments[1]instanceof Et){let i=arguments[0],r=arguments[1],c=arguments[2],f=i.getCoordinate();if(B.EXTERIOR!==this._ptLocator.locate(f,r))return this._minDistance=0,c[0]=i,c[1]=new Sn(r,f),null}}}computeMinDistanceLinesPoints(i,r,c){for(let f=0;f<i.size();f++){let g=i.get(f);for(let y=0;y<r.size();y++){let S=r.get(y);if(this.computeMinDistance(g,S,c),this._minDistance<=this._terminateDistance)return null}}}computeFacetDistance(){let i=new Array(2).fill(null),r=Se.getLines(this._geom[0]),c=Se.getLines(this._geom[1]),f=ke.getPoints(this._geom[0]),g=ke.getPoints(this._geom[1]);return this.computeMinDistanceLines(r,c,i),this.updateMinDistance(i,!1),this._minDistance<=this._terminateDistance?null:(i[0]=null,i[1]=null,this.computeMinDistanceLinesPoints(r,g,i),this.updateMinDistance(i,!1),this._minDistance<=this._terminateDistance?null:(i[0]=null,i[1]=null,this.computeMinDistanceLinesPoints(c,f,i),this.updateMinDistance(i,!0),this._minDistance<=this._terminateDistance?null:(i[0]=null,i[1]=null,this.computeMinDistancePoints(f,g,i),void this.updateMinDistance(i,!1))))}nearestLocations(){return this.computeMinDistance(),this._minDistanceLocation}updateMinDistance(i,r){if(i[0]===null)return null;r?(this._minDistanceLocation[0]=i[1],this._minDistanceLocation[1]=i[0]):(this._minDistanceLocation[0]=i[0],this._minDistanceLocation[1]=i[1])}nearestPoints(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}computeMinDistance(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Z&&arguments[1]instanceof yt){let i=arguments[0],r=arguments[1],c=arguments[2];if(i.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;let f=i.getCoordinates(),g=r.getCoordinate();for(let y=0;y<f.length-1;y++){let S=qe.pointToSegment(g,f[y],f[y+1]);if(S<this._minDistance){this._minDistance=S;let I=new Ze(f[y],f[y+1]).closestPoint(g);c[0]=new Sn(i,y,I),c[1]=new Sn(r,0,g)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Z&&arguments[1]instanceof Z){let i=arguments[0],r=arguments[1],c=arguments[2];if(i.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;let f=i.getCoordinates(),g=r.getCoordinates();for(let y=0;y<f.length-1;y++){let S=new K(f[y],f[y+1]);if(!(S.distance(r.getEnvelopeInternal())>this._minDistance))for(let I=0;I<g.length-1;I++){let z=new K(g[I],g[I+1]);if(S.distance(z)>this._minDistance)continue;let ne=qe.segmentToSegment(f[y],f[y+1],g[I],g[I+1]);if(ne<this._minDistance){this._minDistance=ne;let he=new Ze(f[y],f[y+1]),Ie=new Ze(g[I],g[I+1]),Oe=he.closestPoints(Ie);c[0]=new Sn(i,y,Oe[0]),c[1]=new Sn(r,I,Oe[1])}if(this._minDistance<=this._terminateDistance)return null}}}}}computeMinDistancePoints(i,r,c){for(let f=0;f<i.size();f++){let g=i.get(f);for(let y=0;y<r.size();y++){let S=r.get(y),I=g.getCoordinate().distance(S.getCoordinate());if(I<this._minDistance&&(this._minDistance=I,c[0]=new Sn(g,0,g.getCoordinate()),c[1]=new Sn(S,0,S.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}}distance(){if(this._geom[0]===null||this._geom[1]===null)throw new s("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}computeMinDistanceLines(i,r,c){for(let f=0;f<i.size();f++){let g=i.get(f);for(let y=0;y<r.size();y++){let S=r.get(y);if(this.computeMinDistance(g,S,c),this._minDistance<=this._terminateDistance)return null}}}}var MP=Object.freeze({__proto__:null,DistanceOp:Mr});class by{constructor(){by.constructor_.apply(this,arguments)}static constructor_(){this._factory=null,this._directedEdges=new M,this._coordinates=null;let i=arguments[0];this._factory=i}add(i){this._directedEdges.add(i)}toLineString(){return this._factory.createLineString(this.getCoordinates())}getCoordinates(){if(this._coordinates===null){let i=0,r=0,c=new E;for(let f=this._directedEdges.iterator();f.hasNext();){let g=f.next();g.getEdgeDirection()?i++:r++,c.add(g.getEdge().getLine().getCoordinates(),!1,g.getEdgeDirection())}this._coordinates=c.toCoordinateArray(),r>i&&Be.reverse(this._coordinates)}return this._coordinates}}class Ar{constructor(){Ar.constructor_.apply(this,arguments)}static constructor_(){this._isMarked=!1,this._isVisited=!1,this._data=null}static setMarked(i,r){for(;i.hasNext();)i.next().setMarked(r)}static setVisited(i,r){for(;i.hasNext();)i.next().setVisited(r)}static getComponentWithVisitedState(i,r){for(;i.hasNext();){let c=i.next();if(c.isVisited()===r)return c}return null}setVisited(i){this._isVisited=i}isMarked(){return this._isMarked}setData(i){this._data=i}getData(){return this._data}setMarked(i){this._isMarked=i}getContext(){return this._data}isVisited(){return this._isVisited}setContext(i){this._data=i}}class ws extends Ar{constructor(){super(),ws.constructor_.apply(this,arguments)}static constructor_(){if(this._parentEdge=null,this._from=null,this._to=null,this._p0=null,this._p1=null,this._sym=null,this._edgeDirection=null,this._quadrant=null,this._angle=null,arguments.length!==0){if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this._from=i,this._to=r,this._edgeDirection=f,this._p0=i.getCoordinate(),this._p1=c;let g=this._p1.x-this._p0.x,y=this._p1.y-this._p0.y;this._quadrant=kt.quadrant(g,y),this._angle=Math.atan2(y,g)}}}static toEdges(i){let r=new M;for(let c=i.iterator();c.hasNext();)r.add(c.next()._parentEdge);return r}isRemoved(){return this._parentEdge===null}compareDirection(i){return this._quadrant>i._quadrant?1:this._quadrant<i._quadrant?-1:pe.index(i._p0,i._p1,this._p1)}getCoordinate(){return this._from.getCoordinate()}print(i){let r=this.getClass().getName(),c=r.lastIndexOf("."),f=r.substring(c+1);i.print("  "+f+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+this._angle)}getDirectionPt(){return this._p1}getAngle(){return this._angle}getSym(){return this._sym}getEdge(){return this._parentEdge}getToNode(){return this._to}getEdgeDirection(){return this._edgeDirection}compareTo(i){let r=i;return this.compareDirection(r)}getFromNode(){return this._from}setEdge(i){this._parentEdge=i}remove(){this._sym=null,this._parentEdge=null}getQuadrant(){return this._quadrant}setSym(i){this._sym=i}get interfaces_(){return[a]}}class jf extends ws{constructor(){super(),jf.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];ws.constructor_.call(this,i,r,c,f)}getNext(){return this.getToNode().getDegree()!==2?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(d.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))}}class ko extends Ar{constructor(){super(),ko.constructor_.apply(this,arguments)}static constructor_(){if(this._dirEdge=null,arguments.length!==0){if(arguments.length===2){let i=arguments[0],r=arguments[1];this.setDirectedEdges(i,r)}}}isRemoved(){return this._dirEdge===null}setDirectedEdges(i,r){this._dirEdge=[i,r],i.setEdge(this),r.setEdge(this),i.setSym(r),r.setSym(i),i.getFromNode().addOutEdge(i),r.getFromNode().addOutEdge(r)}getDirEdge(){if(Number.isInteger(arguments[0])){let i=arguments[0];return this._dirEdge[i]}if(arguments[0]instanceof Ro){let i=arguments[0];return this._dirEdge[0].getFromNode()===i?this._dirEdge[0]:this._dirEdge[1].getFromNode()===i?this._dirEdge[1]:null}}remove(){this._dirEdge=null}getOppositeNode(i){return this._dirEdge[0].getFromNode()===i?this._dirEdge[0].getToNode():this._dirEdge[1].getFromNode()===i?this._dirEdge[1].getToNode():null}}class xy{constructor(){xy.constructor_.apply(this,arguments)}static constructor_(){this._outEdges=new M,this._sorted=!1}getNextEdge(i){let r=this.getIndex(i);return this._outEdges.get(this.getIndex(r+1))}getCoordinate(){let i=this.iterator();return i.hasNext()?i.next().getCoordinate():null}iterator(){return this.sortEdges(),this._outEdges.iterator()}sortEdges(){this._sorted||(Le.sort(this._outEdges),this._sorted=!0)}remove(i){this._outEdges.remove(i)}getEdges(){return this.sortEdges(),this._outEdges}getNextCWEdge(i){let r=this.getIndex(i);return this._outEdges.get(this.getIndex(r-1))}getIndex(){if(arguments[0]instanceof ko){let i=arguments[0];this.sortEdges();for(let r=0;r<this._outEdges.size();r++)if(this._outEdges.get(r).getEdge()===i)return r;return-1}if(arguments[0]instanceof ws){let i=arguments[0];this.sortEdges();for(let r=0;r<this._outEdges.size();r++)if(this._outEdges.get(r)===i)return r;return-1}if(Number.isInteger(arguments[0])){let i=arguments[0]%this._outEdges.size();return i<0&&(i+=this._outEdges.size()),i}}add(i){this._outEdges.add(i),this._sorted=!1}getDegree(){return this._outEdges.size()}}class Ro extends Ar{constructor(){super(),Ro.constructor_.apply(this,arguments)}static constructor_(){if(this._pt=null,this._deStar=null,arguments.length===1){let i=arguments[0];Ro.constructor_.call(this,i,new xy)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._pt=i,this._deStar=r}}static getEdgesBetween(i,r){let c=ws.toEdges(i.getOutEdges().getEdges()),f=new xn(c),g=ws.toEdges(r.getOutEdges().getEdges());return f.retainAll(g),f}isRemoved(){return this._pt===null}addOutEdge(i){this._deStar.add(i)}getCoordinate(){return this._pt}getOutEdges(){return this._deStar}remove(){if(arguments.length===0)this._pt=null;else if(arguments.length===1){let i=arguments[0];this._deStar.remove(i)}}getIndex(i){return this._deStar.getIndex(i)}getDegree(){return this._deStar.getDegree()}}class wy extends ko{constructor(){super(),wy.constructor_.apply(this,arguments)}static constructor_(){this._line=null;let i=arguments[0];this._line=i}getLine(){return this._line}}class qf{constructor(){qf.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new bs}find(i){return this._nodeMap.get(i)}iterator(){return this._nodeMap.values().iterator()}remove(i){return this._nodeMap.remove(i)}values(){return this._nodeMap.values()}add(i){return this._nodeMap.put(i.getCoordinate(),i),i}}class $f{constructor(){$f.constructor_.apply(this,arguments)}static constructor_(){this._edges=new xn,this._dirEdges=new xn,this._nodeMap=new qf}findNodesOfDegree(i){let r=new M;for(let c=this.nodeIterator();c.hasNext();){let f=c.next();f.getDegree()===i&&r.add(f)}return r}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}getEdges(){return this._edges}nodeIterator(){return this._nodeMap.iterator()}contains(){if(arguments[0]instanceof ko){let i=arguments[0];return this._edges.contains(i)}if(arguments[0]instanceof ws){let i=arguments[0];return this._dirEdges.contains(i)}}add(){if(arguments[0]instanceof Ro){let i=arguments[0];this._nodeMap.add(i)}else if(arguments[0]instanceof ko){let i=arguments[0];this._edges.add(i),this.add(i.getDirEdge(0)),this.add(i.getDirEdge(1))}else if(arguments[0]instanceof ws){let i=arguments[0];this._dirEdges.add(i)}}getNodes(){return this._nodeMap.values()}remove(){if(arguments[0]instanceof ko){let i=arguments[0];this.remove(i.getDirEdge(0)),this.remove(i.getDirEdge(1)),this._edges.remove(i),i.remove()}else if(arguments[0]instanceof ws){let i=arguments[0],r=i.getSym();r!==null&&r.setSym(null),i.getFromNode().remove(i),i.remove(),this._dirEdges.remove(i)}else if(arguments[0]instanceof Ro){let i=arguments[0];for(let r=i.getOutEdges().getEdges().iterator();r.hasNext();){let c=r.next(),f=c.getSym();f!==null&&this.remove(f),this._dirEdges.remove(c);let g=c.getEdge();g!==null&&this._edges.remove(g)}this._nodeMap.remove(i.getCoordinate()),i.remove()}}findNode(i){return this._nodeMap.find(i)}}class LS extends $f{constructor(){super()}getNode(i){let r=this.findNode(i);return r===null&&(r=new Ro(i),this.add(r)),r}addEdge(i){if(i.isEmpty())return null;let r=Be.removeRepeatedPoints(i.getCoordinates());if(r.length<=1)return null;let c=r[0],f=r[r.length-1],g=this.getNode(c),y=this.getNode(f),S=new jf(g,y,r[1],!0),I=new jf(y,g,r[r.length-2],!1),z=new wy(i);z.setDirectedEdges(S,I),this.add(z)}}class Sy{constructor(){Sy.constructor_.apply(this,arguments)}static constructor_(){this._graph=new LS,this._mergedLineStrings=null,this._factory=null,this._edgeStrings=null}buildEdgeStringsForUnprocessedNodes(){for(let i=this._graph.getNodes().iterator();i.hasNext();){let r=i.next();r.isMarked()||(d.isTrue(r.getDegree()===2),this.buildEdgeStringsStartingAt(r),r.setMarked(!0))}}buildEdgeStringsForNonDegree2Nodes(){for(let i=this._graph.getNodes().iterator();i.hasNext();){let r=i.next();r.getDegree()!==2&&(this.buildEdgeStringsStartingAt(r),r.setMarked(!0))}}buildEdgeStringsStartingAt(i){for(let r=i.getOutEdges().iterator();r.hasNext();){let c=r.next();c.getEdge().isMarked()||this._edgeStrings.add(this.buildEdgeStringStartingWith(c))}}merge(){if(this._mergedLineStrings!==null)return null;Ar.setMarked(this._graph.nodeIterator(),!1),Ar.setMarked(this._graph.edgeIterator(),!1),this._edgeStrings=new M,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this._mergedLineStrings=new M;for(let i=this._edgeStrings.iterator();i.hasNext();){let r=i.next();this._mergedLineStrings.add(r.toLineString())}}addLineString(i){this._factory===null&&(this._factory=i.getFactory()),this._graph.addEdge(i)}buildEdgeStringStartingWith(i){let r=new by(this._factory),c=i;do r.add(c),c.getEdge().setMarked(!0),c=c.getNext();while(c!==null&&c!==i);return r}add(){if(arguments[0]instanceof Q){let i=arguments[0];for(let r=0;r<i.getNumGeometries();r++){let c=i.getGeometryN(r);c instanceof Z&&this.addLineString(c)}}else if(P(arguments[0],j)){let i=arguments[0];this._mergedLineStrings=null;for(let r=i.iterator();r.hasNext();){let c=r.next();this.add(c)}}}buildEdgeStringsForIsolatedLoops(){this.buildEdgeStringsForUnprocessedNodes()}buildEdgeStringsForObviousStartNodes(){this.buildEdgeStringsForNonDegree2Nodes()}getMergedLineStrings(){return this.merge(),this._mergedLineStrings}}class Ey{constructor(){Ey.constructor_.apply(this,arguments)}static constructor_(){this._parentGraph=null,this._edges=new xn,this._dirEdges=new M,this._nodeMap=new qf;let i=arguments[0];this._parentGraph=i}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}getParent(){return this._parentGraph}nodeIterator(){return this._nodeMap.iterator()}contains(i){return this._edges.contains(i)}add(i){if(this._edges.contains(i))return null;this._edges.add(i),this._dirEdges.add(i.getDirEdge(0)),this._dirEdges.add(i.getDirEdge(1)),this._nodeMap.add(i.getDirEdge(0).getFromNode()),this._nodeMap.add(i.getDirEdge(1).getFromNode())}}class Cy{constructor(){Cy.constructor_.apply(this,arguments)}static constructor_(){this._graph=null;let i=arguments[0];this._graph=i}findSubgraph(i){let r=new Ey(this._graph);return this.addReachable(i,r),r}addEdges(i,r,c){i.setVisited(!0);for(let f=i.getOutEdges().iterator();f.hasNext();){let g=f.next();c.add(g.getEdge());let y=g.getToNode();y.isVisited()||r.push(y)}}addReachable(i,r){let c=new Ia;for(c.add(i);!c.empty();){let f=c.pop();this.addEdges(f,c,r)}}getConnectedSubgraphs(){let i=new M;Ar.setVisited(this._graph.nodeIterator(),!1);for(let r=this._graph.edgeIterator();r.hasNext();){let c=r.next().getDirEdge(0).getFromNode();c.isVisited()||i.add(this.findSubgraph(c))}return i}}class Mo{constructor(){Mo.constructor_.apply(this,arguments)}static constructor_(){this._graph=new LS,this._factory=new vt,this._lineCount=0,this._isRun=!1,this._sequencedGeometry=null,this._isSequenceable=!1}static findUnvisitedBestOrientedDE(i){let r=null,c=null;for(let f=i.getOutEdges().iterator();f.hasNext();){let g=f.next();g.getEdge().isVisited()||(c=g,g.getEdgeDirection()&&(r=g))}return r!==null?r:c}static findLowestDegreeNode(i){let r=Ge.MAX_VALUE,c=null;for(let f=i.nodeIterator();f.hasNext();){let g=f.next();(c===null||g.getDegree()<r)&&(r=g.getDegree(),c=g)}return c}static isSequenced(i){if(!(i instanceof _n))return!0;let r=i,c=new Xe,f=null,g=new M;for(let y=0;y<r.getNumGeometries();y++){let S=r.getGeometryN(y),I=S.getCoordinateN(0),z=S.getCoordinateN(S.getNumPoints()-1);if(c.contains(I)||c.contains(z))return!1;f!==null&&(I.equals(f)||(c.addAll(g),g.clear())),g.add(I),g.add(z),f=z}return!0}static reverse(i){let r=i.getCoordinates(),c=new Array(r.length).fill(null),f=r.length;for(let g=0;g<f;g++)c[f-1-g]=new w(r[g]);return i.getFactory().createLineString(c)}static sequence(i){let r=new Mo;return r.add(i),r.getSequencedLineStrings()}computeSequence(){if(this._isRun)return null;this._isRun=!0;let i=this.findSequences();if(i===null)return null;this._sequencedGeometry=this.buildSequencedGeometry(i),this._isSequenceable=!0;let r=this._sequencedGeometry.getNumGeometries();d.isTrue(this._lineCount===r,"Lines were missing from result"),d.isTrue(this._sequencedGeometry instanceof Z||this._sequencedGeometry instanceof _n,"Result is not lineal")}findSequences(){let i=new M;for(let r=new Cy(this._graph).getConnectedSubgraphs().iterator();r.hasNext();){let c=r.next();if(!this.hasSequence(c))return null;{let f=this.findSequence(c);i.add(f)}}return i}addReverseSubpath(i,r,c){let f=i.getToNode(),g=null;for(;;){r.add(i.getSym()),i.getEdge().setVisited(!0),g=i.getFromNode();let y=Mo.findUnvisitedBestOrientedDE(g);if(y===null)break;i=y.getSym()}c&&d.isTrue(g===f,"path not contiguous")}findSequence(i){Ar.setVisited(i.edgeIterator(),!1);let r=Mo.findLowestDegreeNode(i).getOutEdges().iterator().next().getSym(),c=new ny,f=c.listIterator();for(this.addReverseSubpath(r,f,!1);f.hasPrevious();){let g=f.previous(),y=Mo.findUnvisitedBestOrientedDE(g.getFromNode());y!==null&&this.addReverseSubpath(y.getSym(),f,!0)}return this.orient(c)}reverse(i){let r=new ny;for(let c=i.iterator();c.hasNext();){let f=c.next();r.addFirst(f.getSym())}return r}add(){if(P(arguments[0],j))for(let i=arguments[0].iterator();i.hasNext();){let r=i.next();this.add(r)}else arguments[0]instanceof Q&&arguments[0].apply(new class{get interfaces_(){return[Pe]}filter(i){i instanceof Z&&this.addLine(i)}})}addLine(i){this._factory===null&&(this._factory=i.getFactory()),this._graph.addEdge(i),this._lineCount++}hasSequence(i){let r=0;for(let c=i.nodeIterator();c.hasNext();)c.next().getDegree()%2==1&&r++;return r<=2}orient(i){let r=i.get(0),c=i.get(i.size()-1),f=r.getFromNode(),g=c.getToNode(),y=!1;if(f.getDegree()===1||g.getDegree()===1){let S=!1;c.getToNode().getDegree()===1&&c.getEdgeDirection()===!1&&(S=!0,y=!0),r.getFromNode().getDegree()===1&&r.getEdgeDirection()===!0&&(S=!0,y=!1),S||r.getFromNode().getDegree()===1&&(y=!0)}return y?this.reverse(i):i}buildSequencedGeometry(i){let r=new M;for(let c=i.iterator();c.hasNext();)for(let f=c.next().iterator();f.hasNext();){let g=f.next(),y=g.getEdge().getLine(),S=y;g.getEdgeDirection()||y.isClosed()||(S=Mo.reverse(y)),r.add(S)}return r.size()===0?this._factory.createMultiLineString(new Array(0).fill(null)):this._factory.buildGeometry(r)}getSequencedLineStrings(){return this.computeSequence(),this._sequencedGeometry}isSequenceable(){return this.computeSequence(),this._isSequenceable}}var AP=Object.freeze({__proto__:null,LineMerger:Sy,LineSequencer:Mo}),OP=Object.freeze({__proto__:null,GeometrySnapper:Ri,LineStringSnapper:Ol}),PP=Object.freeze({__proto__:null,OverlayOp:We,snap:OP});class Bf{constructor(){Bf.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=new vt,this._geomGraph=null,this._disconnectedRingcoord=null;let i=arguments[0];this._geomGraph=i}static findDifferentPoint(i,r){for(let c=0;c<i.length;c++)if(!i[c].equals(r))return i[c];return null}visitInteriorRing(i,r){if(i.isEmpty())return null;let c=i.getCoordinates(),f=c[0],g=Bf.findDifferentPoint(c,f),y=r.findEdgeInSameDirection(f,g),S=r.findEdgeEnd(y),I=null;S.getLabel().getLocation(0,Ce.RIGHT)===B.INTERIOR?I=S:S.getSym().getLabel().getLocation(0,Ce.RIGHT)===B.INTERIOR&&(I=S.getSym()),d.isTrue(I!==null,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(I)}visitShellInteriors(i,r){if(i instanceof Et){let c=i;this.visitInteriorRing(c.getExteriorRing(),r)}if(i instanceof at){let c=i;for(let f=0;f<c.getNumGeometries();f++){let g=c.getGeometryN(f);this.visitInteriorRing(g.getExteriorRing(),r)}}}getCoordinate(){return this._disconnectedRingcoord}setInteriorEdgesInResult(i){for(let r=i.getEdgeEnds().iterator();r.hasNext();){let c=r.next();c.getLabel().getLocation(0,Ce.RIGHT)===B.INTERIOR&&c.setInResult(!0)}}visitLinkedDirectedEdges(i){let r=i,c=i;do d.isTrue(c!==null,"found null Directed Edge"),c.setVisited(!0),c=c.getNext();while(c!==r)}buildEdgeRings(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next();if(f.isInResult()&&f.getEdgeRing()===null){let g=new xf(f,this._geometryFactory);g.linkDirectedEdgesForMinimalEdgeRings();let y=g.buildMinimalRings();r.addAll(y)}}return r}hasUnvisitedShellEdge(i){for(let r=0;r<i.size();r++){let c=i.get(r);if(c.isHole())continue;let f=c.getEdges(),g=f.get(0);if(g.getLabel().getLocation(0,Ce.RIGHT)===B.INTERIOR){for(let y=0;y<f.size();y++)if(g=f.get(y),!g.isVisited())return this._disconnectedRingcoord=g.getCoordinate(),!0}}return!1}isInteriorsConnected(){let i=new M;this._geomGraph.computeSplitEdges(i);let r=new Ru(new ly);r.addEdges(i),this.setInteriorEdgesInResult(r),r.linkResultDirectedEdges();let c=this.buildEdgeRings(r.getEdgeEnds());return this.visitShellInteriors(this._geomGraph.getGeometry(),r),!this.hasUnvisitedShellEdge(c)}}class NS{computeEdgeEnds(){if(arguments.length===1){let i=arguments[0],r=new M;for(let c=i;c.hasNext();){let f=c.next();this.computeEdgeEnds(f,r)}return r}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=i.getEdgeIntersectionList();c.addEndpoints();let f=c.iterator(),g=null,y=null;if(!f.hasNext())return null;let S=f.next();do g=y,y=S,S=null,f.hasNext()&&(S=f.next()),y!==null&&(this.createEdgeEndForPrev(i,r,y,g),this.createEdgeEndForNext(i,r,y,S));while(y!==null)}}createEdgeEndForNext(i,r,c,f){let g=c.segmentIndex+1;if(g>=i.getNumPoints()&&f===null)return null;let y=i.getCoordinate(g);f!==null&&f.segmentIndex===c.segmentIndex&&(y=f.coord);let S=new sr(i,c.coord,y,new Jt(i.getLabel()));r.add(S)}createEdgeEndForPrev(i,r,c,f){let g=c.segmentIndex;if(c.dist===0){if(g===0)return null;g--}let y=i.getCoordinate(g);f!==null&&f.segmentIndex>=g&&(y=f.coord);let S=new Jt(i.getLabel());S.flip();let I=new sr(i,c.coord,y,S);r.add(I)}}class Uf extends sr{constructor(){super(),Uf.constructor_.apply(this,arguments)}static constructor_(){if(this._edgeEnds=new M,arguments.length===1){let i=arguments[0];Uf.constructor_.call(this,null,i)}else if(arguments.length===2){let i=arguments[1];sr.constructor_.call(this,i.getEdge(),i.getCoordinate(),i.getDirectedCoordinate(),new Jt(i.getLabel())),this.insert(i)}}insert(i){this._edgeEnds.add(i)}print(i){i.println("EdgeEndBundle--> Label: "+this._label);for(let r=this.iterator();r.hasNext();)r.next().print(i),i.println()}iterator(){return this._edgeEnds.iterator()}getEdgeEnds(){return this._edgeEnds}computeLabelOn(i,r){let c=0,f=!1;for(let y=this.iterator();y.hasNext();){let S=y.next().getLabel().getLocation(i);S===B.BOUNDARY&&c++,S===B.INTERIOR&&(f=!0)}let g=B.NONE;f&&(g=B.INTERIOR),c>0&&(g=Mi.determineBoundary(r,c)),this._label.setLocation(i,g)}computeLabelSide(i,r){for(let c=this.iterator();c.hasNext();){let f=c.next();if(f.getLabel().isArea()){let g=f.getLabel().getLocation(i,r);if(g===B.INTERIOR)return this._label.setLocation(i,r,B.INTERIOR),null;g===B.EXTERIOR&&this._label.setLocation(i,r,B.EXTERIOR)}}}getLabel(){return this._label}computeLabelSides(i){this.computeLabelSide(i,Ce.LEFT),this.computeLabelSide(i,Ce.RIGHT)}updateIM(i){Au.updateIM(this._label,i)}computeLabel(i){let r=!1;for(let c=this.iterator();c.hasNext();)c.next().getLabel().isArea()&&(r=!0);this._label=r?new Jt(B.NONE,B.NONE,B.NONE):new Jt(B.NONE);for(let c=0;c<2;c++)this.computeLabelOn(c,i),r&&this.computeLabelSides(c)}}class FP extends Ef{constructor(){super()}updateIM(i){for(let r=this.iterator();r.hasNext();)r.next().updateIM(i)}insert(i){let r=this._edgeMap.get(i);r===null?(r=new Uf(i),this.insertEdgeEnd(i,r)):r.insert(i)}}class Iy extends Rl{constructor(){super(),Iy.constructor_.apply(this,arguments)}static constructor_(){let i=arguments[0],r=arguments[1];Rl.constructor_.call(this,i,r)}computeIM(i){i.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}updateIMFromEdges(i){this._edges.updateIM(i)}}class TS extends sy{constructor(){super()}createNode(i){return new Iy(i,new FP)}}class Ly{constructor(){Ly.constructor_.apply(this,arguments)}static constructor_(){this._nodes=new vf(new TS)}insertEdgeEnds(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this._nodes.add(c)}}getNodeIterator(){return this._nodes.iterator()}copyNodesAndLabels(i,r){for(let c=i.getNodeIterator();c.hasNext();){let f=c.next();this._nodes.addNode(f.getCoordinate()).setLabel(r,f.getLabel().getLocation(r))}}build(i){this.computeIntersectionNodes(i,0),this.copyNodesAndLabels(i,0);let r=new NS().computeEdgeEnds(i.getEdgeIterator());this.insertEdgeEnds(r)}computeIntersectionNodes(i,r){for(let c=i.getEdgeIterator();c.hasNext();){let f=c.next(),g=f.getLabel().getLocation(r);for(let y=f.getEdgeIntersectionList().iterator();y.hasNext();){let S=y.next(),I=this._nodes.addNode(S.coord);g===B.BOUNDARY?I.setLabelBoundary(r):I.getLabel().isNull(r)&&I.setLabel(r,B.INTERIOR)}}}}class zf{constructor(){zf.constructor_.apply(this,arguments)}static constructor_(){this._li=new wn,this._geomGraph=null,this._nodeGraph=new Ly,this._invalidPoint=null;let i=arguments[0];this._geomGraph=i}isNodeEdgeAreaLabelsConsistent(){for(let i=this._nodeGraph.getNodeIterator();i.hasNext();){let r=i.next();if(!r.getEdges().isAreaLabelsConsistent(this._geomGraph))return this._invalidPoint=r.getCoordinate().copy(),!1}return!0}hasDuplicateRings(){for(let i=this._nodeGraph.getNodeIterator();i.hasNext();)for(let r=i.next().getEdges().iterator();r.hasNext();){let c=r.next();if(c.getEdgeEnds().size()>1)return this._invalidPoint=c.getEdge().getCoordinate(0),!0}return!1}isNodeConsistentArea(){let i=this._geomGraph.computeSelfNodes(this._li,!0,!0);return i.hasProperIntersection()?(this._invalidPoint=i.getProperIntersectionPoint(),!1):(this._nodeGraph.build(this._geomGraph),this.isNodeEdgeAreaLabelsConsistent())}getInvalidPoint(){return this._invalidPoint}}class Ny{constructor(){Ny.constructor_.apply(this,arguments)}static constructor_(){this._graph=null,this._rings=new M,this._totalEnv=new K,this._index=null,this._nestedPt=null;let i=arguments[0];this._graph=i}add(i){this._rings.add(i),this._totalEnv.expandToInclude(i.getEnvelopeInternal())}getNestedPoint(){return this._nestedPt}buildIndex(){this._index=new Kt;for(let i=0;i<this._rings.size();i++){let r=this._rings.get(i),c=r.getEnvelopeInternal();this._index.insert(c,r)}}isNonNested(){this.buildIndex();for(let i=0;i<this._rings.size();i++){let r=this._rings.get(i),c=r.getCoordinates(),f=this._index.query(r.getEnvelopeInternal());for(let g=0;g<f.size();g++){let y=f.get(g),S=y.getCoordinates();if(r===y||!r.getEnvelopeInternal().intersects(y.getEnvelopeInternal()))continue;let I=rs.findPtNotNode(c,y,this._graph);if(I!==null&&Ji.isInRing(I,S))return this._nestedPt=I,!1}}return!0}}class dt{constructor(){dt.constructor_.apply(this,arguments)}static constructor_(){if(this._errorType=null,this._pt=null,arguments.length===1){let i=arguments[0];dt.constructor_.call(this,i,null)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._errorType=i,r!==null&&(this._pt=r.copy())}}getCoordinate(){return this._pt}getMessage(){return dt.errMsg[this._errorType]}toString(){let i="";return this._pt!==null&&(i=" at or near point "+this._pt),this.getMessage()+i}getErrorType(){return this._errorType}}dt.ERROR=0,dt.REPEATED_POINT=1,dt.HOLE_OUTSIDE_SHELL=2,dt.NESTED_HOLES=3,dt.DISCONNECTED_INTERIOR=4,dt.SELF_INTERSECTION=5,dt.RING_SELF_INTERSECTION=6,dt.NESTED_SHELLS=7,dt.DUPLICATE_RINGS=8,dt.TOO_FEW_POINTS=9,dt.INVALID_COORDINATE=10,dt.RING_NOT_CLOSED=11,dt.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"];class rs{constructor(){rs.constructor_.apply(this,arguments)}static constructor_(){this._parentGeometry=null,this._isSelfTouchingRingFormingHoleValid=!1,this._validErr=null;let i=arguments[0];this._parentGeometry=i}static findPtNotNode(i,r,c){let f=c.findEdge(r).getEdgeIntersectionList();for(let g=0;g<i.length;g++){let y=i[g];if(!f.isIntersection(y))return y}return null}static isValid(){if(arguments[0]instanceof Q)return new rs(arguments[0]).isValid();if(arguments[0]instanceof w){let i=arguments[0];return!l.isNaN(i.x)&&!l.isInfinite(i.x)&&!l.isNaN(i.y)&&!l.isInfinite(i.y)}}checkInvalidCoordinates(){if(arguments[0]instanceof Array){let i=arguments[0];for(let r=0;r<i.length;r++)if(!rs.isValid(i[r]))return this._validErr=new dt(dt.INVALID_COORDINATE,i[r]),null}else if(arguments[0]instanceof Et){let i=arguments[0];if(this.checkInvalidCoordinates(i.getExteriorRing().getCoordinates()),this._validErr!==null)return null;for(let r=0;r<i.getNumInteriorRing();r++)if(this.checkInvalidCoordinates(i.getInteriorRingN(r).getCoordinates()),this._validErr!==null)return null}}checkHolesNotNested(i,r){if(i.getNumInteriorRing()<=0)return null;let c=new Ny(r);for(let f=0;f<i.getNumInteriorRing();f++){let g=i.getInteriorRingN(f);g.isEmpty()||c.add(g)}c.isNonNested()||(this._validErr=new dt(dt.NESTED_HOLES,c.getNestedPoint()))}checkConsistentArea(i){let r=new zf(i);if(!r.isNodeConsistentArea())return this._validErr=new dt(dt.SELF_INTERSECTION,r.getInvalidPoint()),null;r.hasDuplicateRings()&&(this._validErr=new dt(dt.DUPLICATE_RINGS,r.getInvalidPoint()))}isValid(){return this.checkValid(this._parentGeometry),this._validErr===null}checkShellInsideHole(i,r,c){let f=i.getCoordinates(),g=r.getCoordinates(),y=rs.findPtNotNode(f,r,c);if(y!==null&&!Ji.isInRing(y,g))return y;let S=rs.findPtNotNode(g,i,c);return S!==null?Ji.isInRing(S,f)?S:null:(d.shouldNeverReachHere("points in shell and hole appear to be equal"),null)}checkNoSelfIntersectingRings(i){for(let r=i.getEdgeIterator();r.hasNext();){let c=r.next();if(this.checkNoSelfIntersectingRing(c.getEdgeIntersectionList()),this._validErr!==null)return null}}checkHolesInShell(i,r){if(i.getNumInteriorRing()<=0)return null;let c=i.getExteriorRing(),f=c.isEmpty(),g=new So(c);for(let y=0;y<i.getNumInteriorRing();y++){let S=i.getInteriorRingN(y),I=null;if(!S.isEmpty()){if(I=rs.findPtNotNode(S.getCoordinates(),c,r),I===null)return null;if(f||B.EXTERIOR===g.locate(I))return this._validErr=new dt(dt.HOLE_OUTSIDE_SHELL,I),null}}}checkShellNotNested(i,r,c){let f=i.getCoordinates(),g=r.getExteriorRing();if(g.isEmpty())return null;let y=g.getCoordinates(),S=rs.findPtNotNode(f,g,c);if(S===null||!Ji.isInRing(S,y))return null;if(r.getNumInteriorRing()<=0)return this._validErr=new dt(dt.NESTED_SHELLS,S),null;let I=null;for(let z=0;z<r.getNumInteriorRing();z++){let ne=r.getInteriorRingN(z);if(I=this.checkShellInsideHole(i,ne,c),I===null)return null}this._validErr=new dt(dt.NESTED_SHELLS,I)}checkClosedRings(i){if(this.checkClosedRing(i.getExteriorRing()),this._validErr!==null)return null;for(let r=0;r<i.getNumInteriorRing();r++)if(this.checkClosedRing(i.getInteriorRingN(r)),this._validErr!==null)return null}checkConnectedInteriors(i){let r=new Bf(i);r.isInteriorsConnected()||(this._validErr=new dt(dt.DISCONNECTED_INTERIOR,r.getCoordinate()))}checkNoSelfIntersectingRing(i){let r=new Xe,c=!0;for(let f=i.iterator();f.hasNext();){let g=f.next();if(c)c=!1;else{if(r.contains(g.coord))return this._validErr=new dt(dt.RING_SELF_INTERSECTION,g.coord),null;r.add(g.coord)}}}checkTooFewPoints(i){if(i.hasTooFewPoints())return this._validErr=new dt(dt.TOO_FEW_POINTS,i.getInvalidPoint()),null}getValidationError(){return this.checkValid(this._parentGeometry),this._validErr}checkValid(){if(arguments[0]instanceof yt){let i=arguments[0];this.checkInvalidCoordinates(i.getCoordinates())}else if(arguments[0]instanceof Li){let i=arguments[0];this.checkInvalidCoordinates(i.getCoordinates())}else if(arguments[0]instanceof ae){let i=arguments[0];if(this.checkInvalidCoordinates(i.getCoordinates()),this._validErr!==null||(this.checkClosedRing(i),this._validErr!==null))return null;let r=new Mi(0,i);if(this.checkTooFewPoints(r),this._validErr!==null)return null;let c=new wn;r.computeSelfNodes(c,!0,!0),this.checkNoSelfIntersectingRings(r)}else if(arguments[0]instanceof Z){let i=arguments[0];if(this.checkInvalidCoordinates(i.getCoordinates()),this._validErr!==null)return null;let r=new Mi(0,i);this.checkTooFewPoints(r)}else if(arguments[0]instanceof Et){let i=arguments[0];if(this.checkInvalidCoordinates(i),this._validErr!==null||(this.checkClosedRings(i),this._validErr!==null))return null;let r=new Mi(0,i);if(this.checkTooFewPoints(r),this._validErr!==null||(this.checkConsistentArea(r),this._validErr!==null)||!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(r),this._validErr!==null)||(this.checkHolesInShell(i,r),this._validErr!==null)||(this.checkHolesNotNested(i,r),this._validErr!==null))return null;this.checkConnectedInteriors(r)}else if(arguments[0]instanceof at){let i=arguments[0];for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c);if(this.checkInvalidCoordinates(f),this._validErr!==null||(this.checkClosedRings(f),this._validErr!==null))return null}let r=new Mi(0,i);if(this.checkTooFewPoints(r),this._validErr!==null||(this.checkConsistentArea(r),this._validErr!==null)||!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(r),this._validErr!==null))return null;for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c);if(this.checkHolesInShell(f,r),this._validErr!==null)return null}for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c);if(this.checkHolesNotNested(f,r),this._validErr!==null)return null}if(this.checkShellsNotNested(i,r),this._validErr!==null)return null;this.checkConnectedInteriors(r)}else if(arguments[0]instanceof tt){let i=arguments[0];for(let r=0;r<i.getNumGeometries();r++){let c=i.getGeometryN(r);if(this.checkValid(c),this._validErr!==null)return null}}else if(arguments[0]instanceof Q){let i=arguments[0];if(this._validErr=null,i.isEmpty())return null;if(i instanceof yt)this.checkValid(i);else if(i instanceof Li)this.checkValid(i);else if(i instanceof ae)this.checkValid(i);else if(i instanceof Z)this.checkValid(i);else if(i instanceof Et)this.checkValid(i);else if(i instanceof at)this.checkValid(i);else{if(!(i instanceof tt))throw new Je(i.getGeometryType());this.checkValid(i)}}}setSelfTouchingRingFormingHoleValid(i){this._isSelfTouchingRingFormingHoleValid=i}checkClosedRing(i){if(i.isEmpty())return null;if(!i.isClosed()){let r=null;i.getNumPoints()>=1&&(r=i.getCoordinateN(0)),this._validErr=new dt(dt.RING_NOT_CLOSED,r)}}checkShellsNotNested(i,r){for(let c=0;c<i.getNumGeometries();c++){let f=i.getGeometryN(c).getExteriorRing();for(let g=0;g<i.getNumGeometries();g++){if(c===g)continue;let y=i.getGeometryN(g);if(this.checkShellNotNested(f,y,r),this._validErr!==null)return null}}}}class Or{constructor(){Or.constructor_.apply(this,arguments)}static constructor_(){this._factory=null,this._deList=new M,this._lowestEdge=null,this._ring=null,this._locator=null,this._ringPts=null,this._holes=null,this._shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;let i=arguments[0];this._factory=i}static findEdgeRingContaining(i,r){let c=i.getRing(),f=c.getEnvelopeInternal(),g=c.getCoordinateN(0),y=null,S=null;for(let I=r.iterator();I.hasNext();){let z=I.next(),ne=z.getRing().getEnvelopeInternal();ne.equals(f)||ne.contains(f)&&(g=Be.ptNotInList(c.getCoordinates(),z.getCoordinates()),z.isInRing(g)&&(y===null||S.contains(ne))&&(y=z,S=y.getRing().getEnvelopeInternal()))}return y}static addEdge(i,r,c){if(r)for(let f=0;f<i.length;f++)c.add(i[f],!1);else for(let f=i.length-1;f>=0;f--)c.add(i[f],!1)}static findDirEdgesInRing(i){let r=i,c=new M;do c.add(r),r=r.getNext(),d.isTrue(r!==null,"found null DE in ring"),d.isTrue(r===i||!r.isInRing(),"found DE already in ring");while(r!==i);return c}isIncluded(){return this._isIncluded}getCoordinates(){if(this._ringPts===null){let i=new E;for(let r=this._deList.iterator();r.hasNext();){let c=r.next(),f=c.getEdge();Or.addEdge(f.getLine().getCoordinates(),c.getEdgeDirection(),i)}this._ringPts=i.toCoordinateArray()}return this._ringPts}build(i){let r=i;do this.add(r),r.setRing(this),r=r.getNext(),d.isTrue(r!==null,"found null DE in ring"),d.isTrue(r===i||!r.isInRing(),"found DE already in ring");while(r!==i)}isInRing(i){return B.EXTERIOR!==this.getLocator().locate(i)}addHole(){if(arguments[0]instanceof ae){let i=arguments[0];this._holes===null&&(this._holes=new M),this._holes.add(i)}else if(arguments[0]instanceof Or){let i=arguments[0];i.setShell(this);let r=i.getRing();this._holes===null&&(this._holes=new M),this._holes.add(r)}}computeHole(){let i=this.getRing();this._isHole=pe.isCCW(i.getCoordinates())}getLocator(){return this._locator===null&&(this._locator=new So(this.getRing())),this._locator}getShell(){return this.isHole()?this._shell:this}updateIncluded(){if(this.isHole())return null;for(let i=0;i<this._deList.size();i++){let r=this._deList.get(i).getSym().getRing().getShell();if(r!==null&&r.isIncludedSet())return this.setIncluded(!r.isIncluded()),null}}setShell(i){this._shell=i}setProcessed(i){this._isProcessed=i}isIncludedSet(){return this._isIncludedSet}isValid(){return this.getCoordinates(),!(this._ringPts.length<=3)&&(this.getRing(),rs.isValid(this._ring))}isOuterHole(){return!!this._isHole&&!this.hasShell()}getPolygon(){let i=null;if(this._holes!==null){i=new Array(this._holes.size()).fill(null);for(let r=0;r<this._holes.size();r++)i[r]=this._holes.get(r)}return this._factory.createPolygon(this._ring,i)}isHole(){return this._isHole}isProcessed(){return this._isProcessed}setIncluded(i){this._isIncluded=i,this._isIncludedSet=!0}getOuterHole(){if(this.isHole())return null;for(let i=0;i<this._deList.size();i++){let r=this._deList.get(i).getSym().getRing();if(r.isOuterHole())return r}return null}hasShell(){return this._shell!==null}isOuterShell(){return this.getOuterHole()!==null}getLineString(){return this.getCoordinates(),this._factory.createLineString(this._ringPts)}toString(){return rn.toLineString(new de(this.getCoordinates()))}add(i){this._deList.add(i)}getRing(){if(this._ring!==null)return this._ring;this.getCoordinates(),this._ringPts.length<3&&Fe.out.println(this._ringPts);try{this._ring=this._factory.createLinearRing(this._ringPts)}catch(i){if(!(i instanceof n))throw i;Fe.out.println(this._ringPts)}return this._ring}}Or.EnvelopeComparator=class{compare(A,i){let r=i;return A.getRing().getEnvelope().compareTo(r.getRing().getEnvelope())}get interfaces_(){return[m]}};class Vf{constructor(){Vf.constructor_.apply(this,arguments)}static constructor_(){this._shells=null,this._shellIndex=null;let i=arguments[0];this._shells=i,this.buildIndex()}static assignHolesToShells(i,r){new Vf(r).assignHolesToShells(i)}assignHolesToShells(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this.assignHoleToShell(c)}}buildIndex(){this._shellIndex=new Kt;for(let i of this._shells)this._shellIndex.insert(i.getRing().getEnvelopeInternal(),i)}queryOverlappingShells(i){return this._shellIndex.query(i)}findShellContaining(i){let r=i.getRing().getEnvelopeInternal(),c=this.queryOverlappingShells(r);return Or.findEdgeRingContaining(i,c)}assignHoleToShell(i){let r=this.findShellContaining(i);r!==null&&r.addHole(i)}}class Hf extends ws{constructor(){super(),Hf.constructor_.apply(this,arguments)}static constructor_(){this._edgeRing=null,this._next=null,this._label=-1;let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];ws.constructor_.call(this,i,r,c,f)}getNext(){return this._next}isInRing(){return this._edgeRing!==null}setRing(i){this._edgeRing=i}setLabel(i){this._label=i}getLabel(){return this._label}setNext(i){this._next=i}getRing(){return this._edgeRing}}class Ty extends ko{constructor(){super(),Ty.constructor_.apply(this,arguments)}static constructor_(){this._line=null;let i=arguments[0];this._line=i}getLine(){return this._line}}class os extends $f{constructor(){super(),os.constructor_.apply(this,arguments)}static constructor_(){this._factory=null;let i=arguments[0];this._factory=i}static findLabeledEdgeRings(i){let r=new M,c=1;for(let f=i.iterator();f.hasNext();){let g=f.next();if(g.isMarked()||g.getLabel()>=0)continue;r.add(g);let y=Or.findDirEdgesInRing(g);os.label(y,c),c++}return r}static getDegreeNonDeleted(i){let r=0;for(let c=i.getOutEdges().getEdges().iterator();c.hasNext();)c.next().isMarked()||r++;return r}static deleteAllEdges(i){for(let r=i.getOutEdges().getEdges().iterator();r.hasNext();){let c=r.next();c.setMarked(!0);let f=c.getSym();f!==null&&f.setMarked(!0)}}static label(i,r){for(let c=i.iterator();c.hasNext();)c.next().setLabel(r)}static computeNextCWEdges(i){let r=null,c=null;for(let f=i.getOutEdges().getEdges().iterator();f.hasNext();){let g=f.next();g.isMarked()||(r===null&&(r=g),c!==null&&c.getSym().setNext(g),c=g)}c!==null&&c.getSym().setNext(r)}static computeNextCCWEdges(i,r){let c=null,f=null,g=i.getOutEdges().getEdges();for(let y=g.size()-1;y>=0;y--){let S=g.get(y),I=S.getSym(),z=null;S.getLabel()===r&&(z=S);let ne=null;I.getLabel()===r&&(ne=I),z===null&&ne===null||(ne!==null&&(f=ne),z!==null&&(f!==null&&(f.setNext(z),f=null),c===null&&(c=z)))}f!==null&&(d.isTrue(c!==null),f.setNext(c))}static getDegree(i,r){let c=0;for(let f=i.getOutEdges().getEdges().iterator();f.hasNext();)f.next().getLabel()===r&&c++;return c}static findIntersectionNodes(i,r){let c=i,f=null;do{let g=c.getFromNode();os.getDegree(g,r)>1&&(f===null&&(f=new M),f.add(g)),c=c.getNext(),d.isTrue(c!==null,"found null DE in ring"),d.isTrue(c===i||!c.isInRing(),"found DE already in ring")}while(c!==i);return f}findEdgeRing(i){let r=new Or(this._factory);return r.build(i),r}computeDepthParity(){if(arguments.length===0)for(;;)return null}computeNextCWEdges(){for(let i=this.nodeIterator();i.hasNext();){let r=i.next();os.computeNextCWEdges(r)}}addEdge(i){if(i.isEmpty())return null;let r=Be.removeRepeatedPoints(i.getCoordinates());if(r.length<2)return null;let c=r[0],f=r[r.length-1],g=this.getNode(c),y=this.getNode(f),S=new Hf(g,y,r[1],!0),I=new Hf(y,g,r[r.length-2],!1),z=new Ty(i);z.setDirectedEdges(S,I),this.add(z)}deleteCutEdges(){this.computeNextCWEdges(),os.findLabeledEdgeRings(this._dirEdges);let i=new M;for(let r=this._dirEdges.iterator();r.hasNext();){let c=r.next();if(c.isMarked())continue;let f=c.getSym();if(c.getLabel()===f.getLabel()){c.setMarked(!0),f.setMarked(!0);let g=c.getEdge();i.add(g.getLine())}}return i}getEdgeRings(){this.computeNextCWEdges(),os.label(this._dirEdges,-1);let i=os.findLabeledEdgeRings(this._dirEdges);this.convertMaximalToMinimalEdgeRings(i);let r=new M;for(let c=this._dirEdges.iterator();c.hasNext();){let f=c.next();if(f.isMarked()||f.isInRing())continue;let g=this.findEdgeRing(f);r.add(g)}return r}getNode(i){let r=this.findNode(i);return r===null&&(r=new Ro(i),this.add(r)),r}convertMaximalToMinimalEdgeRings(i){for(let r=i.iterator();r.hasNext();){let c=r.next(),f=c.getLabel(),g=os.findIntersectionNodes(c,f);if(g!==null)for(let y=g.iterator();y.hasNext();){let S=y.next();os.computeNextCCWEdges(S,f)}}}deleteDangles(){let i=this.findNodesOfDegree(1),r=new xn,c=new Ia;for(let f=i.iterator();f.hasNext();)c.push(f.next());for(;!c.isEmpty();){let f=c.pop();os.deleteAllEdges(f);for(let g=f.getOutEdges().getEdges().iterator();g.hasNext();){let y=g.next();y.setMarked(!0);let S=y.getSym();S!==null&&S.setMarked(!0);let I=y.getEdge();r.add(I.getLine());let z=y.getToNode();os.getDegreeNonDeleted(z)===1&&c.push(z)}}return r}}class Ao{constructor(){Ao.constructor_.apply(this,arguments)}static constructor_(){if(this._lineStringAdder=new Wf(this),this._graph=null,this._dangles=new M,this._cutEdges=new M,this._invalidRingLines=new M,this._holeList=null,this._shellList=null,this._polyList=null,this._isCheckingRingsValid=!0,this._extractOnlyPolygonal=null,this._geomFactory=null,arguments.length===0)Ao.constructor_.call(this,!1);else if(arguments.length===1){let i=arguments[0];this._extractOnlyPolygonal=i}}static findOuterShells(i){for(let r=i.iterator();r.hasNext();){let c=r.next(),f=c.getOuterHole();f===null||f.isProcessed()||(c.setIncluded(!0),f.setProcessed(!0))}}static extractPolygons(i,r){let c=new M;for(let f=i.iterator();f.hasNext();){let g=f.next();(r||g.isIncluded())&&c.add(g.getPolygon())}return c}static findDisjointShells(i){Ao.findOuterShells(i);let r=null;do{r=!1;for(let c=i.iterator();c.hasNext();){let f=c.next();f.isIncludedSet()||(f.updateIncluded(),f.isIncludedSet()||(r=!0))}}while(r)}getGeometry(){return this._geomFactory===null&&(this._geomFactory=new vt),this.polygonize(),this._extractOnlyPolygonal?this._geomFactory.buildGeometry(this._polyList):this._geomFactory.createGeometryCollection(vt.toGeometryArray(this._polyList))}getInvalidRingLines(){return this.polygonize(),this._invalidRingLines}findValidRings(i,r,c){for(let f=i.iterator();f.hasNext();){let g=f.next();g.isValid()?r.add(g):c.add(g.getLineString())}}polygonize(){if(this._polyList!==null||(this._polyList=new M,this._graph===null))return null;this._dangles=this._graph.deleteDangles(),this._cutEdges=this._graph.deleteCutEdges();let i=this._graph.getEdgeRings(),r=new M;this._invalidRingLines=new M,this._isCheckingRingsValid?this.findValidRings(i,r,this._invalidRingLines):r=i,this.findShellsAndHoles(r),Vf.assignHolesToShells(this._holeList,this._shellList),Le.sort(this._shellList,new Or.EnvelopeComparator);let c=!0;this._extractOnlyPolygonal&&(Ao.findDisjointShells(this._shellList),c=!1),this._polyList=Ao.extractPolygons(this._shellList,c)}getDangles(){return this.polygonize(),this._dangles}add(){if(P(arguments[0],j))for(let i=arguments[0].iterator();i.hasNext();){let r=i.next();this.add(r)}else if(arguments[0]instanceof Z){let i=arguments[0];this._geomFactory=i.getFactory(),this._graph===null&&(this._graph=new os(this._geomFactory)),this._graph.addEdge(i)}else arguments[0]instanceof Q&&arguments[0].apply(this._lineStringAdder)}setCheckRingsValid(i){this._isCheckingRingsValid=i}findShellsAndHoles(i){this._holeList=new M,this._shellList=new M;for(let r=i.iterator();r.hasNext();){let c=r.next();c.computeHole(),c.isHole()?this._holeList.add(c):this._shellList.add(c)}}getCutEdges(){return this.polygonize(),this._cutEdges}getPolygons(){return this.polygonize(),this._polyList}}class Wf{constructor(){Wf.constructor_.apply(this,arguments)}static constructor_(){this.p=null;let i=arguments[0];this.p=i}filter(i){i instanceof Z&&this.p.add(i)}get interfaces_(){return[Pe]}}Ao.LineStringAdder=Wf;var DP=Object.freeze({__proto__:null,Polygonizer:Ao});class Yf{constructor(){Yf.constructor_.apply(this,arguments)}static constructor_(){this._li=new wn,this._ptLocator=new Co,this._arg=null,this._nodes=new vf(new TS),this._im=null,this._isolatedEdges=new M,this._invalidPoint=null;let i=arguments[0];this._arg=i}insertEdgeEnds(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this._nodes.add(c)}}computeProperIntersectionIM(i,r){let c=this._arg[0].getGeometry().getDimension(),f=this._arg[1].getGeometry().getDimension(),g=i.hasProperIntersection(),y=i.hasProperInteriorIntersection();c===2&&f===2?g&&r.setAtLeast("212101212"):c===2&&f===1?(g&&r.setAtLeast("FFF0FFFF2"),y&&r.setAtLeast("1FFFFF1FF")):c===1&&f===2?(g&&r.setAtLeast("F0FFFFFF2"),y&&r.setAtLeast("1F1FFFFFF")):c===1&&f===1&&y&&r.setAtLeast("0FFFFFFFF")}labelIsolatedEdges(i,r){for(let c=this._arg[i].getEdgeIterator();c.hasNext();){let f=c.next();f.isIsolated()&&(this.labelIsolatedEdge(f,r,this._arg[r].getGeometry()),this._isolatedEdges.add(f))}}labelIsolatedEdge(i,r,c){if(c.getDimension()>0){let f=this._ptLocator.locate(i.getCoordinate(),c);i.getLabel().setAllLocations(r,f)}else i.getLabel().setAllLocations(r,B.EXTERIOR)}computeIM(){let i=new Ct;if(i.set(B.EXTERIOR,B.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(i),i;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);let r=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(r,i);let c=new NS,f=c.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(f);let g=c.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(g),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(i),i}labelNodeEdges(){for(let i=this._nodes.iterator();i.hasNext();)i.next().getEdges().computeLabelling(this._arg)}copyNodesAndLabels(i){for(let r=this._arg[i].getNodeIterator();r.hasNext();){let c=r.next();this._nodes.addNode(c.getCoordinate()).setLabel(i,c.getLabel().getLocation(i))}}labelIntersectionNodes(i){for(let r=this._arg[i].getEdgeIterator();r.hasNext();){let c=r.next(),f=c.getLabel().getLocation(i);for(let g=c.getEdgeIntersectionList().iterator();g.hasNext();){let y=g.next(),S=this._nodes.find(y.coord);S.getLabel().isNull(i)&&(f===B.BOUNDARY?S.setLabelBoundary(i):S.setLabel(i,B.INTERIOR))}}}labelIsolatedNode(i,r){let c=this._ptLocator.locate(i.getCoordinate(),this._arg[r].getGeometry());i.getLabel().setAllLocations(r,c)}computeIntersectionNodes(i){for(let r=this._arg[i].getEdgeIterator();r.hasNext();){let c=r.next(),f=c.getLabel().getLocation(i);for(let g=c.getEdgeIntersectionList().iterator();g.hasNext();){let y=g.next(),S=this._nodes.addNode(y.coord);f===B.BOUNDARY?S.setLabelBoundary(i):S.getLabel().isNull(i)&&S.setLabel(i,B.INTERIOR)}}}labelIsolatedNodes(){for(let i=this._nodes.iterator();i.hasNext();){let r=i.next(),c=r.getLabel();d.isTrue(c.getGeometryCount()>0,"node with empty label found"),r.isIsolated()&&(c.isNull(0)?this.labelIsolatedNode(r,0):this.labelIsolatedNode(r,1))}}updateIM(i){for(let r=this._isolatedEdges.iterator();r.hasNext();)r.next().updateIM(i);for(let r=this._nodes.iterator();r.hasNext();){let c=r.next();c.updateIM(i),c.updateIMFromEdges(i)}}computeDisjointIM(i){let r=this._arg[0].getGeometry();r.isEmpty()||(i.set(B.INTERIOR,B.EXTERIOR,r.getDimension()),i.set(B.BOUNDARY,B.EXTERIOR,r.getBoundaryDimension()));let c=this._arg[1].getGeometry();c.isEmpty()||(i.set(B.EXTERIOR,B.INTERIOR,c.getDimension()),i.set(B.EXTERIOR,B.BOUNDARY,c.getBoundaryDimension()))}}class Xf{constructor(){Xf.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null;let i=arguments[0];this._rectEnv=i.getEnvelopeInternal()}static contains(i,r){return new Xf(i).contains(r)}isContainedInBoundary(i){if(i instanceof Et)return!1;if(i instanceof yt)return this.isPointContainedInBoundary(i);if(i instanceof Z)return this.isLineStringContainedInBoundary(i);for(let r=0;r<i.getNumGeometries();r++){let c=i.getGeometryN(r);if(!this.isContainedInBoundary(c))return!1}return!0}isLineSegmentContainedInBoundary(i,r){if(i.equals(r))return this.isPointContainedInBoundary(i);if(i.x===r.x){if(i.x===this._rectEnv.getMinX()||i.x===this._rectEnv.getMaxX())return!0}else if(i.y===r.y&&(i.y===this._rectEnv.getMinY()||i.y===this._rectEnv.getMaxY()))return!0;return!1}isLineStringContainedInBoundary(i){let r=i.getCoordinateSequence(),c=new w,f=new w;for(let g=0;g<r.size()-1;g++)if(r.getCoordinate(g,c),r.getCoordinate(g+1,f),!this.isLineSegmentContainedInBoundary(c,f))return!1;return!0}isPointContainedInBoundary(){if(arguments[0]instanceof yt){let i=arguments[0];return this.isPointContainedInBoundary(i.getCoordinate())}if(arguments[0]instanceof w){let i=arguments[0];return i.x===this._rectEnv.getMinX()||i.x===this._rectEnv.getMaxX()||i.y===this._rectEnv.getMinY()||i.y===this._rectEnv.getMaxY()}}contains(i){return!!this._rectEnv.contains(i.getEnvelopeInternal())&&!this.isContainedInBoundary(i)}}class ky{constructor(){ky.constructor_.apply(this,arguments)}static constructor_(){this._li=new wn,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;let i=arguments[0];this._rectEnv=i,this._diagUp0=new w(i.getMinX(),i.getMinY()),this._diagUp1=new w(i.getMaxX(),i.getMaxY()),this._diagDown0=new w(i.getMinX(),i.getMaxY()),this._diagDown1=new w(i.getMaxX(),i.getMinY())}intersects(i,r){let c=new K(i,r);if(!this._rectEnv.intersects(c))return!1;if(this._rectEnv.intersects(i)||this._rectEnv.intersects(r))return!0;if(i.compareTo(r)>0){let g=i;i=r,r=g}let f=!1;return r.y>i.y&&(f=!0),f?this._li.computeIntersection(i,r,this._diagDown0,this._diagDown1):this._li.computeIntersection(i,r,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}}class Hu{constructor(){Hu.constructor_.apply(this,arguments)}static constructor_(){this._rectangle=null,this._rectEnv=null;let i=arguments[0];this._rectangle=i,this._rectEnv=i.getEnvelopeInternal()}static intersects(i,r){return new Hu(i).intersects(r)}intersects(i){if(!this._rectEnv.intersects(i.getEnvelopeInternal()))return!1;let r=new Ry(this._rectEnv);if(r.applyTo(i),r.intersects())return!0;let c=new My(this._rectangle);if(c.applyTo(i),c.containsPoint())return!0;let f=new Ay(this._rectangle);return f.applyTo(i),!!f.intersects()}}class Ry extends Ve{constructor(){super(),Ry.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null,this._intersects=!1;let i=arguments[0];this._rectEnv=i}intersects(){return this._intersects}visit(i){let r=i.getEnvelopeInternal();return this._rectEnv.intersects(r)?this._rectEnv.contains(r)||r.getMinX()>=this._rectEnv.getMinX()&&r.getMaxX()<=this._rectEnv.getMaxX()||r.getMinY()>=this._rectEnv.getMinY()&&r.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}isDone(){return this._intersects===!0}}class My extends Ve{constructor(){super(),My.constructor_.apply(this,arguments)}static constructor_(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;let i=arguments[0];this._rectSeq=i.getExteriorRing().getCoordinateSequence(),this._rectEnv=i.getEnvelopeInternal()}visit(i){if(!(i instanceof Et))return null;let r=i.getEnvelopeInternal();if(!this._rectEnv.intersects(r))return null;let c=new w;for(let f=0;f<4;f++)if(this._rectSeq.getCoordinate(f,c),r.contains(c)&&es.containsPointInPolygon(c,i))return this._containsPoint=!0,null}containsPoint(){return this._containsPoint}isDone(){return this._containsPoint===!0}}class Ay extends Ve{constructor(){super(),Ay.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new w,this._p1=new w;let i=arguments[0];this._rectEnv=i.getEnvelopeInternal(),this._rectIntersector=new ky(this._rectEnv)}intersects(){return this._hasIntersection}isDone(){return this._hasIntersection===!0}visit(i){let r=i.getEnvelopeInternal();if(!this._rectEnv.intersects(r))return null;let c=Se.getLines(i);this.checkIntersectionWithLineStrings(c)}checkIntersectionWithLineStrings(i){for(let r=i.iterator();r.hasNext();){let c=r.next();if(this.checkIntersectionWithSegments(c),this._hasIntersection)return null}}checkIntersectionWithSegments(i){let r=i.getCoordinateSequence();for(let c=1;c<r.size();c++)if(r.getCoordinate(c-1,this._p0),r.getCoordinate(c,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}}class Bt extends Io{constructor(){super(),Bt.constructor_.apply(this,arguments)}static constructor_(){if(this._relate=null,arguments.length===2){let i=arguments[0],r=arguments[1];Io.constructor_.call(this,i,r),this._relate=new Yf(this._arg)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];Io.constructor_.call(this,i,r,c),this._relate=new Yf(this._arg)}}static equalsTopo(i,r){return!!i.getEnvelopeInternal().equals(r.getEnvelopeInternal())&&Bt.relate(i,r).isEquals(i.getDimension(),r.getDimension())}static relate(){if(arguments.length===2)return new Bt(arguments[0],arguments[1]).getIntersectionMatrix();if(arguments.length===3)return new Bt(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix()}static overlaps(i,r){return!!i.getEnvelopeInternal().intersects(r.getEnvelopeInternal())&&new Bt(i,r).getIntersectionMatrix().isOverlaps(i.getDimension(),r.getDimension())}static disjoint(i,r){return!Bt.intersects(i,r)}static covers(i,r){return!(r.getDimension()===2&&i.getDimension()<2)&&!(r.getDimension()===1&&i.getDimension()<1&&r.getLength()>0)&&!!i.getEnvelopeInternal().covers(r.getEnvelopeInternal())&&(!!i.isRectangle()||new Bt(i,r).getIntersectionMatrix().isCovers())}static intersects(i,r){if(!i.getEnvelopeInternal().intersects(r.getEnvelopeInternal()))return!1;if(i.isRectangle())return Hu.intersects(i,r);if(r.isRectangle())return Hu.intersects(r,i);if(i.isGeometryCollection()||r.isGeometryCollection()){for(let c=0;c<i.getNumGeometries();c++)for(let f=0;f<r.getNumGeometries();f++)if(Bt.intersects(i.getGeometryN(c),r.getGeometryN(f)))return!0;return!1}return new Bt(i,r).getIntersectionMatrix().isIntersects()}static touches(i,r){return!!i.getEnvelopeInternal().intersects(r.getEnvelopeInternal())&&new Bt(i,r).getIntersectionMatrix().isTouches(i.getDimension(),r.getDimension())}static crosses(i,r){return!!i.getEnvelopeInternal().intersects(r.getEnvelopeInternal())&&new Bt(i,r).getIntersectionMatrix().isCrosses(i.getDimension(),r.getDimension())}static contains(i,r){return!(r.getDimension()===2&&i.getDimension()<2)&&!(r.getDimension()===1&&i.getDimension()<1&&r.getLength()>0)&&!!i.getEnvelopeInternal().contains(r.getEnvelopeInternal())&&(i.isRectangle()?Xf.contains(i,r):new Bt(i,r).getIntersectionMatrix().isContains())}getIntersectionMatrix(){return this._relate.computeIM()}}var GP=Object.freeze({__proto__:null,RelateOp:Bt});class Gl{constructor(){Gl.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._polygons=new M,this._lines=new M,this._points=new M,this._dimension=C.FALSE}static extract(){if(P(arguments[0],j)){let i=arguments[0],r=new Gl;return r.add(i),r}if(arguments[0]instanceof Q){let i=arguments[0],r=new Gl;return r.add(i),r}}getFactory(){return this._geomFactory}filter(i){return this.recordDimension(i.getDimension()),i instanceof tt||i.isEmpty()?null:i instanceof Et?(this._polygons.add(i),null):i instanceof Z?(this._lines.add(i),null):i instanceof yt?(this._points.add(i),null):void d.shouldNeverReachHere("Unhandled geometry type: "+i.getGeometryType())}getExtract(i){switch(i){case 0:return this._points;case 1:return this._lines;case 2:return this._polygons}return d.shouldNeverReachHere("Invalid dimension: "+i),null}recordDimension(i){i>this._dimension&&(this._dimension=i)}getDimension(){return this._dimension}isEmpty(){return this._polygons.isEmpty()&&this._lines.isEmpty()&&this._points.isEmpty()}add(){if(P(arguments[0],j)){let i=arguments[0];for(let r of i)this.add(r)}else if(arguments[0]instanceof Q){let i=arguments[0];this._geomFactory===null&&(this._geomFactory=i.getFactory()),i.apply(this)}}get interfaces_(){return[O]}}class Zf{constructor(){Zf.constructor_.apply(this,arguments)}static constructor_(){this._pointGeom=null,this._otherGeom=null,this._geomFact=null;let i=arguments[0],r=arguments[1];this._pointGeom=i,this._otherGeom=r,this._geomFact=r.getFactory()}static union(i,r){return new Zf(i,r).union()}union(){let i=new Co,r=new Xe;for(let g=0;g<this._pointGeom.getNumGeometries();g++){let y=this._pointGeom.getGeometryN(g).getCoordinate();i.locate(y,this._otherGeom)===B.EXTERIOR&&r.add(y)}if(r.size()===0)return this._otherGeom;let c=null,f=Be.toCoordinateArray(r);return c=f.length===1?this._geomFact.createPoint(f[0]):this._geomFact.createMultiPointFromCoords(f),Ti.combine(c,this._otherGeom)}}class as{constructor(){as.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._g0=null,this._g1=null,this._isUnionSafe=null;let i=arguments[0],r=arguments[1];this._g0=i,this._g1=r,this._geomFactory=i.getFactory()}static containsProperly(){if(arguments.length===2){let i=arguments[0],r=arguments[1];return!i.isNull()&&r.getX()>i.getMinX()&&r.getX()<i.getMaxX()&&r.getY()>i.getMinY()&&r.getY()<i.getMaxY()}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];return as.containsProperly(i,r)&&as.containsProperly(i,c)}}static union(i,r){return new as(i,r).union()}static intersects(i,r,c){return i.intersects(r)||i.intersects(c)}static overlapEnvelope(i,r){let c=i.getEnvelopeInternal(),f=r.getEnvelopeInternal();return c.intersection(f)}static extractBorderSegments(i,r,c){i.apply(new class{get interfaces_(){return[X]}filter(f,g){if(g<=0)return null;let y=f.getCoordinate(g-1),S=f.getCoordinate(g);if(as.intersects(r,y,S)&&!as.containsProperly(r,y,S)){let I=new Ze(y,S);c.add(I)}}isDone(){return!1}isGeometryChanged(){return!1}})}static unionBuffer(i,r){let c=i.getFactory().createGeometryCollection([i,r]);return Ht.bufferOp(c,0)}isBorderSegmentsSame(i,r){let c=this.extractBorderSegments(this._g0,this._g1,r),f=new M;return as.extractBorderSegments(i,r,f),this.isEqual(c,f)}union(){let i=as.overlapEnvelope(this._g0,this._g1);if(i.isNull()){let S=this._g0.copy(),I=this._g1.copy();return Ti.combine(S,I)}let r=new M,c=this.extractByEnvelope(i,this._g0,r),f=this.extractByEnvelope(i,this._g1,r),g=this.unionFull(c,f),y=null;return this._isUnionSafe=this.isBorderSegmentsSame(g,i),y=this._isUnionSafe?this.combine(g,r):this.unionFull(this._g0,this._g1),y}extractBorderSegments(i,r,c){let f=new M;return as.extractBorderSegments(i,c,f),r!==null&&as.extractBorderSegments(r,c,f),f}isUnionOptimized(){return this._isUnionSafe}extractByEnvelope(i,r,c){let f=new M;for(let g=0;g<r.getNumGeometries();g++){let y=r.getGeometryN(g);if(y.getEnvelopeInternal().intersects(i))f.add(y);else{let S=y.copy();c.add(S)}}return this._geomFactory.buildGeometry(f)}isEqual(i,r){if(i.size()!==r.size())return!1;let c=new xn(i);for(let f of r)if(!c.contains(f))return!1;return!0}combine(i,r){return r.size()<=0?i:(r.add(i),Ti.combine(r))}unionFull(i,r){try{return Fu.union(i,r)}catch(c){if(c instanceof ts)return as.unionBuffer(i,r);throw c}}}class lr{constructor(){lr.constructor_.apply(this,arguments)}static constructor_(){this._inputPolys=null,this._geomFactory=null;let i=arguments[0];this._inputPolys=i,this._inputPolys===null&&(this._inputPolys=new M)}static getGeometry(i,r){return r>=i.size()?null:i.get(r)}static union(i){return new lr(i).union()}static restrictToPolygons(i){if(P(i,Jn))return i;let r=Me.getPolygons(i);return r.size()===1?r.get(0):i.getFactory().createMultiPolygon(vt.toPolygonArray(r))}reduceToGeometries(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next(),g=null;P(f,H)?g=this.unionTree(f):f instanceof Q&&(g=f),r.add(g)}return r}union(){if(this._inputPolys===null)throw new Re("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();let i=new Kt(lr.STRTREE_NODE_CAPACITY);for(let c=this._inputPolys.iterator();c.hasNext();){let f=c.next();i.insert(f.getEnvelopeInternal(),f)}this._inputPolys=null;let r=i.itemsTree();return this.unionTree(r)}binaryUnion(){if(arguments.length===1){let i=arguments[0];return this.binaryUnion(i,0,i.size())}if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(c-r<=1){let f=lr.getGeometry(i,r);return this.unionSafe(f,null)}if(c-r==2)return this.unionSafe(lr.getGeometry(i,r),lr.getGeometry(i,r+1));{let f=Math.trunc((c+r)/2),g=this.binaryUnion(i,r,f),y=this.binaryUnion(i,f,c);return this.unionSafe(g,y)}}}unionSafe(i,r){return i===null&&r===null?null:i===null?r.copy():r===null?i.copy():this.unionActual(i,r)}unionActual(i,r){let c=as.union(i,r);return lr.restrictToPolygons(c)}unionTree(i){let r=this.reduceToGeometries(i);return this.binaryUnion(r)}}lr.STRTREE_NODE_CAPACITY=4;class Ma{constructor(){Ma.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFact=null,this._extracter=null,arguments.length===1){if(P(arguments[0],j)){let i=arguments[0];this.extract(i)}else if(arguments[0]instanceof Q){let i=arguments[0];this.extract(i)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._geomFact=r,this.extract(i)}}static union(){if(arguments.length===1){if(P(arguments[0],j))return new Ma(arguments[0]).union();if(arguments[0]instanceof Q)return new Ma(arguments[0]).union()}else if(arguments.length===2)return new Ma(arguments[0],arguments[1]).union()}extract(){if(P(arguments[0],j)){let i=arguments[0];this._extracter=Gl.extract(i)}else if(arguments[0]instanceof Q){let i=arguments[0];this._extracter=Gl.extract(i)}}unionWithNull(i,r){return i===null&&r===null?null:r===null?i:i===null?r:We.union(i,r)}unionNoOpt(i){let r=this._geomFact.createPoint();return is.overlayOp(i,r,We.UNION)}union(){if(this._geomFact===null&&(this._geomFact=this._extracter.getFactory()),this._geomFact===null)return null;if(this._extracter.isEmpty())return this._geomFact.createEmpty(this._extracter.getDimension());let i=this._extracter.getExtract(0),r=this._extracter.getExtract(1),c=this._extracter.getExtract(2),f=null;if(i.size()>0){let z=this._geomFact.buildGeometry(i);f=this.unionNoOpt(z)}let g=null;if(r.size()>0){let z=this._geomFact.buildGeometry(r);g=this.unionNoOpt(z)}let y=null;c.size()>0&&(y=lr.union(c));let S=this.unionWithNull(g,y),I=null;return I=f===null?S:S===null?f:Zf.union(f,S),I===null?this._geomFact.createGeometryCollection():I}}var jP=Object.freeze({__proto__:null,UnaryUnionOp:Ma}),qP=Object.freeze({__proto__:null,ConsistentAreaTester:zf,IsValidOp:rs}),$P=Object.freeze({__proto__:null,BoundaryOp:To,IsSimpleOp:Ra,buffer:RP,distance:MP,linemerge:AP,overlay:PP,polygonize:DP,relate:GP,union:jP,valid:qP});class Pr{constructor(){Pr.constructor_.apply(this,arguments)}static constructor_(){if(this._returnToOriginalPrecision=!0,this._cbr=null,arguments.length===0)Pr.constructor_.call(this,!0);else if(arguments.length===1){let i=arguments[0];this._returnToOriginalPrecision=i}}computeResultPrecision(i){return this._returnToOriginalPrecision&&this._cbr.addCommonBits(i),i}union(i,r){let c=this.removeCommonBits(i,r);return this.computeResultPrecision(Fu.union(c[0],c[1]))}intersection(i,r){let c=this.removeCommonBits(i,r);return this.computeResultPrecision(We.intersection(c[0],c[1]))}removeCommonBits(){if(arguments.length===1){let i=arguments[0];return this._cbr=new Eo,this._cbr.add(i),this._cbr.removeCommonBits(i.copy())}if(arguments.length===2){let i=arguments[0],r=arguments[1];this._cbr=new Eo,this._cbr.add(i),this._cbr.add(r);let c=new Array(2).fill(null);return c[0]=this._cbr.removeCommonBits(i.copy()),c[1]=this._cbr.removeCommonBits(r.copy()),c}}buffer(i,r){let c=this.removeCommonBits(i);return this.computeResultPrecision(Ht.bufferOp(c,r))}symDifference(i,r){let c=this.removeCommonBits(i,r);return this.computeResultPrecision(We.symDifference(c[0],c[1]))}difference(i,r){let c=this.removeCommonBits(i,r);return this.computeResultPrecision(We.difference(c[0],c[1]))}}class Oy extends q.CoordinateOperation{constructor(){super(),Oy.constructor_.apply(this,arguments)}static constructor_(){this._targetPM=null,this._removeCollapsed=!0;let i=arguments[0],r=arguments[1];this._targetPM=i,this._removeCollapsed=r}edit(){if(arguments.length===2&&arguments[1]instanceof Q&&arguments[0]instanceof Array){let i=arguments[0],r=arguments[1];if(i.length===0)return null;let c=new Array(i.length).fill(null);for(let S=0;S<i.length;S++){let I=new w(i[S]);this._targetPM.makePrecise(I),c[S]=I}let f=new E(c,!1).toCoordinateArray(),g=0;r instanceof Z&&(g=2),r instanceof ae&&(g=4);let y=c;return this._removeCollapsed&&(y=null),f.length<g?y:f}return super.edit.apply(this,arguments)}}class Wu{constructor(){Wu.constructor_.apply(this,arguments)}static constructor_(){this._targetPM=null,this._removeCollapsed=!0,this._changePrecisionModel=!1,this._isPointwise=!1;let i=arguments[0];this._targetPM=i}static reduce(i,r){return new Wu(r).reduce(i)}static reducePointwise(i,r){let c=new Wu(r);return c.setPointwise(!0),c.reduce(i)}fixPolygonalTopology(i){let r=i;return this._changePrecisionModel||(r=this.changePM(i,this._targetPM)),Ht.bufferOp(r,0)}reducePointwise(i){let r=null;if(this._changePrecisionModel){let f=this.createFactory(i.getFactory(),this._targetPM);r=new q(f)}else r=new q;let c=this._removeCollapsed;return i.getDimension()>=2&&(c=!0),r.edit(i,new Oy(this._targetPM,c))}changePM(i,r){return this.createEditor(i.getFactory(),r).edit(i,new q.NoOpGeometryOperation)}setRemoveCollapsedComponents(i){this._removeCollapsed=i}createFactory(i,r){return new vt(r,i.getSRID(),i.getCoordinateSequenceFactory())}setChangePrecisionModel(i){this._changePrecisionModel=i}reduce(i){let r=this.reducePointwise(i);return this._isPointwise?r:P(r,Jn)?rs.isValid(r)?r:this.fixPolygonalTopology(r):r}setPointwise(i){this._isPointwise=i}createEditor(i,r){if(i.getPrecisionModel()===r)return new q;let c=this.createFactory(i,r);return new q(c)}}class Yu{constructor(){Yu.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._pts=null,this._start=null,this._end=null,arguments.length===2){let i=arguments[0],r=arguments[1];this._pts=i,this._start=r,this._end=r+1}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._pts=i,this._start=r,this._end=c}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this._geom=i,this._pts=r,this._start=c,this._end=f}}size(){return this._end-this._start}getCoordinate(i){return this._pts.getCoordinate(this._start+i)}updateNearestLocationsLineLine(i,r,c,f,g,y,S,I){let z=new Ze(r,c),ne=new Ze(y,S),he=z.closestPoints(ne);I[0]=new Sn(this._geom,i,new w(he[0])),I[1]=new Sn(f._geom,g,new w(he[1]))}toString(){let i=new te;i.append("LINESTRING ( ");let r=new w;for(let c=this._start;c<this._end;c++)c>this._start&&i.append(", "),this._pts.getCoordinate(c,r),i.append(r.x+" "+r.y);return i.append(" )"),i.toString()}computeDistancePointLine(i,r,c){let f=l.MAX_VALUE;for(let g=r._start;g<r._end-1;g++){let y=r._pts.getCoordinate(g),S=r._pts.getCoordinate(g+1),I=qe.pointToSegment(i,y,S);if(I<f&&(f=I,c!==null&&this.updateNearestLocationsPointLine(i,r,g,y,S,c),f<=0))return f}return f}isPoint(){return this._end-this._start==1}distance(i){let r=this.isPoint(),c=i.isPoint(),f=null;if(r&&c){let g=this._pts.getCoordinate(this._start),y=i._pts.getCoordinate(i._start);f=g.distance(y)}else if(r){let g=this._pts.getCoordinate(this._start);f=this.computeDistancePointLine(g,i,null)}else if(c){let g=i._pts.getCoordinate(i._start);f=this.computeDistancePointLine(g,this,null)}else f=this.computeDistanceLineLine(i,null);return f}computeDistanceLineLine(i,r){let c=l.MAX_VALUE;for(let f=this._start;f<this._end-1;f++){let g=this._pts.getCoordinate(f),y=this._pts.getCoordinate(f+1);for(let S=i._start;S<i._end-1;S++){let I=i._pts.getCoordinate(S),z=i._pts.getCoordinate(S+1),ne=qe.segmentToSegment(g,y,I,z);if(ne<c&&(c=ne,r!==null&&this.updateNearestLocationsLineLine(f,g,y,i,S,I,z,r),c<=0))return c}}return c}updateNearestLocationsPointLine(i,r,c,f,g,y){y[0]=new Sn(this._geom,this._start,new w(i));let S=new Ze(f,g).closestPoint(i);y[1]=new Sn(r._geom,c,new w(S))}nearestLocations(i){let r=this.isPoint(),c=i.isPoint(),f=new Array(2).fill(null);if(r&&c){let g=this._pts.getCoordinate(this._start),y=i._pts.getCoordinate(i._start);f[0]=new Sn(this._geom,this._start,new w(g)),f[1]=new Sn(i._geom,i._start,new w(y))}else if(r){let g=this._pts.getCoordinate(this._start);this.computeDistancePointLine(g,i,f)}else if(c){let g=i._pts.getCoordinate(i._start);this.computeDistancePointLine(g,this,f);let y=f[0];f[0]=f[1],f[1]=y}else this.computeDistanceLineLine(i,f);return f}getEnvelope(){let i=new K;for(let r=this._start;r<this._end;r++)i.expandToInclude(this._pts.getX(r),this._pts.getY(r));return i}}class Fr{static addFacetSequences(i,r,c){let f=0,g=r.size();for(;f<=g-1;){let y=f+Fr.FACET_SEQUENCE_SIZE+1;y>=g-1&&(y=g);let S=new Yu(i,r,f,y);c.add(S),f+=Fr.FACET_SEQUENCE_SIZE}}static build(i){let r=new Kt(Fr.STR_TREE_NODE_CAPACITY);for(let c=Fr.computeFacetSequences(i).iterator();c.hasNext();){let f=c.next();r.insert(f.getEnvelope(),f)}return r.build(),r}static computeFacetSequences(i){let r=new M;return i.apply(new class{get interfaces_(){return[Pe]}filter(c){let f=null;(c instanceof Z||c instanceof yt)&&(f=c.getCoordinateSequence(),Fr.addFacetSequences(c,f,r))}}),r}}Fr.FACET_SEQUENCE_SIZE=6,Fr.STR_TREE_NODE_CAPACITY=4;class jl{constructor(){jl.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._minClearance=null,this._minClearancePts=null;let i=arguments[0];this._inputGeom=i}static getDistance(i){return new jl(i).getDistance()}static getLine(i){return new jl(i).getLine()}getDistance(){return this.compute(),this._minClearance}compute(){if(this._minClearancePts!==null||(this._minClearancePts=new Array(2).fill(null),this._minClearance=l.MAX_VALUE,this._inputGeom.isEmpty()))return null;let i=Fr.build(this._inputGeom).nearestNeighbour(new Xu),r=new Xu;this._minClearance=r.distance(i[0],i[1]),this._minClearancePts=r.getCoordinates()}getLine(){return this.compute(),this._minClearancePts===null||this._minClearancePts[0]===null?this._inputGeom.getFactory().createLineString():this._inputGeom.getFactory().createLineString(this._minClearancePts)}}class Xu{constructor(){Xu.constructor_.apply(this,arguments)}static constructor_(){this._minDist=l.MAX_VALUE,this._minPts=new Array(2).fill(null)}vertexDistance(i,r){for(let c=0;c<i.size();c++)for(let f=0;f<r.size();f++){let g=i.getCoordinate(c),y=r.getCoordinate(f);if(!g.equals2D(y)){let S=g.distance(y);if(S<this._minDist&&(this._minDist=S,this._minPts[0]=g,this._minPts[1]=y,S===0))return S}}return this._minDist}getCoordinates(){return this._minPts}segmentDistance(i,r){for(let c=0;c<i.size();c++)for(let f=1;f<r.size();f++){let g=i.getCoordinate(c),y=r.getCoordinate(f-1),S=r.getCoordinate(f);if(!g.equals2D(y)&&!g.equals2D(S)){let I=qe.pointToSegment(g,y,S);if(I<this._minDist&&(this._minDist=I,this.updatePts(g,y,S),I===0))return I}}return this._minDist}distance(){if(arguments[0]instanceof ns&&arguments[1]instanceof ns){let i=arguments[1],r=arguments[0].getItem(),c=i.getItem();return this._minDist=l.MAX_VALUE,this.distance(r,c)}if(arguments[0]instanceof Yu&&arguments[1]instanceof Yu){let i=arguments[0],r=arguments[1];return this.vertexDistance(i,r),i.size()===1&&r.size()===1?this._minDist:this._minDist<=0?this._minDist:(this.segmentDistance(i,r),this._minDist<=0||this.segmentDistance(r,i),this._minDist)}}updatePts(i,r,c){this._minPts[0]=i;let f=new Ze(r,c);this._minPts[1]=new w(f.closestPoint(i))}get interfaces_(){return[yS]}}jl.MinClearanceDistance=Xu;class Aa{constructor(){Aa.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._minClearance=null,this._minClearancePts=null;let i=arguments[0];this._inputGeom=i}static getDistance(i){return new Aa(i).getDistance()}static getLine(i){return new Aa(i).getLine()}getDistance(){return this.compute(),this._minClearance}compute(){if(this._minClearancePts!==null)return null;this._minClearancePts=new Array(2).fill(null),this._minClearance=l.MAX_VALUE,this._inputGeom.apply(new Qf(this))}updateClearance(){if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];i<this._minClearance&&(this._minClearance=i,this._minClearancePts[0]=new w(r),this._minClearancePts[1]=new w(c))}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];if(i<this._minClearance){this._minClearance=i,this._minClearancePts[0]=new w(r);let g=new Ze(c,f);this._minClearancePts[1]=new w(g.closestPoint(r))}}}getLine(){return this.compute(),this._inputGeom.getFactory().createLineString(this._minClearancePts)}}class Qf{constructor(){Qf.constructor_.apply(this,arguments)}static constructor_(){this.smc=null;let i=arguments[0];this.smc=i}filter(i){this.smc._inputGeom.apply(new Kf(this.smc,i))}get interfaces_(){return[ge]}}class Kf{constructor(){Kf.constructor_.apply(this,arguments)}static constructor_(){this.smc=null,this._queryPt=null;let i=arguments[0],r=arguments[1];this.smc=i,this._queryPt=r}filter(i,r){this.checkVertexDistance(i.getCoordinate(r)),r>0&&this.checkSegmentDistance(i.getCoordinate(r-1),i.getCoordinate(r))}checkSegmentDistance(i,r){if(this._queryPt.equals2D(i)||this._queryPt.equals2D(r))return null;let c=qe.pointToSegment(this._queryPt,r,i);c>0&&this.smc.updateClearance(c,this._queryPt,r,i)}isDone(){return!1}isGeometryChanged(){return!1}checkVertexDistance(i){let r=i.distance(this._queryPt);r>0&&this.smc.updateClearance(r,this._queryPt,i)}get interfaces_(){return[X]}}Aa.VertexCoordinateFilter=Qf,Aa.ComputeMCCoordinateSequenceFilter=Kf;var BP=Object.freeze({__proto__:null,CommonBits:qs,CommonBitsOp:Pr,CommonBitsRemover:Eo,EnhancedPrecisionOp:class{static union(A,i){let r=null;try{return Fu.union(A,i)}catch(c){if(!(c instanceof h))throw c;r=c}try{let c=new Pr(!0).union(A,i);if(!c.isValid())throw r;return c}catch(c){throw c instanceof h?r:c}}static intersection(A,i){let r=null;try{return We.intersection(A,i)}catch(c){if(!(c instanceof h))throw c;r=c}try{let c=new Pr(!0).intersection(A,i);if(!c.isValid())throw r;return c}catch(c){throw c instanceof h?r:c}}static buffer(A,i){let r=null;try{return Ht.bufferOp(A,i)}catch(c){if(!(c instanceof h))throw c;r=c}try{let c=new Pr(!0).buffer(A,i);if(!c.isValid())throw r;return c}catch(c){throw c instanceof h?r:c}}static symDifference(A,i){let r=null;try{return We.symDifference(A,i)}catch(c){if(!(c instanceof h))throw c;r=c}try{let c=new Pr(!0).symDifference(A,i);if(!c.isValid())throw r;return c}catch(c){throw c instanceof h?r:c}}static difference(A,i){let r=null;try{return We.difference(A,i)}catch(c){if(!(c instanceof h))throw c;r=c}try{let c=new Pr(!0).difference(A,i);if(!c.isValid())throw r;return c}catch(c){throw c instanceof h?r:c}}},GeometryPrecisionReducer:Wu,MinimumClearance:jl,SimpleMinimumClearance:Aa});class Jf{constructor(){Jf.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._usePt=null,this._distanceTolerance=null,this._seg=new Ze;let i=arguments[0];this._pts=i}static simplify(i,r){let c=new Jf(i);return c.setDistanceTolerance(r),c.simplify()}setDistanceTolerance(i){this._distanceTolerance=i}simplifySection(i,r){if(i+1===r)return null;this._seg.p0=this._pts[i],this._seg.p1=this._pts[r];let c=-1,f=i;for(let g=i+1;g<r;g++){let y=this._seg.distance(this._pts[g]);y>c&&(c=y,f=g)}if(c<=this._distanceTolerance)for(let g=i+1;g<r;g++)this._usePt[g]=!1;else this.simplifySection(i,f),this.simplifySection(f,r)}simplify(){this._usePt=new Array(this._pts.length).fill(null);for(let r=0;r<this._pts.length;r++)this._usePt[r]=!0;this.simplifySection(0,this._pts.length-1);let i=new E;for(let r=0;r<this._pts.length;r++)this._usePt[r]&&i.add(new w(this._pts[r]));return i.toCoordinateArray()}}class Zu{constructor(){Zu.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;let i=arguments[0];this._inputGeom=i}static simplify(i,r){let c=new Zu(i);return c.setDistanceTolerance(r),c.getResultGeometry()}setDistanceTolerance(i){if(i<0)throw new s("Tolerance must be non-negative");this._distanceTolerance=i}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new ep(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setEnsureValid(i){this._isEnsureValidTopology=i}}class ep extends oe{constructor(){super(),ep.constructor_.apply(this,arguments)}static constructor_(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;let i=arguments[0],r=arguments[1];this._isEnsureValidTopology=i,this._distanceTolerance=r}transformPolygon(i,r){if(i.isEmpty())return null;let c=super.transformPolygon.call(this,i,r);return r instanceof at?c:this.createValidArea(c)}createValidArea(i){return this._isEnsureValidTopology?Ht.bufferOp(i,0):i}transformCoordinates(i,r){let c=i.toCoordinateArray(),f=null;return f=c.length===0?new Array(0).fill(null):Jf.simplify(c,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(f)}transformMultiPolygon(i,r){let c=super.transformMultiPolygon.call(this,i,r);return this.createValidArea(c)}transformLinearRing(i,r){let c=r instanceof Et,f=super.transformLinearRing.call(this,i,r);return!c||f instanceof ae?f:null}}Zu.DPTransformer=ep;class tp extends Ze{constructor(){super(),tp.constructor_.apply(this,arguments)}static constructor_(){if(this._parent=null,this._index=null,arguments.length===2){let i=arguments[0],r=arguments[1];tp.constructor_.call(this,i,r,null,-1)}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];Ze.constructor_.call(this,i,r),this._parent=c,this._index=f}}getParent(){return this._parent}getIndex(){return this._index}}class Oo{constructor(){Oo.constructor_.apply(this,arguments)}static constructor_(){if(this._parentLine=null,this._segs=null,this._resultSegs=new M,this._minimumSize=null,arguments.length===1){let i=arguments[0];Oo.constructor_.call(this,i,2)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._parentLine=i,this._minimumSize=r,this.init()}}static extractCoordinates(i){let r=new Array(i.size()+1).fill(null),c=null;for(let f=0;f<i.size();f++)c=i.get(f),r[f]=c.p0;return r[r.length-1]=c.p1,r}addToResult(i){this._resultSegs.add(i)}asLineString(){return this._parentLine.getFactory().createLineString(Oo.extractCoordinates(this._resultSegs))}getResultSize(){let i=this._resultSegs.size();return i===0?0:i+1}getParentCoordinates(){return this._parentLine.getCoordinates()}getMinimumSize(){return this._minimumSize}asLinearRing(){return this._parentLine.getFactory().createLinearRing(Oo.extractCoordinates(this._resultSegs))}getSegments(){return this._segs}init(){let i=this._parentLine.getCoordinates();this._segs=new Array(i.length-1).fill(null);for(let r=0;r<i.length-1;r++){let c=new tp(i[r],i[r+1],this._parentLine,r);this._segs[r]=c}}getResultCoordinates(){return Oo.extractCoordinates(this._resultSegs)}getParent(){return this._parentLine}getSegment(i){return this._segs[i]}}class ql{constructor(){ql.constructor_.apply(this,arguments)}static constructor_(){this._index=new Dl}add(){if(arguments[0]instanceof Oo){let i=arguments[0].getSegments();for(let r=0;r<i.length;r++){let c=i[r];this.add(c)}}else if(arguments[0]instanceof Ze){let i=arguments[0];this._index.insert(new K(i.p0,i.p1),i)}}query(i){let r=new K(i.p0,i.p1),c=new Py(i);return this._index.query(r,c),c.getItems()}remove(i){this._index.remove(new K(i.p0,i.p1),i)}}class Py{constructor(){Py.constructor_.apply(this,arguments)}static constructor_(){this._querySeg=null,this._items=new M;let i=arguments[0];this._querySeg=i}getItems(){return this._items}visitItem(i){let r=i;K.intersects(r.p0,r.p1,this._querySeg.p0,this._querySeg.p1)&&this._items.add(i)}get interfaces_(){return[Ea]}}class np{constructor(){np.constructor_.apply(this,arguments)}static constructor_(){this._li=new wn,this._inputIndex=new ql,this._outputIndex=new ql,this._line=null,this._linePts=null,this._distanceTolerance=0;let i=arguments[0],r=arguments[1];this._inputIndex=i,this._outputIndex=r}static isInLineSection(i,r,c){if(c.getParent()!==i.getParent())return!1;let f=c.getIndex();return f>=r[0]&&f<r[1]}flatten(i,r){let c=this._linePts[i],f=this._linePts[r],g=new Ze(c,f);return this.remove(this._line,i,r),this._outputIndex.add(g),g}hasBadIntersection(i,r,c){return!!this.hasBadOutputIntersection(c)||!!this.hasBadInputIntersection(i,r,c)}setDistanceTolerance(i){this._distanceTolerance=i}simplifySection(i,r,c){c+=1;let f=new Array(2).fill(null);if(i+1===r){let z=this._line.getSegment(i);return this._line.addToResult(z),null}let g=!0;this._line.getResultSize()<this._line.getMinimumSize()&&c+1<this._line.getMinimumSize()&&(g=!1);let y=new Array(1).fill(null),S=this.findFurthestPoint(this._linePts,i,r,y);y[0]>this._distanceTolerance&&(g=!1);let I=new Ze;if(I.p0=this._linePts[i],I.p1=this._linePts[r],f[0]=i,f[1]=r,this.hasBadIntersection(this._line,f,I)&&(g=!1),g){let z=this.flatten(i,r);return this._line.addToResult(z),null}this.simplifySection(i,S,c),this.simplifySection(S,r,c)}hasBadOutputIntersection(i){for(let r=this._outputIndex.query(i).iterator();r.hasNext();){let c=r.next();if(this.hasInteriorIntersection(c,i))return!0}return!1}hasInteriorIntersection(i,r){return this._li.computeIntersection(i.p0,i.p1,r.p0,r.p1),this._li.isInteriorIntersection()}hasBadInputIntersection(i,r,c){for(let f=this._inputIndex.query(c).iterator();f.hasNext();){let g=f.next();if(this.hasInteriorIntersection(g,c)){if(np.isInLineSection(i,r,g))continue;return!0}}return!1}findFurthestPoint(i,r,c,f){let g=new Ze;g.p0=i[r],g.p1=i[c];let y=-1,S=r;for(let I=r+1;I<c;I++){let z=i[I],ne=g.distance(z);ne>y&&(y=ne,S=I)}return f[0]=y,S}simplify(i){this._line=i,this._linePts=i.getParentCoordinates(),this.simplifySection(0,this._linePts.length-1,0)}remove(i,r,c){for(let f=r;f<c;f++){let g=i.getSegment(f);this._inputIndex.remove(g)}}}class Fy{constructor(){Fy.constructor_.apply(this,arguments)}static constructor_(){this._inputIndex=new ql,this._outputIndex=new ql,this._distanceTolerance=0}setDistanceTolerance(i){this._distanceTolerance=i}simplify(i){for(let r=i.iterator();r.hasNext();)this._inputIndex.add(r.next());for(let r=i.iterator();r.hasNext();){let c=new np(this._inputIndex,this._outputIndex);c.setDistanceTolerance(this._distanceTolerance),c.simplify(r.next())}}}class $l{constructor(){$l.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._lineSimplifier=new Fy,this._linestringMap=null;let i=arguments[0];this._inputGeom=i}static simplify(i,r){let c=new $l(i);return c.setDistanceTolerance(r),c.getResultGeometry()}setDistanceTolerance(i){if(i<0)throw new s("Tolerance must be non-negative");this._lineSimplifier.setDistanceTolerance(i)}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():(this._linestringMap=new _s,this._inputGeom.apply(new sp(this)),this._lineSimplifier.simplify(this._linestringMap.values()),new ip(this._linestringMap).transform(this._inputGeom))}}class ip extends oe{constructor(){super(),ip.constructor_.apply(this,arguments)}static constructor_(){this._linestringMap=null;let i=arguments[0];this._linestringMap=i}transformCoordinates(i,r){if(i.size()===0)return null;if(r instanceof Z){let c=this._linestringMap.get(r);return this.createCoordinateSequence(c.getResultCoordinates())}return super.transformCoordinates.call(this,i,r)}}class sp{constructor(){sp.constructor_.apply(this,arguments)}static constructor_(){this.tps=null;let i=arguments[0];this.tps=i}filter(i){if(i instanceof Z){let r=i;if(r.isEmpty())return null;let c=r.isClosed()?4:2,f=new Oo(r,c);this.tps._linestringMap.put(r,f)}}get interfaces_(){return[Pe]}}$l.LineStringTransformer=ip,$l.LineStringMapBuilderFilter=sp;class Qu{constructor(){Qu.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._tolerance=null;let i=arguments[0],r=arguments[1];this._pts=i,this._tolerance=r*r}static simplify(i,r){return new Qu(i,r).simplify()}simplifyVertex(i){let r=i,c=r.getArea(),f=null;for(;r!==null;){let g=r.getArea();g<c&&(c=g,f=r),r=r._next}return f!==null&&c<this._tolerance&&f.remove(),i.isLive()?c:-1}simplify(){let i=Po.buildLine(this._pts),r=this._tolerance;do r=this.simplifyVertex(i);while(r<this._tolerance);let c=i.getCoordinates();return c.length<2?[c[0],new w(c[0])]:c}}class Po{constructor(){Po.constructor_.apply(this,arguments)}static constructor_(){this._pt=null,this._prev=null,this._next=null,this._area=Po.MAX_AREA,this._isLive=!0;let i=arguments[0];this._pt=i}static buildLine(i){let r=null,c=null;for(let f=0;f<i.length;f++){let g=new Po(i[f]);r===null&&(r=g),g.setPrev(c),c!==null&&(c.setNext(g),c.updateArea()),c=g}return r}getCoordinates(){let i=new E,r=this;do i.add(r._pt,!1),r=r._next;while(r!==null);return i.toCoordinateArray()}getArea(){return this._area}updateArea(){if(this._prev===null||this._next===null)return this._area=Po.MAX_AREA,null;this._area=Math.abs(Gt.area(this._prev._pt,this._pt,this._next._pt))}remove(){let i=this._prev,r=this._next,c=null;return this._prev!==null&&(this._prev.setNext(r),this._prev.updateArea(),c=this._prev),this._next!==null&&(this._next.setPrev(i),this._next.updateArea(),c===null&&(c=this._next)),this._isLive=!1,c}isLive(){return this._isLive}setPrev(i){this._prev=i}setNext(i){this._next=i}}Po.MAX_AREA=l.MAX_VALUE,Qu.VWVertex=Po;class Ku{constructor(){Ku.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;let i=arguments[0];this._inputGeom=i}static simplify(i,r){let c=new Ku(i);return c.setDistanceTolerance(r),c.getResultGeometry()}setDistanceTolerance(i){if(i<0)throw new s("Tolerance must be non-negative");this._distanceTolerance=i}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new rp(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setEnsureValid(i){this._isEnsureValidTopology=i}}class rp extends oe{constructor(){super(),rp.constructor_.apply(this,arguments)}static constructor_(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;let i=arguments[0],r=arguments[1];this._isEnsureValidTopology=i,this._distanceTolerance=r}transformPolygon(i,r){if(i.isEmpty())return null;let c=super.transformPolygon.call(this,i,r);return r instanceof at?c:this.createValidArea(c)}createValidArea(i){return this._isEnsureValidTopology?Ht.bufferOp(i,0):i}transformCoordinates(i,r){let c=i.toCoordinateArray(),f=null;return f=c.length===0?new Array(0).fill(null):Qu.simplify(c,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(f)}transformMultiPolygon(i,r){let c=super.transformMultiPolygon.call(this,i,r);return this.createValidArea(c)}transformLinearRing(i,r){let c=r instanceof Et,f=super.transformLinearRing.call(this,i,r);return!c||f instanceof ae?f:null}}Ku.VWTransformer=rp;var UP=Object.freeze({__proto__:null,DouglasPeuckerSimplifier:Zu,TopologyPreservingSimplifier:$l,VWSimplifier:Ku});class zP{locate(i){}}class op{constructor(){op.constructor_.apply(this,arguments)}static constructor_(){this._subdiv=null,this._lastEdge=null;let i=arguments[0];this._subdiv=i,this.init()}init(){this._lastEdge=this.findEdge()}locate(i){this._lastEdge.isLive()||this.init();let r=this._subdiv.locateFromEdge(i,this._lastEdge);return this._lastEdge=r,r}findEdge(){return this._subdiv.getEdges().iterator().next()}get interfaces_(){return[zP]}}class Oa{constructor(){Oa.constructor_.apply(this,arguments)}static constructor_(){if(this._ls=null,this._data=null,arguments.length===2){let i=arguments[0],r=arguments[1];this._ls=new Ze(i,r)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._ls=new Ze(i,r),this._data=c}else if(arguments.length===6){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5];Oa.constructor_.call(this,new w(i,r,c),new w(f,g,y))}else if(arguments.length===7){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=arguments[4],y=arguments[5],S=arguments[6];Oa.constructor_.call(this,new w(i,r,c),new w(f,g,y),S)}}getStartZ(){return this._ls.getCoordinate(0).getZ()}intersection(i){return this._ls.intersection(i.getLineSegment())}getStart(){return this._ls.getCoordinate(0)}getEnd(){return this._ls.getCoordinate(1)}getEndY(){return this._ls.getCoordinate(1).y}getStartX(){return this._ls.getCoordinate(0).x}setData(i){this._data=i}getData(){return this._data}getEndX(){return this._ls.getCoordinate(1).x}toString(){return this._ls.toString()}getLineSegment(){return this._ls}getEndZ(){return this._ls.getCoordinate(1).getZ()}equalsTopo(i){return this._ls.equalsTopo(i.getLineSegment())}getStartY(){return this._ls.getCoordinate(0).y}}class Ju{constructor(){Ju.constructor_.apply(this,arguments)}static constructor_(){this._seg=null,this._segLen=null,this._splitPt=null,this._minimumLen=0;let i=arguments[0];this._seg=i,this._segLen=i.getLength()}static pointAlongReverse(i,r){let c=new w;return c.x=i.p1.x-r*(i.p1.x-i.p0.x),c.y=i.p1.y-r*(i.p1.y-i.p0.y),c}splitAt(){if(arguments.length===1){let i=arguments[0],r=this._minimumLen/this._segLen;if(i.distance(this._seg.p0)<this._minimumLen)return this._splitPt=this._seg.pointAlong(r),null;if(i.distance(this._seg.p1)<this._minimumLen)return this._splitPt=Ju.pointAlongReverse(this._seg,r),null;this._splitPt=i}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=this.getConstrainedLength(i)/this._segLen;r.equals2D(this._seg.p0)?this._splitPt=this._seg.pointAlong(c):this._splitPt=Ju.pointAlongReverse(this._seg,c)}}getSplitPoint(){return this._splitPt}getConstrainedLength(i){return i<this._minimumLen?this._minimumLen:i}setMinimumLength(i){this._minimumLen=i}}class VP{findSplitPoint(i,r){}}class Dy{static projectedSplitPoint(i,r){return i.getLineSegment().project(r)}findSplitPoint(i,r){let c=i.getLineSegment(),f=c.getLength()/2,g=new Ju(c),y=Dy.projectedSplitPoint(i,r),S=2*y.distance(r)*.8;return S>f&&(S=f),g.setMinimumLength(S),g.splitAt(y),g.getSplitPoint()}get interfaces_(){return[VP]}}class Xn{static checkRobustInCircle(i,r,c,f){let g=Xn.isInCircleNonRobust(i,r,c,f),y=Xn.isInCircleDDSlow(i,r,c,f),S=Xn.isInCircleCC(i,r,c,f),I=Gt.circumcentre(i,r,c);Fe.out.println("p radius diff a = "+Math.abs(f.distance(I)-i.distance(I))/i.distance(I)),g===y&&g===S||(Fe.out.println("inCircle robustness failure (double result = "+g+", DD result = "+y+", CC result = "+S+")"),Fe.out.println(rn.toLineString(new de([i,r,c,f]))),Fe.out.println("Circumcentre = "+rn.toPoint(I)+" radius = "+i.distance(I)),Fe.out.println("p radius diff a = "+Math.abs(f.distance(I)/i.distance(I)-1)),Fe.out.println("p radius diff b = "+Math.abs(f.distance(I)/r.distance(I)-1)),Fe.out.println("p radius diff c = "+Math.abs(f.distance(I)/c.distance(I)-1)),Fe.out.println())}static isInCircleDDFast(i,r,c,f){let g=U.sqr(i.x).selfAdd(U.sqr(i.y)).selfMultiply(Xn.triAreaDDFast(r,c,f)),y=U.sqr(r.x).selfAdd(U.sqr(r.y)).selfMultiply(Xn.triAreaDDFast(i,c,f)),S=U.sqr(c.x).selfAdd(U.sqr(c.y)).selfMultiply(Xn.triAreaDDFast(i,r,f)),I=U.sqr(f.x).selfAdd(U.sqr(f.y)).selfMultiply(Xn.triAreaDDFast(i,r,c));return g.selfSubtract(y).selfAdd(S).selfSubtract(I).doubleValue()>0}static isInCircleCC(i,r,c,f){let g=Gt.circumcentre(i,r,c),y=i.distance(g);return f.distance(g)-y<=0}static isInCircleNormalized(i,r,c,f){let g=i.x-f.x,y=i.y-f.y,S=r.x-f.x,I=r.y-f.y,z=c.x-f.x,ne=c.y-f.y;return(g*g+y*y)*(S*ne-z*I)+(S*S+I*I)*(z*y-g*ne)+(z*z+ne*ne)*(g*I-S*y)>0}static isInCircleDDSlow(i,r,c,f){let g=U.valueOf(f.x),y=U.valueOf(f.y),S=U.valueOf(i.x),I=U.valueOf(i.y),z=U.valueOf(r.x),ne=U.valueOf(r.y),he=U.valueOf(c.x),Ie=U.valueOf(c.y),Oe=S.multiply(S).add(I.multiply(I)).multiply(Xn.triAreaDDSlow(z,ne,he,Ie,g,y)),Ue=z.multiply(z).add(ne.multiply(ne)).multiply(Xn.triAreaDDSlow(S,I,he,Ie,g,y)),ut=he.multiply(he).add(Ie.multiply(Ie)).multiply(Xn.triAreaDDSlow(S,I,z,ne,g,y)),cn=g.multiply(g).add(y.multiply(y)).multiply(Xn.triAreaDDSlow(S,I,z,ne,he,Ie));return Oe.subtract(Ue).add(ut).subtract(cn).doubleValue()>0}static isInCircleNonRobust(i,r,c,f){return(i.x*i.x+i.y*i.y)*Xn.triArea(r,c,f)-(r.x*r.x+r.y*r.y)*Xn.triArea(i,c,f)+(c.x*c.x+c.y*c.y)*Xn.triArea(i,r,f)-(f.x*f.x+f.y*f.y)*Xn.triArea(i,r,c)>0}static isInCircleRobust(i,r,c,f){return Xn.isInCircleNormalized(i,r,c,f)}static triAreaDDSlow(i,r,c,f,g,y){return c.subtract(i).multiply(y.subtract(r)).subtract(f.subtract(r).multiply(g.subtract(i)))}static triAreaDDFast(i,r,c){let f=U.valueOf(r.x).selfSubtract(i.x).selfMultiply(U.valueOf(c.y).selfSubtract(i.y)),g=U.valueOf(r.y).selfSubtract(i.y).selfMultiply(U.valueOf(c.x).selfSubtract(i.x));return f.selfSubtract(g)}static triArea(i,r,c){return(r.x-i.x)*(c.y-i.y)-(r.y-i.y)*(c.x-i.x)}static isInCircleDDNormalized(i,r,c,f){let g=U.valueOf(i.x).selfSubtract(f.x),y=U.valueOf(i.y).selfSubtract(f.y),S=U.valueOf(r.x).selfSubtract(f.x),I=U.valueOf(r.y).selfSubtract(f.y),z=U.valueOf(c.x).selfSubtract(f.x),ne=U.valueOf(c.y).selfSubtract(f.y),he=g.multiply(I).selfSubtract(S.multiply(y)),Ie=S.multiply(ne).selfSubtract(z.multiply(I)),Oe=z.multiply(y).selfSubtract(g.multiply(ne)),Ue=g.multiply(g).selfAdd(y.multiply(y)),ut=S.multiply(S).selfAdd(I.multiply(I)),cn=z.multiply(z).selfAdd(ne.multiply(ne));return Ue.selfMultiply(Ie).selfAdd(ut.selfMultiply(Oe)).selfAdd(cn.selfMultiply(he)).doubleValue()>0}}class Tt{constructor(){Tt.constructor_.apply(this,arguments)}static constructor_(){if(this._p=null,arguments.length===1){let i=arguments[0];this._p=new w(i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._p=new w(i,r)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._p=new w(i,r,c)}}static interpolateZ(){if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2],f=r.distance(c),g=i.distance(r),y=c.getZ()-r.getZ();return r.getZ()+y*(g/f)}if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3],g=r.x,y=r.y,S=c.x-g,I=f.x-g,z=c.y-y,ne=f.y-y,he=S*ne-I*z,Ie=i.x-g,Oe=i.y-y,Ue=(ne*Ie-I*Oe)/he,ut=(-z*Ie+S*Oe)/he;return r.getZ()+Ue*(c.getZ()-r.getZ())+ut*(f.getZ()-r.getZ())}}magn(){return Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y)}equals(){if(arguments.length===1){let i=arguments[0];return this._p.x===i.getX()&&this._p.y===i.getY()}if(arguments.length===2){let i=arguments[0],r=arguments[1];return this._p.distance(i.getCoordinate())<r}}rightOf(i){return this.isCCW(i.dest(),i.orig())}isCCW(i,r){return(i._p.x-this._p.x)*(r._p.y-this._p.y)-(i._p.y-this._p.y)*(r._p.x-this._p.x)>0}getX(){return this._p.x}crossProduct(i){return this._p.x*i.getY()-this._p.y*i.getX()}setZ(i){this._p.setZ(i)}times(i){return new Tt(i*this._p.x,i*this._p.y)}cross(){return new Tt(this._p.y,-this._p.x)}leftOf(i){return this.isCCW(i.orig(),i.dest())}getY(){return this._p.y}classify(i,r){let c=this,f=r.sub(i),g=c.sub(i),y=f.crossProduct(g);return y>0?Tt.LEFT:y<0?Tt.RIGHT:f.getX()*g.getX()<0||f.getY()*g.getY()<0?Tt.BEHIND:f.magn()<g.magn()?Tt.BEYOND:i.equals(c)?Tt.ORIGIN:r.equals(c)?Tt.DESTINATION:Tt.BETWEEN}circumRadiusRatio(i,r){let c=this.circleCenter(i,r),f=this.distance(c,i),g=this.distance(this,i),y=this.distance(i,r);return y<g&&(g=y),y=this.distance(r,this),y<g&&(g=y),f/g}circleCenter(i,r){let c=new Tt(this.getX(),this.getY()),f=this.bisector(c,i),g=this.bisector(i,r),y=new Ni(f,g),S=null;try{S=new Tt(y.getX(),y.getY())}catch(I){if(!(I instanceof Ds))throw I;Fe.err.println("a: "+c+"  b: "+i+"  c: "+r),Fe.err.println(I)}return S}dot(i){return this._p.x*i.getX()+this._p.y*i.getY()}getZ(){return this._p.getZ()}bisector(i,r){let c=r.getX()-i.getX(),f=r.getY()-i.getY(),g=new Ni(i.getX()+c/2,i.getY()+f/2,1),y=new Ni(i.getX()-f+c/2,i.getY()+c+f/2,1);return new Ni(g,y)}getCoordinate(){return this._p}isInCircle(i,r,c){return Xn.isInCircleRobust(i._p,r._p,c._p,this._p)}interpolateZValue(i,r,c){let f=i.getX(),g=i.getY(),y=r.getX()-f,S=c.getX()-f,I=r.getY()-g,z=c.getY()-g,ne=y*z-S*I,he=this.getX()-f,Ie=this.getY()-g,Oe=(z*he-S*Ie)/ne,Ue=(-I*he+y*Ie)/ne;return i.getZ()+Oe*(r.getZ()-i.getZ())+Ue*(c.getZ()-i.getZ())}midPoint(i){let r=(this._p.x+i.getX())/2,c=(this._p.y+i.getY())/2,f=(this._p.getZ()+i.getZ())/2;return new Tt(r,c,f)}toString(){return"POINT ("+this._p.x+" "+this._p.y+")"}sub(i){return new Tt(this._p.x-i.getX(),this._p.y-i.getY())}sum(i){return new Tt(this._p.x+i.getX(),this._p.y+i.getY())}distance(i,r){return Math.sqrt(Math.pow(r.getX()-i.getX(),2)+Math.pow(r.getY()-i.getY(),2))}}Tt.LEFT=0,Tt.RIGHT=1,Tt.BEYOND=2,Tt.BEHIND=3,Tt.BETWEEN=4,Tt.ORIGIN=5,Tt.DESTINATION=6;class Pa extends Tt{constructor(){super(),Pa.constructor_.apply(this,arguments)}static constructor_(){this._isOnConstraint=null,this._constraint=null;let i=arguments[0];Tt.constructor_.call(this,i)}getConstraint(){return this._constraint}setOnConstraint(i){this._isOnConstraint=i}setConstraint(i){this._isOnConstraint=!0,this._constraint=i}merge(i){i._isOnConstraint&&(this._isOnConstraint=!0,this._constraint=i._constraint)}isOnConstraint(){return this._isOnConstraint}}class ln{constructor(){ln.constructor_.apply(this,arguments)}static constructor_(){this._rot=null,this._vertex=null,this._next=null,this._data=null}static swap(i){let r=i.oPrev(),c=i.sym().oPrev();ln.splice(i,r),ln.splice(i.sym(),c),ln.splice(i,r.lNext()),ln.splice(i.sym(),c.lNext()),i.setOrig(r.dest()),i.setDest(c.dest())}static splice(i,r){let c=i.oNext().rot(),f=r.oNext().rot(),g=r.oNext(),y=i.oNext(),S=f.oNext(),I=c.oNext();i.setNext(g),r.setNext(y),c.setNext(S),f.setNext(I)}static makeEdge(i,r){let c=new ln,f=new ln,g=new ln,y=new ln;c._rot=f,f._rot=g,g._rot=y,y._rot=c,c.setNext(c),f.setNext(y),g.setNext(g),y.setNext(f);let S=c;return S.setOrig(i),S.setDest(r),S}static connect(i,r){let c=ln.makeEdge(i.dest(),r.orig());return ln.splice(c,i.lNext()),ln.splice(c.sym(),r),c}equalsNonOriented(i){return!!this.equalsOriented(i)||!!this.equalsOriented(i.sym())}oNext(){return this._next}equalsOriented(i){return!(!this.orig().getCoordinate().equals2D(i.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(i.dest().getCoordinate()))}dNext(){return this.sym().oNext().sym()}lPrev(){return this._next.sym()}rPrev(){return this.sym().oNext()}rot(){return this._rot}oPrev(){return this._rot._next._rot}sym(){return this._rot._rot}setOrig(i){this._vertex=i}lNext(){return this.invRot().oNext().rot()}getLength(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())}setData(i){this._data=i}getData(){return this._data}delete(){this._rot=null}toString(){let i=this._vertex.getCoordinate(),r=this.dest().getCoordinate();return rn.toLineString(i,r)}isLive(){return this._rot!==null}getPrimary(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()}toLineSegment(){return new Ze(this._vertex.getCoordinate(),this.dest().getCoordinate())}dest(){return this.sym().orig()}invRot(){return this._rot.sym()}setDest(i){this.sym().setOrig(i)}orig(){return this._vertex}rNext(){return this._rot._next.invRot()}dPrev(){return this.invRot().oNext().invRot()}setNext(i){this._next=i}}class ed{constructor(){ed.constructor_.apply(this,arguments)}static constructor_(){this._subdiv=null,this._isUsingTolerance=!1;let i=arguments[0];this._subdiv=i,this._isUsingTolerance=i.getTolerance()>0}insertSite(i){let r=this._subdiv.locate(i);if(this._subdiv.isVertexOfEdge(r,i))return r;this._subdiv.isOnEdge(r,i.getCoordinate())&&(r=r.oPrev(),this._subdiv.delete(r.oNext()));let c=this._subdiv.makeEdge(r.orig(),i);ln.splice(c,r);let f=c;do c=this._subdiv.connect(r,c.sym()),r=c.oPrev();while(r.lNext()!==f);for(;;){let g=r.oPrev();if(g.dest().rightOf(r)&&i.isInCircle(r.orig(),g.dest(),r.dest()))ln.swap(r),r=r.oPrev();else{if(r.oNext()===f)return c;r=r.oNext().lPrev()}}}insertSites(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this.insertSite(c)}}}class ap extends h{constructor(){super(),ap.constructor_.apply(this,arguments)}static constructor_(){if(this._seg=null,arguments.length===1){if(typeof arguments[0]=="string"){let i=arguments[0];h.constructor_.call(this,i)}else if(arguments[0]instanceof Ze){let i=arguments[0];h.constructor_.call(this,"Locate failed to converge (at edge: "+i+").  Possible causes include invalid Subdivision topology or very close sites"),this._seg=new Ze(i)}}else if(arguments.length===2){let i=arguments[0],r=arguments[1];h.constructor_.call(this,ap.msgWithSpatial(i,r)),this._seg=new Ze(r)}}static msgWithSpatial(i,r){return r!==null?i+" [ "+r+" ]":i}getSegment(){return this._seg}}class lp{visit(i){}}class ls{constructor(){ls.constructor_.apply(this,arguments)}static constructor_(){this._visitedKey=0,this._quadEdges=new M,this._startingEdge=null,this._tolerance=null,this._edgeCoincidenceTolerance=null,this._frameVertex=new Array(3).fill(null),this._frameEnv=null,this._locator=null,this._seg=new Ze,this._triEdges=new Array(3).fill(null);let i=arguments[0],r=arguments[1];this._tolerance=r,this._edgeCoincidenceTolerance=r/ls.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(i),this._startingEdge=this.initSubdiv(),this._locator=new op(this)}static getTriangleEdges(i,r){if(r[0]=i,r[1]=r[0].lNext(),r[2]=r[1].lNext(),r[2].lNext()!==r[0])throw new s("Edges do not form a triangle")}getTriangleVertices(i){let r=new up;return this.visitTriangles(r,i),r.getTriangleVertices()}isFrameVertex(i){return!!i.equals(this._frameVertex[0])||!!i.equals(this._frameVertex[1])||!!i.equals(this._frameVertex[2])}isVertexOfEdge(i,r){return!(!r.equals(i.orig(),this._tolerance)&&!r.equals(i.dest(),this._tolerance))}connect(i,r){let c=ln.connect(i,r);return this._quadEdges.add(c),c}visitTriangles(i,r){this._visitedKey++;let c=new Ia;c.push(this._startingEdge);let f=new xn;for(;!c.empty();){let g=c.pop();if(!f.contains(g)){let y=this.fetchTriangleToVisit(g,c,r,f);y!==null&&i.visit(y)}}}isFrameEdge(i){return!(!this.isFrameVertex(i.orig())&&!this.isFrameVertex(i.dest()))}isOnEdge(i,r){return this._seg.setCoordinates(i.orig().getCoordinate(),i.dest().getCoordinate()),this._seg.distance(r)<this._edgeCoincidenceTolerance}getEnvelope(){return new K(this._frameEnv)}getVertexUniqueEdges(i){let r=new M,c=new xn;for(let f=this._quadEdges.iterator();f.hasNext();){let g=f.next(),y=g.orig();c.contains(y)||(c.add(y),!i&&this.isFrameVertex(y)||r.add(g));let S=g.sym(),I=S.orig();c.contains(I)||(c.add(I),!i&&this.isFrameVertex(I)||r.add(S))}return r}locateFromEdge(i,r){let c=0,f=this._quadEdges.size(),g=r;for(;;){if(c++,c>f)throw new ap(g.toLineSegment());if(i.equals(g.orig())||i.equals(g.dest()))break;if(i.rightOf(g))g=g.sym();else if(i.rightOf(g.oNext())){if(i.rightOf(g.dPrev()))break;g=g.dPrev()}else g=g.oNext()}return g}getVoronoiDiagram(i){let r=this.getVoronoiCellPolygons(i);return i.createGeometryCollection(vt.toGeometryArray(r))}getTriangles(i){let r=this.getTriangleCoordinates(!1),c=new Array(r.size()).fill(null),f=0;for(let g=r.iterator();g.hasNext();){let y=g.next();c[f++]=i.createPolygon(i.createLinearRing(y))}return i.createGeometryCollection(c)}getVoronoiCellPolygon(i,r){let c=new M,f=i;do{let z=i.rot().orig().getCoordinate();c.add(z),i=i.oPrev()}while(i!==f);let g=new E;g.addAll(c,!1),g.closeRing(),g.size()<4&&(Fe.out.println(g),g.add(g.get(g.size()-1),!0));let y=g.toCoordinateArray(),S=r.createPolygon(r.createLinearRing(y)),I=f.orig();return S.setUserData(I.getCoordinate()),S}setLocator(i){this._locator=i}initSubdiv(){let i=this.makeEdge(this._frameVertex[0],this._frameVertex[1]),r=this.makeEdge(this._frameVertex[1],this._frameVertex[2]);ln.splice(i.sym(),r);let c=this.makeEdge(this._frameVertex[2],this._frameVertex[0]);return ln.splice(r.sym(),c),ln.splice(c.sym(),i),i}isFrameBorderEdge(i){let r=new Array(3).fill(null);ls.getTriangleEdges(i,r);let c=new Array(3).fill(null);ls.getTriangleEdges(i.sym(),c);let f=i.lNext().dest();if(this.isFrameVertex(f))return!0;let g=i.sym().lNext().dest();return!!this.isFrameVertex(g)}makeEdge(i,r){let c=ln.makeEdge(i,r);return this._quadEdges.add(c),c}createFrame(i){let r=i.getWidth(),c=i.getHeight(),f=0;f=r>c?10*r:10*c,this._frameVertex[0]=new Tt((i.getMaxX()+i.getMinX())/2,i.getMaxY()+f),this._frameVertex[1]=new Tt(i.getMinX()-f,i.getMinY()-f),this._frameVertex[2]=new Tt(i.getMaxX()+f,i.getMinY()-f),this._frameEnv=new K(this._frameVertex[0].getCoordinate(),this._frameVertex[1].getCoordinate()),this._frameEnv.expandToInclude(this._frameVertex[2].getCoordinate())}getTriangleCoordinates(i){let r=new dp;return this.visitTriangles(r,i),r.getTriangles()}getVertices(i){let r=new xn;for(let c=this._quadEdges.iterator();c.hasNext();){let f=c.next(),g=f.orig();!i&&this.isFrameVertex(g)||r.add(g);let y=f.dest();!i&&this.isFrameVertex(y)||r.add(y)}return r}fetchTriangleToVisit(i,r,c,f){let g=i,y=0,S=!1;do{this._triEdges[y]=g,this.isFrameEdge(g)&&(S=!0);let I=g.sym();f.contains(I)||r.push(I),f.add(g),y++,g=g.lNext()}while(g!==i);return S&&!c?null:this._triEdges}getEdges(){if(arguments.length===0)return this._quadEdges;if(arguments.length===1){let i=arguments[0],r=this.getPrimaryEdges(!1),c=new Array(r.size()).fill(null),f=0;for(let g=r.iterator();g.hasNext();){let y=g.next();c[f++]=i.createLineString([y.orig().getCoordinate(),y.dest().getCoordinate()])}return i.createMultiLineString(c)}}getTriangleEdges(i){let r=new cp;return this.visitTriangles(r,i),r.getTriangleEdges()}getPrimaryEdges(i){this._visitedKey++;let r=new M,c=new Ia;c.push(this._startingEdge);let f=new xn;for(;!c.empty();){let g=c.pop();if(!f.contains(g)){let y=g.getPrimary();!i&&this.isFrameEdge(y)||r.add(y),c.push(g.oNext()),c.push(g.sym().oNext()),f.add(g),f.add(g.sym())}}return r}delete(i){ln.splice(i,i.oPrev()),ln.splice(i.sym(),i.sym().oPrev());let r=i.sym(),c=i.rot(),f=i.rot().sym();this._quadEdges.remove(i),this._quadEdges.remove(r),this._quadEdges.remove(c),this._quadEdges.remove(f),i.delete(),r.delete(),c.delete(),f.delete()}getTolerance(){return this._tolerance}getVoronoiCellPolygons(i){this.visitTriangles(new kS,!0);let r=new M;for(let c=this.getVertexUniqueEdges(!1).iterator();c.hasNext();){let f=c.next();r.add(this.getVoronoiCellPolygon(f,i))}return r}insertSite(i){let r=this.locate(i);if(i.equals(r.orig(),this._tolerance)||i.equals(r.dest(),this._tolerance))return r;let c=this.makeEdge(r.orig(),i);ln.splice(c,r);let f=c;do c=this.connect(r,c.sym()),r=c.oPrev();while(r.lNext()!==f);return f}locate(){if(arguments.length===1){if(arguments[0]instanceof Tt){let i=arguments[0];return this._locator.locate(i)}if(arguments[0]instanceof w){let i=arguments[0];return this._locator.locate(new Tt(i))}}else if(arguments.length===2){let i=arguments[0],r=arguments[1],c=this._locator.locate(new Tt(i));if(c===null)return null;let f=c;c.dest().getCoordinate().equals2D(i)&&(f=c.sym());let g=f;do{if(g.dest().getCoordinate().equals2D(r))return g;g=g.oNext()}while(g!==f);return null}}}class kS{visit(i){let r=i[0].orig().getCoordinate(),c=i[1].orig().getCoordinate(),f=i[2].orig().getCoordinate(),g=Gt.circumcentreDD(r,c,f),y=new Tt(g);for(let S=0;S<3;S++)i[S].rot().setOrig(y)}get interfaces_(){return[lp]}}class cp{constructor(){cp.constructor_.apply(this,arguments)}static constructor_(){this._triList=new M}getTriangleEdges(){return this._triList}visit(i){this._triList.add(i)}get interfaces_(){return[lp]}}class up{constructor(){up.constructor_.apply(this,arguments)}static constructor_(){this._triList=new M}getTriangleVertices(){return this._triList}visit(i){this._triList.add([i[0].orig(),i[1].orig(),i[2].orig()])}get interfaces_(){return[lp]}}class dp{constructor(){dp.constructor_.apply(this,arguments)}static constructor_(){this._coordList=new E,this._triCoords=new M}checkTriangleSize(i){i.length>=2?rn.toLineString(i[0],i[1]):i.length>=1&&rn.toPoint(i[0])}visit(i){this._coordList.clear();for(let r=0;r<3;r++){let c=i[r].orig();this._coordList.add(c.getCoordinate())}if(this._coordList.size()>0){this._coordList.closeRing();let r=this._coordList.toCoordinateArray();if(r.length!==4)return null;this._triCoords.add(r)}}getTriangles(){return this._triCoords}get interfaces_(){return[lp]}}ls.TriangleCircumcentreVisitor=kS,ls.TriangleEdgesListVisitor=cp,ls.TriangleVertexListVisitor=up,ls.TriangleCoordinatesVisitor=dp,ls.EDGE_COINCIDENCE_TOL_FACTOR=1e3;class hp extends h{constructor(){super(),hp.constructor_.apply(this,arguments)}static constructor_(){if(this._pt=null,arguments.length===1){let i=arguments[0];h.constructor_.call(this,i)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];h.constructor_.call(this,hp.msgWithCoord(i,r)),this._pt=new w(r)}}static msgWithCoord(i,r){return r!==null?i+" [ "+rn.toPoint(r)+" ]":i}getCoordinate(){return this._pt}}class Fo{constructor(){Fo.constructor_.apply(this,arguments)}static constructor_(){this._initialVertices=null,this._segVertices=null,this._segments=new M,this._subdiv=null,this._incDel=null,this._convexHull=null,this._splitFinder=new Dy,this._kdt=null,this._vertexFactory=null,this._computeAreaEnv=null,this._splitPt=null,this._tolerance=null;let i=arguments[0],r=arguments[1];this._initialVertices=new M(i),this._tolerance=r,this._kdt=new ka(r)}static computeVertexEnvelope(i){let r=new K;for(let c=i.iterator();c.hasNext();){let f=c.next();r.expandToInclude(f.getCoordinate())}return r}getInitialVertices(){return this._initialVertices}getKDT(){return this._kdt}setConstraints(i,r){this._segments=i,this._segVertices=r}computeConvexHull(){let i=new vt,r=this.getPointArray(),c=new Tr(r,i);this._convexHull=c.getConvexHull()}addConstraintVertices(){this.computeConvexHull(),this.insertSites(this._segVertices)}getTolerance(){return this._tolerance}setVertexFactory(i){this._vertexFactory=i}formInitialDelaunay(){this.computeBoundingBox(),this._subdiv=new ls(this._computeAreaEnv,this._tolerance),this._subdiv.setLocator(new op(this._subdiv)),this._incDel=new ed(this._subdiv),this.insertSites(this._initialVertices)}insertSite(){if(arguments[0]instanceof Pa){let i=arguments[0],r=this._kdt.insert(i.getCoordinate(),i);if(r.isRepeated()){let c=r.getData();return c.merge(i),c}return this._incDel.insertSite(i),i}if(arguments[0]instanceof w){let i=arguments[0];this.insertSite(this.createVertex(i))}}enforceConstraints(){this.addConstraintVertices();let i=0,r=0;do r=this.enforceGabriel(this._segments),i++;while(r>0&&i<Fo.MAX_SPLIT_ITER);if(i===Fo.MAX_SPLIT_ITER)throw new hp("Too many splitting iterations while enforcing constraints.  Last split point was at: ",this._splitPt)}insertSites(i){for(let r=i.iterator();r.hasNext();){let c=r.next();this.insertSite(c)}}getVertexFactory(){return this._vertexFactory}getPointArray(){let i=new Array(this._initialVertices.size()+this._segVertices.size()).fill(null),r=0;for(let c=this._initialVertices.iterator();c.hasNext();){let f=c.next();i[r++]=f.getCoordinate()}for(let c=this._segVertices.iterator();c.hasNext();){let f=c.next();i[r++]=f.getCoordinate()}return i}findNonGabrielPoint(i){let r=i.getStart(),c=i.getEnd(),f=new w((r.x+c.x)/2,(r.y+c.y)/2),g=r.distance(f),y=new K(f);y.expandBy(g);let S=this._kdt.query(y),I=null,z=l.MAX_VALUE;for(let ne=S.iterator();ne.hasNext();){let he=ne.next().getCoordinate();if(he.equals2D(r)||he.equals2D(c))continue;let Ie=f.distance(he);Ie<g&&(I===null||Ie<z)&&(I=he,z=Ie)}return I}getConstraintSegments(){return this._segments}setSplitPointFinder(i){this._splitFinder=i}getConvexHull(){return this._convexHull}enforceGabriel(i){let r=new M,c=0,f=new M;for(let g=i.iterator();g.hasNext();){let y=g.next(),S=this.findNonGabrielPoint(y);if(S===null)continue;this._splitPt=this._splitFinder.findSplitPoint(y,S);let I=this.createVertex(this._splitPt,y);this.insertSite(I).getCoordinate().equals2D(this._splitPt);let z=new Oa(y.getStartX(),y.getStartY(),y.getStartZ(),I.getX(),I.getY(),I.getZ(),y.getData()),ne=new Oa(I.getX(),I.getY(),I.getZ(),y.getEndX(),y.getEndY(),y.getEndZ(),y.getData());r.add(z),r.add(ne),f.add(y),c+=1}return i.removeAll(f),i.addAll(r),c}createVertex(){if(arguments.length===1){let i=arguments[0],r=null;return r=this._vertexFactory!==null?this._vertexFactory.createVertex(i,null):new Pa(i),r}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=null;return c=this._vertexFactory!==null?this._vertexFactory.createVertex(i,r):new Pa(i),c.setOnConstraint(!0),c}}getSubdivision(){return this._subdiv}computeBoundingBox(){let i=Fo.computeVertexEnvelope(this._initialVertices),r=Fo.computeVertexEnvelope(this._segVertices),c=new K(i);c.expandToInclude(r);let f=.2*c.getWidth(),g=.2*c.getHeight(),y=Math.max(f,g);this._computeAreaEnv=new K(c),this._computeAreaEnv.expandBy(y)}}Fo.MAX_SPLIT_ITER=99;class Ai{constructor(){Ai.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._tolerance=0,this._subdiv=null}static envelope(i){let r=new K;for(let c=i.iterator();c.hasNext();){let f=c.next();r.expandToInclude(f)}return r}static unique(i){let r=Be.copyDeep(i);return Hn.sort(r),new E(r,!1)}static extractUniqueCoordinates(i){if(i===null)return new E;let r=i.getCoordinates();return Ai.unique(r)}static toVertices(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next();r.add(new Tt(f))}return r}create(){if(this._subdiv!==null)return null;let i=Ai.envelope(this._siteCoords),r=Ai.toVertices(this._siteCoords);this._subdiv=new ls(i,this._tolerance),new ed(this._subdiv).insertSites(r)}setTolerance(i){this._tolerance=i}setSites(){if(arguments[0]instanceof Q){let i=arguments[0];this._siteCoords=Ai.extractUniqueCoordinates(i)}else if(P(arguments[0],j)){let i=arguments[0];this._siteCoords=Ai.unique(Be.toCoordinateArray(i))}}getEdges(i){return this.create(),this._subdiv.getEdges(i)}getSubdivision(){return this.create(),this._subdiv}getTriangles(i){return this.create(),this._subdiv.getTriangles(i)}}class td{constructor(){td.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._constraintLines=null,this._tolerance=0,this._subdiv=null,this._constraintVertexMap=new bs}static createConstraintSegments(){if(arguments.length===1){let i=arguments[0],r=Se.getLines(i),c=new M;for(let f=r.iterator();f.hasNext();){let g=f.next();td.createConstraintSegments(g,c)}return c}if(arguments.length===2){let i=arguments[1],r=arguments[0].getCoordinates();for(let c=1;c<r.length;c++)i.add(new Oa(r[c-1],r[c]))}}createSiteVertices(i){let r=new M;for(let c=i.iterator();c.hasNext();){let f=c.next();this._constraintVertexMap.containsKey(f)||r.add(new Pa(f))}return r}create(){if(this._subdiv!==null)return null;let i=Ai.envelope(this._siteCoords),r=new M;this._constraintLines!==null&&(i.expandToInclude(this._constraintLines.getEnvelopeInternal()),this.createVertices(this._constraintLines),r=td.createConstraintSegments(this._constraintLines));let c=this.createSiteVertices(this._siteCoords),f=new Fo(c,this._tolerance);f.setConstraints(r,new M(this._constraintVertexMap.values())),f.formInitialDelaunay(),f.enforceConstraints(),this._subdiv=f.getSubdivision()}setTolerance(i){this._tolerance=i}setConstraints(i){this._constraintLines=i}setSites(i){this._siteCoords=Ai.extractUniqueCoordinates(i)}getEdges(i){return this.create(),this._subdiv.getEdges(i)}getSubdivision(){return this.create(),this._subdiv}getTriangles(i){return this.create(),this._subdiv.getTriangles(i)}createVertices(i){let r=i.getCoordinates();for(let c=0;c<r.length;c++){let f=new Pa(r[c]);this._constraintVertexMap.put(r[c],f)}}}class fp{constructor(){fp.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._tolerance=0,this._subdiv=null,this._clipEnv=null,this._diagramEnv=null}static clipGeometryCollection(i,r){let c=i.getFactory().toGeometry(r),f=new M;for(let g=0;g<i.getNumGeometries();g++){let y=i.getGeometryN(g),S=null;r.contains(y.getEnvelopeInternal())?S=y:r.intersects(y.getEnvelopeInternal())&&(S=We.intersection(c,y),S.setUserData(y.getUserData())),S===null||S.isEmpty()||f.add(S)}return i.getFactory().createGeometryCollection(vt.toGeometryArray(f))}create(){if(this._subdiv!==null)return null;let i=Ai.envelope(this._siteCoords);if(this._diagramEnv=this._clipEnv,this._diagramEnv===null){this._diagramEnv=i;let c=this._diagramEnv.getDiameter();this._diagramEnv.expandBy(c)}let r=Ai.toVertices(this._siteCoords);this._subdiv=new ls(i,this._tolerance),new ed(this._subdiv).insertSites(r)}setSites(){if(arguments[0]instanceof Q){let i=arguments[0];this._siteCoords=Ai.extractUniqueCoordinates(i)}else if(P(arguments[0],j)){let i=arguments[0];this._siteCoords=Ai.unique(Be.toCoordinateArray(i))}}setClipEnvelope(i){this._clipEnv=i}getSubdivision(){return this.create(),this._subdiv}getDiagram(i){this.create();let r=this._subdiv.getVoronoiDiagram(i);return fp.clipGeometryCollection(r,this._diagramEnv)}setTolerance(i){this._tolerance=i}}var HP=Object.freeze({__proto__:null,Vertex:Tt}),WP=Object.freeze({__proto__:null,ConformingDelaunayTriangulationBuilder:td,DelaunayTriangulationBuilder:Ai,VoronoiDiagramBuilder:fp,quadedge:HP});class $s{constructor(){$s.constructor_.apply(this,arguments)}static constructor_(){if(this._linearGeom=null,this._numLines=null,this._currentLine=null,this._componentIndex=0,this._vertexIndex=0,arguments.length===1){let i=arguments[0];$s.constructor_.call(this,i,0,0)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];$s.constructor_.call(this,i,r.getComponentIndex(),$s.segmentEndVertexIndex(r))}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];if(!P(i,N))throw new s("Lineal geometry is required");this._linearGeom=i,this._numLines=i.getNumGeometries(),this._componentIndex=r,this._vertexIndex=c,this.loadCurrentLine()}}static segmentEndVertexIndex(i){return i.getSegmentFraction()>0?i.getSegmentIndex()+1:i.getSegmentIndex()}getComponentIndex(){return this._componentIndex}getLine(){return this._currentLine}getVertexIndex(){return this._vertexIndex}getSegmentEnd(){return this._vertexIndex<this.getLine().getNumPoints()-1?this._currentLine.getCoordinateN(this._vertexIndex+1):null}next(){if(!this.hasNext())return null;this._vertexIndex++,this._vertexIndex>=this._currentLine.getNumPoints()&&(this._componentIndex++,this.loadCurrentLine(),this._vertexIndex=0)}loadCurrentLine(){if(this._componentIndex>=this._numLines)return this._currentLine=null,null;this._currentLine=this._linearGeom.getGeometryN(this._componentIndex)}getSegmentStart(){return this._currentLine.getCoordinateN(this._vertexIndex)}isEndOfLine(){return!(this._componentIndex>=this._numLines)&&!(this._vertexIndex<this._currentLine.getNumPoints()-1)}hasNext(){return!(this._componentIndex>=this._numLines)&&!(this._componentIndex===this._numLines-1&&this._vertexIndex>=this._currentLine.getNumPoints())}}class Fa{constructor(){Fa.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;let i=arguments[0];this._linearGeom=i}static indexOf(i,r){return new Fa(i).indexOf(r)}static indexOfAfter(i,r,c){return new Fa(i).indexOfAfter(r,c)}segmentNearestMeasure(i,r,c){let f=i.projectionFactor(r);return f<=0?c:f<=1?c+f*i.getLength():c+i.getLength()}indexOfFromStart(i,r){let c=l.MAX_VALUE,f=r,g=0,y=new Ze,S=new $s(this._linearGeom);for(;S.hasNext();){if(!S.isEndOfLine()){y.p0=S.getSegmentStart(),y.p1=S.getSegmentEnd();let I=y.distance(i),z=this.segmentNearestMeasure(y,i,g);I<c&&z>r&&(f=z,c=I),g+=y.getLength()}S.next()}return f}indexOf(i){return this.indexOfFromStart(i,-1)}indexOfAfter(i,r){if(r<0)return this.indexOf(i);let c=this._linearGeom.getLength();if(c<r)return c;let f=this.indexOfFromStart(i,r);return d.isTrue(f>=r,"computed index is before specified minimum index"),f}}class pp{constructor(){pp.constructor_.apply(this,arguments)}static constructor_(){this._geomFact=null,this._lines=new M,this._coordList=null,this._ignoreInvalidLines=!1,this._fixInvalidLines=!1,this._lastPt=null;let i=arguments[0];this._geomFact=i}getGeometry(){return this.endLine(),this._geomFact.buildGeometry(this._lines)}getLastCoordinate(){return this._lastPt}endLine(){if(this._coordList===null)return null;if(this._ignoreInvalidLines&&this._coordList.size()<2)return this._coordList=null,null;let i=this._coordList.toCoordinateArray(),r=i;this._fixInvalidLines&&(r=this.validCoordinateSequence(i)),this._coordList=null;let c=null;try{c=this._geomFact.createLineString(r)}catch(f){if(!(f instanceof s)||!this._ignoreInvalidLines)throw f}c!==null&&this._lines.add(c)}setFixInvalidLines(i){this._fixInvalidLines=i}add(){if(arguments.length===1){let i=arguments[0];this.add(i,!0)}else if(arguments.length===2){let i=arguments[0],r=arguments[1];this._coordList===null&&(this._coordList=new E),this._coordList.add(i,r),this._lastPt=i}}setIgnoreInvalidLines(i){this._ignoreInvalidLines=i}validCoordinateSequence(i){return i.length>=2?i:[i[0],i[0]]}}class nd{constructor(){nd.constructor_.apply(this,arguments)}static constructor_(){this._line=null;let i=arguments[0];this._line=i}static extract(i,r,c){return new nd(i).extract(r,c)}extract(i,r){return r.compareTo(i)<0?this.reverse(this.computeLinear(r,i)):this.computeLinear(i,r)}computeLine(i,r){let c=this._line.getCoordinates(),f=new E,g=i.getSegmentIndex();i.getSegmentFraction()>0&&(g+=1);let y=r.getSegmentIndex();r.getSegmentFraction()===1&&(y+=1),y>=c.length&&(y=c.length-1),i.isVertex()||f.add(i.getCoordinate(this._line));for(let I=g;I<=y;I++)f.add(c[I]);r.isVertex()||f.add(r.getCoordinate(this._line)),f.size()<=0&&f.add(i.getCoordinate(this._line));let S=f.toCoordinateArray();return S.length<=1&&(S=[S[0],S[0]]),this._line.getFactory().createLineString(S)}reverse(i){return P(i,N)?i.reverse():(d.shouldNeverReachHere("non-linear geometry encountered"),null)}computeLinear(i,r){let c=new pp(this._line.getFactory());c.setFixInvalidLines(!0),i.isVertex()||c.add(i.getCoordinate(this._line));for(let f=new $s(this._line,i);f.hasNext()&&!(r.compareLocationValues(f.getComponentIndex(),f.getVertexIndex(),0)<0);f.next()){let g=f.getSegmentStart();c.add(g),f.isEndOfLine()&&c.endLine()}return r.isVertex()||c.add(r.getCoordinate(this._line)),c.getGeometry()}}class en{constructor(){en.constructor_.apply(this,arguments)}static constructor_(){if(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this._componentIndex=i._componentIndex,this._segmentIndex=i._segmentIndex,this._segmentFraction=i._segmentFraction}else if(arguments.length===2){let i=arguments[0],r=arguments[1];en.constructor_.call(this,0,i,r)}else if(arguments.length===3){let i=arguments[0],r=arguments[1],c=arguments[2];this._componentIndex=i,this._segmentIndex=r,this._segmentFraction=c,this.normalize()}else if(arguments.length===4){let i=arguments[0],r=arguments[1],c=arguments[2],f=arguments[3];this._componentIndex=i,this._segmentIndex=r,this._segmentFraction=c,f&&this.normalize()}}}static numSegments(i){let r=i.getNumPoints();return r<=1?0:r-1}static compareLocationValues(i,r,c,f,g,y){return i<f?-1:i>f?1:r<g?-1:r>g?1:c<y?-1:c>y?1:0}static pointAlongSegmentByFraction(i,r,c){if(c<=0)return i;if(c>=1)return r;let f=(r.x-i.x)*c+i.x,g=(r.y-i.y)*c+i.y,y=(r.getZ()-i.getZ())*c+i.getZ();return new w(f,g,y)}static getEndLocation(i){let r=new en;return r.setToEnd(i),r}getSegmentIndex(){return this._segmentIndex}getComponentIndex(){return this._componentIndex}getSegmentFraction(){return this._segmentFraction}setToEnd(i){this._componentIndex=i.getNumGeometries()-1;let r=i.getGeometryN(this._componentIndex);this._segmentIndex=en.numSegments(r),this._segmentFraction=0}compareTo(i){let r=i;return this._componentIndex<r._componentIndex?-1:this._componentIndex>r._componentIndex?1:this._segmentIndex<r._segmentIndex?-1:this._segmentIndex>r._segmentIndex?1:this._segmentFraction<r._segmentFraction?-1:this._segmentFraction>r._segmentFraction?1:0}copy(){return new en(this._componentIndex,this._segmentIndex,this._segmentFraction)}toString(){return"LinearLoc["+this._componentIndex+", "+this._segmentIndex+", "+this._segmentFraction+"]"}compareLocationValues(i,r,c){return this._componentIndex<i?-1:this._componentIndex>i?1:this._segmentIndex<r?-1:this._segmentIndex>r?1:this._segmentFraction<c?-1:this._segmentFraction>c?1:0}getSegmentLength(i){let r=i.getGeometryN(this._componentIndex),c=this._segmentIndex;this._segmentIndex>=en.numSegments(r)&&(c=r.getNumPoints()-2);let f=r.getCoordinateN(c),g=r.getCoordinateN(c+1);return f.distance(g)}isVertex(){return this._segmentFraction<=0||this._segmentFraction>=1}isEndpoint(i){let r=i.getGeometryN(this._componentIndex),c=en.numSegments(r);return this._segmentIndex>=c||this._segmentIndex===c-1&&this._segmentFraction>=1}isValid(i){if(this._componentIndex<0||this._componentIndex>=i.getNumGeometries())return!1;let r=i.getGeometryN(this._componentIndex);return!(this._segmentIndex<0||this._segmentIndex>r.getNumPoints())&&(this._segmentIndex!==r.getNumPoints()||this._segmentFraction===0)&&!(this._segmentFraction<0||this._segmentFraction>1)}normalize(){this._segmentFraction<0&&(this._segmentFraction=0),this._segmentFraction>1&&(this._segmentFraction=1),this._componentIndex<0&&(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0),this._segmentIndex<0&&(this._segmentIndex=0,this._segmentFraction=0),this._segmentFraction===1&&(this._segmentFraction=0,this._segmentIndex+=1)}toLowest(i){let r=i.getGeometryN(this._componentIndex),c=en.numSegments(r);return this._segmentIndex<c?this:new en(this._componentIndex,c-1,1,!1)}getCoordinate(i){let r=i.getGeometryN(this._componentIndex),c=r.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=en.numSegments(r))return c;let f=r.getCoordinateN(this._segmentIndex+1);return en.pointAlongSegmentByFraction(c,f,this._segmentFraction)}getSegment(i){let r=i.getGeometryN(this._componentIndex),c=r.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=en.numSegments(r)){let g=r.getCoordinateN(r.getNumPoints()-2);return new Ze(g,c)}let f=r.getCoordinateN(this._segmentIndex+1);return new Ze(c,f)}clamp(i){if(this._componentIndex>=i.getNumGeometries())return this.setToEnd(i),null;if(this._segmentIndex>=i.getNumPoints()){let r=i.getGeometryN(this._componentIndex);this._segmentIndex=en.numSegments(r),this._segmentFraction=1}}isOnSameSegment(i){return this._componentIndex===i._componentIndex&&(this._segmentIndex===i._segmentIndex||i._segmentIndex-this._segmentIndex==1&&i._segmentFraction===0||this._segmentIndex-i._segmentIndex==1&&this._segmentFraction===0)}snapToVertex(i,r){if(this._segmentFraction<=0||this._segmentFraction>=1)return null;let c=this.getSegmentLength(i),f=this._segmentFraction*c,g=c-f;f<=g&&f<r?this._segmentFraction=0:g<=f&&g<r&&(this._segmentFraction=1)}get interfaces_(){return[a]}}class Do{constructor(){Do.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;let i=arguments[0];this._linearGeom=i}static indexOf(i,r){return new Do(i).indexOf(r)}static indexOfAfter(i,r,c){return new Do(i).indexOfAfter(r,c)}indexOfFromStart(i,r){let c=l.MAX_VALUE,f=0,g=0,y=-1,S=new Ze;for(let I=new $s(this._linearGeom);I.hasNext();I.next())if(!I.isEndOfLine()){S.p0=I.getSegmentStart(),S.p1=I.getSegmentEnd();let z=S.distance(i),ne=S.segmentFraction(i),he=I.getComponentIndex(),Ie=I.getVertexIndex();z<c&&(r===null||r.compareLocationValues(he,Ie,ne)<0)&&(f=he,g=Ie,y=ne,c=z)}return c===l.MAX_VALUE?new en(r):new en(f,g,y)}indexOf(i){return this.indexOfFromStart(i,null)}indexOfAfter(i,r){if(r===null)return this.indexOf(i);let c=en.getEndLocation(this._linearGeom);if(c.compareTo(r)<=0)return c;let f=this.indexOfFromStart(i,r);return d.isTrue(f.compareTo(r)>=0,"computed location is before specified minimum location"),f}}class id{constructor(){id.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;let i=arguments[0];this._linearGeom=i}static indicesOf(i,r){return new id(i).indicesOf(r)}indicesOf(i){let r=i.getGeometryN(0).getCoordinateN(0),c=i.getGeometryN(i.getNumGeometries()-1),f=c.getCoordinateN(c.getNumPoints()-1),g=new Do(this._linearGeom),y=new Array(2).fill(null);return y[0]=g.indexOf(r),i.getLength()===0?y[1]=y[0].copy():y[1]=g.indexOfAfter(f,y[0]),y}}class Ss{constructor(){Ss.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;let i=arguments[0];this._linearGeom=i}static getLocation(){if(arguments.length===2){let i=arguments[1];return new Ss(arguments[0]).getLocation(i)}if(arguments.length===3){let i=arguments[1],r=arguments[2];return new Ss(arguments[0]).getLocation(i,r)}}static getLength(i,r){return new Ss(i).getLength(r)}getLocation(){if(arguments.length===1){let i=arguments[0];return this.getLocation(i,!0)}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=i;i<0&&(c=this._linearGeom.getLength()+i);let f=this.getLocationForward(c);return r?f:this.resolveHigher(f)}}getLocationForward(i){if(i<=0)return new en;let r=0,c=new $s(this._linearGeom);for(;c.hasNext();){if(c.isEndOfLine()){if(r===i){let f=c.getComponentIndex(),g=c.getVertexIndex();return new en(f,g,0)}}else{let f=c.getSegmentStart(),g=c.getSegmentEnd().distance(f);if(r+g>i){let y=(i-r)/g,S=c.getComponentIndex(),I=c.getVertexIndex();return new en(S,I,y)}r+=g}c.next()}return en.getEndLocation(this._linearGeom)}getLength(i){let r=0,c=new $s(this._linearGeom);for(;c.hasNext();){if(!c.isEndOfLine()){let f=c.getSegmentStart(),g=c.getSegmentEnd().distance(f);if(i.getComponentIndex()===c.getComponentIndex()&&i.getSegmentIndex()===c.getVertexIndex())return r+g*i.getSegmentFraction();r+=g}c.next()}return r}resolveHigher(i){if(!i.isEndpoint(this._linearGeom))return i;let r=i.getComponentIndex();if(r>=this._linearGeom.getNumGeometries()-1)return i;do r++;while(r<this._linearGeom.getNumGeometries()-1&&this._linearGeom.getGeometryN(r).getLength()===0);return new en(r,0,0)}}class Gy{constructor(){Gy.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;let i=arguments[0];this._linearGeom=i}clampIndex(i){let r=this.positiveIndex(i),c=this.getStartIndex();if(r<c)return c;let f=this.getEndIndex();return r>f?f:r}locationOf(){if(arguments.length===1){let i=arguments[0];return Ss.getLocation(this._linearGeom,i)}if(arguments.length===2){let i=arguments[0],r=arguments[1];return Ss.getLocation(this._linearGeom,i,r)}}project(i){return Fa.indexOf(this._linearGeom,i)}positiveIndex(i){return i>=0?i:this._linearGeom.getLength()+i}extractPoint(){if(arguments.length===1){let i=arguments[0];return Ss.getLocation(this._linearGeom,i).getCoordinate(this._linearGeom)}if(arguments.length===2){let i=arguments[0],r=arguments[1],c=Ss.getLocation(this._linearGeom,i).toLowest(this._linearGeom);return c.getSegment(this._linearGeom).pointAlongOffset(c.getSegmentFraction(),r)}}getStartIndex(){return 0}indexOfAfter(i,r){return Fa.indexOfAfter(this._linearGeom,i,r)}extractLine(i,r){let c=this.clampIndex(i),f=this.clampIndex(r),g=c===f,y=this.locationOf(c,g),S=this.locationOf(f);return nd.extract(this._linearGeom,y,S)}isValidIndex(i){return i>=this.getStartIndex()&&i<=this.getEndIndex()}getEndIndex(){return this._linearGeom.getLength()}indexOf(i){return Fa.indexOf(this._linearGeom,i)}indicesOf(i){let r=id.indicesOf(this._linearGeom,i);return[Ss.getLength(this._linearGeom,r[0]),Ss.getLength(this._linearGeom,r[1])]}}class jy{constructor(){jy.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;let i=arguments[0];this._linearGeom=i,this.checkGeometryType()}clampIndex(i){let r=i.copy();return r.clamp(this._linearGeom),r}project(i){return Do.indexOf(this._linearGeom,i)}checkGeometryType(){if(!(this._linearGeom instanceof Z||this._linearGeom instanceof _n))throw new s("Input geometry must be linear")}extractPoint(){if(arguments.length===1)return arguments[0].getCoordinate(this._linearGeom);if(arguments.length===2){let i=arguments[1],r=arguments[0].toLowest(this._linearGeom);return r.getSegment(this._linearGeom).pointAlongOffset(r.getSegmentFraction(),i)}}getStartIndex(){return new en}indexOfAfter(i,r){return Do.indexOfAfter(this._linearGeom,i,r)}extractLine(i,r){return nd.extract(this._linearGeom,i,r)}isValidIndex(i){return i.isValid(this._linearGeom)}getEndIndex(){return en.getEndLocation(this._linearGeom)}indexOf(i){return Do.indexOf(this._linearGeom,i)}indicesOf(i){return id.indicesOf(this._linearGeom,i)}}var YP=Object.freeze({__proto__:null,LengthIndexedLine:Gy,LengthLocationMap:Ss,LinearGeometryBuilder:pp,LinearIterator:$s,LinearLocation:en,LocationIndexedLine:jy});class RS{static transform(i,r){let c=new M;for(let f=i.iterator();f.hasNext();)c.add(r.execute(f.next()));return c}static select(i,r){let c=new M;for(let f=i.iterator();f.hasNext();){let g=f.next();Boolean.TRUE.equals(r.execute(g))&&c.add(g)}return c}static apply(i,r){for(let c=i.iterator();c.hasNext();)r.execute(c.next())}}RS.Function=function(){};class qy{constructor(){qy.constructor_.apply(this,arguments)}static constructor_(){this.pts=null,this.n=0;let i=arguments[0];this.pts=new Array(i).fill(null)}filter(i){this.pts[this.n++]=i}getCoordinates(){return this.pts}get interfaces_(){return[ge]}}class $y{constructor(){$y.constructor_.apply(this,arguments)}static constructor_(){this._n=0}filter(i){this._n++}getCount(){return this._n}get interfaces_(){return[ge]}}class gp{constructor(){gp.constructor_.apply(this,arguments)}static constructor_(){this._counts=new _s}add(i){let r=this._counts.get(i);r===null?this._counts.put(i,new mp(1)):r.increment()}count(i){let r=this._counts.get(i);return r===null?0:r.count()}}class mp{constructor(){mp.constructor_.apply(this,arguments)}static constructor_(){if(this.count=0,arguments.length!==0){if(arguments.length===1){let i=arguments[0];this.count=i}}}count(){return this.count}increment(){this.count++}}gp.Counter=mp;class By{constructor(){By.constructor_.apply(this,arguments)}static constructor_(){this._size=null,this._items=null,this._size=0,this._items=new M,this._items.add(null)}poll(){if(this.isEmpty())return null;let i=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),i}size(){return this._size}reorder(i){let r=null,c=this._items.get(i);for(;2*i<=this._size&&(r=2*i,r!==this._size&&this._items.get(r+1).compareTo(this._items.get(r))<0&&r++,this._items.get(r).compareTo(c)<0);i=r)this._items.set(i,this._items.get(r));this._items.set(i,c)}clear(){this._size=0,this._items.clear()}peek(){return this.isEmpty()?null:this._items.get(1)}isEmpty(){return this._size===0}add(i){this._items.add(null),this._size+=1;let r=this._size;for(this._items.set(0,i);i.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)this._items.set(r,this._items.get(Math.trunc(r/2)));this._items.set(r,i)}}function XP(){}function ZP(){}function QP(){}function KP(){}class JP extends n{}class Bl{static split(i,r){let c=r.length,f=new M,g=""+i,y=g.indexOf(r);for(;y>=0;){let I=g.substring(0,y);f.add(I),g=g.substring(y+c),y=g.indexOf(r)}g.length>0&&f.add(g);let S=new Array(f.size()).fill(null);for(let I=0;I<S.length;I++)S[I]=f.get(I);return S}static getStackTrace(){if(arguments.length===1){let i=arguments[0],r=new KP,c=new XP;return i.printStackTrace(c),r.toString()}if(arguments.length===2){let i=arguments[0],r=arguments[1],c="";new ZP(Bl.getStackTrace(i));let f=new QP;for(let g=0;g<r;g++)try{c+=f.readLine()+Bl.NEWLINE}catch(y){if(!(y instanceof JP))throw y;d.shouldNeverReachHere()}return c}}static spaces(i){return Bl.chars(" ",i)}static chars(i,r){let c=new Array(r).fill(null);for(let f=0;f<r;f++)c[f]=i;return new String(c)}}Bl.NEWLINE=Fe.getProperty("line.separator");var eF=Object.freeze({__proto__:null,CollectionUtil:RS,CoordinateArrayFilter:qy,CoordinateCountFilter:$y,GeometricShapeFactory:st,NumberUtil:t,ObjectCounter:gp,PriorityQueue:By,StringUtil:Bl,UniqueCoordinateArrayFilter:Pl});Z.prototype.getBoundary=function(){return To.getBoundary(this)},_n.prototype.getBoundary=function(){return To.getBoundary(this)},Q.prototype.equalsTopo=function(A){return Bt.equalsTopo(this,A)},Q.prototype.equals=function(A){return A!==null&&Bt.equalsTopo(this,A)},Q.prototype.union=function(){if(arguments.length===0)return Ma.union(this);if(arguments.length===1){let A=arguments[0];return Fu.union(this,A)}},Q.prototype.isValid=function(){return rs.isValid(this)},Q.prototype.intersection=function(A){return We.intersection(this,A)},Q.prototype.covers=function(A){return Bt.covers(this,A)},Q.prototype.coveredBy=function(A){return Bt.covers(A,this)},Q.prototype.touches=function(A){return Bt.touches(this,A)},Q.prototype.intersects=function(A){return Bt.intersects(this,A)},Q.prototype.within=function(A){return Bt.contains(A,this)},Q.prototype.overlaps=function(A){return Bt.overlaps(this,A)},Q.prototype.disjoint=function(A){return Bt.disjoint(this,A)},Q.prototype.crosses=function(A){return Bt.crosses(this,A)},Q.prototype.buffer=function(){if(arguments.length===1){let A=arguments[0];return Ht.bufferOp(this,A)}if(arguments.length===2){let A=arguments[0],i=arguments[1];return Ht.bufferOp(this,A,i)}if(arguments.length===3){let A=arguments[0],i=arguments[1],r=arguments[2];return Ht.bufferOp(this,A,i,r)}},Q.prototype.convexHull=function(){return new Tr(this).getConvexHull()},Q.prototype.relate=function(){if(arguments.length===1){let A=arguments[0];return Bt.relate(this,A)}if(arguments.length===2){let A=arguments[0],i=arguments[1];return Bt.relate(this,A).matches(i)}},Q.prototype.getCentroid=function(){if(this.isEmpty())return this._factory.createPoint();let A=Nr.getCentroid(this);return this.createPointFromInternalCoord(A,this)},Q.prototype.getInteriorPoint=function(){if(this.isEmpty())return this._factory.createPoint();let A=null,i=this.getDimension();A=i===0?new $u(this):i===1?new qu(this):new or(this);let r=A.getInteriorPoint();return this.createPointFromInternalCoord(r,this)},Q.prototype.symDifference=function(A){return We.symDifference(this,A)},Q.prototype.createPointFromInternalCoord=function(A,i){return i.getPrecisionModel().makePrecise(A),i.getFactory().createPoint(A)},Q.prototype.toText=function(){return new rn().write(this)},Q.prototype.toString=function(){return this.toText()},Q.prototype.contains=function(A){return Bt.contains(this,A)},Q.prototype.difference=function(A){return We.difference(this,A)},Q.prototype.isSimple=function(){return new Ra(this).isSimple()},Q.prototype.isWithinDistance=function(A,i){return!(this.getEnvelopeInternal().distance(A.getEnvelopeInternal())>i)&&Mr.isWithinDistance(this,A,i)},Q.prototype.distance=function(A){return Mr.distance(this,A)},e.algorithm=_P,e.densify=yP,e.dissolve=bP,e.geom=on,e.geomgraph=xP,e.index=IP,e.io=NP,e.linearref=YP,e.noding=TP,e.operation=$P,e.precision=BP,e.simplify=UP,e.triangulate=WP,e.util=eF,e.version="2.12.1"})});function a_(e,t){let n=new jsts.io.OL3Parser;return n.inject(ol.geom.Point,ol.geom.LineString,ol.geom.LinearRing,ol.geom.Polygon,ol.geom.MultiPoint,ol.geom.MultiLineString,ol.geom.MultiPolygon),n.read(t).within(n.read(e))}var nw=R(()=>{Uh()});function l_(e,t){let n=new jsts.io.OL3Parser;return n.inject(ol.geom.Point,ol.geom.LineString,ol.geom.LinearRing,ol.geom.Polygon,ol.geom.MultiPoint,ol.geom.MultiLineString,ol.geom.MultiPolygon),n.read(e).intersects(n.read(t))}var iw=R(()=>{Uh()});function bu({layer:e,inputs:t=[]}){let n=t.map((s,o)=>Array.isArray(s.attribute)?s.attribute.map((l,a)=>[].concat(s.value[a]).map(u=>`${l}|${(s.operator||"eq").toLowerCase()}|${encodeURIComponent(u)}`).join("|null,")).join("|AND,"):`${o>0?`|${t[o-1].logicop},`:""}${s.operator==="in"?`${s.attribute}|${s.operator}|(${[].concat(s.value).map(l=>encodeURIComponent(l)).join(",")})`:[].concat(s.value).map(l=>`${s.attribute}|${(s.operator||"eq").toLowerCase()}|${encodeURIComponent(l)}`).join(`|${s.logicop!==void 0?s.logicop:"OR"},`)}`).join("")||void 0;return Array.isArray(e)?e.map(()=>n):n}var sw=R(()=>{});async function yo({state:e,field:t,layerid:n,filter:s,suggest:o}){try{return(await Promise.allSettled([n||e.layerid].concat(e.otherquerylayerids).map(l=>De(l).getFilterData({suggest:o,fformatter:t,ordering:t,field:s||yo.field({state:e,field:o?t:(e.forminputs.find(a=>t===a.attribute)||{}).dependance||t,fields:[]})})))).filter(l=>l.status==="fulfilled").reduce((l,a,u)=>u===0?l.concat(a.value.data||[]):[...new Set([...a.value.data||[],...l].map(JSON.stringify))].map(JSON.parse),[]).map(([l,a])=>({key:a,value:l}))}catch(l){console.warn(l)}return[]}var rw=R(()=>{ft();Xt();yo.field=({state:e,field:t,fields:n=[]}={})=>{t=e.forminputs.find(o=>o.attribute===t);let s=e.forminputs.find(o=>o.attribute===t.dependance);return!s||[].concat(s.value).find(o=>o===sn)?(n||[]).join()||void 0:(s.value!==void 0&&n.unshift(`${s.attribute}|${s.operator.toLowerCase()}|${s.operator==="in"?`(${[].concat(s.value).map(o=>encodeURIComponent(o)).join(",")})`:`${encodeURIComponent(s.value)}`}`+(n.length?`|${s.logicop}`:"")),yo.field({state:e,fields:n,field:s.attribute}))}});function y4(e){return F.project.getLayerById((F.project.getRelationById(e)||{}).referencedLayer)}var v4=R(()=>{Ke()});function yee(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="SearchPanel.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function ow(){let e=ow.styles||(ow.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var d_,dee,hee,fee,pee,gee,mee,_ee,vee,b4,x4=R(()=>{ft();Ke();ze();Iv();rw();v4();zd();Rt();d_=[],dee={mixins:[_r],data(){return{state:this.$options.service.state,autofilter:!1,allvalue:sn,reload:!1}},computed:{layers_url(){return F.project.getState().layers_url},is_staff(){return window.initConfig.user.is_staff},loading(){return this.state.forminputs.reduce((e,t)=>e||t.loading,!1)},search_layers(){return[].concat(y4(this.state.search_1n_relationid)||[],this.state.search_layers)},filterlayers(){return F.tokens.filtertoken&&this.search_layers.filter(e=>e.getFilterToken())||[]}},methods:{clearFilters(){this.filterlayers.forEach(e=>e.getFilterToken()&&e.clearSelectionFids()),this.state.forminputs.forEach(e=>{["selectfield","autocompletefield"].includes(e.type)?e.value=e.operator==="in"?[e.values[0].value]:e.values[0].value:e.value=null,this.changeInput(e)}),T.closeContent()},resize(){d_.forEach(e=>!F.ismobile&&e.select2("close"))},getLabelOperator(e){return`[${sd[e]}]`},async onFocus(e){if(this.isMobile()){let t=$(e.target).position().top-10;await this.$nextTick(),setTimeout(()=>$(".main-sidebar").scrollTop(t),500)}},async changeInput(e){let t=e.attribute,n=this.state.forminputs.filter(u=>t===u.dependance),s=this.state,o=e.value,l=u=>[].concat(u).find(h=>[sn,null,void 0].includes(h))||u.toString().trim()==="",a=u=>u.type==="autocompletefield";try{this.state.searching=!0,e.type==="numberfield"&&(o=o||o===0?o:null),o===void 0&&(o=sn),["textfield","textField"].includes(e.type)||(o=Array.isArray(o)?o.map(u=>u.trim()):o.trim()),e.value=o,await Promise.allSettled(n.map(async u=>{let h=yo.field({state:s,field:t,fields:[].concat(o).find(d=>[sn,void 0].includes(d))?[]:[e.operator==="in"?`${t}|${e.operator}|(${[].concat(o).map(d=>encodeURIComponent(d))})`:[].concat(o).map(d=>`${t}|${(e.operator||"eq").toLowerCase()}|${encodeURIComponent(d)}`).join("|OR,")]}),p=u.dvalues[h];if(u.operator==="in"&&["selectfield","autocompletefield"].includes(u.type)&&(u.value=[sn]),u.operator!=="in"&&(u.value=u.type==="selectfield"?sn:null),u.values=Array.from(new Set([...!a(u)&&!l(o)?[u.values[0]]:[],...!a(u)&&l(o)?u._values:[],...p||[]])),u.disabled=l(o)?u.dependance_strict:!1,this.state.forminputs.find(d=>d.dependance===u.attribute)&&this.changeInput(u),!(a(u)||l(o)||p)){s.loading[u.attribute]=!0;try{let d=await yo({state:s,layerid:u.alternativeuniquelayer,field:u.attribute,filter:h});!u.dependance_strict&&u.type==="selectfield"&&u._values.push(...u.values),u.values.length===1&&u.values.push(...d),u.dvalues[h]=u.values.slice(1)}catch(d){console.warn(d)}finally{u.disabled=!1,this.state.loading[u.attribute]=!1}}}))}catch(u){console.warn(u)}finally{this.state.searching=!1}},doSearch(e){e.preventDefault(),this.$options.service.run()},async initDateTimeField(e){e.type==="datetimefield"&&(await this.$nextTick(),e.options.format.fieldformat=Vd(e.options.format.fieldformat),e.options.format.displayformat=Vd(e.options.format.displayformat),$(this.$refs[`date_${e.id}`]).datetimepicker({defaultDate:null,format:e.options.format.displayformat,ignoreReadonly:!0,allowInputToggle:!0,toolbarPlacement:"top",widgetPositioning:{vertical:"bottom",horizontal:"left"},showClose:!0,locale:F.language||"en"}),$(this.$refs[`date_${e.id}`]).on("dp.change",()=>{let t=$(`#${e.id}`).val();e.value=t.trim()?moment(t,e.options.format.displayformat).format(e.options.format.fieldformat):null,this.changeInput(e)}),F.ismobile&&setTimeout(()=>{$("#"+e.id).blur()}))},async initSelect2Field(e){if(!["selectfield","autocompletefield"].includes(e.type))return;await this.$nextTick();let t=e.options.numdigaut,n=e.type==="autocompletefield",s=e.operator==="in",o=n?{delay:500,transport:async(a,u,h)=>{try{u({results:(await yo({state:this.state,layerid:e.alternativeuniquelayer,field:e.attribute,suggest:`${e.attribute}|${a.data.q}`})).map(p=>({id:p.value,text:p.key}))})}catch(p){h(p)}}}:null,l=$(`#${e.id}`).select2({ajax:o,width:"100%",dropdownParent:$(".g3w-search-form:visible"),minimumInputLength:n&&(t&&!Number.isNaN(1*t)&&1*t>0&&1*t||2)||0,allowClear:n,placeholder:n?"":null,multiple:s,matcher:(a,u)=>{let h=a.term?a.term.toLowerCase():a.term;return(h||"").toString().trim()===""?u:u.text.toLowerCase().includes(h)&&u.text!==void 0?{...u}:null},language:{noResults:()=>_e("No results"),errorLoading:()=>_e("Error Loading Data"),searching:()=>_e("Searching ..."),inputTooShort:a=>`${_e("Please enter")} ${a.minimum-a.input.length} ${_e("or more characters")}`}});d_.push(l),l.on("select2:select select2:unselecting",a=>{if(a.type==="select2:select"||n){let u=a.params.data?`${a.params.data.id}`:sn;s&&e.value.find(h=>u===h)&&(e.value=e.value.filter(h=>u!==h)),s&&!e.value.find(h=>u===h)&&(e.value=e.value.filter(h=>u!==sn&&sn!==h),e.value.push(u)),s||(e.value=u)}a.type==="select2:unselecting"&&s&&(e.value=e.value.filter(u=>a.params?.args?.data?.id!==u),e.value.length===0&&(e.value=[sn])),this.changeInput(e)}),this.$watch(()=>e.value,async(a,u)=>{(new Set([].concat(a)).difference(new Set([].concat(u)))||[].conact(a).find(h=>sn===h))&&l.val(a).trigger("change")}),T.on("i18n-ready",()=>{this.clearSelect2(),this.initSelect2Field(e)}),l.val(e.value).trigger("change")},clearSelect2(){d_.forEach(e=>{e.select2("destroy"),e.off(),e=null}),d_.splice(0)},async reloadSelect2Inputs(){if(!this.reload){this.reload=!0,await this.$nextTick();try{await this.$options.service.setInputs()}catch(e){console.warn(e)}this.clearSelect2();try{await Promise.allSettled(this.state.forminputs.map(e=>this.initSelect2Field(e)))}catch(e){console.warn(e)}this.reload=!1}}},watch:{autofilter(e=!1){this.state.autofilter.value=Number(e)}},async created(){this.search_layers.forEach(e=>e.on("filtertokenchange",this.reloadSelect2Inputs))},async mounted(){await Promise.allSettled([this.$nextTick(),this.state.mounted]);for(let e of this.state.forminputs)await this.initSelect2Field(e),await this.initDateTimeField(e)},beforeDestroy(){this.search_layers.forEach(e=>e.off("filtertokenchange",this.reloadSelect2Inputs)),this.clearSelect2()}},hee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.searching||e.loading||e.reload,expression:"state.searching || loading || reload"}],staticClass:"g3w-search-panel form-group"},[n("bar-loader",{attrs:{loading:e.state.searching||e.loading||e.reload}}),e._v(" "),n("h4",[n("b",[e._v(e._s(e.state.title))])]),e._v(" "),e.filterlayers.length>0?n("section",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{id:"g3w-search-filter-layers"}},[n("div",{staticStyle:{color:"#FFF","text-align":"justify",position:"relative","border-radius":"3px",margin:"5px 2px 5px 2px","white-space":"pre-line","background-color":"#384246 !important"}},[n("span",{staticStyle:{"text-align":"center","font-size":"0.7em","margin-top":"-4px","margin-left":"-4px","background-color":"var(--bgcolor)","font-weight":"bold",color:"#fff",position:"absolute",top:"0",left:"0",width:"15px",height:"15px",border:"1px solid #fff","border-radius":"50%"}},[e._v("i")]),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"Search values are limited based on the active filter. Remove the filter to search all data.",expression:"'Search values are limited based on the active filter. Remove the filter to search all data.'"}],staticStyle:{"max-height":"200px",padding:"10px","overflow-y":"auto"}})]),e._v(" "),n("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Remove Filter",expression:"'Remove Filter'",arg:"left"}],staticClass:"btn skin-border-color",staticStyle:{"background-color":"transparent",margin:"5px 0"},on:{click:function(s){return s.stopPropagation(),e.clearFilters.apply(null,arguments)}}},[n("i",{staticClass:"skin-color",class:e.$fa("clear")})])]):e._e(),e._v(" "),e._t("tools"),e._v(" "),e._t("form",function(){return[n("form",{staticClass:"g3w-search-form"},[e._l(e.state.forminputs,function(s){return n("div",{key:s.id,staticClass:"form-group"},[s.type==="numberfield"||s.type==="textfield"&&s.widget_type==="Range"?n("div",{staticClass:"numeric"},[n("label",{staticClass:"search-label",attrs:{for:s.id}},[n("span",[e._v(e._s(s.label||s.attribute))]),e._v(" "),n("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(s.operator)))])]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:s.value,expression:"input.value"}],staticClass:"form-control",attrs:{type:"number",min:"0",id:s.id},domProps:{value:s.value},on:{change:function(o){return e.changeInput(s)},input:[function(o){o.target.composing||e.$set(s,"value",o.target.value)},function(o){return e.changeInput(s)}]}})]):["textfield","textField"].includes(s.type)?n("div",{staticClass:"form-item-search text"},[n("label",{staticClass:"search-label",attrs:{for:s.id}},[n("span",[e._v(e._s(s.label||s.attribute))]),e._v(" "),n("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(s.operator)))])]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:s.value,expression:"input.value"}],staticClass:"form-control",attrs:{type:"text",id:s.id},domProps:{value:s.value},on:{focus:e.onFocus,change:function(o){return e.changeInput(s)},input:function(o){o.target.composing||e.$set(s,"value",o.target.value)}}})]):["selectfield","autocompletefield"].includes(s.type)?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.loading[s.dependance]||s.loading||s.disabled,expression:"state.loading[input.dependance] || input.loading || input.disabled"}],staticClass:"text"},[n("label",{staticClass:"search-label",attrs:{for:s.id}},[n("span",[e._v(e._s(s.label||s.attribute))]),e._v(" "),n("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(s.operator)))])]),e._v(" "),s.dependance?n("bar-loader",{attrs:{loading:e.state.loading[s.dependance]||s.loading}}):e._e(),e._v(" "),n("select",{directives:[{name:"disabled",rawName:"v-disabled",value:s.disabled||s.loading,expression:"input.disabled || input.loading"}],staticClass:"form-control",attrs:{name:s.attribute,id:s.id}},e._l(s.values,function(o){return n("option",{key:o.value,domProps:{value:o.value}},[e.allvalue===o.value?n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.search.all",expression:"'sdk.search.all'"}]}):n("span",[e._v(e._s(o.key))])])}),0)],1):s.type==="datetimefield"?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.loading[s.dependance]||!1,expression:"state.loading[input.dependance] || false"}],staticClass:"text"},[n("label",{staticClass:"search-label",attrs:{for:s.id}},[n("span",[e._v(e._s(s.label||s.attribute))]),e._v(" "),n("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(s.operator)))])]),e._v(" "),n("div",{ref:"date_"+s.id,refInFor:!0,staticClass:"input-group date"},[n("input",{staticClass:"form-control",attrs:{id:s.id,type:"text"}}),e._v(" "),n("span",{staticClass:"input-group-addon skin-color"},[n("span",{class:e.$fa(s.options.format.time?"time":"calendar")})])])]):e._e(),e._v(" "),n("sub",[e._v(e._s(s.options.description))]),e._v(" "),e.is_staff?n("details",{staticStyle:{cursor:"pointer","user-select":"none","margin-top":".5em"}},[n("ul",{staticStyle:{"font-size":"80%","padding-left":"15px","font-family":"monospace","white-space":"nowrap","overflow-x":"auto","scrollbar-width":"thin"}},[n("li",[n("b",{staticClass:"skin-color"},[e._v(e._s(s.type))])]),e._v(" "),n("li",[n("b",{staticClass:"skin-color"},[e._v(e._s(s.widget_type))]),s.options.value?n("span",[e._v(": {"),n("br"),e._v('  key: "'+e._s(s.options.key)+'",'),n("br"),e._v('  value: "'+e._s(s.options.value)+'"'),n("br"),e._v("}")]):e._e()]),e._v(" "),s.options.layer_id?n("li",[n("b",{staticClass:"skin-color"},[e._v("layer_id:")]),e._v(' "'+e._s(s.options.layer_id)+'"')]):e._e(),e._v(" "),s.dependance?n("li",[n("b",{staticClass:"skin-color"},[e._v("depends_on:")]),e._v(' "'+e._s(s.dependance)+'"')]):e._e(),e._v(" "),s.dependance?n("li",[n("b",{staticClass:"skin-color"},[e._v("strict:")]),e._v(" "+e._s(s.dependance_strict))]):e._e()])]):e._e(),e._v(" "),s.logicop?n("div",{staticClass:"search-logicop skin-border-color"},[n("h4",[e._v(e._s(s.logicop))])]):e._e()])}),e._v(" "),n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.return!=="data",expression:"'data' !== state.return"}],staticClass:"form-group"},[n("label",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right",value:"Whether automatically filter geometries displayed within the map<br>in order to show only those related to current search results.",expression:"'Whether automatically filter geometries displayed within the map<br>in order to show only those related to current search results.'",arg:"right"}],staticStyle:{display:"block"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.autofilter,expression:"autofilter"}],staticStyle:{margin:"0"},attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.autofilter)?e._i(e.autofilter,null)>-1:e.autofilter},on:{change:function(s){var o=e.autofilter,l=s.target,a=!!l.checked;if(Array.isArray(o)){var u=null,h=e._i(o,u);l.checked?h<0&&(e.autofilter=o.concat([u])):h>-1&&(e.autofilter=o.slice(0,h).concat(o.slice(h+1)))}else e.autofilter=a}}}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"Filter results",expression:"'Filter results'"}]}),e._v(" "),n("i",{staticClass:"fa fa-filter fa-pull-right",style:{opacity:e.state.autofilter.value?1:.5}})])]),e._v(" "),n("div",{staticClass:"form-group"},[n("button",{directives:[{name:"t",rawName:"v-t",value:"dosearch",expression:"'dosearch'"}],staticClass:"sidebar-button-run btn btn-block pull-right",attrs:{id:"dosearch"},on:{click:function(s){return s.stopPropagation(),e.doSearch.apply(null,arguments)}}})])],2)]}),e._v(" "),e._t("footer"),e._v(" "),e.layers_url?n("div",{staticStyle:{"padding-top":"5em"}},[n("b",[n("a",{attrs:{href:e.layers_url,target:"_blank"}},[e._v(e._s(e.$t("Edit in admin")))])])]):e._e()],2)},fee=[],pee=function(e){e&&e("data-v-ba68add4_0",{source:".g3w-search-form label[data-v-ba68add4]{color:#fff}.g3w-search-form .search-logicop[data-v-ba68add4]{width:100%;position:relative;display:flex;justify-content:center;margin-bottom:15px;margin-top:30px;border-bottom:1px solid}.g3w-search-form .search-logicop h4[data-v-ba68add4]{font-weight:700;position:absolute;padding:5px;top:-24px;background:var(--bgcolor)}#dosearch[data-v-ba68add4]{color:#fff;font-weight:700;margin-top:15px;background-color:var(--skin-color)}#dosearch[data-v-ba68add4]:hover{color:#fff}.search-label[data-v-ba68add4]{width:100%;display:flex;justify-content:space-between}.search-label .skin-color[data-v-ba68add4]{font-family:monospace}",map:void 0,media:void 0})},gee="data-v-ba68add4",mee=void 0,_ee=!1;vee=yee({render:hee,staticRenderFns:fee},pee,dee,gee,_ee,mee,!1,ow,void 0,void 0),b4=vee});var w4={};qn(w4,{SearchPanel:()=>h_});function h_(e={},t=!1){let n={loading:{},searching:!1,title:e.name,type:e.type||"search",queryurl:(e.options||{}).queryurl,layerid:(e.options||{}).layerid,otherquerylayerids:(e.options||{}).otherquerylayerids||[],search_endpoint:"api",search_1n_relationid:e.options.search_1n_relationid,search_layers:T.getService("queryresults")._projectLayerIds.filter(a=>[(e.options||{}).querylayerid||(e.options||{}).layerid,...(e.options||{}).otherquerylayerids||[]].includes(a)).map(a=>De(a)),forminputs:((e.options||{}).filter||[]).map((a,u)=>({id:a.id||Qe(),type:a.input.type||"textfield",widget_type:a.input.widget_type,label:a.label,attribute:a.attribute,values:a.input.options.values||[],dvalues:{},dependance_strict:a.input.options.dependance_strict||!1,dependance:a.input.options.dependance||!1,alternativeuniquelayer:a.input.alternativeuniquelayer,value:a.input.type==="selectfield"?sn:null,operator:a.op,logicop:u===e.options.filter.length-1?null:a.logicop,loading:!0,disabled:a.input.options.disabled||!1,options:a.input.options})),autofilter:{value:0},paginate:!!e.options.paginate,return:(e.options||{}).return||"data",child:!!e.child};n.search_layers.some(a=>!a)&&(n.search_layers=n.search_layers.filter(a=>a),T.showUserMessage({type:"warning",message:"Invalid <code>search_layers</code> config. Have you deleted some layers from your QGIS project recently?"}));let s=async()=>{for(let a=0;a<=n.forminputs.length-1;a++){let u=n.forminputs[a];u.operator==="in"&&(u.value=[].concat(u.value));let h=u.dependance_strict&&[].concat(n.forminputs.find(_=>u.dependance===_.attribute).value).find(_=>[sn,"",null,void 0].includes(_)),p=!h,d=Array.isArray(u.options.values)&&u.options.values.length>0;u.values=u.type==="selectfield"?[sn,...p&&d?u.options.values:[],...p&&!d?await yo({state:n,layerid:u.alternativeuniquelayer,field:u.attribute}):[]].map(_=>Zn(_)==="Object"?_:{key:_,value:_}):[],u.values.length===1&&sn===u.values[0].value&&["selectfield","autocompletefield"].includes(u.type)&&(u.value=u.operator==="in"?[sn]:sn),u.dependance&&(n.loading[u.dependance]=!1,u.disabled=h),u._values=[...u.values],u.loading=!1}};n.mounted=s();let o=e.service||Object.assign(new nt,{state:n,doSearch:bee,setInputs:s,run:un((...a)=>{let[u,h]=T.getService("map").getMap().getSize(),p=T.isMobile()&&(u===0||h===0);setTimeout(()=>{p&&T.hideSidebar(),l.getService().doSearch({...a,state:n})},p?0:600)}),clear(){l.getService().state=null},createFilter:()=>bu({layer:n.search_layers,inputs:n.forminputs.filter(a=>![null,void 0,sn].includes(a.value)&&a.value.toString().trim()!=="")})}),l=new Un({...e,show:t,id:e.id||Qe(),title:e.title||"search",vueComponentObject:e.component||b4,service:o});return l}async function bee({filter:e,queryUrl:t,show:n,feature_count:s=1e4,state:o}={}){t=t===void 0?o.queryurl:t,n=n===void 0?o.type==="search"&&o.return==="data":n,o.searching=!0;let l,a,u=!n&&o.type==="search_1n";try{l=await gt.getData("search:features",{inputs:{layer:o.search_layers,filter:e||bu({layer:o.search_layers,inputs:o.forminputs.filter(m=>[].concat(m.value).find(v=>![null,void 0,sn].includes(v)&&m.value.toString().trim()!==""))}),queryUrl:t,formatter:1,feature_count:s,raw:o.return==="search",autofilter:Number(n&&o.autofilter.value),...o.paginate&&!u?{page:1,page_sizes:Bs}:{}},outputs:n&&{title:o.title}});let h=Object.keys((l.data[0]||{}).data||{}).length>0;h&&o.return==="search"&&(await T.closeContent(),new h_(Object.assign((l.data[0]||{}).data,{child:!0}),!0)),!h&&o.return==="search"&&(T.outputDataPlace(Promise.resolve({data:[]})),l=[]),n&&F.project.state.autozoom_query&&(l.data||[]).length===1&&!o.paginate&&T.getService("map").zoomToFeatures(l.data[0].features);let p=u&&(l.data[0]||{}).features||[],d=p.length&&F.project.getRelationById(o.search_1n_relationid),_=d&&F.project.getLayerById(d.referencedLayer);if(u&&(p.length===0||!d)&&(T.outputDataPlace(Promise.resolve({data:[]})),a=[]),d){let{referencedField:m,referencingField:v}=d.fieldRef;m=[].concat(m),v=[].concat(v),a=await gt.getData("search:features",{inputs:{layer:_,filter:bu({layer:[_],inputs:p.map(x=>({attribute:m.length===1?m[0]:m,logicop:"OR",operator:"eq",value:[...new Set(v.length===1?p.map(b=>b.get(v[0])):v.map(b=>x.get(b)))]}))}),formatter:1,feature_count:s,autofilter:o.autofilter.value,...o.paginate?{page:1,page_sizes:Bs}:{}},outputs:{title:o.title}})}}catch(h){console.warn(h)}return o.searching=!1,a||l}var aw=R(()=>{ft();vn();Ka();Ke();ze();ei();Wt();sw();Xr();rw();Us();Xt();x4()});var S4=He((zh,lw)=>{(function(t,n){typeof zh=="object"&&typeof lw=="object"?lw.exports=n():typeof define=="function"&&define.amd?define("CookieLaw",[],n):typeof zh=="object"?zh.CookieLaw=n():t.CookieLaw=n()})(zh,function(){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(s,o,l){n.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:l})},n.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},n.t=function(s,o){if(o&1&&(s=n(s)),o&8||o&4&&typeof s=="object"&&s&&s.__esModule)return s;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:s}),o&2&&typeof s!="string")for(var a in s)n.d(l,a,function(u){return s[u]}.bind(null,a));return l},n.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return n.d(o,"a",o),o},n.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},n.p="",n(n.s=4)}([function(e,t,n){var s=n(2);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=n(5).default,l=o("624a20fb",s,!0,{})},function(e,t,n){"use strict";var s=n(0),o=n.n(s),l=o.a},function(e,t,n){var s=n(3);t=s(!1),t.push([e.i,`.Cookie{position:fixed;overflow:hidden;box-sizing:border-box;z-index:9999;width:100%;display:flex;justify-content:space-between;align-items:baseline;flex-direction:column}.Cookie>*{margin:.9375rem 0;align-self:center}@media screen and (min-width: 48rem){.Cookie{flex-flow:row}.Cookie>*{margin:0}}.Cookie--top{top:0;left:0;right:0}.Cookie--bottom{bottom:0;left:0;right:0}.Cookie__buttons{display:flex;flex-direction:column}.Cookie__buttons>*{margin:.3125rem 0}@media screen and (min-width: 48rem){.Cookie__buttons{flex-direction:row}.Cookie__buttons>*{margin:0 .9375rem}}.Cookie__button{cursor:pointer;align-self:center;white-space:nowrap}.Cookie__declineButton{cursor:pointer;align-self:center;white-space:nowrap}.Cookie--base{background:#F1F1F1;color:#232323;padding:1.250em}.Cookie--base .Cookie__button{background:#97D058;padding:0.625em 3.125em;color:#fff;border-radius:0;border:0;font-size:1em}.Cookie--base .Cookie__button:hover{background:#7ebf36}.Cookie--base .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#727272;border-radius:0;border:0;font-size:1em}.Cookie--base .Cookie__button--decline:hover{background:#cbcbcb}.Cookie--base--rounded{background:#F1F1F1;color:#232323;padding:1.250em}.Cookie--base--rounded .Cookie__button{background:#97D058;padding:0.625em 3.125em;color:#fff;border-radius:20px;border:0;font-size:1em}.Cookie--base--rounded .Cookie__button:hover{background:#7ebf36}.Cookie--base--rounded .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#727272;border-radius:20px;border:0;font-size:1em}.Cookie--base--rounded .Cookie__button--decline:hover{background:#cbcbcb}.Cookie--blood-orange{background:#424851;color:#fff;padding:1.250em}.Cookie--blood-orange .Cookie__button{background:#E76A68;padding:0.625em 3.125em;color:#fff;border-radius:0;border:0;font-size:1em}.Cookie--blood-orange .Cookie__button:hover{background:#e03f3c}.Cookie--blood-orange .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#000;border-radius:0;border:0;font-size:1em}.Cookie--blood-orange .Cookie__button--decline:hover{background:#202327}.Cookie--blood-orange--rounded{background:#424851;color:#fff;padding:1.250em}.Cookie--blood-orange--rounded .Cookie__button{background:#E76A68;padding:0.625em 3.125em;color:#fff;border-radius:20px;border:0;font-size:1em}.Cookie--blood-orange--rounded .Cookie__button:hover{background:#e03f3c}.Cookie--blood-orange--rounded .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#000;border-radius:20px;border:0;font-size:1em}.Cookie--blood-orange--rounded .Cookie__button--decline:hover{background:#202327}.Cookie--dark-lime{background:#424851;color:#fff;padding:1.250em}.Cookie--dark-lime .Cookie__button{background:#97D058;padding:0.625em 3.125em;color:#fff;border-radius:0;border:0;font-size:1em}.Cookie--dark-lime .Cookie__button:hover{background:#7ebf36}.Cookie--dark-lime .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#000;border-radius:0;border:0;font-size:1em}.Cookie--dark-lime .Cookie__button--decline:hover{background:#202327}.Cookie--dark-lime--rounded{background:#424851;color:#fff;padding:1.250em}.Cookie--dark-lime--rounded .Cookie__button{background:#97D058;padding:0.625em 3.125em;color:#fff;border-radius:20px;border:0;font-size:1em}.Cookie--dark-lime--rounded .Cookie__button:hover{background:#7ebf36}.Cookie--dark-lime--rounded .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#000;border-radius:20px;border:0;font-size:1em}.Cookie--dark-lime--rounded .Cookie__button--decline:hover{background:#202327}.Cookie--royal{background:#FBC227;color:#232323;padding:1.250em}.Cookie--royal .Cookie__button{background:#726CEA;padding:0.625em 3.125em;color:#fff;border-radius:0;border:0;font-size:1em}.Cookie--royal .Cookie__button:hover{background:#473fe4}.Cookie--royal .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#221901;border-radius:0;border:0;font-size:1em}.Cookie--royal .Cookie__button--decline:hover{background:#d29a04}.Cookie--royal--rounded{background:#FBC227;color:#232323;padding:1.250em}.Cookie--royal--rounded .Cookie__button{background:#726CEA;padding:0.625em 3.125em;color:#fff;border-radius:20px;border:0;font-size:1em}.Cookie--royal--rounded .Cookie__button:hover{background:#473fe4}.Cookie--royal--rounded .Cookie__button--decline{background:transparent;padding:0.625em 3.125em;color:#221901;border-radius:20px;border:0;font-size:1em}.Cookie--royal--rounded .Cookie__button--decline:hover{background:#d29a04}.slideFromTop-enter,.slideFromTop-leave-to{transform:translate(0px, -12.5em)}.slideFromTop-enter-to,.slideFromTop-leave{transform:translate(0px, 0px)}.slideFromBottom-enter,.slideFromBottom-leave-to{transform:translate(0px, 12.5em)}.slideFromBottom-enter-to,.slideFromBottom-leave{transform:translate(0px, 0px)}.slideFromBottom-enter-active,.slideFromBottom-leave-active,.slideFromTop-enter-active,.slideFromTop-leave-active{transition:transform .4s ease-in}.fade-enter-active,.fade-leave-active{transition:opacity .5s}.fade-enter,.fade-leave-to{opacity:0}
`,""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(l){var a=[];return a.toString=function(){return this.map(function(h){var p=s(h,l);return h[2]?"@media ".concat(h[2]," {").concat(p,"}"):p}).join("")},a.i=function(u,h,p){typeof u=="string"&&(u=[[null,u,""]]);var d={};if(p)for(var _=0;_<this.length;_++){var m=this[_][0];m!=null&&(d[m]=!0)}for(var v=0;v<u.length;v++){var x=[].concat(u[v]);p&&d[x[0]]||(h&&(x[2]?x[2]="".concat(h," and ").concat(x[2]):x[2]=h),a.push(x))}},a};function s(l,a){var u=l[1]||"",h=l[3];if(!h)return u;if(a&&typeof btoa=="function"){var p=o(h),d=h.sources.map(function(_){return"/*# sourceURL=".concat(h.sourceRoot||"").concat(_," */")});return[u].concat(d).concat([p]).join(`
`)}return[u].join(`
`)}function o(l){var a=btoa(unescape(encodeURIComponent(JSON.stringify(l)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a);return"/*# ".concat(u," */")}},function(e,t,n){"use strict";n.r(t);var s=function(){var E=this,X=E.$createElement,K=E._self._c||X;return K("transition",{attrs:{appear:"",name:E.transitionName}},[E.isOpen?K("div",{staticClass:"Cookie",class:[E.containerPosition,E.cookieTheme]},[E._t("default",[K("div",{staticClass:"Cookie__content"},[E._t("message",[E._v(E._s(E.message))])],2),E._v(" "),K("div",{staticClass:"Cookie__buttons"},[E.externalButtonLink?K("a",{class:E.buttonClass,attrs:{target:E.target,href:E.buttonLink}},[E._v(E._s(E.buttonLinkText))]):E._e(),E._v(" "),E.internalButtonLink?K("router-link",{class:E.buttonClass,attrs:{to:E.buttonLink}},[E._v(E._s(E.buttonLinkText))]):E._e(),E._v(" "),E.buttonDecline?K("button",{class:E.buttonDeclineClass,on:{click:E.decline}},[E._v(E._s(E.buttonDeclineText))]):E._e(),E._v(" "),K("button",{class:E.buttonClass,on:{click:E.accept}},[E._v(E._s(E.buttonText))])],1)],{accept:E.accept,close:E.close,decline:E.decline,open:E.open})],2):E._e()])},o=[];function l(E,X){return Object.prototype.hasOwnProperty.call(E,X)}function a(E){return E.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")}function u(E){var X=E.charAt(E.length-1),K=parseInt(E,10),te=new Date;switch(X){case"Y":te.setFullYear(te.getFullYear()+K);break;case"M":te.setMonth(te.getMonth()+K);break;case"D":te.setDate(te.getDate()+K);break;case"h":te.setHours(te.getHours()+K);break;case"m":te.setMinutes(te.getMinutes()+K);break;case"s":te.setSeconds(te.getSeconds()+K);break;default:te=new Date(E)}return te}function h(E){var X="";for(var K in E)if(l(E,K))if(/^expires$/i.test(K)){var te=E[K];typeof te!="object"&&(te+=typeof te=="number"?"D":"",te=u(te)),X+=";"+K+"="+te.toUTCString()}else/^secure$/.test(K)?E[K]&&(X+=";"+K):X+=";"+K+"="+E[K];return l(E,"path")||(X+=";path=/"),X}function p(){return p=Object.assign||function(E){for(var X=1;X<arguments.length;X++){var K=arguments[X];for(var te in K)Object.prototype.hasOwnProperty.call(K,te)&&(E[te]=K[te])}return E},p.apply(this,arguments)}function d(){var E="@key@",X="1",K=new RegExp("(?:^|; )"+E+"="+X+"(?:;|$)");document.cookie=E+"="+X;var te=K.test(document.cookie);return te&&x(E),te}function _(E,X){if(X===void 0&&(X=decodeURIComponent),typeof E!="string"||!E)return null;var K=new RegExp("(?:^|; )"+a(E)+"(?:=([^;]*))?(?:;|$)"),te=K.exec(document.cookie);return te===null?null:typeof X=="function"?X(te[1]):te[1]}function m(E){E===void 0&&(E=decodeURIComponent);for(var X=/(?:^|; )([^=]+?)(?:=([^;]*))?(?:;|$)/g,K={},te;te=X.exec(document.cookie);)X.lastIndex=te.index+te.length-1,K[te[1]]=typeof E=="function"?E(te[2]):te[2];return K}function v(E,X,K,te){K===void 0&&(K=encodeURIComponent),typeof K=="object"&&K!==null&&(te=K,K=encodeURIComponent);var Ge=h(te||{}),ye=typeof K=="function"?K(X):X,Re=E+"="+ye+Ge;document.cookie=Re}function x(E,X){var K={expires:-1};return X&&(K=p({},X,K)),v(E,"a",K)}function b(E){return _(E,null)}function w(E,X,K){return v(E,X,null,K)}function L(E,X){var K=Object.keys(E);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(E);X&&(te=te.filter(function(Ge){return Object.getOwnPropertyDescriptor(E,Ge).enumerable})),K.push.apply(K,te)}return K}function D(E){for(var X=1;X<arguments.length;X++){var K=arguments[X]!=null?arguments[X]:{};X%2?L(Object(K),!0).forEach(function(te){G(E,te,K[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(K)):L(Object(K)).forEach(function(te){Object.defineProperty(E,te,Object.getOwnPropertyDescriptor(K,te))})}return E}function G(E,X,K){return X in E?Object.defineProperty(E,X,{value:K,enumerable:!0,configurable:!0,writable:!0}):E[X]=K,E}function W(E){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?W=function(K){return typeof K}:W=function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},W(E)}var P={local:"localStorage",cookies:"cookies"},j={name:"VueCookieLaw",props:{buttonText:{type:String,default:"Got it!"},buttonDecline:{type:Boolean,default:!1},buttonDeclineText:{type:String,default:"Decline"},buttonLink:{type:[String,Object],required:!1},buttonLinkText:{type:String,default:"More info"},buttonLinkNewTab:{type:Boolean,default:!1},message:{type:String,default:"This website uses cookies to ensure you get the best experience on our website."},theme:{type:String,default:"base"},position:{type:String,default:"bottom"},transitionName:{type:String,default:"slideFromBottom"},buttonClass:{type:String,default:"Cookie__button"},buttonDeclineClass:{type:String,default:"Cookie__button--decline"},storageName:{type:String,default:"cookie:accepted"},storageType:{type:String,default:P.local},cookieOptions:{type:Object,default:function(){},required:!1}},data:function(){return{supportsLocalStorage:!0,isOpen:!1}},computed:{containerPosition:function(){return"Cookie--".concat(this.position)},cookieTheme:function(){return"Cookie--".concat(this.theme)},externalButtonLink:function(){return typeof this.buttonLink=="string"&&this.buttonLink.length},internalButtonLink:function(){return W(this.buttonLink)==="object"&&this.buttonLink!=null&&Object.keys(this.buttonLink).length},target:function(){return this.buttonLinkNewTab?"_blank":"_self"},canUseLocalStorage:function(){return this.storageType===P.local&&this.supportsLocalStorage}},created:function(){if(this.storageType===P.local)try{var X="__vue-cookielaw-check-localStorage";typeof window<"u"&&(window.localStorage.setItem(X,X),window.localStorage.removeItem(X))}catch{console.info("Local storage is not supported, falling back to cookie use"),this.supportsLocalStorage=!1}this.getVisited()||(this.isOpen=!0)},mounted:function(){this.isAccepted()&&this.$emit("accept")},methods:{setVisited:function(){this.canUseLocalStorage?localStorage.setItem(this.storageName,!0):v(this.storageName,!0,D({},this.cookieOptions,{expires:"1Y"}))},setAccepted:function(){this.canUseLocalStorage?localStorage.setItem(this.storageName,!0):v(this.storageName,!0,D({},this.cookieOptions,{expires:"1Y"}))},setDeclined:function(){this.canUseLocalStorage?localStorage.setItem(this.storageName,!1):v(this.storageName,!1,D({},this.cookieOptions,{expires:"1Y"}))},getVisited:function(){var X=!1;return this.canUseLocalStorage?X=localStorage.getItem(this.storageName):X=_(this.storageName),typeof X=="string"&&(X=JSON.parse(X)),X!=null},isAccepted:function(){var X=!1;return this.canUseLocalStorage?X=localStorage.getItem(this.storageName):X=_(this.storageName),typeof X=="string"&&(X=JSON.parse(X)),X},accept:function(){this.setVisited(),this.setAccepted(),this.isOpen=!1,this.$emit("accept")},close:function(){this.isOpen=!1,this.$emit("close")},decline:function(){this.setVisited(),this.setDeclined(),this.isOpen=!1,this.$emit("decline")},revoke:function(){this.canUseLocalStorage?localStorage.removeItem(this.storageName):x(this.storageName),this.isOpen=!0,this.$emit("revoke")},open:function(){this.getVisited()||(this.isOpen=!0)}}},V=j,H=n(1);function se(E,X,K,te,Ge,ye,Re,U){var ce=typeof E=="function"?E.options:E;X&&(ce.render=X,ce.staticRenderFns=K,ce._compiled=!0),te&&(ce.functional=!0),ye&&(ce._scopeId="data-v-"+ye);var we;if(Re?(we=function(Fe){Fe=Fe||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!Fe&&typeof __VUE_SSR_CONTEXT__<"u"&&(Fe=__VUE_SSR_CONTEXT__),Ge&&Ge.call(this,Fe),Fe&&Fe._registeredComponents&&Fe._registeredComponents.add(Re)},ce._ssrRegister=we):Ge&&(we=U?function(){Ge.call(this,this.$root.$options.shadowRoot)}:Ge),we)if(ce.functional){ce._injectStyles=we;var pe=ce.render;ce.render=function(lt,qe){return we.call(qe),pe(lt,qe)}}else{var Ee=ce.beforeCreate;ce.beforeCreate=Ee?[].concat(Ee,we):[we]}return{exports:E,options:ce}}var M=se(V,s,o,!1,null,null,null),ie=t.default=M.exports},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});function s(P,j){for(var V=[],H={},se=0;se<j.length;se++){var M=j[se],ie=M[0],E=M[1],X=M[2],K=M[3],te={id:P+":"+se,css:E,media:X,sourceMap:K};H[ie]?H[ie].parts.push(te):V.push(H[ie]={id:ie,parts:[te]})}return V}var o=typeof document<"u";if(typeof DEBUG<"u"&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var l={},a=o&&(document.head||document.getElementsByTagName("head")[0]),u=null,h=0,p=!1,d=function(){},_=null,m="data-vue-ssr-id",v=typeof navigator<"u"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function x(P,j,V,H){p=V,_=H||{};var se=s(P,j);return b(se),function(ie){for(var E=[],X=0;X<se.length;X++){var K=se[X],te=l[K.id];te.refs--,E.push(te)}ie?(se=s(P,ie),b(se)):se=[];for(var X=0;X<E.length;X++){var te=E[X];if(te.refs===0){for(var Ge=0;Ge<te.parts.length;Ge++)te.parts[Ge]();delete l[te.id]}}}}function b(P){for(var j=0;j<P.length;j++){var V=P[j],H=l[V.id];if(H){H.refs++;for(var se=0;se<H.parts.length;se++)H.parts[se](V.parts[se]);for(;se<V.parts.length;se++)H.parts.push(L(V.parts[se]));H.parts.length>V.parts.length&&(H.parts.length=V.parts.length)}else{for(var M=[],se=0;se<V.parts.length;se++)M.push(L(V.parts[se]));l[V.id]={id:V.id,refs:1,parts:M}}}}function w(){var P=document.createElement("style");return P.type="text/css",a.appendChild(P),P}function L(P){var j,V,H=document.querySelector("style["+m+'~="'+P.id+'"]');if(H){if(p)return d;H.parentNode.removeChild(H)}if(v){var se=h++;H=u||(u=w()),j=G.bind(null,H,se,!1),V=G.bind(null,H,se,!0)}else H=w(),j=W.bind(null,H),V=function(){H.parentNode.removeChild(H)};return j(P),function(ie){if(ie){if(ie.css===P.css&&ie.media===P.media&&ie.sourceMap===P.sourceMap)return;j(P=ie)}else V()}}var D=function(){var P=[];return function(j,V){return P[j]=V,P.filter(Boolean).join(`
`)}}();function G(P,j,V,H){var se=V?"":H.css;if(P.styleSheet)P.styleSheet.cssText=D(j,se);else{var M=document.createTextNode(se),ie=P.childNodes;ie[j]&&P.removeChild(ie[j]),ie.length?P.insertBefore(M,ie[j]):P.appendChild(M)}}function W(P,j){var V=j.css,H=j.media,se=j.sourceMap;if(H&&P.setAttribute("media",H),_.ssrId&&P.setAttribute(m,j.id),se&&(V+=`
/*# sourceURL=`+se.sources[0]+" */",V+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(se))))+" */"),P.styleSheet)P.styleSheet.cssText=V;else{for(;P.firstChild;)P.removeChild(P.firstChild);P.appendChild(document.createTextNode(V))}}}])})});var dw=He((Vh,uw)=>{(function(e,t){typeof Vh=="object"&&typeof uw=="object"?uw.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Vh=="object"?Vh.VueColor=t():e.VueColor=t()})(typeof self<"u"?self:Vh,function(){return function(e){function t(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(s,o,l){t.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},t.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(o,"a",o),o},t.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},t.p="",t(t.s=59)}([function(e,t){function n(o,l){var a=o[1]||"",u=o[3];if(!u)return a;if(l&&typeof btoa=="function"){var h=s(u);return[a].concat(u.sources.map(function(p){return"/*# sourceURL="+u.sourceRoot+p+" */"})).concat([h]).join(`
`)}return[a].join(`
`)}function s(o){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"}e.exports=function(o){var l=[];return l.toString=function(){return this.map(function(a){var u=n(a,o);return a[2]?"@media "+a[2]+"{"+u+"}":u}).join("")},l.i=function(a,u){typeof a=="string"&&(a=[[null,a,""]]);for(var h={},p=0;p<this.length;p++){var d=this[p][0];typeof d=="number"&&(h[d]=!0)}for(p=0;p<a.length;p++){var _=a[p];typeof _[0]=="number"&&h[_[0]]||(u&&!_[2]?_[2]=u:u&&(_[2]="("+_[2]+") and ("+u+")"),l.push(_))}},l}},function(e,t,n){function s(W){for(var P=0;P<W.length;P++){var j=W[P],V=d[j.id];if(V){V.refs++;for(var H=0;H<V.parts.length;H++)V.parts[H](j.parts[H]);for(;H<j.parts.length;H++)V.parts.push(l(j.parts[H]));V.parts.length>j.parts.length&&(V.parts.length=j.parts.length)}else{for(var se=[],H=0;H<j.parts.length;H++)se.push(l(j.parts[H]));d[j.id]={id:j.id,refs:1,parts:se}}}}function o(){var W=document.createElement("style");return W.type="text/css",_.appendChild(W),W}function l(W){var P,j,V=document.querySelector("style["+L+'~="'+W.id+'"]');if(V){if(x)return b;V.parentNode.removeChild(V)}if(D){var H=v++;V=m||(m=o()),P=a.bind(null,V,H,!1),j=a.bind(null,V,H,!0)}else V=o(),P=u.bind(null,V),j=function(){V.parentNode.removeChild(V)};return P(W),function(se){if(se){if(se.css===W.css&&se.media===W.media&&se.sourceMap===W.sourceMap)return;P(W=se)}else j()}}function a(W,P,j,V){var H=j?"":V.css;if(W.styleSheet)W.styleSheet.cssText=G(P,H);else{var se=document.createTextNode(H),M=W.childNodes;M[P]&&W.removeChild(M[P]),M.length?W.insertBefore(se,M[P]):W.appendChild(se)}}function u(W,P){var j=P.css,V=P.media,H=P.sourceMap;if(V&&W.setAttribute("media",V),w.ssrId&&W.setAttribute(L,P.id),H&&(j+=`
/*# sourceURL=`+H.sources[0]+" */",j+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(H))))+" */"),W.styleSheet)W.styleSheet.cssText=j;else{for(;W.firstChild;)W.removeChild(W.firstChild);W.appendChild(document.createTextNode(j))}}var h=typeof document<"u";if(typeof DEBUG<"u"&&DEBUG&&!h)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var p=n(63),d={},_=h&&(document.head||document.getElementsByTagName("head")[0]),m=null,v=0,x=!1,b=function(){},w=null,L="data-vue-ssr-id",D=typeof navigator<"u"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(W,P,j,V){x=j,w=V||{};var H=p(W,P);return s(H),function(se){for(var M=[],ie=0;ie<H.length;ie++){var E=H[ie],X=d[E.id];X.refs--,M.push(X)}se?(H=p(W,se),s(H)):H=[];for(var ie=0;ie<M.length;ie++){var X=M[ie];if(X.refs===0){for(var K=0;K<X.parts.length;K++)X.parts[K]();delete d[X.id]}}}};var G=function(){var W=[];return function(P,j){return W[P]=j,W.filter(Boolean).join(`
`)}}()},function(e,t){e.exports=function(n,s,o,l,a,u){var h,p=n=n||{},d=typeof n.default;d!=="object"&&d!=="function"||(h=n,p=n.default);var _=typeof p=="function"?p.options:p;s&&(_.render=s.render,_.staticRenderFns=s.staticRenderFns,_._compiled=!0),o&&(_.functional=!0),a&&(_._scopeId=a);var m;if(u?(m=function(b){b=b||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,b||typeof __VUE_SSR_CONTEXT__>"u"||(b=__VUE_SSR_CONTEXT__),l&&l.call(this,b),b&&b._registeredComponents&&b._registeredComponents.add(u)},_._ssrRegister=m):l&&(m=l),m){var v=_.functional,x=v?_.render:_.beforeCreate;v?(_._injectStyles=m,_.render=function(b,w){return m.call(w),x(b,w)}):_.beforeCreate=x?[].concat(x,m):[m]}return{esModule:h,exports:p,options:_}}},function(e,t,n){"use strict";function s(a,u){var h,p=a&&a.a;!(h=a&&a.hsl?(0,l.default)(a.hsl):a&&a.hex&&a.hex.length>0?(0,l.default)(a.hex):a&&a.hsv?(0,l.default)(a.hsv):a&&a.rgba?(0,l.default)(a.rgba):a&&a.rgb?(0,l.default)(a.rgb):(0,l.default)(a))||h._a!==void 0&&h._a!==null||h.setAlpha(p||1);var d=h.toHsl(),_=h.toHsv();return d.s===0&&(_.h=d.h=a.h||a.hsl&&a.hsl.h||u||0),{hsl:d,hex:h.toHexString().toUpperCase(),hex8:h.toHex8String().toUpperCase(),rgba:h.toRgb(),hsv:_,oldHue:a.h||u||d.h,source:a.source,a:a.a||h.getAlpha()}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(64),l=function(a){return a&&a.__esModule?a:{default:a}}(o);t.default={props:["value"],data:function(){return{val:s(this.value)}},computed:{colors:{get:function(){return this.val},set:function(a){this.val=a,this.$emit("input",a)}}},watch:{value:function(a){this.val=s(a)}},methods:{colorChange:function(a,u){this.oldHue=this.colors.hsl.h,this.colors=s(a,u||this.oldHue)},isValidHex:function(a){return(0,l.default)(a).isValid()},simpleCheckForValidColor:function(a){for(var u=["r","g","b","a","h","s","l","v"],h=0,p=0,d=0;d<u.length;d++){var _=u[d];a[_]&&(h++,isNaN(a[_])||p++)}if(h===p)return a},paletteUpperCase:function(a){return a.map(function(u){return u.toUpperCase()})},isTransparent:function(a){return(0,l.default)(a).getAlpha()===0}}}},function(e,t){var n=e.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=n)},function(e,t,n){"use strict";function s(m){h||n(65)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(36),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(67),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/common/EditableInput.vue",t.default=_.exports},function(e,t){var n={}.hasOwnProperty;e.exports=function(s,o){return n.call(s,o)}},function(e,t,n){var s=n(8),o=n(16);e.exports=n(9)?function(l,a,u){return s.f(l,a,o(1,u))}:function(l,a,u){return l[a]=u,l}},function(e,t,n){var s=n(13),o=n(42),l=n(25),a=Object.defineProperty;t.f=n(9)?Object.defineProperty:function(u,h,p){if(s(u),h=l(h,!0),s(p),o)try{return a(u,h,p)}catch{}if("get"in p||"set"in p)throw TypeError("Accessors not supported!");return"value"in p&&(u[h]=p.value),u}},function(e,t,n){e.exports=!n(15)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(e,t,n){var s=n(89),o=n(22);e.exports=function(l){return s(o(l))}},function(e,t,n){var s=n(29)("wks"),o=n(17),l=n(4).Symbol,a=typeof l=="function";(e.exports=function(u){return s[u]||(s[u]=a&&l[u]||(a?l:o)("Symbol."+u))}).store=s},function(e,t,n){"use strict";function s(m){h||n(111)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(50),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(113),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/common/Hue.vue",t.default=_.exports},function(e,t,n){var s=n(14);e.exports=function(o){if(!s(o))throw TypeError(o+" is not an object!");return o}},function(e,t){e.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},function(e,t){e.exports=function(n){try{return!!n()}catch{return!0}}},function(e,t){e.exports=function(n,s){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:s}}},function(e,t){var n=0,s=Math.random();e.exports=function(o){return"Symbol(".concat(o===void 0?"":o,")_",(++n+s).toString(36))}},function(e,t,n){"use strict";function s(m){h||n(123)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(53),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(127),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/common/Saturation.vue",t.default=_.exports},function(e,t,n){"use strict";function s(m){h||n(128)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(54),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(133),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/common/Alpha.vue",t.default=_.exports},function(e,t,n){"use strict";function s(m){h||n(130)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(55),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(132),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/common/Checkboard.vue",t.default=_.exports},function(e,t){var n=Math.ceil,s=Math.floor;e.exports=function(o){return isNaN(o=+o)?0:(o>0?s:n)(o)}},function(e,t){e.exports=function(n){if(n==null)throw TypeError("Can't call method on  "+n);return n}},function(e,t){e.exports=!0},function(e,t){var n=e.exports={version:"2.5.1"};typeof __e=="number"&&(__e=n)},function(e,t,n){var s=n(14);e.exports=function(o,l){if(!s(o))return o;var a,u;if(l&&typeof(a=o.toString)=="function"&&!s(u=a.call(o))||typeof(a=o.valueOf)=="function"&&!s(u=a.call(o))||!l&&typeof(a=o.toString)=="function"&&!s(u=a.call(o)))return u;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports={}},function(e,t,n){var s=n(46),o=n(30);e.exports=Object.keys||function(l){return s(l,o)}},function(e,t,n){var s=n(29)("keys"),o=n(17);e.exports=function(l){return s[l]||(s[l]=o(l))}},function(e,t,n){var s=n(4),o=s["__core-js_shared__"]||(s["__core-js_shared__"]={});e.exports=function(l){return o[l]||(o[l]={})}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var s=n(8).f,o=n(6),l=n(11)("toStringTag");e.exports=function(a,u,h){a&&!o(a=h?a:a.prototype,l)&&s(a,l,{configurable:!0,value:u})}},function(e,t,n){t.f=n(11)},function(e,t,n){var s=n(4),o=n(24),l=n(23),a=n(32),u=n(8).f;e.exports=function(h){var p=o.Symbol||(o.Symbol=l?{}:s.Symbol||{});h.charAt(0)=="_"||h in p||u(p,h,{value:a.f(h)})}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";function s(p){return p&&p.__esModule?p:{default:p}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),l=s(o),a=n(5),u=s(a),h=["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#CCCCCC","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"];t.default={name:"Compact",mixins:[l.default],props:{palette:{type:Array,default:function(){return h}}},components:{"ed-in":u.default},computed:{pick:function(){return this.colors.hex.toUpperCase()}},methods:{handlerClick:function(p){this.colorChange({hex:p,source:"hex"})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"editableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get:function(){return this.value},set:function(s){if(!(this.max!==void 0&&+s>this.max))return s;this.$refs.input.value=this.max}},labelId:function(){return"input__label__"+this.label+"__"+Math.random().toString().slice(2,5)},labelSpanText:function(){return this.labelText||this.label}},methods:{update:function(s){this.handleChange(s.target.value)},handleChange:function(s){var o={};o[this.label]=s,o.hex===void 0&&o["#"]===void 0?this.$emit("change",o):s.length>5&&this.$emit("change",o)},handleKeyDown:function(s){var o=this.val,l=Number(o);if(l){var a=this.arrowOffset||1;s.keyCode===38&&(o=l+a,this.handleChange(o),s.preventDefault()),s.keyCode===40&&(o=l-a,this.handleChange(o),s.preventDefault())}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),o=function(a){return a&&a.__esModule?a:{default:a}}(s),l=["#FFFFFF","#F2F2F2","#E6E6E6","#D9D9D9","#CCCCCC","#BFBFBF","#B3B3B3","#A6A6A6","#999999","#8C8C8C","#808080","#737373","#666666","#595959","#4D4D4D","#404040","#333333","#262626","#0D0D0D","#000000"];t.default={name:"Grayscale",mixins:[o.default],props:{palette:{type:Array,default:function(){return l}}},components:{},computed:{pick:function(){return this.colors.hex.toUpperCase()}},methods:{handlerClick:function(a){this.colorChange({hex:a,source:"hex"})}}}},function(e,t,n){"use strict";function s(h){return h&&h.__esModule?h:{default:h}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),l=s(o),a=n(3),u=s(a);t.default={name:"Material",mixins:[u.default],components:{"ed-in":l.default},methods:{onChange:function(h){h&&(h.hex?this.isValidHex(h.hex)&&this.colorChange({hex:h.hex,source:"hex"}):(h.r||h.g||h.b)&&this.colorChange({r:h.r||this.colors.rgba.r,g:h.g||this.colors.rgba.g,b:h.b||this.colors.rgba.b,a:h.a||this.colors.rgba.a,source:"rgba"}))}}}},function(e,t,n){"use strict";function s(d){return d&&d.__esModule?d:{default:d}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(80),l=s(o),a=n(3),u=s(a),h=n(12),p=s(h);t.default={name:"Slider",mixins:[u.default],props:{swatches:{type:Array,default:function(){return[{s:.5,l:.8},{s:.5,l:.65},{s:.5,l:.5},{s:.5,l:.35},{s:.5,l:.2}]}}},components:{hue:p.default},computed:{normalizedSwatches:function(){return this.swatches.map(function(d){return(d===void 0?"undefined":(0,l.default)(d))!=="object"?{s:.5,l:d}:d})}},methods:{isActive:function(d,_){var m=this.colors.hsl;return m.l===1&&d.l===1||m.l===0&&d.l===0||Math.abs(m.l-d.l)<.01&&Math.abs(m.s-d.s)<.01},hueChange:function(d){this.colorChange(d)},handleSwClick:function(d,_){this.colorChange({h:this.colors.hsl.h,s:_.s,l:_.l,source:"hsl"})}}}},function(e,t,n){"use strict";var s=n(23),o=n(41),l=n(44),a=n(7),u=n(6),h=n(26),p=n(87),d=n(31),_=n(94),m=n(11)("iterator"),v=!([].keys&&"next"in[].keys()),x=function(){return this};e.exports=function(b,w,L,D,G,W,P){p(L,w,D);var j,V,H,se=function(Re){if(!v&&Re in X)return X[Re];switch(Re){case"keys":case"values":return function(){return new L(this,Re)}}return function(){return new L(this,Re)}},M=w+" Iterator",ie=G=="values",E=!1,X=b.prototype,K=X[m]||X["@@iterator"]||G&&X[G],te=K||se(G),Ge=G?ie?se("entries"):te:void 0,ye=w=="Array"&&X.entries||K;if(ye&&(H=_(ye.call(new b)))!==Object.prototype&&H.next&&(d(H,M,!0),s||u(H,m)||a(H,m,x)),ie&&K&&K.name!=="values"&&(E=!0,te=function(){return K.call(this)}),s&&!P||!v&&!E&&X[m]||a(X,m,te),h[w]=te,h[M]=x,G)if(j={values:ie?te:se("values"),keys:W?te:se("keys"),entries:Ge},P)for(V in j)V in X||l(X,V,j[V]);else o(o.P+o.F*(v||E),w,j);return j}},function(e,t,n){var s=n(4),o=n(24),l=n(85),a=n(7),u=function(h,p,d){var _,m,v,x=h&u.F,b=h&u.G,w=h&u.S,L=h&u.P,D=h&u.B,G=h&u.W,W=b?o:o[p]||(o[p]={}),P=W.prototype,j=b?s:w?s[p]:(s[p]||{}).prototype;b&&(d=p);for(_ in d)(m=!x&&j&&j[_]!==void 0)&&_ in W||(v=m?j[_]:d[_],W[_]=b&&typeof j[_]!="function"?d[_]:D&&m?l(v,s):G&&j[_]==v?function(V){var H=function(se,M,ie){if(this instanceof V){switch(arguments.length){case 0:return new V;case 1:return new V(se);case 2:return new V(se,M)}return new V(se,M,ie)}return V.apply(this,arguments)};return H.prototype=V.prototype,H}(v):L&&typeof v=="function"?l(Function.call,v):v,L&&((W.virtual||(W.virtual={}))[_]=v,h&u.R&&P&&!P[_]&&a(P,_,v)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){e.exports=!n(9)&&!n(15)(function(){return Object.defineProperty(n(43)("div"),"a",{get:function(){return 7}}).a!=7})},function(e,t,n){var s=n(14),o=n(4).document,l=s(o)&&s(o.createElement);e.exports=function(a){return l?o.createElement(a):{}}},function(e,t,n){e.exports=n(7)},function(e,t,n){var s=n(13),o=n(88),l=n(30),a=n(28)("IE_PROTO"),u=function(){},h=function(){var p,d=n(43)("iframe"),_=l.length;for(d.style.display="none",n(93).appendChild(d),d.src="javascript:",p=d.contentWindow.document,p.open(),p.write("<script>document.F=Object<\/script>"),p.close(),h=p.F;_--;)delete h.prototype[l[_]];return h()};e.exports=Object.create||function(p,d){var _;return p!==null?(u.prototype=s(p),_=new u,u.prototype=null,_[a]=p):_=h(),d===void 0?_:o(_,d)}},function(e,t,n){var s=n(6),o=n(10),l=n(90)(!1),a=n(28)("IE_PROTO");e.exports=function(u,h){var p,d=o(u),_=0,m=[];for(p in d)p!=a&&s(d,p)&&m.push(p);for(;h.length>_;)s(d,p=h[_++])&&(~l(m,p)||m.push(p));return m}},function(e,t){var n={}.toString;e.exports=function(s){return n.call(s).slice(8,-1)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var s=n(46),o=n(30).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(l){return s(l,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data:function(){return{oldHue:0,pullDirection:""}},computed:{colors:function(){var s=this.value.hsl.h;return s!==0&&s-this.oldHue>0&&(this.pullDirection="right"),s!==0&&s-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=s,this.value},directionClass:function(){return{"vc-hue--horizontal":this.direction==="horizontal","vc-hue--vertical":this.direction==="vertical"}},pointerTop:function(){return this.direction==="vertical"?this.colors.hsl.h===0&&this.pullDirection==="right"?0:-100*this.colors.hsl.h/360+100+"%":0},pointerLeft:function(){return this.direction==="vertical"?0:this.colors.hsl.h===0&&this.pullDirection==="right"?"100%":100*this.colors.hsl.h/360+"%"}},methods:{handleChange:function(s,o){!o&&s.preventDefault();var l=this.$refs.container;if(l){var a,u,h=l.clientWidth,p=l.clientHeight,d=l.getBoundingClientRect().left+window.pageXOffset,_=l.getBoundingClientRect().top+window.pageYOffset,m=s.pageX||(s.touches?s.touches[0].pageX:0),v=s.pageY||(s.touches?s.touches[0].pageY:0),x=m-d,b=v-_;this.direction==="vertical"?(b<0?a=360:b>p?a=0:(u=-100*b/p+100,a=360*u/100),this.colors.hsl.h!==a&&this.$emit("change",{h:a,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(x<0?a=0:x>h?a=360:(u=100*x/h,a=360*u/100),this.colors.hsl.h!==a&&this.$emit("change",{h:a,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))}},handleMouseDown:function(s){this.handleChange(s,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp:function(s){this.unbindEventListeners()},unbindEventListeners:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}}},function(e,t,n){"use strict";function s(_){return _&&_.__esModule?_:{default:_}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(118),l=s(o),a=n(3),u=s(a),h=["red","pink","purple","deepPurple","indigo","blue","lightBlue","cyan","teal","green","lightGreen","lime","yellow","amber","orange","deepOrange","brown","blueGrey","black"],p=["900","700","500","300","100"],d=function(){var _=[];return h.forEach(function(m){var v=[];m.toLowerCase()==="black"||m.toLowerCase()==="white"?v=v.concat(["#000000","#FFFFFF"]):p.forEach(function(x){var b=l.default[m][x];v.push(b.toUpperCase())}),_.push(v)}),_}();t.default={name:"Swatches",mixins:[u.default],props:{palette:{type:Array,default:function(){return d}}},computed:{pick:function(){return this.colors.hex}},methods:{equal:function(_){return _.toLowerCase()===this.colors.hex.toLowerCase()},handlerClick:function(_){this.colorChange({hex:_,source:"hex"})}}}},function(e,t,n){"use strict";function s(x){return x&&x.__esModule?x:{default:x}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),l=s(o),a=n(5),u=s(a),h=n(18),p=s(h),d=n(12),_=s(d),m=n(19),v=s(m);t.default={name:"Photoshop",mixins:[l.default],props:{head:{type:String,default:"Color Picker"},disableFields:{type:Boolean,default:!1},hasResetButton:{type:Boolean,default:!1},acceptLabel:{type:String,default:"OK"},cancelLabel:{type:String,default:"Cancel"},resetLabel:{type:String,default:"Reset"},newLabel:{type:String,default:"new"},currentLabel:{type:String,default:"current"}},components:{saturation:p.default,hue:_.default,alpha:v.default,"ed-in":u.default},data:function(){return{currentColor:"#FFF"}},computed:{hsv:function(){var x=this.colors.hsv;return{h:x.h.toFixed(),s:(100*x.s).toFixed(),v:(100*x.v).toFixed()}},hex:function(){var x=this.colors.hex;return x&&x.replace("#","")}},created:function(){this.currentColor=this.colors.hex},methods:{childChange:function(x){this.colorChange(x)},inputChange:function(x){x&&(x["#"]?this.isValidHex(x["#"])&&this.colorChange({hex:x["#"],source:"hex"}):x.r||x.g||x.b||x.a?this.colorChange({r:x.r||this.colors.rgba.r,g:x.g||this.colors.rgba.g,b:x.b||this.colors.rgba.b,a:x.a||this.colors.rgba.a,source:"rgba"}):(x.h||x.s||x.v)&&this.colorChange({h:x.h||this.colors.hsv.h,s:x.s/100||this.colors.hsv.s,v:x.v/100||this.colors.hsv.v,source:"hsv"}))},clickCurrentColor:function(){this.colorChange({hex:this.currentColor,source:"hex"})},handleAccept:function(){this.$emit("ok")},handleCancel:function(){this.$emit("cancel")},handleReset:function(){this.$emit("reset")}}}},function(e,t,n){"use strict";function s(h){return h&&h.__esModule?h:{default:h}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(125),l=s(o),a=n(126),u=s(a);t.default={name:"Saturation",props:{value:Object},computed:{colors:function(){return this.value},bgColor:function(){return"hsl("+this.colors.hsv.h+", 100%, 50%)"},pointerTop:function(){return-100*this.colors.hsv.v+1+100+"%"},pointerLeft:function(){return 100*this.colors.hsv.s+"%"}},beforeDestroy:function(){this.unbindEventListeners()},methods:{throttle:(0,u.default)(function(h,p){h(p)},20,{leading:!0,trailing:!1}),handleChange:function(h,p){!p&&h.preventDefault();var d=this.$refs.container;if(d){var _=d.clientWidth,m=d.clientHeight,v=d.getBoundingClientRect().left+window.pageXOffset,x=d.getBoundingClientRect().top+window.pageYOffset,b=h.pageX||(h.touches?h.touches[0].pageX:0),w=h.pageY||(h.touches?h.touches[0].pageY:0),L=(0,l.default)(b-v,0,_),D=(0,l.default)(w-x,0,m),G=L/_,W=(0,l.default)(-D/m+1,0,1);this.throttle(this.onChange,{h:this.colors.hsv.h,s:G,v:W,a:this.colors.hsv.a,source:"hsva"})}},onChange:function(h){this.$emit("change",h)},handleMouseDown:function(h){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp:function(h){this.unbindEventListeners()},unbindEventListeners:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(20),o=function(l){return l&&l.__esModule?l:{default:l}}(s);t.default={name:"Alpha",props:{value:Object,onChange:Function},components:{checkboard:o.default},computed:{colors:function(){return this.value},gradientColor:function(){var l=this.colors.rgba,a=[l.r,l.g,l.b].join(",");return"linear-gradient(to right, rgba("+a+", 0) 0%, rgba("+a+", 1) 100%)"}},methods:{handleChange:function(l,a){!a&&l.preventDefault();var u=this.$refs.container;if(u){var h,p=u.clientWidth,d=u.getBoundingClientRect().left+window.pageXOffset,_=l.pageX||(l.touches?l.touches[0].pageX:0),m=_-d;h=m<0?0:m>p?1:Math.round(100*m/p)/100,this.colors.a!==h&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:h,source:"rgba"})}},handleMouseDown:function(l){this.handleChange(l,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp:function(){this.unbindEventListeners()},unbindEventListeners:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}}},function(e,t,n){"use strict";function s(a,u,h){if(typeof document>"u")return null;var p=document.createElement("canvas");p.width=p.height=2*h;var d=p.getContext("2d");return d?(d.fillStyle=a,d.fillRect(0,0,p.width,p.height),d.fillStyle=u,d.fillRect(0,0,h,h),d.translate(h,h),d.fillRect(0,0,h,h),p.toDataURL()):null}function o(a,u,h){var p=a+","+u+","+h;if(l[p])return l[p];var d=s(a,u,h);return l[p]=d,d}Object.defineProperty(t,"__esModule",{value:!0});var l={};t.default={name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle:function(){return{"background-image":"url("+o(this.white,this.grey,this.size)+")"}}}}},function(e,t,n){"use strict";function s(L){return L&&L.__esModule?L:{default:L}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),l=s(o),a=n(5),u=s(a),h=n(18),p=s(h),d=n(12),_=s(d),m=n(19),v=s(m),x=n(20),b=s(x),w=["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF","rgba(0,0,0,0)"];t.default={name:"Sketch",mixins:[l.default],components:{saturation:p.default,hue:_.default,alpha:v.default,"ed-in":u.default,checkboard:b.default},props:{presetColors:{type:Array,default:function(){return w}},disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},computed:{hex:function(){var L=void 0;return L=this.colors.a<1?this.colors.hex8:this.colors.hex,L.replace("#","")},activeColor:function(){var L=this.colors.rgba;return"rgba("+[L.r,L.g,L.b,L.a].join(",")+")"}},methods:{handlePreset:function(L){this.colorChange({hex:L,source:"hex"})},childChange:function(L){this.colorChange(L)},inputChange:function(L){L&&(L.hex?this.isValidHex(L.hex)&&this.colorChange({hex:L.hex,source:"hex"}):(L.r||L.g||L.b||L.a)&&this.colorChange({r:L.r||this.colors.rgba.r,g:L.g||this.colors.rgba.g,b:L.b||this.colors.rgba.b,a:L.a||this.colors.rgba.a,source:"rgba"}))}}}},function(e,t,n){"use strict";function s(w){return w&&w.__esModule?w:{default:w}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),l=s(o),a=n(5),u=s(a),h=n(18),p=s(h),d=n(12),_=s(d),m=n(19),v=s(m),x=n(20),b=s(x);t.default={name:"Chrome",mixins:[l.default],props:{disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},components:{saturation:p.default,hue:_.default,alpha:v.default,"ed-in":u.default,checkboard:b.default},data:function(){return{fieldsIndex:0,highlight:!1}},computed:{hsl:function(){var w=this.colors.hsl,L=w.h,D=w.s,G=w.l;return{h:L.toFixed(),s:(100*D).toFixed()+"%",l:(100*G).toFixed()+"%"}},activeColor:function(){var w=this.colors.rgba;return"rgba("+[w.r,w.g,w.b,w.a].join(",")+")"},hasAlpha:function(){return this.colors.a<1}},methods:{childChange:function(w){this.colorChange(w)},inputChange:function(w){if(w){if(w.hex)this.isValidHex(w.hex)&&this.colorChange({hex:w.hex,source:"hex"});else if(w.r||w.g||w.b||w.a)this.colorChange({r:w.r||this.colors.rgba.r,g:w.g||this.colors.rgba.g,b:w.b||this.colors.rgba.b,a:w.a||this.colors.rgba.a,source:"rgba"});else if(w.h||w.s||w.l){var L=w.s?w.s.replace("%","")/100:this.colors.hsl.s,D=w.l?w.l.replace("%","")/100:this.colors.hsl.l;this.colorChange({h:w.h||this.colors.hsl.h,s:L,l:D,source:"hsl"})}}},toggleViews:function(){if(this.fieldsIndex>=2)return void(this.fieldsIndex=0);this.fieldsIndex++},showHighlight:function(){this.highlight=!0},hideHighlight:function(){this.highlight=!1}}}},function(e,t,n){"use strict";function s(p){return p&&p.__esModule?p:{default:p}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),l=s(o),a=n(3),u=s(a),h=["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"];t.default={name:"Twitter",mixins:[u.default],components:{editableInput:l.default},props:{width:{type:[String,Number],default:276},defaultColors:{type:Array,default:function(){return h}},triangle:{default:"top-left",validator:function(p){return["hide","top-left","top-right"].includes(p)}}},computed:{hsv:function(){var p=this.colors.hsv;return{h:p.h.toFixed(),s:(100*p.s).toFixed(),v:(100*p.v).toFixed()}},hex:function(){var p=this.colors.hex;return p&&p.replace("#","")}},methods:{equal:function(p){return p.toLowerCase()===this.colors.hex.toLowerCase()},handlerClick:function(p){this.colorChange({hex:p,source:"hex"})},inputChange:function(p){p&&(p["#"]?this.isValidHex(p["#"])&&this.colorChange({hex:p["#"],source:"hex"}):p.r||p.g||p.b||p.a?this.colorChange({r:p.r||this.colors.rgba.r,g:p.g||this.colors.rgba.g,b:p.b||this.colors.rgba.b,a:p.a||this.colors.rgba.a,source:"rgba"}):(p.h||p.s||p.v)&&this.colorChange({h:p.h||this.colors.hsv.h,s:p.s/100||this.colors.hsv.s,v:p.v/100||this.colors.hsv.v,source:"hsv"}))}}}},function(e,t,n){"use strict";function s(U){return U&&U.__esModule?U:{default:U}}var o=n(60),l=s(o),a=n(69),u=s(a),h=n(73),p=s(h),d=n(77),_=s(d),m=n(115),v=s(m),x=n(120),b=s(x),w=n(135),L=s(w),D=n(139),G=s(D),W=n(143),P=s(W),j=n(19),V=s(j),H=n(20),se=s(H),M=n(5),ie=s(M),E=n(12),X=s(E),K=n(18),te=s(K),Ge=n(3),ye=s(Ge),Re={version:"2.8.2",Compact:l.default,Grayscale:u.default,Twitter:P.default,Material:p.default,Slider:_.default,Swatches:v.default,Photoshop:b.default,Sketch:L.default,Chrome:G.default,Alpha:V.default,Checkboard:se.default,EditableInput:ie.default,Hue:X.default,Saturation:te.default,ColorMixin:ye.default};e.exports=Re},function(e,t,n){"use strict";function s(m){h||n(61)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(35),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(68),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Compact.vue",t.default=_.exports},function(e,t,n){var s=n(62);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("6ce8a5a8",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-compact {
  padding-top: 5px;
  padding-left: 5px;
  width: 245px;
  border-radius: 2px;
  box-sizing: border-box;
  box-shadow: 0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16);
  background-color: #fff;
}
.vc-compact-colors {
  overflow: hidden;
  padding: 0;
  margin: 0;
}
.vc-compact-color-item {
  list-style: none;
  width: 15px;
  height: 15px;
  float: left;
  margin-right: 5px;
  margin-bottom: 5px;
  position: relative;
  cursor: pointer;
}
.vc-compact-color-item--white {
  box-shadow: inset 0 0 0 1px #ddd;
}
.vc-compact-color-item--white .vc-compact-dot {
  background: #000;
}
.vc-compact-dot {
  position: absolute;
  top: 5px;
  right: 5px;
  bottom: 5px;
  left: 5px;
  border-radius: 50%;
  opacity: 1;
  background: #fff;
}
`,""])},function(e,t){e.exports=function(n,s){for(var o=[],l={},a=0;a<s.length;a++){var u=s[a],h=u[0],p=u[1],d=u[2],_=u[3],m={id:n+":"+a,css:p,media:d,sourceMap:_};l[h]?l[h].parts.push(m):o.push(l[h]={id:h,parts:[m]})}return o}},function(e,t,n){var s;(function(o){function l(N,k){if(N=N||"",k=k||{},N instanceof l)return N;if(!(this instanceof l))return new l(N,k);var O=a(N);this._originalInput=N,this._r=O.r,this._g=O.g,this._b=O.b,this._a=O.a,this._roundA=Pe(100*this._a)/100,this._format=k.format||O.format,this._gradientType=k.gradientType,this._r<1&&(this._r=Pe(this._r)),this._g<1&&(this._g=Pe(this._g)),this._b<1&&(this._b=Pe(this._b)),this._ok=O.ok,this._tc_id=rt++}function a(N){var k={r:0,g:0,b:0},O=1,Z=null,ae=null,J=null,re=!1,de=!1;return typeof N=="string"&&(N=Ee(N)),typeof N=="object"&&(pe(N.r)&&pe(N.g)&&pe(N.b)?(k=u(N.r,N.g,N.b),re=!0,de=String(N.r).substr(-1)==="%"?"prgb":"rgb"):pe(N.h)&&pe(N.s)&&pe(N.v)?(Z=U(N.s),ae=U(N.v),k=_(N.h,Z,ae),re=!0,de="hsv"):pe(N.h)&&pe(N.s)&&pe(N.l)&&(Z=U(N.s),J=U(N.l),k=p(N.h,Z,J),re=!0,de="hsl"),N.hasOwnProperty("a")&&(O=N.a)),O=E(O),{ok:re,format:N.format||de,r:Je(255,et(k.r,0)),g:Je(255,et(k.g,0)),b:Je(255,et(k.b,0)),a:O}}function u(N,k,O){return{r:255*X(N,255),g:255*X(k,255),b:255*X(O,255)}}function h(N,k,O){N=X(N,255),k=X(k,255),O=X(O,255);var Z,ae,J=et(N,k,O),re=Je(N,k,O),de=(J+re)/2;if(J==re)Z=ae=0;else{var me=J-re;switch(ae=de>.5?me/(2-J-re):me/(J+re),J){case N:Z=(k-O)/me+(k<O?6:0);break;case k:Z=(O-N)/me+2;break;case O:Z=(N-k)/me+4}Z/=6}return{h:Z,s:ae,l:de}}function p(N,k,O){function Z(Ae,it,Xe){return Xe<0&&(Xe+=1),Xe>1&&(Xe-=1),Xe<1/6?Ae+6*(it-Ae)*Xe:Xe<.5?it:Xe<2/3?Ae+(it-Ae)*(2/3-Xe)*6:Ae}var ae,J,re;if(N=X(N,360),k=X(k,100),O=X(O,100),k===0)ae=J=re=O;else{var de=O<.5?O*(1+k):O+k-O*k,me=2*O-de;ae=Z(me,de,N+1/3),J=Z(me,de,N),re=Z(me,de,N-1/3)}return{r:255*ae,g:255*J,b:255*re}}function d(N,k,O){N=X(N,255),k=X(k,255),O=X(O,255);var Z,ae,J=et(N,k,O),re=Je(N,k,O),de=J,me=J-re;if(ae=J===0?0:me/J,J==re)Z=0;else{switch(J){case N:Z=(k-O)/me+(k<O?6:0);break;case k:Z=(O-N)/me+2;break;case O:Z=(N-k)/me+4}Z/=6}return{h:Z,s:ae,v:de}}function _(N,k,O){N=6*X(N,360),k=X(k,100),O=X(O,100);var Z=o.floor(N),ae=N-Z,J=O*(1-k),re=O*(1-ae*k),de=O*(1-(1-ae)*k),me=Z%6;return{r:255*[O,re,J,J,de,O][me],g:255*[de,O,O,re,J,J][me],b:255*[J,J,de,O,O,re][me]}}function m(N,k,O,Z){var ae=[Re(Pe(N).toString(16)),Re(Pe(k).toString(16)),Re(Pe(O).toString(16))];return Z&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0):ae.join("")}function v(N,k,O,Z,ae){var J=[Re(Pe(N).toString(16)),Re(Pe(k).toString(16)),Re(Pe(O).toString(16)),Re(ce(Z))];return ae&&J[0].charAt(0)==J[0].charAt(1)&&J[1].charAt(0)==J[1].charAt(1)&&J[2].charAt(0)==J[2].charAt(1)&&J[3].charAt(0)==J[3].charAt(1)?J[0].charAt(0)+J[1].charAt(0)+J[2].charAt(0)+J[3].charAt(0):J.join("")}function x(N,k,O,Z){return[Re(ce(Z)),Re(Pe(N).toString(16)),Re(Pe(k).toString(16)),Re(Pe(O).toString(16))].join("")}function b(N,k){k=k===0?0:k||10;var O=l(N).toHsl();return O.s-=k/100,O.s=K(O.s),l(O)}function w(N,k){k=k===0?0:k||10;var O=l(N).toHsl();return O.s+=k/100,O.s=K(O.s),l(O)}function L(N){return l(N).desaturate(100)}function D(N,k){k=k===0?0:k||10;var O=l(N).toHsl();return O.l+=k/100,O.l=K(O.l),l(O)}function G(N,k){k=k===0?0:k||10;var O=l(N).toRgb();return O.r=et(0,Je(255,O.r-Pe(-k/100*255))),O.g=et(0,Je(255,O.g-Pe(-k/100*255))),O.b=et(0,Je(255,O.b-Pe(-k/100*255))),l(O)}function W(N,k){k=k===0?0:k||10;var O=l(N).toHsl();return O.l-=k/100,O.l=K(O.l),l(O)}function P(N,k){var O=l(N).toHsl(),Z=(O.h+k)%360;return O.h=Z<0?360+Z:Z,l(O)}function j(N){var k=l(N).toHsl();return k.h=(k.h+180)%360,l(k)}function V(N){var k=l(N).toHsl(),O=k.h;return[l(N),l({h:(O+120)%360,s:k.s,l:k.l}),l({h:(O+240)%360,s:k.s,l:k.l})]}function H(N){var k=l(N).toHsl(),O=k.h;return[l(N),l({h:(O+90)%360,s:k.s,l:k.l}),l({h:(O+180)%360,s:k.s,l:k.l}),l({h:(O+270)%360,s:k.s,l:k.l})]}function se(N){var k=l(N).toHsl(),O=k.h;return[l(N),l({h:(O+72)%360,s:k.s,l:k.l}),l({h:(O+216)%360,s:k.s,l:k.l})]}function M(N,k,O){k=k||6,O=O||30;var Z=l(N).toHsl(),ae=360/O,J=[l(N)];for(Z.h=(Z.h-(ae*k>>1)+720)%360;--k;)Z.h=(Z.h+ae)%360,J.push(l(Z));return J}function ie(N,k){k=k||6;for(var O=l(N).toHsv(),Z=O.h,ae=O.s,J=O.v,re=[],de=1/k;k--;)re.push(l({h:Z,s:ae,v:J})),J=(J+de)%1;return re}function E(N){return N=parseFloat(N),(isNaN(N)||N<0||N>1)&&(N=1),N}function X(N,k){Ge(N)&&(N="100%");var O=ye(N);return N=Je(k,et(0,parseFloat(N))),O&&(N=parseInt(N*k,10)/100),o.abs(N-k)<1e-6?1:N%k/parseFloat(k)}function K(N){return Je(1,et(0,N))}function te(N){return parseInt(N,16)}function Ge(N){return typeof N=="string"&&N.indexOf(".")!=-1&&parseFloat(N)===1}function ye(N){return typeof N=="string"&&N.indexOf("%")!=-1}function Re(N){return N.length==1?"0"+N:""+N}function U(N){return N<=1&&(N=100*N+"%"),N}function ce(N){return o.round(255*parseFloat(N)).toString(16)}function we(N){return te(N)/255}function pe(N){return!!ge.CSS_UNIT.exec(N)}function Ee(N){N=N.replace(lt,"").replace(qe,"").toLowerCase();var k=!1;if(C[N])N=C[N],k=!0;else if(N=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var O;return(O=ge.rgb.exec(N))?{r:O[1],g:O[2],b:O[3]}:(O=ge.rgba.exec(N))?{r:O[1],g:O[2],b:O[3],a:O[4]}:(O=ge.hsl.exec(N))?{h:O[1],s:O[2],l:O[3]}:(O=ge.hsla.exec(N))?{h:O[1],s:O[2],l:O[3],a:O[4]}:(O=ge.hsv.exec(N))?{h:O[1],s:O[2],v:O[3]}:(O=ge.hsva.exec(N))?{h:O[1],s:O[2],v:O[3],a:O[4]}:(O=ge.hex8.exec(N))?{r:te(O[1]),g:te(O[2]),b:te(O[3]),a:we(O[4]),format:k?"name":"hex8"}:(O=ge.hex6.exec(N))?{r:te(O[1]),g:te(O[2]),b:te(O[3]),format:k?"name":"hex"}:(O=ge.hex4.exec(N))?{r:te(O[1]+""+O[1]),g:te(O[2]+""+O[2]),b:te(O[3]+""+O[3]),a:we(O[4]+""+O[4]),format:k?"name":"hex8"}:!!(O=ge.hex3.exec(N))&&{r:te(O[1]+""+O[1]),g:te(O[2]+""+O[2]),b:te(O[3]+""+O[3]),format:k?"name":"hex"}}function Fe(N){var k,O;return N=N||{level:"AA",size:"small"},k=(N.level||"AA").toUpperCase(),O=(N.size||"small").toLowerCase(),k!=="AA"&&k!=="AAA"&&(k="AA"),O!=="small"&&O!=="large"&&(O="small"),{level:k,size:O}}var lt=/^\s+/,qe=/\s+$/,rt=0,Pe=o.round,Je=o.min,et=o.max,Be=o.random;l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var N=this.toRgb();return(299*N.r+587*N.g+114*N.b)/1e3},getLuminance:function(){var N,k,O,Z,ae,J,re=this.toRgb();return N=re.r/255,k=re.g/255,O=re.b/255,Z=N<=.03928?N/12.92:o.pow((N+.055)/1.055,2.4),ae=k<=.03928?k/12.92:o.pow((k+.055)/1.055,2.4),J=O<=.03928?O/12.92:o.pow((O+.055)/1.055,2.4),.2126*Z+.7152*ae+.0722*J},setAlpha:function(N){return this._a=E(N),this._roundA=Pe(100*this._a)/100,this},toHsv:function(){var N=d(this._r,this._g,this._b);return{h:360*N.h,s:N.s,v:N.v,a:this._a}},toHsvString:function(){var N=d(this._r,this._g,this._b),k=Pe(360*N.h),O=Pe(100*N.s),Z=Pe(100*N.v);return this._a==1?"hsv("+k+", "+O+"%, "+Z+"%)":"hsva("+k+", "+O+"%, "+Z+"%, "+this._roundA+")"},toHsl:function(){var N=h(this._r,this._g,this._b);return{h:360*N.h,s:N.s,l:N.l,a:this._a}},toHslString:function(){var N=h(this._r,this._g,this._b),k=Pe(360*N.h),O=Pe(100*N.s),Z=Pe(100*N.l);return this._a==1?"hsl("+k+", "+O+"%, "+Z+"%)":"hsla("+k+", "+O+"%, "+Z+"%, "+this._roundA+")"},toHex:function(N){return m(this._r,this._g,this._b,N)},toHexString:function(N){return"#"+this.toHex(N)},toHex8:function(N){return v(this._r,this._g,this._b,this._a,N)},toHex8String:function(N){return"#"+this.toHex8(N)},toRgb:function(){return{r:Pe(this._r),g:Pe(this._g),b:Pe(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Pe(this._r)+", "+Pe(this._g)+", "+Pe(this._b)+")":"rgba("+Pe(this._r)+", "+Pe(this._g)+", "+Pe(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Pe(100*X(this._r,255))+"%",g:Pe(100*X(this._g,255))+"%",b:Pe(100*X(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Pe(100*X(this._r,255))+"%, "+Pe(100*X(this._g,255))+"%, "+Pe(100*X(this._b,255))+"%)":"rgba("+Pe(100*X(this._r,255))+"%, "+Pe(100*X(this._g,255))+"%, "+Pe(100*X(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(Q[m(this._r,this._g,this._b,!0)]||!1)},toFilter:function(N){var k="#"+x(this._r,this._g,this._b,this._a),O=k,Z=this._gradientType?"GradientType = 1, ":"";if(N){var ae=l(N);O="#"+x(ae._r,ae._g,ae._b,ae._a)}return"progid:DXImageTransform.Microsoft.gradient("+Z+"startColorstr="+k+",endColorstr="+O+")"},toString:function(N){var k=!!N;N=N||this._format;var O=!1,Z=this._a<1&&this._a>=0;return k||!Z||N!=="hex"&&N!=="hex6"&&N!=="hex3"&&N!=="hex4"&&N!=="hex8"&&N!=="name"?(N==="rgb"&&(O=this.toRgbString()),N==="prgb"&&(O=this.toPercentageRgbString()),N!=="hex"&&N!=="hex6"||(O=this.toHexString()),N==="hex3"&&(O=this.toHexString(!0)),N==="hex4"&&(O=this.toHex8String(!0)),N==="hex8"&&(O=this.toHex8String()),N==="name"&&(O=this.toName()),N==="hsl"&&(O=this.toHslString()),N==="hsv"&&(O=this.toHsvString()),O||this.toHexString()):N==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return l(this.toString())},_applyModification:function(N,k){var O=N.apply(null,[this].concat([].slice.call(k)));return this._r=O._r,this._g=O._g,this._b=O._b,this.setAlpha(O._a),this},lighten:function(){return this._applyModification(D,arguments)},brighten:function(){return this._applyModification(G,arguments)},darken:function(){return this._applyModification(W,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(w,arguments)},greyscale:function(){return this._applyModification(L,arguments)},spin:function(){return this._applyModification(P,arguments)},_applyCombination:function(N,k){return N.apply(null,[this].concat([].slice.call(k)))},analogous:function(){return this._applyCombination(M,arguments)},complement:function(){return this._applyCombination(j,arguments)},monochromatic:function(){return this._applyCombination(ie,arguments)},splitcomplement:function(){return this._applyCombination(se,arguments)},triad:function(){return this._applyCombination(V,arguments)},tetrad:function(){return this._applyCombination(H,arguments)}},l.fromRatio=function(N,k){if(typeof N=="object"){var O={};for(var Z in N)N.hasOwnProperty(Z)&&(O[Z]=Z==="a"?N[Z]:U(N[Z]));N=O}return l(N,k)},l.equals=function(N,k){return!(!N||!k)&&l(N).toRgbString()==l(k).toRgbString()},l.random=function(){return l.fromRatio({r:Be(),g:Be(),b:Be()})},l.mix=function(N,k,O){O=O===0?0:O||50;var Z=l(N).toRgb(),ae=l(k).toRgb(),J=O/100;return l({r:(ae.r-Z.r)*J+Z.r,g:(ae.g-Z.g)*J+Z.g,b:(ae.b-Z.b)*J+Z.b,a:(ae.a-Z.a)*J+Z.a})},l.readability=function(N,k){var O=l(N),Z=l(k);return(o.max(O.getLuminance(),Z.getLuminance())+.05)/(o.min(O.getLuminance(),Z.getLuminance())+.05)},l.isReadable=function(N,k,O){var Z,ae,J=l.readability(N,k);switch(ae=!1,Z=Fe(O),Z.level+Z.size){case"AAsmall":case"AAAlarge":ae=J>=4.5;break;case"AAlarge":ae=J>=3;break;case"AAAsmall":ae=J>=7}return ae},l.mostReadable=function(N,k,O){var Z,ae,J,re,de=null,me=0;O=O||{},ae=O.includeFallbackColors,J=O.level,re=O.size;for(var Ae=0;Ae<k.length;Ae++)(Z=l.readability(N,k[Ae]))>me&&(me=Z,de=l(k[Ae]));return l.isReadable(N,de,{level:J,size:re})||!ae?de:(O.includeFallbackColors=!1,l.mostReadable(N,["#fff","#000"],O))};var C=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Q=l.hexNames=function(N){var k={};for(var O in N)N.hasOwnProperty(O)&&(k[N[O]]=O);return k}(C),ge=function(){var N="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",k="[\\s|\\(]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")\\s*\\)?",O="[\\s|\\(]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")\\s*\\)?";return{CSS_UNIT:new RegExp(N),rgb:new RegExp("rgb"+k),rgba:new RegExp("rgba"+O),hsl:new RegExp("hsl"+k),hsla:new RegExp("hsla"+O),hsv:new RegExp("hsv"+k),hsva:new RegExp("hsva"+O),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();e!==void 0&&e.exports?e.exports=l:(s=function(){return l}.call(t,n,t,e))!==void 0&&(e.exports=s)})(Math)},function(e,t,n){var s=n(66);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("0f73e73c",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-editable-input {
  position: relative;
}
.vc-input__input {
  padding: 0;
  border: 0;
  outline: none;
}
.vc-input__label {
  text-transform: capitalize;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-editable-input"},[h("input",{directives:[{name:"model",rawName:"v-model",value:a.val,expression:"val"}],ref:"input",staticClass:"vc-input__input",attrs:{"aria-labelledby":a.labelId},domProps:{value:a.val},on:{keydown:a.handleKeyDown,input:[function(p){p.target.composing||(a.val=p.target.value)},a.update]}}),a._v(" "),h("span",{staticClass:"vc-input__label",attrs:{for:a.label,id:a.labelId}},[a._v(a._s(a.labelSpanText))]),a._v(" "),h("span",{staticClass:"vc-input__desc"},[a._v(a._s(a.desc))])])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-compact",attrs:{role:"application","aria-label":"Compact color picker"}},[h("ul",{staticClass:"vc-compact-colors",attrs:{role:"listbox"}},a._l(a.paletteUpperCase(a.palette),function(p){return h("li",{key:p,staticClass:"vc-compact-color-item",class:{"vc-compact-color-item--white":p==="#FFFFFF"},style:{background:p},attrs:{role:"option","aria-label":"color:"+p,"aria-selected":p===a.pick},on:{click:function(d){a.handlerClick(p)}}},[h("div",{directives:[{name:"show",rawName:"v-show",value:p===a.pick,expression:"c === pick"}],staticClass:"vc-compact-dot"})])}))])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(70)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(37),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(72),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Grayscale.vue",t.default=_.exports},function(e,t,n){var s=n(71);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("21ddbb74",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-grayscale {
  width: 125px;
  border-radius: 2px;
  box-shadow: 0 2px 15px rgba(0,0,0,.12), 0 2px 10px rgba(0,0,0,.16);
  background-color: #fff;
}
.vc-grayscale-colors {
  border-radius: 2px;
  overflow: hidden;
  padding: 0;
  margin: 0;
}
.vc-grayscale-color-item {
  list-style: none;
  width: 25px;
  height: 25px;
  float: left;
  position: relative;
  cursor: pointer;
}
.vc-grayscale-color-item--white .vc-grayscale-dot {
  background: #000;
}
.vc-grayscale-dot {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 6px;
  height: 6px;
  margin: -3px 0 0 -2px;
  border-radius: 50%;
  opacity: 1;
  background: #fff;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-grayscale",attrs:{role:"application","aria-label":"Grayscale color picker"}},[h("ul",{staticClass:"vc-grayscale-colors",attrs:{role:"listbox"}},a._l(a.paletteUpperCase(a.palette),function(p){return h("li",{key:p,staticClass:"vc-grayscale-color-item",class:{"vc-grayscale-color-item--white":p=="#FFFFFF"},style:{background:p},attrs:{role:"option","aria-label":"Color:"+p,"aria-selected":p===a.pick},on:{click:function(d){a.handlerClick(p)}}},[h("div",{directives:[{name:"show",rawName:"v-show",value:p===a.pick,expression:"c === pick"}],staticClass:"vc-grayscale-dot"})])}))])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(74)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(38),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(76),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Material.vue",t.default=_.exports},function(e,t,n){var s=n(75);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("1ff3af73",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-material {
  width: 98px;
  height: 98px;
  padding: 16px;
  font-family: "Roboto";
  position: relative;
  border-radius: 2px;
  box-shadow: 0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16);
  background-color: #fff;
}
.vc-material .vc-input__input {
  width: 100%;
  margin-top: 12px;
  font-size: 15px;
  color: #333;
  height: 30px;
}
.vc-material .vc-input__label {
  position: absolute;
  top: 0;
  left: 0;
  font-size: 11px;
  color: #999;
  text-transform: capitalize;
}
.vc-material-hex {
  border-bottom-width: 2px;
  border-bottom-style: solid;
}
.vc-material-split {
  display: flex;
  margin-right: -10px;
  padding-top: 11px;
}
.vc-material-third {
  flex: 1;
  padding-right: 10px;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-material",attrs:{role:"application","aria-label":"Material color picker"}},[h("ed-in",{staticClass:"vc-material-hex",style:{borderColor:a.colors.hex},attrs:{label:"hex"},on:{change:a.onChange},model:{value:a.colors.hex,callback:function(p){a.$set(a.colors,"hex",p)},expression:"colors.hex"}}),a._v(" "),h("div",{staticClass:"vc-material-split"},[h("div",{staticClass:"vc-material-third"},[h("ed-in",{attrs:{label:"r"},on:{change:a.onChange},model:{value:a.colors.rgba.r,callback:function(p){a.$set(a.colors.rgba,"r",p)},expression:"colors.rgba.r"}})],1),a._v(" "),h("div",{staticClass:"vc-material-third"},[h("ed-in",{attrs:{label:"g"},on:{change:a.onChange},model:{value:a.colors.rgba.g,callback:function(p){a.$set(a.colors.rgba,"g",p)},expression:"colors.rgba.g"}})],1),a._v(" "),h("div",{staticClass:"vc-material-third"},[h("ed-in",{attrs:{label:"b"},on:{change:a.onChange},model:{value:a.colors.rgba.b,callback:function(p){a.$set(a.colors.rgba,"b",p)},expression:"colors.rgba.b"}})],1)])],1)},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(78)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(39),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(114),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Slider.vue",t.default=_.exports},function(e,t,n){var s=n(79);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("7982aa43",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-slider {
  position: relative;
  width: 410px;
}
.vc-slider-hue-warp {
  height: 12px;
  position: relative;
}
.vc-slider-hue-warp .vc-hue-picker {
  width: 14px;
  height: 14px;
  border-radius: 6px;
  transform: translate(-7px, -2px);
  background-color: rgb(248, 248, 248);
  box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.37);
}
.vc-slider-swatches {
  display: flex;
  margin-top: 20px;
}
.vc-slider-swatch {
  margin-right: 1px;
  flex: 1;
  width: 20%;
}
.vc-slider-swatch:first-child {
  margin-right: 1px;
}
.vc-slider-swatch:first-child .vc-slider-swatch-picker {
  border-radius: 2px 0px 0px 2px;
}
.vc-slider-swatch:last-child {
  margin-right: 0;
}
.vc-slider-swatch:last-child .vc-slider-swatch-picker {
  border-radius: 0px 2px 2px 0px;
}
.vc-slider-swatch-picker {
  cursor: pointer;
  height: 12px;
}
.vc-slider-swatch:nth-child(n) .vc-slider-swatch-picker.vc-slider-swatch-picker--active {
  transform: scaleY(1.8);
  border-radius: 3.6px/2px;
}
.vc-slider-swatch-picker--white {
  box-shadow: inset 0 0 0 1px #ddd;
}
.vc-slider-swatch-picker--active.vc-slider-swatch-picker--white {
  box-shadow: inset 0 0 0 0.6px #ddd;
}
`,""])},function(e,t,n){"use strict";function s(p){return p&&p.__esModule?p:{default:p}}t.__esModule=!0;var o=n(81),l=s(o),a=n(100),u=s(a),h=typeof u.default=="function"&&typeof l.default=="symbol"?function(p){return typeof p}:function(p){return p&&typeof u.default=="function"&&p.constructor===u.default&&p!==u.default.prototype?"symbol":typeof p};t.default=typeof u.default=="function"&&h(l.default)==="symbol"?function(p){return p===void 0?"undefined":h(p)}:function(p){return p&&typeof u.default=="function"&&p.constructor===u.default&&p!==u.default.prototype?"symbol":p===void 0?"undefined":h(p)}},function(e,t,n){e.exports={default:n(82),__esModule:!0}},function(e,t,n){n(83),n(96),e.exports=n(32).f("iterator")},function(e,t,n){"use strict";var s=n(84)(!0);n(40)(String,"String",function(o){this._t=String(o),this._i=0},function(){var o,l=this._t,a=this._i;return a>=l.length?{value:void 0,done:!0}:(o=s(l,a),this._i+=o.length,{value:o,done:!1})})},function(e,t,n){var s=n(21),o=n(22);e.exports=function(l){return function(a,u){var h,p,d=String(o(a)),_=s(u),m=d.length;return _<0||_>=m?l?"":void 0:(h=d.charCodeAt(_),h<55296||h>56319||_+1===m||(p=d.charCodeAt(_+1))<56320||p>57343?l?d.charAt(_):h:l?d.slice(_,_+2):p-56320+(h-55296<<10)+65536)}}},function(e,t,n){var s=n(86);e.exports=function(o,l,a){if(s(o),l===void 0)return o;switch(a){case 1:return function(u){return o.call(l,u)};case 2:return function(u,h){return o.call(l,u,h)};case 3:return function(u,h,p){return o.call(l,u,h,p)}}return function(){return o.apply(l,arguments)}}},function(e,t){e.exports=function(n){if(typeof n!="function")throw TypeError(n+" is not a function!");return n}},function(e,t,n){"use strict";var s=n(45),o=n(16),l=n(31),a={};n(7)(a,n(11)("iterator"),function(){return this}),e.exports=function(u,h,p){u.prototype=s(a,{next:o(1,p)}),l(u,h+" Iterator")}},function(e,t,n){var s=n(8),o=n(13),l=n(27);e.exports=n(9)?Object.defineProperties:function(a,u){o(a);for(var h,p=l(u),d=p.length,_=0;d>_;)s.f(a,h=p[_++],u[h]);return a}},function(e,t,n){var s=n(47);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(o){return s(o)=="String"?o.split(""):Object(o)}},function(e,t,n){var s=n(10),o=n(91),l=n(92);e.exports=function(a){return function(u,h,p){var d,_=s(u),m=o(_.length),v=l(p,m);if(a&&h!=h){for(;m>v;)if((d=_[v++])!=d)return!0}else for(;m>v;v++)if((a||v in _)&&_[v]===h)return a||v||0;return!a&&-1}}},function(e,t,n){var s=n(21),o=Math.min;e.exports=function(l){return l>0?o(s(l),9007199254740991):0}},function(e,t,n){var s=n(21),o=Math.max,l=Math.min;e.exports=function(a,u){return a=s(a),a<0?o(a+u,0):l(a,u)}},function(e,t,n){var s=n(4).document;e.exports=s&&s.documentElement},function(e,t,n){var s=n(6),o=n(95),l=n(28)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(u){return u=o(u),s(u,l)?u[l]:typeof u.constructor=="function"&&u instanceof u.constructor?u.constructor.prototype:u instanceof Object?a:null}},function(e,t,n){var s=n(22);e.exports=function(o){return Object(s(o))}},function(e,t,n){n(97);for(var s=n(4),o=n(7),l=n(26),a=n(11)("toStringTag"),u="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),h=0;h<u.length;h++){var p=u[h],d=s[p],_=d&&d.prototype;_&&!_[a]&&o(_,a,p),l[p]=l.Array}},function(e,t,n){"use strict";var s=n(98),o=n(99),l=n(26),a=n(10);e.exports=n(40)(Array,"Array",function(u,h){this._t=a(u),this._i=0,this._k=h},function(){var u=this._t,h=this._k,p=this._i++;return!u||p>=u.length?(this._t=void 0,o(1)):h=="keys"?o(0,p):h=="values"?o(0,u[p]):o(0,[p,u[p]])},"values"),l.Arguments=l.Array,s("keys"),s("values"),s("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(n,s){return{value:s,done:!!n}}},function(e,t,n){e.exports={default:n(101),__esModule:!0}},function(e,t,n){n(102),n(108),n(109),n(110),e.exports=n(24).Symbol},function(e,t,n){"use strict";var s=n(4),o=n(6),l=n(9),a=n(41),u=n(44),h=n(103).KEY,p=n(15),d=n(29),_=n(31),m=n(17),v=n(11),x=n(32),b=n(33),w=n(104),L=n(105),D=n(13),G=n(10),W=n(25),P=n(16),j=n(45),V=n(106),H=n(107),se=n(8),M=n(27),ie=H.f,E=se.f,X=V.f,K=s.Symbol,te=s.JSON,Ge=te&&te.stringify,ye=v("_hidden"),Re=v("toPrimitive"),U={}.propertyIsEnumerable,ce=d("symbol-registry"),we=d("symbols"),pe=d("op-symbols"),Ee=Object.prototype,Fe=typeof K=="function",lt=s.QObject,qe=!lt||!lt.prototype||!lt.prototype.findChild,rt=l&&p(function(){return j(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a!=7})?function(re,de,me){var Ae=ie(Ee,de);Ae&&delete Ee[de],E(re,de,me),Ae&&re!==Ee&&E(Ee,de,Ae)}:E,Pe=function(re){var de=we[re]=j(K.prototype);return de._k=re,de},Je=Fe&&typeof K.iterator=="symbol"?function(re){return typeof re=="symbol"}:function(re){return re instanceof K},et=function(re,de,me){return re===Ee&&et(pe,de,me),D(re),de=W(de,!0),D(me),o(we,de)?(me.enumerable?(o(re,ye)&&re[ye][de]&&(re[ye][de]=!1),me=j(me,{enumerable:P(0,!1)})):(o(re,ye)||E(re,ye,P(1,{})),re[ye][de]=!0),rt(re,de,me)):E(re,de,me)},Be=function(re,de){D(re);for(var me,Ae=w(de=G(de)),it=0,Xe=Ae.length;Xe>it;)et(re,me=Ae[it++],de[me]);return re},C=function(re,de){return de===void 0?j(re):Be(j(re),de)},Q=function(re){var de=U.call(this,re=W(re,!0));return!(this===Ee&&o(we,re)&&!o(pe,re))&&(!(de||!o(this,re)||!o(we,re)||o(this,ye)&&this[ye][re])||de)},ge=function(re,de){if(re=G(re),de=W(de,!0),re!==Ee||!o(we,de)||o(pe,de)){var me=ie(re,de);return!me||!o(we,de)||o(re,ye)&&re[ye][de]||(me.enumerable=!0),me}},N=function(re){for(var de,me=X(G(re)),Ae=[],it=0;me.length>it;)o(we,de=me[it++])||de==ye||de==h||Ae.push(de);return Ae},k=function(re){for(var de,me=re===Ee,Ae=X(me?pe:G(re)),it=[],Xe=0;Ae.length>Xe;)!o(we,de=Ae[Xe++])||me&&!o(Ee,de)||it.push(we[de]);return it};Fe||(K=function(){if(this instanceof K)throw TypeError("Symbol is not a constructor!");var re=m(arguments.length>0?arguments[0]:void 0),de=function(me){this===Ee&&de.call(pe,me),o(this,ye)&&o(this[ye],re)&&(this[ye][re]=!1),rt(this,re,P(1,me))};return l&&qe&&rt(Ee,re,{configurable:!0,set:de}),Pe(re)},u(K.prototype,"toString",function(){return this._k}),H.f=ge,se.f=et,n(49).f=V.f=N,n(34).f=Q,n(48).f=k,l&&!n(23)&&u(Ee,"propertyIsEnumerable",Q,!0),x.f=function(re){return Pe(v(re))}),a(a.G+a.W+a.F*!Fe,{Symbol:K});for(var O="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Z=0;O.length>Z;)v(O[Z++]);for(var ae=M(v.store),J=0;ae.length>J;)b(ae[J++]);a(a.S+a.F*!Fe,"Symbol",{for:function(re){return o(ce,re+="")?ce[re]:ce[re]=K(re)},keyFor:function(re){if(!Je(re))throw TypeError(re+" is not a symbol!");for(var de in ce)if(ce[de]===re)return de},useSetter:function(){qe=!0},useSimple:function(){qe=!1}}),a(a.S+a.F*!Fe,"Object",{create:C,defineProperty:et,defineProperties:Be,getOwnPropertyDescriptor:ge,getOwnPropertyNames:N,getOwnPropertySymbols:k}),te&&a(a.S+a.F*(!Fe||p(function(){var re=K();return Ge([re])!="[null]"||Ge({a:re})!="{}"||Ge(Object(re))!="{}"})),"JSON",{stringify:function(re){if(re!==void 0&&!Je(re)){for(var de,me,Ae=[re],it=1;arguments.length>it;)Ae.push(arguments[it++]);return de=Ae[1],typeof de=="function"&&(me=de),!me&&L(de)||(de=function(Xe,mn){if(me&&(mn=me.call(this,Xe,mn)),!Je(mn))return mn}),Ae[1]=de,Ge.apply(te,Ae)}}}),K.prototype[Re]||n(7)(K.prototype,Re,K.prototype.valueOf),_(K,"Symbol"),_(Math,"Math",!0),_(s.JSON,"JSON",!0)},function(e,t,n){var s=n(17)("meta"),o=n(14),l=n(6),a=n(8).f,u=0,h=Object.isExtensible||function(){return!0},p=!n(15)(function(){return h(Object.preventExtensions({}))}),d=function(b){a(b,s,{value:{i:"O"+ ++u,w:{}}})},_=function(b,w){if(!o(b))return typeof b=="symbol"?b:(typeof b=="string"?"S":"P")+b;if(!l(b,s)){if(!h(b))return"F";if(!w)return"E";d(b)}return b[s].i},m=function(b,w){if(!l(b,s)){if(!h(b))return!0;if(!w)return!1;d(b)}return b[s].w},v=function(b){return p&&x.NEED&&h(b)&&!l(b,s)&&d(b),b},x=e.exports={KEY:s,NEED:!1,fastKey:_,getWeak:m,onFreeze:v}},function(e,t,n){var s=n(27),o=n(48),l=n(34);e.exports=function(a){var u=s(a),h=o.f;if(h)for(var p,d=h(a),_=l.f,m=0;d.length>m;)_.call(a,p=d[m++])&&u.push(p);return u}},function(e,t,n){var s=n(47);e.exports=Array.isArray||function(o){return s(o)=="Array"}},function(e,t,n){var s=n(10),o=n(49).f,l={}.toString,a=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],u=function(h){try{return o(h)}catch{return a.slice()}};e.exports.f=function(h){return a&&l.call(h)=="[object Window]"?u(h):o(s(h))}},function(e,t,n){var s=n(34),o=n(16),l=n(10),a=n(25),u=n(6),h=n(42),p=Object.getOwnPropertyDescriptor;t.f=n(9)?p:function(d,_){if(d=l(d),_=a(_,!0),h)try{return p(d,_)}catch{}if(u(d,_))return o(!s.f.call(d,_),d[_])}},function(e,t){},function(e,t,n){n(33)("asyncIterator")},function(e,t,n){n(33)("observable")},function(e,t,n){var s=n(112);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("7c5f1a1c",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-hue {
  position: absolute;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  border-radius: 2px;
}
.vc-hue--horizontal {
  background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
}
.vc-hue--vertical {
  background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
}
.vc-hue-container {
  cursor: pointer;
  margin: 0 2px;
  position: relative;
  height: 100%;
}
.vc-hue-pointer {
  z-index: 2;
  position: absolute;
}
.vc-hue-picker {
  cursor: pointer;
  margin-top: 1px;
  width: 4px;
  border-radius: 1px;
  height: 8px;
  box-shadow: 0 0 2px rgba(0, 0, 0, .6);
  background: #fff;
  transform: translateX(-2px) ;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{class:["vc-hue",a.directionClass]},[h("div",{ref:"container",staticClass:"vc-hue-container",attrs:{role:"slider","aria-valuenow":a.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360"},on:{mousedown:a.handleMouseDown,touchmove:a.handleChange,touchstart:a.handleChange}},[h("div",{staticClass:"vc-hue-pointer",style:{top:a.pointerTop,left:a.pointerLeft},attrs:{role:"presentation"}},[h("div",{staticClass:"vc-hue-picker"})])])])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-slider",attrs:{role:"application","aria-label":"Slider color picker"}},[h("div",{staticClass:"vc-slider-hue-warp"},[h("hue",{on:{change:a.hueChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1),a._v(" "),h("div",{staticClass:"vc-slider-swatches",attrs:{role:"group"}},a._l(a.normalizedSwatches,function(p,d){return h("div",{key:d,staticClass:"vc-slider-swatch",attrs:{"data-index":d,"aria-label":"color:"+a.colors.hex,role:"button"},on:{click:function(_){a.handleSwClick(d,p)}}},[h("div",{staticClass:"vc-slider-swatch-picker",class:{"vc-slider-swatch-picker--active":a.isActive(p,d),"vc-slider-swatch-picker--white":p.l===1},style:{background:"hsl("+a.colors.hsl.h+", "+100*p.s+"%, "+100*p.l+"%)"}})])}))])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(116)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(51),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(119),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Swatches.vue",t.default=_.exports},function(e,t,n){var s=n(117);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("10f839a2",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-swatches {
  width: 320px;
  height: 240px;
  overflow-y: scroll;
  background-color: #fff;
  box-shadow: 0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16);
}
.vc-swatches-box {
  padding: 16px 0 6px 16px;
  overflow: hidden;
}
.vc-swatches-color-group {
  padding-bottom: 10px;
  width: 40px;
  float: left;
  margin-right: 10px;
}
.vc-swatches-color-it {
  box-sizing: border-box;
  width: 40px;
  height: 24px;
  cursor: pointer;
  background: #880e4f;
  margin-bottom: 1px;
  overflow: hidden;
  -ms-border-radius: 2px 2px 0 0;
  -moz-border-radius: 2px 2px 0 0;
  -o-border-radius: 2px 2px 0 0;
  -webkit-border-radius: 2px 2px 0 0;
  border-radius: 2px 2px 0 0;
}
.vc-swatches-color--white {
  border: 1px solid #DDD;
}
.vc-swatches-pick {
  fill: rgb(255, 255, 255);
  margin-left: 8px;
  display: block;
}
.vc-swatches-color--white .vc-swatches-pick {
  fill: rgb(51, 51, 51);
}
`,""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"red",function(){return s}),n.d(t,"pink",function(){return o}),n.d(t,"purple",function(){return l}),n.d(t,"deepPurple",function(){return a}),n.d(t,"indigo",function(){return u}),n.d(t,"blue",function(){return h}),n.d(t,"lightBlue",function(){return p}),n.d(t,"cyan",function(){return d}),n.d(t,"teal",function(){return _}),n.d(t,"green",function(){return m}),n.d(t,"lightGreen",function(){return v}),n.d(t,"lime",function(){return x}),n.d(t,"yellow",function(){return b}),n.d(t,"amber",function(){return w}),n.d(t,"orange",function(){return L}),n.d(t,"deepOrange",function(){return D}),n.d(t,"brown",function(){return G}),n.d(t,"grey",function(){return W}),n.d(t,"blueGrey",function(){return P}),n.d(t,"darkText",function(){return j}),n.d(t,"lightText",function(){return V}),n.d(t,"darkIcons",function(){return H}),n.d(t,"lightIcons",function(){return se}),n.d(t,"white",function(){return M}),n.d(t,"black",function(){return ie});var s={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},o={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},l={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},a={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},u={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},h={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},p={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},d={50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},_={50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},m={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},v={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},x={50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},b={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},w={50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},L={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},D={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},G={50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723"},W={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},P={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238"},j={primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},V={primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},H={active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},se={active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},M="#ffffff",ie="#000000";t.default={red:s,pink:o,purple:l,deepPurple:a,indigo:u,blue:h,lightBlue:p,cyan:d,teal:_,green:m,lightGreen:v,lime:x,yellow:b,amber:w,orange:L,deepOrange:D,brown:G,grey:W,blueGrey:P,darkText:j,lightText:V,darkIcons:H,lightIcons:se,white:M,black:ie}},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-swatches",attrs:{role:"application","aria-label":"Swatches color picker","data-pick":a.pick}},[h("div",{staticClass:"vc-swatches-box",attrs:{role:"listbox"}},a._l(a.palette,function(p,d){return h("div",{key:d,staticClass:"vc-swatches-color-group"},a._l(p,function(_){return h("div",{key:_,class:["vc-swatches-color-it",{"vc-swatches-color--white":_==="#FFFFFF"}],style:{background:_},attrs:{role:"option","aria-label":"Color:"+_,"aria-selected":a.equal(_),"data-color":_},on:{click:function(m){a.handlerClick(_)}}},[h("div",{directives:[{name:"show",rawName:"v-show",value:a.equal(_),expression:"equal(c)"}],staticClass:"vc-swatches-pick"},[h("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[h("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}})])])])}))}))])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(121)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(52),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(134),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Photoshop.vue",t.default=_.exports},function(e,t,n){var s=n(122);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("080365d4",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-photoshop {
  background: #DCDCDC;
  border-radius: 4px;
  box-shadow: 0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15);
  box-sizing: initial;
  width: 513px;
  font-family: Roboto;
}
.vc-photoshop__disable-fields {
  width: 390px;
}
.vc-ps-head {
  background-image: linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%);
  border-bottom: 1px solid #B1B1B1;
  box-shadow: inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02);
  height: 23px;
  line-height: 24px;
  border-radius: 4px 4px 0 0;
  font-size: 13px;
  color: #4D4D4D;
  text-align: center;
}
.vc-ps-body {
  padding: 15px;
  display: flex;
}
.vc-ps-saturation-wrap {
  width: 256px;
  height: 256px;
  position: relative;
  border: 2px solid #B3B3B3;
  border-bottom: 2px solid #F0F0F0;
  overflow: hidden;
}
.vc-ps-saturation-wrap .vc-saturation-circle {
  width: 12px;
  height: 12px;
}
.vc-ps-hue-wrap {
  position: relative;
  height: 256px;
  width: 19px;
  margin-left: 10px;
  border: 2px solid #B3B3B3;
  border-bottom: 2px solid #F0F0F0;
}
.vc-ps-hue-pointer {
  position: relative;
}
.vc-ps-hue-pointer--left,
.vc-ps-hue-pointer--right {
  position: absolute;
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 5px 0 5px 8px;
  border-color: transparent transparent transparent #555;
}
.vc-ps-hue-pointer--left:after,
.vc-ps-hue-pointer--right:after {
  content: "";
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 4px 0 4px 6px;
  border-color: transparent transparent transparent #fff;
  position: absolute;
  top: 1px;
  left: 1px;
  transform: translate(-8px, -5px);
}
.vc-ps-hue-pointer--left {
  transform: translate(-13px, -4px);
}
.vc-ps-hue-pointer--right {
  transform: translate(20px, -4px) rotate(180deg);
}
.vc-ps-controls {
  width: 180px;
  margin-left: 10px;
  display: flex;
}
.vc-ps-controls__disable-fields {
  width: auto;
}
.vc-ps-actions {
  margin-left: 20px;
  flex: 1;
}
.vc-ps-ac-btn {
  cursor: pointer;
  background-image: linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%);
  border: 1px solid #878787;
  border-radius: 2px;
  height: 20px;
  box-shadow: 0 1px 0 0 #EAEAEA;
  font-size: 14px;
  color: #000;
  line-height: 20px;
  text-align: center;
  margin-bottom: 10px;
}
.vc-ps-previews {
  width: 60px;
}
.vc-ps-previews__swatches {
  border: 1px solid #B3B3B3;
  border-bottom: 1px solid #F0F0F0;
  margin-bottom: 2px;
  margin-top: 1px;
}
.vc-ps-previews__pr-color {
  height: 34px;
  box-shadow: inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000;
}
.vc-ps-previews__label {
  font-size: 14px;
  color: #000;
  text-align: center;
}
.vc-ps-fields {
  padding-top: 5px;
  padding-bottom: 9px;
  width: 80px;
  position: relative;
}
.vc-ps-fields .vc-input__input {
  margin-left: 40%;
  width: 40%;
  height: 18px;
  border: 1px solid #888888;
  box-shadow: inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC;
  margin-bottom: 5px;
  font-size: 13px;
  padding-left: 3px;
  margin-right: 10px;
}
.vc-ps-fields .vc-input__label, .vc-ps-fields .vc-input__desc {
  top: 0;
  text-transform: uppercase;
  font-size: 13px;
  height: 18px;
  line-height: 22px;
  position: absolute;
}
.vc-ps-fields .vc-input__label {
  left: 0;
  width: 34px;
}
.vc-ps-fields .vc-input__desc {
  right: 0;
  width: 0;
}
.vc-ps-fields__divider {
  height: 5px;
}
.vc-ps-fields__hex .vc-input__input {
  margin-left: 20%;
  width: 80%;
  height: 18px;
  border: 1px solid #888888;
  box-shadow: inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC;
  margin-bottom: 6px;
  font-size: 13px;
  padding-left: 3px;
}
.vc-ps-fields__hex .vc-input__label {
  position: absolute;
  top: 0;
  left: 0;
  width: 14px;
  text-transform: uppercase;
  font-size: 13px;
  height: 18px;
  line-height: 22px;
}
`,""])},function(e,t,n){var s=n(124);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("b5380e52",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-saturation,
.vc-saturation--white,
.vc-saturation--black {
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}
.vc-saturation--white {
  background: linear-gradient(to right, #fff, rgba(255,255,255,0));
}
.vc-saturation--black {
  background: linear-gradient(to top, #000, rgba(0,0,0,0));
}
.vc-saturation-pointer {
  cursor: pointer;
  position: absolute;
}
.vc-saturation-circle {
  cursor: pointer;
  width: 4px;
  height: 4px;
  box-shadow: 0 0 0 1.6px #fff, inset 0 0 1px 1px rgba(0,0,0,.3), 0 0 1px 2px rgba(0,0,0,.4);
  border-radius: 50%;
  transform: translate(-2px, -2px);
}
`,""])},function(e,t){function n(s,o,l){return o<l?s<o?o:s>l?l:s:s<l?l:s>o?o:s}e.exports=n},function(e,t){function n(H,se,M){function ie(et){var Be=ce,C=we;return ce=we=void 0,qe=et,Ee=H.apply(C,Be)}function E(et){return qe=et,Fe=setTimeout(te,se),rt?ie(et):Ee}function X(et){var Be=et-lt,C=et-qe,Q=se-Be;return Pe?j(Q,pe-C):Q}function K(et){var Be=et-lt,C=et-qe;return lt===void 0||Be>=se||Be<0||Pe&&C>=pe}function te(){var et=V();if(K(et))return Ge(et);Fe=setTimeout(te,X(et))}function Ge(et){return Fe=void 0,Je&&ce?ie(et):(ce=we=void 0,Ee)}function ye(){Fe!==void 0&&clearTimeout(Fe),qe=0,ce=lt=we=Fe=void 0}function Re(){return Fe===void 0?Ee:Ge(V())}function U(){var et=V(),Be=K(et);if(ce=arguments,we=this,lt=et,Be){if(Fe===void 0)return E(lt);if(Pe)return Fe=setTimeout(te,se),ie(lt)}return Fe===void 0&&(Fe=setTimeout(te,se)),Ee}var ce,we,pe,Ee,Fe,lt,qe=0,rt=!1,Pe=!1,Je=!0;if(typeof H!="function")throw new TypeError(h);return se=u(se)||0,o(M)&&(rt=!!M.leading,Pe="maxWait"in M,pe=Pe?P(u(M.maxWait)||0,se):pe,Je="trailing"in M?!!M.trailing:Je),U.cancel=ye,U.flush=Re,U}function s(H,se,M){var ie=!0,E=!0;if(typeof H!="function")throw new TypeError(h);return o(M)&&(ie="leading"in M?!!M.leading:ie,E="trailing"in M?!!M.trailing:E),n(H,se,{leading:ie,maxWait:se,trailing:E})}function o(H){var se=typeof H;return!!H&&(se=="object"||se=="function")}function l(H){return!!H&&typeof H=="object"}function a(H){return typeof H=="symbol"||l(H)&&W.call(H)==d}function u(H){if(typeof H=="number")return H;if(a(H))return p;if(o(H)){var se=typeof H.valueOf=="function"?H.valueOf():H;H=o(se)?se+"":se}if(typeof H!="string")return H===0?H:+H;H=H.replace(_,"");var M=v.test(H);return M||x.test(H)?b(H.slice(2),M?2:8):m.test(H)?p:+H}var h="Expected a function",p=NaN,d="[object Symbol]",_=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,x=/^0o[0-7]+$/i,b=parseInt,w=typeof global=="object"&&global&&global.Object===Object&&global,L=typeof self=="object"&&self&&self.Object===Object&&self,D=w||L||Function("return this")(),G=Object.prototype,W=G.toString,P=Math.max,j=Math.min,V=function(){return D.Date.now()};e.exports=s},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{ref:"container",staticClass:"vc-saturation",style:{background:a.bgColor},on:{mousedown:a.handleMouseDown,touchmove:a.handleChange,touchstart:a.handleChange}},[h("div",{staticClass:"vc-saturation--white"}),a._v(" "),h("div",{staticClass:"vc-saturation--black"}),a._v(" "),h("div",{staticClass:"vc-saturation-pointer",style:{top:a.pointerTop,left:a.pointerLeft}},[h("div",{staticClass:"vc-saturation-circle"})])])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){var s=n(129);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("4dc1b086",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-alpha {
  position: absolute;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
}
.vc-alpha-checkboard-wrap {
  position: absolute;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  overflow: hidden;
}
.vc-alpha-gradient {
  position: absolute;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
}
.vc-alpha-container {
  cursor: pointer;
  position: relative;
  z-index: 2;
  height: 100%;
  margin: 0 3px;
}
.vc-alpha-pointer {
  z-index: 2;
  position: absolute;
}
.vc-alpha-picker {
  cursor: pointer;
  width: 4px;
  border-radius: 1px;
  height: 8px;
  box-shadow: 0 0 2px rgba(0, 0, 0, .6);
  background: #fff;
  margin-top: 1px;
  transform: translateX(-2px);
}
`,""])},function(e,t,n){var s=n(131);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("7e15c05b",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-checkerboard {
  position: absolute;
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  background-size: contain;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement;return(a._self._c||u)("div",{staticClass:"vc-checkerboard",style:a.bgStyle})},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-alpha"},[h("div",{staticClass:"vc-alpha-checkboard-wrap"},[h("checkboard")],1),a._v(" "),h("div",{staticClass:"vc-alpha-gradient",style:{background:a.gradientColor}}),a._v(" "),h("div",{ref:"container",staticClass:"vc-alpha-container",on:{mousedown:a.handleMouseDown,touchmove:a.handleChange,touchstart:a.handleChange}},[h("div",{staticClass:"vc-alpha-pointer",style:{left:100*a.colors.a+"%"}},[h("div",{staticClass:"vc-alpha-picker"})])])])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{class:["vc-photoshop",a.disableFields?"vc-photoshop__disable-fields":""],attrs:{role:"application","aria-label":"PhotoShop color picker"}},[h("div",{staticClass:"vc-ps-head",attrs:{role:"heading"}},[a._v(a._s(a.head))]),a._v(" "),h("div",{staticClass:"vc-ps-body"},[h("div",{staticClass:"vc-ps-saturation-wrap"},[h("saturation",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1),a._v(" "),h("div",{staticClass:"vc-ps-hue-wrap"},[h("hue",{attrs:{direction:"vertical"},on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}},[h("div",{staticClass:"vc-ps-hue-pointer"},[h("i",{staticClass:"vc-ps-hue-pointer--left"}),h("i",{staticClass:"vc-ps-hue-pointer--right"})])])],1),a._v(" "),h("div",{class:["vc-ps-controls",a.disableFields?"vc-ps-controls__disable-fields":""]},[h("div",{staticClass:"vc-ps-previews"},[h("div",{staticClass:"vc-ps-previews__label"},[a._v(a._s(a.newLabel))]),a._v(" "),h("div",{staticClass:"vc-ps-previews__swatches"},[h("div",{staticClass:"vc-ps-previews__pr-color",style:{background:a.colors.hex},attrs:{"aria-label":"New color is "+a.colors.hex}}),a._v(" "),h("div",{staticClass:"vc-ps-previews__pr-color",style:{background:a.currentColor},attrs:{"aria-label":"Current color is "+a.currentColor},on:{click:a.clickCurrentColor}})]),a._v(" "),h("div",{staticClass:"vc-ps-previews__label"},[a._v(a._s(a.currentLabel))])]),a._v(" "),a.disableFields?a._e():h("div",{staticClass:"vc-ps-actions"},[h("div",{staticClass:"vc-ps-ac-btn",attrs:{role:"button","aria-label":a.acceptLabel},on:{click:a.handleAccept}},[a._v(a._s(a.acceptLabel))]),a._v(" "),h("div",{staticClass:"vc-ps-ac-btn",attrs:{role:"button","aria-label":a.cancelLabel},on:{click:a.handleCancel}},[a._v(a._s(a.cancelLabel))]),a._v(" "),h("div",{staticClass:"vc-ps-fields"},[h("ed-in",{attrs:{label:"h",desc:"\xB0",value:a.hsv.h},on:{change:a.inputChange}}),a._v(" "),h("ed-in",{attrs:{label:"s",desc:"%",value:a.hsv.s,max:100},on:{change:a.inputChange}}),a._v(" "),h("ed-in",{attrs:{label:"v",desc:"%",value:a.hsv.v,max:100},on:{change:a.inputChange}}),a._v(" "),h("div",{staticClass:"vc-ps-fields__divider"}),a._v(" "),h("ed-in",{attrs:{label:"r",value:a.colors.rgba.r},on:{change:a.inputChange}}),a._v(" "),h("ed-in",{attrs:{label:"g",value:a.colors.rgba.g},on:{change:a.inputChange}}),a._v(" "),h("ed-in",{attrs:{label:"b",value:a.colors.rgba.b},on:{change:a.inputChange}}),a._v(" "),h("div",{staticClass:"vc-ps-fields__divider"}),a._v(" "),h("ed-in",{staticClass:"vc-ps-fields__hex",attrs:{label:"#",value:a.hex},on:{change:a.inputChange}})],1),a._v(" "),a.hasResetButton?h("div",{staticClass:"vc-ps-ac-btn",attrs:{"aria-label":"reset"},on:{click:a.handleReset}},[a._v(a._s(a.resetLabel))]):a._e()])])])])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(136)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(56),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(138),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Sketch.vue",t.default=_.exports},function(e,t,n){var s=n(137);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("612c6604",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-sketch {
  position: relative;
  width: 200px;
  padding: 10px 10px 0;
  box-sizing: initial;
  background: #fff;
  border-radius: 4px;
  box-shadow: 0 0 0 1px rgba(0, 0, 0, .15), 0 8px 16px rgba(0, 0, 0, .15);
}
.vc-sketch-saturation-wrap {
  width: 100%;
  padding-bottom: 75%;
  position: relative;
  overflow: hidden;
}
.vc-sketch-controls {
  display: flex;
}
.vc-sketch-sliders {
  padding: 4px 0;
  flex: 1;
}
.vc-sketch-sliders .vc-hue,
.vc-sketch-sliders .vc-alpha-gradient {
  border-radius: 2px;
}
.vc-sketch-hue-wrap {
  position: relative;
  height: 10px;
}
.vc-sketch-alpha-wrap {
  position: relative;
  height: 10px;
  margin-top: 4px;
  overflow: hidden;
}
.vc-sketch-color-wrap {
  width: 24px;
  height: 24px;
  position: relative;
  margin-top: 4px;
  margin-left: 4px;
  border-radius: 3px;
}
.vc-sketch-active-color {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 2px;
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, .15), inset 0 0 4px rgba(0, 0, 0, .25);
  z-index: 2;
}
.vc-sketch-color-wrap .vc-checkerboard {
  background-size: auto;
}
.vc-sketch-field {
  display: flex;
  padding-top: 4px;
}
.vc-sketch-field .vc-input__input {
  width: 90%;
  padding: 4px 0 3px 10%;
  border: none;
  box-shadow: inset 0 0 0 1px #ccc;
  font-size: 10px;
}
.vc-sketch-field .vc-input__label {
  display: block;
  text-align: center;
  font-size: 11px;
  color: #222;
  padding-top: 3px;
  padding-bottom: 4px;
  text-transform: capitalize;
}
.vc-sketch-field--single {
  flex: 1;
  padding-left: 6px;
}
.vc-sketch-field--double {
  flex: 2;
}
.vc-sketch-presets {
  margin-right: -10px;
  margin-left: -10px;
  padding-left: 10px;
  padding-top: 10px;
  border-top: 1px solid #eee;
}
.vc-sketch-presets-color {
  border-radius: 3px;
  overflow: hidden;
  position: relative;
  display: inline-block;
  margin: 0 10px 10px 0;
  vertical-align: top;
  cursor: pointer;
  width: 16px;
  height: 16px;
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, .15);
}
.vc-sketch-presets-color .vc-checkerboard {
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, .15);
  border-radius: 3px;
}
.vc-sketch__disable-alpha .vc-sketch-color-wrap {
  height: 10px;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{class:["vc-sketch",a.disableAlpha?"vc-sketch__disable-alpha":""],attrs:{role:"application","aria-label":"Sketch color picker"}},[h("div",{staticClass:"vc-sketch-saturation-wrap"},[h("saturation",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1),a._v(" "),h("div",{staticClass:"vc-sketch-controls"},[h("div",{staticClass:"vc-sketch-sliders"},[h("div",{staticClass:"vc-sketch-hue-wrap"},[h("hue",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1),a._v(" "),a.disableAlpha?a._e():h("div",{staticClass:"vc-sketch-alpha-wrap"},[h("alpha",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1)]),a._v(" "),h("div",{staticClass:"vc-sketch-color-wrap"},[h("div",{staticClass:"vc-sketch-active-color",style:{background:a.activeColor},attrs:{"aria-label":"Current color is "+a.activeColor}}),a._v(" "),h("checkboard")],1)]),a._v(" "),a.disableFields?a._e():h("div",{staticClass:"vc-sketch-field"},[h("div",{staticClass:"vc-sketch-field--double"},[h("ed-in",{attrs:{label:"hex",value:a.hex},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-sketch-field--single"},[h("ed-in",{attrs:{label:"r",value:a.colors.rgba.r},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-sketch-field--single"},[h("ed-in",{attrs:{label:"g",value:a.colors.rgba.g},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-sketch-field--single"},[h("ed-in",{attrs:{label:"b",value:a.colors.rgba.b},on:{change:a.inputChange}})],1),a._v(" "),a.disableAlpha?a._e():h("div",{staticClass:"vc-sketch-field--single"},[h("ed-in",{attrs:{label:"a",value:a.colors.a,"arrow-offset":.01,max:1},on:{change:a.inputChange}})],1)]),a._v(" "),h("div",{staticClass:"vc-sketch-presets",attrs:{role:"group","aria-label":"A color preset, pick one to set as current color"}},[a._l(a.presetColors,function(p){return[a.isTransparent(p)?h("div",{key:p,staticClass:"vc-sketch-presets-color",attrs:{"aria-label":"Color:"+p},on:{click:function(d){a.handlePreset(p)}}},[h("checkboard")],1):h("div",{key:p,staticClass:"vc-sketch-presets-color",style:{background:p},attrs:{"aria-label":"Color:"+p},on:{click:function(d){a.handlePreset(p)}}})]})],2)])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(140)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(142),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Chrome.vue",t.default=_.exports},function(e,t,n){var s=n(141);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("1cd16048",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-chrome {
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3);
  box-sizing: initial;
  width: 225px;
  font-family: Menlo, monospace;
  background-color: #fff;
}
.vc-chrome-controls {
  display: flex;
}
.vc-chrome-color-wrap {
  position: relative;
  width: 36px;
}
.vc-chrome-active-color {
  position: relative;
  width: 30px;
  height: 30px;
  border-radius: 15px;
  overflow: hidden;
  z-index: 1;
}
.vc-chrome-color-wrap .vc-checkerboard {
  width: 30px;
  height: 30px;
  border-radius: 15px;
  background-size: auto;
}
.vc-chrome-sliders {
  flex: 1;
}
.vc-chrome-fields-wrap {
  display: flex;
  padding-top: 16px;
}
.vc-chrome-fields {
  display: flex;
  margin-left: -6px;
  flex: 1;
}
.vc-chrome-field {
  padding-left: 6px;
  width: 100%;
}
.vc-chrome-toggle-btn {
  width: 32px;
  text-align: right;
  position: relative;
}
.vc-chrome-toggle-icon {
  margin-right: -4px;
  margin-top: 12px;
  cursor: pointer;
  position: relative;
  z-index: 2;
}
.vc-chrome-toggle-icon-highlight {
  position: absolute;
  width: 24px;
  height: 28px;
  background: #eee;
  border-radius: 4px;
  top: 10px;
  left: 12px;
}
.vc-chrome-hue-wrap {
  position: relative;
  height: 10px;
  margin-bottom: 8px;
}
.vc-chrome-alpha-wrap {
  position: relative;
  height: 10px;
}
.vc-chrome-hue-wrap .vc-hue {
  border-radius: 2px;
}
.vc-chrome-alpha-wrap .vc-alpha-gradient {
  border-radius: 2px;
}
.vc-chrome-hue-wrap .vc-hue-picker, .vc-chrome-alpha-wrap .vc-alpha-picker {
  width: 12px;
  height: 12px;
  border-radius: 6px;
  transform: translate(-6px, -2px);
  background-color: rgb(248, 248, 248);
  box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.37);
}
.vc-chrome-body {
  padding: 16px 16px 12px;
  background-color: #fff;
}
.vc-chrome-saturation-wrap {
  width: 100%;
  padding-bottom: 55%;
  position: relative;
  border-radius: 2px 2px 0 0;
  overflow: hidden;
}
.vc-chrome-saturation-wrap .vc-saturation-circle {
  width: 12px;
  height: 12px;
}
.vc-chrome-fields .vc-input__input {
  font-size: 11px;
  color: #333;
  width: 100%;
  border-radius: 2px;
  border: none;
  box-shadow: inset 0 0 0 1px #dadada;
  height: 21px;
  text-align: center;
}
.vc-chrome-fields .vc-input__label {
  text-transform: uppercase;
  font-size: 11px;
  line-height: 11px;
  color: #969696;
  text-align: center;
  display: block;
  margin-top: 12px;
}
.vc-chrome__disable-alpha .vc-chrome-active-color {
  width: 18px;
  height: 18px;
}
.vc-chrome__disable-alpha .vc-chrome-color-wrap {
  width: 30px;
}
.vc-chrome__disable-alpha .vc-chrome-hue-wrap {
  margin-top: 4px;
  margin-bottom: 4px;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{class:["vc-chrome",a.disableAlpha?"vc-chrome__disable-alpha":""],attrs:{role:"application","aria-label":"Chrome color picker"}},[h("div",{staticClass:"vc-chrome-saturation-wrap"},[h("saturation",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1),a._v(" "),h("div",{staticClass:"vc-chrome-body"},[h("div",{staticClass:"vc-chrome-controls"},[h("div",{staticClass:"vc-chrome-color-wrap"},[h("div",{staticClass:"vc-chrome-active-color",style:{background:a.activeColor},attrs:{"aria-label":"current color is "+a.colors.hex}}),a._v(" "),a.disableAlpha?a._e():h("checkboard")],1),a._v(" "),h("div",{staticClass:"vc-chrome-sliders"},[h("div",{staticClass:"vc-chrome-hue-wrap"},[h("hue",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1),a._v(" "),a.disableAlpha?a._e():h("div",{staticClass:"vc-chrome-alpha-wrap"},[h("alpha",{on:{change:a.childChange},model:{value:a.colors,callback:function(p){a.colors=p},expression:"colors"}})],1)])]),a._v(" "),a.disableFields?a._e():h("div",{staticClass:"vc-chrome-fields-wrap"},[h("div",{directives:[{name:"show",rawName:"v-show",value:a.fieldsIndex===0,expression:"fieldsIndex === 0"}],staticClass:"vc-chrome-fields"},[h("div",{staticClass:"vc-chrome-field"},[a.hasAlpha?a._e():h("ed-in",{attrs:{label:"hex",value:a.colors.hex},on:{change:a.inputChange}}),a._v(" "),a.hasAlpha?h("ed-in",{attrs:{label:"hex",value:a.colors.hex8},on:{change:a.inputChange}}):a._e()],1)]),a._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:a.fieldsIndex===1,expression:"fieldsIndex === 1"}],staticClass:"vc-chrome-fields"},[h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"r",value:a.colors.rgba.r},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"g",value:a.colors.rgba.g},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"b",value:a.colors.rgba.b},on:{change:a.inputChange}})],1),a._v(" "),a.disableAlpha?a._e():h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"a",value:a.colors.a,"arrow-offset":.01,max:1},on:{change:a.inputChange}})],1)]),a._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:a.fieldsIndex===2,expression:"fieldsIndex === 2"}],staticClass:"vc-chrome-fields"},[h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"h",value:a.hsl.h},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"s",value:a.hsl.s},on:{change:a.inputChange}})],1),a._v(" "),h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"l",value:a.hsl.l},on:{change:a.inputChange}})],1),a._v(" "),a.disableAlpha?a._e():h("div",{staticClass:"vc-chrome-field"},[h("ed-in",{attrs:{label:"a",value:a.colors.a,"arrow-offset":.01,max:1},on:{change:a.inputChange}})],1)]),a._v(" "),h("div",{staticClass:"vc-chrome-toggle-btn",attrs:{role:"button","aria-label":"Change another color definition"},on:{click:a.toggleViews}},[h("div",{staticClass:"vc-chrome-toggle-icon"},[h("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"},on:{mouseover:a.showHighlight,mouseenter:a.showHighlight,mouseout:a.hideHighlight}},[h("path",{attrs:{fill:"#333",d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}})])]),a._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:a.highlight,expression:"highlight"}],staticClass:"vc-chrome-toggle-icon-highlight"})])])])])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l},function(e,t,n){"use strict";function s(m){h||n(144)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(58),l=n.n(o);for(var a in o)a!=="default"&&function(m){n.d(t,m,function(){return o[m]})}(a);var u=n(146),h=!1,p=n(2),d=s,_=p(l.a,u.a,!1,d,null,null);_.options.__file="src/components/Twitter.vue",t.default=_.exports},function(e,t,n){var s=n(145);typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),n(1)("669a48a5",s,!1,{})},function(e,t,n){t=e.exports=n(0)(!1),t.push([e.i,`
.vc-twitter {
  background: #fff;
  border: 0 solid rgba(0,0,0,0.25);
  box-shadow: 0 1px 4px rgba(0,0,0,0.25);
  border-radius: 4px;
  position: relative;
}
.vc-twitter-triangle {
  width: 0px;
  height: 0px;
  border-style: solid;
  border-width: 0 9px 10px 9px;
  border-color: transparent transparent #fff transparent;
  position: absolute;
}
.vc-twitter-triangle-shadow {
  width: 0px;
  height: 0px;
  border-style: solid;
  border-width: 0 9px 10px 9px;
  border-color: transparent transparent rgba(0, 0, 0, .1) transparent;
  position: absolute;
}
.vc-twitter-body {
  padding: 15px 9px 9px 15px;
}
.vc-twitter .vc-editable-input {
  position: relative;
}
.vc-twitter .vc-editable-input input {
  width: 100px;
  font-size: 14px;
  color: #666;
  border: 0px;
  outline: none;
  height: 28px;
  box-shadow: inset 0 0 0 1px #F0F0F0;
  box-sizing: content-box;
  border-radius: 0 4px 4px 0;
  float: left;
  padding: 1px;
  padding-left: 8px;
}
.vc-twitter .vc-editable-input span {
  display: none;
}
.vc-twitter-hash {
  background: #F0F0F0;
  height: 30px;
  width: 30px;
  border-radius: 4px 0 0 4px;
  float: left;
  color: #98A1A4;
  display: flex;
  align-items: center;
  justify-content: center;
}
.vc-twitter-swatch {
  width: 30px;
  height: 30px;
  float: left;
  border-radius: 4px;
  margin: 0 6px 6px 0;
  cursor: pointer;
  position: relative;
  outline: none;
}
.vc-twitter-clear {
  clear: both;
}
.vc-twitter-hide-triangle .vc-twitter-triangle {
  display: none;
}
.vc-twitter-hide-triangle .vc-twitter-triangle-shadow {
  display: none;
}
.vc-twitter-top-left-triangle .vc-twitter-triangle{
  top: -10px;
  left: 12px;
}
.vc-twitter-top-left-triangle .vc-twitter-triangle-shadow{
  top: -11px;
  left: 12px;
}
.vc-twitter-top-right-triangle .vc-twitter-triangle{
  top: -10px;
  right: 12px;
}
.vc-twitter-top-right-triangle .vc-twitter-triangle-shadow{
  top: -11px;
  right: 12px;
}
`,""])},function(e,t,n){"use strict";var s=function(){var a=this,u=a.$createElement,h=a._self._c||u;return h("div",{staticClass:"vc-twitter",class:{"vc-twitter-hide-triangle ":a.triangle==="hide","vc-twitter-top-left-triangle ":a.triangle==="top-left","vc-twitter-top-right-triangle ":a.triangle==="top-right"},style:{width:typeof a.width=="number"?a.width+"px":a.width}},[h("div",{staticClass:"vc-twitter-triangle-shadow"}),a._v(" "),h("div",{staticClass:"vc-twitter-triangle"}),a._v(" "),h("div",{staticClass:"vc-twitter-body"},[a._l(a.defaultColors,function(p,d){return h("span",{key:d,staticClass:"vc-twitter-swatch",style:{background:p,boxShadow:"0 0 4px "+(a.equal(p)?p:"transparent")},on:{click:function(_){a.handlerClick(p)}}})}),a._v(" "),h("div",{staticClass:"vc-twitter-hash"},[a._v("#")]),a._v(" "),h("editable-input",{attrs:{label:"#",value:a.hex},on:{change:a.inputChange}}),a._v(" "),h("div",{staticClass:"vc-twitter-clear"})],2)])},o=[];s._withStripped=!0;var l={render:s,staticRenderFns:o};t.a=l}])})});function $ee(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="QueryResultsActionQueryPolygonCSVAttributes.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function hw(){let e=hw.styles||(hw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Oee,Pee,Fee,Dee,Gee,jee,qee,Bee,Hh,C4=R(()=>{Ke();Rt();Oee={name:"queryresults-querypolygonaddattributes",props:{layer:{type:Object},config:{type:Object,default:null}},data(){return{type:this.config.choices[0].type}},created(){this.unwatch=this.$watch(()=>F.language,()=>{this.config.choices.forEach(e=>$(this.$refs[e.type]).text(_e(e.label))),$(this.$refs.g3w_select_feature_featurepolygon).select2().trigger("change")})},beforeDestroy(){this.unwatch&&this.unwatch(),this.unwatch=null}},Pee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%"}},[n("h5",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.querybypolygon.download.title",expression:"'mapcontrols.querybypolygon.download.title'"}],staticClass:"skin-background-color g3w-polygonattributes-types-title"}),e._v(" "),n("div",{staticClass:"g3w-polygonattributes-types-content"},[n("select",{directives:[{name:"select2",rawName:"v-select2",value:"type",expression:"'type'"}],ref:"g3w_select_feature_featurepolygon",staticClass:"form-control",staticStyle:{width:"100%"},attrs:{search:!1}},e._l(e.config.choices,function(s){return n("option",{directives:[{name:"t",rawName:"v-t",value:s.label,expression:"choice.label"}],key:s.type,ref:s.type,refInFor:!0,domProps:{value:s.type}})}),0),e._v(" "),n("button",{staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(s){return s.stopPropagation(),e.config.download(e.type)}}},[n("span",{class:e.g3wtemplate.getFontClass("download")})])])])},Fee=[],Dee=function(e){e&&e("data-v-0715e2ba_0",{source:".g3w-polygonattributes-types-title[data-v-0715e2ba]{font-weight:700;padding:3px;color:#fff;margin:0 0 5px 0}.g3w-polygonattributes-types-content[data-v-0715e2ba]{display:flex;justify-content:space-between;padding:3px;border-radius:3px;border:1px solid #f4f4f4}",map:void 0,media:void 0})},Gee="data-v-0715e2ba",jee=void 0,qee=!1;Bee=$ee({render:Pee,staticRenderFns:Fee},Dee,Oee,Gee,qee,jee,!1,hw,void 0,void 0),Hh=Bee});function Zee(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="QueryResultsActionDownloadFormats.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Uee,zee,Vee,Hee,Wee,Yee,Xee,Qee,Wh,fw=R(()=>{Ke();Uee={name:"downloadformats",data(){return{ApplicationState:F,download_format:this.config.downloads[0].format,down_with_relations:!1,downloads_formats:[...this.config.downloads]}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},config:{type:Object,default:null}},watch:{down_with_relations(e){e&&(this.downloads_formats=this.downloads_formats.filter(({format:t})=>t!=="pdf")),e&&this.download_format==="pdf"&&(this.download_format=this.downloads_formats[0].format),e||(this.downloads_formats=[...this.config.downloads])}},methods:{async download(){try{let e=this.config.downloads.find(t=>t.format===this.download_format);await e.cbk(this.layer,this.feature?this.feature:this.layer.features,e,this.featureIndex,e.format==="pdf"?document.querySelector(`[feature-html-content="${this.layer.id}_${this.featureIndex}"]`).innerHTML:null,Number(this.down_with_relations))}catch(e){console.warn(e)}}}},zee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.layer.hasdownloadablerelations?n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.down_with_relations,expression:"down_with_relations"}],staticClass:"magic-checkbox",attrs:{id:"g3w-download-relations_"+e.featureIndex,type:"checkbox"},domProps:{checked:Array.isArray(e.down_with_relations)?e._i(e.down_with_relations,null)>-1:e.down_with_relations},on:{change:function(s){var o=e.down_with_relations,l=s.target,a=!!l.checked;if(Array.isArray(o)){var u=null,h=e._i(o,u);l.checked?h<0&&(e.down_with_relations=o.concat([u])):h>-1&&(e.down_with_relations=o.slice(0,h).concat(o.slice(h+1)))}else e.down_with_relations=a}}}),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"Download with relations",expression:"'Download with relations'"}],attrs:{for:"g3w-download-relations_"+e.featureIndex}})]):e._e(),e._v(" "),n("div",{staticClass:"g3w-download-formats-content",staticStyle:{width:"100%",display:"flex"},on:{click:function(s){s.preventDefault(),s.stopPropagation()}}},[n("select",{directives:[{name:"select2",rawName:"v-select2",value:"download_format",expression:"'download_format'"}],staticClass:"form-control",staticStyle:{"flex-grow":"1"},attrs:{search:!1}},e._l(e.downloads_formats,function(s){return n("option",{directives:[{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.dowload,expression:"ApplicationState.dowload"}],key:s.id,domProps:{value:s.format}},[n("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(s.format))])])}),0),e._v(" "),n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.download,expression:"ApplicationState.download"}],staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(s){return s.stopPropagation(),e.download.apply(null,arguments)}}},[n("span",{class:e.g3wtemplate.getFontClass("download")})])])])},Vee=[],Hee=void 0,Wee=void 0,Yee=void 0,Xee=!1;Qee=Zee({render:zee,staticRenderFns:Vee},Hee,Uee,Wee,Xee,Yee,!1,void 0,void 0,void 0),Wh=Qee});var pw=He((p4e,I4)=>{I4.exports.geometries={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31}});var gw=He((g4e,L4)=>{L4.exports={C:254,L:1,D:8,N:18,M:18,F:18,B:8}});var N4=He((m4e,f_)=>{f_.exports.lpad=function(t,n,s){for(;t.length<n;)t=s+t;return t};f_.exports.rpad=function(t,n,s){for(;t.length<n;)t=t+s;return t};f_.exports.writeField=function(t,n,s,o){for(var l=0;l<n;l++)t.setUint8(o,s.charCodeAt(l)),o++;return o}});var k4=He((_4e,p_)=>{var Kee=gw(),Jee={string:"C",number:"N",boolean:"L",null:"C"};p_.exports.multi=ete;p_.exports.bytesPer=nte;p_.exports.obj=T4;function ete(e){var t={};e.forEach(n);function n(s){tte(t,s)}return T4(t)}function tte(e,t){for(var n in t){var s=typeof t[n]<"u"&&t[n]!==null;(typeof e[n]>"u"||s)&&(e[n]=t[n])}return e}function T4(e){var t={},n=[];for(var s in e)t[s]=e[s]===null?"null":typeof e[s];for(var o in t){var l=Jee[t[o]];l&&n.push({name:o,type:l,size:Kee[l]})}return n}function nte(e){return e.reduce(function(t,n){return t+n.size},1)}});var A4=He((v4e,M4)=>{var y4e=gw(),xu=N4(),R4=k4();M4.exports=function(t,n){var s=n||R4.multi(t),o=32*s.length+1,l=R4.bytesPer(s),a=new ArrayBuffer(o+32+l*t.length+1),u=new Date,h=new DataView(a);h.setUint8(0,3),h.setUint8(1,u.getFullYear()-1900),h.setUint8(2,u.getMonth()+1),h.setUint8(3,u.getDate()),h.setUint32(4,t.length,!0);var p=o+32;h.setUint16(8,p,!0),h.setUint16(10,l,!0),h.setInt8(32+o-1,13),s.forEach(function(_,m){_.name.split("").slice(0,10).forEach(function(v,x){h.setInt8(32+m*32+x,v.charCodeAt(0))}),h.setInt8(32+m*32+11,_.type.charCodeAt(0)),h.setInt8(32+m*32+16,_.size),_.type=="N"&&h.setInt8(32+m*32+17,3)});var d=o+32;return t.forEach(function(_,m){h.setUint8(d,32),d++,s.forEach(function(v){var x=_[v.name];switch((x===null||typeof x>"u")&&(x=""),v.type){case"L":h.setUint8(d,x?84:70),d++;break;case"D":d=xu.writeField(h,8,xu.lpad(x.toString(),8," "),d);break;case"N":d=xu.writeField(h,v.size,xu.lpad(x.toString(),v.size," ").substr(0,18),d);break;case"C":d=xu.writeField(h,v.size,xu.rpad(x.toString(),v.size," "),d);break;default:throw new Error("Unknown field type")}})}),h.setUint8(d,26),h}});var P4=He((b4e,O4)=>{O4.exports.structure=A4()});var mw=He((x4e,F4)=>{F4.exports='GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]'});var _w=He((w4e,g_)=>{g_.exports.enlarge=function(t,n){return n[0]<t.xmin&&(t.xmin=n[0]),n[0]>t.xmax&&(t.xmax=n[0]),n[1]<t.ymin&&(t.ymin=n[1]),n[1]>t.ymax&&(t.ymax=n[1]),t};g_.exports.enlargeExtent=function(t,n){return n.xmax>t.xmax&&(t.xmax=n.xmax),n.xmin<t.xmin&&(t.xmin=n.xmin),n.ymax>t.ymax&&(t.ymax=n.ymax),n.ymin<t.ymin&&(t.ymin=n.ymin),t};g_.exports.blank=function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}}});var G4=He((S4e,wu)=>{var D4=_w();wu.exports.write=function(t,n,s,o){var l=28,a=100,u=0,h=0;t.forEach(function(d,_){s.setInt32(u,_+1),s.setInt32(u+4,10),s.setInt32(u+8,1,!0),s.setFloat64(u+12,d[0],!0),s.setFloat64(u+20,d[1],!0),o.setInt32(h,a/2),o.setInt32(h+4,10),h+=8,u+=l,a+=l})};wu.exports.extent=function(e){return e.reduce(function(t,n){return D4.enlarge(t,n)},D4.blank())};wu.exports.parts=function(t,n){return t.length};wu.exports.shxLength=function(e){return e.length*8};wu.exports.shpLength=function(e){return e.length*28}});var $4=He((E4e,Su)=>{var m_=_w(),j4=pw();Su.exports.write=function(t,n,s,o,l){var a=0,u=0,h=100;t.forEach(p);function p(d,_){var m=__(d),v=q4([d],l),x=m.length*16+48+(v-1)*4,b=m.reduce(function(D,G){return m_.enlarge(D,G)},m_.blank());o.setInt32(u,h/2),o.setInt32(u+4,x/2),u+=8,h+=x+8,s.setInt32(a,_+1),s.setInt32(a+4,x/2),s.setInt32(a+8,l,!0),s.setFloat64(a+12,b.xmin,!0),s.setFloat64(a+20,b.ymin,!0),s.setFloat64(a+28,b.xmax,!0),s.setFloat64(a+36,b.ymax,!0),s.setInt32(a+44,v,!0),s.setInt32(a+48,m.length,!0),s.setInt32(a+52,0,!0);for(var w=d.reduce(function(D,G){return Array.isArray(G[0][0])?D=D.concat(G):D.push(G),D},[]),L=1;L<v;L++)s.setInt32(a+52+L*4,w.reduce(function(D,G,W){return W<L?D+G.length:D},0),!0);m.forEach(function(G,W){s.setFloat64(a+56+W*16+(v-1)*4,G[0],!0),s.setFloat64(a+56+W*16+(v-1)*4+8,G[1],!0)}),a+=x+8}};Su.exports.shpLength=function(e){return e.length*56+__(e).length*16};Su.exports.shxLength=function(e){return e.length*8};Su.exports.extent=function(e){return __(e).reduce(function(t,n){return m_.enlarge(t,n)},m_.blank())};function q4(e,t){var n=1;return(t===j4.geometries.POLYGON||t===j4.geometries.POLYLINE)&&(n=e.reduce(function(s,o){return s+=o.length,Array.isArray(o[0][0][0])&&(s+=o.reduce(function(l,a){return l+a.length-1},0)),s},0)),n}Su.exports.parts=q4;function __(e,t){return t===void 0&&(t=[]),typeof e[0][0]=="object"?e.reduce(function(n,s){return n.concat(__(s))},t):e}});var yw=He((C4e,V4)=>{var ite=pw(),ste=P4(),rte=mw(),ote=G4(),B4=$4(),ate={1:ote,5:B4,3:B4};V4.exports=lte;function lte(e,t,n,s){var o=ite.geometries[t],l=ate[o],a=l.parts(n,o),u=100+(a-n.length)*4+l.shpLength(n),h=100+l.shxLength(n),p=new ArrayBuffer(u),d=new DataView(p),_=new ArrayBuffer(h),m=new DataView(_),v=l.extent(n);U4(d,o),U4(m,o),z4(v,d),z4(v,m),l.write(n,v,new DataView(p,100),new DataView(_,100),o),d.setInt32(24,u/2),m.setInt32(24,50+n.length*4);var x=ste.structure(e);s(null,{shp:d,shx:m,dbf:x,prj:rte})}function U4(e,t){e.setInt32(0,9994),e.setInt32(28,1e3,!0),e.setInt32(32,t,!0)}function z4(e,t){t.setFloat64(36,e.xmin,!0),t.setFloat64(44,e.ymin,!0),t.setFloat64(52,e.xmax,!0),t.setFloat64(60,e.ymax,!0)}});var W4=He((I4e,Eu)=>{Eu.exports.point=Yh("Point","POINT");Eu.exports.line=Yh("LineString","POLYLINE");Eu.exports.multiline=Yh("MultiLineString","POLYLINE");Eu.exports.polygon=Yh("Polygon","POLYGON");Eu.exports.multipolygon=Yh("MultiPolygon","POLYGON");function Yh(e,t){return function(n){var s=n.features.filter(ute(e));return{geometries:t==="POLYLINE"?[s.map(H4)]:s.map(H4),properties:s.map(cte),type:t}}}function H4(e){return e.geometry.coordinates}function cte(e){return e.properties}function ute(e){return Array.isArray(e)?function(t){return e.includes(t.geometry.type)}:function(t){return t.geometry.type===e}}});var vw=He((L4e,Y4)=>{var dte=yw(),Xh=W4(),hte=mw(),fte=Sp();Y4.exports=function(e,t,n=!1){let s=new fte,o=s;t&&t.folder&&(o=s.folder(t.folder));var l=t&&t.prj?t.prj:hte;[Xh.point(e),Xh.line(e),Xh.polygon(e),Xh.multipolygon(e),Xh.multiline(e)].forEach(function(u){u.geometries.length&&u.geometries[0].length&&dte(u.properties,u.type,u.geometries,function(h,p){var d=t&&t.types&&t.types[u.type.toLowerCase()]?t.types[u.type.toLowerCase()]:u.type;o.file(d+".shp",p.shp.buffer,{binary:!0}),o.file(d+".shx",p.shx.buffer,{binary:!0}),o.file(d+".dbf",p.dbf.buffer,{binary:!0}),o.file(d+".prj",l)})});var a={};return!t||!t.outputType?a.type="base64":a.type=t.outputType,!t||!t.compression?a.compression="DEFLATE":a.compression=t.compression,n?s.generateNodeStream({...a,streamFiles:!0}):s.generateAsync(a)}});var X4=He((bw,xw)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof bw<"u"?t():(t(),e.FileSaver={})})(bw,function(){"use strict";function e(u,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function t(u,h,p){var d=new XMLHttpRequest;d.open("GET",u),d.responseType="blob",d.onload=function(){a(d.response,h,p)},d.onerror=function(){console.error("could not download file")},d.send()}function n(u){var h=new XMLHttpRequest;h.open("HEAD",u,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function s(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(u,h,p){var d=o.URL||o.webkitURL,_=document.createElement("a");h=h||u.name||"download",_.download=h,_.rel="noopener",typeof u=="string"?(_.href=u,_.origin===location.origin?s(_):n(_.href)?t(u,h,p):s(_,_.target="_blank")):(_.href=d.createObjectURL(u),setTimeout(function(){d.revokeObjectURL(_.href)},4e4),setTimeout(function(){s(_)},0))}:"msSaveOrOpenBlob"in navigator?function(u,h,p){if(h=h||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(e(u,p),h);else if(n(u))t(u,h,p);else{var d=document.createElement("a");d.href=u,d.target="_blank",setTimeout(function(){s(d)})}}:function(u,h,p,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof u=="string")return t(u,h,p);var _=u.type==="application/octet-stream",m=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||_&&m||l)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var L=x.result;L=v?L:L.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=L:location=L,d=null},x.readAsDataURL(u)}else{var b=o.URL||o.webkitURL,w=b.createObjectURL(u);d?d.location=w:location.href=w,d=null,setTimeout(function(){b.revokeObjectURL(w)},4e4)}});o.saveAs=a.saveAs=a,typeof xw<"u"&&(xw.exports=a)})});var Q4=He((N4e,Z4)=>{var pte=vw(),gte=X4().saveAs;Z4.exports=function(e,t){let n="download";t&&(t.filename||t.folder)&&(n=t.filename||t.folder),pte(e,t).then(function(s){gte(s,n+".zip")})}});var K4=He((T4e,y_)=>{y_.exports.download=Q4();y_.exports.write=yw();y_.exports.zip=vw()});async function Zh(e,t,n=[],s,o,l,a=0){let u=T.getService("queryresults"),h=De(t.id);if(e===void 0&&t){let p=!h&&t,d=Object.assign(document.createElement("template"),{innerHTML:`
        <dialog>
          <h4 style="margin: 0; padding: .5em; color: #FFF; position: sticky; top: 0; background-color: #212c31"><i class="fas fa-download" style="margin-right: .5ch;"></i> ${_e("Export features")}</h4>
          <form method="dialog">

            <div class="form-group">
              <label>${_e("Layer")}</label>
              <select name="layer" class="form-control" disabled>
                <option value="${t.id}" selected>${t.name}</option>
                ${_u().filter(_=>t.id!==_.getId()).map(_=>`<option value="${_.getId()}">${_.getName()}</option>`).join()}
              </select>
            </div>

            <div class="form-group">
              <label>${_e("Data Format")}</label>
              <select name="format" class="form-control">
                ${[h?.isGeoTIFFDownloadable?.()?`<option value="GeoTiff">${_e("GeoTiff")}</option>`:"",h?.isGeoTIFFDownloadable?.()?`<option value="GeoTiff-at-map-extent">${_e("GeoTiff (current view)")}</option>`:"",h?.isShpDownloadable?.()?`<option value="Shp">${_e("Shapefile")}</option>`:"",h?.isGpxDownloadable?.()?`<option value="Gpx">${_e("GPX")}</option>`:"",h?.isGpkgDownloadable?.()?`<option value="Gpkg">${_e("GeoPackage")}</option>`:"",h?.isCsvDownloadable?.()?`<option value="Csv">${_e("CSV")}</option>`:"",h?.isXlsDownloadable?.()?`<option value="Xls">${_e("Excel")}</option>`:"",p&&p._type!=="wms"&&p.downloadUrl?'<option value="external-url">External URL</option>':"",p&&p._type!=="wms"&&!p.downloadUrl?`<option value="external-shp">${_e("Shapefile")}</option>`:""].filter(Boolean).join("")}
              </select>
            </div>

            <div class="form-group" ${h?.hasDowloadableRelations?.()?"":"hidden"}>
              <label>${_e("Include relations in exported file?")}</label>
              <select name="down_with_relations" class="form-control">
                <option value="1">${_e("yes")}</option>
                <option value="0">${_e("no")}</option>
              </select>
            </div>

            <menu style="display: flex; justify-content: space-between;">
              <button id="confirm_button" type="submit" value="confirm" class="btn btn-block btn-success">Download</button>
            </menu>
          </form>

        </dialog>
      `.trim()}).content.firstChild;d.addEventListener("click",_=>{_.target===d&&d.close()}),d.addEventListener("close",async()=>{if(d.returnValue==="confirm"){F.download=!0;try{let _=d.querySelector('[name="format"]').value,m=Number(d.querySelector('[name="down_with_relations"]').value),v,x;if(_==="external-url"){let b=p.downloadUrl&&await fetch(p.downloadUrl,{headers:{"Access-Control-Expose-Headers":"Content-Disposition"},signal:AbortSignal.timeout($n)});if(!b?.ok)throw(await b.json()).message;v=await b.blob(),x=(b.headers.get("content-disposition")||"filename=g3w_download_file").split("filename=").at(-1)}else if(_==="external-shp")x=t.name.split(`.${p.type}`)[0],v=await J4.default.zip(new ol.format.GeoJSON().writeFeaturesObject(T.getService("map").getLayerByName(p.name).getSource().getFeatures(),{dataProjection:p.crs,featureProjection:T.getService("map").getEpsg()||p.crs}),{outputType:"blob",prj:p.crs,folder:x,types:{point:x,mulipoint:x,polygon:x,multipolygon:x,line:x,polyline:x,multiline:x}});else{let b={down_with_relations:m,filtertoken:h.getFilterToken(),..._==="GeoTiff-at-map-extent"?{map_extent:T.getService("map").getMapExtent().toString()}:{}};if(url=h.getUrl(_.replace("-at-map-extent","").toLowerCase()),response=url&&await fetch(url,{body:Object.keys(b||{}).reduce((w,L)=>(w.append(L,b[L]),w),new FormData),method:"POST",headers:{"Access-Control-Expose-Headers":"Content-Disposition"},signal:AbortSignal.timeout($n)}),!response?.ok)throw(await response.json()).message;v=await response.blob(),x=response.headers.get("content-disposition")}Si(v,x)}catch(_){T.notify.error(_.message||_)}F.download=!1}d.remove()}),document.body.appendChild(d),d.showModal()}else{n&&!Array.isArray(n)&&(n=[n]);let{query:p={}}=u.state,d=Object.fromEntries(Object.entries({down_with_relations:a,field:p.type==="search"&&p.search?p.search.join():void 0,fids:p.type!=="search"||!p.search?p.fids||n.filter(x=>!t.filter?.active||x.selection.selected).map(x=>x.attributes[jt]).join(","):void 0,html:e==="pdf"?l:void 0}).filter(([x,b])=>b!==void 0)),_=async(x=!1)=>{n.length>1&&(t.downloadformats.active=x,u.setLayerActionTool({layer:t})),T.setLoadingContent(!0);try{d.filtertoken=h.getFilterToken();let w,L;if(e==="pdf"?(w=h.getUrl("pdf"),L=w&&await fetch(w,{body:JSON.stringify(d),method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Access-Control-Expose-Headers":"Content-Disposition"},signal:AbortSignal.timeout($n)})):(w=h.getUrl(e==="shapefile"?"shp":e),L=w&&await fetch(w,{body:Object.keys(d||{}).reduce((D,G)=>(D.append(G,d[G]),D),new FormData),method:"POST",headers:{"Access-Control-Expose-Headers":"Content-Disposition"},signal:AbortSignal.timeout($n)})),!L?.ok)throw(await L.json()).message;Si(await L.blob(),L.headers.get("content-disposition"))}catch(w){T.showUserMessage({type:"alert",message:w||"server_error",textMessage:!!w})}F.download=!0,F.download=!1,T.setLoadingContent(!1);let b=u.state.layersactions[t.id].find(w=>w.id==="downloads");n.length>1&&b===void 0&&(t[e].active=!1,u.setLayerActionTool({layer:t})),n.length>1&&b!==void 0&&(t.downloadformats.active=!1),n.length<=1&&b===void 0&&(s.state.toggled[o]=!1),n.length<=1&&b!==void 0&&(b.state.toggled[o]=!1),n.length<=1&&u.setCurrentActionLayerFeatureTool({index:o,action:s,layer:t})};if(p.type!=="polygon"){await _();return}let m=u.state.layersactions[t.id].find(x=>x.id==="downloads"),v={choices:[{id:Qe(),type:"feature",label:"mapcontrols.querybypolygon.download.choiches.feature.label"},{id:Qe(),type:"polygon",label:"mapcontrols.querybypolygon.download.choiches.feature_polygon.label"}],download:x=>{x==="polygon"?(d.sbp_qgs_layer_id=t.id,d.sbp_fid=p.fid):(delete d.sbp_fid,delete d.sbp_qgs_layer_id),_(!0)}};if(n.length===1&&m===void 0&&(s.state.toggled[o]=!0),n.length===1&&(u.state.actiontools[Hh.name]=u.state.actiontools[t.id]||{},u.state.actiontools[Hh.name][t.id]=v,u.setCurrentActionLayerFeatureTool({layer:t,index:o,action:s,component:Hh})),m===void 0&&n.length!==1&&(t[e].active=!t[e].active),n.length!==1){let x=m||t[e].active&&m===void 0;u.setLayerActionTool({layer:t,component:x?Hh:null,config:x?v:null})}}}function eO(e){let t=T.getService("queryresults");e.downloadformats.active=!e.downloadformats.active,t.setLayerActionTool({layer:e,component:e.downloadformats.active?Wh:null,config:e.downloadformats.active?{...t.state.actiontools.downloadformats[e.id],downloads:t.state.actiontools.downloadformats[e.id].downloads.filter(n=>n.format!=="pdf")}:null})}var J4,v_=R(()=>{ft();_o();Rt();Ke();ze();ga();Xt();o_();Wt();C4();fw();J4=Ut(K4());T.once("ready",()=>{T.getService("queryresults").onafter("addActionsForLayers",(e,t)=>{let n=T.getService("queryresults");t.filter(s=>s.downloads.length>0).forEach(s=>{e[s.id].push({id:"downloads",download:!0,class:T.getFontClass("download"),state:Vue.observable({toggled:s.features.reduce((o,l,a)=>Object.assign(o,{[a]:null}),{})}),toggleable:!0,hint:"Downloads",change({features:o}){o.forEach((l,a)=>this.state.toggled[a]===void 0?$t.$set(this.state.toggled,a,!1):this.state.toggled[a]=!1)},cbk:(o,l,a,u)=>{a.state.toggled[u]=!a.state.toggled[u],n.setCurrentActionLayerFeatureTool({layer:o,index:u,action:a,component:a.state.toggled[u]?Wh:null})}}),n.state.actiontools.downloadformats=n.state.actiontools.downloadformats||{},n.state.actiontools.downloadformats[s.id]={downloads:s.downloads.map(o=>({id:`download_${o}_feature`,download:!0,format:o,class:T.getFontClass(o),hint:`download_types.${o}`,cbk:(l,a,u,h,p,d)=>{if(Zh(o,l,a,u,h,p,d),n.state.query.type!=="polygon"){let _=e[l.id].find(m=>m.id==="downloads");_.cbk(l,a,_,h,p,d)}}}))}})})})});var _O=He((Fw,mO)=>{(function(e,t){typeof define=="function"&&define.amd?define(t):typeof Fw=="object"?mO.exports=t():e.Cookie=t()})(Fw,function(){"use strict";function e(o,l,a){if(l===void 0)return e.get(o);l===null?e.remove(o):e.set(o,l,a)}e.enabled=function(){var o="__test_key",l;return document.cookie=o+"=1",l=!!document.cookie,l&&e.remove(o),l},e.get=function(o,l){if(typeof o!="string"||!o)return null;o="(?:^|; )"+t(o)+"(?:=([^;]*?))?(?:;|$)";var a=new RegExp(o),u=a.exec(document.cookie);return u!==null?l?u[1]:decodeURIComponent(u[1]):null},e.getRaw=function(o){return e.get(o,!0)},e.set=function(o,l,a,u){a!==!0&&(u=a,a=!1),u=n(u||{});var h=o+"="+(a?l:encodeURIComponent(l))+u;document.cookie=h},e.setRaw=function(o,l,a){e.set(o,l,!0,a)},e.remove=function(o){e.set(o,"a",{expires:new Date})};function t(o){return o.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")}function n(o){var l="";for(var a in o)if(o.hasOwnProperty(a)){if(a==="expires"){var u=o[a];typeof u!="object"&&(u+=typeof u=="number"?"D":"",u=s(u)),o[a]=u.toUTCString()}if(a==="secure"){o[a]&&(l+=";"+a);continue}l+=";"+a+"="+o[a]}return o.hasOwnProperty("path")||(l+=";path=/"),l}function s(o){var l=new Date,a=o.charAt(o.length-1),u=parseInt(o,10);switch(a){case"Y":l.setFullYear(l.getFullYear()+u);break;case"M":l.setMonth(l.getMonth()+u);break;case"D":l.setDate(l.getDate()+u);break;case"h":l.setHours(l.getHours()+u);break;case"m":l.setMinutes(l.getMinutes()+u);break;case"s":l.setSeconds(l.getSeconds()+u);break;default:l=new Date(o)}return l}return e})});var bO=He((yO,vO)=>{(function(){Number.isInteger=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};var e=_O(),t={install:function(n){n.prototype.$cookie=this,n.cookie=this},set:function(n,s,o){var l=o;return Number.isInteger(o)&&(l={expires:o}),e.set(n,s,l)},get:function(n){return e.get(n)},delete:function(n,s){var o={expires:-1};s!==void 0&&(o=Object.assign(s,o)),this.set(n,"",o)}};typeof yO=="object"?vO.exports=t:typeof define=="function"&&define.amd?define([],function(){return t}):window.Vue&&(window.VueCookie=t,Vue.use(t))})()});var xO={};qn(xO,{default:()=>Yie});function Hie(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="SpatialBookMarks.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Dw(){let e=Dw.styles||(Dw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var jie,qie,$ie,Bie,Uie,zie,Vie,Wie,Yie,wO=R(()=>{Ke();ze();gr();_g();Wt();Rt();jie={name:"spatial-bookmarks",components:{InputText:_c},data(){let e=F.project.getId(),t=JSON.parse(window.localStorage.getItem("SPATIALBOOKMARKS")||"{}");return t[e]=t[e]||[],window.localStorage.setItem("SPATIALBOOKMARKS",JSON.stringify(t||"{}")),{showaddform:!1,project:{bookmarks:F.project.state.bookmarks||[]},user:{bookmarks:t[e]},addbookmarkinput:{name:"add-bookmark",label:_e("Name"),i18nLabel:!0,value:null,editable:!0,type:"varchar",input:{type:"text",options:{}},visible:!0,validate:{valid:!1,required:!0}}}},computed:{is_staff(){return window.initConfig.user.is_staff},lang(){return F.language},is_mobile(){return window.innerWidth<767}},methods:{addBookMark(){this.user.bookmarks.push({id:Qe(),name:this.addbookmarkinput.value,extent:T.getService("map").getMapExtent(),removable:!0,crs:{epsg:1*T.getService("map").getCrs().split("EPSG:")[1]}}),this.saveUserBookMarks(),this.showaddform=!1},removeBookMark(e){this.user.bookmarks=this.user.bookmarks.filter(t=>e!==t.id),this.saveUserBookMarks()},saveUserBookMarks(){let e=F.project.getId(),t=JSON.parse(window.localStorage.getItem("SPATIALBOOKMARKS")||"{}");t[e]=this.user.bookmarks||[],window.localStorage.setItem("SPATIALBOOKMARKS",JSON.stringify(t||"{}"))},showAddForm(){this.addbookmarkinput.value=null,this.showaddform=!0},async gotoSpatialBookmark({extent:e,crs:t}){if(window.innerWidth<767&&T.hideSidebar(),t.epsg!==T.getService("map").getEpsg().split("EPSG:")[1]){let n=await In.registerProjection(`EPSG:${t.epsg}`);e=ol.proj.transformExtent(e,n,T.getService("map").getProjection())}T.getService("map").zoomToExtent(e,{force:!0})}},watch:{async showaddform(e){if(e){await this.$nextTick();for(let t=0;t<this.$refs.add_bookmark_input.$el.children.length;t++)this.$refs.add_bookmark_input.$el.children[t].classList.remove("col-sm-12")}}},created(){this.$on("close",()=>this.showaddform=!1)}},qie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"treeview-menu g3w-spatial-bookmarks menu-items",class:{"g3w-tools":!e.showaddform},attrs:{id:"g3w-spatial-bookmarks"}},[e.showaddform?n("li",[n("div",{staticStyle:{display:"flex","justify-content":"end"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"close",expression:"'close'",arg:"left"}],staticClass:"sidebar-button sidebar-button-icon",class:e.$fa("close"),staticStyle:{padding:"5px",margin:"3px"},on:{click:function(s){s.stopPropagation(),e.showaddform=!1}}})]),e._v(" "),n("div",{staticStyle:{color:"#FFF","text-align":"justify",position:"relative","border-radius":"3px",margin:"5px 2px 5px 2px","white-space":"pre-line","background-color":"#384246 !important"}},[n("span",{staticStyle:{"text-align":"center","font-size":"0.7em","margin-top":"-4px","margin-left":"-4px","background-color":"var(--bgcolor)","font-weight":"bold",color:"#fff",position:"absolute",top:"0",left:"0",width:"15px",height:"15px",border:"1px solid #fff","border-radius":"50%"}},[e._v("i")]),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"Move on map extent, insert name and click Add",expression:"'Move on map extent, insert name and click Add'"}],staticStyle:{"max-height":"200px",padding:"10px","overflow-y":"auto"}})]),e._v(" "),n("div",{staticClass:"container add-bookmark-input",staticStyle:{padding:"5px",width:"100%"}},[n("input-text",{ref:"add_bookmark_input",attrs:{state:e.addbookmarkinput}})],1),e._v(" "),n("div",{staticStyle:{"margin-top":"5px"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"},{name:"disabled",rawName:"v-disabled",value:!e.addbookmarkinput.validate.valid,expression:"!addbookmarkinput.validate.valid"}],staticClass:"sidebar-button-run btn btn-block",on:{click:function(s){return s.stopPropagation(),e.addBookMark.apply(null,arguments)}}})])]):[e.is_staff?n("div",{staticClass:"content-bookmarks"},[n("span",{directives:[{name:"t",rawName:"v-t",value:"Project Bookmarks",expression:"'Project Bookmarks'"}],attrs:{hidden:e.is_mobile}}),e._v(" "),n("a",{staticStyle:{float:"right"},attrs:{hidden:e.is_mobile,href:"https://docs.qgis.org/3.34/"+e.lang+"/docs/user_manual/map_views/map_view.html#bookmarking-extents-on-the-map",target:"_blank","data-i18n-title":"QGIS Docs","data-placement":"right"}},[n("i",{class:e.$fa("external-link")})])]):e._e(),e._v(" "),e._l(e.project.bookmarks,function(s){return[s.nodes?n("li",[n("div",{staticStyle:{"font-weight":"bold",width:"100%"},style:{borderBottom:s.expanded?"2px solid #2c3b41":"none"},on:{click:function(o){o.stopPropagation(),s.expanded=!s.expanded}}},[n("span",{class:e.$fa(s.expanded?"caret-down":"caret-right"),staticStyle:{"margin-right":"5px"}}),e._v(" "),n("span",[e._v(e._s(s.name))])]),e._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:s.expanded,expression:"bookmark.expanded"}],staticStyle:{"margin-left":"10px"}},e._l(s.nodes,function(o){return n("li",{staticClass:"spatial-bookmark",on:{click:function(l){return l.stopPropagation(),e.gotoSpatialBookmark(o)}}},[n("div",[n("span",{class:e.$fa("bookmark"),staticStyle:{"margin-right":"5px","font-size":"0.7em"}}),e._v(" "),n("span",{staticClass:"g3w-long-text"},[e._v(e._s(o.name))])])])}),0)]):n("li",{staticClass:"spatial-bookmark",on:{click:function(o){return o.stopPropagation(),e.gotoSpatialBookmark(s)}}},[n("div",[n("span",{class:e.$fa("bookmark"),staticStyle:{"margin-right":"5px","font-size":"0.7em"}}),e._v(" "),n("span",{staticClass:"g3w-long-text"},[e._v(e._s(s.name))])])])]}),e._v(" "),n("div",{staticClass:"content-bookmarks",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-top":"10px"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"User Bookmarks",expression:"'User Bookmarks'"}],attrs:{hidden:e.is_mobile}}),e._v(" "),n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"add",expression:"'add'",arg:"left"}],staticClass:"sidebar-button sidebar-button-icon",class:e.$fa("plus"),staticStyle:{padding:"5px",cursor:"pointer"},attrs:{hidden:e.is_mobile},on:{click:function(s){return s.stopPropagation(),e.showAddForm.apply(null,arguments)}}})]),e._v(" "),e._l(e.user.bookmarks,function(s){return n("li",{staticClass:"spatial-bookmark",on:{click:function(o){return o.stopPropagation(),e.gotoSpatialBookmark(s)}}},[n("div",[n("span",{class:e.$fa("bookmark"),staticStyle:{"margin-right":"5px","font-size":"0.7em"}}),e._v(" "),n("span",{staticClass:"g3w-long-text"},[e._v(e._s(s.name))])]),e._v(" "),n("span",{staticClass:"sidebar-button sidebar-button-icon",staticStyle:{color:"red",margin:"5px",cursor:"pointer"},on:{click:function(o){return o.stopPropagation(),e.removeBookMark(s.id)}}},[n("i",{class:e.$fa("trash")})])])})]],2)},$ie=[],Bie=function(e){e&&e("data-v-0187c0e1_0",{source:".content-bookmarks{font-weight:700;color:#fff;padding:5px;border-bottom:1px solid #fff;margin-bottom:2px}.spatial-bookmark{display:flex;align-items:baseline;justify-content:space-between;padding:5px!important}",map:void 0,media:void 0})},Uie=void 0,zie=void 0,Vie=!1;Wie=Hie({render:qie,staticRenderFns:$ie},Bie,jie,Uie,Vie,zie,!1,Dw,void 0,void 0),Yie=Wie});async function k_(e={}){let t=F.project.getLayersStore(),n=e.values.length>1,s=await fetch(t.getWmsUrl(),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:new URLSearchParams(await T.getPrintParams({SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetPrintAtlas",EXP_FILTER:e.field+(n?" IN (":"=")+e.values.map(o=>`'${o}'`).join()+(n?")":""),TEMPLATE:e.template,filtertoken:F.tokens.filtertoken,DOWNLOAD:e.download?1:void 0})||{}).toString()});if(!s.ok)throw new Error(s.status===500?"Internal Server Error":"Request Failed");return{mime_type:"application/pdf",layers:!0,url:URL.createObjectURL(await s.blob())}}var Gw=R(()=>{Ke();ze()});function nse(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="PrintPage.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function jw(){let e=jw.styles||(jw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Xie,Zie,Qie,Kie,Jie,ese,tse,ise,SO,EO=R(()=>{Ke();ze();Xie={name:"print-page",data(){let e=this.$options.service.state||{};return{state:e,format:e.format,ready:!1}},methods:{async downloadImage(){try{T.disableSideBar(!0),this.state.downloading=!0,["jpg","png","svg"].includes(this.format)&&(await this.imageToDataURL({src:this.state.url,type:`image/${this.format}`}),setTimeout(()=>{T.disableSideBar(!1),this.state.downloading=!1}))}catch(e){console.warn(e)}},imageToDataURL({src:e,type:t="image/jpeg",callback:n=()=>{}}){return new Promise((s,o)=>{let l=new Image;l.onload=function(){let a=document.createElement("canvas"),u=a.getContext("2d");a.height=this.naturalHeight,a.width=this.naturalWidth,u.drawImage(this,0,0);let h=a.toDataURL(t);n(h),s(h)},l.onerror=o,l.src=e})}},watch:{ready:{handler(e){T.setLoadingContent(!e)},immediate:!0}},beforeDestroy(){this.state.url&&F.project.state.ows_method==="POST"&&URL.revokeObjectURL(this.state.url)}},Zie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"print-output"}},[n("transition",{attrs:{duration:500,name:"fade"}},[n("bar-loader",{attrs:{loading:e.state.loading&&e.state.layers}})],1),e._v(" "),e.state.layers?[["pdf","geopdf"].includes(e.format)?n("iframe",{ref:"out",attrs:{src:e.state.url},on:{load:function(s){e.ready=!0},error:function(s){e.ready=!0}}}):n("div",{staticClass:"g3w-print-image-output"},[n("div",{attrs:{id:"g3w-print-header"}},[n("div",{class:{"g3w-disabled":!!(e.state.downloading&&e.state.layers)}},[n("a",{attrs:{href:e.state.url,download:"download."+e.format}},[n("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Download Image",expression:"'Download Image'"}],staticClass:"btn skin-button",class:e.$fa("download"),attrs:{"data-placement":"left",role:"button"},on:{click:function(s){return s.stopPropagation(),e.downloadImage.apply(null,arguments)}}})])])]),e._v(" "),e.state.url?n("div",{staticClass:"g3w-print-url"},[n("img",{ref:"out",attrs:{src:e.state.url},on:{load:function(s){e.ready=!0},error:function(s){e.ready=!0}}})]):e._e()])]:n("h4",{directives:[{name:"t",rawName:"v-t",value:"No Layer to print",expression:"'No Layer to print'"}]})],2)},Qie=[],Kie=function(e){e&&e("data-v-551265b6_0",{source:"#print-output[data-v-551265b6]{height:100%;position:relative}#print-output>iframe[data-v-551265b6]{border:0;width:100%;height:100%}.g3w-print-image-output[data-v-551265b6]{display:flex;flex-direction:column;position:relative;height:100%}#g3w-print-header[data-v-551265b6]{display:flex;justify-content:flex-end;align-items:flex-end;margin-top:5px;margin-bottom:5px}#g3w-print-header button[data-v-551265b6]{font-weight:700}.g3w-print-url[data-v-551265b6]{height:100%;width:100%;position:relative;overflow-y:auto}.g3w-print-url>img[data-v-551265b6]{height:auto;max-width:100%}#print-output>h4[data-v-551265b6]{font-weight:700}",map:void 0,media:void 0})},Jie="data-v-551265b6",ese=void 0,tse=!1;ise=nse({render:Zie,staticRenderFns:Qie},Kie,Xie,Jie,tse,ese,!1,jw,void 0,void 0),SO=ise});var CO={};qn(CO,{default:()=>fse});function dse(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Print.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function qw(){let e=qw.styles||(qw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var sse,rse,ose,ase,lse,cse,use,hse,fse,IO=R(()=>{ft();Ws();Ke();ze();su();qh();ga();Gw();$i();Xt();zd();EO();Rt();sse={name:"print",mixins:[_r],data(){return this.init(),{ApplicationState:F,state:this.state||{},disabled:!1,atlas_values:[]}},computed:{has_maps(){return(this.state.maps||[]).length>0},has_autocomplete(){return!!(this.state.atlas&&this.state.atlas.field_name)},lang(){return F.language}},methods:{init(){this._init=this._init!==void 0?this._init:!1,this._moveKey=this._moveKey||null,this._page=this._page||null,this._resolutions=this._resolutions||{};let e=F.project.getPrint()||[],t=e.length>0,n=[{value:"png",label:"PNG"},{value:"jpg",label:"JPG"},{value:"svg",label:"SVG"},{value:"pdf",label:"PDF"},{value:"geopdf",label:"GEOPDF"}];this.state=Object.assign(this.state||{},{visible:t,print:e,loading:!1,downloading:!1,url:null,layers:!0,maps:t?e[0].maps:void 0,labels:t?e[0].labels:void 0,template:t?e[0].name:void 0,atlas:t?e[0].atlas:void 0,rotation:t?0:void 0,inner:[0,0,0,0],scales:[],scale:t?null:void 0,dpis:[150,300],dpi:150,formats:n,format:n[0].value}),this.print_extent=null},resize(){this.select2&&!F.ismobile&&this.select2.select2("close")},async changeTemplate(){if(!this.state.template)return;await this.$nextTick(),this.select2&&(this.select2.select2("destroy"),this.select2.off(),this.select2=null),this.disabled=!1;let e=this.state.atlas||this.state.maps.length===0,t=this.state.print.find(n=>n.name===this.state.template);Object.assign(this.state,{maps:t.maps,atlas:t.atlas,labels:t.labels}),this.atlas_values=[],this.state.atlas?(this._clearPrint(),this.initSelect2Field()):e?this.showPrintArea(!0):this._setPrintArea(),await this.$nextTick()},changeScale(){try{if(this.state.scale.includes(":")){let e=Number(this.state.scale.split(":")[1].trim());this.$refs.scales.children[this.$refs.scales.children.length-1].value=e,this.state.scale=e}}catch(e){console.warn(e),this.state.scale=this.state.scales[0].value}(Number.isNaN(Number(this.state.scale))||this.state.scale>this.state.scales[0].value)&&(this.state.scale=this.state.scales[0].value),this.state.scale<0&&(this.state.scale=this.state.scales[this.state.scales.length-1].value),$(this.$refs.scales).val(this.state.scale).trigger("change"),this.state.scale&&this._setPrintArea()},changeDpi(){Number.isNaN(Number(this.state.dpi))&&(this.state.dpi=this.state.dpis[0],$(this.$refs.dpi).val(this.state.dpi).trigger("change"))},changeRotation(){this.state.rotation=this.state.rotation>=0?Math.min(this.state.rotation||0,360):Math.max(this.state.rotation||0,-360),T.getService("map").setInnerGreyCoverBBox({rotation:this.state.rotation})},isAxisOrientationInverted(){return T.getService("map").getProjection().getAxisOrientation()==="neu"},getOverviewExtent(e={}){let{xmin:t,xmax:n,ymin:s,ymax:o}=e;return(this.isAxisOrientationInverted()?[s,t,o,n]:[t,s,n,o]).join()},getPrintExtent(){let e=T.getService("map").viewer.map;try{let[t,n]=e.getCoordinateFromPixel([this.state.inner[0],this.state.inner[1]]),[s,o]=e.getCoordinateFromPixel([this.state.inner[2],this.state.inner[3]]);this.print_extent=(this.isAxisOrientationInverted()?[n,t,o,s]:[t,n,s,o]).join()}catch(t){console.warn(t)}return this.print_extent},async print(){let e=!!this.state.atlas,t,n;this.state.loading=!0;try{if(T.disableSideBar(!0),this._page&&await Ot(T.closeContent()),e){F.download=!0;let{url:s}=await k_({template:this.state.template,field:this.state.atlas.field_name||"$id",values:this.atlas_values,download:!0}),o=s&&await fetch(s);if(!o?.ok)throw(await o.json()).message;Si(await o.blob(),this.state.template)}if(!e){this.state.url=null,this.state.layers=!0,this._page=new pt({service:{state:this.state},vueComponentObject:SO}),T.setContent({content:this._page,title:"print",perc:100});let s=this.state.maps.some(p=>p.preset_theme!==void 0),o=F.project.getLayersStore(),l=o.getLayers({PRINTABLE:{scale:this.state.scale},SERVERTYPE:"QGIS"}).reverse(),a=(l||[]).map(p=>p.getPrintLayerName()).join(),u=o.getWmsUrl(),h=l.length&&new URLSearchParams(await T.getPrintParams({SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetPrint",TEMPLATE:this.state.template,DPI:this.state.dpi,STYLES:l.map(p=>p.getStyle()).join(","),OPACITIES:l.map(p=>parseInt(p.getOpacity()/100*255)).join(","),...s?{}:{LAYERS:a},FORMAT:{png:"png",pdf:"application/pdf",geopdf:"application/pdf"}[this.state.format]||this.state.format,...this.state.format==="geopdf"?{FORMAT_OPTIONS:"WRITE_GEO_PDF:TRUE"}:{},CRS:o.getProjection().getCode(),filtertoken:F.tokens.filtertoken,...this.state.maps.map(p=>({name:p.name,preset_theme:p.preset_theme,scale:p.overview?p.scale:this.state.scale,extent:p.overview?this.getOverviewExtent(p.extent):this.getPrintExtent()})).reduce((p,d)=>Object.assign(p,{[`${d.name}:SCALE`]:d.scale,[`${d.name}:EXTENT`]:d.extent,[`${d.name}:ROTATION`]:this.state.rotation,...s&&d.preset_theme===void 0?{[`${d.name}:LAYERS`]:a}:{}}),{}),...(this.state.labels||[]).reduce((p,d)=>Object.assign(p,{[d.id]:d.text}),{})})).toString();if(n=await fetch(u,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:h}),n.status!==200)throw new Error(n.statusText);this.state.url=URL.createObjectURL(await n.blob()),this.state.layers=!!n.ok,this._page.getInternalComponent().$on("hook:mounted",()=>this.state.loading=!1),this._page.unmount=()=>{T.getService("map").viewer.map.once("postrender",this._setPrintArea.bind(this));let p=pt.prototype.unmount.call(this._page);return this._page=null,p}}}catch(s){n&&!n.ok&&n.status===500?t=n.status===500?"Internal Server Error":"Request Failed":t=s,this.state.loading=!1,T.disableSideBar(!1),console.warn(s)}this.state.loading=!1,F.download=!1,(e||!this.state.layers)&&T.disableSideBar(!1),t&&(console.warn(t),T.notify.error(t||_e("info.server_error")),T.closeContent())},showPrintArea(e){let t=!e;t&&this.select2&&this.select2.val(null).trigger("change"),t&&(this.atlas_values=[],this.print_extent=null),this.state.print.length!==0&&T.closeContent().then(n=>{setTimeout(()=>{let s=n.getService();s.getMap().once("postrender",()=>{if(!e)return this._clearPrint();this._moveKey=s.viewer.map.on("moveend",this._setPrintArea.bind(this)),this._initPrintConfig(),this.state.atlas===void 0&&this._setPrintArea()&&s.startDrawGreyCover()}),s.getMap().renderSync()})})},_setPrintArea(){if(!this.has_maps)return this._clearPrint(),!1;let e=T.getService("map").viewer.map,t=e.getSize(),n=e.getView().getResolution(),{h:s,w:o}=this.state.maps.find(d=>!d.overview),l=n*(T.getService("map").getMapUnits()==="m"?1:ol.proj.Units.METERS_PER_UNIT.degrees),a=o/1e3*parseFloat(this.state.scale)/l/2,u=s/1e3*parseFloat(this.state.scale)/l/2,[h,p]=[t[0]/2,t[1]/2];return this.state.inner=[h-a,p+u,h+a,p-u],T.getService("map").setInnerGreyCoverBBox({type:"pixel",inner:this.state.inner,rotation:this.state.rotation}),!0},_clearPrint(){ol.Observable.unByKey(this._moveKey),this._moveKey=null,T.getService("map").stopDrawGreyCover()},_setScales(e){let t=T.getService("map").getMapUnits(),n=Ks(e,t),s=Ul.sort((a,u)=>u.value-a.value),o=s.filter(a=>a.value<n),l=s.findLast(a=>a.value>=n);this.state.scales=(l?[l]:[]).concat(o),this.state.scales.forEach(a=>this._resolutions[a.value]=ba(a.value,t))},_initPrintConfig(){let e=T.getService("map").viewer.map.getView();this._initialized||(this._setScales(e.getMaxResolution()),this._initialized=!0);let t=e.getResolution();Object.entries(this._resolutions).find(([n,s])=>{if(t<=s)return this.state.scale=n,!0})},reload(){this.state.print=F.project.state.print||[];let e=this.state.print.length>0,t=this._initialized;if(this.state.template=e?this.state.print[0].name:this.state.template,e&&!t&&this.init(),e){this._initPrintConfig();let n=T.getService("map");n.on("changeviewaftercurrentproject",()=>{this.state.scales=Ul,this._setScales(n.viewer.map.getView().getMaxResolution())})}else this._clearPrint()},initSelect2Field(){this.select2=$("#print_atlas_autocomplete").select2({width:"100%",multiple:!0,dropdownParent:$(this.$refs.print_atlas),minimumInputLength:1,ajax:{delay:500,transport:async(e,t,n)=>{try{t({results:(await De(this.state.atlas.qgs_layer_id).getFilterData({suggest:`${this.state.atlas.field_name}|${e.data.q}`,unique:this.state.atlas.field_name})).map(s=>({id:s,text:s}))})}catch(s){console.warn(s),n(s)}}},matcher:(e,t)=>{let n=e.term?e.term.toLowerCase():e.term;return(n||"").toString().trim()===""?t:t.text.toLowerCase().includes(n)&&t.text!==void 0?{...t}:null},language:{noResults:()=>_e("No results"),errorLoading:()=>_e("Error Loading Data"),searching:()=>_e("Searching ..."),inputTooShort:e=>`${_e("Please enter")} ${e.minimum-e.input.length} ${_e("or more characters")}`}}),this.select2.on("select2:select",e=>{this.atlas_values.push(e.params.data.id)}),this.select2.on("select2:unselect",e=>{this.atlas_values=this.atlas_values.filter(t=>t!=e.params.data.id)})}},watch:{async has_autocomplete(e){e&&(await this.$nextTick(),this.initSelect2Field())},atlas_values:{immediate:!0,async handler(e){if(this._skip_atlas_check||!this.state.atlas)return;if(this.has_autocomplete){this.disabled=e.length===0;return}let t=o=>o&&Number.isInteger(1*o)&&1*o>=0&&1*o<this.state.atlas.feature_count||null,n=new Set,s=(e?e[0]:"")||"";s.split(",").filter(o=>o).forEach(o=>{if(!o.includes("-")&&t(o)!==null){n.add(o);return}let l=o.split("-"),a=l.filter(u=>t(u)!==null);if(a.length===l.length&&a.reduce((u,h,p)=>u&&(p===0||a[p-1]<=h),!0)){for(let u=1;u<a.length;u++)for(let h=a[u-1];h<a[u];h++)n.add(h+"");n.add(a[a.length-1])}}),this._skip_atlas_check=!0,this.atlas_values=Array.from(n),await this.$nextTick(),this._skip_atlas_check=!1,this.disabled=s.trim()===""}},"state.url":async function(e){if(!e)return;let t;try{await this.$nextTick(),t=setTimeout(()=>{T.disableSideBar(!1),this.state.downloading=!1,T.showUserMessage({type:"alert",message:"timeout"})},$n);let n=await fetch(e);if(!n.ok)throw n.statusText}catch(n){console.warn(n),T.notify.error(n||_e("info.server_error")),T.closeContent()}finally{clearTimeout(t),T.disableSideBar(!1),this.state.downloading=!1}}},async mounted(){await this.$nextTick(),this.state.atlas&&this.initSelect2Field()}},rse=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"treeview-menu",attrs:{id:"print"}},[n("li",[e.state.print.length?n("form",{staticClass:"g3w-search-form form-horizonal",staticStyle:{"border-radius":"0 0 3px 3px",padding:"10px"}},[n("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),n("fieldset",{staticStyle:{border:"1px solid",padding:"4.9px 8.75px 8.75px 10.5px","border-radius":"3px","background-color":"hsl(from var(--bgcolor) h s calc(l + 8))",color:"rgb(255, 255, 255)","user-select":"none"}},[n("legend",{staticStyle:{width:"15px",height:"15px",border:"1px solid","border-radius":"50%","background-color":"rgb(34, 45, 50)","font-weight":"bold",color:"rgb(255, 255, 255)","font-size":"0.7em",display:"flex","justify-content":"center",margin:"0px -14px","user-select":"none"}},[e._v("i")]),e._v(" "),n("details",[n("summary",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right",value:"Show more",expression:"'Show more'",arg:"right"}],staticStyle:{cursor:"pointer",display:"flex","justify-content":"space-between","align-items":"center",width:"100%"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"Exportable layers are defined by the administrator",expression:"'Exportable layers are defined by the administrator'"}],staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"}}),e._v(" "),n("i",{staticClass:"far fa-eye"})]),e._v(" "),n("hr",{staticStyle:{margin:"10px 0","border-style":"dotted"}}),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"print_help",expression:"'print_help'"}],staticStyle:{"white-space":"wrap","line-height":"25px"}})])]),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"Template",expression:"'Template'"}],attrs:{for:"templates"}}),e._v(" "),n("select",{directives:[{name:"select2",rawName:"v-select2",value:"state.template",expression:"'state.template'"}],staticClass:"form-control",style:{marginBottom:this.state.atlas&&"10px"},attrs:{id:"templates",select2_value:e.state.template},on:{change:e.changeTemplate}},e._l(e.state.print,function(s){return n("option",{domProps:{value:s.name}},[e._v(e._s(s.name))])}),0),e._v(" "),e.state.atlas?e._e():[n("label",{directives:[{name:"t",rawName:"v-t",value:"Scale",expression:"'Scale'"}],attrs:{for:"scale"}}),e._v(" "),n("select",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.has_maps,expression:"!has_maps"},{name:"select2",rawName:"v-select2",value:"state.scale",expression:"'state.scale'"}],ref:"scales",staticClass:"form-control",attrs:{id:"scale",select2_value:e.state.scale,createTag:!0},on:{change:e.changeScale}},e._l(e.state.scales,function(s){return n("option",{domProps:{value:s.value}},[e._v(e._s(s.label))])}),0),e._v(" "),n("label",{attrs:{for:"dpi"}},[e._v("dpi")]),e._v(" "),n("select",{directives:[{name:"select2",rawName:"v-select2",value:"state.dpi",expression:"'state.dpi'"}],ref:"dpi",staticClass:"form-control",attrs:{id:"dpi",select2_value:e.state.dpi,createTag:!0},on:{change:e.changeDpi}},e._l(e.state.dpis,function(s){return n("option",[e._v(e._s(s))])}),0),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"Rotation",expression:"'Rotation'"}],attrs:{for:"rotation"}}),e._v(" "),n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.has_maps,expression:"!has_maps"},{name:"model",rawName:"v-model",value:e.state.rotation,expression:"state.rotation"}],staticClass:"form-control",attrs:{id:"rotation",min:"-360",max:"360",type:"number"},domProps:{value:e.state.rotation},on:{input:[function(s){s.target.composing||e.$set(e.state,"rotation",s.target.value)},e.changeRotation]}}),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"Format",expression:"'Format'"}],attrs:{for:"format"}}),e._v(" "),n("select",{directives:[{name:"select2",rawName:"v-select2",value:"state.format",expression:"'state.format'"}],staticClass:"form-control",attrs:{id:"format",select2_value:e.state.format}},e._l(e.state.formats,function(s){return n("option",{domProps:{value:s.value}},[e._v(e._s(s.label))])}),0)],e._v(" "),e.state.atlas?n("div",{ref:"print_atlas",staticClass:"form-group",staticStyle:{width:"100%"}},[e.has_autocomplete?[n("label",{attrs:{for:"print_atlas_autocomplete"}},[n("span",[e._v(e._s(e.state.atlas.field_name))])]),e._v(" "),n("select",{staticClass:"form-control",attrs:{id:"print_atlas_autocomplete",name:e.state.atlas.field_name}})]:[n("label",[n("span",[e._v("fids [max: "+e._s(e.state.atlas.feature_count-1)+"]")])]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.atlas_values,expression:"atlas_values"}],staticClass:"form-control",domProps:{value:e.atlas_values},on:{keydown:function(s){if(!s.type.indexOf("key")&&e._k(s.keyCode,"space",32,s.key,[" ","Spacebar"]))return null;s.preventDefault()},input:function(s){s.target.composing||(e.atlas_values=s.target.value)}}}),e._v(" "),n("div",{attrs:{id:"fid-print-atals-instruction"}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"Values accepted: from 1 to value of [max]. Is possible to insert a range ex. 4-6",expression:"'Values accepted: from 1 to value of [max]. Is possible to insert a range ex. 4-6'"}],attrs:{id:"fids_intruction"}}),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"Ex. 1,4-6 will be printed id 1,4,5,6",expression:"'Ex. 1,4-6 will be printed id 1,4,5,6'"}],attrs:{id:"fids_examples_values"}})])]],2):e._e(),e._v(" "),e.state.labels&&e.state.labels.length>0?n("div",{staticClass:"print-labels-content"},[n("b",{directives:[{name:"t",rawName:"v-t",value:"Labels",expression:"'Labels'"}],staticClass:"skin-color"}),e._v(" "),n("div",{staticClass:"labels-input-content"},e._l(e.state.labels,function(s){return n("span",{key:s.id},[n("label",{attrs:{for:"g3w_label_id_input_"+s.id}},[e._v(" "+e._s(s.id))]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:s.text,expression:"label.text"}],staticClass:"form-control",attrs:{id:"g3w_label_id_input_"+s.id},domProps:{value:s.text},on:{input:function(o){o.target.composing||e.$set(s,"text",o.target.value)}}})])}),0)]):e._e(),e._v(" "),n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.download||e.disabled,expression:"ApplicationState.download || disabled"},{name:"t",rawName:"v-t",value:"Create Print",expression:"'Create Print'"}],staticClass:"sidebar-button-run btn",attrs:{id:"printbutton"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.print.apply(null,arguments)}}})],2):e._e(),e._v(" "),n("div",{staticStyle:{padding:"1em","text-align":"center"}},[n("b",[n("a",{attrs:{href:"https://docs.qgis.org/3.34/"+e.lang+"/docs/training_manual/map_composer/map_composer.html",target:"_blank","data-i18n-title":"QGIS Docs","data-placement":"right"}},[n("i",{class:e.$fa("external-link")}),e._v(" "+e._s(e.$t("Edit in QGIS"))+`
        `)])])])])])},ose=[],ase=function(e){e&&(e("data-v-3da50320_0",{source:"#print .select2-container--open{width:100%}#print .select2-container--open input.select2-search__field{color:#555;width:100%}#print.treeview-menu .select2.select2-container{display:block}",map:void 0,media:void 0}),e("data-v-3da50320_1",{source:".print-labels-content[data-v-3da50320]{margin:15px 0;color:#fff}.print-labels-content>span.skin-color[data-v-3da50320]{font-size:1.1em;display:block;border-bottom:2px solid #fff;margin-bottom:5px}.print-labels-content>.labels-input-content[data-v-3da50320]{max-height:120px;overflow-y:auto}label[data-v-3da50320]{color:#fff}#printbutton[data-v-3da50320]{width:100%;font-weight:700;background-color:var(--skin-color);margin:15px 0}#fid-print-atals-instruction[data-v-3da50320]{margin-top:5px;color:#fff}#fids_intruction[data-v-3da50320]{white-space:pre-line}#fids_examples_values[data-v-3da50320]{margin-top:3px;font-weight:700}.g3w-search-form>label[data-v-3da50320]:not(:nth-child(1)){margin-top:15px}details[open] .fa-eye[data-v-3da50320]{display:none}details[open] summary>span[data-v-3da50320]{overflow:visible!important}",map:void 0,media:void 0}))},lse="data-v-3da50320",cse=void 0,use=!1;hse=dse({render:rse,staticRenderFns:ose},ase,sse,lse,use,cse,!1,qw,void 0,void 0),fse=hse});var LO={};qn(LO,{default:()=>Bw});function xse(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="QueryBuilder.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function $w(){let e=$w.styles||($w.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var pse,gse,mse,_se,yse,vse,bse,wse,Bw,Uw=R(()=>{ft();Ke();ei();ze();Wt();r_();ii();Xt();p1();Rt();pse={name:"query-builder",data(){return{edit:this.$options.options!==void 0,currentlayer:null,message:"",filter:this.$options.options!==void 0?this.$options.options.filter:"",loading:{test:!1,values:!1},values:[],manual:!0,manualvalue:null,select:{field:null,value:null}}},computed:{fields(){return this.currentlayer?this.currentlayer.fields:[]},disabled(){return!this.filter}},watch:{"select.field"(){this.values=[],this.manual=!0}},methods:{addToExpression({value:e,type:t}={}){switch(t){case"operator":e=` ${e} `;break;case"field":e=`"${e}"`;break;case"value":e=`'${e}'`;break}e&&(this.filter=`${this.filter}${e}`)},async all(){this.loading.values=!0;try{let e=this.currentlayer.id,t=this.select.field,n=F.querybuilder.cache;if(n[e]=n[e]||{},n[e][t]!==void 0)this.values=n[e][t];else{let s=await Ye.get({url:De(e).getUrl("data"),params:{ordering:t,formatter:1,fformatter:t}});s.result&&(n[e][t]=n[e][t]||s.data),this.values=n[e][t]||[]}}catch(e){console.warn(e)}this.loading.values=!1,await this.$nextTick(),this.manualvalue=null,this.manual=!1},reset(){this.filter="",this.message="",this.filterElement.previous=null,this.filterElement.current=null,this.filterElement.operator=null,this.select.field=null,this.$refs.search_fields&&(this.$refs.search_fields.selectedIndex=-1),this.$refs.search_values&&(this.$refs.search_values.selectedIndex=-1)},async run(){try{this.loading.test=!0;let e=De(this.currentlayer.id),{data:t}=await gt.getData("search:features",{inputs:{layer:e,filter:mu({layer:e,filter:this.filter}),feature_count:100},outputs:!0}),n=t.length&&t[0].features.length;return this.message=n===void 0?"":` ${n}`,t}catch(e){console.warn(e)}finally{this.loading.test=!1}},async save(){let e=this.projectId||F.project.getId(),t=this.edit&&this.$options.options.id,n=window.localStorage.getItem("QUERYBUILDERSEARCHES"),s=n?JSON.parse(n):void 0,o;try{if(o={layerId:this.currentlayer.id,filter:this.filter,layerName:De(this.currentlayer.id).getName(),name:t?this.edit&&this.$options.options.name:await new Promise((a,u)=>Hm({label:_e("Insert the name of the new search"),value:"",callback:h=>h?a(h):u()})),id:t||Qe()},t){let a=s[e].findIndex(u=>u.id===o.id);a!==-1&&(s[e][a]=o)}else T.getService("search").state.querybuildersearches.push(o),s===void 0?s={[e]:[o]}:s[e]=[...s[e]||[],o]}catch(a){console.warn(a);return}let l=F.querybuilder.searches;try{window.localStorage.setItem("QUERYBUILDERSEARCHES",JSON.stringify(s))}catch(a){console.warn(a)}setTimeout(()=>{s[e].forEach(a=>l[e].push(a))},0),l[e].splice(0),T.showUserMessage({type:"success",message:_e("Saved"),autoclose:!0})}},created(){this.filterElement={current:null,previous:null,operator:null};let e=F.project;this.layers=e.getLayers().filter(t=>!t.baselayer&&Array.isArray(t.fields)).map(t=>{let n=[];return e.state.relations.filter(s=>t.id===s.referencedLayer&&s.type==="ONE").forEach(s=>{let o=e.getLayerById(s.referencingLayer);s.customPrefix=s.customPrefix===void 0?`${o.getName()}_`:s.customPrefix,n=[...n,...o.getFields().map(l=>`${s.customPrefix}${l.name}`)]}),{id:t.id,label:t.title,fields:t.fields.filter(s=>s.show).map(s=>({label:s.label,name:s.name})).filter(s=>!n.includes(s))}}),this.operators=Object.values(yp),this.currentlayer=this.edit?this.layers.find(t=>t.id===this.$options.options.layerId):this.layers[0]},async mounted(){await this.$nextTick(),this.select2=$("#query_builder_layers_select").select2({width:"100%"}),this.edit&&(this.select2.val(this.layers.indexOf(this.currentlayer)),this.select2.trigger("change")),this.select2.on("select2:select",e=>{this.currentlayer=this.layers[e.params.data.id],this.select.field=null,this.select.value=null,this.reset()})},beforeDestroy(){this.select2.select2("destroy"),this.select2=null}},gse=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-group",attrs:{id:"query_builder"}},[n("div",{staticClass:"mb-5",attrs:{id:"query_builder_layers"}},[n("label",{directives:[{name:"t",rawName:"v-t",value:"EXPRESSION",expression:"'EXPRESSION'"}],staticClass:"querybuilder-title"}),e._v(" "),n("a",{staticStyle:{float:"right"},attrs:{href:"https://g3w-suite.readthedocs.io/en/v3.9.x/g3wsuite_client.html#search-and-query-builder",target:"_blank","data-i18n-title":"Docs","data-placement":"right"}},[n("i",{class:e.$fa("external-link")})]),e._v(" "),n("select",{staticClass:"form-control",attrs:{id:"query_builder_layers_select"}},e._l(e.layers,function(s,o){return n("option",{key:s.label,staticClass:"bold",domProps:{value:o}},[e._v(e._s(s.label))])}),0)]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],attrs:{id:"query_builder_expression_content"},domProps:{value:e.filter},on:{input:function(s){s.target.composing||(e.filter=s.target.value)}}}),e._v(" "),n("bar-loader",{attrs:{loading:e.loading.test}}),e._v(" "),n("b",{directives:[{name:"show",rawName:"v-show",value:e.message,expression:"message"}],staticClass:"skin-color"},[n("span",{directives:[{name:"t",rawName:"v-t",value:"Features found:",expression:"'Features found:'"}]}),e._v(e._s(e.message))]),e._v(" "),n("div",{staticClass:"content-end"},[n("button",{directives:[{name:"t",rawName:"v-t",value:"RUN",expression:"'RUN'"}],staticClass:"query_builder_button btn btn-secondary bold",attrs:{disabled:e.disabled},on:{click:e.run}},[n("i",{class:e.$fa("run"),staticStyle:{color:"green"}})]),e._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"CLEAR",expression:"'CLEAR'"}],staticClass:"query_builder_button btn btn-secondary bold",on:{click:e.reset}},[n("i",{class:e.$fa("clear")})]),e._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"SAVE",expression:"'SAVE'"}],staticClass:"query_builder_button btn btn-secondary bold",attrs:{disabled:e.disabled},on:{click:e.save}},[n("i",{class:e.$fa("save")})])]),e._v(" "),n("hr"),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"FIELDS",expression:"'FIELDS'"}]}),e._v(" "),n("select",{ref:"search_fields",staticClass:"mb-5",attrs:{size:"4"}},[n("option",{attrs:{selected:"",hidden:""}}),e._v(" "),e._l(e.fields,function(s){return n("option",{key:s.name,on:{click:function(o){e.select.field=s.name,e.addToExpression({value:s.name,type:"field"})}}},[e._v(e._s(s.label))])})],2),e._v(" "),n("div",{staticClass:"content-wrap mb-5"},e._l(e.operators,function(s){return n("button",{key:s,staticClass:"query_builder_button btn btn-secondary bold",on:{click:function(o){return e.addToExpression({value:s,type:"operator"})}}},[e._v(e._s(s))])}),0),e._v(" "),n("bar-loader",{attrs:{loading:e.loading.values}}),e._v(" "),e.manual?e._e():n("select",{ref:"search_values",staticClass:"mb-5",attrs:{size:"4"}},[n("option",{attrs:{selected:"",hidden:""}}),e._v(" "),e._l(e.values,function(s){var o=s[0],l=s[1];return n("option",{key:o,on:{click:function(a){e.select.value=o,e.addToExpression({value:o,type:"value"})}}},[e._v(e._s(l))])})],2),e._v(" "),e.select.field!==null&&!e.values.length?n("button",{staticClass:"btn btn-secondary bold",class:{"skin-border-color":!e.manual},staticStyle:{color:"#000"},on:{click:e.all}},[n("i",{class:e.g3wtemplate.getFontClass("search")}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"SEARCH A VALUE",expression:"'SEARCH A VALUE'"}]})]):e._e()],1)},mse=[],_se=function(e){e&&e("data-v-5e907e2b_0",{source:"#query_builder[data-v-5e907e2b]{margin-bottom:0;height:100%;display:flex;flex-wrap:nowrap;flex-direction:column}#query_builder .select2.select2-container[data-v-5e907e2b]{font-weight:700}.querybuilder-title[data-v-5e907e2b]{color:#fff;font-weight:700}select[data-v-5e907e2b]{background-color:#fff;color:#000;border:none}option[data-v-5e907e2b]{padding:8px;cursor:pointer}option[data-v-5e907e2b]:checked{background:var(--skin-color) linear-gradient(0deg,var(--skin-color) 0,var(--skin-color) 100%);color:#fff}option[data-v-5e907e2b]:nth-of-type(2n+1){background-color:#f9f9f9}.query_builder_button[data-v-5e907e2b]{margin:1px;flex-basis:78px;flex-grow:1;color:#000}.content-wrap[data-v-5e907e2b]{display:flex;flex-wrap:wrap}.content-end[data-v-5e907e2b]{display:flex;flex-wrap:wrap;justify-content:flex-end;margin-top:5px}.mb-5[data-v-5e907e2b]{margin-bottom:5px}#query_builder_expression_content[data-v-5e907e2b]{width:100%;resize:none;height:100px;color:#000}",map:void 0,media:void 0})},yse="data-v-5e907e2b",vse=void 0,bse=!1;wse=xse({render:gse,staticRenderFns:mse},_se,pse,yse,bse,vse,!1,$w,void 0,void 0),Bw=wse});var NO={};qn(NO,{default:()=>Vw});function kse(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Tool.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function zw(){let e=zw.styles||(zw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Sse,Ese,Cse,Ise,Lse,Nse,Tse,Rse,Vw,Hw=R(()=>{Ke();ze();Sse={name:"g3w-tool",props:["tool"],methods:{showToolStateMessage(){T.showModalDialog({title:this.tool.state.type.toUpperCase(),message:this.tool.state.message})}},computed:{disabled(){return!this.tool.offline&&!F.online||this.tool.loading||this.tool.disabled},sidebarOpen(){return F.gui.sidebar.open}}},Ese=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.tool.type==="checkbox"?n("div",{staticClass:"checkbox"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.tool.isCheck,expression:"tool.isCheck"}],staticStyle:{cursor:"pointer"},attrs:{id:e.tool.layerName,type:"checkbox"},domProps:{value:e.tool.layerName,checked:Array.isArray(e.tool.isCheck)?e._i(e.tool.isCheck,e.tool.layerName)>-1:e.tool.isCheck},on:{click:function(s){return e.tool.action(e.tool)},change:function(s){var o=e.tool.isCheck,l=s.target,a=!!l.checked;if(Array.isArray(o)){var u=e.tool.layerName,h=e._i(o,u);l.checked?h<0&&e.$set(e.tool,"isCheck",o.concat([u])):h>-1&&e.$set(e.tool,"isCheck",o.slice(0,h).concat(o.slice(h+1)))}else e.$set(e.tool,"isCheck",a)}}}),e._v(`
      `+e._s(e.tool.name)+`
    `)])]):n("div",{staticClass:"tool",class:{tool_disabled:e.disabled},staticStyle:{position:"relative"},attrs:{"data-i18n-title":e.sidebarOpen?null:e.tool.html&&e.tool.html.text||e.tool.name,"data-placement":"right"},on:{click:function(s){e.disabled||e.tool.action(e.tool)}}},[n("bar-loader",{attrs:{loading:e.tool.loading}}),e._v(" "),n("i",{class:e.$fa(e.tool.icon||"caret-right")}),e._v(" "),e.tool.html?n("span",{staticClass:"tool-label"},[n("i",{class:e.tool.html.icon}),e._v(`
    `+e._s(e.tool.html.text||e.tool.name)+`
    `)]):n("span",{directives:[{name:"t",rawName:"v-t",value:e.tool.name,expression:"tool.name"}],staticClass:"tool-label"}),e._v(" "),e.tool.state.type?n("span",{staticClass:"tool_type",style:{color:{alert:"red",info:"blue",warning:"orange"}[e.tool.state.type]},on:{click:function(s){return s.stopPropagation(),e.showToolStateMessage.apply(null,arguments)}}},[n("i",{class:e.$fa(e.tool.state.type)})]):e._e()],1)])},Cse=[],Ise=function(e){e&&e("data-v-737daaaf_0",{source:".tool_disabled[data-v-737daaaf]{cursor:not-allowed}.tool_disabled>span[data-v-737daaaf]{color:#777}.tool_type[data-v-737daaaf]{cursor:pointer;vertical-align:center;position:absolute;right:0;top:0;padding:5px}",map:void 0,media:void 0})},Lse="data-v-737daaaf",Nse=void 0,Tse=!1;Rse=kse({render:Ese,staticRenderFns:Cse},Ise,Sse,Lse,Tse,Nse,!1,zw,void 0,void 0),Vw=Rse});var TO={};qn(TO,{default:()=>$se});function jse(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Search.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Ww(){let e=Ww.styles||(Ww.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Mse,Ase,Ose,Pse,Fse,Dse,Gse,qse,$se,kO=R(()=>{Ka();Ke();ei();ze();r_();Xt();Hw();Uw();Rt();Mse={name:"search",data(){return{state:this.state||{}}},components:{"g3w-tool":Vw},computed:{show(){return this.state.searches.length+this.state.tools.length+this.state.querybuildersearches.length>0}},methods:{showPanel(e={}){this.$options.service.showPanel(e)},async remove(e,t){try{await new Promise((a,u)=>{T.dialog.confirm(_e("Do you want delete it?"),h=>h?a():u())});let n=window.localStorage.getItem("QUERYBUILDERSEARCHES"),s=n?JSON.parse(n):void 0,o=F.project.getId(),l=(s?s[o]||[]:[]).filter(a=>a.id!==e.id);l.length?s[o]=l:delete s[o];try{Object.keys(s).length?window.localStorage.setItem("QUERYBUILDERSEARCHES",JSON.stringify(s)):window.localStorage.removeItem("QUERYBUILDERSEARCHES")}catch(a){console.warn(a)}this.state.querybuildersearches.splice(t,1)}catch(n){console.warn(n)}},edit(e){let t={id:e.id,name:e.name,layerId:e.layerId,filter:e.filter,title:_e("Advanced search"),show:!0};t.internalPanel=new(Vue.extend(Bw))({options:t}),new Un(t)},async run(e){e.qbloading=!0;try{let t=De(e.layerId);await gt.getData("search:features",{inputs:{layer:t,filter:mu({layer:t,filter:e.filter}),feature_count:100},outputs:!0})}catch(t){console.warn(t),T.showUserMessage({type:"alert",message:"An error occurs. Please check the query",autoclose:!0})}e.qbloading=!1}}},Ase=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("ul",{staticClass:"treeview-menu g3w-search g3w-tools menu-items",attrs:{id:"g3w-search"}},[e._l(e.state.searches,function(s){return n("li",{staticClass:"menu-item",on:{click:function(o){return e.showPanel(s)}}},[n("i",{class:e.$fa("empty-circle")}),e._v(" "),n("span",[e._v(e._s(s.name))])])}),e._v(" "),e._l(e.state.tools,function(s){return n("li",[n("g3w-tool",{attrs:{tool:s}})],1)}),e._v(" "),e._l(e.state.querybuildersearches,function(s,o){return n("li",{key:s.id},[n("div",{staticStyle:{position:"relative"},on:{click:function(l){return e.edit(s)}}},[n("bar-loader",{attrs:{loading:s.qbloading}}),e._v(" "),n("div",{staticClass:"search-tools"},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Delete",expression:"'Delete'"}],staticClass:"search-action",class:e.$fa("trash"),staticStyle:{color:"red","margin-right":"5px"},attrs:{"data-placement":"bottom"},on:{click:function(l){return l.stopPropagation(),e.remove(s,o)}}}),e._v(" "),n("span",[e._v(e._s(s.name))]),e._v(" "),n("div",[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom",value:"Run",expression:"'Run'",arg:"bottom"}],staticClass:"search-action",class:e.$fa("run"),staticStyle:{color:"green"},on:{click:function(l){return l.stopPropagation(),e.run(s)}}})])])],1)])})],2):e._e()},Ose=[],Pse=function(e){e&&e("data-v-151d1b17_0",{source:"li.menu-item[data-v-151d1b17]{padding-right:20px!important}li.menu-item span[data-v-151d1b17]{display:inline-flex;white-space:pre-wrap}.search-action[data-v-151d1b17]{text-shadow:0 2px 5px rgba(0,0,0,.3);padding:0 4px}#g3w-search li i[data-v-151d1b17]{width:20px}.search-tools[data-v-151d1b17]{display:flex;align-items:baseline}.search-tools>span[data-v-151d1b17]{white-space:pre-wrap}.search-tools>div[data-v-151d1b17]{margin-left:auto}",map:void 0,media:void 0})},Fse="data-v-151d1b17",Dse=void 0,Gse=!1;qse=jse({render:Ase,staticRenderFns:Ose},Pse,Mse,Fse,Gse,Dse,!1,Ww,void 0,void 0),$se=qse});function Xse(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="CatalogChangeMapThemes.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Yw(){let e=Yw.styles||(Yw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Bse,Use,zse,Vse,Hse,Wse,Yse,Zse,RO,MO=R(()=>{_g();ze();Ke();ii();Rt();Bse={name:"changemapthemes",components:{InputText:_c},props:{map_themes:{type:Object,default:{project:[],custom:[]}},layerstrees:{type:Array}},data(){let e=Object.values(this.map_themes).flat().find(t=>t.default);return{active_theme:e&&e.theme||null,collapsed:F.project.state.toc_themes_init_status==="collapsed",custom_theme:{name:"add-user-theme",label:"Name of new map theme",i18nLabel:!0,value:null,editable:!0,type:"varchar",input:{type:"text",options:{}},visible:!0,validate:{valid:!1,required:!0,error:"Invalid or exiting name"}},show_form:!1}},methods:{toggle(){this.show_form||(document.getElementById("g3w-catalog-views").classList.toggle("menu-open"),this.collapsed=!this.collapsed)},_getMapThemeParams(){let e={layerstree:[],styles:{}},t=(n,s)=>{n.forEach(o=>{let l=o.id!==void 0?{id:o.id,name:o.name,visible:o.visible,expanded:o.expanded}:{name:o.name,checked:o.checked,expanded:o.expanded,"mutually-exclusive":o["mutually-exclusive"]};Array.isArray(o.nodes)&&(l.nodes=[],t(o.nodes,l.nodes)),o.id!==void 0&&(e.styles[o.id]=o.styles.find(a=>a.current).name),s.push(l)})};return t(this.layerstrees[0].tree[0].nodes,e.layerstree),e},async saveTheme(){let e=this.custom_theme.value;if(e)try{let t=this._getMapThemeParams(),n=await Ye.post({url:`${F.project.urls.map_themes}${encodeURIComponent(e)}/`,contentType:"application/json",data:JSON.stringify(t)});if(!n.result)throw n;this.map_themes.custom.push({theme:this.custom_theme.value,styles:t.styles}),T.showUserMessage({type:"success",message:"Theme saved successfully",autoclose:!0}),this.show_form=!1,this.active_theme=this.custom_theme.value,await this.$nextTick(),this.custom_theme.value=null}catch(t){console.warn(t),T.showUserMessage({type:"alert",message:t.error||"info.server_error"})}},async updateTheme(e){if(e)try{let t=this._getMapThemeParams(),n=await Ye.post({url:`${F.project.urls.map_themes}${encodeURIComponent(e)}/`,contentType:"application/json",data:JSON.stringify(t)});if(!n.result)throw n;Object.assign(this.map_themes.custom.find(s=>e===s.theme),{styles:t.styles,layerstree:t.layerstree}),T.showUserMessage({type:"success",message:"Theme updated successfully",autoclose:!0})}catch(t){console.warn(t),T.showUserMessage({type:"alert",message:t.error||"info.server_error"})}},deleteTheme(e){T.dialog.confirm(_e("Do you want delete the theme?"),async t=>{if(!(!t||!e))try{let n=await(await fetch(`${F.project.urls.map_themes}${encodeURIComponent(e)}/`,{method:"DELETE"})).json();if(!n.result)throw n;this.map_themes.custom=this.map_themes.custom.filter(({theme:s})=>s!==e),T.showUserMessage({type:"success",message:"Theme deleted successfully",autoclose:!0}),e===this.active_theme&&(this.active_theme=null)}catch(n){console.warn(n),T.showUserMessage({type:"alert",message:n.error||"info.server_error"})}})}},watch:{active_theme:{immediate:!1,handler(e){e===null||e===this.custom_theme.value||this.$emit("change-map-theme",e)}},"custom_theme.value"(e){setTimeout(()=>{this.custom_theme.validate.valid=e?!this.map_themes.custom.find(({theme:t})=>t===e.trim()):!1},200)},async show_form(e){this.custom_theme.value=null,e&&(await this.$nextTick(),Array.from(this.$refs.add_map_theme_input.$el.children).forEach(t=>t.classList.remove("col-sm-12")))}},created(){this.logged=F.user.id!==void 0}},Use=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"sidebar-menu"},[n("li",{staticClass:"treeview sidebaritem skin-border-color",attrs:{id:"g3w-catalog-toc-views"}},[n("a",{staticClass:"g3w-map-theme-anchor",attrs:{href:"#"}},[n("section",{on:{click:function(s){return s.stopPropagation(),e.toggle.apply(null,arguments)}}},[n("i",{class:e.$fa(e.collapsed?"caret-down":"caret-up"),staticStyle:{padding:"3px"}}),e._v(" "),n("i",{class:e.$fa(e.collapsed?"eye-close":"eye"),staticStyle:{padding:"0 0 0 4px"}}),e._v(" "),e.active_theme?n("span",{staticClass:"current_map_theme treeview-label g3w-long-text"},[n("span",{directives:[{name:"t",rawName:"v-t:pre",value:"THEME",expression:"'THEME'",arg:"pre"}]},[e._v(":")]),e._v(" "),n("span",{staticClass:"skin-color",staticStyle:{"font-size":"1.1em"}},[e._v(e._s(e.active_theme))])]):n("b",{directives:[{name:"t",rawName:"v-t",value:"CHOOSE THEME",expression:"'CHOOSE THEME'"}],staticClass:"treeview-label"})])]),e._v(" "),e.show_form?n("div",{staticClass:"add-map-theme skin-border-color"},[n("div",{staticStyle:{display:"flex","justify-content":"end","padding-top":"5px"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"close",expression:"'close'",arg:"left"}],staticClass:"sidebar-button sidebar-button-icon",class:e.$fa("close"),staticStyle:{padding:"2px",margin:"2px"},on:{click:function(s){s.stopPropagation(),e.show_form=!1}}})]),e._v(" "),n("div",{staticClass:"container add-map-theme-input"},[n("input-text",{ref:"add_map_theme_input",attrs:{state:e.custom_theme}})],1),e._v(" "),n("div",{staticStyle:{"margin-top":"5px"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"},{name:"disabled",rawName:"v-disabled",value:!e.custom_theme.validate.valid,expression:"!custom_theme.validate.valid"}],staticClass:"sidebar-button-run btn btn-block",on:{click:function(s){return s.stopPropagation(),e.saveTheme.apply(null,arguments)}}})])]):n("ul",{class:{"menu-open":!e.collapsed},attrs:{id:"g3w-catalog-views"}},[(e.map_themes.project||[]).length>0?n("li",{attrs:{id:"g3w-catalog-views-project"}},[n("ul",{staticStyle:{padding:"0"}},[n("li",[n("div",{directives:[{name:"t",rawName:"v-t",value:"Project Themes",expression:"'Project Themes'"}],staticClass:"project_map_theme"})]),e._v(" "),n("li",{staticStyle:{padding:"5px 5px 5px 17px"}},e._l(e.map_themes.project,function(s,o){return n("div",{key:s.theme},[n("label",{attrs:{for:"g3w-map_theme-"+o}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.active_theme,expression:"active_theme"}],attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+o},domProps:{value:s.theme,checked:e._q(e.active_theme,s.theme)},on:{change:function(l){e.active_theme=s.theme}}}),e._v(" "),n("span",{staticClass:"g3w-long-text"},[e._v(e._s(s.theme))])])])}),0)])]):e._e(),e._v(" "),e.logged?n("li",{attrs:{id:"g3w-catalog-views-user"}},[n("ul",{staticStyle:{padding:"0"}},[n("li",[n("div",{staticClass:"user_map_theme"},[n("span",{directives:[{name:"t",rawName:"v-t",value:"User Themes",expression:"'User Themes'"}]}),e._v(" "),n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"add",expression:"'add'",arg:"left"}],staticClass:"action sidebar-button sidebar-button-icon",class:e.$fa("plus"),staticStyle:{"margin-left":"auto",padding:"5px"},on:{click:function(s){s.stopPropagation(),e.show_form=!e.show_form}}})])]),e._v(" "),n("li",{staticStyle:{padding:"5px 5px 5px 17px"}},e._l(e.map_themes.custom,function(s,o){return n("div",{key:s.theme,staticStyle:{display:"flex","justify-content":"space-between"}},[n("span",[n("label",{attrs:{for:"g3w-map_theme-"+o+"-user"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.active_theme,expression:"active_theme"}],attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+o+"-user"},domProps:{value:s.theme,checked:e._q(e.active_theme,s.theme)},on:{change:function(l){e.active_theme=s.theme}}}),e._v(" "),n("span",{staticClass:"g3w-long-text"},[e._v(e._s(s.theme))])])]),e._v(" "),n("span",{staticClass:"g3w-custom-map-theme-tools"},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"update",expression:"'update'",arg:"top"},{name:"disabled",rawName:"v-disabled",value:e.active_theme!==s.theme,expression:"active_theme !== map_theme.theme"}],staticClass:"action sidebar-button sidebar-button-icon",staticStyle:{padding:"5px"},on:{click:function(l){return l.stopPropagation(),e.updateTheme(s.theme)}}},[n("i",{staticClass:"skin-color",class:e.$fa("save")})]),e._v(" "),n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"cancel",expression:"'cancel'",arg:"top"}],staticClass:"action sidebar-button sidebar-button-icon",staticStyle:{padding:"5px"},on:{click:function(l){return l.stopPropagation(),e.deleteTheme(s.theme)}}},[n("i",{class:e.$fa("trash"),staticStyle:{color:"red"}})])])])}),0)])]):e._e()])])])},zse=[],Vse=function(e){e&&e("data-v-544d7057_0",{source:"#g3w-catalog-toc-views[data-v-544d7057]{margin-bottom:5px;border-bottom:2px solid}.g3w-map-theme-anchor[data-v-544d7057]{padding:0;margin-bottom:5px}.g3w-map-theme-anchor>section[data-v-544d7057]{display:flex;flex-wrap:wrap;align-items:center;padding:5px}.add-map-theme[data-v-544d7057]{border-top:2px solid;margin:5px 0}.add-map-theme-input[data-v-544d7057]{width:100%}#g3w-catalog-views[data-v-544d7057]{display:none;padding:0}#g3w-catalog-views.menu-open[data-v-544d7057]{display:block}.current_map_theme[data-v-544d7057]{overflow:hidden;white-space:normal;text-overflow:ellipsis}.project_map_theme[data-v-544d7057]{font-weight:700;padding:3px;border-bottom:1px solid #fff}.user_map_theme[data-v-544d7057]{font-weight:700;padding:5px 3px;display:flex;justify-content:space-between;align-self:baseline;border-bottom:1px solid #fff}",map:void 0,media:void 0})},Hse="data-v-544d7057",Wse=void 0,Yse=!1;Zse=Xse({render:Use,staticRenderFns:zse},Vse,Bse,Hse,Yse,Wse,!1,Yw,void 0,void 0),RO=Zse});var R_,Xw=R(()=>{R_={created(){this.__CLICK_EVENT={count:0,timeoutID:null}},methods:{handleClick(e={},t){if(!this.__CLICK_EVENT){console.warn("click mixin not initialized on context:",t);return}this.__CLICK_EVENT.count+=1,this.__CLICK_EVENT.timeoutID||(this.__CLICK_EVENT.timeoutID=setTimeout(()=>{e[this.__CLICK_EVENT.count]!==void 0&&e[this.__CLICK_EVENT.count].call(t),this.__resetClickMixin()},300))},__resetClickMixin(){this.__CLICK_EVENT.count=0,this.__CLICK_EVENT.timeoutID=null},__clearClickMixin(){this.__resetClickMixin(),this.__CLICK_EVENT=null}},beforeDestroy(){this.__clearClickMixin()}}});function sre(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="CatalogLayerLegend.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Zw(){let e=Zw.styles||(Zw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Qse,Kse,Jse,ere,tre,nre,ire,rre,AO,OO=R(()=>{ze();Ke();Xw();Xt();ii();Qse={name:"catalog-layer-legend",props:{legendplace:{type:String},layer:{type:Object}},data(){return{loading:!1,categories:[],currentstyle:this.layer.styles.find(e=>e.current===!0).name}},mixins:[R_],computed:{showfeaturecount(){return this.layer.featurecount!==void 0},externallegend(){return this.layer.source.type==="wms"},legend(){return this.layer.legend},show(){return this.layer.expanded&&this.layer.visible&&(this.legendplace==="toc"||this.legendplace==="tab"&&this.layer.categories)}},methods:{onCategoryClick(){this.handleClick({1:()=>{console.info("TODO: select category (single click)")},2:()=>{console.info("TODO: zoom to category (double click)")}},this)},showCategoryMenu(){this.$emit("showmenucategory")},getWmsSourceLayerLegendUrl(){return this.getProjectLayer().getLegendUrl({...(window.initConfig.layout||{}).legend,width:16,height:16})},getProjectLayer(){return De(this.layer.id)},isDisabled(e){return this.categories[e].disabled},showHideLayerCategory(e){this.categories[e].checked=!this.categories[e].checked,this.getProjectLayer().change(),this.legendplace==="tab"?this.layer.legend.change=!0:this.categories[e].checked&&this.mapReady&&this.setLayerCategories(!1)},setError(){this.legend.error=!0,this.legend.loading=!1},async urlLoaded(){this.legend.loading=!1},async onChangeLayerLegendStyle(e={}){if(this.loading=!0,!this.externallegend){try{await this.setLayerCategories(!0),this.currentstyle=e.style,this.dynamic&&await this.setLayerCategories(!1)}catch(t){console.warn("Error while changing layer style",t)}this.loading=!1}},async setLayerCategories(e=!1){try{let t=this.getProjectLayer(),n=t.getCategories();if(e&&n)this.categories=n;else{let{nodes:s=[]}=await Ye.get({url:t.getLegendUrl(window.initConfig.layout?.legend,{categories:!0,format:"application/json",all:e})});e?this._setAllLayerCategories(s):this._updateLayerCategories(s,n)}}catch(t){console.warn(t),this.setError()}},_setAllLayerCategories(e){let t=this.getProjectLayer(),n=[];e.forEach(({icon:s,title:o,ruleKey:l,checked:a,symbols:u=[]})=>{s?n.push({icon:s,title:o,ruleKey:l,checked:a,disabled:!1}):u.forEach(h=>{h._checked=h.checked,h.disabled=!1,n.push(h)})}),t.setCategories(n),this.categories=n},_updateLayerCategories(e=[],t=[]){this.getProjectLayer().setCategories(t),this.categories=t,e.length>0?e.forEach(({icon:n,title:s,symbols:o=[]})=>{n&&(o=[{icon:n,title:s}]),t.forEach(l=>{let a=o.find(h=>h.icon===l.icon&&h.title===l.title),u=l.checked===void 0||l.checked;l.disabled=u&&a===void 0,l.icon=(o.find(h=>h.title===l.title&&h.icon!==l.icon)||{icon:l.icon}).icon})}):t.forEach(n=>n.disabled=n.checked===void 0||n.checked)},async onChangeMapLegendParams(){this.mapReady=!0,this.layer.visible&&this.externallegend===!1&&(this.legendplace==="toc"||this.layer.categories)&&this.setLayerCategories(!1)},async runInitLayerVisibleAction(){await this.setLayerCategories(!0),this.dynamic&&(await this.setLayerCategories(!1),T.getService("map").on("change-map-legend-params",this.onChangeMapLegendParams)),this.initialize=!0}},watch:{async"layer.visible"(e){let t=e&&this.externallegend===!1;t&&this.initialize===!1&&await this.runInitLayerVisibleAction(),t&&this.initialize!==!1&&await this.setLayerCategories(!this.dynamic)}},async created(){this.initialize=!1,this.dynamic=F.project.state.context_base_legend,this.mapReady=!1,this.getProjectLayer().onafter("change",this.onChangeLayerLegendStyle),this.externallegend===!1&&this.layer.visible===!0&&await this.runInitLayerVisibleAction()},beforeDestroy(){this.getProjectLayer().un("change",this.onChangeLayerLegendStyle)}},Kse=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",{staticClass:"layer-legend",on:{click:function(s){s.stopPropagation(),s.preventDefault()}}},[e.legend?n("bar-loader",{attrs:{loading:e.legend.loading}}):e._e(),e._v(" "),e.externallegend?n("figure",[n("img",{attrs:{src:e.getWmsSourceLayerLegendUrl()}})]):n("figure",{directives:[{name:"disabled",rawName:"v-disabled",value:e.loading,expression:"loading"}]},[n("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),e._l(e.categories,function(s,o){return n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:s.disabled,expression:"category.disabled"}],staticStyle:{display:"flex","align-items":"center",width:"100%"},on:{contextmenu:function(l){return l.preventDefault(),l.stopPropagation(),e.showCategoryMenu.apply(null,arguments)}}},[s.ruleKey?n("span",{class:e.$fa(s.checked?"check":"uncheck"),staticStyle:{"padding-right":"3px"},on:{click:function(l){return l.stopPropagation(),l.preventDefault(),e.showHideLayerCategory(o)}}}):e._e(),e._v(" "),e.legendplace==="toc"?n("img",{attrs:{src:s.icon&&"data:image/png;base64,"+s.icon},on:{error:function(l){return e.setError()},load:function(l){return e.urlLoaded()}}}):e._e(),e._v(" "),e.legendplace==="tab"&&s.ruleKey||e.legendplace==="toc"?n("span",{staticClass:"g3w-long-text",staticStyle:{"padding-left":"3px"},on:{click:function(l){return l.stopPropagation(),e.onCategoryClick.apply(null,arguments)}}},[n("span",[e._v(e._s(s.title))]),e._v(" "),e.showfeaturecount&&s.ruleKey!==void 0?n("span",{staticStyle:{"font-weight":"bold"}},[e._v(`
          [`+e._s(e.layer.featurecount[s.ruleKey])+`]
        `)]):e._e()]):e._e()])})],2)],1):e._e()},Jse=[],ere=function(e){e&&e("data-v-60e0d2fb_0",{source:".layer-legend[data-v-60e0d2fb]{padding-left:36px}",map:void 0,media:void 0})},tre="data-v-60e0d2fb",nre=void 0,ire=!1;rre=sre({render:Kse,staticRenderFns:Jse},ere,Qse,tre,ire,nre,!1,Zw,void 0,void 0),AO=rre});function M_(e){e.nodes.forEach(t=>{t.id===void 0?M_({nodes:t.nodes,visible:e.visible&&t.checked}):t.parentGroup.checked&&t.checked&&De(t.id).setVisible(e.visible)})}function fre(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="CatalogTristateTree.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var ore,are,lre,cre,ure,dre,hre,pre,PO,FO=R(()=>{_o();Ke();ze();Xw();OO();Xt();ore={name:"catalog-tristate-tree",props:["layerstree","storeid","legend","legendplace","parent_mutually_exclusive","parentFolder","externallayers","root","parent"],components:{CatalogLayerLegend:AO},mixins:[R_],data(){return{expanded:this.layerstree.expanded,isGroupChecked:!0,controltoggled:!1,n_childs:null,filtered:!1,logged:F.user.id!==void 0}},computed:{showfeaturecount(){return this.layerstree.featurecount!==void 0},showLegendLayer(){return!this.layerstree.exclude_from_legend},showLayerTocLegend(){return!this.isGroup&&this.showLegendLayer&&this.layerstree.geolayer},isGroup(){return!!this.layerstree.nodes},legendlayerposition(){return this.showLegendLayer&&this.layerstree.legend?this.legendplace:"tab"},showscalevisibilityclass(){return!this.isGroup&&this.layerstree.scalebasedvisibility},showScaleVisibilityToolip(){return this.showscalevisibilityclass&&this.layerstree.disabled&&this.layerstree.checked},isTable(){return!this.isGroup&&!this.layerstree.geolayer&&!this.layerstree.external},isHidden(){return this.layerstree.hidden&&this.layerstree.hidden===!0},selected(){this.layerstree.selected=this.layerstree.disabled&&this.layerstree.selected?!1:this.layerstree.selected},isHighLight(){let e=De(this.layerstree.id)||this.layerstree;return!this.isGroup&&F.highlightlayers&&e&&e.isVisible()&&e.getTocHighlightable()},isInGrey(){return!this.isGroup&&!this.isTable&&!this.layerstree.external&&(!this.layerstree.visible||this.layerstree.disabled)},getFeatureCount(){return Object.values(this.layerstree.featurecount).reduce((e,t)=>e+1*t,0)}},watch:{"layerstree.checked"(){this.isGroup?this.handleGroupChecked(this.layerstree):this.handleLayerChecked(this.layerstree)}},methods:{removeCurrentFilter(){return De(this.layerstree.id).deleteFilterToken()},handleGroupChecked(e){if(!e.checked){e.nodes.forEach(o=>{o.id===void 0?M_({nodes:o.nodes,visible:!1}):o.checked&&De(o.id).setVisible(!1)});return}let t=e.parentGroup?e.parentGroup.checked:!0,n=e.parentGroup&&e.parentGroup.mutually_exclusive;n||M_({nodes:e.nodes,visible:t}),n&&e.parentGroup.nodes.forEach(o=>{o.checked=o.groupId===e.groupId,o.checked&&M_({nodes:o.nodes,visible:t})});let s=e.parentGroup;for(;s;)s.checked=s.root||s.checked,s=s.parentGroup},handleLayerChecked(e){let t=T.getService("map");if(!e.projectLayer){e.visible=e.checked,e.setVisible(e.checked),t.emit("change-layer-visibility",{id:e.id,visible:e.checked});return}let n=De(e.id),s=e.checked;n.setVisible(s?!e.disabled:!1),s&&e.parentGroup.mutually_exclusive&&e.parentGroup.nodes.forEach(l=>l.checked=l.id===e.id);let o=e.parentGroup;for(;s&&o;)o.checked=!0,o=o.parentGroup;$t.$emit("treenodevisible",n)},saveFilter(e){De(e.id).saveFilter()},toggleFilterLayer(){$t.$emit("activefiltertokenlayer",this.storeid,this.layerstree)},clearSelection(){$t.$emit("unselectionlayer",this.storeid,this.layerstree)},toggle(){this.layerstree.checked=!this.layerstree.checked},expandCollapse(){this.layerstree.expanded=!this.layerstree.expanded},select(){this.layerstree.selected!==void 0&&(!this.isGroup&&!this.isTable||this.layerstree.external&&this.layerstree.projectLayer===!1)&&$t.$emit("treenodeselected",this.layerstree)},maybeZoomToLayer(e){this.canZoom(this.layerstree)&&T.getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg)},canZoom(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(t=>t>0)},onTreeItemClick(){this.handleClick({1:()=>!this.isTable&&!this.isGroup&&this.select(),2:()=>!this.isTable&&this.maybeZoomToLayer(this.layerstree)},this)},triClass(){return this.g3wtemplate.getFontClass(this.layerstree.checked?"check":"uncheck")},removeExternalLayer(e){T.getService("map").removeExternalLayer(e)},showContextMenu(e){$t.$emit("context-menu",e,this.layerstree)}},created(){this.isGroup&&!this.layerstree.checked&&this.handleGroupChecked(this.layerstree),this.isGroup&&!this.root&&this.parent_mutually_exclusive&&!this.layerstree.mutually_exclusive&&this.layerstree.nodes.forEach(e=>{e.id&&(e.uncheckable=!0)})}},are=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isGroup||!e.layerstree.projectLayer||e.layerstree.toc?n("li",{staticClass:"tree-item",class:{selected:!e.isGroup||!e.isTable?e.layerstree.selected:!1,itemmarginbottom:!e.isGroup,disabled:e.isInGrey,group:e.isGroup},style:{marginLeft:e.isGroup?"0":"5px",position:"relative"},on:{contextmenu:function(s){return s.preventDefault(),s.stopPropagation(),e.showContextMenu.apply(null,arguments)},click:function(s){return s.stopPropagation(),e.onTreeItemClick.apply(null,arguments)}}},[e.isGroup?n("span",{staticClass:"root collapse-expande-collapse-icon",class:[{bold:e.isGroup},e.g3wtemplate.getFontClass(e.layerstree.expanded?"caret-down":"caret-right")],staticStyle:{"padding-right":"2px"},on:{click:function(s){return s.stopPropagation(),e.expandCollapse.apply(null,arguments)}}}):e._e(),e._v(" "),e.isGroup?n("span",{class:[e.triClass()],staticStyle:{color:"#ffffff"},on:{click:function(s){return s.stopPropagation(),e.toggle()}}}):e.isTable?n("span",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden,expression:"!layerstree.hidden"}],class:[e.parentFolder?"child":"root",e.g3wtemplate.getFontClass("table")],staticStyle:{"padding-left":"18px"}}):[e.layerstree.external&&e.layerstree.removable?n("span",{class:e.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red","padding-left":"1px"},on:{click:function(s){return s.stopPropagation(),e.removeExternalLayer(e.layerstree.name,e.layerstree._type)}}}):e._e(),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden,expression:"!layerstree.hidden"}],staticClass:"checkbox-layer",class:e.parentFolder?"child":"root"},[e.legendlayerposition==="toc"||!e.isGroup&&e.layerstree.categories?n("span",{staticClass:"collapse-expande-collapse-icon",class:e.g3wtemplate.getFontClass(e.layerstree.visible&&e.layerstree.expanded?"caret-down":"caret-right"),on:{click:function(s){return s.target!==s.currentTarget?null:(s.stopPropagation(),e.expandCollapse.apply(null,arguments))}}}):e._e(),e._v(" "),n("span",{class:[e.g3wtemplate.getFontClass(e.layerstree.checked?"check":"uncheck"),{"toc-added-external-layer":!e.layerstree.legend&&e.layerstree.external}],style:{paddingLeft:e.legendlayerposition==="toc"||!e.isGroup&&e.layerstree.categories?"5px":!e.layerstree.legend&&e.layerstree.external?"1px":"18px"},on:{click:function(s){return s.stopPropagation(),e.toggle()}}})])],e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden||e.isGroup,expression:"!layerstree.hidden || isGroup"}],staticClass:"tree-node-title",class:{disabled:!e.layerstree.external&&(e.layerstree.disabled||e.layerstree.id&&!e.layerstree.visible),bold:e.isGroup}},[n("span",{staticClass:"g3w-long-text",class:{highlightlayer:e.isHighLight,scalevisibility:e.showscalevisibilityclass},attrs:{"data-i18n-title":e.showScaleVisibilityToolip?"minscale:"+e.layerstree.minscale+" - maxscale:"+e.layerstree.maxscale:"","data-placement":"top","data-i18n-raw":""}},[!e.isGroup&&!e.layerstree.external&&e.layerstree.filter.current!==null?n("span",{staticStyle:{cursor:"pointer"},attrs:{"data-i18n-title":e.layerstree.filter.current.name,"data-placement":"top","data-i18n-raw":""},on:{click:function(s){return s.stopPropagation(),e.removeCurrentFilter.apply(null,arguments)}}},[n("span",{class:e.g3wtemplate.getFontClass("filter"),staticStyle:{color:"red"}})]):e._e(),e._v(" "),n("span",[e._v(e._s(e.layerstree.title))]),e._v(" "),!e.isGroup&&e.showfeaturecount?n("span",{staticStyle:{"font-weight":"bold"}},[e._v(`
        [`+e._s(e.getFeatureCount)+`]
      `)]):e._e()]),e._v(" "),!e.isGroup&&e.layerstree.selection?n("div",[e.layerstree.selection.active?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Invert Selection",expression:"'Invert Selection'"}],staticClass:"action-button selection-filter-icon",class:e.g3wtemplate.getFontClass("clear"),attrs:{"data-placement":"left"},on:{click:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"caputure",void 0,s.key,void 0)?null:(s.preventDefault(),s.stopPropagation(),e.clearSelection.apply(null,arguments))}}}):e._e(),e._v(" "),!e.layerstree.external&&(e.layerstree.selection.active||e.layerstree.filter.active)&&!e.layerstree.filter.pagination?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Enable/Disable filter",expression:"'Enable/Disable filter'"}],staticClass:"action-button selection-filter-icon",class:[e.g3wtemplate.getFontClass("filter"),e.layerstree.filter.active?"active":""],attrs:{"data-placement":"left"},on:{click:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"caputure",void 0,s.key,void 0)?null:(s.preventDefault(),s.stopPropagation(),e.toggleFilterLayer.apply(null,arguments))}}}):e._e(),e._v(" "),e.logged&&!e.layerstree.external&&e.layerstree.selection.active&&e.layerstree.filter.active?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Save Filter",expression:"'Save Filter'"}],staticClass:"action-button selection-filter-icon",class:e.g3wtemplate.getFontClass("save"),attrs:{"data-placement":"left"},on:{click:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"caputure",void 0,s.key,void 0)?null:(s.preventDefault(),s.stopPropagation(),e.saveFilter(e.layerstree))}}}):e._e()]):e._e()]),e._v(" "),e.showLayerTocLegend?n("catalog-layer-legend",{attrs:{legendplace:e.legendplace,layer:e.layerstree}}):e._e(),e._v(" "),e.isGroup?n("ul",{directives:[{name:"show",rawName:"v-show",value:e.layerstree.expanded,expression:"layerstree.expanded"}],staticClass:"tree-content-items group",class:["g3w-lendplace-"+e.legendplace]},e._l(e.layerstree.nodes,function(s){return n("span",{key:s.id||s.groupId},[n("catalog-tristate-tree",{attrs:{root:!1,legendConfig:e.legend,legendplace:e.legendplace,parentFolder:e.isGroup,layerstree:s,storeid:e.storeid,parent:e.layerstree,parent_mutually_exclusive:!!e.layerstree.mutually_exclusive}})],1)}),0):e._e(),e._v(" "),e.isGroup?e._e():n("a",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Open menu",expression:"'Open menu'",arg:"left"}],class:"toggle-context-menu "+e.$fa("ellips-v"),attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.showContextMenu.apply(null,arguments)}}})],2):e._e()},lre=[],cre=void 0,ure=void 0,dre=void 0,hre=!1;pre=fre({render:are,staticRenderFns:lre},cre,ore,ure,hre,dre,!1,void 0,void 0,void 0),PO=pre});var DO={};qn(DO,{default:()=>Ere});function Qh(e,t){return t||t===0?`${e}${t}`:null}function wre(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Catalog.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Qw(){let e=Qw.styles||(Qw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var gre,mre,_re,yre,vre,bre,xre,Sre,Ere,GO=R(()=>{_o();Ke();ze();ii();Xt();MO();FO();gre={name:"catalog",data(){return{state:this.$options.service.state||{},legend_position:F.project.state.legend_position||"tab",iframe:F.iframe,showlegend:!1,backgroundLegend:F.gui.layout.app.legend&&F.gui.layout.app.legend.transparent?"transparent":"#FFFFFF",currentBaseLayer:null,activeTab:F.project.state.catalog_tab||"layers",loading:!1}},components:{CatalogChangeMapThemes:RO,CatalogTristateTree:PO},computed:{project(){return F.project},title(){return this.project.state.name},baselayers(){return this.project.state.baselayers},hasBaseLayers(){return this.project.state.baselayers.length>0},hasLayers(){return this.state.external.vector.length>0||this.state.layerstrees.reduce((e,t)=>t.tree.length+e,0)>0||this.state.layersgroups.length>0},hasRelatedMaps(){return window.initConfig.macrogroups.length+window.initConfig.groups.length+window.initConfig.projects.length>1}},methods:{onLegendError(e){e.error=!0,e.loading=!1},onLegendLoad(e){e.loading=!1},getLegendSrc(e=!1){this.legend_position==="tab"&&this.state.layerstrees.forEach(t=>{let n=this._traverseVisibleLayers(t.tree);this.showlegend=this.showlegend||n.length>0,t.tree.forEach(async s=>{try{e&&(s.legendurls&&s.legendurls.length===0||n.some(o=>o.legend.change)||F.project.state.context_base_legend)&&n.filter(o=>o.legend.change).forEach(o=>o.legend.change=!1),s.legendurls=await this._getLegendSrc(n)}catch(o){console.warn(o)}})})},_traverseVisibleLayers(e,t=[]){for(let n of e)n.id!==null&&n.id!==void 0&&n.visible&&n.geolayer&&!n.exclude_from_legend&&t.push(n),n.nodes!==null&&n.nodes!==void 0&&this._traverseVisibleLayers(n.nodes,t);return t},async _getLegendSrc(e){let t=[],n=e.filter(o=>o.geolayer),s={GET:{},POST:{}};n.forEach(o=>{let l=s[o.source&&o.source.url||o.external?"GET":o.ows_method],a=De(o.id),u=a?a.getLegendUrl((window.initConfig.layout||{}).legend,{all:!F.project.state.context_base_legend,format:"image/png",categories:o.categories}):void 0;if(a===void 0)return;if(o.source&&o.source.url){l[u]=[];return}let h=u.split("LAYER=")[0].split("LEGEND_ON=")[0].split("LEGEND_OFF=")[0];l[h]||(l[h]=[]),l[h].unshift({layerName:u.split("LAYER=")[1],style:(Array.isArray(o.styles)&&o.styles.find(p=>p.current)||{name:!1}).name,legend_on:(u.split("LAYER=")[0].split("LEGEND_ON=")[1]||"").replace("&",""),legend_off:(u.split("LAYER=")[0].split("LEGEND_ON=")[0].split("LEGEND_OFF=")[1]||"").replace("&","")})});for(let o in s)for(let l in s[o]){let a={loading:!0,url:null,error:!1};t.push(a);let u={LAYERS:[],STYLES:[],LEGEND_ON:[],LEGEND_OFF:[]};(s[o][l]||[]).reduce((p,d)=>(u.LAYERS.push(d.layerName),u.STYLES.push(d.style),d.legend_on&&u.LEGEND_ON.push(d.legend_on),d.legend_off&&u.LEGEND_OFF.push(d.legend_off),u),u);let h=[Qh("LAYERS=",u.LAYERS.join(",")),Qh("STYLES=",u.STYLES.join(",")),Qh("LEGEND_ON=",u.LEGEND_ON.join(",")),Qh("LEGEND_OFF=",u.LEGEND_OFF.join(",")),Qh("filtertoken=",F.tokens.filtertoken)].filter(p=>p).join("&");try{a.url=o==="GET"?l+(s[o][l].length?h:""):URL.createObjectURL(await(await fetch(l.split("?")[0],{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:l.split("?")[1].split("&").filter(p=>p.split("=")[0]).map(p=>`${p.split("=")[0]}=${encodeURIComponent(p.split("=")[1])}`).join("&")+"&"+h})).blob())}catch(p){console.warn(p)}finally{a.loading=!1}}return t},async getMapThemeFromThemeName(e){let t=F.project,n=Object.values(t.state.map_themes).flat().find(s=>e===s.theme);if(n&&n.layerstree===void 0)try{let s=await Ye.get({url:`${t.urls.map_themes}${e}/`});s.result&&(n.layerstree=s.data)}catch(s){console.warn("Error while retreiving map theme configuration",s)}return n},async setLayersTreePropertiesFromMapTheme({map_theme:e,layerstree:t}){let n=F.project;t=t!==void 0?t:n.state.layerstree;let s=await this.getMapThemeFromThemeName(e),o={layers:{}},l=[],a=[],u=(h,p,d)=>{h.forEach((_,m)=>{if(_.nodes)a.push({node:_,group:p[m]}),u(_.nodes,p[m].nodes,d&&_.checked);else if(_.style=s.styles[_.id],p[m].checked!==_.visible&&(o.layers[_.id]={visibility:!0,style:!1}),p[m].checked=_.visible,_.style){let v=new Promise(x=>{let b=w=>{o.layers[w.id]===void 0&&(o.layers[w.id]={visibility:!1,style:!1}),o.layers[w.id].style=n.getLayerById(w.id).setCurrentStyle(w.style),x()};n.getLayersStore()?b(_):(w=>setTimeout(()=>b(w)))(_)});l.push(v)}})};return u(s.layerstree,t),await Promise.allSettled(l),a.forEach(({group:h,node:{checked:p,expanded:d}})=>{h.checked=p,h.expanded=d}),o},async changeMapTheme(e){T.closeContent(),this.state.layerstrees[0].checked=!0;let t=(await this.setLayersTreePropertiesFromMapTheme({map_theme:e,rootNode:this.state.layerstrees[0],layerstree:this.state.layerstrees[0].tree[0].nodes})).layers,n=Object.keys(t).filter(o=>t[o].style),s=(await this.getMapThemeFromThemeName(e)).styles;n.forEach(o=>{if(!t[o].visible){let l=De(o);l.clearCategories(),l.change()}}),n.forEach(o=>$t.$emit("layer-change-style",{layerId:o,style:s[o]}))},onTabClick(e){e.target.attributes["aria-controls"]&&(this.activeTab=e.target.attributes["aria-controls"].value)},setBaseLayer(e){this.currentBaseLayer=e,this.project.setBaseLayer(e),F.baseLayerId=e},getSrcBaseLayerImage(e){let t="nobaselayer.png";switch(e&&e.servertype||e){case"OSM":t="osm.png";break;case"Bing":t=`bing${e.source.subtype}.png`;break;case"TMS":t=e.icon?e.icon:t;break;case"WMTS":t=e.icon?e.icon:t;break}return(e||{}).icon?t:`${T.getResourcesUrl()}images/${t}`},onUnSelectionLayer(e,t){if(!t)return console.warn("undefined layer");let n=T.getService("queryresults"),s=t.external&&n.getActionLayerById({layer:t,id:"selection"});!t.external&&e&&F.catalog[e].getLayerById(t.id).clearSelectionFids(),t.external&&(t.selection.active=!1,t.selection.features.forEach((o,l)=>{o.selection.selected&&(o.selection.selected=!1,s&&(s.state.toggled[l]=!1),T.getService("map").setSelectionFeatures("remove",{feature:o}))}))},async onActiveFilterTokenLayer(e,t){t.filter.active=await F.catalog[e].getLayerById(t.id).toggleFilterToken()},onTreeNodeVisible(e){T.getService("map").emit("cataloglayervisible",e)},onTreeNodeSelected(e){T.getService("map").selectLayer(e.id)},showaddLayerModal(){window.innerWidth<767&&T.hideSidebar(),$("#modal-addlayer").modal("show")},openChangeMapMenu(){window.innerWidth<767&&T.hideSidebar(),$("#modal-changemap").modal("show")}},watch:{"state.external.wms"(e,t){t&&e.length===0&&(this.activeTab=this.project.state.catalog_tab||"layers")},project:{async handler(e){let t=e.state.catalog_tab||"layers";this.loading=t==="baselayers",await this.$nextTick(),setTimeout(()=>{this.loading=!1,this.activeTab=t},t==="baselayers"?500:0)},immediate:!1},activeTab(e,t){e==="legend"&&this.getLegendSrc(!0),this.$el&&(this.$el.parentElement.classList.remove(`tab-${t}`),this.$el.parentElement.classList.add(`tab-${e}`))}},created(){$t.$on("unselectionlayer",this.onUnSelectionLayer),$t.$on("activefiltertokenlayer",this.onActiveFilterTokenLayer),$t.$on("treenodevisible",this.onTreeNodeVisible),$t.$on("treenodeselected",this.onTreeNodeSelected),$t.$on("layer-change-style",this.getLegendSrc)},beforeMount(){this.currentBaseLayer=this.project.state.initbaselayer},async mounted(){await this.$nextTick(),F.project.state.context_base_legend?T.getService("map").on("change-map-legend-params",()=>{this.getLegendSrc()}):this.getLegendSrc()}},mre=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabbable-panel catalog"},[n("div",{staticClass:"tabbable-line"},[n("ul",{staticClass:"nav nav-tabs catalalog-nav-tabs",attrs:{role:"tablist"},on:{"!click":function(s){return e.onTabClick.apply(null,arguments)}}},[e.hasLayers?n("li",{class:{active:e.activeTab==="layers"},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"data",expression:"'data'"}],attrs:{href:"#layers","aria-controls":"layers",role:"tab","data-toggle":"tab"}})]):e._e(),e._v(" "),e.state.external.wms.length?n("li",{class:{active:e.activeTab==="externalwms"},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"externalwms",expression:"'externalwms'"}],attrs:{href:"#externalwms","aria-controls":"externalwms",role:"tab","data-toggle":"tab"}})]):e._e(),e._v(" "),e.hasBaseLayers?n("li",{class:{active:e.activeTab==="baselayers"},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"baselayers",expression:"'baselayers'"}],attrs:{href:"#baselayers","aria-controls":"baselayers",role:"tab","data-toggle":"tab"}})]):e._e(),e._v(" "),e.legend_position==="tab"&&e.showlegend?n("li",{class:{active:e.activeTab==="legend"},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"legend",expression:"'legend'"}],attrs:{href:"#legend","aria-controls":"legend",role:"tab","data-toggle":"tab","data-i18n":"legend"}})]):e._e()]),e._v(" "),n("div",{staticClass:"tab-content catalog-tab-content"},[n("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),n("div",{staticClass:"tab-pane",class:{active:e.activeTab==="layers"},attrs:{id:"layers",role:"tabpanel"}},[n("div",{staticStyle:{margin:"2px"},attrs:{id:"g3w-catalog-toc-layers-toolbar"}},[n("catalog-change-map-themes",{key:e.project.state.gid,attrs:{map_themes:e.project.state.map_themes,layerstrees:e.state.layerstrees},on:{"change-map-theme":e.changeMapTheme}})],1),e._v(" "),e._l(e.state.layerstrees,function(s){return n("ul",{key:s.storeid,staticClass:"tree-root root project-root"},e._l(s.tree,function(o){return n("catalog-tristate-tree",{key:o.id,staticClass:"item",attrs:{layerstree:o,parentFolder:!1,root:!0,legendplace:e.legend_position,parent_mutually_exclusive:!1,storeid:s.storeid}})}),1)}),e._v(" "),e.state.external.vector.length?n("ul",{staticClass:"g3w-external_layers-group"},e._l(e.state.external.vector,function(s){return n("catalog-tristate-tree",{key:s.id,staticClass:"item",attrs:{externallayers:e.state.external.vector,layerstree:s}})}),1):e._e(),e._v(" "),e._l(e.state.layersgroups,function(s){return n("ul",{staticClass:"g3w-catalog-layers-group"},[n("div",[n("h4",[e._v(e._s(s.title))]),e._v(" "),e._l(s.nodes,function(o){return n("catalog-tristate-tree",{staticClass:"item",attrs:{layerstree:o}})})],2)])})],2),e._v(" "),e.state.external.wms.length?n("div",{staticClass:"tab-pane",class:{active:e.activeTab==="externalwms"},attrs:{id:"externalwms",role:"tabpanel"}},[n("ul",{staticClass:"g3w-external_wms_layers-group"},e._l(e.state.external.wms,function(s){return n("catalog-tristate-tree",{key:s.id,staticClass:"item",attrs:{externallayers:e.state.external.wms,layerstree:s}})}),1)]):e._e(),e._v(" "),e.hasBaseLayers?n("div",{staticClass:"tab-pane baselayers",class:{active:e.activeTab==="baselayers"||!e.hasLayers},attrs:{id:"baselayers",role:"tabpanel"}},[n("ul",{class:{mobile:e.isMobile()},style:{gridTemplateColumns:"repeat(auto-fill, minmax("+(e.baselayers.length>4?80:120)+"px, 1fr))"},attrs:{id:"baselayers-content"}},[e._l(e.baselayers,function(s){return s.fixed?e._e():n("li",{key:s.title},[n("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:e.currentBaseLayer===s.id?1:.5,height:e.baselayers.length>4?"108px":null},attrs:{src:e.getSrcBaseLayerImage(s)},on:{click:function(o){return o.stopPropagation(),e.setBaseLayer(s.id)}}}),e._v(" "),n("div",{staticClass:"baseselayer-text text-center g3w-long-text"},[e._v(e._s(s.title))])])}),e._v(" "),n("li",{on:{click:function(s){return s.stopPropagation(),e.setBaseLayer(null)}}},[n("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:e.currentBaseLayer===null?1:.5},attrs:{src:e.getSrcBaseLayerImage(null)}}),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"nobaselayer",expression:"'nobaselayer'"}],staticClass:"baseselayer-text text-center g3w-long-text"})])],2)]):e._e(),e._v(" "),e._l(e.state.layerstrees,function(s){return e.legend_position==="tab"&&e.activeTab==="legend"?n("div",{key:s.id,staticClass:"tab-pane",class:{active:e.activeTab==="legend"},style:{backgroundColor:e.backgroundLegend},attrs:{role:"tabpanel",id:"legend"}},e._l(s.tree,function(o){return n("div",{staticClass:"legend-item"},e._l(o.legendurls,function(l){return n("figure",{key:l.url},[n("bar-loader",{attrs:{loading:l.loading}}),e._v(" "),n("img",{directives:[{name:"show",rawName:"v-show",value:!l.loading&&!l.error,expression:"!url.loading && !url.error"}],attrs:{src:l.url,alt:""},on:{error:function(a){return e.onLegendError(l)},load:function(a){return e.onLegendLoad(l)}}}),e._v(" "),n("divider")],1)}),0)}),0):e._e()})],2)]),e._v(" "),e.hasRelatedMaps||e.activeTab!=="legend"?n("div",{staticStyle:{position:"sticky",bottom:"0","background-color":"var(--bgcolor)",display:"flex","text-align":"center","line-height":"48px",color:"#fff","border-top":"2px solid var(--skin-color)","margin-top":"12px","justify-content":"space-around"}},[e.activeTab!=="legend"?n("a",{attrs:{href:"#"},on:{click:function(s){return s.stopPropagation(),e.showaddLayerModal.apply(null,arguments)}}},[n("i",{class:e.$fa("layers")}),e._v(" "),n("b",{directives:[{name:"t",rawName:"v-t",value:"Add Layer",expression:"'Add Layer'"}]})]):e._e(),e._v(" "),e.hasRelatedMaps&&e.activeTab!=="legend"&&!e.iframe?n("a",{attrs:{href:"#"},on:{click:function(s){return s.stopPropagation(),e.openChangeMapMenu.apply(null,arguments)}}},[n("i",{class:e.$fa("refresh")}),e._v(" "),n("b",{directives:[{name:"t",rawName:"v-t",value:"changemap",expression:"'changemap'"}]})]):e._e()]):e._e()])},_re=[],yre=function(e){e&&(e("data-v-1a3d2f55_0",{source:".tabbable-line>.nav-tabs>li.active{border-bottom:4px solid var(--skin-color)}.catalog #legend div.selected,.catalog .tree-item.selected{background-color:var(--skin-color)}.catalog-context-menu li.title{border-bottom-color:var(--skin-color)!important}.skin-blue .tabbable-line>.nav-tabs>li:is(.open,:hover){border-bottom:4px solid #6abbea}.skin-blue .tabbable-line.tabs-below>.nav-tabs>li:hover{border-top:4px solid #6abbea}.skin-blue .tabbable-line.tabs-below>.nav-tabs>li.active{border-top:4px solid #f3565d}.skin-green .tabbable-line>.nav-tabs>li:is(.open,:hover){border-bottom:4px solid #00ff8e}.skin-green .tabbable-line.tabs-below>.nav-tabs>li:hover{border-top:4px solid #00ff8e}.skin-green .tabbable-line.tabs-below>.nav-tabs>li.active{border-top:4px solid #f3565d}.skin-purple .tabbable-line>.nav-tabs>li:is(.open,:hover){border-bottom:4px solid #a19dff}.skin-purple .tabbable-line.tabs-below>.nav-tabs>li:hover{border-top:4px solid #a19dff}.skin-purple .tabbable-line.tabs-below>.nav-tabs>li.active{border-top:4px solid #f3565d}.skin-red .tabbable-line>.nav-tabs>li:is(.open,:hover){border-bottom:4px solid #ff5542}.skin-red .tabbable-line.tabs-below>.nav-tabs>li:hover{border-top:4px solid #ff5542}.skin-red .tabbable-line.tabs-below>.nav-tabs>li.active{border-top:4px solid #ff5542}.skin-yellow .tabbable-line>.nav-tabs>li:is(.open,:hover){border-bottom:4px solid #ffde0d}.skin-yellow .tabbable-line.tabs-below>.nav-tabs>li:hover{border-top:4px solid #ffde0d}.skin-yellow .tabbable-line.tabs-below>.nav-tabs>li.active{border-top:4px solid #ffdf12}.tabbable-panel{padding:10px}.tabbable-line>.nav-tabs{border:none;margin:0}.tabbable-line .nav-tabs ul li{color:#fff}.tabbable-line>.nav-tabs>li{margin-right:2px;border-bottom:4px solid hsl(from var(--bgcolor) h s calc(l - 2))}.tabbable-line>.nav-tabs>li>a{border:0;margin-right:0;color:#fff}.tabbable-line>.nav-tabs>li>a>i{color:#a6a6a6}.tabbable-line>.nav-tabs>li:is(.open,:hover)>a{border:0;background:0 0!important}.tabbable-line>.nav-tabs>li:is(.open,:hover)>a>i{color:#a6a6a6}.tabbable-line>.nav-tabs>li:is(.open,:hover) .dropdown-menu{margin-top:0}.tabbable-line>.nav-tabs>li.active{position:relative;font-weight:700}.tabbable-line>.nav-tabs>li.active>a{border:0;color:#fff;background-color:hsl(from var(--bgcolor) h s calc(l + 4))}.tabbable-line>.nav-tabs>li.active>a>i{color:#fff}.tabbable-line>.tab-content.catalog-tab-content{margin-top:-3px;border:0;color:#fff;padding:5px 0 0 0}.portlet .tabbable-line>.tab-content{padding-bottom:0}.tabbable-line.tabs-below>.nav-tabs>li{border-top:4px solid transparent}.tabbable-line.tabs-below>.nav-tabs>li>a{margin-top:0}.tabbable-line.tabs-below>.nav-tabs>li:hover{border-bottom:0;color:#fff}.tabbable-line.tabs-below>.nav-tabs>li.active{margin-bottom:-2px;border-bottom:0}.tabbable-line.tabs-below>.tab-content{margin-top:-10px;border-top:0;border-bottom:1px solid #eee;padding-bottom:15px}.nav-tabs>li.active>a,.nav-tabs>li.active>a:is(:focus,:hover){color:#fff}.catalog>.title{padding:10px;font-weight:700}.catalog ul{line-height:1.75em;list-style-type:none}.catalog #legend div.selected ul.layer-categories,.catalog .tree-item.selected ul.layer-categories{background-color:var(--bgcolor)}.catalog #legend div div.tree-node-title,.catalog .tree-item div.tree-node-title{padding-left:3px;cursor:pointer;width:80%;display:inline-flex;justify-content:space-between;user-select:none}.catalog #legend div div.tree-node-title.disabled,.catalog .tree-item div.tree-node-title.disabled{color:#999}.catalog #legend div div.tree-node-title .selection-filter-icon,.catalog .tree-item div.tree-node-title .selection-filter-icon{box-shadow:rgba(0,0,0,.3) 0 2px 5px;padding:5px;border-radius:3px;margin:0 3px;font-weight:700;color:#fff!important}.catalog #legend div div.tree-node-title .selection-filter-icon.active,.catalog .tree-item div.tree-node-title .selection-filter-icon.active{box-shadow:none;background-color:#384247}.catalog .tree-item{cursor:pointer;margin-bottom:3px}.catalog .tree-item.disabled>span{color:#999}.catalog .root{padding:2px 1px 1px 5px}.catalog .root .tree-item.group{padding-left:1px}.catalog .root.fa-chevron-right{padding-right:5px;padding-left:0}.catalog .root-categories.fa-chevron-right{padding-right:7px}.catalog .root-categories.fa-chevron-down{padding-right:3px}.bold{font-weight:700;color:#fff}.highlightlayer{border-bottom:2px dashed;border-color:#ffb516}.catalog{padding:3px}.catalog .tree-root{padding-left:0}.catalog .tree-root li>.root{padding-left:5px}.catalog .tree-root li.tree-item ul.tree-content-items.root{padding-left:18px}.catalog .tree-root li.tree-item ul.tree-content-items.root>.tree-item.group{padding-left:1px!important}.catalog .tree-root li.tree-item ul.tree-content-items{padding-left:17px;padding-top:2px}.g3w-lendplace-toc{padding-left:23px}.g3w-lendplace-toc.group{padding-left:17px}.g3w-lendplace-toc.root{padding-left:18px}.g3w-lendplace-toc.root>li.itemmarginbottom{margin-left:-13px}.g3w-lendplace-toc.root>li.itemmarginbottom div.layer-legend{padding-left:56px}.g3w-lendplace-toc.root>li.itemmarginbottom>span.child{padding-left:18px!important}.catalog .tree-root span.root.collapse-expande-collapse-icon{width:19px}.catalog .tree-root span.root.collapse-expande-collapse-icon.project-root{width:17px}.catalog .tree-root span.collapse-expande-collapse-icon{width:10px}.catalog span.legend-collapse-expande-collapse-icon{font-size:1.2em}.catalog .child-categories{padding:5px 3px 1px 12px}.catalog .layer-legend{padding:3px 0 0 35px;background-color:var(--bgcolor)}.catalog .catalalog-nav-tabs{display:flex;flex:1 1 0}.catalog .catalalog-nav-tabs>li{font-size:1em;white-space:initial;display:flex;flex:1 1 0;align-items:stretch}.catalog .catalalog-nav-tabs>li a{padding:10px 0;text-align:center;height:100%;width:100%}.catalog .tree{color:#fff}.catalog .tree.disabled{color:#999;cursor:not-allowed}.catalog .g3w-external_wms_layers-group{padding:5px}.catalog .baselayers .radio{margin:0}#baselayers-content{display:grid;justify-content:center;grid-gap:5px;padding:0;margin:5px}#baselayers-content.mobile{grid-template-columns:repeat(auto-fill,minmax(80px,110px))}#baselayers-content .baseselayer-text{white-space:pre-line;font-weight:700}#baselayers-content .baselayer{cursor:pointer}#baselayers-content .baselayer .baselayer-name{font-weight:700;white-space:pre-line;text-align:center}#catalog #layers ul.g3w-external_layers-group{padding-left:0!important}#catalog #layers ul.g3w-external_layers-group li{padding-left:2px!important}#catalog #layers .sidebar-menu>li>a{border:0}#catalog>a{display:none!important}#catalog .tree-item>.toggle-context-menu{opacity:0;position:absolute;inset:0 4px auto auto;color:#fff;padding:4px 8px;border:1px solid;border-radius:3px}#catalog .tree-item:not(.group):hover>.toggle-context-menu{opacity:1}",map:void 0,media:void 0}),e("data-v-1a3d2f55_1",{source:"#legend .divider[data-v-1a3d2f55]{display:block;position:relative;padding:0;margin:8px auto;height:0;width:100%;max-height:0;font-size:1px;line-height:0;clear:both;border:none}.legend-item[data-v-1a3d2f55]{width:100%;position:relative}.g3w-catalog-layers-group>div[data-v-1a3d2f55]{border:1px solid #ffffff33;margin:5px}.g3w-catalog-layers-group>div>h4[data-v-1a3d2f55]{margin:5px;font-weight:700}",map:void 0,media:void 0}))},vre="data-v-1a3d2f55",bre=void 0,xre=!1;Sre=wre({render:mre,staticRenderFns:_re},yre,gre,vre,xre,bre,!1,Qw,void 0,void 0),Ere=Sre});function Mre(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Relations.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Kw(){let e=Kw.styles||(Kw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Cre,Ire,Lre,Nre,Tre,kre,Rre,Are,jO,qO=R(()=>{Cre={name:"relations",props:["relations","feature","loading"],methods:{async showRelation(e){await this.$parent.showRelation(e)},featureInfo(){return Object.entries(this.feature.attributes).filter(([e,t])=>t&&typeof t=="string"&&!t.includes("/")).map(([e,t])=>({key:e,value:t})).slice(0,3)}},async mounted(){this.relations.length===1&&(this.relations[0].noback=!0,await this.showRelation(this.relations[0]))},beforeDestroy(){this.relations.length===1&&delete this.relations[0].noback}},Ire=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"query-relations"},[n("div",{staticClass:"header skin-background-color lighten"},[n("div",{staticClass:"skin-color-dark"},[n("span",{directives:[{name:"t",rawName:"v-t:pre",value:"List of relations of feature",expression:"'List of relations of feature'",arg:"pre"}],staticStyle:{"font-size":"1.1em"}}),e._v(" "),e._l(e.featureInfo(),function(s){return n("div",[e._v(" - "),n("b",[e._v(e._s(s.key))]),e._v(": "+e._s(s.value))])})],2)]),e._v(" "),n("div",{staticClass:"query-relations-content"},e._l(e.relations,function(s){return n("div",{staticClass:"skin-border-color relation-grid-item",on:{click:function(o){return o.stopPropagation(),e.showRelation(s)}}},[n("span",{staticClass:"skin-color g3w-long-text"},[e._v(e._s(s.name))])])}),0)])},Lre=[],Nre=function(e){e&&e("data-v-41af3bb8_0",{source:".relation-grid-item[data-v-41af3bb8]{min-width:0;min-height:80px;border:2px solid;cursor:pointer;border-radius:4px;background-color:#fff;display:flex;align-items:center}.relation-grid-item[data-v-41af3bb8]:hover{background-color:transparent}.query-relations[data-v-41af3bb8]{overflow-y:auto}.query-relations>.header[data-v-41af3bb8]{margin-bottom:10px;border-radius:4px;padding:5px}.query-relations>.query-relations-content[data-v-41af3bb8]{display:grid;grid-template-columns:repeat(2,auto);grid-column-gap:5px;grid-row-gap:5px}.relation-grid-item>.g3w-long-text[data-v-41af3bb8]{font-weight:700;padding:5px}",map:void 0,media:void 0})},Tre="data-v-41af3bb8",kre=void 0,Rre=!1;Are=Mre({render:Ire,staticRenderFns:Lre},Nre,Cre,Tre,Rre,kre,!1,Kw,void 0,void 0),jO=Are});var $O={};qn($O,{default:()=>eS});function $re(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Relation.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Jw(){let e=Jw.styles||(Jw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Ore,Pre,Fre,Dre,Gre,jre,qre,Bre,eS,tS=R(()=>{ft();Ke();Ws();d1();fw();ze();_o();ei();dr();Us();Xt();b1();lc();ga();Ore={name:"relation",props:{feature:{default:null},relation:{},previousview:{},cardinality:{},layer:{},showrelationslist:{default:!1},chartRelationIds:{default:[]}},components:{Field:Vm,downloadformats:Wh},data(){let e=De(this.nmRelation?this.nmRelation.referencedLayer:this.relation.referencingLayer);return{ApplicationState:F,chart:{toggled:!1,button:!!this.chartRelationIds.find(t=>t===this.relation.referencingLayer)},download:{formats:e.getDownloadableFormats().filter(t=>t!=="pdf"),layer:null,toggled:!1,config:{downloads:[]}},isEditable:e.isEditable()&&!e.isInEditing(),table:{title:e.getName()||e.getTitle(),formStructure:e.getLayerEditingFormStructure(),features:[],columns:e.getTableHeaders(),rows:[],rows_fid:[]},nmRelation:F.project.getRelationById(this.relation.nmRelationId),norelations:!1}},computed:{showTools(){let e=(this.table.features||[]).some(t=>t.geometry);return[!!this.isEditable,!!this.table.formStructure,!!e].filter(Boolean).length}},watch:{async norelations(){await this.$nextTick(),this.resize()}},methods:{zoomToGeometry(e){e&&T.getService("map").zoomToGeometry(new ol.geom[e.type](e.coordinates),{highlight:!0})},async getData(e={}){try{T.setLoadingContent(!0),T.disableContent(!0);let t=await(await fetch(Ph({layer:this.layer,fid:this.feature.attributes[jt],relation:this.relation}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:(e.start?e.start/e.length:0)+1,page_size:e.length,formatter:1,ordering:e.order.length?`${e.order[0].dir==="desc"?"-":""}${this.table.columns[e.order[0].column-+!!this.showTools].name}`:void 0,field:(this.table.columns||[]).filter(s=>![null,void 0,""].includes(s.search)).map(s=>`${s.name}|ilike|${s.search}`).join("|AND,")||void 0})})).json(),n=(t?.vector?.data?.features||[]).map(s=>({id:s.id,geometry:s.geometry,attributes:Object.assign(s.properties,{[jt]:s.id})}));return this.nmRelation&&n.length&&(n=(await gt.getData("search:features",{inputs:{layer:De(this.nmRelation.referencedLayer),filter:n.map(s=>`${this.nmRelation.fieldRef.referencedField}|eq|${encodeURIComponent(s.attributes[this.nmRelation.fieldRef.referencingField])}`).join("|OR,"),formatter:1},outputs:null})?.data?.[0]?.features||[]).map(s=>({id:s.getId(),geometry:s.getGeometry(),attributes:pr(s.getProperties()).reduce((o,l)=>Object.assign(o,{[l]:s.get(l)}),{})}))),this.table.features=n,this.table.rows=n.map(s=>[null].concat(this.table.columns.filter(o=>o).map(o=>(o.value=(s.attributes||s.properties)[o.name],o.value)))),this.table.rows_fid=n.map(s=>s.attributes[jt]),{data:this.table.rows,recordsFiltered:t?.vector?.count??0,recordsTotal:t?.vector?.count??0,filter:n.map(s=>s.id)}}catch(t){return console.warn(t),{data:[],recordsFiltered:0,recordsTotal:0}}finally{this.table.get_data||(this.norelations=this.table.rows.length===0,this.table.get_data=!0),T.setLoadingContent(!1),T.disableContent(!1)}},async resize(){if(!this.$refs.relation||this.$refs.relation.parentNode.style.display==="none")return;$(this.$refs.relation).find("div.dataTables_scrollBody").height($(".content").height()-$(".query-relation  div.dataTables_scrollHeadInner").height()-$(".content_breadcrumb").outerHeight()-$(".navbar").outerHeight()-$(".close-panel-block").outerHeight()-$(this.$refs.header).outerHeight()-$(".dataTables_filter").last().outerHeight()-$(".dataTables_paginate.paging_simple_numbers").outerHeight()-$(".dataTables_scrollHead").last().outerHeight()),this.$table&&this.$table.columns.adjust()},async saveRelation(e){F.download=!0;try{let t=await fetch(Ph({layer:this.layer,fid:this.feature.attributes[jt],relation:this.relation,type:e}),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Expose-Headers":"Content-Disposition"},body:JSON.stringify({formatter:1}),signal:AbortSignal.timeout($n)});if(!t?.ok)throw(await t.json()).message;Si(await t.blob(),t.headers.get("content-disposition").split("filename=").at(-1))}catch(t){console.warn(t),T.showUserMessage({type:"alert",message:t||"info.server_error",closable:!0})}F.download=!1,this.download.toggled=!1},async showFormStructure(e,t){T.showContent({content:new pt({internalComponent:new(Vue.extend({data:()=>({layerid:this.table.layerId,feature:this.table.features[t],fields:this.table.columns.map((n,s)=>Object.assign(n,{value:e[s],query:!0,input:{type:`${Ud().getType(n)}`}})),formStructure:this.table.formStructure}),template:`
                <div class="queryresults-wrapper">
                  <div class ="queryresults-container">
                    <table ref="table" class="table">
                      <tbody>
                        <tr class="featurebox-body">
                          <td>
                            <tabs
                              :layerid = "layerid"
                              :feature = "feature"
                              :fields  = "fields"
                              :tabs    = "formStructure"
                            />
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              `,async mounted(){await this.$nextTick(),this.$refs.table.click()}}))}),push:!0,showgoback:!0,closable:!1,title:this.table.title})},editFeature(e){T.getService("queryresults").editFeature({layer:{id:this.nmRelation?this.nmRelation.referencedLayer:this.relation.referencingLayer,attributes:this.table.columns},feature:this.table.features[e]})},back(){this.$parent.setRelationsList()},onChartResize(){let e=n=>{let s=Math.abs(n.x-window.innerWidth)*100/$(this.$refs.wrapper).width();this.$refs.content.style.width=`${100-s}%`,this.$refs.chart.style.width=`${s}%`},t=document.getElementById("g3w-view-content");t.addEventListener("mousemove",e),t.addEventListener("mouseup",async()=>{t.removeEventListener("mousemove",e),await this.$nextTick(),T.emit("resize")},{once:!0})}},created(){this.resize=un(this.resize.bind(this)),T.on("resize",this.resize)},async mounted(){let e=De(this.nmRelation?this.nmRelation.referencedLayer:this.relation.referencingLayer);await this.$nextTick(),this.relation.title=this.relation.name,this.download.formats.length&&(this.download.layer=e.state,this.download.config.downloads=this.download.formats.map(t=>({id:t,format:t,cbk:()=>{this.saveRelation(e.getDownloadUrl(t))},download:!0})),this.download.handler=async()=>{this.download.formats.length==1?this.saveRelation(e.getDownloadUrl(this.download.formats[0])):this.download.toggled=!this.download.toggled,this.resize()}),$t.$on("reload-relations",()=>{this.$table?.columns?.adjust()}),this.chart.handler=En(async()=>{this.chart.toggled=!this.chart.toggled,await this.$nextTick(),this.chart.container=this.chart.container||$("#chart_content"),this.chart.toggled?T.getService("queryresults").showChart([this.relation.referencingLayer],this.chart.container,{relations:[this.relation],fid:this.feature.attributes[jt]}):T.getService("queryresults").hideChart(this.chart.container),this.resize()}),this.relation.type!=="ONE"&&(this.$table=$(this.$refs.table).DataTable({autoWidth:!1,bLengthChange:!0,dom:"ltip",bSortCellsTop:!0,columnDefs:[].concat(this.showTools?{orderable:!1,targets:0,width:"1%"}:{orderable:!0,targets:0}),order:[],lengthMenu:Bs,pageLength:e.getAttributeTablePageLength()||Bs[1],responsive:!0,scrollResize:!0,scrollCollapse:!0,scrollX:!0,serverSide:!0,ajax:un(async(t,n)=>{n(await this.getData(t)),await this.$nextTick(),this.norelations?(this.$table.destroy(!0),this.$table=null):this.$table.columns.adjust()})}),this.changeColumn=un((t,n)=>{let s=t.target.value.trim();this.table.columns[n].search=s,this.$table.columns(n).search(s).draw()})),T.on("pop-content",()=>setTimeout(()=>this.resize())),document.getElementById("table_body_attributes").remove(),this.resize()},async beforeDestroy(){this.$table&&(this.$table.destroy(),this.$table=null),this.chart.toggled&&T.getService("queryresults").hideChart(this.chart.container),this.chart.container&&(this.$emit("hide-chart",this.chart.container),this.chart.container=null),this.table.columns.forEach(e=>delete e.search),T.off("pop-content",this.resize),T.off("resize",this.resize)}},Pre=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"relation",staticClass:"query-relation",class:e.isMobile()?"mobile":null},[n("div",{ref:"header",staticClass:"header skin-background-color lighten"},[n("div",{staticClass:"g3w-long-text"},[e.showrelationslist?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right",value:"Back to relations",expression:"'Back to relations'",arg:"right"}],staticClass:"action-button-icon action-button back-button",class:e.$fa("exit"),on:{click:function(s){return s.stopPropagation(),e.back.apply(null,arguments)}}}):e._e(),e._v(" "),n("b",{staticClass:"relation-tile skin-color"},[e._v(" "+e._s(e.relation.name)+" ")])]),e._v(" "),e.table.rows.length?n("div",{staticClass:"relations-table-tools"},[e.download.formats.length?n("span",{directives:[{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.download,expression:"ApplicationState.download"},{name:"t-tooltip",rawName:"v-t-tooltip:left",value:e.download.formats.length>1?"Downloads":"download_types."+this.download.formats[0],expression:"download.formats.length > 1 ? 'Downloads' : `download_types.${this.download.formats[0]}`",arg:"left"}],staticClass:"action-button-icon action-button",class:[e.$fa("download"),{"toggled-white":e.download.toggled}],on:{click:function(s){return s.stopPropagation(),e.download.handler.apply(null,arguments)}}}):e._e(),e._v(" "),e.chart.button?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom",value:"Show Chart",expression:"'Show Chart'",arg:"bottom"}],staticClass:"action-button-icon action-button",class:[e.$fa("chart"),e.chart.toggled?"toggled-white":""],on:{click:function(s){return s.stopPropagation(),e.chart.handler.apply(null,arguments)}}}):e._e()]):e._e()]),e._v(" "),e.norelations?n("div",{staticClass:"dataTables_scrollBody"},[n("span",{directives:[{name:"t",rawName:"v-t",value:"No relations found",expression:"'No relations found'"}]})]):n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.table.get_data,expression:"!table.get_data"}],ref:"wrapper",staticClass:"relation-wrapper"},[n("div",{ref:"content",style:{width:e.chart.toggled?"70%":"100%",marginRight:e.chart.toggled?"8px":"3px",position:"relative"},attrs:{id:"table_content"}},[e.download.toggled?n("downloadformats",{staticClass:"header-component",attrs:{layer:e.download.layer,config:e.download.config}}):e._e(),e._v(" "),n("table",{ref:"table",staticClass:"hover relationtable table table-striped row-border compact nowrap"},[n("thead",[n("tr",{staticStyle:{height:"0! important"}},[e.showTools?n("th",{style:{minWidth:e.showTools*30+"px",padding:"0 !important"}}):e._e(),e._v(" "),e._l(e.table.columns,function(s){return n("th",[e._v(e._s(s.label))])})],2),e._v(" "),n("tr",[e.showTools?n("th"):e._e(),e._v(" "),e._l(e.table.columns,function(s,o){return n("th",[n("input",{staticClass:"form-control column-search",attrs:{type:"text",placeholder:s.name,title:"search by "+s.name},domProps:{value:s.search},on:{keyup:function(l){return e.changeColumn(l,o)}}})])})],2)]),e._v(" "),n("tbody",{attrs:{id:"table_body_attributes",hidden:""}}),e._v(" "),n("tbody",{ref:"table_body"},e._l(e.table.rows,function(s,o){return n("tr",{key:e.table.rows_fid[o]},[e.showTools?n("td",{staticClass:"table-tools"},[e.table.features[o].geometry?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right",value:"Zoom to Geometry",expression:"'Zoom to Geometry'",arg:"right"}],staticClass:"action-button row-form skin-color",class:e.$fa("marker"),on:{click:function(l){return l.stopPropagation(),e.zoomToGeometry(e.table.features[o].geometry)}}}):e._e(),e._v(" "),e.table.formStructure?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right",value:"Form View",expression:"'Form View'",arg:"right"}],staticClass:"action-button row-form skin-color",class:e.$fa("table"),on:{click:function(l){return l.stopPropagation(),e.showFormStructure(s,o)}}}):e._e(),e._v(" "),e.isEditable?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right",value:"Edit",expression:"'Edit'",arg:"right"}],staticClass:"action-button row-form skin-color",class:e.$fa("pencil"),on:{click:function(l){return l.stopPropagation(),e.editFeature(o)}}}):e._e()]):e._e(),e._v(" "),e._l(s.slice(1),function(l){return n("td",[n("field",{attrs:{state:{value:l}}})],1)})],2)}),0)])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.chart.toggled,expression:"chart.toggled"}],staticClass:"skin-border-color lighten",staticStyle:{"border-style":"solid","border-width":"0 1px 0 1px","min-width":"5px","background-color":"#ddd",cursor:"col-resize"},on:{mousedown:function(s){return s.stopPropagation(),e.onChartResize.apply(null,arguments)}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.chart.toggled,expression:"chart.toggled"}],ref:"chart",style:{width:e.chart.toggled?"30%":"0"},attrs:{id:"chart_content"}})])])},Fre=[],Dre=function(e){e&&(e("data-v-513f051c_0",{source:".query-relation[data-v-513f051c]{margin-top:3px}.query-relation>.header[data-v-513f051c]{padding:3px;display:flex;justify-content:space-between;align-items:center;width:100%;margin:0!important}.query-relation>.header>.g3w-long-text[data-v-513f051c]{border-radius:3px;font-size:1.3em}.query-relation.mobile>.header>.g3w-long-text[data-v-513f051c]{font-size:1em}.relations-table-tools[data-v-513f051c]{font-size:1.1em;margin-bottom:3px}.relations-table-tools>.action-button[data-v-513f051c]{padding:5px}.relation-wrapper[data-v-513f051c]{display:flex;justify-content:space-between;margin-bottom:5px;margin-top:3px;height:95%}.back-button[data-v-513f051c]{font-size:.8em}.header-component[data-v-513f051c]{width:100%;display:flex;margin-left:auto;margin-bottom:5px;margin-right:4px}.relationtable .table-tools .action-button[data-v-513f051c]:hover{background-color:transparent}.relationtable.dataTable tbody tr.selected[data-v-513f051c]{background-color:#e4e4e4!important}.relationtable.dataTable tbody tr.selected .row-wrap-tabs .tabs-wrapper[data-v-513f051c]{background-color:#fff!important}#chart_content[data-v-513f051c]{padding-bottom:5px;margin-bottom:5px;margin-left:8px}.dataTables_scrollBody[data-v-513f051c]{font-weight:700;margin-top:10px;font-size:1.1em;display:flex;justify-content:space-between}.form-control.column-search[data-v-513f051c]{font-style:italic;font-weight:400}",map:void 0,media:void 0}),e("data-v-513f051c_1",{source:".relation-wrapper .dataTables_length select{border:1px solid #ccc;background:#fff;height:27px}.relation-wrapper .paginate_button{background:0 0!important;color:currentColor!important;box-shadow:none!important}.relation-wrapper .paginate_button.disabled{opacity:.25!important}.relation-wrapper .dataTables_scroll{background:#fff}",map:void 0,media:void 0}))},Gre="data-v-513f051c",jre=void 0,qre=!1;Bre=$re({render:Pre,staticRenderFns:Fre},Dre,Ore,Gre,qre,jre,!1,Jw,void 0,void 0),eS=Bre});var BO={};qn(BO,{default:()=>Kre});function Zre(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="RelationsPage.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Ure,zre,Vre,Hre,Wre,Yre,Xre,Qre,Kre,UO=R(()=>{_o();ze();qO();tS();Ure={name:"relation-page",data(){let{relation:e=null,relations:t=[],nmRelation:n,feature:s=null,currentview:o="relations",chartRelationIds:l=[],layer:a}=this.$options;return{loading:!1,state:null,error:!1,previousview:o,feature:s,currentview:o,relation:e,relations:t,nmRelation:n,chartRelationIds:l,layer:a}},components:{relations:jO,relation:eS},computed:{showrelationslist(){return this.previousview==="relations"&&this.relations.length>1}},methods:{reloadLayout(){$t.$emit("reload-relations")},async showRelation(e){this.loading=!0,this.relation=e;try{T.setCurrentContentOptions({title:e.name,crumb:{title:e.name,text:!0}}),await this.$nextTick(),this.previousview=this.currentview,this.currentview="relation"}catch(t){console.warn(t)}this.loading=!0},setRelationsList(){this.previousview="relation",this.currentview="relations",T.setCurrentContentOptions({crumb:{title:"info.list_of_relations"}}),this.loading=!1}},beforeMount(){(this.currentview==="relation"||this.relations.length===1&&this.relations[0].type==="ONE")&&this.showRelation(this.relations[0])},async mounted(){this.relations.sort(({name:e},{name:t})=>e<t?-1:e>t?1:0),await this.$nextTick(),this.error&&requestAnimationFrame(()=>T.popContent()),this.error=!1},created(){this.$on("resize-component",this.reloadLayout)}},zre=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"query-relations-page"},[n(e.currentview,{ref:e.currentview,tag:"component",attrs:{loading:e.loading,previousview:e.previousview,relations:e.relations,relation:e.relation,feature:e.feature,layer:e.layer,chartRelationIds:e.chartRelationIds,showrelationslist:e.showrelationslist}})],1)},Vre=[],Hre=void 0,Wre=void 0,Yre=void 0,Xre=!1;Qre=Zre({render:zre,staticRenderFns:Vre},Hre,Ure,Wre,Xre,Yre,!1,void 0,void 0,void 0),Kre=Qre});var VO={};qn(VO,{default:()=>Jre});function zO(e){if(e.nodes)for(let t of e.nodes)zO(t);else e.name&&(e.relation=!0)}var Jre,HO=R(()=>{_o();ze();ft();vn();Ws();_l();Ke();ei();lc();iw();nw();Gw();ga();dr();Wt();Xt();bl();fu();Rt();Jre=new class extends nt{constructor(){super(),this.setters=["setQueryResponse","setLayersData","addComponent","addActionsForLayers","postRender","closeComponent","changeLayerResult","activeMapInteraction","editFeature","openCloseFeatureResult","removeFeatureLayerFromResult"],this.unlistenerlayeractionevents=[],this._relations={},this._atlas=[],this.plotLayerIds=[],this.state={logged:F.user.id!==void 0,components:[],layers:[],changed:!1,query:null,type:"ows",layersactions:{},actiontools:{},currentactiontools:{},currentactionfeaturelayer:{},layeractiontool:{},layersFeaturesBoxes:{},layerscustomcomponents:{}},this._vectorLayers=[],this._addFeaturesLayerResultInteraction={id:null,interaction:null,mapcontrol:null,toggleeventhandler:null},this._asyncFnc={todo:()=>{},zoomToLayerFeaturesExtent:{async:!1},highLightLayerFeatures:{async:!1},goToGeometry:{async:!1}},this.resultsQueryLayer=new ol.layer.Vector({source:new ol.source.Vector,style:t=>new ol.style.Style(t.getGeometry().getType()==="Point"?{text:new ol.style.Text({fill:new ol.style.Stroke({color:"black"}),text:"\uF3C5",font:'900 3em "Font Awesome 5 Free"',offsetY:-15})}:{stroke:new ol.style.Stroke({color:"black"})})}),this._project=F.project,this._projectLayerIds=(()=>{let t=[],n=s=>{(s.nodes||[s]).forEach(o=>{o.id?t.push(o.id):n(o)})};return this._project.state.layerstree.forEach(n),t})(),this._setRelations(this._project),this._atlas=this._project.getPrint().filter(t=>t.atlas)||[],T.onbefore("setContent",t=>{t.perc===100&&T.isMobile()&&(this._asyncFnc.zoomToLayerFeaturesExtent.async=!0,this._asyncFnc.highLightLayerFeatures.async=!0,this._asyncFnc.goToGeometry.async=!0)})}setQueryResponse(t,n={add:!1,update:!1}){if(t.data||(t.data=[]),t.query||(t.query={external:{add:!1,filter:{SELECTED:!1}}}),t.query.external||(t.query.external={add:!1,filter:{SELECTED:!1}}),n.add===!1&&n.update&&(this.state.query=t.query,this.state.type=t.type),n.add===!1&&!n.update&&(this.clearState(),this.state.query=t.query,this.state.type=t.type),t.query.external.add===!0&&n.add===!1){let l=T.getService("catalog"),a=t.query.external.filter.SELECTED;this._vectorLayers.forEach(u=>{let h=u.get("id");u.getVisible()&&[void 0,!!(l.state.external.vector.find(p=>p.id===h)||{}).selected].includes(a)&&t.data[h==="__g3w_marker"?"unshift":"push"](this.getVectorLayerFeaturesFromQueryRequest(u,t.query))})}let s=n.add===!1&&{coordinates:(this.state.query.coordinates||[]).length===2&&new ol.geom.Point(this.state.query.coordinates),bbox:(this.state.query.bbox||[]).length===4&&ol.geom.Polygon.fromExtent(this.state.query.bbox),polygon:this.state.query.geometry,drawpolygon:this.state.query.geometry,circle:this.state.query.geometry}[this.state.query.type];if(s){let l=new ol.Feature(s);l.setId(void 0),this.resultsQueryLayer.getSource().clear(),T.getService("map").getMap().removeLayer(this.resultsQueryLayer),this.resultsQueryLayer.getSource().addFeature(l),T.getService("map").getMap().addLayer(this.resultsQueryLayer),this.resultsQueryLayer.setZIndex(T.getService("map").getMap().getLayers().getLength())}let o=t.data.flatMap(l=>[].concat(l)).filter(l=>l&&(l.rawdata!==void 0||Array.isArray(l.features)&&l.features.length>0)).map(({layer:l,features:a,rawdata:u,error:h}={})=>{let p=l instanceof Gn,d=l instanceof ol.layer.Vector,_=typeof l=="string"||l instanceof String,m;if(_)m=Gn.LayerTypes.VECTOR;else if(p)try{m=l.getSourceType()}catch(P){console.warn("uknown source type for layer:",P,l)}let v=_&&l.split("_"),x=(p?l.getId():void 0)||(d?l.get("id"):void 0)||(_?l:void 0),b,w;(!a||!a.length)&&(b=[]),!b&&l instanceof Gn&&(w=l.getAttributes().map(P=>this.state.type==="ows"?{...P,name:P.name.replace(/ /g,"_")}:P)),!b&&l instanceof ol.layer.Vector&&(w=l.getProperties()),(!b&&typeof l=="string"||l instanceof String)&&(w=a[0]?a[0].getProperties():[]);let L=(!b&&l instanceof Gn&&w||[]).filter(P=>{try{return P.name[0]==="_"||Number.isInteger(1*P.name[0])}catch{return!1}}).map(P=>({alias:P.name.replace(/_/,""),name:P.name}));!b&&L.length&&a.forEach(P=>{let j=Object.keys(P.getProperties());L.forEach(V=>{j.find(H=>{if(H===V.alias)return P.set(V.name,P.get(H)),!0})})});let D=!b&&pr(Object.keys(a[0]instanceof ol.Feature?a[0].getProperties():a[0].properties));b||(b=w&&w.length>0?w.filter(P=>D.includes(P.name)):D.map(P=>({name:P,label:P,show:jt!==P&&[void 0,"gdal","wms","wcs","wmst","postgresraster"].includes(m),type:"varchar"})));let G=d||_,W=p&&l.hasFormStructure()&&l.getLayerEditingFormStructure();if(W&&Array.isArray(this._relations[l.getId()])&&this._relations[l.getId()].length>0)for(let P of W)zO(P);return{id:x,attributes:b,external:G,features:(!u&&a||[]).map(P=>({id:G||P instanceof ol.Feature?P.getId():P.id,attributes:P instanceof ol.Feature?P.getProperties():P.properties,geometry:P instanceof ol.Feature?P.getGeometry():P.geometry,selection:{selected:!G&&(!!t.query.autofilter||l.state.selection.active)},show:!0})),hasgeometry:Array.isArray(a)&&!u&&a.some(P=>P instanceof ol.Feature?P.getGeometry():P.geometry),hasImageField:Array.isArray(a)&&!u&&a.length&&b.some(P=>P.type==="image"),loading:!1,show:!0,expandable:!0,addfeaturesresults:{active:!1},downloadformats:{active:!1},editable:p?l.isEditable()&&l.config.editing.visible:!1,inediting:p?l.isInEditing():!1,source:p?l.getSource():void 0,infoformat:p?l.getInfoFormat():void 0,infoformats:p?l.getInfoFormats():[],downloads:p?l.getDownloadableFormats():[],formStructure:W?{structure:W,fields:l.getFields().filter(P=>P.show).concat((Array.isArray(a)&&!u&&a.length>0&&b||[]).filter(P=>l.getFields().some(j=>j.name===P.name)))}:void 0,relationsattributes:p||d||_?[]:void 0,hasdownloadablerelations:!G&&l.hasDowloadableRelations(),filter:p&&!["wms","wcs","wmst"].includes(m)?l.state.filter:{},selection:p&&!["wms","wcs","wmst"].includes(m)&&l.state.selection||d&&l.selection||{active:!1},title:p&&l.getTitle()||d&&l.get("name")||_&&v&&(v.length>4?v.slice(0,v.length-4).join(" "):l)||void 0,atlas:this._atlas.filter(P=>P.atlas.qgs_layer_id===x),rawdata:u||null,error:h||"",toc:G||l.state.toc,max_preview_fields:l.state?.max_preview_fields||3}});this.setLayersData(o,n)}setLayersData(t=[],n={add:!1,update:!1}){n.add===!1&&t.sort((s,o)=>s.external?0:this._projectLayerIds.indexOf(s.id)>this._projectLayerIds.indexOf(o.id)?1:-1),t.forEach((s,o)=>{s.filter.pagination=s.filter.active&&this.state.query?.pagination?.paginate?.at(o),n.add||n.update?this.updateLayerResultFeatures(s,n.update):this.state.layers.push(s)}),this.setActionsForLayers(t,{add:n.add,update:n.update}),this.state.changed=!0}addComponent(t){this.state.components.push(t)}addActionsForLayers(t,n){}postRender(t){}closeComponent(){}changeLayerResult(t){this.state.layersactions[t.id].forEach(n=>n.change&&n.change(t)),(t.features||[]).forEach((n,s)=>{let o=this.state.currentactiontools[t.id];o!==void 0&&(o[s]===void 0&&Vue.set(o,s,null),o[s]=null)})}activeMapInteraction(){}editFeature({layer:t,feature:n}={}){}openCloseFeatureResult({open:t,layer:n,feature:s,container:o}={}){}removeFeatureLayerFromResult(t,n){this.updateLayerResultFeatures({id:t.id,external:t.external,features:[n]})}addLayersPlotIds(t=[]){this.plotLayerIds=t}registerCustomComponent({id:t=Qe(),layerId:n,component:s,type:o="feature",position:l="after"}={}){return this.state.layerscustomcomponents[n]===void 0&&(this.state.layerscustomcomponents[n]={layer:{before:[],after:[]},feature:{before:[],after:[]}}),this.state.layerscustomcomponents[n][o][l].push({id:t,component:s}),t}updateLayerResultFeatures(t,n=!1){let s=this.state.layers.find(u=>u.id===t.id),o=t.features||[],l=(s||{}).external;if(s&&(s.features||[]).length>0){let u=n?[]:s.features.map(p=>this._getFeatureId(p,l)),h=this.state.layersactions[s.id].find(p=>p.id==="selection");n&&(s.features.forEach(p=>delete this.state.layersFeaturesBoxes[this.getBoxId(s,p)]),s.features.splice(0)),o.forEach((p,d)=>{let _=this._getFeatureId(p,l);u.some(m=>m===_)?(h&&p.selection.selected&&(l?s:De(s.id)).excludeSelectionFid(_,s.filter.active),s.features=s.features.filter(m=>_!==this._getFeatureId(m,l)),delete this.state.layersFeaturesBoxes[this.getBoxId(s,p)],h&&(delete h.state.toggled[d],h.state.toggled=Vue.observable(s.features.reduce((m,v,x)=>(m[x]=v.selection.selected,m),{})))):s.features.push(p)}),(s.features||[]).forEach(p=>{let d=(s.features||[]).length>1,_=this.state.layersFeaturesBoxes[this.getBoxId(s,p)];_&&setTimeout(()=>_.collapsed=d)})}s&&(s.features||[]).length===0&&setTimeout(()=>{this.state.layers=this.state.layers.filter(u=>u.id!==s.id),this.clearHighlightGeometry(s),this.removeAddFeaturesLayerResultInteraction(!0)}),this.state.layers.length===1&&T.getService("map").highlightFeatures(this.state.layers[0].features,{duration:1/0}),this.changeLayerResult(s)}getBoxId(t,n,s){return s!=null?`${t.id}_${n.id}_${s}`:`${t.id}_${n.id}`}setActionsForLayers(t,n={add:!1,update:!1}){n.add||n.update||(this.unlistenerlayeractionevents=[],t.forEach((s,o)=>{if(this.state.layeractiontool[s.id]=Vue.observable({component:null,config:null}),this.state.currentactiontools[s.id]=Vue.observable({...Array((s.features||[]).length).fill(null)}),this.state.currentactionfeaturelayer[s.id]=Vue.observable({...Array((s.features||[]).length).fill(null)}),this.state.layersactions[s.id]=this.state.layersactions[s.id]||[],this.state.layersactions[s.id].push(...[s.hasgeometry&&{id:"gotogeometry",mouseover:!0,class:T.getFontClass("marker"),hint:"Zoom to feature",cbk:En(this.goToGeometry.bind(this))},(this._relations[s.id]||[]).some(l=>l.type==="MANY")&&{id:"show-query-relations",class:T.getFontClass("relation"),hint:"Show Relations",cbk(l,a,u){T.setCurrentContentOptions({title:l.title,crumb:{text:!0,title:l.title}}),T.pushContent({content:new pt({internalComponent:new(Vue.extend((UO(),kn(BO)).default))({relations:u.relations,chartRelationIds:u.relations.map(h=>T.getService("queryresults").plotLayerIds.find(p=>p===h.referencingLayer)).filter(Boolean),feature:a,layer:l})}),backonclose:!0,title:"info.list_of_relations",id:"__G3W_LIST_OF_RELATIONS_ID__",crumb:{title:"info.list_of_relations",trigger:null},closable:!1})},relations:(this._relations[s.id]||[]).filter(l=>l.type==="MANY")},this._atlas.filter(l=>l.atlas.qgs_layer_id===s.id).length&&{id:"printatlas",download:!0,class:T.getFontClass("print"),hint:"Print Atlas",cbk:this.printAtlas.bind(this)},(s.id==="__g3w_marker"||!s.external&&(s.source||{}).type!=="wms")&&{id:"removefeaturefromresult",mouseover:!0,class:T.getFontClass("minus-square"),style:{color:"red"},state:Vue.observable({show:!s.filter.pagination}),hint:"Remove feature from results",cbk:this.removeFeatureLayerFromResult.bind(this),init(){this.unwatch=$t.$watch(()=>s.filter.pagination,l=>this.state.show=!l)},clear(){this.unwatch&&this.unwatch()},change(){this.state.disabled=!s.filter.pagination}},s.toc&&s.selection.active!==void 0&&{id:"selection",class:T.getFontClass("success"),hint:"Add/Remove Selection",state:Vue.observable({toggled:s.features.reduce((l,a,u)=>(l[u]=!1,l),{}),show:!s.filter.pagination}),init({layer:l,feature:a,index:u,action:h}={}){if(!a)return console.trace("Invalid feature");let p=De(l.id),d=a.attributes[jt]||a.id,_=l.external?a.selection.selected:p.state.filter.active||p.hasSelectionFid(d);h.state.toggled[u]=_,l.selection.active=(u===0||l.selection.active)&&_,p&&_&&!p.hasSelectionFid(d)&&(p.addOlSelectionFeature({id:d,feature:a}).selected=!0,p.includeSelectionFid(d,!1))},change({features:l}){setTimeout(()=>{this.state.show=!s.filter.pagination,l.forEach((a,u)=>this.state.toggled[u]===void 0&&$t.$set(this.state.toggled,u,!1))})},cbk:En(this.toggleSelection.bind(this))},s.hasgeometry&&!s.external&&(s.source||{}).type!=="wms"&&{id:"link_zoom_to_fid",class:T.getFontClass("share-alt"),hint:"Share via link",cbk(l,a,u){let h=new URL(location.href);h.searchParams.set("zoom_to_fid",`${l.id}|${a.attributes[jt]}`),T.getPermalink(h,{})}},s.editable&&s.inediting===!1&&{id:"editing",class:T.getFontClass("pencil"),hint:"Editing",cbk:(l,a)=>this.editFeature({layer:l,feature:a})}].filter(Boolean)),s.external&&s.toc&&s.selection.active!==void 0)s.selection.features=s.selection.features||[],s.features.forEach(l=>l.selection=(s.selection.features.find(a=>l.id===a.getId())||{selection:{selected:!1}}).selection);else if(!s.external&&s.toc&&s.selection.active!==void 0){let l=()=>s.features.forEach((a,u)=>this.state.layersactions[s.id].find(h=>h.id==="selection").state.toggled[u]=!1);De(s.id).on("unselectionall",l),this.unlistenerlayeractionevents.push({layer:De(s.id),event:"unselectionall",handler:l})}}),this.addActionsForLayers(this.state.layersactions,this.state.layers))}getActionLayerById({layer:t,id:n}={}){if(this.state.layersactions[t.id])return this.state.layersactions[t.id].find(s=>s.id===n)}setCurrentActionLayerFeatureTool({layer:t,action:n,index:s,component:o=null}={}){let l=this.state.currentactiontools[t.id],a=this.state.currentactionfeaturelayer[t.id];a[s]=o?n:null,l[s]=o,l[s]&&n.id!==a[s].id&&a[s].toggleable&&(a[s].state.toggled[s]=!1)}setLayerActionTool({layer:t,component:n=null,config:s=null}={}){this.state.layeractiontool[t.id].component=n,this.state.layeractiontool[t.id].config=s}clear(){this._asyncFnc.todo(),this.unlistenerlayeractionevents.forEach(t=>t.layer.off(t.event,t.handler)),this.unlistenerlayeractionevents=[],T.getService("map").clearHighlightGeometry(),this.resultsQueryLayer.getSource().clear(),this.removeAddFeaturesLayerResultInteraction(!0),this._asyncFnc={todo:()=>{},zoomToLayerFeaturesExtent:{async:!1},highLightLayerFeatures:{async:!1},goToGeometry:{async:!1}},this.clearState(),this.closeComponent(),this.resultsQueryLayer.getSource().clear(),T.getService("map").getMap().removeLayer(this.resultsQueryLayer)}isOneLayerResult(){return this.state.layers.length===1}removeAddFeaturesLayerResultInteraction(t){let n=this._addFeaturesLayerResultInteraction;n.toggleeventhandler!==null&&T.getService("map").off("mapcontrol:toggled",n.toggleeventhandler),n.interaction!==null&&T.getService("map").removeInteraction(n.interaction),n.mapcontrol!==null&&n.mapcontrol.toggle(t),Object.assign(n,{interaction:null,id:null,toggleeventhandler:null,mapcontrol:null})}addLayerFeaturesToResultsAction(t){let n=this._addFeaturesLayerResultInteraction,s=![null,t.id].includes(n.id),o=s&&this.state.layers.find(l=>l.id===n.id);if(s&&o&&(o.addfeaturesresults.active=!1),s&&n.interaction&&T.getService("map").removeInteraction(n.interaction),n.id=t.id,t.addfeaturesresults.active=!t.addfeaturesresults.active,t.addfeaturesresults.active===!1)this.removeAddFeaturesLayerResultInteraction(!0);else{this.activeMapInteraction();let l=(this.state.layers.find(a=>a.id===t.id)||{}).external;n.mapcontrol=n.mapcontrol||T.getService("map").getCurrentToggledMapControl()||null,n.interaction=new gi,T.getService("map").addInteraction(n.interaction,{close:!1}),n.interaction.on("picked",async({coordinate:a})=>{l?this.setQueryResponse({data:[this.getVectorLayerFeaturesFromQueryRequest(this._vectorLayers.find(u=>t.id===u.get("id")),{coordinates:a})],query:{coordinates:a}},{add:!0}):await gt.getData("query:coordinates",{inputs:{coordinates:a,query_point_tolerance:this._project.getQueryPointTolerance(),layerIds:[t.id],multilayers:!1},outputs:{show:{add:!0}}})}),n.toggleeventhandler=a=>{a.target.isToggled()&&a.target.isClickMap()&&(t.addfeaturesresults.active=!1)},T.getService("map").once("mapcontrol:toggled",n.toggleeventhandler)}}deactiveQueryInteractions(){this.state.layers.forEach(t=>{t.addfeaturesresults&&(t.addfeaturesresults.active=!1)}),this.removeAddFeaturesLayerResultInteraction()}zoomToLayerFeaturesExtent(t,n={}){n.highlight=!this.isOneLayerResult();let s=(t.features||[]).filter(o=>this.showFeature(t,o));this._asyncFnc.zoomToLayerFeaturesExtent.async?this._asyncFnc.todo=T.getService("map").zoomToFeatures.bind(T.getService("map"),s,n):T.getService("map").zoomToFeatures(s,n)}showFeature(t,n){return n.show&&((t.filter||{}).active?n.selection.selected:!0)}highLightLayerFeatures(t,n={}){let s=(t.features||[]).filter(o=>this.showFeature(t,o));this._asyncFnc.highLightLayerFeatures.async?this._asyncFnc.todo=T.getService("map").highlightFeatures.bind(T.getService("map"),s,n):T.getService("map").highlightFeatures(s,n)}clearState(){this.state.layers.splice(0),this.state.query=null,this.state.querytitle="",this.state.changed=!1,this.state.layersactions={},this.state.actiontools={},this.state.layeractiontool={},this.state.currentactiontools={},this.state.layersFeaturesBoxes={},this.removeAddFeaturesLayerResultInteraction()}getState(){return this.state}setState(t){this.state=t}_setRelations(t){this._relations=(t.getRelations()||[]).reduce((n,s)=>(n[s.referencedLayer]=n[s.referencedLayer]||[],n[s.referencedLayer].push(s),n),{})}setTitle(t){this.state.querytitle=t||""}async trigger(t,n,s,o,l){if(t==="highlightgeometry"&&this.highlightGeometry(n,s,o),t==="clearHighlightGeometry"&&this.clearHighlightGeometry(n,s,o),n&&this.state.layersactions[n.id]){let a=this.state.layersactions[n.id].find(u=>u.id===t);if(a&&a.cbk&&await a.cbk(n,s,a,o,l),a&&a.route){let u=a.route.replace(/{(\w*)}/g,(h,p)=>s.attributes.hasOwnProperty(p)?s.attributes[p]:"");u&&u!==""&&T.goto(u)}}}registerVectorLayer(t){this._vectorLayers.includes(t)||this._vectorLayers.push(t)}unregisterVectorLayer(t){this._vectorLayers=this._vectorLayers.filter(n=>(this.state.layers=this.state.layers.filter(s=>s.id!==t.get("id")),n!==t))}getVectorLayerFeaturesFromQueryRequest(t,n={}){let{coordinates:s,bbox:o,geometry:l,filterConfig:a={}}=n,u=[],h=s&&Array.isArray(s),p=o&&Array.isArray(o);h&&T.getService("map").viewer.map.forEachFeatureAtPixel(T.getService("map").viewer.map.getPixelFromCoordinate(s),_=>{u.push(_)},{layerFilter:_=>_===t}),p&&!h&&(l=ol.geom.Polygon.fromExtent(o));let d=l instanceof ol.geom.Polygon||l instanceof ol.geom.MultiPolygon;return d&&!h&&Qi===t.constructor?u=t.getIntersectedFeatures(l):d&&!h&&ol.layer.Vector===t.constructor&&t.getSource().getFeatures().forEach(_=>{let m;switch(a.spatialMethod){case"within":m=a_(l,_.getGeometry());break;case"intersects":default:m=l_(l,_.getGeometry());break}m===!0&&u.push(_)}),{features:u,layer:t}}async _printSingleAtlas({atlas:t={},features:n=[]}={}){let s=t.atlas?.field_name||"$id";F.download=!0,T.setLoadingContent(!0);try{let{url:o}=await k_({field:s,values:n.map(a=>a.attributes[s==="$id"?jt:s]),template:t.name,download:!0}),l=o&&await fetch(o);if(!l?.ok)throw(await l.json()).message;Si(await l.blob(),t.name||(l.headers.get("content-disposition")||"filename=g3w_download_file").split("filename=").at(1))}catch(o){T.showUserMessage({type:"alert",message:o||"server_error",textMessage:!!o})}F.download=!1,T.setLoadingContent(!1)}showChart(t,n,s){this.emit("show-chart",t,n,s)}hideChart(t){this.emit("hide-chart",t)}printAtlas(t,n){let s=n?[n]:t.features,o=this._atlas.filter(a=>a.atlas.qgs_layer_id===t.id);if(o.length<=1){this._printSingleAtlas({features:s,atlas:o[0]});return}let l="";o.forEach((a,u)=>{let h=Qe();l+=`<label for="${h}"><input id="${h}" g3w_atlas_index="${u}" type="radio" name="template" value="${a.name}" /> ${a.name}</label><br>`}),T.showModalDialog({title:_e("Select Template"),message:l,buttons:{success:{label:"OK",className:"skin-button",callback:()=>{let a=$('input[name="template"]:checked').attr("g3w_atlas_index");if(a===void 0)return!1;this._printSingleAtlas({features:s,atlas:o[a]})}}}})}goToGeometry(t,n){n.geometry&&(this._asyncFnc.goToGeometry.async?this._asyncFnc.todo=T.getService("map")[this.isOneLayerResult()?"zoomToFeatures":"highlightGeometry"].bind(T.getService("map"),this.isOneLayerResult()?[n]:n.geometry,this.isOneLayerResult()?{}:{layerId:t.id,duration:1500}):setTimeout(()=>T.getService("map")[this.isOneLayerResult()?"zoomToFeatures":"highlightGeometry"](this.isOneLayerResult()?[n]:n.geometry,this.isOneLayerResult()?{}:{layerId:t.id,duration:1500})))}highlightGeometry(t,n){n.geometry&&T.getService("map").highlightGeometry(n.geometry,{layerId:t.id,zoom:!1,duration:1/0})}clearHighlightGeometry(t){T.getService("map").clearHighlightGeometry()}showRelation({relation:t,layerId:n,feature:s}={}){let o=this._project.getRelationById(t.name);T.pushContent({content:new pt({vueComponentObject:(tS(),kn($O)).default,propsData:{relation:o,chartRelationIds:this.plotLayerIds.find(l=>l==o.referencingLayer)?[o.referencingLayer]:[],nmRelation:this._project.getRelationById(t.nmRelationId),layer:{id:n},feature:s}}),crumb:{title:o.name,text:!0},title:o.name,text:!0,closable:!1})}_getFeatureId(t,n){return n?t.id:t.attributes[jt]||t.id}async toggleSelection(t,n){let s=T.getService("queryresults"),o=s.getActionLayerById({layer:t,id:"selection"}),l=(t.features||[]).findIndex(d=>d==n),a=t.selection.active,u=t.external?t:De(t.id),h=[].concat(n||t.features||[]);if(!h.length)return console.warn("no features");if(t.features.forEach((d,_)=>{n?_===l&&(o.state.toggled[_]=!o.state.toggled[_]):o.state.toggled[_]=!a,d.selection.selected=o.state.toggled[_]}),!t.external&&!n&&a){u.clearSelectionFids();return}if(t.selection.features=t.selection.features||[],t.external&&!n){t.selection.active=!a,t.features.forEach(d=>{let _=t.selection.features.find(m=>d.id===m.getId());_||(_=new ol.Feature(d.geometry),_.setId(d.id),Object.keys(d.attributes).forEach(m=>_.set(m,d.attributes[m])),t.selection.features.push(Object.assign(_,{__layerId:t.id,selection:{selected:t.selection.active}}))),_.selection.selected=t.selection.active,T.getService("map").setSelectionFeatures(t.selection.active?"add":"remove",{feature:_})});return}if(t.external&&n){let d=u.selection.features.find(_=>n.id===_.getId());d&&(d.selection.selected=o.state.toggled[l]),d||(d=new ol.Feature(n.geometry),d.setId(n.id),Object.keys(n.attributes).forEach(_=>d.set(_,n.attributes[_])),u.selection.features.push(Object.assign(d,{__layerId:u.id,selection:{selected:!0}}))),T.getService("map").setSelectionFeatures(d.selection.selected?"add":"remove",{feature:d}),u.selection.active=Object.values(o.state.toggled).every(_=>_);return}let p=(h||[]).map(d=>d.attributes[jt]||d.id);p.forEach((d,_)=>{let m=u.state.filter.active||u.hasSelectionFid(d);!m&&h[_]?.geometry&&!u.getOlSelectionFeature(d)&&u.addOlSelectionFeature({id:d,feature:h[_]}),n&&m&&u.excludeSelectionFid(d),n&&!m&&u.includeSelectionFid(d),!n&&!a&&!m&&u.includeSelectionFid(d,!1),!n&&a&&u.excludeSelectionFid(d,!1)}),u.state.filter.active&&p.forEach((d,_)=>{let m=n?l:_;t.features.splice(m,1),delete o.state.toggled[m],o.state.toggled=Object.entries(o.state.toggled).reduce((v,x,b)=>Object.assign(v,{[b]:x}),{})}),u.state.selection.active=Object.values(o.state.toggled).every(d=>d),T.getService("map").clearHighlightGeometry(),s.getState().layers.length===1&&!s.getState().layers[0].features.length&&s.getState().layers.splice(0)}}});function aoe(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="QueryResultsTableAttributeFieldValue.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var eoe,toe,noe,ioe,soe,roe,ooe,loe,WO,YO=R(()=>{yv();Ev();hg();us();eoe={name:"tableattributefieldvalue",props:{field:{type:Object},feature:{type:Object}},mixins:[mr],components:{"g3w-link":cg,"g3w-vue":gg,"g3w-image":tl}},toe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isVue(e.field)?n("g3w-vue",{attrs:{feature:e.feature,state:e.field}}):e.isSimple(e.field)?n("span",{domProps:{innerHTML:e._s(e.field.value)}}):e.isPhoto(e.field)?n("g3w-image",{attrs:{state:e.field}}):e.isImage(e.field)?n("g3w-image",{attrs:{state:e.field}}):e.isLink(e.field)?n("g3w-link",{attrs:{state:{value:e.field.value}}}):e._e()},noe=[],ioe=void 0,soe="data-v-019d651d",roe=void 0,ooe=!1;loe=aoe({render:toe,staticRenderFns:noe},ioe,eoe,soe,ooe,roe,!1,void 0,void 0,void 0),WO=loe});function moe(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="QueryResultsActionInfoFormats.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var coe,uoe,doe,hoe,foe,poe,goe,_oe,XO,ZO=R(()=>{ze();Ym();lc();Xt();coe={name:"Infoformats",props:{layer:{type:Object,required:!0}},data(){return{infoformat:this.layer.infoformat}},computed:{infoformats(){return this.layer.infoformats||[]},hasInfo(){return this.infoformats.length}},methods:{async reloadLayerDataWithChangedContentType(e){this.layer.loading=!0,this.$el.disabled=!0;try{let t=await this.projectLayer.changeProxyDataAndReloadFromServer("wms",{headers:{"Content-Type":e},params:{INFO_FORMAT:e}});this.layer.infoformat=e,this.projectLayer.setInfoFormat(this.layer.infoformat);let[n]=gs.get(e)({layers:[this.projectLayer],response:t});n.features?this.__parsedata(n):this.__parserawdata(n)}catch(t){console.warn(t)}this.layer.loading=!1,this.$el.disabled=!1},__parsedata(e){let t=T.getService("queryresults");this.layer.rawdata=null,e.features.forEach(n=>{let{id:s,geometry:o,properties:l}={properties:n instanceof ol.Feature?n.getProperties():n.properties,geometry:n instanceof ol.Feature?n.getGeometry():n.geometry,id:n instanceof ol.Feature?n.getId():n.id};this.layer.attributes.length===0&&(this.layer.hasgeometry=!!o,t.setActionsForLayers([this.layer]),pr(l).forEach(a=>{this.layer.attributes.push({name:a,label:a,show:!0})})),this.layer.features.push({id:s,attributes:l,geometry:o,show:!0})})},async __parserawdata(e){this.layer.features.splice(0),await this.$nextTick(),this.layer.rawdata=e.rawdata}},watch:{infoformat(e){this.reloadLayerDataWithChangedContentType(e)}},created(){this.projectLayer=De(this.layer.id)},beforeDestroy(){this.projectLayer&&this.projectLayer.clearProxyData("wms"),this.projectLayer=null}},uoe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.hasInfo?n("select",{directives:[{name:"select2",rawName:"v-select2",value:"infoformat",expression:"'infoformat'"}],staticClass:"skin-color",attrs:{select2_value:e.infoformat,search:!1}},e._l(e.infoformats,function(s){return n("option",{key:s,domProps:{value:s}},[e._v(`
    `+e._s(s)+`
  `)])}),0):e._e()},doe=[],hoe=void 0,foe=void 0,poe=void 0,goe=!1;_oe=moe({render:uoe,staticRenderFns:doe},hoe,coe,foe,goe,poe,!1,void 0,void 0,void 0),XO=_oe});function Coe(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="QueryResultsAction.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var yoe,voe,boe,xoe,woe,Soe,Eoe,Ioe,QO,KO=R(()=>{Ke();yoe={name:"action",data(){return{ApplicationState:F,show:!0}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},action:{type:Object,required:!0}},methods:{async clickAction(e,t,n,s,o){await this.trigger(e,t,n,s),this.$emit("action-clicked",e)}},async created(){if(this.action.init&&this.action.init({layer:this.layer,feature:this.feature,index:this.featureIndex,action:this.action}),typeof this.action.condition=="function"){let e=this.action.condition({layer:this.layer,feature:this.feature});this.show=e instanceof Promise?await e:e}},beforeDestroy(){typeof this.action.clear=="function"&&this.action.clear({action:this.action,layer:this.layer,feature:this.feature})}},voe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show&&((e.action.state||{}).show===void 0?e.show:e.action.state.show)?n("span",{directives:[{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.download||!!(e.action.state||{}).disabled,expression:"ApplicationState.download || !!(action.state || {}).disabled"},{name:"t-tooltip",rawName:"v-t-tooltip:top",value:e.action.hint,expression:"action.hint",arg:"top"}],staticClass:"action-button",class:{toggled:(e.action.state||{}).toggled&&e.action.state.toggled[e.featureIndex]},on:{contextmenu:function(s){s.preventDefault(),s.stopPropagation()},click:function(s){return s.stopPropagation(),e.clickAction(e.action,e.layer,e.feature,e.featureIndex,s)}}},[n("span",{class:"action-button-icon "+e.action.class,staticStyle:{padding:"2px"},style:e.action.style})]):e._e()},boe=[],xoe=void 0,woe=void 0,Soe=void 0,Eoe=!1;Ioe=Coe({render:voe,staticRenderFns:boe},xoe,yoe,woe,Eoe,Soe,!1,void 0,void 0,void 0),QO=Ioe});function Ooe(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="QueryResultsActions.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function nS(){let e=nS.styles||(nS.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Loe,Noe,Toe,koe,Roe,Moe,Aoe,Poe,A_,iS=R(()=>{KO();Loe={name:"actions",props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},actions:{type:Array,default:[]},colspan:{type:Number}},components:{action:QO}},Noe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.actions.length?n("td",{staticClass:"g3w-feature-actions",staticStyle:{padding:"3px"},attrs:{colspan:e.colspan}},e._l(e.actions,function(s){return n("action",e._b({key:s.id,attrs:{action:s}},"action",e.$props,!1))}),1):e._e()},Toe=[],koe=function(e){e&&e("data-v-7ca160b6_0",{source:".g3w-feature-actions[data-v-7ca160b6]{padding:3px;background-color:rgba(34,45,50,.1)!important}",map:void 0,media:void 0})},Roe="data-v-7ca160b6",Moe=void 0,Aoe=!1;Poe=Ooe({render:Noe,staticRenderFns:Toe},koe,Loe,Roe,Aoe,Moe,!1,nS,void 0,void 0),A_=Poe});function Uoe(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="QueryResultsHeaderFeatureBody.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function sS(){let e=sS.styles||(sS.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Foe,Doe,Goe,joe,qoe,$oe,Boe,zoe,JO,eP=R(()=>{iS();hg();us();Foe={name:"headerfeaturebody",mixins:[mr],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object}},components:{actions:A_,"g3w-image":tl}},Doe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[e._l(e.attributesSubset(e.layer),function(s){return n("td",{staticClass:"attribute"},[e.isLink(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:s.name}))?n("span",{staticClass:"skin-color",class:e.g3wtemplate.getFontClass("link")}):e.isPhoto(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:s.name}))||e.isImage(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:s.name}))?n("g3w-image",{attrs:{state:e.getLayerField({layer:e.layer,feature:e.feature,fieldName:s.name})}}):n("span",{domProps:{innerHTML:e._s(e.feature.attributes[s.name])}})],1)}),e._v(" "),e.hasLayerOneFeature(e.layer)?e._e():n("td")],2)},Goe=[],joe=function(e){e&&e("data-v-77addd1a_0",{source:".noAttributes[data-v-77addd1a]{display:flex;justify-content:flex-end}",map:void 0,media:void 0})},qoe="data-v-77addd1a",$oe=void 0,Boe=!1;zoe=Uoe({render:Doe,staticRenderFns:Goe},joe,Foe,qoe,Boe,$oe,!1,sS,void 0,void 0),JO=zoe});function Koe(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="QueryResultsHeaderFeatureActionsBody.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function rS(){let e=rS.styles||(rS.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Voe,Hoe,Woe,Yoe,Xoe,Zoe,Qoe,Joe,tP,nP=R(()=>{iS();us();Voe={name:"headerfeaturebody",mixins:[mr],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object},index:{type:Number},actions:{type:Array},colspan:{type:Number}},components:{actions:A_}},Hoe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",{staticClass:"featurebox-header",on:{mouseover:function(s){return s.stopPropagation(),e.trigger({id:"highlightgeometry"},e.layer,e.feature,e.index)},mouseout:function(s){return s.stopPropagation(),e.trigger({id:"clearHighlightGeometry"},e.layer,e.feature,e.index)}}},[n("actions",{attrs:{colspan:e.colspan,layer:e.layer,featureIndex:e.index,trigger:e.trigger,feature:e.feature,actions:e.actions}})],1)},Woe=[],Yoe=function(e){e&&e("data-v-59230f00_0",{source:".noAttributes[data-v-59230f00]{display:flex;justify-content:flex-end}",map:void 0,media:void 0})},Xoe="data-v-59230f00",Zoe=void 0,Qoe=!1;Joe=Koe({render:Hoe,staticRenderFns:Woe},Yoe,Voe,Xoe,Qoe,Zoe,!1,rS,void 0,void 0),tP=Joe});var iP={};qn(iP,{default:()=>hae});function uae(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="QueryResults.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function oS(){let e=oS.styles||(oS.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var eae,tae,nae,iae,sae,rae,oae,aae,lae,cae,dae,hae,sP=R(()=>{Ke();us();YO();ZO();eP();nP();Xr();dr();Xt();lu();v_();v_();ze();eae=10,tae=10,nae=["varchar","integer","float","bigint","date"],iae={name:"queryresults",data(){return{ApplicationState:F,state:this.$options.service.state,headerExpandActionCellWidth:eae,headerActionsCellWidth:tae}},mixins:[mr],components:{TableAttributeFieldValue:WO,infoformats:XO,"header-feature-body":JO,HeaderFeatureActionsBody:tP},computed:{onelayerresult(){return this.state.layers.length===1},hasLayers(){return this.hasResults||!!this.state.components.length},hasResults(){return this.state.layers.length>0},info(){if(this.state.query){let e=this.state.query,t=T.getService("map").getMapUnits()==="degrees"?4:2;switch(e.type){case"coordinates":return{icon:"marker",message:`  ${e.coordinates[0].toFixed(t)}, ${e.coordinates[1].toFixed(t)}`};case"bbox":return{icon:"square",message:`  [${e.bbox.map(n=>n.toFixed(t)).join(" , ")}]`};case"polygon":case"drawpolygon":return{icon:"draw",message:e.layerName?`${e.layerName} ${e.fid!==void 0?` - Feature Id: ${e.fid}`:""}`:" "};case"circle":return{icon:"empty-circle",message:" "};default:console.warn(`Unsupported query type:  ${e.type}`);break}}else this.state.search;return{icon:null,message:null}},queryableLayers(){return Zi({QUERYABLE:!0})},selectedLayer(){return T.getService("map").getSelectedLayer()}},methods:{canPaginate(e){return!!(this.state.query&&this.state.query.pagination&&this.state.query.pagination.paginate[this.state.layers.findIndex(t=>t==e)])},canSelect(e){return T.getService("queryresults").getActionLayerById({layer:e,id:"selection"})&&(!this.canPaginate(e)||e.selection.active&&e.filter.active)&&e.features.length>1},getLayerDownloads(e=[]){return e.filter(t=>t!=="pdf")},showLayer(e){return e.show&&(this.layerHasFeatures(e)||e.rawdata||Array.isArray(e.infoformats)&&e.infoformats.length>0)},getLayerCustomComponents(e,t="feature",n="after"){return this.state.layerscustomcomponents[e]&&this.state.layerscustomcomponents[e][t]&&this.state.layerscustomcomponents[e][t][n]||[]},getLayerField({layer:e,feature:t,fieldName:n}){return{...e.attributes.find(o=>n===o.name),label:null,value:t.attributes[n]}},getQueryFields(e,t){let n=[];for(let s of e.formStructure.fields){let o={...s};o.query=!0,o.value=t.attributes[s.name],o.input={type:`${this.getFieldType(o)}`},n.push(o)}return n},getColSpan(e){return this.attributesSubsetLength(e)+!this.hasLayerOneFeature(e)*1},addLayerFeaturesToResults(e){this.$options.service.addLayerFeaturesToResultsAction(e)},printAtlas(e){this.$options.service.printAtlas(e)},showLayerDownloadFormats(e){eO(e)},saveLayerResult(e,t="csv"){Zh(t,e,e.features)},hasLayerOneFeature(e){return e.features.length===1},saveFilter(e){De(e.id).saveFilter()},async addRemoveFilter(e){await De(e.id).toggleFilterToken()},getContainerFromFeatureLayer({layer:e,index:t}={}){return $(`#${e.id}_${t} > td`)},hasOneLayerAndOneFeature(e){return this.hasLayerOneFeature(e)},hasFormStructure(e){return!!e.formStructure},layerHasFeatures(e){return Array.isArray(e.features)&&e.features.length>0},toggleSelection(e){this.$options.service.toggleSelection(e)},extractAttributesFromFirstTabOfFormStructureLayers(e){let t=new Set,n=s=>{if(s.nodes)s.nodes.forEach(o=>n(o));else{let o=e.formStructure.fields.find(l=>s.field_name===l.name);o&&(this.state.type==="ows"&&(o={...o},o.name=o.name.replace(/ /g,"_")),t.add(o))}};return e.formStructure.structure.length&&e.formStructure.structure.forEach(s=>n(s)),Array.from(t)},attributesSubset(e){let t=this.hasFormStructure(e)?this.extractAttributesFromFirstTabOfFormStructureLayers(e):e.attributes,n=t.filter(o=>o.show&&nae.includes(o.type)),s=Math.min(e.max_preview_fields,t.length);return n.slice(0,s)},attributesSubsetLength(e){return this.attributesSubset(e).length},getLayerFormStructure(e){return e.formStructure.structure.map(t=>Vue.observable(structuredClone(t)))},getLayerFeatureBox(e,t,n){let s=this.getBoxId(e,t,n);return this.state.layersFeaturesBoxes[s]===void 0&&(this.state.layersFeaturesBoxes[s]=Vue.observable({collapsed:!0}),this.$watch(()=>this.state.layersFeaturesBoxes[s].collapsed,o=>{let l=e.features.findIndex(u=>t.id===u.id),a=this.getContainerFromFeatureLayer({layer:e,index:l});this.$options.service.openCloseFeatureResult({open:!o,layer:e,feature:t,container:a})}),this.state.layersFeaturesBoxes[s].collapsed=e.features.length>1),this.state.layersFeaturesBoxes[s]},collapsedFeatureBox(e,t,n){let s=this.state.layersFeaturesBoxes[this.getBoxId(e,t,n)];return s?s.collapsed:!0},showFeatureInfo(e,t){let n=this.state.layersFeaturesBoxes[t];this.$options.service.emit("show-query-feature-info",{layer:e,tabs:this.hasFormStructure(e),show:n?!n.collapsed:!1})},showFeature(e,t){return this.$options.service.showFeature(e,t)},getBoxId(e,t,n){return this.$options.service.getBoxId(e,t,n)},async toggleFeatureBox(e,t,n){let s=this.getBoxId(e,t,n);this.state.layersFeaturesBoxes[s].collapsed=!this.state.layersFeaturesBoxes[s].collapsed,await this.$nextTick(),this.showFeatureInfo(e,s)},toggleFeatureBoxAndZoom(e,t,n){this.hasLayerOneFeature(e)||this.toggleFeatureBox(e,t,n)},async trigger(e,t,n,s){e.opened&&$(`#${t.id}_${s}`).css("display")==="none"&&(this.toggleFeatureBox(t,n),await this.$nextTick()),await this.$options.service.trigger(e.id,t,n,s,this.getContainerFromFeatureLayer({layer:t,index:s}))},openLink(e){window.open(e,"_blank")},isJSON(e){return!this.isVue(e)&&this.isSimple(e)&&Zn(e.value)==="Object"},openAttributeTable(e){De(e.id).openAttributeTable({perc:100})},highLightLayerFeatures(e,t={highlight:!0}){e.hasgeometry&&this.$options.service.highLightLayerFeatures(e,t)},collapseSidebar(e){let t=e.target.closest(".box"),n=t.classList.contains("collapsed-box");t.classList.toggle("collapsed-box"),t.querySelector(".btn-collapser").classList.toggle("fa-plus",!n),t.querySelector(".btn-collapser").classList.add("fa-minus",n)},async changePage(e,t,n){let{query:s,layers:o}=this.state;o[e].loading=!0;try{n!==void 0&&(s.pagination.current_sizes[e]=n);let l=s.pagination.current_sizes[e];s.autofilter&&s.pagination.paginate[e]&&(s.autofilter=!1,s.pagination.getData.params.forEach(v=>delete v.autofilter)),l&&(s.pagination.getData.params[e].page_size=l);let{method:a,params:u}=s.pagination.getData,h=(s.pagination.getData.layers||[]).find(v=>o[e].id===v.getId()),p=!!h.getFilterToken(),d=await h[a]({...u[e],page:t});this.$options.service.setQueryResponse({...d,query:s},{add:!1,update:!0}),s.pagination.paginate[e]=d.count>(d.data||[])[0].features.length,s.pagination.pages[e]=Math.ceil(d.count/l),o[e].filter.pagination=o[e].filter.active&&s.pagination.paginate[e],s.pagination.current[e]=t;let _=h.state.selection.active||p,m=this.state.layersactions[h.getId()].find(({id:v})=>v==="selection");o[e].features.forEach((v,x)=>{if(_&&!v.selection.selected&&v.geometry&&h.isGeoLayer()){let b=o[e].external?v.id:v.attributes[G3W_FID]||v.id;h.addOlSelectionFeature({id:b,feature:v}).selected=!0,h.includeSelectionFid(b,!1)}v.selection.selected=_,m.state.toggled[x]=_}),h.state.filter.active=_,h.state.selection.active=_,o[e].hasgeometry&&this.$options.service.highLightLayerFeatures(o[e])}catch(l){console.warn(l)}o[e].loading=!1}},watch:{async"state.layers"(e=[]){if(e.forEach(t=>{t.attributes.length<=t.max_preview_fields&&!t.hasImageField&&(t.expandable=!1),t.features.forEach(n=>{this.getLayerFeatureBox(t,n),n.attributes.relations&&n.attributes.relations.forEach(s=>{s.elements.forEach((o,l)=>this.state.layersFeaturesBoxes[`${t.id}_${n.id}_${s.name}${l}`]={collapsed:!0})})})}),this.onelayerresult&&this.hasLayerOneFeature(e[0])){let t=e[0],n=t.features[0],s=this.getBoxId(t,n);this.$options.service.onceafter("postRender",()=>{this.showFeatureInfo(t,s)})}requestAnimationFrame(()=>this.$options.service.postRender(this.$el)),await this.$nextTick()},onelayerresult(e){e&&!this.state.query.pagination?.paginate?.at(0)&&!this.state.layers[0].filter.active&&T.getService("map").highlightFeatures(this.state.layers[0].features,{duration:1/0})}},created(){this.zoomToLayerFeaturesExtent=En(e=>{this.$options.service.zoomToLayerFeaturesExtent(e)})},destroyed(){this.$options.service.clear()}},sae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"queryresults-wrapper",attrs:{id:"search-results"}},[e.info.message?n("div",{staticClass:"skin-color",staticStyle:{"font-weight":"bold","margin-bottom":"3px","font-size":"1.1em"}},[e.info.icon?n("span",{class:e.g3wtemplate.getFontClass(e.info.icon)}):e._e(),e._v(" "),n("span",[e._v(" "+e._s(e.info.message)+" ")])]):e._e(),e._v(" "),n("div",{staticClass:"queryresults-container"},[e.state.layers.length?[e.hasLayers?n("ul",{staticClass:"queryresults",staticStyle:{position:"relative"},attrs:{id:"queryresults"}},[e._l(e.state.layers.filter(function(s){return e.showLayer(s)}),function(s,o){return n("li",[n("bar-loader",{attrs:{loading:s.loading}}),e._v(" "),n("div",{staticClass:"box box-primary"},[n("div",{staticClass:"box-header with-border",class:{mobile:e.isMobile()},on:{mouseover:function(l){return l.stopPropagation(),e.highLightLayerFeatures(s,{highlight:!0,duration:1/0})},mouseout:function(l){return l.stopPropagation(),e.highLightLayerFeatures(s,{highlight:!1})},click:function(l){return l.stopPropagation(),e.collapseSidebar.apply(null,arguments)}}},[n("div",{staticClass:"box-title query-layer-title",style:{fontSize:e.isMobile()&&"1em !important"}},[s.external?e._e():n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Open Attribute Table",expression:"'Open Attribute Table'",arg:"left"}],staticClass:"action-button",on:{click:function(l){return l.stopPropagation(),e.openAttributeTable(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("list")})]),e._v(`
                `+e._s(s.title)+`
                `),s.rawdata?e._e():n("span",[e._v(`
                  (`+e._s(e.canPaginate(s)?s.features.length+(e.state.query.pagination.current.at(o)-1)*e.state.query.pagination.getData.params.at(o).page_size+" - "+e.state.query.pagination.counts[o]:s.features.length)+`)
                `)])]),e._v(" "),n("div",{staticClass:"box-features-action",on:{click:function(l){l.stopPropagation()}}},[n("infoformats",{attrs:{layer:s}}),e._v(" "),s.features.length>1?[s.hasgeometry?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Zoom to features extent",expression:"'Zoom to features extent'",arg:"left"}],staticClass:"action-button",on:{click:function(l){return l.stopPropagation(),e.zoomToLayerFeaturesExtent(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("marker")})]):e._e(),e._v(" "),s.atlas.length?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Print Atlas",expression:"'Print Atlas'",arg:"left"},{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.download,expression:"ApplicationState.download"}],staticClass:"action-button",on:{click:function(l){return l.stopPropagation(),e.printAtlas(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("print")})]):e._e(),e._v(" "),e.getLayerDownloads(s.downloads).length>0?[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Downloads",expression:"'Downloads'",arg:"left"},{name:"disabled",rawName:"v-disabled",value:e.ApplicationState.download,expression:"ApplicationState.download"}],staticClass:"action-button",class:{toggled:s.downloadformats.active}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("download"),on:{click:function(l){return l.stopPropagation(),e.showLayerDownloadFormats(s)}}})])]:e._e()]:e._e(),e._v(" "),s.external||s.source&&s.source.type!=="wms"&&!(e.state.query&&e.state.query.pagination)?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Add/Remove features to results",expression:"'Add/Remove features to results'",arg:"left"}],staticClass:"action-button",class:{toggled:s.addfeaturesresults.active},on:{click:function(l){return l.stopPropagation(),e.addLayerFeaturesToResults(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("plus-square")})]):e._e(),e._v(" "),e.canSelect(s)?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Add/Remove Selection",expression:"'Add/Remove Selection'",arg:"left"}],staticClass:"action-button",class:{toggled:s.selection.active},on:{click:function(l){return l.stopPropagation(),e.toggleSelection(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("success")})]):e._e(),e._v(" "),!s.external&&s.selection.active?[s.filter.pagination?e._e():n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Enable/Disable filter",expression:"'Enable/Disable filter'",arg:"left"}],staticClass:"action-button",class:{toggled:s.filter.active},on:{click:function(l){return l.stopPropagation(),e.addRemoveFilter(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("filter")})]),e._v(" "),e.state.logged&&s.filter.active&&(s.filter.current===null||s.selection.active)?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Save Filter",expression:"'Save Filter'",arg:"left"}],staticClass:"action-button",on:{click:function(l){return l.stopPropagation(),e.saveFilter(s)}}},[n("span",{staticClass:"action-button-icon",class:e.g3wtemplate.getFontClass("save")})]):e._e()]:e._e()],2),e._v(" "),n("button",{staticClass:"btn btn-box-tool",staticStyle:{"pointer-events":"none"}},[n("i",{staticClass:"btn-collapser skin-color",class:e.g3wtemplate.font.minus})])]),e._v(" "),e.state.layeractiontool[s.id].component?[n("div",{staticClass:"g3w-layer-action-tools with-border",class:{mobile:e.isMobile()},staticStyle:{padding:"5px"}},[n(e.state.layeractiontool[s.id].component,{tag:"component",attrs:{layer:s,config:e.state.layeractiontool[s.id].config}})],1)]:e._e(),e._v(" "),e._l(e.getLayerCustomComponents(s.id,"layer","before"),function(l){var a=l.component;return n(a,{tag:"component",attrs:{layer:s}})}),e._v(" "),e.state.query.pagination&&e.state.query.pagination.page_sizes[o].length>1?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:s.loading,expression:"layer.loading"}],attrs:{id:"g3w-queryresults-pagination"}},[n("select",{staticClass:"form-control",staticStyle:{width:"auto"},on:{change:function(l){e.changePage(o,1,Number(l.target.value))}}},e._l(e.state.query.pagination.page_sizes[o],function(l){return n("option",{key:l,domProps:{value:l}},[e._v(e._s(l))])}),0),e._v(" "),n("ul",{staticStyle:{display:"flex","align-items":"center"},attrs:{disabled:!s.loading}},[n("li",[e.state.query.pagination.counts[o]>s.features.length?n("button",{staticClass:"btn fas fa-angle-left",attrs:{disabled:e.state.query.pagination.current[o]===1},on:{click:function(l){return l.stopPropagation(),e.changePage(o,e.state.query.pagination.current[o]-1)}}}):e._e()]),e._v(" "),n("li",[n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:s.features.length===e.state.query.pagination.counts[o],expression:"layer.features.length === state.query.pagination.counts[index]"}],staticClass:"btn",class:{"skin-background-color":e.state.query.pagination.current[o]===1},on:{click:function(l){return l.stopPropagation(),e.changePage(o,1)}}},[e._v("1")])]),e._v(" "),e.state.query.pagination.counts[o]>s.features.length&&e.state.query.pagination.pages[o]>4&&e.state.query.pagination.current[o]>2?n("li",[e._v("\u2026")]):e._e(),e._v(" "),n("li",[e.state.query.pagination.pages[o]>1&&e.state.query.pagination.counts[o]>s.features.length?e._l(e.state.query.pagination.pages[o]<4||e.state.query.pagination.current[o]<3?Array.from(Array(e.state.query.pagination.pages[o]-2).keys()).slice(0,2).map(function(l){return l+2}):e.state.query.pagination.pages[o]-e.state.query.pagination.current[o]>2?[e.state.query.pagination.current[o],e.state.query.pagination.current[o]+1]:[e.state.query.pagination.pages[o]-2,e.state.query.pagination.pages[o]-1],function(l){return n("button",{staticClass:"btn",class:{"skin-background-color":l===e.state.query.pagination.current[o]},on:{click:function(a){return a.stopPropagation(),e.changePage(o,l)}}},[e._v(e._s(l)+`
                    `)])}):e._e()],2),e._v(" "),e.state.query.pagination.counts[o]>s.features.length&&e.state.query.pagination.pages[o]>4&&e.state.query.pagination.current[o]<e.state.query.pagination.pages[o]-2?n("li",[e._v("\u2026")]):e._e(),e._v(" "),n("li",[e.state.query.pagination.counts[o]>s.features.length&&e.state.query.pagination.pages[o]>1?n("button",{staticClass:"btn",class:{"skin-background-color":e.state.query.pagination.pages[o]===e.state.query.pagination.current[o]},on:{click:function(l){return l.stopPropagation(),e.changePage(o,e.state.query.pagination.pages[o])}}},[e._v(`
                    `+e._s(e.state.query.pagination.pages[o])+`
                  `)]):e._e()]),e._v(" "),n("li",[e.state.query.pagination.counts[o]>s.features.length?n("button",{staticClass:"btn fas fa-angle-right",attrs:{disabled:e.state.query.pagination.pages[o]===e.state.query.pagination.current[o]},on:{click:function(l){return l.stopPropagation(),e.changePage(o,e.state.query.pagination.current[o]+1)}}}):e._e()])])]):e._e(),e._v(" "),n("div",{staticClass:"box-body",class:{mobile:e.isMobile()}},[s.rawdata?[n("div",{staticClass:"queryresults-text-html",class:{text:s.infoformat==="text/plain"},domProps:{innerHTML:e._s(s.rawdata)}})]:e.hasFormStructure(s)?[n("table",{staticClass:"table",class:{mobile:e.isMobile()}},e._l(s.features,function(l,a){return e.showFeature(s,l)?n("tbody",{key:l.id},[n("header-feature-actions-body",{attrs:{colspan:e.getColSpan(s),actions:e.state.layersactions[s.id],layer:s,feature:l,index:a,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(s,l),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}),e._v(" "),n("tr",{staticClass:"g3w-feature-result-action-tools"},[e.state.currentactiontools[s.id][a]?[n("td",{attrs:{colspan:e.getColSpan(s)}},[n(e.state.currentactiontools[s.id][a],{tag:"component",attrs:{colspan:e.getColSpan(s),layer:s,feature:l,featureIndex:a,config:e.state.actiontools[e.state.currentactiontools[s.id][a].name][s.id]}})],1)]:e._e()],2),e._v(" "),e.hasLayerOneFeature(s)?e._e():n("tr",{staticStyle:{"font-weight":"bold","text-align":"center"}},[e._l(e.attributesSubset(s),function(u,h){return n("td",{staticClass:"centered"},[e._v(`
                            `+e._s(e.getLayerFeatureBox(s,l).collapsed?u.label:"")+`
                          `)])}),e._v(" "),n("td",{staticClass:"collapsed",class:{noAttributes:e.attributesSubset(s).length===0},staticStyle:{"text-align":"end"},on:{click:function(u){return u.stopPropagation(),e.toggleFeatureBoxAndZoom(s,l)}}},[n("span",{staticClass:"fa link morelink skin-color",class:e.g3wtemplate.font[e.getLayerFeatureBox(s,l).collapsed?"plus":"minus"]})])],2),e._v(" "),!e.hasLayerOneFeature(s)&&e.getLayerFeatureBox(s,l).collapsed?n("header-feature-body",{attrs:{actions:e.state.layersactions[s.id],layer:s,feature:l,index:a,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(s,l),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}):e._e(),e._v(" "),e._l(e.getLayerCustomComponents(s.id,"feature","before"),function(u){var h=u.component;return n("tr",[n("td",{attrs:{colspan:e.getColSpan(s)}},[n(h,{tag:"component",attrs:{layer:s,feature:l}})],1)])}),e._v(" "),n("tr",{directives:[{name:"show",rawName:"v-show",value:!e.collapsedFeatureBox(s,l)||e.hasOneLayerAndOneFeature(s),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:s.id+"_"+a}},[n("td",{attrs:{colspan:e.getColSpan(s),"feature-html-content":s.id+"_"+a}},[n("tabs",{attrs:{fields:e.getQueryFields(s,l),layerid:s.id,feature:l,tabs:e.getLayerFormStructure(s)}})],1)]),e._v(" "),e._l(e.getLayerCustomComponents(s.id,"feature","after"),function(u){var h=u.component;return n("tr",[n("td",{attrs:{colspan:e.getColSpan(s)}},[n(h,{tag:"component",attrs:{layer:s,feature:l}})],1)])})],2):e._e()}),0)]:[n("table",{staticClass:"table",class:{mobile:e.isMobile()}},e._l(s.features,function(l,a){return e.showFeature(s,l)?n("tbody",{key:l.id},[n("header-feature-actions-body",{attrs:{colspan:e.getColSpan(s),actions:e.state.layersactions[s.id],layer:s,feature:l,index:a,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(s,l),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}),e._v(" "),n("tr",{staticClass:"g3w-feature-result-action-tools"},[e.state.currentactiontools[s.id][a]?[n("td",{attrs:{colspan:e.getColSpan(s)}},[n(e.state.currentactiontools[s.id][a],{tag:"component",attrs:{colspan:e.getColSpan(s),layer:s,feature:l,featureIndex:a,config:e.state.actiontools[e.state.currentactiontools[s.id][a].name][s.id]}})],1)]:e._e()],2),e._v(" "),e.hasLayerOneFeature(s)?e._e():n("tr",{staticStyle:{"font-weight":"bold","text-align":"center"}},[e._l(e.attributesSubset(s),function(u,h){return n("td",{staticClass:"centered"},[e._v(`
                        `+e._s(e.getLayerFeatureBox(s,l).collapsed?u.label:"")+`
                      `)])}),e._v(" "),n("td",{staticClass:"collapsed",class:{noAttributes:e.attributesSubset(s).length===0},staticStyle:{"text-align":"end"},on:{click:function(u){return u.stopPropagation(),e.toggleFeatureBoxAndZoom(s,l)}}},[n("span",{staticClass:"fa link morelink skin-color",class:e.g3wtemplate.font[e.getLayerFeatureBox(s,l).collapsed?"plus":"minus"]})])],2),e._v(" "),!e.hasLayerOneFeature(s)&&e.getLayerFeatureBox(s,l).collapsed?n("header-feature-body",{attrs:{actions:e.state.layersactions[s.id],layer:s,feature:l,index:a,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(s,l),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}):e._e(),e._v(" "),e._l(e.getLayerCustomComponents(s.id,"feature","before"),function(u){var h=u.component;return n("tr",[n("td",{attrs:{colspan:e.getColSpan(s)}},[n(h,{tag:"component",staticClass:"box-body",attrs:{layer:s,feature:l}})],1)])}),e._v(" "),n("tr",{directives:[{name:"show",rawName:"v-show",value:!e.collapsedFeatureBox(s,l)||e.hasOneLayerAndOneFeature(s),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:s.id+"_"+a}},[n("td",{attrs:{colspan:e.getColSpan(s),"feature-html-content":s.id+"_"+a}},[n("table",{staticClass:"feature_attributes"},[e._l(s.attributes.filter(function(u){return u.show}),function(u){return[e.isJSON(e.getLayerField({layer:s,feature:l,fieldName:u.name}))?[e._l(e.getLayerField({layer:s,feature:l,fieldName:u.name}).value,function(h,p){var d;return e._l(typeof h=="object"?h:(d={},d[p]=h,d),function(_,m){return n("tr",{staticStyle:{"padding-top":"10px","padding-bottom":"10px"}},[n("td",{staticClass:"attr-label"},[e._v(e._s(u.label)+"."),typeof h=="object"?[e._v(e._s(p)+".")]:e._e(),e._v(e._s(m))],2),e._v(" "),n("td",{staticClass:"attr-value"},[e._v(e._s(_))])])})})]:n("tr",[n("td",{staticClass:"attr-label"},[e._v(e._s(u.label))]),e._v(" "),n("td",{staticClass:"attr-value",attrs:{attribute:u.name}},[n("table-attribute-field-value",{attrs:{feature:l,field:e.getLayerField({layer:s,feature:l,fieldName:u.name})}})],1)])]})],2)])]),e._v(" "),e._l(e.getLayerCustomComponents(s.id,"feature","after"),function(u){var h=u.component;return n("tr",[n("td",{attrs:{colspan:"getColSpan(layer)"}},[n(h,{tag:"component",staticClass:"box-body",attrs:{layer:s,feature:l}})],1)])})],2):e._e()}),0)]],2),e._v(" "),e._l(e.getLayerCustomComponents(s.id,"layer","after"),function(l){var a=l.component;return n("div",{staticClass:"box-body",class:{mobile:e.isMobile()}},[n(a,{tag:"component",attrs:{layer:s}})],1)})],2)],1)}),e._v(" "),e._l(e.state.components,function(s){return n("li",[n(s,{tag:"component",on:{showresults:function(o){return e.showResults()}}})],1)})],2):e._e()]:[e.state.changed?n("div",{staticClass:"query-results-not-found"},[n("h4",{directives:[{name:"t",rawName:"v-t",value:"info.no_results",expression:"'info.no_results'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","text-align":"center"}})]):e._e()]],2),e._v(" "),e.state.query?n("div",{staticStyle:{visibility:"hidden",position:"sticky",bottom:"-8px",background:"#eee",padding:"8px 0",display:"flex",gap:"1em"}},[n("label",{staticStyle:{"margin-top":"5px"}},[e._v(e._s(e.$t("Filter by:")))]),e._v(" "),n("select",{staticStyle:{flex:"1"}},[e._l(e.queryableLayers,function(s){return n("option",{domProps:{selected:s===e.selectedLayer}},[e._v(e._s(s.getName()))])}),e._v(" "),n("option",{domProps:{selected:!e.selectedLayer}},[e._v(e._s(e.$t("mapcontrols.queryby.all")))])],2)]):e._e()])},rae=[],oae=function(e){e&&e("data-v-0ef4a1f4_0",{source:".feature_attributes tr[data-v-0ef4a1f4]{line-height:1.8em}.featurebox-body+tr[data-v-0ef4a1f4]{border-top:2px groove #000}#g3w-queryresults-pagination[data-v-0ef4a1f4]{display:flex;justify-content:space-between;align-items:center;margin-top:15px;flex-wrap:wrap;margin-left:10px}#g3w-queryresults-pagination>ul>li>*[data-v-0ef4a1f4]{background-color:transparent;margin:2px;font-weight:700;font-size:.8em}",map:void 0,media:void 0})},aae="data-v-0ef4a1f4",lae=void 0,cae=!1;dae=uae({render:sae,staticRenderFns:rae},oae,iae,aae,cae,lae,!1,oS,void 0,void 0),hae=dae});var rP={};qn(rP,{default:()=>wae});function bae(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="Map.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function aS(){let e=aS.styles||(aS.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var fae,pae,gae,mae,_ae,yae,vae,xae,wae,oP=R(()=>{Ke();Ja();fae={name:"g3w-map",data(){let{service:e}=this.$options;return{target:this.$options.service.target,hidemaps:e.state.hidemaps,map_info:e.state.map_info,service:e,mouse:{visible:!0,switch_icon:!1,epsg_4326:!1,tooltip:null},urlCopied:!1,mapunit:F.map.unit}},computed:{version(){return"Powered by G3W-SUITE "+initConfig.version},showmapunits(){return this.service.state.mapunits.length>1}},methods:{onDrop(e){if(document.querySelector(".drop-area").toggleAttribute("hidden",e.type!=="dragenter"),e.dataTransfer.files&&e.type==="drop"){let t=GUI.getService("map"),n=document.querySelector.bind(document),s=async(l,a)=>{l="#modal-addlayer "+l,await vi(()=>n(l),1e3),n(l).value=a,n(l).dispatchEvent(new Event("input")),n(l).dispatchEvent(new Event("change"))};(async l=>{if(await vi(()=>!n("#add-layer-type").value,5e3),t.getLayerByName(l.name))return console.assert(!t.getLayerByName(l.name),`Unable to add layer: ${l.name}`);setTimeout(()=>console.assert(t.getLayerByName(l.name),`Unable to add layer: ${l.name}`),2500),await s("#add-layer-type","file"),await vi(()=>n('#addcustomlayer input[type="file"]'),1e3);let a=new DataTransfer;a.items.add(l),n('#addcustomlayer input[type="file"]').files=a.files,n('#addcustomlayer input[type="file"]').dispatchEvent(new Event("change")),$("#modal-addlayer").modal("show")})(e.dataTransfer.files[0])}},showEmbedModal(){document.querySelector(".nav-embedmap").click()},switchMapsCoordinateTo4326(){this.mouse.epsg_4326=!this.mouse.epsg_4326,this.service.getMapControlByType("mouseposition").dispatchEvent({type:"change:epsg",epsg:this.mouse.epsg_4326?"EPSG:4326":this.service.getEpsg()})}},watch:{mapunit(e){F.map.unit=e,this.service.changeScaleLineUnit(e)}},async mounted(){this.crs=this.service.getCrs(),await this.$nextTick(),this.service.onafter("addHideMap",async({ratio:e,layers:t=[],mainview:n=!1,switchable:s=!1}={})=>{await this.$nextTick(),this.service._addHideMap({ratio:e,layers:t,mainview:n,switchable:s})}),this.service.once("ready",()=>{this.service.getMapControlByType("mouseposition")?(this.mouse.switch_icon=this.service.getMapControlByType("mouseposition")&&this.service.getEpsg()!=="EPSG:4326",this.mouse.tooltip=`ESPG ${this.service.getCrs().split(":")[1]} \u2194 WGS84`):this.mouse.visible=!1})},destroyed(){this.service.clear()}},pae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"g3w-maps"}},[e._l(e.hidemaps,function(s){return n("div",{key:s.id,staticClass:"g3w-map hidemap",attrs:{id:s.id}})}),e._v(" "),n("div",{staticClass:"g3w-map",attrs:{id:e.target},on:{drop:function(s){return s.preventDefault(),e.onDrop.apply(null,arguments)},dragenter:function(s){return s.preventDefault(),e.onDrop.apply(null,arguments)},dragleave:function(s){return s.preventDefault(),e.onDrop.apply(null,arguments)},dragover:function(s){s.preventDefault()}}},[n("div",{staticClass:"drop-area",attrs:{hidden:""}},[e._v(`
      Upload Files
    `)]),e._v(" "),n("div",{ref:"g3w-map-controls",staticClass:"g3w-map-controls rv",staticStyle:{display:"flex"}}),e._v(" "),e.map_info.info?n("div",{ref:"g3w-map-info",style:e.map_info.style,attrs:{id:"g3w-map-info"}},[e._v(`
      `+e._s(e.map_info.info)+`
    `)]):e._e(),e._v(" "),e._m(0),e._v(" "),n("div",{staticClass:"g3w-map-controls-left-bottom"})]),e._v(" "),n("div",{staticClass:"skin-border-color",attrs:{id:"map_footer"}},[n("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_left"}},[n("a",{staticStyle:{"margin-left":"5px","align-self":"center"},attrs:{href:"https://g3wsuite.it/",target:"_blank",title:e.version}},[n("img",{attrs:{height:"15",src:"/static/client/images/g3wsuite_logo.png",alt:""}})])]),e._v(" "),n("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_right"}},[e.mouse.visible&&e.mouse.switch_icon&&!e.isMobile()?n("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:e.mouse.tooltip,expression:"mouse.tooltip",arg:"top"}],attrs:{id:"switch-mouse-coordinate"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.switchMapsCoordinateTo4326.apply(null,arguments)}}},[n("span",{staticClass:"skin-color-dark",class:e.$fa("mouse"),staticStyle:{"caret-color":"rgba(0,0,0,0)"}})]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.mouse.visible,expression:"mouse.visible"}],attrs:{id:"mouse-position-control"}}),e._v(" "),n("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"Copy share URL",expression:"'Copy share URL'",arg:"top"}],class:e.$fa("share-alt")+" skin-color-dark",attrs:{id:"permalink"},on:{click:function(s){return s.stopPropagation(),e.showEmbedModal.apply(null,arguments)}}}),e._v(" "),n("div",{attrs:{id:"scale-control"}}),e._v(" "),e.showmapunits?n("div",{attrs:{id:"scale-line-units"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.mapunit,expression:"mapunit"}],staticClass:"skin-color-dark",staticStyle:{padding:"5px 2px","font-weight":"bold",border:"0",cursor:"pointer"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.mapunit=s.target.multiple?o:o[0]}}},e._l(e.service.state.mapunits,function(s){return n("option",{directives:[{name:"t",rawName:"v-t",value:"scaleline_units."+s,expression:"`scaleline_units.${unit}`"}],staticStyle:{"font-weight":"bold"},domProps:{value:s,selected:e.mapunit===s}})}),0)]):e._e()])])],2)},gae=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"none"}},[n("div",{attrs:{id:"marker"}})])}],mae=function(e){e&&e("data-v-5a771db7_0",{source:'#marker[data-v-5a771db7]{width:15px;height:15px;border:2px solid #ff0;border-radius:10px;background-color:#ff0;opacity:.8}.g3w-map-controls-left-bottom[data-v-5a771db7]{position:absolute;bottom:75px;left:10px;z-index:1}#g3w-map-info[data-v-5a771db7]{position:absolute;top:60px;left:5px;font-weight:700;z-index:100;background:rgba(255,255,255,.6);padding:5px;border-radius:3px}#g3w-maps[data-v-5a771db7]{position:relative;width:100%;height:100%}.g3w-map[data-v-5a771db7]{position:absolute;width:100%;height:100%}.g3w-map.show[data-v-5a771db7]{display:block}.g3w-map.hide[data-v-5a771db7]{display:none}#map_footer[data-v-5a771db7]{position:absolute;bottom:0;height:30px;width:100%;display:flex;justify-content:space-between;background-color:rgba(255,255,255,.7)}#permalink[data-v-5a771db7]{font-weight:700;font-size:1.2em;padding:8px 5px 0 5px;cursor:pointer;background-color:#eee}#switch-mouse-coordinate[data-v-5a771db7]{display:flex;height:100%;margin-left:8px;align-items:center;cursor:pointer}#switch-mouse-coordinate span[data-v-5a771db7]{padding:3px 5px 0 3px}#map_footer_right[data-v-5a771db7]{flex-shrink:0}.drop-area[data-v-5a771db7]:not([hidden]){display:flex}.drop-area[data-v-5a771db7]{justify-content:center;align-items:center;width:100%;height:100%;color:#fff;font-size:4em;position:absolute;z-index:100;background-color:var(--bgcolor);pointer-events:none}.drop-area[data-v-5a771db7]::before{border:5px dashed #fff;content:"";bottom:60px;left:60px;position:absolute;right:60px;top:60px}',map:void 0,media:void 0})},_ae="data-v-5a771db7",yae=void 0,vae=!1;xae=bae({render:pae,staticRenderFns:gae},mae,fae,_ae,vae,yae,!1,aS,void 0,void 0),wae=xae});ft();Ke();Hl();Wy();Yy();Xy();ft();function XS(e){switch(e){case fe.LINESTRINGZ:case fe.LINESTRINGM:case fe.LINESTRINGZM:case fe.LINESTRING25D:case fe.LINE:case fe.LINEZ:case fe.LINEM:case fe.LINEZM:case fe.LINE25D:return"LineString";case fe.MULTILINESTRINGZ:case fe.MULTILINESTRINGM:case fe.MULTILINESTRINGZM:case fe.MULTILINESTRING25D:case fe.MULTILINE:case fe.MULTILINEZ:case fe.MULTILINEM:case fe.MULTILINEZM:case fe.MULTILINE25D:return"MultiLineString";case fe.POINT:case fe.POINTZ:case fe.POINTM:case fe.POINTZM:case fe.POINT25D:return"Point";case fe.MULTIPOINT:case fe.MULTIPOINTZ:case fe.MULTIPOINTM:case fe.MULTIPOINTZM:case fe.MULTIPOINT25D:return"MultiPoint";case fe.POLYGON:case fe.POLYGONZ:case fe.POLYGONM:case fe.POLYGONZM:case fe.POLYGON25D:return"Polygon";case fe.MULTIPOLYGON:case fe.MULTIPOLYGONZ:case fe.MULTIPOLYGONM:case fe.MULTIPOLYGONZM:case fe.MULTIPOLYGON25D:return"MultiPolygon";default:return console.warn("invalid geometry type: ",e),e}}xp();wp();ud();dd();var cI=Ut(Sp());D0();var eI,K2=()=>new DecompressionStream("deflate-raw");try{K2(),eI=async e=>{let t=K2(),n=t.writable.getWriter(),s=t.readable.getReader(),o,l=[],a=0,u=0,h;for(n.write(e),n.close();!(h=await s.read()).done;)o=h.value,l.push(o),a+=o.length;return!l[1]&&o||(o=new Uint8Array(a),l.map(p=>(o.set(p,u),u+=p.length))),o}}catch{}var QD=new TextDecoder,G0=e=>{throw new Error("but-unzip~"+e)},J2=e=>QD.decode(e);function*tI(e,t=eI){let n=e.length-20,s=Math.max(n-65516,2);for(;(n=e.lastIndexOf(80,n-1))!==-1&&!(e[n+1]===75&&e[n+2]===5&&e[n+3]===6)&&n>s;);n===-1&&G0(2);let o=(p,d)=>e.subarray(n+=p,n+=d),l=new DataView(e.buffer,e.byteOffset),a=p=>l.getUint16(p+n,!0),u=p=>l.getUint32(p+n,!0),h=a(10);for(h!==a(8)&&G0(3),n=u(16);h--;){let p=a(10),d=a(30),_=a(32),m=u(20),v=u(42),x=J2(o(46,a(28))),b=J2(o(d,_)),w=n,L;n=v,L=o(30+a(26)+a(28),m),yield{filename:x,comment:b,read:()=>p&8?t(L):p?G0(1):L},n=w}}var KD=/.+\.(shp|dbf|json|prj|cpg)$/i,nI=async e=>{let t={},n=[];for(let l of tI(e))KD.test(l.filename)&&n.push(Promise.resolve(l.read()).then(a=>t[l.filename]=a));await Promise.all(n);let s={},o=new TextDecoder;for(let[l,a]of Object.entries(t))l.slice(-3).toLowerCase()==="shp"||l.slice(-3).toLowerCase()==="dbf"?s[l]=new DataView(a.buffer,a.byteOffset,a.byteLength):s[l]=o.decode(a);return s};var JD=globalThis.URL,iI=(e,t)=>{if(!t)return e;let n=new JD(e);return n.pathname=`${n.pathname}.${t}`,n.href};async function Ha(e,t){let n=iI(e,t),s=t==="prj"||t==="cpg";try{let o=await fetch(n);if(o.status>399)throw new Error(o.statusText);if(s)return o.text();let l=await o.arrayBuffer();return new DataView(l)}catch(o){if(s||t==="dbf")return!1;throw o}}function eG(e){let t=0,n=1,s=e.length,o,l,a=[e[0][0],e[0][1],e[0][0],e[0][1]];for(;n<s;)o=l||e[0],l=e[n],t+=(l[0]-o[0])*(l[1]+o[1]),n++,l[0]<a[0]&&(a[0]=l[0]),l[1]<a[1]&&(a[1]=l[1]),l[0]>a[2]&&(a[2]=l[0]),l[1]>a[3]&&(a[3]=l[1]);return{ring:e,clockWise:t>0,bbox:a,children:[]}}function tG(e,t){return!(e.bbox[0]>t.bbox[0]||e.bbox[1]>t.bbox[1]||e.bbox[2]<t.bbox[2]||e.bbox[3]<t.bbox[3])}function nG(e){let t=[],n=[];for(let o of e){let l=eG(o);l.clockWise?t.push(l):n.push(l)}for(let o of n)for(let l of t)if(tG(l,o)){l.children.push(o.ring);break}let s=[];for(let o of t)s.push([o.ring].concat(o.children));return s}Cn.prototype.parsePoint=function(e){return{type:"Point",coordinates:this.parseCoord(e,0)}};Cn.prototype.parseZPoint=function(e){let t=this.parsePoint(e);return t.coordinates.push(e.getFloat64(16,!0)),t};Cn.prototype.parsePointArray=function(e,t,n){let s=[],o=0;for(;o<n;)s.push(this.parseCoord(e,t)),t+=16,o++;return s};Cn.prototype.parseZPointArray=function(e,t,n,s){let o=0;for(;o<n;)s[o].push(e.getFloat64(t,!0)),o++,t+=8;return s};Cn.prototype.parseArrayGroup=function(e,t,n,s,o){let l=[],a=0,u,h=0,p;for(;a<s;)a++,n+=4,u=h,a===s?h=o:h=e.getInt32(n,!0),p=h-u,p&&(l.push(this.parsePointArray(e,t,p)),t+=p<<4);return l};Cn.prototype.parseZArrayGroup=function(e,t,n,s){let o=0;for(;o<n;)s[o]=this.parseZPointArray(e,t,s[o].length,s[o]),t+=s[o].length<<3,o++;return s};Cn.prototype.parseMultiPoint=function(e){let t={},n=e.getInt32(32,!0);if(!n)return null;let s=this.parseCoord(e,0),o=this.parseCoord(e,16);t.bbox=[s[0],s[1],o[0],o[1]];let l=36;return n===1?(t.type="Point",t.coordinates=this.parseCoord(e,l)):(t.type="MultiPoint",t.coordinates=this.parsePointArray(e,l,n)),t};Cn.prototype.parseZMultiPoint=function(e){let t=this.parseMultiPoint(e);if(!t)return null;let n;if(t.type==="Point")return t.coordinates.push(e.getFloat64(72,!0)),t;n=t.coordinates.length;let s=52+(n<<4);return t.coordinates=this.parseZPointArray(e,s,n,t.coordinates),t};Cn.prototype.parsePolyline=function(e){let t={},n=e.getInt32(32,!0);if(!n)return null;let s=this.parseCoord(e,0),o=this.parseCoord(e,16);t.bbox=[s[0],s[1],o[0],o[1]];let l=e.getInt32(36,!0),a,u;return n===1?(t.type="LineString",a=44,t.coordinates=this.parsePointArray(e,a,l)):(t.type="MultiLineString",a=40+(n<<2),u=40,t.coordinates=this.parseArrayGroup(e,a,u,n,l)),t};Cn.prototype.parseZPolyline=function(e){let t=this.parsePolyline(e);if(!t)return null;let n=t.coordinates.length,s;return t.type==="LineString"?(s=60+(n<<4),t.coordinates=this.parseZPointArray(e,s,n,t.coordinates),t):(s=56+(t.coordinates.reduce(function(l,a){return l+a.length},0)<<4)+(n<<2),t.coordinates=this.parseZArrayGroup(e,s,n,t.coordinates),t)};Cn.prototype.polyFuncs=function(e){return e&&(e.type==="LineString"?(e.type="Polygon",e.coordinates=[e.coordinates],e):(e.coordinates=nG(e.coordinates),e.coordinates.length===1?(e.type="Polygon",e.coordinates=e.coordinates[0],e):(e.type="MultiPolygon",e)))};Cn.prototype.parsePolygon=function(e){return this.polyFuncs(this.parsePolyline(e))};Cn.prototype.parseZPolygon=function(e){return this.polyFuncs(this.parseZPolyline(e))};var sI={1:"parsePoint",3:"parsePolyline",5:"parsePolygon",8:"parseMultiPoint",11:"parseZPoint",13:"parseZPolyline",15:"parseZPolygon",18:"parseZMultiPoint"};function iG(e){return e?function(t,n){let s=[t.getFloat64(n,!0),t.getFloat64(n+8,!0)];return e.inverse(s)}:function(t,n){return[t.getFloat64(n,!0),t.getFloat64(n+8,!0)]}}function Cn(e,t){if(!(this instanceof Cn))return new Cn(e,t);this.buffer=e,this.headers=this.parseHeader(),this.shpFuncs(t),this.rows=this.getRows()}Cn.prototype.shpFuncs=function(e){let t=this.headers.shpCode;if(t>20&&(t-=20),!(t in sI))throw new Error(`I don't know shp type "${t}"`);this.parseFunc=this[sI[t]],this.parseCoord=iG(e)};Cn.prototype.getShpCode=function(){return this.parseHeader().shpCode};Cn.prototype.parseHeader=function(){let e=this.buffer;return{length:e.getInt32(24)<<1,version:e.getInt32(28,!0),shpCode:e.getInt32(32,!0),bbox:[e.getFloat64(36,!0),e.getFloat64(44,!0),e.getFloat64(52,!0),e.getFloat64(60,!0)]}};Cn.prototype.getRows=function(){let e=100,t=this.buffer.byteLength-8,n=[],s;for(;e<=t&&(s=this.getRow(e),!!s);)e+=8,e+=s.len,s.type?n.push(this.parseFunc(s.data)):n.push(null);return n};Cn.prototype.getRow=function(e){let t=this.buffer.getInt32(e),n=this.buffer.getInt32(e+4)<<1;if(n===0)return{id:t,len:n,type:0};if(!(e+n+8>this.buffer.byteLength))return{id:t,len:n,data:new DataView(this.buffer.buffer,this.buffer.byteOffset+e+12,n-4),type:this.buffer.getInt32(e+8,!0)}};function Yp(e,t){return new Cn(e,t).rows}var sG=/^(?:ANSI\s)?(\d+)$/m;function j0(e,t){if(!e)return s;try{new TextDecoder(e.trim())}catch{var n=sG.exec(e);return n&&!t?j0("windows-"+n[1],!0):(e=void 0,s)}return s;function s(o){var l=new TextDecoder(e||void 0),a=l.decode(o,{stream:!0})+l.decode();return a.replace(/\0/g,"").trim()}}function rG(e){var t={};return t.lastUpdated=new Date(e.getUint8(1)+1900,e.getUint8(2),e.getUint8(3)),t.records=e.getUint32(4,!0),t.headerLen=e.getUint16(8,!0),t.recLen=e.getUint16(10,!0),t}function oG(e,t,n){for(var s=[],o=32;o<t&&(s.push({name:n(new Uint8Array(e.buffer.slice(e.byteOffset+o,e.byteOffset+o+11))),dataType:String.fromCharCode(e.getUint8(o+11)),len:e.getUint8(o+16),decimal:e.getUint8(o+17)}),e.getUint8(o+32)!==13);)o+=32;return s}function aG(e,t,n,s,o){let l=new Uint8Array(e.buffer.slice(e.byteOffset+t,e.byteOffset+t+n));var a=o(l);switch(s){case"N":case"F":case"O":return parseFloat(a,10);case"D":return new Date(a.slice(0,4),parseInt(a.slice(4,6),10)-1,a.slice(6,8));case"L":return a.toLowerCase()==="y"||a.toLowerCase()==="t";default:return a}}function lG(e,t,n,s){for(var o={},l=0,a=n.length,u,h;l<a;)h=n[l],u=aG(e,t,h.len,h.dataType,s),t+=h.len,typeof u<"u"&&(o[h.name]=u),l++;return o}function Xp(e,t){for(var n=j0(t),s=rG(e),o=oG(e,s.headerLen-1,n),l=(o.length+1<<5)+2,a=s.recLen,u=s.records,h=[];u;)h.push(lG(e,l,o,n)),l+=a,u--;return h}var cG=globalThis.URL,uG=e=>{if(!e)throw new Error("forgot to pass buffer");if(ac(e))return new Uint8Array(e);if(ac(e.buffer))return e.BYTES_PER_ELEMENT===1?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("invalid buffer like object")},dG=new TextDecoder,oI=e=>{if(e){if(typeof e=="string")return e;if(ac(e)||ArrayBuffer.isView(e)||q0(e))return dG.decode(e)}},aI=e=>{if(!e)throw new Error("forgot to pass buffer");if(q0(e))return e;if(ac(e))return new DataView(e);if(ac(e.buffer))return new DataView(e.buffer,e.byteOffset,e.byteLength);throw new Error("invalid buffer like object")};function ac(e){return e instanceof globalThis.ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]"}function q0(e){return e instanceof globalThis.DataView||Object.prototype.toString.call(e)==="[object DataView]"}var $0=function([e,t]){let n={};n.type="FeatureCollection",n.features=[];let s=0,o=e.length;for(t||(t=[]);s<o;)n.features.push({type:"Feature",geometry:e[s],properties:t[s]||{}}),s++;return n},lI=async function(e,t){let n;e=uG(e);let s=await nI(e),o=[];t=t||[];for(n in s)n.indexOf("__MACOSX")===-1&&(n.slice(-4).toLowerCase()===".shp"?(o.push(n.slice(0,-4)),s[n.slice(0,-3)+n.slice(-3).toLowerCase()]=s[n]):n.slice(-4).toLowerCase()===".prj"?s[n.slice(0,-3)+n.slice(-3).toLowerCase()]=zo(s[n]):n.slice(-5).toLowerCase()===".json"||t.indexOf(n.split(".").pop())>-1?o.push(n.slice(0,-3)+n.slice(-3).toLowerCase()):(n.slice(-4).toLowerCase()===".dbf"||n.slice(-4).toLowerCase()===".cpg")&&(s[n.slice(0,-3)+n.slice(-3).toLowerCase()]=s[n]));if(!o.length)throw new Error("no layers founds");let l=o.map(function(a){let u,h,p=a.lastIndexOf(".");return p>-1&&a.slice(p).indexOf("json")>-1?(u=JSON.parse(s[a]),u.fileName=a.slice(0,p)):t.indexOf(a.slice(p+1))>-1?(u=s[a],u.fileName=a):(s[a+".dbf"]&&(h=Xp(s[a+".dbf"],s[a+".cpg"])),u=$0([Yp(s[a+".shp"],s[a+".prj"]),h]),u.fileName=a),u});return l.length===1?l[0]:l};async function hG(e,t){let n=await Ha(e);return lI(n,t)}var fG=async e=>{let t=await Promise.all([Ha(e,"shp"),Ha(e,"prj")]),n=!1;try{t[1]&&(n=zo(t[1]))}catch{n=!1}return Yp(t[0],n)},pG=async e=>{let[t,n]=await Promise.all([Ha(e,"dbf"),Ha(e,"cpg")]);if(t)return Xp(t,n)},rI=(e,t)=>new cG(e,globalThis?.document?.location).pathname.slice(-4).toLowerCase()===t,gG=({shp:e,dbf:t,cpg:n,prj:s})=>{let o=[_G(e,s)];return t&&o.push(yG(t,n)),$0(o)},mG=async function(e,t){if(typeof e!="string"){if(ac(e)||ArrayBuffer.isView(e)||q0(e))return lI(e);if(e.shp)return gG(e);throw new TypeError("must be a string, some sort of Buffer, or an object with at least a .shp property")}if(rI(e,".zip"))return hG(e,t);rI(e,".shp")&&(e=e.slice(0,-4));let n=await Promise.all([fG(e),pG(e)]);return $0(n)},_G=function(e,t){if(e=aI(e),t=oI(t),typeof t=="string")try{t=zo(t)}catch{t=!1}return Yp(e,t)},yG=function(e,t){return e=aI(e),t=oI(t),Xp(e,t)},Zp=mG;ft();Wt();async function uI({name:e,type:t,crs:n,mapCrs:s,data:o,style:l}={}){let a=[],u=["zip","kml","kmz"].includes(t)?"EPSG:4326":n,h=[];if(t==="zip"&&(o=JSON.stringify(await Zp(await o.arrayBuffer(o)))),t==="kmz"){let p=new cI.default;p.load(await o.arrayBuffer(o)),o=p.file(/.kml$/i).at(-1).asText()}return t==="csv"&&o.values.forEach((p,d)=>{let _={},m=p.split(o.separator);if(m.length!==o.headers.length)return a.push({row:d+1,value:o.values[d]});let v=[];if(m.forEach((x,b)=>{o.headers[b]===o.x&&(v[0]=1*x),o.headers[b]===o.y&&(v[1]=1*x),_[o.headers[b]]=x}),v.every(x=>!Number.isNaN(x))){let x=new ol.Feature(new ol.geom.Point(v).transform(n,s));x.setId(d),x.setProperties(_),h.push(x)}}),t!=="csv"&&(h={gpx:new ol.format.GPX,gml:new ol.format.WMSGetFeatureInfo,geojson:new ol.format.GeoJSON,zip:new ol.format.GeoJSON,kml:new ol.format.KML({extractStyles:!1}),kmz:new ol.format.KML({extractStyles:!1})}[t].readFeatures(o,{dataProjection:u,featureProjection:s||u})),["kml","kmz"].includes(t)&&h.forEach(p=>p.unset("styleUrl")),a.length&&GUI.showUserMessage({type:"warning",message:"The result in the map is partial due to the presence of the below incorrect records list:",hooks:{footer:{template:`<select v-select2="errors[0].value" class="skin-color" :search="false" style="width:100%">
            <option v-for="e in errors" :key="e.row" :value="e.value">[{{ e.row}}] {{e.value}}</option>
          </select>`,data:()=>({errors:a})}}}),h.length?new ol.layer.Vector({source:new ol.source.Vector({features:h}),name:e,_fields:t==="csv"?o.headers:Object.keys(h[0].getProperties()).filter(p=>ur.indexOf(p)<0),id:Qe(),style:l}):Promise.reject()}B0();lc();lu();function n4(e=[],t=[]){return e[0]===t[0]&&e[1]===t[1]}xp();dd();ud();Uh();function tw({feature:e,splitfeature:t}={}){let n={feature:e.getGeometry(),split:t.getGeometry()};if(n.split.getType()!=="LineString")return[];let s=[],o=new jsts.io.OL3Parser;o.inject(ol.geom.Point,ol.geom.LineString,ol.geom.LinearRing,ol.geom.Polygon,ol.geom.MultiPoint,ol.geom.MultiLineString,ol.geom.MultiPolygon);let l=jo(n.feature.getType()),a=qo(n.feature.getType()),u=$o(n.feature.getType()),h=u&&(l?n.feature.getPolygons():n.feature),p=a&&(l?n.feature.getLineStrings():n.feature);if(l&&(a||u)){let d=u?ol.geom.MultiPolygon:ol.geom.MultiLineString;(u?h:p).forEach(_=>{let m=tw({splitfeature:t,feature:new ol.Feature({geometry:_})});m.length>0?m.forEach(v=>v&&s.push(new d([v.getCoordinates()]))):s.push(new d([_.getCoordinates()]))})}if(u&&!l){let d=h.getCoordinates()[0][0][2]!==void 0,_=o.read(h),m=o.read(h.getLinearRing(0)),v=o.read(n.split),x;if(h.getLinearRingCount()>1){let D;for(let W=1;W<h.getLinearRingCount();W++){let P=o.read(h.getLinearRing(W));D=D===void 0?P:D.union(P)}x=new jsts.operation.polygonize.Polygonizer,x.add(D);let G;x.getPolygons().toArray().forEach(W=>G=G===void 0?W:G.union(W)),x=G}d&&(h.getCoordinates()[0].forEach((D,G)=>m.getCoordinates()[G].z=D[2]),v.getCoordinates().forEach(D=>D.z=0));let b=m.union(v),w=new jsts.operation.polygonize.Polygonizer;w.add(b);let L=w.getPolygons().toArray();L.length>1&&L.forEach(D=>{if(x&&(D=D.difference(x)),_.intersects(D.getInteriorPoint())){let G=o.write(D),W=D.getCoordinates();if(d){W.forEach((V,H)=>V.z=V.z===void 0?W[H===0?H+1:H-1].z:V.z);let j=[];G.getCoordinates()[0].forEach((V,H)=>{V.push(W[H].z),j.push(V)}),G.setCoordinates([j])}let P=!jo(G.getType());l?s.push(new ol.geom.MultiPolygon(P?[G.getCoordinates()]:G.getCoordinates())):P?s.push(G):G.getCoordinates().forEach(j=>s.push(new ol.geom.Polygon(j)))}})}if(a&&!l){let d=n.split,_=n.feature,m=_.getCoordinates()[0][2]!==void 0,v=!1,x=[],b=new jsts.io.WKTReader,w=new ol.format.WKT,L=new jsts.io.OL3Parser;L.inject(ol.geom.Point,ol.geom.LineString,ol.geom.LinearRing,ol.geom.Polygon,ol.geom.MultiPoint,ol.geom.MultiLineString,ol.geom.MultiPolygon);let D=b.read(w.writeGeometry(d)),G=w.writeGeometry(_);m&&(G=G.replace(" Z",""));let P=b.read(G).getCoordinates(),j=new jsts.geom.GeometryFactory,V=[],H,se;for(let ie=0;ie<P.length-1;ie++){se=P[ie],H=P[ie+1],m&&(se.z=_.getCoordinates()[ie][2],H.z=_.getCoordinates()[ie+1][2]);let X=j.createLineString([se,H]).intersection(D).getCoordinates();v=v||X.length>0,X.forEach(K=>{m&&(K.z=se.z);let te=L.write(j.createLineString((V.length?V:[]).concat([se,K])));if(m){let Ge=te.getCoordinates();te.setCoordinates([[...Ge[0],se.z],[...Ge[1],K.z]])}V.length&&(V=[]),x.push(te),se=K}),V=V.concat([se,H])}let M=L.write(j.createLineString(V));return m&&M.setCoordinates(V.map((ie,E)=>{let X=M.getCoordinates()[E];return X.push(ie.z),X})),x.push(M),v?x:[]}return s}D1();nw();iw();Ja();Uh();function d4({features:e=[],index:t=0,clone:n=!1}={}){let s=new jsts.io.OL3Parser,o=e.length;if(o===0)return null;if(o===1)return e[0];let l,a=n?e[t].clone():e[t],u=a.getGeometry(),h=u.getType();if(h==="LineString"){let m=new jsts.operation.linemerge.LineMerger;for(let x=0;x<o;x++)m.addLineString(new jsts.geom.GeometryFactory().createLineString(s.read(e[x].getGeometry()).getCoordinates()));let v=m.getMergedLineStrings();l=v.size()===1?v.toArray()[0]:null}if(h!=="LineString"){l=s.read(u);for(let m=0;m<o;m++)t!==m&&(l=l.union(s.read(e[m].getGeometry())))}if(!l)return null;let p=s.write(l),d=p.getType(),_=d===h?p.getCoordinates():h.indexOf("Multi")!==-1&&d===h.replace("Multi","")?[p.getCoordinates()]:null;return _===null?null:(a.getGeometry().setCoordinates(_),a)}function h4(e,t){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}k1();R1();fv();function f4(e){return window.initConfig.projects.find(t=>e===t.gid)}lg();i_();Zm();T1();ei();cc();ii();var p4=new class{constructor(){this.tasks=[]}async runTask(t={}){let{method:n="GET",params:s={},url:o,taskUrl:l,interval:a=1e3,timeout:u=1/0,listener:h=()=>{}}=t;try{let p=n==="GET"?await Ye.get({url:o,params:s}):await Ye.post({url:o,data:s.data||{},contentType:s.contentType||"application/json"}),{result:d,task_id:_}=p;if(d){let m=setInterval(async()=>{if(u=u-a,u>0){let v;try{v=await Ye.get({url:`${l}${_}`})}catch(x){v=x,console.warn(x)}h({task_id:_,timeout:!1,response:v})}else h({timeout:!0}),this.stopTask({task_id:_})},a);this.tasks.push({task_id:_,intervalId:m}),h({task_id:_,response:p})}else return Promise.reject(p)}catch(p){return console.warn(p),Promise.reject(p)}}stopTask(t={}){let n=this.tasks.find(s=>t.task_id===s.task_id);n&&clearInterval(n.intervalId)}clear(){this.tasks.forEach(({taskId:t})=>this.stopTask({taskId:t})),this.tasks.splice(0)}};ze();$1();us();ya();qh();su();Ym();$i();vn();Ka();Ws();c1();_l();z1();bl();t_();fu();Oh();B1();Wt();function g4(e,t){console.warn("[G3W-CLIENT] g3wsdk.core.utils.inherit is deprecated"),console.trace();function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e}vn();function m4(e){console.warn("[G3W-CLIENT] g3wsdk.core.utils.base is deprecated"),console.trace();let t=arguments.callee.caller;if(t.superClass_)return t.superClass_.constructor.name==="Function"?t.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1)):arguments.length===1?Object.assign(e,Reflect.construct(t.superClass_.constructor,arguments,e.constructor)):Object.assign(e,Reflect.construct(t.superClass_.constructor,Array.prototype.slice.call(arguments,1),e.constructor));let n=!1;for(let s=e.constructor;s;s=s.superClass_?.constructor)if(s.prototype[arguments[1]]===t)n=!0;else if(n)return s.prototype[arguments[1]].apply(e,Array.prototype.slice.call(arguments,2));if(e[arguments[1]]===t)return e.constructor.prototype[arguments[1]].apply(e,Array.prototype.slice.call(arguments,2));throw Error("base called from a method of one name to a method of a different name")}Vl();Xr();dr();Us();ii();sw();Xt();o_();Rt();vn();Ws();Ke();cc();ze();Xr();Rt();var _4=Ut(Qa()),uee=1e4,c_=class extends nt{constructor({name:t=null,config:n=F.pluginsConfigs[t],service:s=null,dependencies:o=[],i18n:l=null,fontClasses:a=[],api:u={}}={}){super(),this.setName(t),this.setConfig(n),this.setLocale(l),this.setService(s),this.setDependencies(o),this.addFontClasses(a),this.setApi(u),this.setHookService(null),this._ready=!1,this.hookservices={search:T.getService("search"),tools:T.getService("tools")},this._timeout=setTimeout(()=>{F.plugins=F.plugins.filter(h=>this.name!==h),this.name&&delete F.gui.layout[this.name]},uee)}setName(t){this.name=t}getName(){return this.name}setConfig(t){this.config=Zn(t)==="Object"?t:null}getConfig(t){return this.config||F.pluginsConfigs[t||this.name]}registerLocale(t,n){_e.register(t,n)}setLocale(t){if(t&&this.name)for(let n in t)_e.register(n,{plugins:{[this.name]:t[n]}})}setService(t){this.service=t,t&&t.setPlugin(this)}getService(){return this.service}setDependencies(t=[]){this.dependencies=t}setApi(t={}){this._api=t,t.getConfig=this._api.getConfig}getApi(){return this._api}setHookService(t){this._hook=t}getHookService(t="tools"){return this.hookservices[t]}setLayout(t){t=t!==void 0?t:(0,_4.default)(F.gui.layout.app);let n=t.rightpanel||{width:50,height:50,width_100:!1,height_100:!1};t.rightpanel=Object.assign(n,{width:t.rightpanel.width||n.width,height:t.rightpanel.height||n.width,width_100:!1,height_100:!1}),F.gui.layout[this.name]=t}setCurrentLayout(){F.gui.layout.__current=this.name}setReady(t){this._ready=t,this._ready&&this.setLayout(),this.emit("set-ready",t,this.name),setTimeout(()=>{clearTimeout(this._timeout),F.plugins=F.plugins.filter(n=>this.name!==n)},0)}isReady(){return new Promise(t=>{this._ready?t(this._ready):this.once("set-ready",n=>{this._ready=n,t(this._ready)})})}isCurrentProjectCompatible(t){return t===F.project.getGid()}registerPlugin(t){let n=this.isCurrentProjectCompatible(t);return n?qi.registerPlugin(this):(F.plugins=F.plugins.filter(s=>this.name!==s),clearTimeout(this._timeout)),n}getDependencyPlugins(t){return this.dependencies=t||this.dependencies,Promise.all(this.dependencies.map(n=>this.getDependencyPlugin(n)))}async getDependencyPluginsObject(t){let n={},s=await this.getDependencyPlugins(t);return this.dependencies.forEach((o,l)=>n[o]=s[l]),n}getDependencyPlugin(t){return F.pluginsConfigs[t]?new Promise(n=>{let s=qi.getPlugin(t);s&&s.isReady().then(()=>n(s.getApi()))||qi.onafter("registerPlugin",o=>{t===o.name&&o.isReady().then(()=>n(o.getApi()))})}):Promise.reject({error:"no plugin"})}setHookLoading({hook:t="tools",loading:n=!1}={}){this.getHookService(t).setLoading(n)}addToolGroup({hook:t="tools",position:n,title:s}={}){this.getHookService(t).addToolGroup(n,s)}removeToolGroup({hook:t,group:n}={}){this.getHookService(t).removeToolGroup(n.title)}addTools(t,n){let s=t.hook||"tools",o=[];return!t.action&&!t.type?this.removeToolGroup({hook:s,group:n}):(this.setHookService(s),o=(this.config.configs||[this.config]).map(l=>({icon:t.icon,type:t.type,name:l.name||t.name,html:t.html,options:t.options||{},action:t.action&&t.action.bind(this,l),loading:t.loading!==void 0?t.loading:!1,disabled:t.disabled!==void 0?t.disabled:!1,offline:t.offline!==void 0?t.offline:!0,state:t.state!==void 0?t.state:{type:null,message:null}})),this.getHookService(s).addTools(o,n)),o}setToolState({id:t,state:n={type:null,message:null}}={}){this.hookservices[this._hook].state.toolsGroups.find(s=>{let o=s.tools.find(l=>l.name===t);if(o)return o.state.type=n.type,o.state.message=n.message,!0})}removeTools(){this.hookservices[this._hook].removeTools()}createSideBarComponent(t,n={}){return n.vueComponentObject=t,n.collapsible=n.collapsible??!0,n.mobile=n.mobile??!0,n.sidebarOptions=n.sidebarOptions??{position:1},T.addComponent(new pt(n),"sidebar",n.sidebarOptions),this.once("unload",()=>T.removeComponent(n.id,"sidebar",n.sidebarOptions)),T.getComponent(n.id)}unload(){this.service&&this.service.clearAllEvents(),this.emit("unload")}load(){}getProject(){return F.project}addDependency(t){this.dependencies.push(t)}addFontClass({name:t,className:n}){Vue.prototype.g3wtemplate.addFontClass({name:t,className:n})}addFontClasses(t=[]){t.forEach(n=>this.addFontClass(n))}},u_=class extends nt{constructor(t={}){super(t),this.plugin,this._api={own:null,dependencies:{}},this._pluginEvents={},this._appEvents=[],this.currentLayout=F.gui.layout.__current,this.vm=new Vue,this.unwatch=this.vm.$watch(()=>F.gui.layout.__current,n=>this.currentLayout=n===this.name?this.currentLayout:n)}init(t={}){this.config=t}resetCurrentLayout(){F.gui.layout.__current=this.currentLayout}setPlugin(t){this.plugin=t}getPlugin(){return this.plugin}isIframe(){return F.iframe}getCurrentProject(){return F.project}getGid(){return this.config.gid&&this.config.gid.split(":")[1]}getConfig(){return this.config}setConfig(t){this.config=t}setApi({dependency:t,api:n}={}){t?this._api.dependencies[t]=n:this._api.own=n}getApi({dependency:t}={}){return t&&this._api.dependencies[t]||this._api.own}initEvents(t=[]){for(let n in t)this._pluginEvents[t[n]]={}}subscribeEvent({name:t,once:n=!1,owner:s,listener:o}={}){this._pluginEvents[t]=this._pluginEvents[t]?this._pluginEvents[t]:{},this._pluginEvents[t][s]=o,n?this.once(t,o):this.on(t,o)}triggerEvent({name:t,params:n={}}){this.emit(t,n)}unsubscribeEvent({name:t,owner:n}){this.removeEvent(t,this._pluginEvents[t][n]),delete this._pluginEvents[t][n]}unsubscribeAllEvents(){for(let t in this._pluginEvents)this.removeEvent(t),delete this._pluginEvents[t]}clearAllEvents(){this.unsubscribeAllEvents(),this.unwatch(),this.vm=null,this._pluginEvents=null}loadPlugin(){return!0}clear(){}};gu();aw();M1();var xee=av();function Cr(e){return new Proxy(e,{apply(t,n,s){return t.constructor.name==="Function"&&t instanceof Function?(console.warn('[G3W-CLIENT] class constructors must be invoked with "new"'),console.trace(),Object.assign(n,Reflect.construct(t,s))):t.apply(n,s)}})}var wee=Ud(),See=pc(),jn={constant:zl,core:{G3WObject:Cr(nt),utils:{base:m4,inherit:g4,XHR:Ye,getUniqueDomId:Qe,uniqueId:Qe,throttle:En,debounce:un,toRawType:Zn,createFilterFormInputs:bu,noop:oi,waitFor:vi},geoutils:{createVectorLayerFromFile:xee(uI,"[G3W-CLIENT] g3wsdk.core.geoutils.createVectorLayerFromFile is deprecated"),createSelectedStyle:Wa,getAlphanumericPropertiesFromFeature:pr,getQueryLayersPromisesByCoordinates:gt.getQueryLayersPromisesByCoordinates,getMapLayersByFilter:Zi,areCoordinatesEqual:n4,splitFeature:tw,convertSingleMultiGeometry:e_,within:a_,intersects:l_,dissolve:d4,distance:h4,Geometry:{GeometryTypes:zl.GEOMETRY_TYPES,removeZValueToOLFeatureGeometry:cd,addZValueToOLFeatureGeometry:bp,getOLGeometry:XS,isMultiGeometry:jo,isPointGeometryType:Wl,isLineGeometryType:qo,isPolygonGeometryType:$o,is3DGeometry:ld}},ApplicationService:Mn,ApplicationState:F,i18n:{t:_e},task:{TaskService:p4},data:{DataRouterService:gt},errors:{parsers:{Server:gs.get("g3w-error")}},project:{ProjectsRegistry:Object.assign(new nt,{setters:{setCurrentProject(e){}},getProjectUrl:$d,getProjectConfigByGid:f4,getListableProjects:el,getProject:wl,getCurrentProject:()=>F.project})},map:{MapLayersStoreRegistry:El},catalog:{CatalogLayersStoresRegistry:{getLayerById:De,getLayers:_u}},layer:{LayersStore:Cr(pu),Layer:Cr(Gn),TableLayer:Cr(mo),VectorLayer:Cr(Qi),features:{Feature:Cr(ps),FeaturesStore:Cr(hu)}},interaction:{PickCoordinatesInteraction:gi,PickFeatureInteraction:pa},plugin:{Plugin:Cr(c_),PluginsRegistry:Cr(qi),PluginService:Cr(u_)},input:{inputService:{handleFilterExpressionFormInput:Gh,handleDefaultExpressionFormInput:ou}}},gui:{GUI:T,Panel:Un,ComponentsFactory:{build:({vueComponentObject:e,service:t,propsData:n},s={})=>new pt(s).init({vueComponentObject:e,service:t,propsData:n})},FieldsService:wee,vue:{Component:pt,Panel:Un,SearchPanel:h_,FormComponent:jh,Inputs:{G3wFormInputs:Qm,G3WInput:ru,InputsComponents:{text_input:Hd(),texthtml_input:Jx(),textarea_input:t1(),integer_input:n1(),string_input:Hd(),float_input:i1(),radio_input:s1(),check_input:r1(),range_input:o1(),datetimepicker_input:a1(),unique_input:l1(),select_input:Dh(),media_input:S1(),select_autocomplete_input:Dh(),picklayer_input:E1(),color_input:C1(),slider_input:I1(),lonlat_input:L1()}},Fields:See,Mixins:ML,services:{FormService:au}}},ol:{interactions:{PickFeatureInteraction:pa,PickCoordinatesInteraction:gi},controls:{},utils:{merge:(e,t)=>({...e,...t}),getScaleFromResolution:Ks,getResolutionFromScale:ba,createMeasureTooltip:_a,removeMeasureTooltip:FA}},info:()=>{Promise.allSettled([new Promise(e=>$script("https://unpkg.com/platform@1.3.6/platform.js",e)),new Promise(e=>Mn.complete?e():Mn.on("complete",e))]).finally(async()=>{let e=window.platform||{};window.console.info(`
[g3wsdk.info]

- g3w-admin: __${initConfig.version}__
- g3w-client: __4.0.0-editing_commit_style__
${Object.entries(F.pluginsConfigs).map(t=>`    - ${t[0]}: __${t[1].version}__`).join(`
`)}
- browser: __${e.name} ${e.version}__
- operating system: __${e.os.toString()}__
`.trim())})},version:zl.APP_VERSION};jn.core.geometry={Geom:jn.core.geoutils,Geometry:jn.core.geoutils.Geometry};jn.ol.interactions.measure={};jn.ol.interactions.measure.AreaInteraction=class extends du{constructor(e={}){e.geometryType="Polygon",super(e)}},jn.ol.interactions.measure.LengthInteraction=class extends du{constructor(e={}){e.geometryType="LineString",super(e)}},jn.core.geoutils.isSameBaseGeometryType=(e,t)=>e.replace("Multi","")===t.replace("Multi","");jn.core.ApplicationService.setLocalItem=({id:e,data:t}={})=>{try{window.localStorage.setItem(e,JSON.stringify(t))}catch(n){return console.warn(n),n}};jn.core.ApplicationService.removeLocalItem=e=>window.localStorage.removeItem(e);jn.core.ApplicationService.getLocalItem=e=>window.localStorage.getItem(e)?JSON.parse(window.localStorage.getItem(e)):void 0;jn.core.ApplicationService.getApplicationUser=()=>F.user;jn.core.ApplicationService.changeProject=({gid:e}={})=>_t(async()=>{let t=await T.getService("map").addMapExtentUrlParameterToUrl($d(e),crs);try{history.replaceState(null,null,t)}catch(n){console.warn(n)}location.replace(t)});jn.core.ApplicationService.setCurrentLayout=(e="app")=>F.gui.layout.__current=e;jn.core.ApplicationService.getCurrentLayoutName=()=>F.gui.layout.__current;jn.core.ApplicationService.isIframe=()=>F.iframe;jn.core.project.ProjectsRegistry.setProjectAliasUrl=e=>{let t=window.initConfig.projects.find(n=>e.gid===n.gid);t&&(t.url=`${e.host||""}${e.url}`)};jn.core.i18n.getAppLanguage=()=>window.initConfig.user.i18n||"en";jn.core.i18n.tPlugin=e=>_e(`plugins.${e}`);jn.core.i18n.addI18nPlugin=({name:e,config:t})=>{console.warn("[G3W-I18N] g3wsdk.core.i18n.addI18nPlugin is deprecated, please use `g3wsdk.core.plugin.Plugin.setLocale` instead");for(let n in t)_e.register(n,{plugins:{[e]:t[n]}})};window.g3wsdk=jn;ft();Ke();vn();Ka();Ws();Hl();ze();gu();hv();var lO=Ut(S4());xv();Ke();Ka();Ws();ze();Wt();$i();Z1();Ja();function Eee(e){let t=0,n=0,s=0,o=0;e.addEventListener("mousedown",function(u){[".select2-container","button","select","input","textarea"].some(h=>u.target.closest(h))||(u.preventDefault(),s=u.clientX,o=u.clientY,document.addEventListener("mouseup",l),document.addEventListener("mousemove",a))});function l(){document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",a)}function a(u){u.preventDefault(),t=s-u.clientX,n=o-u.clientY,s=u.clientX,o=u.clientY,e.style.marginLeft&&(t-=parseInt(e.style.marginLeft),e.style.marginLeft=null),e.style.marginTop&&(n-=parseInt(e.style.marginTop),e.style.marginTop=null),e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px"}}var Cee={name:"usermessage",props:{id:{},type:{type:String,default:"info"},title:{type:String,default:null},subtitle:{type:String,default:null},size:{type:String,default:"fullpage"},message:{type:String,default:""},textMessage:{type:Boolean,default:!1},autoclose:{type:Boolean,default:!1},duration:{type:Number,default:3e3},closable:{type:Boolean,default:!0},iconClass:{type:String,default:null}},data(){return{style:{top:"position-area"in document.body.style?"anchor(--g3w-view-map top)":null,left:"position-area"in document.body.style?"anchor(--g3w-view-map left)":null,width:this.size==="small"?"325px":g3wsdk.core.ApplicationState.viewport.map.sizes.width+"px",marginLeft:this.size==="small"?document.body.classList.contains("sidebar-collapse")?"5px":"40px":null}}},computed:{showheader(){return this.type!=="loading"}},methods:{closeUserMessage(){this.$el.popover&&this.$el.hidePopover(),this.$emit("close-usermessage")}},async mounted(){if(this.$el.showPopover(),this.type==="tool"&&Eee(this.$el),this.size==="fullpage"&&(this.uw=this.$watch(()=>g3wsdk.core.ApplicationState.viewport.map.sizes.width,e=>this.style.width=this.size==="fullpage"?`${e}px`:this.style.width)),this.observer=new MutationObserver(e=>{e.forEach(t=>{t.attributeName==="class"&&(this.style.marginLeft=this.size==="small"?t.target.classList.contains("sidebar-collapse")?"5px":"40px":null)})}),this.observer.observe(document.body,{attributes:!0}),this.autoclose){await this.$nextTick();let e=setTimeout(()=>{this.closeUserMessage(),clearTimeout(e)},this.duration)}},beforeDestroy(){this.uw&&(this.uw(),this.uw=null),this.observer&&(this.observer.disconnect(),this.observer=null)}},Iee=function(){var e,t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"usermessage-content",class:(e={},e["usermessage-"+t.type]=!0,e),style:t.style,attrs:{id:t.id,popover:"manual"}},[t.showheader?s("div",{staticClass:"usermessage-header-content"},[s("i",{staticClass:"usermessage-header-icontype",class:t.$fa(t.iconClass||t.type)}),t._v(" "),s("div",{staticClass:"usermessage-header-title"},[t._t("header",function(){return[t.title?s("h4",{directives:[{name:"t",rawName:"v-t",value:t.title,expression:"title"}]}):s("h4",[t._v(" "+t._s(t.type.toUpperCase()))]),t._v(" "),t.subtitle?s("h5",{directives:[{name:"t",rawName:"v-t",value:t.subtitle,expression:"subtitle"}],staticClass:"usermessage-header-subtitle"}):t._e()]})],2),t._v(" "),s("div",{staticClass:"usermessage-header-right"},[t.closable?s("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"close",expression:"'close'",arg:"left"}],on:{click:t.closeUserMessage}},[s("i",{staticClass:"usermessage-header-right-item",class:t.$fa("close")})]):t._e()])]):t._e(),t._v(" "),t._t("body",function(){return[t.textMessage?s("div",{staticClass:"usermessage-message"},[t._v(t._s(t.message))]):s("div",{directives:[{name:"t",rawName:"v-t",value:t.message,expression:"message"}],staticClass:"usermessage-message"})]}),t._v(" "),t._t("footer")],2)},Lee=[],Nee=function(e){e&&(e("data-v-4aefe642_0",{source:"#g3w-view-map{anchor-name:--g3w-view-map}",map:void 0,media:void 0}),e("data-v-4aefe642_1",{source:".usermessage-content[data-v-4aefe642]{color:#fff;line-height:normal;padding:3px;min-width:250px;border:unset;inset:unset;margin:unset}.usermessage-success[data-v-4aefe642]{background-color:#62ac62}.usermessage-info[data-v-4aefe642]{background-color:#44a0bb}.usermessage-warning[data-v-4aefe642]{background-color:#f29e1d}.usermessage-alert[data-v-4aefe642]{background-color:#c34943}.usermessage-tool[data-v-4aefe642]{background-color:#fff;color:#222d32;cursor:move;border:thin solid #ccc}.usermessage-loading[data-v-4aefe642]{background-color:#fff;color:#222d32;font-weight:700}.usermessage-header-content[data-v-4aefe642]{display:flex;align-items:baseline;justify-content:space-between;width:100%;border-bottom:2px solid #eee}.usermessage-header-icontype[data-v-4aefe642]{padding:10px 0 0 5px;font-weight:700;font-size:1.3em}.usermessage-header-title[data-v-4aefe642],.usermessage-header-title h4[data-v-4aefe642]{font-weight:700;text-align:center}.usermessage-header-subtitle[data-v-4aefe642]{font-weight:700;margin:5px}.usermessage-header-right[data-v-4aefe642]{padding:5px}.usermessage-header-right-item[data-v-4aefe642]{font-weight:700!important;font-size:1.2em;cursor:pointer}.usermessage-message[data-v-4aefe642]{width:100%;padding:10px;max-height:100px;font-size:1.1em;align-self:flex-start;overflow-y:auto}",map:void 0,media:void 0}))},Tee="data-v-4aefe642",kee=void 0,Ree=!1;function Mee(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="UserMessage.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function cw(){let e=cw.styles||(cw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Aee=Mee({render:Iee,staticRenderFns:Lee},Nee,Cee,Tee,Ree,kee,!1,cw,void 0,void 0),E4=Aee;var tO=Ut(dw());_o();Ke();ze();Xt();v_();Rt();function mte(e){let t=e.querySelector("li.title");if(!t||e._drag)return;e._drag=!0;let n=0,s=0,o=0,l=0;t.addEventListener("mousedown",function(h){[".select2-container","button","select","input","textarea"].some(p=>h.target.closest(p))||(h.preventDefault(),o=h.clientX,l=h.clientY,document.addEventListener("mouseup",a),document.addEventListener("mousemove",u))});function a(){document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",u)}function u(h){h.preventDefault(),n=o-h.clientX,s=l-h.clientY,o=h.clientX,l=h.clientY,e.style.marginLeft&&(n-=parseInt(e.style.marginLeft),e.style.marginLeft=null),e.style.marginTop&&(s-=parseInt(e.style.marginTop),e.style.marginTop=null),e.style.top=e.offsetTop-s+"px",e.style.left=e.offsetLeft-n+"px"}}var _te={name:"catalog-context-menu",props:{external:{type:Object}},data(){return{ApplicationState:F,layer:null,layer_style:null,top:0,left:0,project_menu:!1,layer_menu:!1}},computed:{edit_url(){return F.project.getState().edit_url},layers_url(){return F.project.getState().layers_url}},components:{"chrome-picker":tO.Chrome},directives:{"click-outside":{bind(e,t,n){this.event=s=>{e===s.target||e.contains(s.target)||(s.stopPropagation(),n.context[t.expression](s))},document.body.addEventListener("click",this.event,!0)},unbind(){document.body.removeEventListener("click",this.event,!0)}}},methods:{async onShowContextMenu(e,t){this.closeMenu(),await this.$nextTick(),this.left=e.x;let n=!(t||{}).nodes&&t;this.layer=n||null,this.layer_menu=!!n,this.project_menu=!n,await this.$nextTick(),this.top=e.target.getBoundingClientRect().top-this.$refs.menu.clientHeight+e.target.clientHeight/2,window.innerWidth<767&&(this.left=window.innerWidth/2-this.$refs.menu.clientWidth/2,this.top=window.innerHeight/2-this.$refs.menu.clientHeight/2),[this.$refs.ogc_menu].forEach(s=>s&&s.classList.toggle("inline-submenu",s.querySelector("ul").children.length===1)),mte(this.$refs.menu)},showDownloadMenu(e){Zh(void 0,e),this.closeMenu()},closeMenu(){this.layer_menu=!1,this.project_menu=!1},onChangeColor(e){this.layer.color=e,this.$refs.layer_color.style.backgroundColor=e.hex;let t=T.getService("map").getLayerByName(this.layer.name||""),n=t.getStyle();n._g3w_options.color=e,t.setStyle(n)},canShowWmsUrl(e){let t=De(e),n=F.project.state.metadata.wms_url;return t&&!t.isType("table")&&!!(n&&!t.isExternalWMS()?n:t.getWmsUrl())},canShowWfsUrl(e){let t=De(e);return t&&!t.isType("table")&&t.isWfsActive()},canDownload(e,t){let n=De(t);return n&&n.getDownloadableFormats().filter(s=>s!=="pdf").length&&n["is"+e+"Downloadable"]()},getWmsUrl(e){let t=F.project.state.metadata.wms_url,n=De(e);return t&&!n.isExternalWMS()?t:`${n.getWmsUrl()}?service=WMS&version=1.3.0&request=GetCapabilities`},getWfsUrl(e){return`${De(e).getWfsUrl()}?service=WFS&version=1.1.0&request=GetCapabilities`},getWfs3Url(e){return`${De(e).getWfsUrl()}wfs3/`},copyUrl(e,t){let n=this[`get${e}Url`](this.layer.id),s=document.createElement("a"),o=document.createElement("input");s.href=n,o.value=s.href,document.body.appendChild(o),o.select(),document.execCommand("copy"),t.setAttribute("title",_e("Copied")),t.setAttribute("data-i18n-title",_e("Copied")),o.remove(),s.remove(),setTimeout(()=>{this.closeMenu()},600)},setLayerPosition(e){if(e!==this.layer.position){this.layer.position=e;let t=T.getService("map");t.getLayerById(this.layer.id).setZIndex({top:t.layersCount,bottom:0}[e]),t.emit("change-layer-position-map",{id:this.layer.id,position:e}),this.closeMenu()}},zoomToLayer(e){try{T.getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg)}catch(t){console.warn(t),T.showUserMessage({type:"alert",message:`${t.message}`,textMessage:!0})}this.closeMenu()},canEdit(e){return e?!e.external&&De(e.id).isEditable()&&De(e.id).config.editing.visible:g3wsdk.core.plugin.PluginsRegistry.getPlugin("editing")},startEditing(e){this.closeMenu();let t=g3wsdk.core.plugin.PluginsRegistry.getPlugin("editing");t.showPanel(e?{toolboxes:[e.id]}:void 0),e&&t.startEditing(e.id)},canZoom(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(t=>t>0)},getGeometryType(e,t=!1){let n=t?T.getService("catalog").state.external.vector.find(s=>e===s.id):De(e);if(n){let s=t?n.geometryType:n.config.geometrytype;return n&&s!=="NoGeometry"&&s||""}return""},showAttributeTable(e){De(e).openAttributeTable(),this.closeMenu()},async showMetadata(e){this.closeMenu(),$("#modal-metadata").modal("show"),e&&setTimeout(()=>{document.querySelector('#project-catalog [href="#metadata_layers"]').click(),document.querySelector('#metadata_layers [data-target="#'+e+'"]').click()})},setLayerStyle(e){this.layer_style=this.layer.styles[e].name,De(this.layer.id).changeCurrentStyle(this.layer_style),this.closeMenu()},async setLayerFilter(e){let t=this.layer.filter.current===null||e.fid!==this.layer.filter.current.fid,n=De(this.layer.id);t?await n.applyFilter(e):await n.deleteFilterToken(),n.change(),this.closeMenu()},async deleteFilter(e){let t=De(this.layer.id);if(!t)return;let n=e===this.layer.fid;await t.deleteFilterToken(e),n&&t.change(),this.closeMenu()},async showMenu(e){let t=e.target.closest("li"),n=t&&t.querySelector("ul");if(n){let s=n.offsetHeight+n.getBoundingClientRect().top>=this.$refs.menu.offsetHeight+this.$refs.menu.getBoundingClientRect().top;n.style.top=n.offsetHeight>this.$refs.menu.offsetHeight?0:void 0,n.style.left=this.$refs.menu.offsetWidth-2+"px",n.style.maxHeight=this.$refs.menu.offsetHeight+"px",n.style.bottom=s?0:void 0,n.style.marginTop=s?void 0:"-5px",n.style.overflowY="auto"}},canOpenAttributeTable(e){return e.openattributetable},isExternalLayer(e){return!e.projectLayer},isExternalWMSLayer(e){return!e.projectLayer&&e._type==="wms"},isExternalVectorLayer(e){return!e.projectLayer&&e._type!=="wms"},canShowStylesMenu(e){return e.geolayer&&e.styles&&e.styles.length>1},canShowFiltersMenu(e){return e.filters&&e.filters.length>0},hasMetadata(e){return e.metadata},canShowOpacityPicker(e){return e.geolayer&&e.visible},onLayerOpacity(){if(this.isExternalWMSLayer(this.layer)){let e=T.getService("map").getLayerById(this.layer.id);e&&(e.setOpacity(Number(this.layer.opacity)),T.getService("map").emit("change-layer-opacity",{id:this.layer.id,opacity:this.layer.opacity}))}else{let e=De(this.layer.id);e&&($t.$emit("layer-change-opacity",{layerId:this.layer.id}),e.change())}}},created(){$t.$on("context-menu",this.onShowContextMenu),document.addEventListener("keyup",e=>e.key==="Escape"&&this.closeMenu())}},yte=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.layer_menu||e.project_menu?n("ul",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeMenu,expression:"closeMenu"}],ref:"menu",staticClass:"catalog-context-menu",style:{top:e.top+"px",left:e.left+"px"},attrs:{id:"layer-context-menu",tabindex:"-1"},on:{mouseover:e.showMenu}},[n("li",{staticClass:"title"},[e.project_menu?n("div",[e._v("G3W-ADMIN "+e._s(e.ApplicationState.project.getName()))]):n("div",[e._v(`
      `+e._s(e.layer.title)+`
      `),n("div",{staticStyle:{"font-weight":"normal","font-size":"0.8em"}},[e._v(`
        `+e._s(e.getGeometryType(e.layer.id,e.layer.external))+`
      `)])])]),e._v(" "),e.project_menu||e.hasMetadata(e.layer)?n("li",{on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.showMetadata(e.layer&&e.layer.id)}}},[n("i",{class:e.$fa("info")}),e._v(" "+e._s(e.$t("Metadata"))+`
    `),e.layer&&e.layer.metadata&&e.layer.metadata.abstract?n("ul",{staticClass:"sub-contex-menu",staticStyle:{"border-radius":"0 3px 3px 0"}},[n("li",{staticClass:"layer-menu-metadata-info",domProps:{innerHTML:e._s(e.layer.metadata.abstract)}})]):e._e()]):e._e(),e._v(" "),e.canEdit(e.layer)?n("li",{on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.startEditing(e.layer)}}},[n("i",{class:e.$fa("pencil")}),e._v(" "+e._s(e.$t("Edit Layer"))+`
  `)]):e._e(),e._v(" "),e.layer_menu?[e.canZoom(e.layer)?n("li",{on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.zoomToLayer(e.layer)}}},[n("i",{class:e.$fa("search")}),e._v(" "+e._s(e.$t("Zoom to Layer"))+`
    `)]):e._e(),e._v(" "),e.canOpenAttributeTable(e.layer)?n("li",{on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.showAttributeTable(e.layer.id)}}},[n("i",{class:e.$fa("list")}),e._v(" "+e._s(e.$t("Open Attribute Table"))+`
    `)]):e._e(),e._v(" "),e.isExternalLayer(e.layer)?n("li",[n("i",{class:e.$fa("sort")}),e._v(`
      `+e._s(e.$t("layer_position.message"))+" ("+e._s(e.$t("layer_position."+e.layer.position))+`)
      `),n("i",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},e._l(["top","bottom"],function(s){return n("li",{staticStyle:{display:"list-item"},on:{click:function(o){return e.setLayerPosition(s)}}},[s===e.layer.position?n("span",{class:e.$fa("circle"),staticStyle:{"font-size":"0.5em","margin-right":"3px"}}):e._e(),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"layer_position."+s,expression:"'layer_position.' + position"}]})])}),0)]):e._e(),e._v(" "),e.canShowStylesMenu(e.layer)?n("li",[n("i",{class:e.$fa("palette")}),e._v(`
      `+e._s(e.$t("Style"))+" ("+e._s(e.layer.styles.find(function(s){return s.current}).name.toLowerCase())+`)
      `),n("i",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},e._l(e.layer.styles,function(s,o){return n("li",{key:s.name,staticStyle:{display:"list-item"},on:{click:function(l){return l.stopPropagation(),e.setLayerStyle(o)}}},[s.current?n("span",{class:e.$fa("circle"),staticStyle:{"font-size":"0.8em"}}):e._e(),e._v(`
          `+e._s(s.name+(e.layer.styles.length>1&&s.name===e.layer.defaultstyle?" ("+e.$t("default")+")":""))+`
        `)])}),0)]):e._e(),e._v(" "),e.canShowOpacityPicker(e.layer)?n("li",[n("i",{class:e.$fa("slider")}),e._v(`
      `+e._s(e.$t("Opacity"))+" ("+e._s(e.layer.opacity/100)+`)
      `),n("i",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},[n("li",{staticStyle:{display:"list-item"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.layer.opacity,expression:"layer.opacity"}],attrs:{type:"range",min:"0",max:"100",step:"1",list:"opacity-markers"},domProps:{value:e.layer.opacity},on:{change:e.onLayerOpacity,__r:function(s){return e.$set(e.layer,"opacity",s.target.value)}}}),e._v(" "),e._m(0)])])]):e._e(),e._v(" "),e.isExternalWMSLayer(e.layer)?n("li",[n("i",{class:e.$fa("slider")}),e._v(`
      `+e._s(e.$t("Opacity"))+" ("+e._s(e.layer.opacity)+`)
      `),n("span",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},[n("li",{staticStyle:{display:"list-item"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.layer.opacity,expression:"layer.opacity"}],attrs:{type:"range",min:"0",max:"1",step:"0.01",list:"opacity-markers"},domProps:{value:e.layer.opacity},on:{change:e.onLayerOpacity,__r:function(s){return e.$set(e.layer,"opacity",s.target.value)}}}),e._v(" "),e._m(1)])])]):e._e(),e._v(" "),e.isExternalVectorLayer(e.layer)?n("li",[n("i",{class:e.$fa("tint")}),e._v(`
      `+e._s(e.$t("Color"))+`
      `),n("i",{ref:"layer_color",staticStyle:{width:"10px",height:"10px","border-radius":"10px",position:"absolute",right:"20px","margin-top":"4px"},style:{backgroundColor:e.layer.color}}),e._v(" "),n("i",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},[n("li",{staticStyle:{padding:"14px","background-color":"#E0E0E0"}},[n("chrome-picker",{ref:"color_picker",staticStyle:{width:"100%"},on:{click:function(s){s.preventDefault(),s.stopPropagation()},"hook:beforeDestroy":function(){return e.$refs.color_picker.$off()},input:e.onChangeColor},model:{value:e.layer.color,callback:function(s){e.$set(e.layer,"color",s)},expression:"layer.color"}})],1)])]):e._e(),e._v(" "),e.canShowFiltersMenu(e.layer)?n("li",[n("i",{class:e.$fa("filter")}),e._v(`
      `+e._s(e.$t("Filters"))+`
      `),n("i",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},e._l(e.layer.filters,function(s){return n("li",{key:s.fid,staticStyle:{display:"flex","justify-content":"space-between","align-items":"baseline"},on:{click:function(o){return o.stopPropagation(),e.setLayerFilter(s)}}},[e.layer.filter.current&&e.layer.filter.current.fid===s.fid?n("span",{class:e.$fa("circle"),staticStyle:{"font-size":"0.5em","margin-right":"3px","justify-self":"flex-start"}}):e._e(),e._v(" "),n("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(s.name))]),e._v(" "),n("span",{staticClass:"skin-border-color",class:e.$fa("trash"),staticStyle:{color:"red",right:"0","padding-left":"10px","border-left":"2px solid"},on:{click:function(o){return o.stopPropagation(),e.deleteFilter(s.fid)}}})])}),0)]):e._e(),e._v(" "),e.canDownload("",e.layer.id)||e.isExternalVectorLayer(e.layer)?n("li",{attrs:{disabled:e.ApplicationState.download},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.showDownloadMenu(e.layer)}}},[n("i",{class:e.$fa("download")}),e._v(`
      `+e._s(e.$t("Download"))+`
    `)]):e._e(),e._v(" "),[this.canShowWmsUrl(this.layer.id),this.canShowWfsUrl(this.layer.id),this.canShowWfsUrl(this.layer.id)].filter(Boolean).length?n("li",{ref:"ogc_menu"},[n("i",{class:e.$fa("map")}),e._v(" "+e._s(e.$t("OGC Services"))+`
      `),n("i",{class:e.$fa("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),n("ul",{staticClass:"sub-contex-menu"},[e.canShowWmsUrl(e.layer.id)?n("li",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"baseline"},on:{click:function(s){return e.copyUrl("Wms",s.target)}}},[n("a",{staticStyle:{color:"#000"},attrs:{href:e.getWmsUrl(e.layer.id),target:"_blank"}},[n("i",{class:e.$fa("map")}),e._v(` WMS
          `)]),e._v(" "),n("b",{staticClass:"click-to-copy skin-color-dark",class:e.$fa("eye"),attrs:{"data-placement":"top",title:e.getWmsUrl(e.layer.id)}})]):e._e(),e._v(" "),e.canShowWfsUrl(e.layer.id)?n("li",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"baseline"},on:{click:function(s){return e.copyUrl("Wfs",s.target)}}},[n("a",{staticStyle:{color:"#000"},attrs:{href:e.getWfsUrl(e.layer.id),target:"_blank"}},[n("i",{class:e.$fa("map")}),e._v(` WFS
          `)]),e._v(" "),n("b",{staticClass:"click-to-copy skin-color-dark",class:e.$fa("eye"),attrs:{"data-placement":"top",title:e.getWfsUrl(e.layer.id)}})]):e._e(),e._v(" "),e.canShowWfsUrl(e.layer.id)?n("li",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"baseline"},on:{click:function(s){return e.copyUrl("Wfs3",s.target)}}},[n("a",{staticStyle:{color:"#000"},attrs:{href:e.getWfs3Url(e.layer.id),target:"_blank"}},[n("i",{class:e.$fa("map")}),e._v(` WFS 3
          `)]),e._v(" "),n("b",{staticClass:"click-to-copy skin-color-dark",class:e.$fa("eye"),attrs:{"data-placement":"top",title:e.getWfs3Url(e.layer.id)}})]):e._e()])]):e._e()]:e._e(),e._v(" "),e.layers_url&&e.layer_menu&&!e.isExternalLayer(e.layer)?n("li",[n("a",{staticStyle:{color:"initial"},attrs:{href:e.layers_url,target:"_blank"}},[n("i",[n("svg",{staticStyle:{height:"14px","vertical-align":"-1.5px",fill:"currentColor"},attrs:{xmlns:"http://www.w3.org/2000/svg","xml:space":"preserve",viewBox:"0 0 32 32"}},[n("path",{attrs:{d:"m17.61 17.63 4.36-.02-4-3.98h-4.36v4l4 4.45z"}}),e._v(" "),n("path",{attrs:{d:"m31.61 27.22-7.62-7.6-4.38.01v4.33l7.24 7.67h4.76z"}}),e._v(" "),n("path",{attrs:{d:"M18 25.18c-.68.16-1.17.2-1.9.2a9.77 9.77 0 0 1-9.68-9.88c0-5.57 4.4-9.78 9.68-9.78s9.48 4.2 9.48 9.78c0 .91-.15 1.96-.36 2.8l4.88 4.65a15 15 0 0 0 1.95-7.48C32.05 6.87 25.19.44 16 .44 6.86.44 0 6.84 0 15.47c0 8.68 6.86 15.2 16 15.2 2.36 0 4.23-.3 6.2-1.1L18 25.18z"}})])]),e._v(`
      Layers settings
      `),n("i",{class:e.$fa("external-link"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}})])]):e._e(),e._v(" "),e.edit_url&&e.project_menu?n("li",[n("a",{staticStyle:{color:"initial"},attrs:{href:e.edit_url,target:"_blank"},on:{click:function(s){return s.stopPropagation(),e.closeMenu.apply(null,arguments)}}},[n("i",[n("svg",{staticStyle:{height:"14px","vertical-align":"-1.5px",fill:"currentColor"},attrs:{xmlns:"http://www.w3.org/2000/svg","xml:space":"preserve",viewBox:"0 0 32 32"}},[n("path",{attrs:{d:"m17.61 17.63 4.36-.02-4-3.98h-4.36v4l4 4.45z"}}),e._v(" "),n("path",{attrs:{d:"m31.61 27.22-7.62-7.6-4.38.01v4.33l7.24 7.67h4.76z"}}),e._v(" "),n("path",{attrs:{d:"M18 25.18c-.68.16-1.17.2-1.9.2a9.77 9.77 0 0 1-9.68-9.88c0-5.57 4.4-9.78 9.68-9.78s9.48 4.2 9.48 9.78c0 .91-.15 1.96-.36 2.8l4.88 4.65a15 15 0 0 0 1.95-7.48C32.05 6.87 25.19.44 16 .44 6.86.44 0 6.84 0 15.47c0 8.68 6.86 15.2 16 15.2 2.36 0 4.23-.3 6.2-1.1L18 25.18z"}})])]),e._v(`
      Project settings
      `),n("i",{class:e.$fa("external-link"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}})])]):e._e()],2):e._e()},vte=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("datalist",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{id:"opacity-markers"}},[n("option",{attrs:{value:"0"}},[e._v("0")]),e._v(" "),n("option",{attrs:{value:"25"}},[e._v("0.25")]),e._v(" "),n("option",{attrs:{value:"50"}},[e._v("0.50")]),e._v(" "),n("option",{attrs:{value:"75"}},[e._v("0.75")]),e._v(" "),n("option",{attrs:{value:"100"}},[e._v("1")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("datalist",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{id:"opacity-markers"}},[n("option",[e._v("0")]),e._v(" "),n("option",[e._v("0.25")]),e._v(" "),n("option",[e._v("0.50")]),e._v(" "),n("option",[e._v("0.75")]),e._v(" "),n("option",[e._v("1")])])}],bte=function(e){e&&e("data-v-7f933709_0",{source:".catalog-context-menu{background:#fafafa;border:1px solid #bdbdbd;border-radius:3px;display:block;list-style:none;margin:0;padding:0;position:fixed;min-width:150px;z-index:2;color:#000;outline:0;display:flex;flex-direction:column}.catalog-context-menu li ul{position:absolute;width:max-content;order:1;padding-left:0;background-color:#fff;color:#000}.catalog-context-menu li:not(:hover) ul{display:none}.catalog-context-menu li{border-bottom:1px solid #e0e0e0;margin:0;padding:8px 25px 8px 15px;display:flex;flex-direction:row}.catalog-context-menu li:not(.title){align-items:center}.catalog-context-menu li i{padding-right:3px;margin-right:6px;color:hsl(from var(--skin-color) h s calc(l - 20))!important}.catalog-context-menu li .click-to-copy{color:#000;opacity:1;margin-left:1ch;margin-right:-15px;margin-top:8px}.catalog-context-menu li .click-to-copy:hover{color:#fff!important;transform:scale(1.1)}.catalog-context-menu .click-to-copy .tooltip-inner{min-width:200px}.catalog-context-menu li.title{background:0 0!important;font-size:1.1em;font-weight:700;border-bottom-width:3px!important;flex-direction:column;max-width:250px;cursor:move!important;color:#000!important}.catalog-context-menu li:last-child{border-bottom:none}.catalog-context-menu li:hover{color:#fafafa;cursor:pointer}.catalog-context-menu li .layer-menu-metadata-info{background-color:#fff;color:#000;padding:5px;max-width:200px;white-space:normal;overflow-y:auto;max-height:150px}.catalog-context-menu .tooltip-inner{word-break:break-all;font-weight:700}.catalog-context-menu .item-text{margin-left:3px}.catalog-context-menu :is(ul,li){list-style-type:none}.catalog-context-menu li.inline-submenu{display:list-item;padding:0;text-indent:100%;line-height:0;overflow:hidden}.catalog-context-menu li.inline-submenu>*{display:none}.catalog-context-menu li.inline-submenu>ul{display:block;position:relative;left:0!important;width:100%;text-indent:0;line-height:initial}.catalog-context-menu li,.catalog-context-menu li.inline-submenu>ul>li{font-weight:700}.catalog-context-menu li li{font-weight:400}",map:void 0,media:void 0})},xte=void 0,wte=void 0,Ste=!1;function Ete(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="CatalogContextMenu.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function ww(){let e=ww.styles||(ww.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Cte=Ete({render:yte,staticRenderFns:vte},bte,_te,xte,Ste,wte,!1,ww,void 0,void 0),nO=Cte;var Ite={name:"modal-login",data(){return{show:!1}},computed:{login_url(){return window.initConfig.user.login_url}},methods:{onIframeLoaded(e){let t=this.$refs.login_iframe.contentWindow.g3wsdk&&this.$refs.login_iframe.contentWindow.g3wsdk.core.ApplicationState;t&&t.user&&t.user.logout_url&&(this.show=!1,window.location.reload())}},async mounted(){await this.$nextTick(),this.show=!0}},Lte=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",{staticClass:"modal fade",attrs:{id:"modal-login",tabindex:"-1",role:"document"}},[n("div",{staticClass:"modal-dialog",staticStyle:{height:"60%",width:"60%"}},[n("div",{staticClass:"modal-content",staticStyle:{height:"100%",background:"#d2d6de",display:"grid","grid-template-areas":"'iframe'","place-items":"center"}},[n("button",{staticClass:"close",staticStyle:{position:"absolute",inset:"0 0 auto auto",padding:"10px 15px"},attrs:{type:"button","data-dismiss":"modal"}},[e._v("\xD7")]),e._v(" "),n("span",{staticStyle:{"grid-area":"iframe"}},[e._v("Loading..")]),e._v(" "),n("iframe",{ref:"login_iframe",staticStyle:{border:"0",width:"100%",height:"100%","grid-area":"iframe"},attrs:{loading:"lazy",src:e.login_url},on:{load:e.onIframeLoaded}})])])]):e._e()},Nte=[],Tte=void 0,kte=void 0,Rte=void 0,Mte=!1;function Ate(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="ModalLogin.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Ote=Ate({render:Lte,staticRenderFns:Nte},Tte,Ite,kte,Mte,Rte,!1,void 0,void 0,void 0),iO=Ote;var sO=Ut(dw()),Sw=Ut(Sp());ft();Ke();gr();ze();Wt();ii();n_();Object.entries({RasterLayer:Ei}).forEach(([e,t])=>console.assert(t!==void 0,`${e} is undefined`));function Pte(e,t=","){let n=new RegExp("("+t+`|\r?
|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"`+t+`\r
]*))`,"gi"),s=[[]],o=null;for(;(o=n.exec(e))&&o[0]!==`\r
`;)o[1].length&&o[1]!==t&&s.push([]),s.at(-1).push(o[2]?o[2].replace(new RegExp('""',"g"),'"'):o[3]);return s}var Fte={name:"modal-addlayer",data(){return{layer_type:void 0,file_type:null,layer_name:null,layer_crs:F.project.getProjection().getCode(),layer_color:{hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},wms_config:null,wms_urls:[],wms_projection:null,wms_styles:[],wms_layers:[],wms_visible:!0,wms_opacity:1,url:null,id:null,olLayer:null,map_crs:F.project.getProjection().getCode(),layer_data:null,position:"top",persistent:!1,loading:!1,fields:[],field:null,csv_x:null,csv_y:null,csv_wkt:null,csv_separator:",",csv_loading:!1,name:void 0,title:null,layers:[],projections:[],error_message:"",parse_errors:[]}},components:{"chrome-picker":sO.Chrome},computed:{feature_count(){return this.olLayer&&this.olLayer.getSource().getFeatures().length||0}},watch:{wms_styles(e=[]){let t=this.wms_config||{},n=(t.layers||[]).filter((l,a)=>e.includes(a.toString())),s=(t.layers||[]).findLastIndex(l=>l==n.at(-1)),o=(t.layers||[]).map(({crss:l})=>l.map(a=>`EPSG:${a.epsg}`).sort())[s];if(n.length===0?(this.wms_projection=null,this.projections=[]):n.length===1?(this.wms_projection=o[0],this.projections=o):this.projections=this.projections.filter(l=>o.includes(l)),n.length){let l=0,a=` (${n.map(h=>h.title).join(" + ")})`,u=a;for(;T.getService("map").getLayerByName(t.title+u);)u=` ${a} (${++l})`;this.name=t.title+u}this.wms_layers=n},async wms_projection(){await this.$nextTick();let e=this.wms_config||{},t=(e.layers||[]).map(({crss:n})=>n.map(s=>`EPSG:${s.epsg}`).sort());this.layers=this.wms_projection===null?e.layers:e.layers.filter((n,s)=>t[s].includes(this.wms_projection))},async layer_type(e,t){e&&t&&(this.layer_type=void 0,await this.$nextTick(),this.layer_type=e),t==="file"&&this.unloadFile(),t==="wms"&&this.unloadWMS()},url(){this.url&&!this.wms_config&&this.wms_urls.some(e=>e.url==this.url)?this.id=this.wms_urls.find(e=>e.url==this.url).id:this.url||(this.id="")}},methods:{onChangeColor(e){this.layer_color=e},async parseFile(){let e=this.$refs.input_file;if(!e.accept.split(",").includes(`.${e.files[0].name.split(".").at(-1).toLowerCase()}`)){this.error_message="Not supported format";return}if(T.getService("map").getLayerByName(e.files[0].name)){this.error_message="Layer with same name already added";return}try{this.error_message="",this.parse_errors=[],this.layer_name=e.files[0].name,this.file_type=e.files[0].name.split(".").at(-1).toLowerCase(),this.layer_data=null;let t=[],n;if((this.fields||[]).splice(0),this.file_type==="kmz"){let s=new Sw.default;s.load(await e.files[0].arrayBuffer(e.files[0])),n=s.file(/.kml$/i).at(-1).asText()}if(this.file_type==="zip"){let s=await e.files[0].arrayBuffer(),o={},l=await Sw.default.loadAsync(e.files[0]);for(let a in l.files)if(/.+\.(shp|dbf|json|prj|cpg)$/i.test(a)){let u=(a.split(".").at(-1)||"").toLowerCase();o[u]=await l.files[a].async(["shp","dbf"].includes(u)?"arraybuffer":"text")}n=JSON.stringify(await Zp(o))}if(this.file_type==="csv"){this.csv_loading=!0,n=Pte(await e.files[0].text(),this.csv_separator);let s=["x","lng","longitude","longitudine"],o=["y","lat","latitude","latitudine"];this.fields=n.shift();let l=this.fields.findIndex(h=>h.toLowerCase()==="wkt"),a=this.fields.findIndex(h=>s.includes(h.toLowerCase())),u=this.fields.findIndex(h=>o.includes(h.toLowerCase()));this.csv_wkt=this.csv_wkt||this.fields[l],this.csv_x=this.csv_wkt||this.csv_x||this.fields[a]||this.fields[0],this.csv_y=this.csv_wkt||this.csv_y||this.fields[u]||this.fields[1],n.forEach((h,p)=>{let d=Number(h[a]),_=Number(h[u]);if(!this.csv_wkt&&(Number.isNaN(d)||Number.isNaN(_)))return this.parse_errors.push({row:p+1,value:n[p]});try{let m=new ol.Feature({geometry:new ol.format.WKT().readGeometry(this.csv_wkt?h[l]:`POINT (${d} ${_})`,{dataProjection:this.layer_crs,featureProjection:T.getService("map").getEpsg()}),...h.reduce((v,x,b)=>(v[this.fields[b]]=x,v),{})});m.setId(p),t.push(m)}catch(m){console.warn(m)}}),this.csv_loading=!1}n||(n=await e.files[0].text()||{}),this.layer_crs=["kml","kmz"].includes(this.file_type)?"EPSG:4326":this.layer_crs,await In.registerProjection(this.layer_crs),this.layer_data=n,this.file_type!=="csv"&&(t={gpx:new ol.format.GPX,gml:new ol.format.WMSGetFeatureInfo,geojson:new ol.format.GeoJSON,zip:new ol.format.GeoJSON,kml:new ol.format.KML({extractStyles:!1}),kmz:new ol.format.KML({extractStyles:!1})}[this.file_type].readFeatures(n,{dataProjection:this.layer_crs,featureProjection:T.getService("map").getEpsg()||this.layer_crs})),this.file_type==="zip"&&this.layer_crs!=="EPSG:4326"&&t.forEach(s=>s.getGeometry().transform("EPSG:4326",this.layer_crs)),["kml","kmz"].includes(this.file_type)&&t.forEach(s=>s.unset("styleUrl")),t.length>0&&(this.olLayer=new ol.layer.Vector({source:new ol.source.Vector({features:t}),name:this.layer_name,id:Qe()}),this.fields=this.file_type==="csv"?this.fields:Object.keys(t[0].getProperties()).filter(s=>ur.indexOf(s)<0))}catch(t){console.warn(t),this.error_message=`${t}`}},async addLayer(){if(this.loading=!0,this.layer_type==="wms"){let e=(this.name||`wms_${Qe()}`).trim();try{let t=this.getLocalWMSData();this.wms_config&&(t.wms[this.url]||[]).some(o=>o.layers.length===this.wms_layers.length&&this.wms_layers.every(l=>o.layers.includes(l.name)))&&await this.fetchWMS(this.url);let s={url:this.url,name:e,layers:this.wms_layers.map(o=>o.name),epsg:this.wms_projection,position:this.position,visible:this.wms_visible,opacity:+this.wms_opacity};t.wms[this.url]=t.wms[this.url]||[],t.wms[this.url].push(s),this.updateLocalWMSData(t);try{await this._addExternalWMSLayer(s)}catch(o){console.warn(o),T.getService("map").removeExternalLayer(e),this.deleteWMS(e),setTimeout(()=>{T.showUserMessage({type:"warning",message:"WMS Layer not added. Please check all wms parameter or url"})})}}catch(t){console.warn(t)}this.wms_config&&(this.unloadWMS(),$("#modal-addlayer").modal("hide"))}if(this.layer_type==="file")try{await T.getService("map").addExternalLayer(this.olLayer,{crs:this.layer_crs,position:this.position,color:this.layer_color,field:this.field,persistent:!!this.persistent,type:this.file_type}),$(this.$refs.modal_addlayer).modal("hide"),this.unloadFile()}catch(e){console.warn(e),this.error_message=`${e}`}this.loading=!1},unloadFile(){this.error_message="",this.parse_errors=[],this.loading=!1,this.layer_name=null,this.file_type=null,this.layer_crs=T.getService("map").getCrs(),this.layer_color={hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},this.layer_data=null,this.olLayer=null,this.fields=[],this.field=null,this.csv_x=null,this.csv_y=null,this.csv_wkt=null,this.$refs.input_file&&(this.$refs.input_file.value=null)},unloadWMS(){let e=this.url;this.url="",this.error_message="",this.wms_config=null,this.wms_layers=[],this.wms_opacity=1,this.wms_visible=!0,this.wms_styles=[],this.name=null,this.loading=!1,setTimeout(()=>this.url=e)},async addWmsURL(){this.loading=!0;let e={url:this.url,id:this.id,show:!0},t=this.wms_urls.find(n=>n.url===this.url);try{if(await this.fetchWMS(this.url),!t){let n=this.getLocalWMSData();this.wms_urls.push(e),n.urls=this.wms_urls,this.updateLocalWMSData(n)}}catch(n){console.warn(n)}this.loading=!1},deleteWmsUrl(e){this.wms_urls=this.wms_urls.filter(n=>e!==n.id);let t=this.getLocalWMSData();t.urls=this.wms_urls,this.updateLocalWMSData(t)},_addExternalWMSLayer({url:e,layers:t,name:n,epsg:s=T.getService("map").getEpsg(),position:o="top",opacity:l,visible:a=!0}={}){return new Promise((u,h)=>{let p=new Ei({id:n||Qe(),layers:t,projection:ol.proj.get(s),url:e}),d=p.getOLLayer();d.getSource().once("imageloadend",u),d.getSource().once("imageloaderror",h),d.getSource().on("imageloadend",()=>p.emit("loadstart")),d.getSource().on("imageloadend",()=>p.emit("loadend")),d.getSource().on("imageloaderror",()=>p.emit("loaderror")),T.getService("map").addExternalLayer(p,{position:o,opacity:l,visible:a}),(!this.wms_visible||!this.wms_opacity)&&setTimeout(u,1e3)})},async fetchWMS(e){this.loading=!0;try{let t=await Ye.post({url:`${window.initConfig.interfaceowsurl}`,contentType:"application/json",data:JSON.stringify({url:e||this.url,service:"wms"})});if(!t.result)throw"invalid response";t.wmsurl=e||this.url,t.methods&&t.methods.GetMap?this.url=(t.methods.GetMap.urls||[]).find(o=>o.type==="Get").url:this.url=t.wmsurl,this.title=t.title;let n=0,s="";for(;T.getService("map").getLayerByName(t.title+s);)s=` (${++n})`;this.name=t.title+s,t.layers.forEach(({crss:o})=>o.forEach(l=>In.registerProjection(l.epsg))),this.layers=t.layers,this.wms_config=t,this.error_message=null}catch(t){console.warn(t),this.error_message=t}this.loading=!1},deleteWMS(e){let t=this.getLocalWMSData();Object.keys(t.wms||{}).forEach(n=>{let s=t.wms[n].findIndex(o=>o.name==e);s>=0&&t.wms[n].splice(s,1),t.wms[n].length||delete t.wms[n]}),this.updateLocalWMSData(t)},changeLayerData(e,t={}){let n=this.getLocalWMSData();Object.keys(n.wms).find(s=>{let o=n.wms[s].findIndex(l=>l.name==e);if(o!==-1)return n.wms[s][o][t.key]=t.value,!0}),this.updateLocalWMSData(n)},getLocalWMSData(){let e=window.localStorage.getItem("externalwms");return((e?JSON.parse(e):void 0)||{})[F.project.getId()]},updateLocalWMSData(e){let t=window.localStorage.getItem("externalwms"),n=(t?JSON.parse(t):void 0)||{};n[F.project.getId()]=e;try{window.localStorage.setItem("externalwms",JSON.stringify(n))}catch(s){console.warn(s)}},templateResultLayers(e){let t=this.layers[e.id];return t?$(`
        <sub>${t.name}</sub><br>
        <b>${t.title}</b><br>
        <i>${t.abstract||""}</i>
      `):e.text},templateSelectionLayers(e){let t=this.layers[e.id];return t?$(`
        <sub>${t.name}</sub><br>
        <b>${t.title}</b>
      `):e.text}},async mounted(){$("#modal-addlayer").modal("hide"),$("#modal-addlayer").on("hide.bs.modal",()=>{this.layer_type=void 0,this.unloadFile(),this.unloadWMS()}),await T.isReady(),await T.getService("map").isReady(),this.deleteWMS=this.deleteWMS.bind(this),T.getService("map").on("remove-external-layer",this.deleteWMS);let e=this.getLocalWMSData();e===void 0&&(e={urls:[],wms:{}},this.updateLocalWMSData(e)),setTimeout(()=>{let t=T.getService("map");t.on("change-layer-position-map",({id:n,position:s}={})=>this.changeLayerData(n,{key:"position",value:s})),t.on("change-layer-opacity",({id:n,opacity:s}={})=>this.changeLayerData(n,{key:"opacity",value:s})),t.on("change-layer-visibility",({id:n,visible:s}={})=>this.changeLayerData(n,{key:"visible",value:s})),Object.keys(e.wms).forEach(n=>{e.wms[n].forEach(s=>this._addExternalWMSLayer({url:n,...s}))})}),this.wms_urls=e.urls},beforeDestroy(){this.unloadFile(),this.unloadWMS(),$("#modal-addlayer").modal("hide"),$("#modal-addlayer").remove(),T.getService("map").off("remove-external-layer",this.deleteWMS),this.$data=null}},Dte=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"modal_addlayer",staticClass:"modal fade",attrs:{id:"modal-addlayer",role:"dialog",tabindex:"-1"}},[n("div",{staticClass:"modal-dialog"},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e._v("\xD7")]),e._v(" "),n("h4",{directives:[{name:"t",rawName:"v-t",value:"Add Layer",expression:"'Add Layer'"}],staticClass:"modal-title",staticStyle:{"font-weight":"bold"}})]),e._v(" "),n("div",{staticClass:"modal-body"},[n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"Layer type",expression:"'Layer type'"}]}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.layer_type,expression:"layer_type"}],staticClass:"form-control",attrs:{id:"add-layer-type"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.layer_type=s.target.multiple?o:o[0]}}},[n("option",{directives:[{name:"t",rawName:"v-t",value:"Choose type",expression:"'Choose type'"}],attrs:{disabled:""},domProps:{value:void 0}}),e._v(" "),n("option",{directives:[{name:"t",rawName:"v-t",value:"WMS (URL)",expression:"'WMS (URL)'"}],attrs:{value:"wms"}}),e._v(" "),n("option",{directives:[{name:"t",rawName:"v-t",value:"Local file",expression:"'Local file'"}],attrs:{value:"file"}})])]),e._v(" "),n("hr"),e._v(" "),n("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),e.layer_type==="wms"?n("div",{staticClass:"form-group"},[n("a",{staticStyle:{float:"right"},attrs:{href:"https://g3w-suite.readthedocs.io/en/v3.9.x/g3wsuite_client.html#wms",target:"_blank","data-i18n-title":"Docs","data-placement":"bottom"}},[n("i",{class:e.$fa("external-link")})]),e._v(" "),n("fieldset",{staticClass:"form-group",attrs:{disabled:e.wms_config}},[n("label",{attrs:{for:"add_wms_url"}},[e._v("URL")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{id:"add_wms_url",placeholder:"http://example.org/?&service=WMS&request=GetCapabilities",type:"url",list:"wms_urls",required:""},domProps:{value:e.url},on:{input:function(s){s.target.composing||(e.url=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),e._v(" "),e.wms_config?e._e():n("small",{directives:[{name:"t",rawName:"v-t",value:"Search through saved connections or add a new server",expression:"'Search through saved connections or add a new server'"}]}),e._v(" "),n("datalist",{attrs:{id:"wms_urls"}},e._l(e.wms_urls,function(s){return n("option",{key:s.id,domProps:{value:s.url}},[e._v(e._s(s.id))])}),0)]),e._v(" "),e.url&&!e.wms_config&&!e.loading?n("fieldset",{staticClass:"form-group",attrs:{disabled:e.wms_config||e.wms_urls.some(function(s){return s.url==e.url})}},[n("label",{attrs:{for:"add_wms_name",title:"required"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"Name",expression:"'Name'"}]}),e._v(" "),n("i",{staticStyle:{"font-family":"Monospace",color:"var(--skin-color)"}},[e._v("*")])]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.id,expression:"id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{id:"add_wms_name",required:""},domProps:{value:e.id},on:{input:function(s){s.target.composing||(e.id=s.target.value.trim())},blur:function(s){return e.$forceUpdate()}}}),e._v(" "),e.id!==null&&e.wms_urls.some(function(s){return s.id===e.id})&&e.wms_urls.every(function(s){return s.url!==e.url})?n("p",{staticStyle:{color:"red",margin:"10px 0"}},[e._v(`
              \u26A0\uFE0F `),n("b",{directives:[{name:"t",rawName:"v-t",value:"A WMS connection with this name already exists",expression:"'A WMS connection with this name already exists'"}]})]):e._e()]):e._e(),e._v(" "),e.wms_config?e._e():n("button",{staticClass:"btn btn-block btn-success",attrs:{disabled:!(e.id||"").trim()||e.wms_urls.some(function(s){return s.id===e.id&&s.url!==e.url})||!(e.url||"").trim().match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),e.addWmsURL.apply(null,arguments)}}},[n("i",{class:e.$fa("plus-square")}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"Connect",expression:"'Connect'"}]})]),e._v(" "),e.wms_config?e._e():n("div",{staticClass:"form-group"},[n("hr"),e._v(" "),e.wms_urls.length?n("p",{directives:[{name:"t",rawName:"v-t",value:"Saved connections:",expression:"'Saved connections:'"}],staticStyle:{"text-align":"center","font-weight":"bold"}}):e._e(),e._v(" "),e._l(e.wms_urls,function(s){return n("div",{key:s.id,staticStyle:{"border-bottom":"1px solid #ccc","padding-bottom":"3px"}},[n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","padding-top":"3px"}},[n("b",{staticStyle:{"flex-grow":"1",cursor:"pointer"},attrs:{title:e.$t("Connect")},on:{click:function(o){return e.fetchWMS(s.url)}}},[e._v(e._s(s.id))]),e._v(" "),n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"Connect",expression:"'Connect'",arg:"top"}],class:e.$fa("eye"),staticStyle:{color:"var(--skin-color)",padding:"3px",margin:"2px","font-size":"1.3em",cursor:"pointer"},on:{click:function(o){return e.fetchWMS(s.url)}}}),e._v(" "),n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top",value:"Remove",expression:"'Remove'",arg:"top"}],class:e.$fa("trash"),staticStyle:{color:"red",padding:"3px",margin:"2px","font-size":"1.3em",cursor:"pointer"},on:{click:function(o){return e.deleteWmsUrl(s.id)}}})]),e._v(" "),n("small",{staticStyle:{cursor:"pointer"},attrs:{title:e.$t("Connect")},on:{click:function(o){return e.fetchWMS(s.url)}}},[e._v(e._s(s.url))])])})],2),e._v(" "),e.wms_config?n("fieldset",{attrs:{disabled:e.loading}},[n("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Disconnect",expression:"'Disconnect'",arg:"left"}],staticClass:"close",staticStyle:{float:"right",padding:"5px 10px","margin-top":"15px",outline:"1px solid",color:"red",opacity:"1"},attrs:{type:"button"},on:{click:e.unloadWMS}},[e._v("\xD7")]),e._v(" "),n("h3",{staticClass:"skin-color g3w-wms-panel-title"},[e._v(e._s(e.title))]),e._v(" "),e.wms_config.abstract?n("fieldset",{staticClass:"form-group",staticStyle:{border:"1px solid #c0c0c0",padding:"4.9px 8.75px 8.75px 10.5px","border-radius":"3px"}},[n("legend",{staticStyle:{width:"15px",height:"15px",border:"1px solid","border-radius":"50%","background-color":"var(--bgcolor)","font-weight":"bold",color:"#fff","font-size":"0.7em","text-align":"center",margin:"0 -14px","user-select":"none"}},[e._v("i")]),e._v(`
              `+e._s(e.wms_config.abstract)+`
            `)]):e._e(),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"g3w-wms-layers"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"Layers",expression:"'Layers'"}]})]),e._v(" "),n("select",{directives:[{name:"select2",rawName:"v-select2",value:"wms_styles",expression:"'wms_styles'"}],attrs:{id:"g3w-wms-layers",multiple:!0,clear:!0,templateResult:e.templateResultLayers,templateSelection:e.templateSelectionLayers}},e._l(e.layers,function(s,o){return n("option",{domProps:{value:o}},[e._v(e._s(s.title))])}),0)]),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"Projection",expression:"'Projection'"}],attrs:{for:"g3w-wms-projections"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.wms_projection,expression:"wms_projection"}],staticClass:"form-control",attrs:{id:"g3w-wms-projections"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.wms_projection=s.target.multiple?o:o[0]}}},e._l(e.projections,function(s){return n("option",[e._v(e._s(s))])}),0)]),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"layer_position.message",expression:"'layer_position.message'"}],attrs:{for:"position-layer"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.position,expression:"position"}],staticClass:"form-control",attrs:{id:"position-layer"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.position=s.target.multiple?o:o[0]}}},[n("option",{directives:[{name:"t",rawName:"v-t",value:"layer_position.top",expression:"'layer_position.top'"}],domProps:{value:"top"}}),e._v(" "),n("option",{directives:[{name:"t",rawName:"v-t",value:"layer_position.bottom",expression:"'layer_position.bottom'"}],domProps:{value:"bottom"}})])]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.wms_visible,expression:"wms_visible"}],attrs:{id:"g3w-wms-visible",hidden:""},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.wms_visible=s.target.multiple?o:o[0]}}},[n("option",{domProps:{value:!1}}),e._v(" "),n("option",{domProps:{value:!0}})]),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"Opacity",expression:"'Opacity'"}],attrs:{for:"g3w-wms-opacity"}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.wms_opacity,expression:"wms_opacity"}],attrs:{id:"g3w-wms-opacity",type:"range",min:"0",max:"1",step:"0.01",list:"wms-opacity-markers"},domProps:{value:e.wms_opacity},on:{__r:function(s){e.wms_opacity=s.target.value}}}),e._v(" "),e._m(0)]),e._v(" "),n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"Name",expression:"'Name'"}],attrs:{for:"g3w-wms-layer-name"}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{id:"g3w-wms-layer-name"},domProps:{value:e.name},on:{input:function(s){s.target.composing||(e.name=s.target.value)}}})])]):e._e()]):e._e(),e._v(" "),e.layer_type==="file"?n("div",{staticClass:"form-group"},[e.layer_data?n("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left",value:"Remove",expression:"'Remove'",arg:"left"}],staticClass:"close",staticStyle:{float:"right",padding:"5px 10px",margin:"5px 0 0 8px",outline:"1px solid",color:"red",opacity:"1"},attrs:{type:"button"},on:{click:e.unloadFile}},[e._v("\xD7")]):e._e(),e._v(" "),n("form",{style:{padding:e.layer_data?"0":"20px 0"},attrs:{id:"addcustomlayer"}},[n("input",{ref:"input_file",attrs:{type:"file",accept:".zip,.geojson,.GEOJSON,.kml,.kmz,.KMZ,.KML,.json,.gpx,.gml,.csv"},on:{change:e.parseFile}}),e._v(" "),n("h4",{staticClass:"skin-color"},[e.layer_data?e.layer_name?n("b",[e._v(e._s(e.layer_name))]):e._e():n("b",{directives:[{name:"t",rawName:"v-t",value:"Add your file here",expression:"'Add your file here'"}]})]),e._v(" "),e.layer_data?e._e():n("i",{staticClass:"fa-5x",class:e.g3wtemplate.getFontClass("cloud-upload"),attrs:{"aria-hidden":"true"}}),e._v(" "),e.layer_data?e._e():n("span",{staticStyle:{"font-family":"Monospace"}},[e._v(".gml, .geojson, .kml, .kmz, .gpx, .csv, .zip (shapefile)")])]),e._v(" "),e.file_type==="csv"?n("div",{staticClass:"form-group",staticStyle:{padding:"15px",border:"1px solid grey","border-radius":"3px"}},[n("bar-loader",{attrs:{loading:e.csv_loading}}),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"Delimiter",expression:"'Delimiter'"}],attrs:{for:"g3w-select-field-layer"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.csv_separator,expression:"csv_separator"}],staticClass:"form-control",attrs:{id:"g3w-select-separator"},on:{change:[function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.csv_separator=s.target.multiple?o:o[0]},e.parseFile]}},[n("option",[e._v(",")]),e._v(" "),n("option",[e._v(";")])]),e._v(" "),e.fields.length>1&&!e.csv_wkt?[n("label",{directives:[{name:"t",rawName:"v-t",value:"X field",expression:"'X field'"}],attrs:{for:"g3w-select-x-field"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.csv_x,expression:"csv_x"}],staticClass:"form-control",attrs:{id:"g3w-select-x-field",disabled:!(e.fields||[]).length},on:{change:[function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.csv_x=s.target.multiple?o:o[0]},e.parseFile]}},e._l(e.fields,function(s){return n("option",[e._v(e._s(s))])}),0),e._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"Y field",expression:"'Y field'"}],attrs:{for:"g3w-select-y-field"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.csv_y,expression:"csv_y"}],staticClass:"form-control",attrs:{id:"g3w-select-y-field",disabled:!(e.fields||[]).length},on:{change:[function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.csv_y=s.target.multiple?o:o[0]},e.parseFile]}},e._l(e.fields,function(s){return n("option",[e._v(e._s(s))])}),0)]:e._e(),e._v(" "),e.csv_wkt?[n("label",{attrs:{for:"g3w-select-wkt-field"}},[e._v("WKT")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.csv_wkt,expression:"csv_wkt"}],staticClass:"form-control",attrs:{id:"g3w-select-y-field"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.csv_wkt=s.target.multiple?o:o[0]}}},e._l(e.fields,function(s){return n("option",[e._v(e._s(s))])}),0)]:e._e(),e._v(" "),e.fields.length===0?n("div",{directives:[{name:"t",rawName:"v-t",value:"No valid fields",expression:"'No valid fields'"}]}):e._e(),e._v(" "),e.olLayer?n("small",{staticStyle:{color:"red",display:"inline-block","margin-top":"1em"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"Features found:",expression:"'Features found:'"}]}),e._v(" "+e._s(e.feature_count))]):e._e()],2):e._e(),e._v(" "),n("a",{staticStyle:{float:"right"},attrs:{href:"https://epsg.io/"+(e.layer_crs||"").toLowerCase().replace("epsg:",""),target:"_blank","data-i18n-title":"Docs","data-placement":"bottom"}},[n("i",{class:e.$fa("external-link")})]),e._v(" "),n("fieldset",{staticClass:"form-group",attrs:{disabled:e.layer_data||["kml","kmz"].includes(e.file_type)}},[n("label",{directives:[{name:"t",rawName:"v-t",value:"Projection",expression:"'Projection'"}],attrs:{for:"projection-layer"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.layer_crs,expression:"layer_crs"}],staticClass:"form-control",attrs:{id:"projection-layer"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.layer_crs=s.target.multiple?o:o[0]}}},e._l(new Set([e.map_crs,"EPSG:3003","EPSG:3004","EPSG:3045","EPSG:3857","EPSG:4326","EPSG:6708","EPSG:23032","EPSG:23033","EPSG:25833","EPSG:32632","EPSG:32633"]),function(s){return n("option",[e._v(e._s(s))])}),0)]),e._v(" "),e.parse_errors.length?n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"csv_parse_errors"}},[e._v("\u26A0\uFE0F Parse errors:")]),e._v(" "),n("select",{staticClass:"form-control",staticStyle:{"background-color":"gold","font-family":"Monospace"},attrs:{id:"csv_parse_errors"}},e._l(e.parse_errors,function(s){var o=s.value,l=s.row;return n("option",[e._v("["+e._s(l)+"] "+e._s(o))])}),0)]):e._e(),e._v(" "),e.layer_data?n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"layer_position.message",expression:"'layer_position.message'"}],attrs:{for:"position-layer"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.position,expression:"position"}],staticClass:"form-control",attrs:{id:"position-layer"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.position=s.target.multiple?o:o[0]}}},[n("option",{directives:[{name:"t",rawName:"v-t",value:"layer_position.top",expression:"'layer_position.top'"}],domProps:{value:"top"}}),e._v(" "),n("option",{directives:[{name:"t",rawName:"v-t",value:"layer_position.bottom",expression:"'layer_position.bottom'"}],domProps:{value:"bottom"}})])]):e._e(),e._v(" "),e.layer_data?n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"Persistent data",expression:"'Persistent data'"}],attrs:{for:"persistent-layer"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.persistent,expression:"persistent"}],staticClass:"form-control",attrs:{id:"persistent-layer"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.persistent=s.target.multiple?o:o[0]}}},[n("option",{directives:[{name:"t",rawName:"v-t",value:"no",expression:"'no'"}],domProps:{value:!1}}),e._v(" "),n("option",{directives:[{name:"t",rawName:"v-t",value:"yes",expression:"'yes'"}],domProps:{value:!0}})]),e._v(" "),n("small",{directives:[{name:"t",rawName:"v-t",value:"save layer into browser storage",expression:"'save layer into browser storage'"}]})]):e._e(),e._v(" "),(e.fields||[]).length?n("div",{staticClass:"form-group"},[n("label",{directives:[{name:"t",rawName:"v-t",value:"label",expression:"'label'"}],attrs:{for:"g3w-select-field-layer"}}),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.field,expression:"field"}],staticClass:"form-control",attrs:{id:"g3w-select-field-layer"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var a="_value"in l?l._value:l.value;return a});e.field=s.target.multiple?o:o[0]}}},[n("option",{domProps:{value:null}},[e._v("---")]),e._v(" "),e._l(e.fields,function(s){return n("option",{key:s,domProps:{value:s}},[e._v(e._s(s))])})],2),e._v(" "),n("small",{directives:[{name:"t",rawName:"v-t",value:"field shown on map",expression:"'field shown on map'"}]})]):e._e(),e._v(" "),e.layer_data?n("div",[n("p",{directives:[{name:"t",rawName:"v-t",value:"Layer Color",expression:"'Layer Color'"}],staticStyle:{"font-weight":"700"}}),e._v(" "),n("chrome-picker",{staticStyle:{width:"100%"},on:{input:e.onChangeColor},model:{value:e.layer_color,callback:function(s){e.layer_color=s},expression:"layer_color"}})],1):e._e()]):e._e()],1),e._v(" "),n("div",{staticClass:"modal-footer"},[e.error_message?n("div",{directives:[{name:"t",rawName:"v-t",value:e.error_message,expression:"error_message"}],staticStyle:{"font-weight":"bold","font-size":"1.2em","background-color":"orange",padding:"10px","text-align":"center","margin-bottom":"5px"}}):e._e(),e._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}}),e._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"}],staticClass:"btn btn-success",attrs:{type:"button",disabled:e.layer_type==="wms"?!e.wms_layers.length:!e.layer_data},on:{click:function(s){return s.stopPropagation(),e.addLayer.apply(null,arguments)}}})])])])])},Gte=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("datalist",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{id:"wms-opacity-markers"}},[n("option",{attrs:{value:"0"}},[e._v("0")]),e._v(" "),n("option",{attrs:{value:"0.25"}},[e._v("0.25")]),e._v(" "),n("option",{attrs:{value:"0.50"}},[e._v("0.50")]),e._v(" "),n("option",{attrs:{value:"0.75"}},[e._v("0.75")]),e._v(" "),n("option",{attrs:{value:"1"}},[e._v("1")])])}],jte=function(e){e&&e("data-v-a2530334_0",{source:"#addcustomlayer[data-v-a2530334]{margin:10px 0 10px 0;position:relative;border:2px dashed #97a1a8;display:flex;flex-direction:column;text-align:center;gap:8px;opacity:.8}#addcustomlayer input[data-v-a2530334]{position:absolute;outline:0;opacity:0;cursor:pointer;inset:0}#add_wms_url[data-v-a2530334]::placeholder{font-size:85%;opacity:.5}.g3w-wms-panel-title[data-v-a2530334]{font-size:1.2em;font-weight:700;margin-bottom:10px}",map:void 0,media:void 0})},qte="data-v-a2530334",$te=void 0,Bte=!1;function Ute(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="ModalAddLayer.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Ew(){let e=Ew.styles||(Ew.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var zte=Ute({render:Dte,staticRenderFns:Gte},jte,Fte,qte,Bte,$te,!1,Ew,void 0,void 0),rO=zte;Ke();gr();ii();lg();ze();var b_="images/logo_gis3w_156_85.png";async function x_(e){return x_[e]=x_[e]||await Ye.get({url:encodeURI(`/${F.user.i18n}/about/api/group/${e}/`)}),x_[e]}async function w_(e){return w_[e]=w_[e]||await Ye.get({url:encodeURI(`/${F.user.i18n}/about/api/group/${e}/projects/`)}),w_[e]}var Vte={name:"modal-changemap",data(){return{state:null,loading:!1,current:"projects",items:[],parent:null,steps:[],curr_group:null}},methods:{async back(){let e=this.steps.pop(),t=this.steps.length>0,n=t&&this.steps[this.steps.length-1];if(t&&n.macrogroup_id!==void 0||!t&&e===void 0&&Array.isArray(this.parent.macrogroup_id)&&this.parent.macrogroup_id.length>0){let s=t?n.macrogroup_id:this.parent.macrogroup_id,o=!t;return this.showMacroGroups(s,o)}if(t&&n.macrogroup_id===void 0)return this.showGroups(n,!1);if(!t)return this.showRoot()},async showMacroGroups(e=[],t=!0){if(e.length===1)return this.parent=this.macrogroups.find(n=>n.id===e[0]),await this.showGroups(this.parent);this.items=this.macrogroups.filter(n=>e.includes(n.id)),this.current="macrogroups",this.parent={macrogroup_id:e,title:null,name:null},t&&this.steps.push(this.parent)},async showGroups(e,t=!0){try{this.loading=!0,this.parent=e,this.items=await x_(e.id),this.current="groups"}catch(n){console.warn(n),this.items=[]}finally{t&&this.steps.push(this.parent),this.loading=!1}},async showProjects(e){try{this.loading=!0,this.parent=e,this.items=this.parent.id===this.curr_group?el():await w_(e.id,t=>this.setItemImageSrc({item:t,type:"project"})),this.current="projects"}catch(t){console.warn(t),this.items=[]}finally{this.steps.push(this.parent),this.loading=!1}},showRoot(){this.current="root",this.items=[...this.macrogroups,...this.groups],this.steps=[]},async changeMapProject(e){let t,n=window.initConfig.urls.baseurl,s=this.parent.srid?`EPSG:${this.parent.srid}`:this.parent.crs.epsg;await In.registerProjection(s);try{new URL(n),t=`${n}${e.url||e.map_url.replace(/^\//,"")}`}catch{t=`${location.origin}${n}${e.url||e.map_url.replace(/^\//,"")}`}t=await T.getService("map").addMapExtentUrlParameterToUrl(t,s),history.replaceState(null,null,t),location.replace(t)},async trigger(e){switch(this.current){case"root":return e.srid===void 0?this.showGroups(e):this.showProjects(e);case"macrogroups":return this.showGroups(e);case"groups":return await this.showProjects(e);case"projects":return await this.changeMapProject(e)}},setItemImageSrc({item:e,type:t}={}){switch(t){case"project":e.thumbnail=this._setSrc(e.thumbnail);break;case"group":e.header_logo_img=this._setSrc(e.header_logo_img);break;case"macrogroup":e.logo_img=this._setSrc(e.logo_img);break;case"net_error":e.thumbnail||e.logo_img?e.thumbnail=`${window.initConfig.urls.clienturl}${b_}`:e.header_logo_img&&(e.header_logo_img=`${window.initConfig.urls.clienturl}${b_}`);break}},_setSrc(e){let t,n=this.$options.host||"",s=window.initConfig.mediaurl,o=window.initConfig.urls.clienturl,l=e&&e.includes(s),a=e&&!e.includes("static")&&!e.includes("media");return e?l?t=e:a?t=`${s}${e}`:t=`${o}${b_}`:t=`${o}${b_}`,`${n}${t}`}},async created(){let e=window.initConfig;this.items=el(),this.parent=window.initConfig,this.curr_group=this.parent.id,this.macrogroups=e.macrogroups,this.groups=e.groups,Object.entries({project:this.items,magrocroup:this.macrogroups,group:this.groups}).forEach(([t,n])=>n.forEach(s=>this.setItemImageSrc({item:s,type:t})))}},Hte=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal fade",attrs:{id:"modal-changemap",tabindex:"-1"}},[n("div",{staticClass:"modal-dialog",staticStyle:{"min-width":"80vw"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-body",staticStyle:{height:"80vh"}},[this.current!=="root"?n("div",{staticClass:"skin-background-color",staticStyle:{display:"flex","align-items":"center",color:"#fff"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom",value:"Change Session",expression:"'Change Session'",arg:"bottom"},{name:"disabled",rawName:"v-disabled",value:e.loading,expression:"loading"}],staticStyle:{"font-size":"2em",margin:"5px",cursor:"pointer",padding:"3px",border:"2px solid #fff","border-radius":"3px"},on:{click:function(s){return s.stopPropagation(),e.back.apply(null,arguments)}}},[n("i",{class:e.$fa("reply"),staticStyle:{color:"#FFF"}})]),e._v(" "),e.parent?n("div",{staticStyle:{margin:"auto"}},[n("h3",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.parent.title||e.parent.name))])]):e._e()]):e._e(),e._v(" "),e.items.length?n("div",{staticClass:"g3w-change-map-menu-container"},e._l(e.items,function(s){return n("div",{key:s.name,staticClass:"menu-item"},[n("div",{staticClass:"menu-item-image",on:{click:function(o){return o.stopPropagation(),e.trigger(s)}}},[n("img",{staticClass:"img-responsive",attrs:{src:s.thumbnail||s.header_logo_img||s.logo_img,alt:"logo"},on:{error:function(o){return e.setItemImageSrc({item:s,type:"net_error"})}}})]),e._v(" "),n("div",{staticClass:"menu-item-content"},[n("div",{staticClass:"menu-item-text"},[n("h4",{staticClass:"menu-item-title"},[e._v(e._s(s.title))]),e._v(" "),n("div",{domProps:{innerHTML:e._s(s.description)}})])])])}),0):n("h3",{directives:[{name:"t",rawName:"v-t",value:"no_other_"+e.current,expression:"`no_other_${current}`"}],staticStyle:{"font-weight":"bold"}})]),e._v(" "),n("div",{staticClass:"modal-footer",staticStyle:{position:"relative",background:"#fff"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}})])])])])},Wte=[],Yte=function(e){e&&e("data-v-477c12a2_0",{source:".g3w-change-map-menu-container[data-v-477c12a2]{height:100%;display:grid;grid-template-columns:repeat(auto-fill,minmax(30%,1fr));grid-gap:1em;overflow-y:auto}.menu-item[data-v-477c12a2]{margin-bottom:20px;margin-top:20px}.menu-item-image[data-v-477c12a2]{cursor:pointer;position:relative;overflow:hidden;padding-bottom:50%;opacity:.7}.menu-item-image[data-v-477c12a2]:hover{opacity:1}.menu-item-image img[data-v-477c12a2]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.menu-item-content[data-v-477c12a2]{padding:15px;background:rgba(255,255,255,.3)}.menu-item-text[data-v-477c12a2]{position:relative;overflow:hidden;height:100%;text-align:justify}.menu-item-title[data-v-477c12a2]{text-align:center;font-weight:700;background:rgba(255,255,255,.5);padding:5px}",map:void 0,media:void 0})},Xte="data-v-477c12a2",Zte=void 0,Qte=!1;function Kte(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="ModalChangeMap.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Cw(){let e=Cw.styles||(Cw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Jte=Kte({render:Hte,staticRenderFns:Wte},Yte,Vte,Xte,Qte,Zte,!1,Cw,void 0,void 0),oO=Jte;Ke();Hl();ii();var ene={name:"modal-metadata",data(){let e=F.project.getState(),t=window.initConfig.version.split("-")[0].split(".");return{customcredits:!1,powered_by:window.initConfig.powered_by,urls:window.initConfig.urls,docs_url:`https://g3w-suite.readthedocs.io/en/v${t[0].replace("v","")}.${t[1]}.x/`,groups:Object.entries({general:["title","name","description","abstract","keywords","fees","accessconstraints","contactinformation","wms_url"],spatial:["crs","extent"],layers:["layers"]}).reduce((n,[s,o])=>(n[s]=o.reduce((l,a)=>{let u=e.metadata&&e.metadata[a]?e.metadata[a]:e[a];return u&&(a==="layers"&&(u=u.filter(h=>h.geometry!=="NoGeometry"&&h.crs&&h.crs.epsg)),l[a]={value:u,label:`metadata.${s}.fields.${a}`}),l},{}),n),{}),g3wsdk_info:""}},methods:{showHideInfo(e){let t=e.target.closest(".layer_header");t.querySelector(".open-close").classList.toggle("fa-plus"),t.querySelector(".open-close").classList.toggle("fa-minus")},sanitizeValue(e){return(Array.isArray(e)||typeof e=="object"&&e!==null)&&(e=Object.values(e).length?e:""),e},copy_g3wsdk_info(e){let t=document.createRange();t.selectNode(e.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(t),document.execCommand("copy"),window.getSelection().removeAllRanges(),alert("Copied to clipboard!")}},async created(){if(window.initConfig.credits)try{let e=await Ye.get({url:window.initConfig.credits});this.customcredits=e!=="None"&&e}catch(e){console.warn(e)}},mounted(){$("#modal-metadata").on("show.bs.modal",async()=>{await Promise.allSettled([new Promise(t=>$script("https://unpkg.com/platform@1.3.6/platform.js",t)),new Promise(t=>Mn.complete?t():Mn.on("complete",t))]);let e=window.platform||{};this.g3wsdk_info=`
[g3wsdk.info]

- g3w-admin: __${initConfig.version}__
- g3w-client: __4.0.0-editing_commit_style__
${Object.entries(F.pluginsConfigs).map(t=>`    - ${t[0]}: __${t[1].version}__`).join(`
`)}
- browser: __${e.name} ${e.version}__
- operating system: __${e.os.toString()}__
`.trim()})}},tne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal fade",attrs:{id:"modal-metadata",tabindex:"-1"}},[n("div",{staticClass:"modal-dialog",staticStyle:{"min-width":"80vw"}},[n("div",{staticClass:"modal-content"},[n("ul",{staticClass:"modal-header nav nav-tabs",attrs:{role:"tablist"}},e._l(["general","spatial","layers","credits"],function(s){return n("li",{class:{active:s==="general"}},[n("a",{class:"metadata-item-tab "+s,attrs:{"data-toggle":"tab",href:"#metadata_"+s}},[n("i",{staticClass:"action-button",class:e.$fa({general:"info",spatial:"globe",layers:"bars",credits:"copyright"}[s]),attrs:{"aria-hidden":"true"}}),e._v(" "),n("b",{directives:[{name:"t",rawName:"v-t",value:"metadata."+s+".title",expression:"'metadata.'+ tab +'.title'"}]})])])}),0),e._v(" "),n("div",{staticClass:"modal-body",staticStyle:{"min-height":"65vh","max-height":"70vh"},attrs:{id:"project-catalog"}},[n("div",{staticClass:"tab-content"},[e._l(["general","spatial"],function(s){return n("div",{staticClass:"tab-pane fade",class:{in:s==="general",active:s==="general"},attrs:{id:"metadata_"+s}},e._l(e.groups[s],function(o,l){return n("div",{staticClass:"row row-info"},[n("div",{staticClass:"wrap-content-tab"},[n("div",{directives:[{name:"t",rawName:"v-t",value:o.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),l==="keywords"||l==="wms_url"?n("div",{staticClass:"col-sm-10 value"},[n("span",[e._v(e._s([].concat(o.value).join(", ")))])]):l==="abstract"||!Array.isArray(o.value)&&typeof o.value!="object"?n("div",{staticClass:"col-sm-10 value"},[n("span",{domProps:{innerHTML:e._s(o.value)}})]):l!=="contactinformation"?n("div",{staticClass:"col-sm-10 value"},e._l(o.value,function(a,u){return n("div",[l==="extent"?n("span",{staticClass:"bbox-labels"},[e._v(e._s(["MINX","MINY","MAXX","MAXY"][u]))]):e._e(),e._v(" "),n("span",[e._v(e._s(a))])])}),0):n("div",{staticClass:"col-sm-10 value"},e._l(o.value,function(a,u){return n("div",[n("div",{staticClass:"row metadata-contact-row"},[n("div",{staticClass:"col-sm-2 metadata-contact-label"},[n("i",{staticClass:"contact-icon",class:e.$fa({contactelectronicmailaddress:"mail",personprimary:"user",contactvoicetelephone:"mobile"}[u]),attrs:{"aria-hidden":"true"}}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"metadata.general.fields.subfields.contactinformation."+u,expression:"`metadata.general.fields.subfields.contactinformation.${info}`"}]})]),e._v(" "),u==="personprimary"?n("div",{staticClass:"col-sm-10"},e._l(a,function(h,p){return n("div",[n("span",{directives:[{name:"t",rawName:"v-t",value:"metadata.general.fields.subfields.contactinformation."+p,expression:"`metadata.general.fields.subfields.contactinformation.${key}`"}],staticClass:"metadata-contact-label"}),e._v(" "),n("span",[e._v(e._s(h))])])}),0):u==="contactelectronicmailaddress"?n("div",{staticClass:"col-sm-10"},[n("a",{attrs:{href:"mailto: "+e.sanitizeValue(a)}},[n("b",[e._v(e._s(e.sanitizeValue(a)))])])]):n("div",{staticClass:"col-sm-10"},[e._v(e._s(e.sanitizeValue(a)))])])])}),0)])])}),0)}),e._v(" "),n("div",{staticClass:"tab-pane fade",attrs:{id:"metadata_layers"}},e._l(e.groups.layers.layers.value,function(s){return n("div",{staticClass:"row-info"},[n("h4",{staticClass:"layer_header",attrs:{"data-toggle":"collapse","data-target":"#"+s.id},on:{click:e.showHideInfo}},[n("i",{class:"layer-header-icon action-button "+e.g3wtemplate.font[s.geometrytype==="NoGeometry"?"table":"map"],attrs:{"aria-hidden":"true"}}),e._v(" "),n("span",{staticClass:"layer-name"},[e._v(e._s(s.name))]),e._v(" "),n("span",{staticClass:"action-button open-close",class:e.$fa("plus")})]),e._v(" "),n("div",{staticClass:"collapse",attrs:{id:s.id}},[n("ul",{staticClass:"metadata-nav-tabs nav nav-tabs layer-nav-tabs",attrs:{role:"tablist"}},[n("li",{staticClass:"active spatial-tab",attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"metadata.layers.groups.general",expression:"'metadata.layers.groups.general'"}],attrs:{href:"#layer_general_"+s.id,"aria-controls":"general",role:"tab","data-toggle":"tab"}})]),e._v(" "),s.geometrytype!=="NoGeometry"?n("li",{staticClass:"spatial-tab",attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"metadata.layers.groups.spatial",expression:"'metadata.layers.groups.spatial'"}],attrs:{href:"#layer_spatial_"+s.id,"aria-controls":"profile",role:"tab","data-toggle":"tab"}})]):e._e()]),e._v(" "),n("div",{staticClass:"tab-content layer-tab-content"},[n("div",{staticClass:"tab-pane active",attrs:{role:"tabpanel",id:"layer_general_"+s.id}},[n("div",{staticClass:"container-fluid"},[e._l(["metadata.title","name","source","metadata.abstract","metadata.keywords","metadata.metadataurl.onlineresource","metadata.dataurl.onlineresources","metadata.attributes"],function(o){return[o.split(".").reduce(function(l,a){return l[a]},s)!==void 0?n("div",{staticClass:"row layer-row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"metadata.layers.fields.subfields."+o.replace("metadata.","").split(".")[0],expression:"'metadata.layers.fields.subfields.' + attr.replace('metadata.', '').split('.')[0]"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),o==="metadata.title"?n("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(s.metadata.title))]):e._e(),e._v(" "),o==="name"?n("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(s.name))]):e._e(),e._v(" "),o==="source"?n("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(s.source.type))]):e._e(),e._v(" "),o==="metadata.abstract"?n("div",{staticClass:"col-md-10 col-sm-12 value",domProps:{innerHTML:e._s(s.metadata.abstract)}}):o==="metadata.keywords"?n("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(s.metadata.keywords.join(", ")))]):o==="metadata.metadataurl.onlineresource"?n("div",{staticClass:"col-md-10 col-sm-12 value"},[n("a",{attrs:{href:s.metadata.metadataurl.onlineresources}},[e._v(e._s(s.metadata.metadataurl.onlineresources))])]):o==="metadata.dataurl.onlineresources"?n("div",{staticClass:"col-md-10 col-sm-12 value"},[n("a",{attrs:{href:s.metadata.dataurl.onlineresources}},[e._v(e._s(s.metadata.dataurl.onlineresources))])]):o==="metadata.attributes"?n("div",{staticClass:"col-md-10 col-sm-12 value",staticStyle:{overflow:"auto"}},[n("table",{staticClass:"table table-striped",staticStyle:{"background-color":"#eee !important"}},[n("thead",[n("tr",e._l(s.metadata.attributes[0],function(l,a){return n("th",[e._v(e._s(a))])}),0)]),e._v(" "),n("tbody",e._l(s.metadata.attributes,function(l){return n("tr",e._l(l,function(a,u){return n("td",[e._v(e._s(a))])}),0)}),0)])]):e._e()]):e._e()]})],2)]),e._v(" "),n("div",{staticClass:"tab-pane",attrs:{role:"tabpanel",id:"layer_spatial_"+s.id}},[n("div",{staticClass:"container-fluid"},[e._l(["crs","geometrytype","bbox","metadata.crs"],function(o){return[o.split(".").reduce(function(l,a){return l[a]},s)!==void 0?n("div",{staticClass:"row layer-row"},[o==="metadata.crs"?n("div",{staticClass:"col-md-2 col-sm-12 metadata-label"},[e._v("CRS")]):n("div",{directives:[{name:"t",rawName:"v-t",value:"metadata.layers.fields.subfields."+o.replace("metadata.","").split(".")[0],expression:"'metadata.layers.fields.subfields.' + attr.replace('metadata.', '').split('.')[0]"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),o==="crs"?n("div",{staticClass:"col-sm-10 value"},[e._v(e._s(s.crs.epsg))]):o==="geometrytype"?n("div",{staticClass:"col-sm-10 value"},[e._v(e._s(s.geometrytype))]):o==="bbox"?n("div",{staticClass:"col-sm-10 value"},e._l(s.bbox,function(l,a){return n("p",[n("span",{staticStyle:{"font-weight":"bold","margin-right":"5px"}},[e._v(e._s(a))]),e._v(" "),n("span",[e._v(e._s(l))])])}),0):o==="metadata.crs"?n("div",{staticClass:"col-sm-10 value"},e._l(s.metadata.crs,function(l){return n("div",[n("span",[e._v(e._s(l))])])}),0):e._e()]):e._e()]})],2)])])])])}),0),e._v(" "),n("div",{staticClass:"tab-pane fade",attrs:{id:"metadata_credits"}},[e.customcredits?n("div",{staticClass:"customcredits",domProps:{innerHTML:e._s(e.customcredits)}}):e._e(),e._v(" "),e.powered_by?n("div",{staticClass:"g3w-credits-block"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"Application based on OS framework",expression:"'Application based on OS framework'"}],staticClass:"credit-title-logo",staticStyle:{padding:"5px"}}),e._v(" "),n("a",{attrs:{target:"_blank",href:"https://g3wsuite.it/"}},[n("img",{staticClass:"g3w-suite-logo",attrs:{src:e.urls.clienturl+"images/g3wsuite_logo.png",alt:""}})]),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"Publish and manage your QGIS projects on the web",expression:"'Publish and manage your QGIS projects on the web'"}],staticStyle:{"margin-top":"10px"}})]):e._e(),e._v(" "),e.powered_by?n("div",{directives:[{name:"t",rawName:"v-t:pre",value:"Framework developed by",expression:"'Framework developed by'",arg:"pre"}],staticClass:"credit-title-logo g3w-credits-block",staticStyle:{"font-size":"1em",display:"flex","justify-content":"center"}},[n("a",{staticStyle:{"text-align":"center!important"},attrs:{href:"http://www.gis3w.it",target:"_blank"}},[n("img",{staticClass:"img-responsive",staticStyle:{"margin-left":"auto",display:"block","margin-right":"auto"},attrs:{width:"60",src:e.urls.clienturl+"images/logo_gis3w_156_85.png",alt:""}})])]):e._e(),e._v(" "),e.powered_by?n("address",{staticStyle:{"line-height":"1.3","text-align":"center","margin-top":"5px",display:"flex","justify-content":"center",gap:"5px"},attrs:{id:"address-credits"}},[n("span",[e._v("\u{1F4CD} Montecatini Terme - Italy")]),e._v(" "),n("a",{staticStyle:{color:"#000"},attrs:{href:"tel:+393938534336"}},[e._v("\u{1F4F1} +39 393 8534336")]),e._v(" "),n("a",{staticStyle:{color:"#000"},attrs:{href:"mailto:info@gis3w.it"}},[e._v("\u2709\uFE0F info@gis3w.it")])]):e._e(),e._v(" "),e.powered_by?n("div",{staticStyle:{display:"flex","justify-content":"center",gap:"20px"}},[n("a",{attrs:{href:e.docs_url,rel:"nofollow",target:"_blank"}},[e._v("\u{1F4D6} Docs")]),e._v(" "),n("a",{attrs:{href:"mailto:info@gis3w.it?subject=Sponsoring%20G3W-SUITE%20development&body=Hi%20there,%20I'd%20like%20to%20fund%20some%20code%20changes:"}},[e._v("\u2764\uFE0F Sponsor")]),e._v(" "),n("a",{attrs:{href:"https://github.com/g3w-suite",target:"_blank"}},[e._v("\u{1F41E} Report a bug")])]):e._e(),e._v(" "),n("hr"),e._v(" "),e.powered_by&&e.g3wsdk_info?n("pre",{staticStyle:{cursor:"pointer"},attrs:{title:"click to copy"},on:{click:e.copy_g3wsdk_info}},[e._v(e._s(e.g3wsdk_info))]):e._e()])],2)]),e._v(" "),n("div",{staticClass:"modal-footer",staticStyle:{position:"relative",background:"#fff"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}})])])])])},nne=[],ine=function(e){e&&e("data-v-5265e46e_0",{source:'.metadata-item-tab.general[data-v-5265e46e]{color:var(--skin-primary)}.metadata-item-tab.layers[data-v-5265e46e]{color:var(--skin-warning)}.metadata-item-tab.spatial[data-v-5265e46e]{color:var(--skin-success)}#project-catalog[data-v-5265e46e]{background:0 0}.modal-header.nav[data-v-5265e46e]{display:flex;gap:1px;justify-content:space-between}.modal-header.nav li[data-v-5265e46e]{background-color:#e4e4e4;width:100%}.modal-header.nav li.active[data-v-5265e46e]{background-color:#fff}.modal-header.nav li.active a.metadata-item-tab[data-v-5265e46e]{border-bottom-color:var(--bgcolor)!important;border-bottom-width:4px;background-color:transparent!important;color:#2c3b41!important}.modal-header.nav li a.metadata-item-tab[data-v-5265e46e]{height:100%;margin:0;font-size:1.1em;border-top:0;border-right:0;border-left:0;border-bottom:4px solid #e2e2e2}.modal-header.nav li a[data-v-5265e46e]{text-align:center}.modal-header.nav li a i[data-v-5265e46e]{margin-right:5px}.metadata-item-tab[data-v-5265e46e]{margin-right:10px;border-radius:3px;margin-bottom:10px}.tab-title[data-v-5265e46e]{position:absolute;bottom:10px;right:auto}.row-info[data-v-5265e46e]{margin:0!important;padding-top:10px;padding-bottom:10px;border-bottom:1px solid #eee}.row-info .label[data-v-5265e46e]{font-weight:700}.h_100[data-v-5265e46e]{height:100%}#project-catalog[data-v-5265e46e]{position:relative;overflow:auto}.nav-tabs[data-v-5265e46e]{border-bottom:0 none}.metadata-label[data-v-5265e46e]{font-weight:700;font-size:1.1em}.bbox-labels[data-v-5265e46e]{font-weight:700}.metadata-contact-label[data-v-5265e46e]{font-weight:700}.contact-icon[data-v-5265e46e]{margin-right:3px}.metadata-contact-row[data-v-5265e46e]{margin-bottom:5px}.layer_header[data-v-5265e46e]{padding:5px;margin-bottom:0;margin-top:0;cursor:pointer}.layer-name[data-v-5265e46e]{font-weight:700}.layer-header-icon[data-v-5265e46e]{margin-right:10px;color:#999}.layer_header span.open-close[data-v-5265e46e]{position:absolute;right:5px;color:#999}.layer-row[data-v-5265e46e]{padding:10px;border-bottom:1px solid #e2e2e2}.layer-nav-tabs[data-v-5265e46e]{border-bottom:0 solid #ddd}.layer-nav-tabs>li.active>a[data-v-5265e46e],.layer-nav-tabs>li.active>a[data-v-5265e46e]:focus,.layer-nav-tabs>li.active>a[data-v-5265e46e]:hover{border-width:0}.layer-nav-tabs>li>a[data-v-5265e46e]{border:none;color:#aeaeae}.layer-nav-tabs>li.active>a[data-v-5265e46e],.layer-nav-tabs>li>a[data-v-5265e46e]:hover{border:none;background:0 0}.layer-nav-tabs>li>a[data-v-5265e46e]::after{content:"";height:2px;position:absolute;width:100%;left:0;bottom:-1px;transition:all 250ms ease 0s;transform:scale(0)}.layer-nav-tabs>li.active>a[data-v-5265e46e]::after,.layer-nav-tabs>li:hover>a[data-v-5265e46e]::after{transform:scale(1)}.layer-tab-content[data-v-5265e46e]{margin:10px;background-color:#eee;overflow:auto}.spatial-tab[data-v-5265e46e]{font-weight:700}.metadata-nav-tabs>li.active>a[data-v-5265e46e],.metadata-nav-tabs>li>a[data-v-5265e46e]:hover{color:var(--skin-color)!important}.metadata-nav-tabs>li>a[data-v-5265e46e]::after{background:var(--skin-color)}.modal-header.nav .action-button[data-v-5265e46e]:hover{background-color:transparent}.credit-title-logo[data-v-5265e46e]{font-weight:700;font-size:1.2em;margin-bottom:15px}.g3w-credits-block[data-v-5265e46e]{text-align:center!important;margin-bottom:20px}.g3w-suite-logo[data-v-5265e46e]{width:50%!important}.customcredits[data-v-5265e46e]{margin-bottom:10px;margin-top:5px;text-align:center}',map:void 0,media:void 0})},sne="data-v-5265e46e",rne=void 0,one=!1;function ane(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="ModalMetadata.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Iw(){let e=Iw.styles||(Iw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var lne=ane({render:tne,staticRenderFns:nne},ine,ene,sne,one,rne,!1,Iw,void 0,void 0),aO=lne;Rt();var cne={name:"app",data(){return{iframe:!1,language:null,cookie_law_buttonText:_e("Got It!"),app:F,state:F.viewport,updatePreviousTitle:!1,header:_e("main navigation"),custom_links:(window.initConfig.header_custom_links||[]).concat(F.navbaritems).filter(Boolean).map(e=>Object.assign(e,{id:e.id||Qe()}))}},components:{CookieLaw:lO.default,userMessage:E4,CatalogContextMenu:nO,ModalLogin:iO,ModalAddlayer:rO,ModalChangemap:oO,ModalMetadata:aO,Teleport:dg},computed:{languages(){let e=(Array.isArray(this.appconfig.i18n)&&this.appconfig.i18n||[]).sort((t,n)=>t[0].localeCompare(n[0]));return e.length>1&&e},dropdownParent(){return window.innerWidth>=768},appconfig(){return window.initConfig},isIframe(){return window.top!==window.self},urls(){return this.appconfig.urls},logo_url(){return F.project.state.thumbnail||`${this.appconfig.mediaurl}${window.initConfig.header_logo_img}`},project_title(){return F.project.getState().name},user(){return this.appconfig.user&&this.appconfig.user.username?this.appconfig.user:null},login_url(){return this.appconfig.user.login_url},has_iframe_login(){return this.login_url&&(this.login_url[0]==="/"||$h(this.login_url,window.location.href))},hasRelatedMaps(){return this.appconfig.macrogroups.length+this.appconfig.groups.length+this.appconfig.projects.length>1},main_title(){let e=this.appconfig.main_map_title,t=this.appconfig.title||this.appconfig.slug;return e?`${e} - ${t}`:t},breadcrumb(){return this.state.content.contentsdata.filter(e=>e.options.crumb).map(e=>e.options.crumb)},has_panel(){let e=F.gui.layout[F.gui.layout.__current].rightpanel;return e.width_100||e.height_100?!1:(this.state.split==="h"?e.width:e.height)>0},usermessage(){return this.state.usermessage},showtitle(){if(this.state.content.contentsdata.length>0){let e=this.state.content.contentsdata[this.state.content.contentsdata.length-1].options;if([!0,!1].includes(e.showtitle))return e.showtitle}return!0},styles(){return{map:{width:`${this.state.map.sizes.width}px`,height:`${this.state.map.sizes.height}px`},content:{width:`${this.state.content.sizes.width}px`,height:`${this.state.content.sizes.height}px`}}},contentTitle(){if(this.state.content.contentsdata.length){let{title:e,post_title:t,text:n=!1}=this.state.content.contentsdata[this.state.content.contentsdata.length-1].options;return{title:e,post_title:t,text:n}}},backOrBackTo(){return this.state.content.contentsdata.length>1&&this.state.content.showgoback?this.state.content.contentsdata[this.state.content.contentsdata.length-2].options.title?"backto":"back":!1},previousTitle(){let e=this.state.content.contentsdata.length>1&&this.state.content.showgoback?this.state.content.contentsdata[this.state.content.contentsdata.length-2].options.title:null;return this.updatePreviousTitle=!0,this.$nextTick(()=>this.updatePreviousTitle=!1),e},title(){return F.sidebar.title},disabled(){return F.gui.sidebar.disabled},panels(){return F.sidebar.contentsdata},showmainpanel(){return F.sidebar.components.length>0&&!this.panels.length},componentname(){return F.sidebar.components.length?F.sidebar.components.slice(-1)[0].getTitle():""},panelname(){return this.panels.length?this.panels.slice(-1)[0].content.getTitle():""}},methods:{onCustomItemClick(e,t){if(t.onclick)return e.preventDefault(),t.onclick();if(["modal","metadata"].includes(t.type)){if(e.preventDefault(),t.target&&t.type==="modal"&&document.querySelector(t.target))return $(t.target).modal("show");if(t.target&&t.type==="metadata"&&document.querySelector("#modal-metadata")){$("#modal-metadata").modal("show"),document.querySelector('#modal-metadata a[href="'+t.target+'"]').click();return}$("body").append(`
        <div id = "custom_modal" class = "modal fade" tabindex="-1">
          <div class = "modal-dialog">
            <div class  = "modal-content">${t.content}</div>
          </div>
        </div>
      `),$("#custom_modal").modal("show"),$("#custom_modal").on("hidden.bs.modal",()=>$("#custom_modal").remove())}},async showEmbedModal(){await T.getPermalink(new URL(window.location.href),{})},showaddLayerModal(){window.innerWidth<767&&T.hideSidebar(),$("#modal-addlayer").modal("show")},openChangeMapMenu(){window.innerWidth<767&&T.hideSidebar(),$("#modal-changemap").modal("show")},isNotLastCrumb(e){return e<this.breadcrumb.length-1},closeContent(){T.closeContent()},gotoPreviousContent(){T.popContent()},closeUserMessage(){T.closeUserMessage()},async onResize(e){let t=document.getElementById("g3w-view-content"),n=F.gui.layout[F.gui.layout.__current].rightpanel,s,o,l;this.state.content.disabled=!0;let a=h=>{h.preventDefault(),s=t.getBoundingClientRect(),o=h.pageX-s.left-window.scrollX,l=h.pageY-s.top-window.scrollY,n.width=Math.min(Math.max(Math.round(200/$(".content-wrapper").width()*100),Math.round((s.width-o)/$(".content-wrapper").width()*100)),90),n.height=Math.min(Math.max(Math.round(200/$(".content-wrapper").height()*100),Math.round((s.height-l)/$(".content-wrapper").height()*100)),90);let p=$("#app")[0].getBoundingClientRect().width-$(".main-sidebar")[0].getBoundingClientRect().width-$(".main-sidebar").offset().left,d=$(window).height()-$(".navbar").height(),_=this.state.split==="h",m=this.state.split==="v",v=(_?n.width:n.height)/100;Object.assign(this.state.content.sizes,{width:_?p*v:p,height:m?d*v:d})},u=async h=>{document.removeEventListener("mousemove",a),!this.disabled&&this.state.split==="h"&&n.width>65&&T.hideSidebar(),this.state.content.disabled=!1,T._layout()};document.addEventListener("mousemove",a),document.addEventListener("mouseup",u,{once:!0})},resizeFull(){let e=F.viewport,t=F.gui.layout[F.gui.layout.__current].rightpanel;e.split==="h"?t.width_100=!t.width_100:t.height_100=!t.height_100,T._layout()},splitContent(e){let t=T.getCurrentContent().options.split;F.viewport.split=T.getCurrentContent().options.split=t==="v"?"h":"v",e.target.setAttribute("data-original-title",`Dock ${t==="h"?"right":"bottom"}`),T._layout()},closePanel(){T.closePanel()},async closeAllPanels(){F.sidebar.title=null;let e=F.sidebar.contentsdata;e.length&&(await Promise.allSettled(e.map(async t=>{t.content instanceof pt||t.content instanceof Un?await Ot(t.content.unmount()):$(F.sidebar.parent).empty()})),e.splice(0,e.length))},toggleSidebar(){T.toggleSidebar()},toggleSidebarItem(e){let t=document.body.classList.contains("sidebar-mini"),n=document.body.classList.contains("sidebar-collapse");t&&n&&T.showSidebar();let s=e.target.closest(".sidebaritem"),o=F.sidebar.components.find(u=>u.id===s.id),l=o&&o.getOpen(),a=s.querySelector(".treeview-menu");!o||l&&n||a&&a.contains(e.target)||(!o.collapsible&&window.innerWidth<=767&&T.toggleSidebar(),o.click({open:!l}))}},watch:{language:{immediate:!0,async handler(e){if(e){try{_e.register(e,(await import(`${initConfig.urls.clienturl}locales/${e}.js`)).default)}catch(t){T.showUserMessage({type:"warning",message:t.toString(),autoclose:!0})}F.language=e,history.replaceState(null,null,window.location.pathname.split("/").map((t,n)=>n===1?e:t).join("/")),await vi(()=>{let t=Object.keys(F.locales[e]),n=Object.keys(initConfig.plugins),s=Array.from(new Set(Object.keys(F.locales.en).filter(l=>l.startsWith("plugins.")).map(l=>l.split(".")[1]))),o=Array.from(new Set(t.filter(l=>l.startsWith("plugins.")).map(l=>l.split(".")[1])));return t.length&&n.filter(l=>s.includes(l)).length===o.length}),setTimeout(()=>{T.emit("i18n-ready",e),this.cookie_law_buttonText=_e("Got It!"),$.extend($.fn.dataTableExt.oStdClasses,{sFilterInput:"form-control search"}),$.extend(!0,$.fn.dataTable.defaults,{language:{sSearch:"",searchPlaceholder:_e("dosearch"),sLengthMenu:_e("Show _MENU_ values per page"),paginate:{previous:"\xAB",next:"\xBB"},info:_e("_TOTAL_ entries"),zeroRecords:_e("No matching records found"),infoFiltered:""}})},500)}}}},created(){this.language=this.appconfig.user.i18n},async mounted(){this.language=this.appconfig.user.i18n,await this.$nextTick(),$("#startingspinner").remove(),document.body.classList.toggle("is-mobile",this.isMobile()),document.body.classList.toggle("is-iframe",F.iframe),F.iframe||document.body.classList.add("sidebar-mini")}},une=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.app.gui.app.disabled,expression:"app.gui.app.disabled"}],staticClass:"wrapper",attrs:{id:"app"}},[e.isIframe?e._e():n("nav",{ref:"navbar",staticClass:"navbar no-print",staticStyle:{display:"flex","justify-content":"start",height:"50px"},attrs:{role:"navigation"}},[e.logo_url?n("a",{staticStyle:{padding:"4px",display:"inline-block",height:"50px"},attrs:{href:e.appconfig.header_logo_link||e.urls.frontendurl||"#",target:e.appconfig.header_logo_link?"_blank":""}},[n("img",{staticStyle:{height:"100%"},attrs:{alt:"",src:e.logo_url}})]):e._e(),e._v(" "),n("button",{staticClass:"navbar-toggler",attrs:{hidden:""},on:{click:function(s){return s.preventDefault(),e.toggleSidebar.apply(null,arguments)}}},[n("i",{class:e.$fa("bars")}),n("b",{staticStyle:{"margin-left":"8px"}},[e._v("MENU")])]),e._v(" "),n("hgroup",{staticClass:"project_title"},[n("p",{staticClass:"h2"},[e._v(e._s(e.main_title))]),e._v(" "),n("h1",[e._v(e._s(e.project_title))])]),e._v(" "),n("ul",{staticClass:"nav-links",staticStyle:{display:"flex","text-align":"center","white-space":"nowrap","list-style":"none",padding:"0",margin:"0"}},[e._l(e.custom_links,function(s){return n("li",{key:s.id,class:"nav-"+s.id,style:{order:s.position},attrs:{id:"g3w-nav-custom-links-"+s.id}},[n("a",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:s.i18n?s.title:"&nbsp;"+s.title+"&nbsp;",expression:"item.i18n ? item.title : ('&nbsp;' + item.title + '&nbsp;')"}],attrs:{href:s.url||"#",target:s.target,"data-placement":"bottom"},on:{click:function(o){return e.onCustomItemClick(o,s)}}},[s.icon?n("i",{class:s.icon}):e._e(),e._v(" "),s.img?n("img",{attrs:{height:"20",src:s.img,title:s.img_title,alt:s.img_title}}):e._e(),e._v(" "),s.i18n?n("span",{directives:[{name:"t",rawName:"v-t",value:s.text||s.title||s.img_title,expression:"item.text || item.title || item.img_title"}],attrs:{hidden:s.text?void 0:""}}):e._e(),e._v(" "),s.i18n?e._e():n("span",{attrs:{hidden:s.text?void 0:""},domProps:{innerHTML:e._s(s.text||s.title||s.img_title)}})])])}),e._v(" "),n("li",{staticClass:"nav-user dropdown",attrs:{id:"g3w-nav-account"}},[n("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[n("i",{class:e.$fa("user")}),e._v(" "),e.user?n("span",[e._v(e._s(e.user.username))]):n("span",{directives:[{name:"t",rawName:"v-t",value:"sign_in",expression:"'sign_in'"}]}),e._v(" "),n("i",{staticClass:"triangle"})]),e._v(" "),n("ul",{staticClass:"dropdown-menu"},[e.user?n("li",{staticClass:"user-header"},[e._v(`
            \u{1F44B}
            `),!e.user.first_name&&!e.user.last_name?n("span",[e._v(e._s(e.user.username))]):n("span",[e._v(e._s(e.user.first_name)+" "+e._s(e.user.last_name))])]):e._e(),e._v(" "),n("li",{staticClass:"user-footer"},[e.user?e._e():n("a",{staticClass:"nav-login btn btn-default btn-flat skin-color",attrs:{src:e.login_url,"data-toggle":e.has_iframe_login?"modal":void 0,"data-target":e.has_iframe_login?"#modal-login":void 0}},[n("b",{directives:[{name:"t",rawName:"v-t",value:"sign_in",expression:"'sign_in'"}]}),n("i",{class:e.$fa("sign-in")})]),e._v(" "),e.user&&e.user.admin_url?n("a",{staticClass:"nav-admin btn btn-default btn-flat skin-color",attrs:{href:e.user.admin_url}},[n("b",[e._v("Admin")]),n("i",{class:e.$fa("tool")})]):e._e(),e._v(" "),e.urls.frontendurl?n("a",{staticClass:"nav-home btn btn-default btn-flat skin-color",attrs:{href:e.urls.frontendurl}},[n("b",{directives:[{name:"t",rawName:"v-t",value:"homepage",expression:"'homepage'"}]}),n("i",{class:e.$fa("home")})]):e._e(),e._v(" "),e.user&&e.user.logout_url?n("a",{staticClass:"nav-logout btn btn-default btn-flat skin-color",attrs:{href:e.user.logout_url}},[n("b",{directives:[{name:"t",rawName:"v-t",value:"Logout",expression:"'Logout'"}]}),n("i",{class:e.$fa("sign-out")})]):e._e(),e._v(" "),n("a",{staticClass:"nav-embedmap btn btn-default btn-flat skin-color",attrs:{href:"#"},on:{click:e.showEmbedModal}},[n("b",{directives:[{name:"t",rawName:"v-t",value:"Embed map",expression:"'Embed map'"}]}),n("i",{class:e.$fa("share-alt")})]),e._v(" "),e.hasRelatedMaps?n("a",{staticClass:"nav-changemap btn btn-default btn-flat",attrs:{href:"#"},on:{click:e.openChangeMapMenu}},[n("b",{directives:[{name:"t",rawName:"v-t",value:"changemap",expression:"'changemap'"}]}),n("i",{class:e.$fa("refresh")})]):e._e(),e._v(" "),n("a",{staticClass:"nav-addlayer btn btn-default btn-flat",attrs:{href:"#"},on:{click:e.showaddLayerModal}},[n("b",{directives:[{name:"t",rawName:"v-t",value:"Add Layer",expression:"'Add Layer'"}]}),n("i",{class:e.$fa("layers")})])])])]),e._v(" "),e.languages?n("li",{staticClass:"nav-lang",attrs:{id:"g3w-nav-language"}},[n("button",{staticStyle:{display:"flex",gap:"5px"},attrs:{type:"button",commandfor:"nav-lang-dialog",command:"show-modal"}},[n("img",{attrs:{src:e.urls.staticurl+"img/flags/"+e.language.toLowerCase()+".png",width:"24",height:"16",alt:""}}),e._v(`
          `+e._s(e.languages.find(function(s){return s[0]===e.language}).at(1))+`
          `),n("i",{staticClass:"triangle",staticStyle:{"margin-top":"8px"}})]),e._v(" "),n("dialog",{attrs:{id:"nav-lang-dialog"},on:{click:function(s){s.target===s.target.closest("dialog")&&s.target.closest("dialog").close()}}},[n("form",{staticStyle:{display:"grid","grid-template-columns":"repeat(auto-fill, minmax(120px, 1fr))",gap:"10px","user-select":"none"},attrs:{method:"dialog"}},e._l(e.languages,function(s){return n("label",{key:s[0],staticStyle:{cursor:"pointer","text-align":"left"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.language,expression:"language"}],staticStyle:{"pointer-events":"none","margin-right":"8px"},attrs:{type:"radio"},domProps:{value:s[0],checked:e._q(e.language,s[0])},on:{click:function(o){o.target.closest("dialog").close()},change:function(o){e.language=s[0]}}}),e._v(" "),n("img",{attrs:{src:e.urls.staticurl+"img/flags/"+s[0].toLowerCase()+".png",width:"24",height:"16",alt:s[0].toLowerCase()}}),e._v(" "),n("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(s[1]))])])}),0)])]):e._e()],2)]),e._v(" "),n("aside",[n("div",{staticClass:"main-sidebar no-print",class:{iframe:e.iframe,"g3w-disabled":e.disabled}},[n("div",{attrs:{id:"disable-sidebar"}}),e._v(" "),n("div",{staticClass:"g3w-sidebarpanel",attrs:{hidden:e.panels.length<=0}},[n("div",{attrs:{id:"g3w-sidebarpanel-header-placeholder"}},[n("div",{staticStyle:{display:"flex","margin-bottom":"5px"},style:{justifyContent:e.app.sidebar.title?"space-between":"flex-end"}},[e.title?n("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticStyle:{display:"inline-block","font-weight":"bold"}}):e._e(),e._v(" "),n("div",[e.panels.length>1?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"back",expression:"'back'"}],staticClass:"g3w-span-button close-pane-button",attrs:{"data-placement":"left"},on:{click:function(s){return s.stopPropagation(),e.closePanel.apply(null,arguments)}}},[n("i",{staticClass:"panel-icon",class:e.$fa("arrow-left")})]):e._e(),e._v(" "),n("span",{staticClass:"g3w-span-button close-pane-button",attrs:{"data-i18n-title":e.app.sidebar.tooltip_close||"close","data-placement":"right"},on:{click:function(s){s.stopPropagation(),e.app.sidebar.btn_close&&e.closeAllPanels()}}},[n("i",{staticClass:"panel-icon",class:e.$fa("close"),style:{opacity:e.app.sidebar.btn_close?"1":"0.7",cursor:e.app.sidebar.btn_close?"pointer":"not-allowed"}})])])])]),e._v(" "),n("div",{staticClass:"g3w-sidebarpanel-placeholder",attrs:{id:"g3w-sidebarpanel-placeholder"}})]),e._v(" "),n("ul",{staticClass:"sidebar-menu",class:{"g3w-disabled":e.disabled},attrs:{id:"g3w-sidebarcomponents",hidden:!e.showmainpanel},on:{click:e.toggleSidebarItem}},[n("li",{staticClass:"treeview sidebaritem",attrs:{id:"metadata"}},[n("a",{attrs:{href:"#","data-toggle":"modal","data-target":"#modal-metadata"}},[n("i",{class:e.$fa("file"),staticStyle:{color:"#fff"}}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"Metadata",expression:"'Metadata'"}],staticClass:"treeview-label"})])])])]),e._v(" "),n("a",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Sidebar menu",expression:"'Sidebar menu'"}],staticClass:"sidebar-aside-toggle",class:{"g3w-disabled":e.disabled,iframe:e.iframe},staticStyle:{"z-index":"2"},attrs:{href:"#",role:"button","data-placement":"right"},on:{click:function(s){return s.preventDefault(),e.toggleSidebar.apply(null,arguments)}}})]),e._v(" "),n("div",{staticClass:"content-wrapper",style:{paddingTop:e.isIframe?0:null}},[n("transition",{attrs:{name:"fade",duration:{enter:500,leave:500}}},[e.usermessage.show?n("user-message",{attrs:{title:e.usermessage.title,subtitle:e.usermessage.subtitle,id:e.usermessage.id,message:e.usermessage.message,draggable:e.usermessage.draggable,closable:e.usermessage.closable,duration:e.usermessage.duration,position:e.usermessage.position,autoclose:e.usermessage.autoclose,textMessage:e.usermessage.textMessage,size:e.usermessage.size,type:e.usermessage.type,"icon-class":e.usermessage.iconClass},on:{"close-usermessage":e.closeUserMessage}},[e.usermessage.hooks.header?n("template",{slot:"header"},[n(e.usermessage.hooks.header,{tag:"component"})],1):e._e(),e._v(" "),e.usermessage.hooks.body?n("template",{slot:"body"},[n(e.usermessage.hooks.body,{tag:"component"})],1):e._e(),e._v(" "),e.usermessage.hooks.footer?n("template",{slot:"footer"},[n(e.usermessage.hooks.footer,{tag:"component"})],1):e._e()],2):e._e()],1),e._v(" "),n("div",{staticClass:"g3w-view map",class:"split-"+e.state.split,style:e.styles.map,attrs:{id:"g3w-view-map"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.has_panel,expression:"has_panel"}],class:"split-"+e.state.split,attrs:{id:"resize-map-and-content"},on:{mousedown:function(s){return s.stopPropagation(),e.onResize.apply(null,arguments)}}}),e._v(" "),n("div",{attrs:{id:"application-notifications"}},[n("div",{class:{"g3w-hide":e.app.online},staticStyle:{color:"#999"}},[n("i",{class:e.$fa("wifi")}),e._v(" "),n("b",{staticStyle:{"font-size":"0.4em"}},[e._v("offline")])]),e._v(" "),n("div",{class:{"skin-color":!0,"g3w-hide":!e.app.download}},[n("bar-loader",{attrs:{loading:!0}}),e._v(" "),n("i",{class:e.$fa("download"),staticStyle:{padding:"3px"}}),e._v(" "),n("b",{staticStyle:{"font-size":"0.35em"}},[e._v("download")])],1),e._v(" "),n("div",{class:{"g3w-hide":e.app.plugins.length===0},staticStyle:{color:"#994b10"}},[n("bar-loader",{attrs:{loading:!0}}),e._v(" "),n("i",{class:e.$fa("tools")}),e._v(" "),n("b",{staticStyle:{"font-size":"0.4em"}},[e._v("plugins")])],1)])]),e._v(" "),n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.content.disabled,expression:"state.content.disabled"}],staticClass:"g3w-view content",class:"split-"+e.state.split,style:e.styles.content,attrs:{id:"g3w-view-content"}},[e.breadcrumb.length>1?n("section",{ref:e.breadcrumb,staticClass:"content_breadcrumb"},e._l(e.breadcrumb,function(s,o){return n("span",{key:s.title},[n("span",{directives:[{name:"t",rawName:"v-t",value:s.text?null:s.title,expression:"crumb.text ? null : crumb.title"}],staticClass:"skin-color-dark",style:{fontWeight:e.isNotLastCrumb(o)?"bold":"normal"}},[s.text?n("span",[e._v(" "+e._s(s.title)+" ")]):e._e()]),e._v(" "),e.isNotLastCrumb(o)?n("span",{staticStyle:{"font-weight":"bold",margin:"3px 0"}},[e._v("/")]):e._e()])}),0):e._e(),e._v(" "),e.showtitle&&e.contentTitle||e.previousTitle||e.state.content.closable?n("div",{staticClass:"close-panel-block",staticStyle:{display:"flex","justify-content":"space-between"}},[e.previousTitle?n("div",{staticClass:"g3w_contents_back g3w-long-text"},[e.backOrBackTo==="back"?n("div",{class:e.backOrBackTo},[n("span",{staticClass:"action-button",class:e.$fa("back")}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}]})]):n("div",{class:e.backOrBackTo,on:{click:function(s){return s.stopPropagation(),e.gotoPreviousContent()}}},[n("span",{staticClass:"action-button",class:e.$fa("back")}),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"backto",expression:"'backto'"}]}),e._v(" "),e.updatePreviousTitle?e._e():n("span",{directives:[{name:"t",rawName:"v-t",value:e.previousTitle,expression:"previousTitle"}]})])]):e._e(),e._v(" "),!e.previousTitle&&e.showtitle&&e.contentTitle?n("div",{staticClass:"panel-title",class:{mobile:e.isMobile()},style:[e.state.content.style.title]},[n("b",{attrs:{id:"contenttitle"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:e.contentTitle.text?null:e.contentTitle.title,expression:"contentTitle.text ? null : contentTitle.title"}]},[e.contentTitle.text?n("span",[e._v(e._s(e.contentTitle.title))]):e._e()]),e._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:e.contentTitle.post_title,expression:"contentTitle.post_title"}]})])]):e._e(),e._v(" "),n("div",{staticClass:"g3-content-header-action-tools",staticStyle:{display:"flex","align-items":"center",gap:".5ch",padding:"0 .5ch"}},[e._l(e.state.content.headertools,function(s){return n(s,{tag:"component"})}),e._v(" "),n("div",{staticStyle:{display:"flex","justify-content":"space-between","font-size":"1em",padding:"0","align-self":"center","margin-left":"auto",cursor:"pointer"}},[e.state.split!==void 0?n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom",value:"Enlarge / Reduce",expression:"'Enlarge / Reduce'",arg:"bottom"}],staticClass:"action-button skin-color-dark",class:e.$fa("resize-"+e.state.split),staticStyle:{"margin-right":"3px"},on:{click:e.resizeFull}}):e._e()]),e._v(" "),n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom",value:"Dock to "+(this.state.split==="h"?"Bottom":"Right"),expression:"`Dock to ${'h' === this.state.split ? 'Bottom' : 'Right'}`",arg:"bottom"}],staticClass:"action-button skin-color-dark fa fa-external-link-alt",staticStyle:{cursor:"pointer",scale:".9"},style:{transform:e.state.split==="h"?"rotate(134deg)":"rotate(44deg)"},on:{click:e.splitContent}}),e._v(" "),e.state.content.closable?n("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom",value:"close",expression:"'close'",arg:"bottom"}],staticClass:"action-button skin-color-dark fas fa-times",class:{mobile:e.isMobile()},on:{click:e.closeContent}}):e._e()],2)]):e._e(),e._v(" "),n("bar-loader",{attrs:{loading:e.state.content.loading}})],1)],1),e._v(" "),n("catalog-context-menu"),e._v(" "),n("cookie-law",{attrs:{theme:"dark-lime",buttonText:e.cookie_law_buttonText}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"This website uses cookies to ensure you get the best experience on our website.",expression:"'This website uses cookies to ensure you get the best experience on our website.'"}],attrs:{slot:"message"},slot:"message"})]),e._v(" "),n("Teleport",{attrs:{to:"body"}},[n("div",{staticClass:"modal fade modal-fullscreen",attrs:{id:"modal-fullscreen",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false","aria-labelledby":"modal-fullscreen","aria-hidden":"true"}}),e._v(" "),!e.user&&e.has_iframe_login?n("modal-login"):e._e(),e._v(" "),n("modal-addlayer"),e._v(" "),n("modal-changemap"),e._v(" "),n("modal-metadata")],1)],1)},dne=[],hne=function(e){e&&e("data-v-5e256101_0",{source:".project_title[data-v-5e256101]{display:inline-flex;flex-direction:column;justify-content:center;height:100%;font-weight:700;color:#fff;max-height:50px;overflow:hidden;max-width:calc(100% - 150px)}.project_title>*[data-v-5e256101]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:700;margin:0}.project_title .h2[data-v-5e256101]{font-size:1.5em}.project_title h1[data-v-5e256101]{font-size:1.2em;padding-bottom:5px}#g3w-sidebarpanel-header-placeholder[data-v-5e256101]{overflow:hidden;line-height:14px;font-size:1.5em;min-height:35px;border-bottom:1px solid #fff;margin-bottom:5px}#disable-sidebar[data-v-5e256101]{display:none;position:absolute;background-color:rgba(0,0,0,.3);height:100%;width:100%;z-index:10}.content_breadcrumb[data-v-5e256101]{font-size:1.2em;padding:0 3px;border-radius:3px}.close-panel-block[data-v-5e256101]{overflow:hidden;margin-top:2px;margin-bottom:2px;font-size:1.4em}.g3w_contents_back[data-v-5e256101]{font-size:.8em}.g3w_contents_back[data-v-5e256101] :is(.backto,.back){display:inline-block;font-weight:700}.g3w_contents_back .backto[data-v-5e256101]{margin-top:5px;cursor:pointer}.user-header[data-v-5e256101]{padding:10px;text-align:center;border-bottom:1px solid rgba(0,0,0,.3)}.user-footer[data-v-5e256101]{padding:8px;display:flex;justify-content:space-between;flex-direction:column;gap:8px}.user-footer .btn-default[data-v-5e256101]{color:rgba(0,0,0,.75);border-color:currentColor;display:flex;flex-direction:row-reverse;justify-content:left;align-items:center;gap:8px}.user-footer .btn-default[data-v-5e256101]:not(:hover){background-color:transparent}.nav-user>.dropdown-menu[data-v-5e256101]{padding:1px 0 0 0;border:1px solid #aaa;border-top-width:0;border-radius:0;margin-top:0}i.triangle[data-v-5e256101]{border-color:#fff transparent transparent transparent;border-style:solid;border-width:5px 4px 0 4px;display:inline-block;margin:3px}.open i.triangle[data-v-5e256101]{border-color:transparent transparent #fff transparent;border-width:0 4px 5px 4px}@media (min-width:767px){.user-footer :is(.nav-sidebar,.nav-addlayer).btn-default[data-v-5e256101]{display:none}.project_title[data-v-5e256101]{margin-right:auto}}@media (max-width:767px){.nav-user>.dropdown-toggle[data-v-5e256101],.user-header[data-v-5e256101],body:not(.sidebar-open) .navbar-toggler~*[data-v-5e256101]{display:none!important}.navbar-nav[data-v-5e256101]{flex-direction:column}.user-footer .btn-default[data-v-5e256101]{padding:10px}.user-footer[data-v-5e256101]{background-color:transparent;border:none}.nav-user>ul[data-v-5e256101]{display:block;position:static;float:none;border:none;background-color:transparent}.nav-user .btn[data-v-5e256101]{color:#fff!important}.nav-user>.dropdown-menu[data-v-5e256101]{border:none}}",map:void 0,media:void 0})},fne="data-v-5e256101",pne=void 0,gne=!1;function mne(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="App.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Lw(){let e=Lw.styles||(Lw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var _ne=mne({render:une,staticRenderFns:dne},hne,cne,fne,gne,pne,!1,Lw,void 0,void 0),Nw=_ne;var yne={name:"bar-loader",props:{loading:{type:Boolean|String,default:!1},color:{type:String,default:null}}},vne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.loading?n("div",{staticClass:"bar-loader",class:{color:e.color?"skin-background-color":null},staticStyle:{border:"0"},style:{backgroundColor:e.color}}):e._e()},bne=[],xne=void 0,wne=void 0,Sne=void 0,Ene=!1;function Cne(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="GlobalBarLoader.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Ine=Cne({render:vne,staticRenderFns:bne},xne,yne,wne,Ene,Sne,!1,void 0,void 0,void 0),S_=Ine;var Lne={name:"progressbar",props:["progress"]},Nne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.progress!==null&&e.progress!==void 0?n("div",{staticStyle:{margin:"5px 0 5px 0",width:"100%","background-color":"#FFFFFF",border:"0","border-radius":"3px"}},[n("div",{staticClass:"skin-background-color",staticStyle:{display:"flex","justify-content":"center","font-weight":"bold"},style:{width:e.progress<10?10:e.progress}},[n("span",[e._v(e._s(e.progress))])])]):e._e()},Tne=[],kne=void 0,Rne=void 0,Mne=void 0,Ane=!1;function One(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="GlobalProgressBar.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Pne=One({render:Nne,staticRenderFns:Tne},kne,Lne,Rne,Ane,Mne,!1,void 0,void 0,void 0),E_=Pne;var Fne={name:"helpdiv",props:{message:{type:String,required:!0},type:{type:String,default:"info"}}},Dne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"help_div_container"},[n("span",{staticClass:"help_icon"},[e._v("i")]),e._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"g3w-help-message-content"})])},Gne=[],jne=function(e){e&&e("data-v-16d3632e_0",{source:".help_div_container[data-v-16d3632e]{color:#fff;text-align:justify;position:relative;border-radius:3px;margin:5px 2px 5px 2px;white-space:pre-line;background-color:#384246!important}.help_icon[data-v-16d3632e]{text-align:center;font-size:.7em;margin-top:-4px;margin-left:-4px;background-color:var(--bgcolor);font-weight:700;color:#fff;position:absolute;top:0;left:0;width:15px;height:15px;border:1px solid #fff;border-radius:50%}.g3w-help-message-content[data-v-16d3632e]{max-height:200px;padding:10px;overflow-y:auto}",map:void 0,media:void 0})},qne="data-v-16d3632e",$ne=void 0,Bne=!1;function Une(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="GlobalHelpDiv.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Tw(){let e=Tw.styles||(Tw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var zne=Une({render:Dne,staticRenderFns:Gne},jne,Fne,qne,Bne,$ne,!1,Tw,void 0,void 0),C_=zne;Ke();Wt();var Vne={name:"datetime",props:{type:{type:String,default:"date"},format:{type:String,default:"YYYY-MM-DD"},minDate:{default:!1},maxDate:{default:!1},enabledDates:{default:!1},value:{},label:{default:"Date"}},data(){return{datetimevalue:this.value}},methods:{changeInput(e){},change(e){let t=moment(e).format(this.format);this.$emit("change",t)}},async mounted(){await this.$nextTick(),this.datetimeinputelement=$(this.$refs.iddatetimepicker),this.datetimeinputelement.datetimepicker({minDate:this.minDate,maxDate:this.maxDate,defaultDate:this.datetimevalue,useCurrent:!1,allowInputToggle:!0,enabledDates:this.enabledDates,showClose:!0,format:this.format,locale:F.language,toolbarPlacement:"top",widgetPositioning:{horizontal:"right"}}),this.datetimeinputelement.on("dp.change",({date:e})=>{this.change(e)}),this.datetimeinputelement.on("dp.hide",e=>{}),F.ismobile&&setTimeout(()=>datetimeinputelement.blur())},watch:{value(e){this.datetimevalue=e,this.datetimeinputelement.data("DateTimePicker").date(e)},async minDate(e){this.datetimeinputelement.data("DateTimePicker").minDate(e)},async maxDate(e){this.datetimeinputelement.data("DateTimePicker").maxDate(e)},enabledDates(e){this.datetimeinputelement.data("DateTimePicker").enabledDates(e)}},created(){this.id=Qe()}},Hne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"datimecontainer"},[n("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticStyle:{display:"block"},attrs:{for:e.id}}),e._v(" "),n("div",{staticClass:"form-group"},[n("div",{ref:"iddatetimepicker",staticClass:"input-group date"},[n("input",{ref:"idinputdatetimepiker",staticClass:"form-control",attrs:{id:e.id,type:"text"},on:{change:e.changeInput}}),e._v(" "),n("span",{staticClass:"input-group-addon caret"},[n("span",{staticClass:"datetimeinput",class:e.g3wtemplate.getFontClass(e.type==="time"?"time":"calendar")})])])])])},Wne=[],Yne=void 0,Xne="data-v-8140967e",Zne=void 0,Qne=!1;function Kne(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};return d.__file="GlobalDateTime.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s,d}var Jne=Kne({render:Hne,staticRenderFns:Wne},Yne,Vne,Xne,Qne,Zne,!1,void 0,void 0,void 0),I_=Jne;Us();var eie={name:"range",props:{id:{default:void 0},label:{type:String,default:""},min:{type:Number,default:0},max:{type:Number,default:10},step:{type:Number,default:1},labelValue:{},value:{default:0},sync:{type:Boolean,default:!1},showValue:{type:Boolean,default:!1},unit:{type:String,default:""}},data(){return{state:{value:this.value}}},methods:{changeBackGround(e){this.$refs["range-input"].style.backgroundSize=`${e?(e-this.min)*100/(this.max-this.min):0}% 100%`},setValue(e){this.changedValue(e)},change(e){this.changedValue(1*e.target.value)},emitChangeValue(e){this.state.value=e,this.$emit("change-range",{id:this.id,value:e})}},watch:{value(e){this.state.value=e},"state.value"(e){this.changeBackGround(e),this.sync&&this.emitChangeValue(e)}},created(){this.changedValue=this.sync?()=>this.$emit("changed"):un(e=>{this.emitChangeValue(e)})},async mounted(){await this.$nextTick(),this.changeBackGround(this.value)}},tie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("section",{staticStyle:{display:"flex","justify-content":"space-between","font-weight":"bold"}},[n("section",{staticStyle:{"align-self":"flex-end"}},[n("span",{staticClass:"min-max-label"},[e._v(e._s(e.min))]),e._v(" "),n("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.unit))])]),e._v(" "),n("div",{staticStyle:{display:"flex","flex-direction":"column",margin:"0 3px"}},[n("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticClass:"skin-color",staticStyle:{display:"block"},attrs:{for:e.id}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],ref:"range-input",attrs:{type:"range",id:e.id,min:e.min,max:e.max,step:e.step},domProps:{value:e.state.value},on:{change:e.change,__r:function(s){return e.$set(e.state,"value",s.target.value)}}})]),e._v(" "),n("section",{staticStyle:{"align-self":"flex-end"}},[n("span",{staticClass:"min-max-label"},[e._v(e._s(e.max))]),e._v(" "),n("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.unit))])])]),e._v(" "),e.showValue?[n("span",[e._v(e._s(e.state.value))]),e._v(" "),n("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.unit))])]:e._e()],2)},nie=[],iie=function(e){e&&e("data-v-efe7be7e_0",{source:".min-max-label[data-v-efe7be7e]{align-self:end;font-weight:700}",map:void 0,media:void 0})},sie="data-v-efe7be7e",rie=void 0,oie=!1;function aie(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="GlobalRange.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function kw(){let e=kw.styles||(kw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var lie=aie({render:tie,staticRenderFns:nie},iie,eie,sie,oie,rie,!1,kw,void 0,void 0),L_=lie;ft();ei();Zm();Ke();var cie=pc(),uie={name:"node",props:["contenttype","node","fields","showTitle","addToValidate","removeToValidate","changeInput","layerid","feature","showRelationByField","handleRelation"],components:{G3wInput:ru,...cie},data(){return{context:this.contenttype,editing_required:!1}},computed:{filterNodes(){return this.node.nodes&&this.node.nodes.filter(t=>this.getNodeType(t)==="group"?!0:!t.nodes&&t.name&&this.getNodeType(t)!="group"?(t.relation=!0,!0):!!this.fields.find(n=>(t.field_name?t.field_name.replace(/ /g,"_"):t.field_name)===n.name||t.relation))||[]},nodesLength(){return this.filterNodes.length},rows(){let e=1;return this.nodesLength===0?e=0:this.columnNumber<=this.nodesLength&&(e=Math.floor(this.nodesLength/this.columnNumber)+this.nodesLength%this.columnNumber),e},columnNumber(){let e=parseInt(this.node.columncount)?parseInt(this.node.columncount):1;return e>this.nodesLength?this.nodesLength:e},showGroupTile(){return this.showTitle&&this.node.showlabel&&this.node.groupbox}},methods:{loadingRelation(e){return(F.project.getLayerById(this.layerid).getRelationById(e.name)||{state:{loading:!1}}).state},isRelationDisabled(e){return this.getRelationName(e.name)===void 0||this.contenttype==="editing"&&this.isRelationChildLayerNotEditable(e)},getRelationName(e){return(F.project.getRelationById(e)||{}).name},isRelationChildLayerNotEditable(e){let t=F.project.getRelationById(e.name),n=F.project.getLayerById(t.referencingLayer);return!(n&&n.isEditable())},getNodes(e){let t=(e-1)*this.columnNumber;return this.filterNodes.slice(t,this.columnNumber+t)},getNode(e,t){return this.getNodes(e)[t-1]},getField(e){if(e.relation)return e;let t=this.fields.find(n=>(e.field_name?e.field_name.replace(/ /g,"_"):e.field_name)===n.name);return t.showlabel=e.showlabel,t},getNodeType(e){let t=e.groupbox||e.nodes?"group":e.relation?"relation":"field";return t==="field"&&[void 0,""].includes(e.alias)&&(e.alias=e.field_name),t},getComponent(e){if(!e.relation)return e.query?e.input.type:"g3w-input"}}},die=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tab-node group"},[e.showGroupTile?n("h5",{staticClass:"title group-title",class:{mobile:e.isMobile()},style:{fontSize:e.isMobile()?"1em":"1.1em"}},[e._v(e._s(e.node.name)+`
  `)]):e._e(),e._v(" "),e._l(e.rows,function(s){return n("div",{staticClass:"node-row",class:{mobile:e.isMobile()}},[e._l(e.columnNumber,function(o){return[e.getNode(s,o)?[e.getNodeType(e.getNode(s,o))==="field"?n(e.getComponent(e.getField(e.getNode(s,o))),{tag:"component",staticStyle:{padding:"5px 3px 5px 3px"},attrs:{state:e.getField(e.getNode(s,o)),changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,feature:e.feature},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}}):[e.getNodeType(e.getNode(s,o))==="group"?n("tabs",e._b({staticClass:"sub-group",staticStyle:{width:"100% !important"},attrs:{group:!0,tabs:[e.getNode(s,o)]}},"tabs",e.$props,!1)):[e.showRelationByField?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.isRelationDisabled(e.getNode(s,o))||e.loadingRelation(e.getNode(s,o)).loading,expression:"isRelationDisabled(getNode(row, column)) || loadingRelation(getNode(row, column)).loading"}],style:{cursor:e.showRelationByField&&"pointer"},on:{click:function(l){l.stopPropagation(),e.handleRelation({relation:e.getNode(s,o),feature:e.feature,layerId:e.layerid})}}},[n("bar-loader",{attrs:{loading:e.loadingRelation(e.getNode(s,o)).loading}}),e._v(" "),n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("div",{staticClass:"query_relation_field"},[n("i",{class:e.g3wtemplate.font[e.context==="query"?"relation":"pencil"]})]),e._v(" "),n("span",{staticClass:"query_relation_field_message g3w-long-text"},[n("span",{staticStyle:{"text-transform":"uppercase"}},[e._v(" "+e._s(e.getRelationName(e.getNode(s,o).name)))])])])],1):e._e()]]]:e._e()]})],2)})],2)},hie=[],fie=function(e){e&&e("data-v-cdcd1e8e_0",{source:".tab-node[data-v-cdcd1e8e]{min-width:0;overflow:hidden}.tab-node.odd[data-v-cdcd1e8e]{background-color:hsl(from var(--skin-color) h s l / .1)}.title[data-v-cdcd1e8e]{font-weight:700;width:100%;color:#fff;padding:3px;margin-top:5px;margin-bottom:5px;border-radius:2px}.node-row[data-v-cdcd1e8e]{margin-bottom:0;column-gap:2px;margin-top:0;display:grid;grid-auto-columns:minmax(0,1fr);grid-auto-flow:column}.row.mobile[data-v-cdcd1e8e]{margin-bottom:0!important}",map:void 0,media:void 0})},pie="data-v-cdcd1e8e",gie=void 0,mie=!1;function _ie(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="GlobalTabsNode.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Rw(){let e=Rw.styles||(Rw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var yie=_ie({render:die,staticRenderFns:hie},fie,uie,pie,mie,gie,!1,Rw,void 0,void 0),cO=yie;ze();lc();Wt();Vl();function vie(e,t){let n=e;if(t!=="editing"){delete e.attributes.geometry,n=new ol.Feature(e.geometry);let s={};pr(e.attributes).filter(o=>jt!==o).forEach(o=>s[o]=e.attributes[o]),n.setProperties(s),n.setId(e.id||e.attributes[jt])}return new ol.format.GeoJSON().writeFeatureObject(n)}var bie={name:"tabs",props:{group:{type:Boolean,default:!1},contenttype:{default:"query"},layerid:{required:!0},tabs:{required:!0},feature:{required:!0},fields:{required:!0},addToValidate:{type:Function,default:oi},removeToValidate:{type:Function,default:oi},changeInput:{type:Function,default:oi},showRelationByField:{type:Boolean,default:!0},handleRelation:{type:Function,default:({relation:e,layerId:t,feature:n}={})=>T.getService("queryresults").showRelation({relation:e,layerId:t,feature:n})}},data(){return{ids:[]}},computed:{required_fields(){return this.contenttype==="editing"&&this.fields.filter(e=>e.validate.required).map(e=>e.name)},show(){return this.tabs.reduce((e,t)=>e||t.visible===void 0||!!t.visible,!1)}},methods:{async setVisibility(e){e.visible=await gt.getData("expression:expression_eval",{inputs:{qgs_layer_id:this.layerid,form_data:vie(this.feature||{},this.contenttype),expression:e.visibility_expression.expression,formatter:this.contenttype==="query"?1:0},outputs:!1})},setEditingRequireTab(e){return e.nodes===void 0?this.required_fields.includes(e.field_name):!!e.nodes.find(t=>this.setEditingRequireTab(t))},getField(e){return this.fields.find(t=>e===t.name)},toggleGroup(e){e.target.closest(".tabs-wrapper").classList.toggle("collapsed")}},components:{Node:cO},async created(){if(this.unwatch=[],this.tabs.forEach(async(e,t)=>{e.visibility_expression&&(e.visible===void 0&&this.$set(e,"visible",0),await this.setVisibility(e)),this.contenttype==="editing"&&(e.required===void 0&&(e.required=this.setEditingRequireTab(e)),e.visibility_expression&&e.visibility_expression.referenced_columns.forEach(n=>{let s=this.fields.find(o=>n===o.name);this.unwatch.push(this.$watch(()=>s.value,async()=>{await this.$nextTick(),await this.setVisibility(e)}))})),this.ids.push(`tab_${Qe()}`)}),this.root_tabs=[],this.group)this.root_tabs=[this.tabs];else{let e=[];this.tabs.forEach(t=>{t.nodes?e.push(t):(e.length&&(this.root_tabs.push([...e]),e.splice(0)),this.root_tabs.push({nodes:[t]}))}),e.length&&this.root_tabs.push(e)}},beforeDestroy(){this.unwatch.forEach(e=>e()),this.unwatch=null}},xie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",{staticClass:"tabs-wrapper"},[e._l(e.root_tabs,function(s,o){return[Array.isArray(s)?[n("ul",{staticClass:"formquerytabs nav nav-tabs"},[e._l(s,function(l,a){return[l.visible===void 0||l.visible?n("li",{class:{active:a===0}},[n("a",{staticClass:"tab_a",class:{mobile:e.isMobile(),"group-title":e.group},style:{fontSize:e.isMobile()?"1.0em":(e.group?"1.1":"1.2")+"em"},attrs:{"data-toggle":"tab",href:"#"+e.ids[a]},on:{click:function(u){e.group&&e.toggleGroup(u)}}},[e._v(`
               `+e._s(l.name)+" "),e.contenttype==="editing"&&l.required?n("span",{staticStyle:{"padding-left":"3px","font-size":"1.1em"}},[e._v("*")]):e._e()])]):e._e()]})],2),e._v(" "),n("div",{staticClass:"tab-content",class:{editing:e.contenttype==="editing"}},[e._l(s,function(l,a){return[l.visible===void 0||l.visible?n("div",{staticClass:"tab-pane fade",class:{"in active":a===0},attrs:{id:e.ids[a]}},[n("node",{attrs:{showRelationByField:e.showRelationByField,handleRelation:e.handleRelation,feature:e.feature,layerid:e.layerid,contenttype:e.contenttype,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput,fields:e.fields,showTitle:!1,node:l}})],1):e._e()]})],2)]:n("node",{class:[o%2?"odd":"even"],attrs:{showRelationByField:e.showRelationByField,handleRelation:e.handleRelation,feature:e.feature,layerid:e.layerid,contenttype:e.contenttype,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput,fields:e.fields,showTitle:!1,node:s}})]})],2):e._e()},wie=[],Sie=function(e){e&&e("data-v-1cf08cba_0",{source:".formquerytabs.nav-tabs>li[data-v-1cf08cba]{margin-right:3px}.formquerytabs.nav-tabs>li[data-v-1cf08cba]:last-child{margin-right:0}.formquerytabs.nav-tabs li:not(.active)>a[data-v-1cf08cba]{color:var(--skin-color);background-color:hsl(from var(--skin-color) h s calc(l + 48))!important;border:1px solid hsl(from var(--skin-color) h s calc(l + 30));margin:0 3px 3px 0;border-bottom:0!important}.formquerytabs.nav-tabs li>a[data-v-1cf08cba]{color:var(--skin-color)}.formquerytabs.nav-tabs li a.tab_a.group-title[data-v-1cf08cba]{background-color:hsl(from var(--skin-color) h s calc(l + 20))!important}.formquerytabs.nav-tabs .nav-tabs>li.active>a[data-v-1cf08cba]:hover,.formquerytabs.nav-tabs li.active>a[data-v-1cf08cba],.formquerytabs.nav-tabs li.active>a[data-v-1cf08cba]:focus{background-color:var(--skin-color)!important;color:#fff}.skin-green .formquerytabs.nav-tabs li:not(.active)>a[data-v-1cf08cba]{background-color:#e4ffcb!important}.skin-green .formquerytabs.nav-tabs li a.tab_a.group-title[data-v-1cf08cba]{background-color:rgba(61,166,90,.85)!important}.skin-red .formquerytabs.nav-tabs li:not(.active)>a[data-v-1cf08cba]{background-color:hsl(from var(--skin-danger) h s calc(l + 40))!important}.skin-yellow .formquerytabs.nav-tabs li:not(.active)>a[data-v-1cf08cba]{background-color:#fefcfa!important;border:1px solid var(--skin-warning-d40)}.formquerytabs[data-v-1cf08cba]{overflow:hidden!important;display:flex;flex-wrap:wrap}.formquerytabs>li[data-v-1cf08cba]{flex:1;display:flex}.formquerytabs>li>a[data-v-1cf08cba]{font-weight:700;flex:1}.nav-tabs>li>a.mobile[data-v-1cf08cba]{padding:5px 10px}.tab_a[data-v-1cf08cba]{padding:5px;margin-right:0!important;border-bottom:0;margin-bottom:3px;border-radius:3px 3px 0 0}.formquerytabs li a.tab_a.group-title[data-v-1cf08cba]{color:inherit!important;font-weight:500;font-size:1em!important;padding:.25em;cursor:pointer}.tabs-wrapper>.formquerytabs li a.tab_a.group-title[data-v-1cf08cba]:before{content:'\u25BE'}.tabs-wrapper.collapsed>.formquerytabs li a.tab_a.group-title[data-v-1cf08cba]:before{content:'\u25B8'}.tabs-wrapper.collapsed>.formquerytabs+.tab-content[data-v-1cf08cba]{display:none}",map:void 0,media:void 0})},Eie="data-v-1cf08cba",Cie=void 0,Iie=!1;function Lie(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="GlobalTabs.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Mw(){let e=Mw.styles||(Mw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Nie=Lie({render:xie,staticRenderFns:wie},Sie,bie,Eie,Iie,Cie,!1,Mw,void 0,void 0),N_=Nie;var Tie={name:"divider"},kie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"divider"})},Rie=[],Mie=function(e){e&&e("data-v-25b15c6e_0",{source:".divider[data-v-25b15c6e]{display:block;position:relative;padding:0;margin-bottom:5px;height:0;width:100%;max-height:0;font-size:1px;line-height:0;clear:both;border:none;border-bottom:2px solid #eee}",map:void 0,media:void 0})},Aie="data-v-25b15c6e",Oie=void 0,Pie=!1;function Fie(e,t,n,s,o,l,a,u,h,p){let d=(typeof n=="function"?n.options:n)||{};d.__file="GlobalDivider.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),d._scopeId=s;{let _;if(t&&(_=a?function(m){t.call(this,p(m,this.$root.$options.shadowRoot))}:function(m){t.call(this,u(m))}),_!==void 0)if(d.functional){let m=d.render;d.render=function(x,b){return _.call(b),m(x,b)}}else{let m=d.beforeCreate;d.beforeCreate=m?[].concat(m,_):[_]}}return d}function Aw(){let e=Aw.styles||(Aw.styles={}),t=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(s,o){if(document.querySelector('style[data-vue-ssr-id~="'+s+'"]'))return;let l=t?o.media||"default":s,a=e[l]||(e[l]={ids:[],parts:[],element:void 0});if(!a.ids.includes(s)){let u=o.source,h=a.ids.length;if(a.ids.push(s),o.map&&(u+=`
/*# sourceURL=`+o.map.sources[0]+" */",u+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(o.map))))+" */"),t&&(a.element=a.element||document.querySelector("style[data-group="+l+"]")),!a.element){let p=document.head||document.getElementsByTagName("head")[0],d=a.element=document.createElement("style");d.type="text/css",o.media&&d.setAttribute("media",o.media),t&&(d.setAttribute("data-group",l),d.setAttribute("data-next-index","0")),p.appendChild(d)}if(t&&(h=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",h+1)),a.element.styleSheet)a.parts.push(u),a.element.styleSheet.cssText=a.parts.filter(Boolean).join(`
`);else{let p=document.createTextNode(u),d=a.element.childNodes;d[h]&&a.element.removeChild(d[h]),d.length?a.element.insertBefore(p,d[h]):a.element.appendChild(p)}}}}var Die=Fie({render:kie,staticRenderFns:Rie},Mie,Tie,Aie,Pie,Oie,!1,Aw,void 0,void 0),T_=Die;var uO=(e,t)=>{e.classList.toggle("g3w-disabled",t.value)};ze();$(document).on("select2:open",function(e){let t=document.querySelector(".select2-container--open .select2-dropdown");t.popover=!0,t.parentElement.style.anchorName="--select2-dropdown-open",t.style.margin=t.style.inset="unset",t.style.top="anchor(--select2-dropdown-open bottom)",t.style.left="anchor(--select2-dropdown-open left)",t.showPopover()});var dO={inserted(e,t,n){let{templateResult:s,templateSelection:o,multiple:l=!1,search:a=!0,select2_value:u,indexItem:h,createTag:p=!1,dropdownAutoWidth:d=!1,dropdownParent:_=!1,placeholder:m="",clear:v=!1}=n.data.attrs||{},x=t.value&&Array.isArray(n.context[t.value])&&h!==void 0,b=()=>{$(e).select2({tags:p,width:"100%",dropdownAutoWidth:d,dropdownParent:_===!0?$(e.parentNode):void 0,templateResult:s,templateSelection:o,minimumResultsForSearch:a?void 0:-1,placeholder:m,allowClear:v,createTag(w){let L=w.term.trim();return L?{id:L,text:L,newTag:!0}:null}}).on("select2:select select2:unselect",w=>{if(!t.value)return;let L=t.value,D=w.type==="select2:select",G=w.params.data.id,W=n.context,P=D&&(x?W[L][h].value:W[L]);if(D&&l&&P.every(j=>G!==j))P.push(G);else if(D&&x)W[L][h].value=G;else if(D){let j=`${L}`.split("."),V=j.pop();j.reduce((H,se)=>(H=H[se],H),n.context)[V]=G}!D&&l&&x?W[L][h].value=W[L][h].value.filter(j=>G!==j):!D&&l&&(W[L]=W[L].filter(j=>G!==j)),(D||l)&&e.dispatchEvent(new Event("change"))})};b(),t.value&&u!==void 0&&($(e).val(u).trigger("change"),n.g3w_observer=new MutationObserver(w=>{let L=(w.find(D=>D.attributeName==="select2_value")||{}).target;L&&$(e).val(L.getAttribute("select2_value")).trigger("change")}),n.g3w_observer.observe(e,{attributes:!0})),T.on("i18n-ready",()=>{if(!e.isConnected)return!0;b()})},unbind:(e,t)=>{t.g3w_observer&&t.g3w_observer.disconnect(),$(e).select2("destroy")}};ze();Rt();$(document).on("shown.bs.tooltip",function(e){console.warn("[G3W-CLIENT] $.fn.tooltip is deprecated");let t=$(e.target).data("bs.tooltip").tip()[0];t.popover="manual",t.style.margin=t.style.border=t.style.background="unset",t.showPopover(),T.isMobile()&&setTimeout(()=>$(e.target).tooltip("hide"),600)});document.head.insertAdjacentHTML("beforeend",`<style>
  #tooltip {
    margin: unset;
    inset: unset;
    font-weight: 700;
    color: #fff;
    background-color: #222;
    border: none;
    border-radius: 4px;
    padding: 5px;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    font-size: 12.5px;
    opacity: 0.9;
    padding: 8px;
    overflow: visible;
  }
  #tooltip[data-placement]:after {
    content: '';
    position: absolute;
    border-color: transparent;
    border-style: solid;
  }
  #tooltip[data-placement="left"]:after {
    top: 50%;
    right: -8px;
    margin-top: -5px;
    border-left-color: #000;
    border-width: 4px;
  }
  #tooltip[data-placement="top"]:after {
    left: 50%;
    bottom: -6px;
    margin-left: -5px;
    border-top-color: #000;
    border-width: 5px 5px 0;
  }
  #tooltip[data-placement="right"]:after {
    top: 50%;
    left: -6px;
    margin-top: -5px;
    border-right-color: #000;
    border-width: 5px 5px 5px 0;
  }
  #tooltip[data-placement="bottom"]:after {
    left: 50%;
    top: -5px;
    margin-left: -5px;
    border-bottom-color: #000;
    border-width: 0 5px 5px;
  }
</style>`);var Ki=Object.assign(document.createElement("template"),{innerHTML:`
    <div popover="manual" id="tooltip"></div>
  `.trim()}).content.firstChild;document.querySelector("#app").insertAdjacentElement("afterend",Ki);document.addEventListener("mousemove",hO);document.addEventListener("mousedown",hO);function hO(e){let t=document.elementFromPoint(e.clientX,e.clientY)?.closest("[data-i18n-title], [title]"),n=t?.getAttribute("data-i18n-title")??t?.getAttribute("title");if(!t||!n||t?.closest(".select2")){Ki.hidePopover();return}Ki.addEventListener("toggle",d=>{d.newState==="closed"&&t.removeAttribute("aria-describedby")},{once:!0}),t.removeAttribute("title"),t.setAttribute("aria-describedby","tooltip"),t.setAttribute("data-i18n-title",n);let s=t.getAttribute("current-tooltip")??n;s=t.hasAttribute("data-i18n-raw")?s:_e(t.hasAttribute("data-i18n-plugin")?`plugins.${s}`:s),Ki.innerHTML=s,Ki.showPopover();let o=t.getAttribute("data-placement")||"left",l=t.getBoundingClientRect(),a=4,u,h,p=0;do o==="top"&&(h=l.top+window.scrollY-Ki.clientHeight-a,u=l.left+window.scrollX+l.width/2-Ki.clientWidth/2),o==="bottom"&&(h=l.bottom+window.scrollY+a,u=l.left+window.scrollX+l.width/2-Ki.clientWidth/2),o==="left"&&(h=l.top+window.scrollY+l.height/2-Ki.clientHeight/2,u=l.left+window.scrollX-Ki.clientWidth-a),o==="right"&&(h=l.top+window.scrollY+l.height/2-Ki.clientHeight/2,u=l.right+window.scrollX+a),h<0&&(o="bottom"),h>window.innerHeight&&(o="top"),u>window.innerWidth&&(o="left"),u<0&&(o="right"),p++;while(p<10&&(u<0||h<0||h>window.innerHeight||u>window.innerWidth));Ki.setAttribute("data-placement",o),Object.assign(Ki.style,{top:h+"px",left:u+"px"}),T.isMobile()&&setTimeout(()=>Ki.hidePopover(),600)}function fO(e,t){t.arg&&e.setAttribute("data-placement",t.arg),[null,"",void 0].includes(t.value)?e.removeAttribute("data-i18n-title"):e.setAttribute("data-i18n-title",t.value),t.modifiers.text&&e.setAttribute("data-i18n-raw",""),t.arg==="plugin"&&e.setAttribute("data-i18n-plugin","")}ze();Rt();var Ow=(e,t)=>{let n="";if(t.name==="t-plugin"&&e.__currentBinding.value!==null&&(n=_e(`plugins.${e.__currentBinding.value}`)),t.name==="t"&&(n=_e(e.__currentBinding.value??"")),e.innerHTML=e.__currentBinding.arg==="pre"?`${n} ${e.__innerHTML}`:`${e.__innerHTML} ${n}`,!e.isConnected)return!0},Pw={bind(e,t){e.__innerHTML=e.innerHTML,e.__currentBinding=t,Ow(e,t),T.on("i18n-ready",Ow.bind(null,e,t))},update(e,t){Ow(e,t)}};Vl();ii();$i();i_();Rt();Ke();Hl();ze();Rt();Mn.on("ready",function(){F.project.state.messages?.items?.length&&(initConfig.header_custom_links.unshift({id:"alerts",icon:"far fa-bell",title:"alerts",i18n:!0,onclick:Gie}),T.isReady().then(()=>pO()))});async function Gie(){if(document.querySelector("dialog#project-messages"))return;let e=F.project.getId(),t=F.project.state.messages,n=JSON.parse(window.localStorage.getItem("MESSAGES")||"{}"),s=F.project.getState()?.edit_url||"",o=Object.assign(document.createElement("template"),{innerHTML:`
      <dialog id="project-messages" popover="manual">
        <h4 style="margin: 0; padding: .5em; color: #FFF; position: sticky; top: 0; background-color: #212c31">${_e("alerts")}</h4>
        <form method="dialog">
          <table style="user-select:none;width:100%;">
            <thead>
              <tr>
                <th><i class="fa fa-check"></i> ${_e("Marked as read")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(l=>`
                <tr>
                  <td>
                    <label style="display: flex;justify-content: space-between; font-weight:${n[e].some(a=>a===l.id)?"normal":"bold"};" title="${_e("Mark as read/unread")}">
                      &bull; ${l.title}
                      <input name="dont_show_again_${l.id}" type="checkbox" ${n[e].some(a=>a===l.id)?"checked":""}>
                    </label>
                  </td>
                  <td style="width: 20px;" ${s?"":"hidden"}>
                    <a href="${s.replace("/projects/update/","/projects/")}messages/update/${l.id}/" target = "_blank" data-i18n-title="Edit in admin">
                      <i class="far fa-edit"></i>
                    </a>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          <menu style="display: flex; justify-content: end;">
            <button type="button" value="close" class="btn btn-secondary" popovertargetaction="hide" popovertarget="project-messages">${t.items.find(l=>!n[e].some(a=>a===l.id))?_e("show"):_e("close")}</button>
          </menu>
        </form>
      </dialog>
    `.trim()}).content.firstChild;o.addEventListener("close",()=>{o.remove(),pO()}),gO(o),document.body.appendChild(o),o.showPopover(),o.querySelectorAll('[name^="dont_show_again_"]').forEach(l=>l.addEventListener("click",a=>{let u=JSON.parse(window.localStorage.getItem("MESSAGES")||"{}"),h=+l.name.replace("dont_show_again_","");l.checked?u[e].push(h):u[e]=u[e].filter(p=>h!==p),window.localStorage.setItem("MESSAGES",JSON.stringify(u)),o.querySelector('menu button[value="close"]').innerHTML=Array.from(o.querySelectorAll('[name^="dont_show_again_"]')).some(p=>!p.checked)?_e("show"):_e("close")})),o.addEventListener("click",l=>{if(l.target.closest("tbody label")){let a=l.target.closest("tbody label"),u=a.querySelector("input");a.style.fontWeight=u.checked?"normal":"bold"}})}async function pO(){let e=F.project.state.messages;if(!e)return;let t=F.project.getId(),n=JSON.parse(window.localStorage.getItem("MESSAGES")||"{}");n[t]=n[t]||[],window.localStorage.setItem("MESSAGES",JSON.stringify(n)),document.querySelector(".nav-alerts a sup")||document.querySelector(".nav-alerts a").insertAdjacentHTML("beforeend",`<sup style="font-weight: bold;margin-top: -6px;">${e.items.length>10?"10+":e.items.length}</sup>`);for(let o=0;o<e.items.length;o++){let l=e.items[o];if(n[t].some(p=>p===l.id))continue;let a=Object.assign(document.createElement("template"),{innerHTML:`
        <dialog id="project-message" popover="manual">
          <h4 style="margin: 0; padding: .5em; color: #FFF; position: sticky; top: 0; background-color: ${{Info:"#0073b7",Warning:"#e99611",Error:"#605ca8",Critical:"#605ca8"}[Object.entries(e.levels).find(([p,d])=>d===l.level)[0]]};">${l.title}</h4>
          <form method="dialog">
            ${l.body}
            <menu style="display: flex;justify-content: space-between;">
              <label style="display: block; width: fit-content;">
                <input type="checkbox" name="dont_show_again" /> ${_e("Don't show again")}
              </label>
              <button type="button" value="close" class="btn btn-secondary" popovertargetaction="hide" popovertarget="project-message">${_e("close")}</button>
            </menu>
          </form>
        </dialog>
      `.trim()}).content.firstChild,{promise:u,resolve:h}=Promise.withResolvers();a.addEventListener("close",async p=>{try{if(a.querySelector('input[name="dont_show_again"]').checked){let d=JSON.parse(window.localStorage.getItem("MESSAGES")||"{}");d[t].push(l.id),window.localStorage.setItem("MESSAGES",JSON.stringify(d))}}catch(d){console.warn(d)}a.remove(),h()}),gO(a),document.body.appendChild(a),a.showPopover(),await u}let s=e.items.filter(o=>!n[t].includes(o.id));s.length?document.querySelector(".nav-alerts a sup").innerHTML=s.length>10?"10+":s.length:document.querySelector(".nav-alerts a sup").innerHTML=""}function gO(e){e.style.maxWidth="90vw",e.style.maxHeight="90vh",e.style.resize="both",e.addEventListener("toggle",async t=>{t.newState==="closed"&&e.dispatchEvent(new Event("close"))}),document.addEventListener("keydown",function t(n){n.key==="Escape"&&(e?.hidePopover?.(),document.removeEventListener("keydown",t))}),e.addEventListener("mousedown",t=>{let n=e.getBoundingClientRect(),s=t.clientY<n.top-20||t.clientY>n.top+n.height||t.clientX<n.left||t.clientX>n.left+n.width-20,o=["label","button","select","input","textarea"].some(u=>t.target.closest(u));if(s||o)return;t.preventDefault();let l=({clientX:u,clientY:h})=>{Object.assign(e.style,{margin:0,left:`${u-t.clientX+n.left}px`,top:`${h-t.clientY+n.top}px`})},a=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",a)}),e.addEventListener("mousemove",t=>{let n=e.getBoundingClientRect(),s=t.clientY<n.top||t.clientY>n.top+n.height||t.clientX<n.left||t.clientX>n.left+n.width;e.style.cursor=s?null:"move"})}Object.entries({ApplicationState:F,G3WObject:nt,Panel:Un,Component:pt,ApplicationService:Mn,GUI:T,MapLayersStoresRegistry:El,IframePluginService:qd,App:Nw,BarLoader:S_,Progressbar:E_,HelpDiv:C_,DateTime:I_,Range:L_,Tabs:N_,Divider:T_,getProject:wl}).forEach(([e,t])=>console.assert(t!==void 0,`${e} is undefined`));Vue.component(S_.name,S_);Vue.component(E_.name,E_);Vue.component(C_.name,C_);Vue.component(I_.name,I_);Vue.component(L_.name,L_);Vue.component(N_.name,N_);Vue.component(T_.name,T_);Vue.directive("disabled",uO);Vue.directive("select2",dO);Vue.directive("t-tooltip",fO);Vue.directive("t",Pw);Vue.directive("t-plugin",Pw);Vue.use(bO());Vue.use({install(e){e.prototype.$t=_e,e.prototype.g3wtemplate={font:Hy,addFontClass({name:t,className:n}={}){let s=this.font[t]===void 0;return s&&(this.font[t]=n),s},getFontClass(t){return this.font[t]||""}},e.prototype.$fa=e.prototype.g3wtemplate.getFontClass.bind(e.prototype.g3wtemplate),e.mixin({methods:{isMobile(){return isMobile.any}}})}},{});Vue.mixin({inheritAttrs:!1});var lS={};function Sae(){let e=F.querybuilder.searches,t=F.project.getId();return e[t]=e[t]||[],e[t]}function aP(e){return new Promise(function(t,n){let s=document.createElement("script");s.onload=t,s.onerror=o=>{console.warn(o),n(new Error("Failed to load script: "+e))},s.src=e,document.head.appendChild(s)})}var ot=window.initConfig;F.user=ot.user;Mn.emit("initconfig",ot);var cS=ot.vendorkeys||{};ot.baselayers.forEach(e=>{e.apikey&&(cS[e.servertype?e.servertype.toLowerCase():null]=e.apikey)});Object.keys(cS).forEach(e=>F.keys.vendorkeys[e]=cS[e]);Object.assign(ot,{urls:Object.assign(ot.urls||{},{ows:"ows",api:"api",initconfig:"api/initconfig",config:"api/config",baseurl:ot.baseurl,frontendurl:ot.frontendurl,staticurl:ot.staticurl,clienturl:ot.staticurl+ot.client,mediaurl:ot.mediaurl,vectorurl:ot.vectorurl,proxyurl:ot.proxyurl,rasterurl:ot.rasterurl,interfaceowsurl:ot.interfaceowsurl}),layout:ot.layout||{},plugins:ot.plugins||{},tools:ot.tools||{tools:[]},views:ot.views||{},user:ot.user||null,header_custom_links:ot.header_custom_links||[]});ot.header_custom_links.unshift({id:"credits",type:"metadata",target:"#metadata_credits",icon:"far fa-question-circle",title:"Credits",i18n:!0});ot.layout.iframe=window.top!==window.self;F.language=ot.user.i18n||"en";$.ajaxSetup({beforeSend:e=>{e.setRequestHeader("Accept-Language",ot.user.i18n||"en")}});(async()=>{try{F.language=ot.user.i18n,_e.register("en",(await import(`${ot.urls.clienturl}locales/en.js`)).default),_e.register([ot.user.i18n],(await import(`${ot.urls.clienturl}locales/${ot.user.i18n}.js`)).default);try{ot.macrogroups=await Ye.get({url:`/${F.user.i18n}/about/api/macrogroup/`})}catch(s){console.warn(s)}try{ot.groups=await Ye.get({url:`/${F.user.i18n}/about/api/group/nomacrogroup/`})}catch(s){console.warn(s)}let e=JSON.parse(window.localStorage.getItem("SIDEBAR")||null)||ot.layout.rightpanel||{};ot.layout.rightpanel=Object.assign({},e,{width:e.width||50,height:e.height||50,width_100:!1,height_100:!1}),F.gui.layout.app=ot.layout,ot.projects.forEach(s=>Object.assign(s,{baselayers:ot.baselayers,minscale:ot.minscale,maxscale:ot.maxscale,crs:ot.crs,vectorurl:ot.vectorurl,rasterurl:ot.rasterurl}));let t=await Promise.race([new Promise(s=>setTimeout(()=>s("Timeout"),$n)),wl(ot.initproject,{map_theme:new URLSearchParams(location.search).get("map_theme")})]);Object.assign(F.project,t);let n=t.getLayersStore();F.catalog[n.getId()]=n,El.addLayersStore(n),g3wsdk.core.project.ProjectsRegistry.setCurrentProject(t),window.addEventListener("online",()=>{F.online=!0,Mn.online()}),window.addEventListener("offline",()=>{F.online=!1,Mn.offline()}),Mn.emit("ready"),F.iframe&&qd.init({project:t}),(isMobile.any||(window.initConfig.layout||{}).iframe)&&$("body").addClass("sidebar-collapse"),Vue.component("app",Nw),await new Promise(s=>new Vue({el:"#app",mounted:s})),[new pt({id:"spatialbookmarks",icon:"far fa-bookmark",iconColor:"#00bcd4",title:"Bookmarks",vueComponentObject:(wO(),kn(xO)).default}),Object.assign(new pt({id:"print",visible:window.initConfig.user.is_staff||(F.project.getPrint()||[]).length>0,icon:T.getFontClass("print"),iconColor:"#FF9B21",title:"print",service:{},internalComponent:new(Vue.extend((IO(),kn(CO)).default))}),{_setOpen(s){this.getInternalComponent().showPrintArea(s)}}),new pt({id:"search",visible:!0,icon:T.getFontClass("search"),iconColor:"#8dc3e3",title:F.project.state.search_title||"search",service:Object.assign(new nt,{state:{searches:(F.project.state.search||[]).sort((s,o)=>`${s.name}`.localeCompare(o.name)),tools:[],querybuildersearches:Sae()},title:F.project.state.search_title||"search",addTool(s){this.state.tools.push(s)},addTools(s){for(let o of s)this.addTool(o)},showPanel(s){return new(aw(),kn(w4)).SearchPanel(s,!0)},getTitle(){return this.title},removeTools(){this.state.tools.splice(0)},stop(s){return _t(Promise.resolve(s))},removeTool(){}}),actions:[{id:"querybuilder",class:`${T.getFontClass("calculator")} sidebar-button sidebar-button-icon`,tooltip:_e("Advanced search"),fnc:()=>(T.closeContent(),T.closeSideBar(),new Un({title:_e("Advanced search"),show:!0,vueComponentObject:(Uw(),kn(LO)).default})),style:{color:"#8DC3E3",padding:"6px",fontSize:"1.2em",borderRadius:"3px",marginRight:"5px"}}],vueComponentObject:(kO(),kn(TO)).default}),new function(){let s={id:"tools",icon:T.getFontClass("tools"),iconColor:"#FFE721",toolsGroups:[],visible:!1,loading:!1},o=new nt({setters:{addTool(u,{title:h,position:p}){let d=s.toolsGroups.find(_=>_.name===h);return d||(d={name:h,tools:[]},s.toolsGroups.splice(p,0,d)),d.tools.push(Object.assign(u,{state:u.state||{type:null,message:null},action:u.action||(lS[u.type]||oi).bind(null,u.options)}))},addToolGroup(u,h){let p=s.toolsGroups.find(d=>d.name===h);return p||(p={name:h,tools:[]},s.toolsGroups.splice(u,0,p)),p},addTools(u,h){u.forEach(p=>this.addTool(p,h))},removeToolGroup(u){s.toolsGroups=s.toolsGroups.filter(h=>h.name!==u)},removeTools(){s.toolsGroups.splice(0)}}});o.state=s,o.config=null,o.getState=()=>s,o.reload=()=>{o.removeTools()},o.setLoading=(u=!1)=>{s.loading=u},o.ACTIONS=lS;let l=F.project.getState().tools||{};for(let u in l)o.addToolGroup(0,u.toUpperCase()),o.addTools(l[u].map(h=>({name:h.name,action:lS[u].bind(null,h)})),{position:0,title:u.toUpperCase()});let a=new pt({id:"tools",icon:T.getFontClass("tools"),iconColor:"#FFE721",title:"tools",service:o,internalComponent:new(Vue.extend({template:`
              <ul class="g3w-tools treeview-menu">
                <bar-loader :loading="state.loading"/>
                <li v-for="g in state.toolsGroups" :key="g.name">
                  <div class="tool-header"><i :class="g3wtemplate.getFontClass('tool')"></i><span>{{ g.name }}</span></div>
                  <div :id="g.name + '-tools'" class="tool-box"><g3w-tool v-for="t in g.tools" :key="t.name" :tool="t" /></div>
                </li>
              </ul>`,components:{G3wTool:(Hw(),kn(NO)).default},data:()=>({state:null}),watch:{async"state.toolsGroups"(u){a.setVisible(u.length>0),this.$emit("visible",u.length>0),await T.isReady(),document.querySelector("#g3w-sidebarcomponents #tools").classList.toggle("single",u.length===1&&u[0].name==="EDITING")}}}))});return a._setOpen=(u=!1)=>{a.internalComponent.state.open=u,u&&T.closeContent()},a},new function(){let s={external:{wms:[],vector:[]},layerstrees:Object.values(F.catalog).map(a=>({tree:a.getLayersTree(),storeid:a.getId()})),layersgroups:[]},o=new nt({setters:{addExternalLayer({layer:a,type:u="vector"}={}){a.removable=!0,s.external[u].push(a)},removeExternalLayer({name:a,type:u="vector"}={}){s.external[u].filter((h,p)=>{if(a===h.name)return s.external[u].splice(p,1),!0})}}});return o.state=s,o.createLayersGroup=({title:a="Layers Group",layers:u=[]}={})=>({title:a,nodes:u.map(h=>h)}),o.addLayersGroup=a=>{s.layersgroups.push(a)},o.getExternalLayers=({type:a="vector"})=>s.external[a],new pt({id:"catalog",icon:T.getFontClass("map"),iconColor:"#019A4C",title:"catalog",resizable:!0,vueComponentObject:(GO(),kn(DO)).default,service:o})}].forEach(s=>T.addComponent(s,"sidebar")),T.setComponent(new pt({id:"queryresults",service:(HO(),kn(VO)).default,vueComponentObject:(sP(),kn(iP)).default})),T.setComponent(new pt({id:"map",service:new(gu(),kn(s_)).default.MapService,vueComponentObject:(oP(),kn(rP)).default})),T.setComponent(Object.assign(new pt({id:"contents",vueComponentObject:{template:'<div id="contents" class="contents"></div>'}}),{parent:null,contentsdata:F.contentsdata,getComponentById:s=>(F.contentsdata.find(o=>s==o.content.id)||{}).content})),T.getComponent("map").mount("#g3w-view-map",!0),T.getComponent("contents").mount("#g3w-view-content",!0),F.sizes.sidebar.width=$(".main-sidebar").width(),T.ready();try{let s=F.project.getGid(),o={};Object.entries(window.initConfig.plugins).filter(([,a])=>a.gid===s).forEach(([a,u])=>o[a]=u),Object.assign(F.pluginsConfigs,o),Object.keys(F.pluginsConfigs).forEach(a=>F.configurationPlugins.push(a)),Object.keys(F.pluginsConfigs).forEach(a=>F.plugins.push(a));let l=F.project.getState()||{};l&&l.law&&l.law.length?(F.pluginsConfigs.law=l.law,F.pluginsConfigs.law.gid=l.gid):delete F.pluginsConfigs.law;for(let a in F.pluginsConfigs)Object.entries(F.pluginsConfigs[a].plugins||{}).forEach(([u,h])=>F.pluginsConfigs[u]={...F.pluginsConfigs[u],...h});await Promise.allSettled(Object.entries(F.pluginsConfigs).map(async([a,u])=>{if(u){u.baseUrl=window.initConfig.urls.staticurl;try{await Promise.all((u.jsscripts||[]).map(p=>aP(p,!1)));let h=g3wsdk.core.project.ProjectsRegistry.getCurrentProject().getState().modified+"+"+new Date().toISOString().slice(0,13);await aP(`${window.initConfig.urls.staticurl}${a}/js/plugin.js?${h}`,!1)}catch(h){return console.warn("[G3W-PLUGIN]",h),F.plugins=F.plugins.filter(p=>a!==p),Promise.reject()}}}))}catch(s){console.warn(s)}Mn.complete=!0,Mn.emit("complete")}catch(e){console.error(e),e=e.responseJSON?.error?.data??e?.statusText??e,$("#startingspinner").remove();let t=document.querySelector(".error-page");t?t.querySelector(".trace").insertAdjacentHTML("beforeend",`
      <br>${e||_e("Connection error")}
    `):document.body.insertAdjacentHTML("beforeend",`
      <div class="error-page" style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #FFF; background-color: var(--skin-color);">
        <h1 style="font-weight: bold;">${_e("Connection error")}</h1>
        <h2 style="order: -1; font-size: 5em; font-weight: bold;">Oops!</h2>
        <h3>${_e("At the moment is not possible show map")}</h3>
        <p class="trace" style="background: #333;padding: 1rem;border-radius: 3px;margin-top: 2rem;font-family: Monospace;">${e||_e("Connection error")}</p>
      </div>`)}})();})();
/*! Bundled license information:

wolfy87-eventemitter/EventEmitter.js:
  (*!
   * EventEmitter v5.2.9 - git.io/ee
   * Unlicense - http://unlicense.org/
   * Oliver Caldwell - https://oli.me.uk/
   * @preserve
   *)

jszip/dist/jszip.min.js:
  (*!
  
  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>
  
  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
  
  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  *)

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

jsts/dist/jsts.min.js:
  (**
   * JSTS. See https://github.com/bjornharrtell/jsts
   * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EDLv1.txt
   * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EPLv1.txt
   * @license
   *)

vue-cookie-law/dist/vue-cookie-law.js:
  (*!
   * vue-cookie-law v1.13.3
   * (c) 2020 Jakub Juszczak <jakub@posteo.de>
   * 
   *)

tiny-cookie/tiny-cookie.js:
  (*!
   * tiny-cookie - A tiny cookie manipulation plugin
   * https://github.com/Alex1990/tiny-cookie
   * Under the MIT license | (c) Alex Chao
   *)
*/
//# sourceMappingURL=app.min.js.map
